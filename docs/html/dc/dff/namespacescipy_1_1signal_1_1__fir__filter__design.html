<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: scipy.signal._fir_filter_design Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dc/dff/namespacescipy_1_1signal_1_1__fir__filter__design.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.signal._fir_filter_design Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9b6d9b077f47727a463a031e87df6327" id="r_a9b6d9b077f47727a463a031e87df6327"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b6d9b077f47727a463a031e87df6327">_get_fs</a> (fs, nyq)</td></tr>
<tr class="separator:a9b6d9b077f47727a463a031e87df6327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa1c6de0dbaf7aa0f1121be85ff1c3f" id="r_a3aa1c6de0dbaf7aa0f1121be85ff1c3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3aa1c6de0dbaf7aa0f1121be85ff1c3f">kaiser_beta</a> (a)</td></tr>
<tr class="separator:a3aa1c6de0dbaf7aa0f1121be85ff1c3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ac7cf55e5243fdc7cbac8b63108b0a" id="r_a50ac7cf55e5243fdc7cbac8b63108b0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50ac7cf55e5243fdc7cbac8b63108b0a">kaiser_atten</a> (numtaps, width)</td></tr>
<tr class="separator:a50ac7cf55e5243fdc7cbac8b63108b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3198c7e00ea036cdc733e5ff5b93dd3" id="r_ac3198c7e00ea036cdc733e5ff5b93dd3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3198c7e00ea036cdc733e5ff5b93dd3">kaiserord</a> (ripple, width)</td></tr>
<tr class="separator:ac3198c7e00ea036cdc733e5ff5b93dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e940213231a4c6a1271017ee67a9ab" id="r_a74e940213231a4c6a1271017ee67a9ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74e940213231a4c6a1271017ee67a9ab">firwin</a> (numtaps, cutoff, width=None, window='hamming', pass_zero=<a class="el" href="../../d8/d0b/classTrue.html">True</a>, scale=<a class="el" href="../../d8/d0b/classTrue.html">True</a>, nyq=None, fs=None)</td></tr>
<tr class="separator:a74e940213231a4c6a1271017ee67a9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7877c78a419877dd794b26a3c807cd" id="r_a1f7877c78a419877dd794b26a3c807cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f7877c78a419877dd794b26a3c807cd">firwin2</a> (numtaps, freq, gain, nfreqs=None, window='hamming', nyq=None, antisymmetric=False, fs=None)</td></tr>
<tr class="separator:a1f7877c78a419877dd794b26a3c807cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909a3ff237b9a0c641ef2dd402a0a7ee" id="r_a909a3ff237b9a0c641ef2dd402a0a7ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a909a3ff237b9a0c641ef2dd402a0a7ee">remez</a> (numtaps, bands, desired, weight=None, Hz=None, type='bandpass', maxiter=25, grid_density=16, fs=None)</td></tr>
<tr class="separator:a909a3ff237b9a0c641ef2dd402a0a7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e0f668c9d6f42ff759cbf31c99b92d" id="r_a30e0f668c9d6f42ff759cbf31c99b92d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30e0f668c9d6f42ff759cbf31c99b92d">firls</a> (numtaps, bands, desired, weight=None, nyq=None, fs=None)</td></tr>
<tr class="separator:a30e0f668c9d6f42ff759cbf31c99b92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df677277b316465bef06cda54628ac1" id="r_a6df677277b316465bef06cda54628ac1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6df677277b316465bef06cda54628ac1">_dhtm</a> (mag)</td></tr>
<tr class="separator:a6df677277b316465bef06cda54628ac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2de1b0b0595bd11e48606e002ec9542" id="r_ac2de1b0b0595bd11e48606e002ec9542"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2de1b0b0595bd11e48606e002ec9542">minimum_phase</a> (h, method='homomorphic', n_fft=None)</td></tr>
<tr class="separator:ac2de1b0b0595bd11e48606e002ec9542"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7a7427ef2d43c03cef301cd91dd737c4" id="r_a7a7427ef2d43c03cef301cd91dd737c4"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a7427ef2d43c03cef301cd91dd737c4">__all__</a></td></tr>
<tr class="separator:a7a7427ef2d43c03cef301cd91dd737c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions for FIR filter design.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a6df677277b316465bef06cda54628ac1" name="a6df677277b316465bef06cda54628ac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df677277b316465bef06cda54628ac1">&#9670;&#160;</a></span>_dhtm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design._dhtm </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>mag</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Compute the modified 1-D discrete Hilbert transform

Parameters
----------
mag : ndarray
    The magnitude spectrum. Should be 1-D with an even length, and
    preferably a fast length for FFT/IFFT.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l01099">1099</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l01121">minimum_phase()</a>.</p>

</div>
</div>
<a id="a9b6d9b077f47727a463a031e87df6327" name="a9b6d9b077f47727a463a031e87df6327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b6d9b077f47727a463a031e87df6327">&#9670;&#160;</a></span>_get_fs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design._get_fs </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nyq</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Utility for replacing the argument 'nyq' (with default 1) with 'fs'.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00019">19</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00879">firls()</a>, <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00266">firwin()</a>, and <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00494">firwin2()</a>.</p>

</div>
</div>
<a id="a30e0f668c9d6f42ff759cbf31c99b92d" name="a30e0f668c9d6f42ff759cbf31c99b92d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e0f668c9d6f42ff759cbf31c99b92d">&#9670;&#160;</a></span>firls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.firls </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>numtaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>desired</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>weight</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nyq</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">FIR filter design using least-squares error minimization.

Calculate the filter coefficients for the linear-phase finite
impulse response (FIR) filter which has the best approximation
to the desired frequency response described by `bands` and
`desired` in the least squares sense (i.e., the integral of the
weighted mean-squared error within the specified bands is
minimized).

Parameters
----------
numtaps : int
    The number of taps in the FIR filter. `numtaps` must be odd.
bands : array_like
    A monotonic nondecreasing sequence containing the band edges in
    Hz. All elements must be non-negative and less than or equal to
    the Nyquist frequency given by `nyq`. The bands are specified as
    frequency pairs, thus, if using a 1D array, its length must be
    even, e.g., `np.array([0, 1, 2, 3, 4, 5])`. Alternatively, the
    bands can be specified as an nx2 sized 2D array, where n is the
    number of bands, e.g, `np.array([[0, 1], [2, 3], [4, 5]])`.
desired : array_like
    A sequence the same size as `bands` containing the desired gain
    at the start and end point of each band.
weight : array_like, optional
    A relative weighting to give to each band region when solving
    the least squares problem. `weight` has to be half the size of
    `bands`.
nyq : float, optional, deprecated
    This is the Nyquist frequency. Each frequency in `bands` must be
    between 0 and `nyq` (inclusive). Default is 1.

    .. deprecated:: 1.0.0
       `firls` keyword argument `nyq` is deprecated in favour of `fs` and
       will be removed in SciPy 1.12.0.
fs : float, optional
    The sampling frequency of the signal. Each frequency in `bands`
    must be between 0 and ``fs/2`` (inclusive). Default is 2.

Returns
-------
coeffs : ndarray
    Coefficients of the optimal (in a least squares sense) FIR filter.

See Also
--------
firwin
firwin2
minimum_phase
remez

Notes
-----
This implementation follows the algorithm given in [1]_.
As noted there, least squares design has multiple advantages:

    1. Optimal in a least-squares sense.
    2. Simple, non-iterative method.
    3. The general solution can obtained by solving a linear
       system of equations.
    4. Allows the use of a frequency dependent weighting function.

This function constructs a Type I linear phase FIR filter, which
contains an odd number of `coeffs` satisfying for :math:`n &lt; numtaps`:

.. math:: coeffs(n) = coeffs(numtaps - 1 - n)

The odd number of coefficients and filter symmetry avoid boundary
conditions that could otherwise occur at the Nyquist and 0 frequencies
(e.g., for Type II, III, or IV variants).

.. versionadded:: 0.18

References
----------
.. [1] Ivan Selesnick, Linear-Phase Fir Filter Design By Least Squares.
       OpenStax CNX. Aug 9, 2005.
       http://cnx.org/contents/eb1ecb35-03a9-4610-ba87-41cd771c95f2@7

Examples
--------
We want to construct a band-pass filter. Note that the behavior in the
frequency ranges between our stop bands and pass bands is unspecified,
and thus may overshoot depending on the parameters of our filter:

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, axs = plt.subplots(2)
&gt;&gt;&gt; fs = 10.0  # Hz
&gt;&gt;&gt; desired = (0, 0, 1, 1, 0, 0)
&gt;&gt;&gt; for bi, bands in enumerate(((0, 1, 2, 3, 4, 5), (0, 1, 2, 4, 4.5, 5))):
...     fir_firls = signal.firls(73, bands, desired, fs=fs)
...     fir_remez = signal.remez(73, bands, desired[::2], fs=fs)
...     fir_firwin2 = signal.firwin2(73, bands, desired, fs=fs)
...     hs = list()
...     ax = axs[bi]
...     for fir in (fir_firls, fir_remez, fir_firwin2):
...         freq, response = signal.freqz(fir)
...         hs.append(ax.semilogy(0.5*fs*freq/np.pi, np.abs(response))[0])
...     for band, gains in zip(zip(bands[::2], bands[1::2]),
...                            zip(desired[::2], desired[1::2])):
...         ax.semilogy(band, np.maximum(gains, 1e-7), 'k--', linewidth=2)
...     if bi == 0:
...         ax.legend(hs, ('firls', 'remez', 'firwin2'),
...                   loc='lower center', frameon=False)
...     else:
...         ax.set_xlabel('Frequency (Hz)')
...     ax.grid(True)
...     ax.set(title='Band-pass %d-%d Hz' % bands[2:4], ylabel='Magnitude')
...
&gt;&gt;&gt; fig.tight_layout()
&gt;&gt;&gt; plt.show()
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00879">879</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">References <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00019">_get_fs()</a>.</p>

</div>
</div>
<a id="a74e940213231a4c6a1271017ee67a9ab" name="a74e940213231a4c6a1271017ee67a9ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e940213231a4c6a1271017ee67a9ab">&#9670;&#160;</a></span>firwin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.firwin </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>numtaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cutoff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>width</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>window</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'hamming'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pass_zero</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../d8/d0b/classTrue.html">True</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>scale</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../d8/d0b/classTrue.html">True</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nyq</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">FIR filter design using the window method.

This function computes the coefficients of a finite impulse response
filter. The filter will have linear phase; it will be Type I if
`numtaps` is odd and Type II if `numtaps` is even.

Type II filters always have zero response at the Nyquist frequency, so a
ValueError exception is raised if firwin is called with `numtaps` even and
having a passband whose right end is at the Nyquist frequency.

Parameters
----------
numtaps : int
    Length of the filter (number of coefficients, i.e. the filter
    order + 1).  `numtaps` must be odd if a passband includes the
    Nyquist frequency.
cutoff : float or 1-D array_like
    Cutoff frequency of filter (expressed in the same units as `fs`)
    OR an array of cutoff frequencies (that is, band edges). In the
    latter case, the frequencies in `cutoff` should be positive and
    monotonically increasing between 0 and `fs/2`. The values 0 and
    `fs/2` must not be included in `cutoff`.
width : float or None, optional
    If `width` is not None, then assume it is the approximate width
    of the transition region (expressed in the same units as `fs`)
    for use in Kaiser FIR filter design. In this case, the `window`
    argument is ignored.
window : string or tuple of string and parameter values, optional
    Desired window to use. See `scipy.signal.get_window` for a list
    of windows and required parameters.
pass_zero : {True, False, 'bandpass', 'lowpass', 'highpass', 'bandstop'}, optional
    If True, the gain at the frequency 0 (i.e., the "DC gain") is 1.
    If False, the DC gain is 0. Can also be a string argument for the
    desired filter type (equivalent to ``btype`` in IIR design functions).

    .. versionadded:: 1.3.0
       Support for string arguments.
scale : bool, optional
    Set to True to scale the coefficients so that the frequency
    response is exactly unity at a certain frequency.
    That frequency is either:

    - 0 (DC) if the first passband starts at 0 (i.e. pass_zero
      is True)
    - `fs/2` (the Nyquist frequency) if the first passband ends at
      `fs/2` (i.e the filter is a single band highpass filter);
      center of first passband otherwise

nyq : float, optional, deprecated
    This is the Nyquist frequency. Each frequency in `cutoff` must be
    between 0 and `nyq`. Default is 1.

    .. deprecated:: 1.0.0
       `firwin` keyword argument `nyq` is deprecated in favour of `fs` and
       will be removed in SciPy 1.12.0.
fs : float, optional
    The sampling frequency of the signal. Each frequency in `cutoff`
    must be between 0 and ``fs/2``.  Default is 2.

Returns
-------
h : (numtaps,) ndarray
    Coefficients of length `numtaps` FIR filter.

Raises
------
ValueError
    If any value in `cutoff` is less than or equal to 0 or greater
    than or equal to ``fs/2``, if the values in `cutoff` are not strictly
    monotonically increasing, or if `numtaps` is even but a passband
    includes the Nyquist frequency.

See Also
--------
firwin2
firls
minimum_phase
remez

Examples
--------
Low-pass from 0 to f:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; numtaps = 3
&gt;&gt;&gt; f = 0.1
&gt;&gt;&gt; signal.firwin(numtaps, f)
array([ 0.06799017,  0.86401967,  0.06799017])

Use a specific window function:

&gt;&gt;&gt; signal.firwin(numtaps, f, window='nuttall')
array([  3.56607041e-04,   9.99286786e-01,   3.56607041e-04])

High-pass ('stop' from 0 to f):

&gt;&gt;&gt; signal.firwin(numtaps, f, pass_zero=False)
array([-0.00859313,  0.98281375, -0.00859313])

Band-pass:

&gt;&gt;&gt; f1, f2 = 0.1, 0.2
&gt;&gt;&gt; signal.firwin(numtaps, [f1, f2], pass_zero=False)
array([ 0.06301614,  0.88770441,  0.06301614])

Band-stop:

&gt;&gt;&gt; signal.firwin(numtaps, [f1, f2])
array([-0.00801395,  1.0160279 , -0.00801395])

Multi-band (passbands are [0, f1], [f2, f3] and [f4, 1]):

&gt;&gt;&gt; f3, f4 = 0.3, 0.4
&gt;&gt;&gt; signal.firwin(numtaps, [f1, f2, f3, f4])
array([-0.01376344,  1.02752689, -0.01376344])

Multi-band (passbands are [f1, f2] and [f3,f4]):

&gt;&gt;&gt; signal.firwin(numtaps, [f1, f2, f3, f4], pass_zero=False)
array([ 0.04890915,  0.91284326,  0.04890915])
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00265">265</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">References <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00019">_get_fs()</a>, <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00088">kaiser_atten()</a>, and <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00050">kaiser_beta()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5d/__signaltools_8py_source.html#l04458">scipy.signal._signaltools.decimate()</a>, <a class="el" href="../../d3/d5d/__signaltools_8py_source.html#l03225">scipy.signal._signaltools.resample_poly()</a>, <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00264">scipy.signal.tests.test_fir_filter_design.TestFirWinMore.test_bad_pass_zero()</a>, <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00211">scipy.signal.tests.test_fir_filter_design.TestFirWinMore.test_fs_nyq()</a>, and <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00098">scipy.signal.tests.test_fir_filter_design.TestFirwin.test_scaling()</a>.</p>

</div>
</div>
<a id="a1f7877c78a419877dd794b26a3c807cd" name="a1f7877c78a419877dd794b26a3c807cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f7877c78a419877dd794b26a3c807cd">&#9670;&#160;</a></span>firwin2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.firwin2 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>numtaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>freq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gain</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nfreqs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>window</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'hamming'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>nyq</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>antisymmetric</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">FIR filter design using the window method.

From the given frequencies `freq` and corresponding gains `gain`,
this function constructs an FIR filter with linear phase and
(approximately) the given frequency response.

Parameters
----------
numtaps : int
    The number of taps in the FIR filter.  `numtaps` must be less than
    `nfreqs`.
freq : array_like, 1-D
    The frequency sampling points. Typically 0.0 to 1.0 with 1.0 being
    Nyquist.  The Nyquist frequency is half `fs`.
    The values in `freq` must be nondecreasing. A value can be repeated
    once to implement a discontinuity. The first value in `freq` must
    be 0, and the last value must be ``fs/2``. Values 0 and ``fs/2`` must
    not be repeated.
gain : array_like
    The filter gains at the frequency sampling points. Certain
    constraints to gain values, depending on the filter type, are applied,
    see Notes for details.
nfreqs : int, optional
    The size of the interpolation mesh used to construct the filter.
    For most efficient behavior, this should be a power of 2 plus 1
    (e.g, 129, 257, etc). The default is one more than the smallest
    power of 2 that is not less than `numtaps`. `nfreqs` must be greater
    than `numtaps`.
window : string or (string, float) or float, or None, optional
    Window function to use. Default is "hamming". See
    `scipy.signal.get_window` for the complete list of possible values.
    If None, no window function is applied.
nyq : float, optional, deprecated
    This is the Nyquist frequency. Each frequency in `freq` must be
    between 0 and `nyq`. Default is 1.

    .. deprecated:: 1.0.0
       `firwin2` keyword argument `nyq` is deprecated in favour of `fs` and
       will be removed in SciPy 1.12.0.
antisymmetric : bool, optional
    Whether resulting impulse response is symmetric/antisymmetric.
    See Notes for more details.
fs : float, optional
    The sampling frequency of the signal. Each frequency in `cutoff`
    must be between 0 and ``fs/2``. Default is 2.

Returns
-------
taps : ndarray
    The filter coefficients of the FIR filter, as a 1-D array of length
    `numtaps`.

See Also
--------
firls
firwin
minimum_phase
remez

Notes
-----
From the given set of frequencies and gains, the desired response is
constructed in the frequency domain. The inverse FFT is applied to the
desired response to create the associated convolution kernel, and the
first `numtaps` coefficients of this kernel, scaled by `window`, are
returned.

The FIR filter will have linear phase. The type of filter is determined by
the value of 'numtaps` and `antisymmetric` flag.
There are four possible combinations:

   - odd  `numtaps`, `antisymmetric` is False, type I filter is produced
   - even `numtaps`, `antisymmetric` is False, type II filter is produced
   - odd  `numtaps`, `antisymmetric` is True, type III filter is produced
   - even `numtaps`, `antisymmetric` is True, type IV filter is produced

Magnitude response of all but type I filters are subjects to following
constraints:

   - type II  -- zero at the Nyquist frequency
   - type III -- zero at zero and Nyquist frequencies
   - type IV  -- zero at zero frequency

.. versionadded:: 0.9.0

References
----------
.. [1] Oppenheim, A. V. and Schafer, R. W., "Discrete-Time Signal
   Processing", Prentice-Hall, Englewood Cliffs, New Jersey (1989).
   (See, for example, Section 7.4.)

.. [2] Smith, Steven W., "The Scientist and Engineer's Guide to Digital
   Signal Processing", Ch. 17. http://www.dspguide.com/ch17/1.htm

Examples
--------
A lowpass FIR filter with a response that is 1 on [0.0, 0.5], and
that decreases linearly on [0.5, 1.0] from 1 to 0:

&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; taps = signal.firwin2(150, [0.0, 0.5, 1.0], [1.0, 1.0, 0.0])
&gt;&gt;&gt; print(taps[72:78])
[-0.02286961 -0.06362756  0.57310236  0.57310236 -0.06362756 -0.02286961]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00493">493</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">References <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00019">_get_fs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00375">scipy.signal.tests.test_fir_filter_design.TestFirwin2.test04()</a>, <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00387">scipy.signal.tests.test_fir_filter_design.TestFirwin2.test05()</a>, and <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00399">scipy.signal.tests.test_fir_filter_design.TestFirwin2.test06()</a>.</p>

</div>
</div>
<a id="a50ac7cf55e5243fdc7cbac8b63108b0a" name="a50ac7cf55e5243fdc7cbac8b63108b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ac7cf55e5243fdc7cbac8b63108b0a">&#9670;&#160;</a></span>kaiser_atten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.kaiser_atten </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>numtaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>width</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the attenuation of a Kaiser FIR filter.

Given the number of taps `N` and the transition width `width`, compute the
attenuation `a` in dB, given by Kaiser's formula:

    a = 2.285 * (N - 1) * pi * width + 7.95

Parameters
----------
numtaps : int
    The number of taps in the FIR filter.
width : float
    The desired width of the transition region between passband and
    stopband (or, in general, at any discontinuity) for the filter,
    expressed as a fraction of the Nyquist frequency.

Returns
-------
a : float
    The attenuation of the ripple, in dB.

See Also
--------
kaiserord, kaiser_beta

Examples
--------
Suppose we want to design a FIR filter using the Kaiser window method
that will have 211 taps and a transition width of 9 Hz for a signal that
is sampled at 480 Hz. Expressed as a fraction of the Nyquist frequency,
the width is 9/(0.5*480) = 0.0375. The approximate attenuation (in dB)
is computed as follows:

&gt;&gt;&gt; from scipy.signal import kaiser_atten
&gt;&gt;&gt; kaiser_atten(211, 0.0375)
64.48099630593983
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00088">88</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00266">firwin()</a>.</p>

</div>
</div>
<a id="a3aa1c6de0dbaf7aa0f1121be85ff1c3f" name="a3aa1c6de0dbaf7aa0f1121be85ff1c3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa1c6de0dbaf7aa0f1121be85ff1c3f">&#9670;&#160;</a></span>kaiser_beta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.kaiser_beta </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute the Kaiser parameter `beta`, given the attenuation `a`.

Parameters
----------
a : float
    The desired attenuation in the stopband and maximum ripple in
    the passband, in dB.  This should be a *positive* number.

Returns
-------
beta : float
    The `beta` parameter to be used in the formula for a Kaiser window.

References
----------
Oppenheim, Schafer, "Discrete-Time Signal Processing", p.475-476.

Examples
--------
Suppose we want to design a lowpass filter, with 65 dB attenuation
in the stop band.  The Kaiser window parameter to be used in the
window method is computed by ``kaiser_beta(65)``:

&gt;&gt;&gt; from scipy.signal import kaiser_beta
&gt;&gt;&gt; kaiser_beta(65)
6.20426
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00050">50</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00266">firwin()</a>, and <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00131">kaiserord()</a>.</p>

</div>
</div>
<a id="ac3198c7e00ea036cdc733e5ff5b93dd3" name="ac3198c7e00ea036cdc733e5ff5b93dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3198c7e00ea036cdc733e5ff5b93dd3">&#9670;&#160;</a></span>kaiserord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.kaiserord </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ripple</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>width</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Determine the filter window parameters for the Kaiser window method.

The parameters returned by this function are generally used to create
a finite impulse response filter using the window method, with either
`firwin` or `firwin2`.

Parameters
----------
ripple : float
    Upper bound for the deviation (in dB) of the magnitude of the
    filter's frequency response from that of the desired filter (not
    including frequencies in any transition intervals). That is, if w
    is the frequency expressed as a fraction of the Nyquist frequency,
    A(w) is the actual frequency response of the filter and D(w) is the
    desired frequency response, the design requirement is that::

        abs(A(w) - D(w))) &lt; 10**(-ripple/20)

    for 0 &lt;= w &lt;= 1 and w not in a transition interval.
width : float
    Width of transition region, normalized so that 1 corresponds to pi
    radians / sample. That is, the frequency is expressed as a fraction
    of the Nyquist frequency.

Returns
-------
numtaps : int
    The length of the Kaiser window.
beta : float
    The beta parameter for the Kaiser window.

See Also
--------
kaiser_beta, kaiser_atten

Notes
-----
There are several ways to obtain the Kaiser window:

- ``signal.windows.kaiser(numtaps, beta, sym=True)``
- ``signal.get_window(beta, numtaps)``
- ``signal.get_window(('kaiser', beta), numtaps)``

The empirical equations discovered by Kaiser are used.

References
----------
Oppenheim, Schafer, "Discrete-Time Signal Processing", pp.475-476.

Examples
--------
We will use the Kaiser window method to design a lowpass FIR filter
for a signal that is sampled at 1000 Hz.

We want at least 65 dB rejection in the stop band, and in the pass
band the gain should vary no more than 0.5%.

We want a cutoff frequency of 175 Hz, with a transition between the
pass band and the stop band of 24 Hz. That is, in the band [0, 163],
the gain varies no more than 0.5%, and in the band [187, 500], the
signal is attenuated by at least 65 dB.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.signal import kaiserord, firwin, freqz
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fs = 1000.0
&gt;&gt;&gt; cutoff = 175
&gt;&gt;&gt; width = 24

The Kaiser method accepts just a single parameter to control the pass
band ripple and the stop band rejection, so we use the more restrictive
of the two. In this case, the pass band ripple is 0.005, or 46.02 dB,
so we will use 65 dB as the design parameter.

Use `kaiserord` to determine the length of the filter and the
parameter for the Kaiser window.

&gt;&gt;&gt; numtaps, beta = kaiserord(65, width/(0.5*fs))
&gt;&gt;&gt; numtaps
167
&gt;&gt;&gt; beta
6.20426

Use `firwin` to create the FIR filter.

&gt;&gt;&gt; taps = firwin(numtaps, cutoff, window=('kaiser', beta),
...               scale=False, fs=fs)

Compute the frequency response of the filter.  ``w`` is the array of
frequencies, and ``h`` is the corresponding complex array of frequency
responses.

&gt;&gt;&gt; w, h = freqz(taps, worN=8000)
&gt;&gt;&gt; w *= 0.5*fs/np.pi  # Convert w to Hz.

Compute the deviation of the magnitude of the filter's response from
that of the ideal lowpass filter. Values in the transition region are
set to ``nan``, so they won't appear in the plot.

&gt;&gt;&gt; ideal = w &lt; cutoff  # The "ideal" frequency response.
&gt;&gt;&gt; deviation = np.abs(np.abs(h) - ideal)
&gt;&gt;&gt; deviation[(w &gt; cutoff - 0.5*width) &amp; (w &lt; cutoff + 0.5*width)] = np.nan

Plot the deviation. A close look at the left end of the stop band shows
that the requirement for 65 dB attenuation is violated in the first lobe
by about 0.125 dB. This is not unusual for the Kaiser window method.

&gt;&gt;&gt; plt.plot(w, 20*np.log10(np.abs(deviation)))
&gt;&gt;&gt; plt.xlim(0, 0.5*fs)
&gt;&gt;&gt; plt.ylim(-90, -60)
&gt;&gt;&gt; plt.grid(alpha=0.25)
&gt;&gt;&gt; plt.axhline(-65, color='r', ls='--', alpha=0.3)
&gt;&gt;&gt; plt.xlabel('Frequency (Hz)')
&gt;&gt;&gt; plt.ylabel('Deviation from ideal (dB)')
&gt;&gt;&gt; plt.title('Lowpass Filter Frequency Response')
&gt;&gt;&gt; plt.show()
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00131">131</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">References <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00050">kaiser_beta()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d59/test__fir__filter__design_8py_source.html#l00211">scipy.signal.tests.test_fir_filter_design.TestFirWinMore.test_fs_nyq()</a>.</p>

</div>
</div>
<a id="ac2de1b0b0595bd11e48606e002ec9542" name="ac2de1b0b0595bd11e48606e002ec9542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2de1b0b0595bd11e48606e002ec9542">&#9670;&#160;</a></span>minimum_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.minimum_phase </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'homomorphic'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>n_fft</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a linear-phase FIR filter to minimum phase

Parameters
----------
h : array
    Linear-phase FIR filter coefficients.
method : {'hilbert', 'homomorphic'}
    The method to use:

        'homomorphic' (default)
            This method [4]_ [5]_ works best with filters with an
            odd number of taps, and the resulting minimum phase filter
            will have a magnitude response that approximates the square
            root of the original filter's magnitude response.

        'hilbert'
            This method [1]_ is designed to be used with equiripple
            filters (e.g., from `remez`) with unity or zero gain
            regions.

n_fft : int
    The number of points to use for the FFT. Should be at least a
    few times larger than the signal length (see Notes).

Returns
-------
h_minimum : array
    The minimum-phase version of the filter, with length
    ``(length(h) + 1) // 2``.

See Also
--------
firwin
firwin2
remez

Notes
-----
Both the Hilbert [1]_ or homomorphic [4]_ [5]_ methods require selection
of an FFT length to estimate the complex cepstrum of the filter.

In the case of the Hilbert method, the deviation from the ideal
spectrum ``epsilon`` is related to the number of stopband zeros
``n_stop`` and FFT length ``n_fft`` as::

    epsilon = 2. * n_stop / n_fft

For example, with 100 stopband zeros and a FFT length of 2048,
``epsilon = 0.0976``. If we conservatively assume that the number of
stopband zeros is one less than the filter length, we can take the FFT
length to be the next power of 2 that satisfies ``epsilon=0.01`` as::

    n_fft = 2 ** int(np.ceil(np.log2(2 * (len(h) - 1) / 0.01)))

This gives reasonable results for both the Hilbert and homomorphic
methods, and gives the value used when ``n_fft=None``.

Alternative implementations exist for creating minimum-phase filters,
including zero inversion [2]_ and spectral factorization [3]_ [4]_.
For more information, see:

    http://dspguru.com/dsp/howtos/how-to-design-minimum-phase-fir-filters

References
----------
.. [1] N. Damera-Venkata and B. L. Evans, "Optimal design of real and
       complex minimum phase digital FIR filters," Acoustics, Speech,
       and Signal Processing, 1999. Proceedings., 1999 IEEE International
       Conference on, Phoenix, AZ, 1999, pp. 1145-1148 vol.3.
       :doi:`10.1109/ICASSP.1999.756179`
.. [2] X. Chen and T. W. Parks, "Design of optimal minimum phase FIR
       filters by direct factorization," Signal Processing,
       vol. 10, no. 4, pp. 369-383, Jun. 1986.
.. [3] T. Saramaki, "Finite Impulse Response Filter Design," in
       Handbook for Digital Signal Processing, chapter 4,
       New York: Wiley-Interscience, 1993.
.. [4] J. S. Lim, Advanced Topics in Signal Processing.
       Englewood Cliffs, N.J.: Prentice Hall, 1988.
.. [5] A. V. Oppenheim, R. W. Schafer, and J. R. Buck,
       "Discrete-Time Signal Processing," 2nd edition.
       Upper Saddle River, N.J.: Prentice Hall, 1999.

Examples
--------
Create an optimal linear-phase filter, then convert it to minimum phase:

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.signal import remez, minimum_phase, freqz, group_delay
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; freq = [0, 0.2, 0.3, 1.0]
&gt;&gt;&gt; desired = [1, 0]
&gt;&gt;&gt; h_linear = remez(151, freq, desired, fs=2.)

Convert it to minimum phase:

&gt;&gt;&gt; h_min_hom = minimum_phase(h_linear, method='homomorphic')
&gt;&gt;&gt; h_min_hil = minimum_phase(h_linear, method='hilbert')

Compare the three filters:

&gt;&gt;&gt; fig, axs = plt.subplots(4, figsize=(4, 8))
&gt;&gt;&gt; for h, style, color in zip((h_linear, h_min_hom, h_min_hil),
...                            ('-', '-', '--'), ('k', 'r', 'c')):
...     w, H = freqz(h)
...     w, gd = group_delay((h, 1))
...     w /= np.pi
...     axs[0].plot(h, color=color, linestyle=style)
...     axs[1].plot(w, np.abs(H), color=color, linestyle=style)
...     axs[2].plot(w, 20 * np.log10(np.abs(H)), color=color, linestyle=style)
...     axs[3].plot(w, gd, color=color, linestyle=style)
&gt;&gt;&gt; for ax in axs:
...     ax.grid(True, color='0.5')
...     ax.fill_between(freq[1:3], *ax.get_ylim(), color='#ffeeaa', zorder=1)
&gt;&gt;&gt; axs[0].set(xlim=[0, len(h_linear) - 1], ylabel='Amplitude', xlabel='Samples')
&gt;&gt;&gt; axs[1].legend(['Linear', 'Min-Hom', 'Min-Hil'], title='Phase')
&gt;&gt;&gt; for ax, ylim in zip(axs[1:], ([0, 1.1], [-150, 10], [-60, 60])):
...     ax.set(xlim=[0, 1], ylim=ylim, xlabel='Frequency')
&gt;&gt;&gt; axs[1].set(ylabel='Magnitude')
&gt;&gt;&gt; axs[2].set(ylabel='Magnitude (dB)')
&gt;&gt;&gt; axs[3].set(ylabel='Group delay')
&gt;&gt;&gt; plt.tight_layout()
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l01121">1121</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

<p class="reference">References <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l01099">_dhtm()</a>.</p>

</div>
</div>
<a id="a909a3ff237b9a0c641ef2dd402a0a7ee" name="a909a3ff237b9a0c641ef2dd402a0a7ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909a3ff237b9a0c641ef2dd402a0a7ee">&#9670;&#160;</a></span>remez()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.signal._fir_filter_design.remez </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>numtaps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>bands</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>desired</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>weight</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>Hz</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>type</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'bandpass'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>maxiter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">25</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>grid_density</em></span><span class="paramdefsep"> = </span><span class="paramdefval">16</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the minimax optimal filter using the Remez exchange algorithm.

Calculate the filter-coefficients for the finite impulse response
(FIR) filter whose transfer function minimizes the maximum error
between the desired gain and the realized gain in the specified
frequency bands using the Remez exchange algorithm.

Parameters
----------
numtaps : int
    The desired number of taps in the filter. The number of taps is
    the number of terms in the filter, or the filter order plus one.
bands : array_like
    A monotonic sequence containing the band edges.
    All elements must be non-negative and less than half the sampling
    frequency as given by `fs`.
desired : array_like
    A sequence half the size of bands containing the desired gain
    in each of the specified bands.
weight : array_like, optional
    A relative weighting to give to each band region. The length of
    `weight` has to be half the length of `bands`.
Hz : scalar, optional, deprecated
    The sampling frequency in Hz. Default is 1.

    .. deprecated:: 1.0.0
       `remez` keyword argument `Hz` is deprecated in favour of `fs` and
       will be removed in SciPy 1.12.0.
type : {'bandpass', 'differentiator', 'hilbert'}, optional
    The type of filter:

      * 'bandpass' : flat response in bands. This is the default.

      * 'differentiator' : frequency proportional response in bands.

      * 'hilbert' : filter with odd symmetry, that is, type III
                    (for even order) or type IV (for odd order)
                    linear phase filters.

maxiter : int, optional
    Maximum number of iterations of the algorithm. Default is 25.
grid_density : int, optional
    Grid density. The dense grid used in `remez` is of size
    ``(numtaps + 1) * grid_density``. Default is 16.
fs : float, optional
    The sampling frequency of the signal.  Default is 1.

Returns
-------
out : ndarray
    A rank-1 array containing the coefficients of the optimal
    (in a minimax sense) filter.

See Also
--------
firls
firwin
firwin2
minimum_phase

References
----------
.. [1] J. H. McClellan and T. W. Parks, "A unified approach to the
       design of optimum FIR linear phase digital filters",
       IEEE Trans. Circuit Theory, vol. CT-20, pp. 697-701, 1973.
.. [2] J. H. McClellan, T. W. Parks and L. R. Rabiner, "A Computer
       Program for Designing Optimum FIR Linear Phase Digital
       Filters", IEEE Trans. Audio Electroacoust., vol. AU-21,
       pp. 506-525, 1973.

Examples
--------
In these examples, `remez` is used to design low-pass, high-pass,
band-pass and band-stop filters.  The parameters that define each filter
are the filter order, the band boundaries, the transition widths of the
boundaries, the desired gains in each band, and the sampling frequency.

We'll use a sample frequency of 22050 Hz in all the examples.  In each
example, the desired gain in each band is either 0 (for a stop band)
or 1 (for a pass band).

`freqz` is used to compute the frequency response of each filter, and
the utility function ``plot_response`` defined below is used to plot
the response.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy import signal
&gt;&gt;&gt; import matplotlib.pyplot as plt

&gt;&gt;&gt; fs = 22050   # Sample rate, Hz

&gt;&gt;&gt; def plot_response(w, h, title):
...     "Utility function to plot response functions"
...     fig = plt.figure()
...     ax = fig.add_subplot(111)
...     ax.plot(w, 20*np.log10(np.abs(h)))
...     ax.set_ylim(-40, 5)
...     ax.grid(True)
...     ax.set_xlabel('Frequency (Hz)')
...     ax.set_ylabel('Gain (dB)')
...     ax.set_title(title)

The first example is a low-pass filter, with cutoff frequency 8 kHz.
The filter length is 325, and the transition width from pass to stop
is 100 Hz.

&gt;&gt;&gt; cutoff = 8000.0    # Desired cutoff frequency, Hz
&gt;&gt;&gt; trans_width = 100  # Width of transition from pass to stop, Hz
&gt;&gt;&gt; numtaps = 325      # Size of the FIR filter.
&gt;&gt;&gt; taps = signal.remez(numtaps, [0, cutoff, cutoff + trans_width, 0.5*fs],
...                     [1, 0], fs=fs)
&gt;&gt;&gt; w, h = signal.freqz(taps, [1], worN=2000, fs=fs)
&gt;&gt;&gt; plot_response(w, h, "Low-pass Filter")
&gt;&gt;&gt; plt.show()

This example shows a high-pass filter:

&gt;&gt;&gt; cutoff = 2000.0    # Desired cutoff frequency, Hz
&gt;&gt;&gt; trans_width = 250  # Width of transition from pass to stop, Hz
&gt;&gt;&gt; numtaps = 125      # Size of the FIR filter.
&gt;&gt;&gt; taps = signal.remez(numtaps, [0, cutoff - trans_width, cutoff, 0.5*fs],
...                     [0, 1], fs=fs)
&gt;&gt;&gt; w, h = signal.freqz(taps, [1], worN=2000, fs=fs)
&gt;&gt;&gt; plot_response(w, h, "High-pass Filter")
&gt;&gt;&gt; plt.show()

This example shows a band-pass filter with a pass-band from 2 kHz to
5 kHz.  The transition width is 260 Hz and the length of the filter
is 63, which is smaller than in the other examples:

&gt;&gt;&gt; band = [2000, 5000]  # Desired pass band, Hz
&gt;&gt;&gt; trans_width = 260    # Width of transition from pass to stop, Hz
&gt;&gt;&gt; numtaps = 63         # Size of the FIR filter.
&gt;&gt;&gt; edges = [0, band[0] - trans_width, band[0], band[1],
...          band[1] + trans_width, 0.5*fs]
&gt;&gt;&gt; taps = signal.remez(numtaps, edges, [0, 1, 0], fs=fs)
&gt;&gt;&gt; w, h = signal.freqz(taps, [1], worN=2000, fs=fs)
&gt;&gt;&gt; plot_response(w, h, "Band-pass Filter")
&gt;&gt;&gt; plt.show()

The low order leads to higher ripple and less steep transitions.

The next example shows a band-stop filter.

&gt;&gt;&gt; band = [6000, 8000]  # Desired stop band, Hz
&gt;&gt;&gt; trans_width = 200    # Width of transition from pass to stop, Hz
&gt;&gt;&gt; numtaps = 175        # Size of the FIR filter.
&gt;&gt;&gt; edges = [0, band[0] - trans_width, band[0], band[1],
...          band[1] + trans_width, 0.5*fs]
&gt;&gt;&gt; taps = signal.remez(numtaps, edges, [1, 0, 1], fs=fs)
&gt;&gt;&gt; w, h = signal.freqz(taps, [1], worN=2000, fs=fs)
&gt;&gt;&gt; plot_response(w, h, "Band-stop Filter")
&gt;&gt;&gt; plt.show()
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00695">695</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7a7427ef2d43c03cef301cd91dd737c4" name="a7a7427ef2d43c03cef301cd91dd737c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a7427ef2d43c03cef301cd91dd737c4">&#9670;&#160;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.signal._fir_filter_design.__all__</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  [<span class="stringliteral">&#39;kaiser_beta&#39;</span>, <span class="stringliteral">&#39;kaiser_atten&#39;</span>, <span class="stringliteral">&#39;kaiserord&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>           <span class="stringliteral">&#39;firwin&#39;</span>, <span class="stringliteral">&#39;firwin2&#39;</span>, <span class="stringliteral">&#39;remez&#39;</span>, <span class="stringliteral">&#39;firls&#39;</span>, <span class="stringliteral">&#39;minimum_phase&#39;</span>]</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html#l00015">15</a> of file <a class="el" href="../../d3/da4/__fir__filter__design_8py_source.html">_fir_filter_design.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/d0f/namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="../../dd/d63/namespacescipy_1_1signal.html">signal</a></li><li class="navelem"><a class="el" href="../../dc/dff/namespacescipy_1_1signal_1_1__fir__filter__design.html">_fir_filter_design</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
