<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: scipy.stats._sensitivity_analysis Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d2/dc3/namespacescipy_1_1stats_1_1__sensitivity__analysis.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._sensitivity_analysis Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/def/classscipy_1_1stats_1_1__sensitivity__analysis_1_1BootstrapSobolResult.html">BootstrapSobolResult</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dfb/classscipy_1_1stats_1_1__sensitivity__analysis_1_1PPFDist.html">PPFDist</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/de7/classscipy_1_1stats_1_1__sensitivity__analysis_1_1SobolResult.html">SobolResult</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef6cd984fce57597e2c6512d9a3e43d2" id="r_aef6cd984fce57597e2c6512d9a3e43d2"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef6cd984fce57597e2c6512d9a3e43d2">f_ishigami</a> (npt.ArrayLike x)</td></tr>
<tr class="separator:aef6cd984fce57597e2c6512d9a3e43d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a4ae12ce501b64edd12f5384277070" id="r_a56a4ae12ce501b64edd12f5384277070"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56a4ae12ce501b64edd12f5384277070">sample_A_B</a> (IntNumber n, list[<a class="el" href="../../d2/dfb/classscipy_1_1stats_1_1__sensitivity__analysis_1_1PPFDist.html">PPFDist</a>] dists, SeedType random_state=None)</td></tr>
<tr class="separator:a56a4ae12ce501b64edd12f5384277070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51768cca60c87e5b5589432418d66b3c" id="r_a51768cca60c87e5b5589432418d66b3c"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51768cca60c87e5b5589432418d66b3c">sample_AB</a> (np.ndarray A, np.ndarray B)</td></tr>
<tr class="separator:a51768cca60c87e5b5589432418d66b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3394b5a581b10a87f91479884fd95a65" id="r_a3394b5a581b10a87f91479884fd95a65"><td class="memItemLeft" align="right" valign="top">tuple[np.ndarray, np.ndarray]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3394b5a581b10a87f91479884fd95a65">saltelli_2010</a> (np.ndarray f_A, np.ndarray f_B, np.ndarray f_AB)</td></tr>
<tr class="separator:a3394b5a581b10a87f91479884fd95a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f7cabcfd790452d50dc83de8ae3377a" id="r_a7f7cabcfd790452d50dc83de8ae3377a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/de7/classscipy_1_1stats_1_1__sensitivity__analysis_1_1SobolResult.html">SobolResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f7cabcfd790452d50dc83de8ae3377a">sobol_indices</a> (*, Callable[[np.ndarray], npt.ArrayLike]|dict[Literal['f_A', 'f_B', 'f_AB'], np.ndarray] func, IntNumber n, list[<a class="el" href="../../d2/dfb/classscipy_1_1stats_1_1__sensitivity__analysis_1_1PPFDist.html">PPFDist</a>]|None dists=None, Callable|Literal['<a class="el" href="#a3394b5a581b10a87f91479884fd95a65">saltelli_2010</a>'] method='<a class="el" href="#a3394b5a581b10a87f91479884fd95a65">saltelli_2010</a>', SeedType random_state=None)</td></tr>
<tr class="separator:a7f7cabcfd790452d50dc83de8ae3377a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad68542b9f3741053b0ab71dde9c102d3" id="r_ad68542b9f3741053b0ab71dde9c102d3"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad68542b9f3741053b0ab71dde9c102d3">__all__</a></td></tr>
<tr class="separator:ad68542b9f3741053b0ab71dde9c102d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aef6cd984fce57597e2c6512d9a3e43d2" name="aef6cd984fce57597e2c6512d9a3e43d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef6cd984fce57597e2c6512d9a3e43d2">&#9670;&#160;</a></span>f_ishigami()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._sensitivity_analysis.f_ishigami </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Ishigami function.

    .. math::

        Y(\mathbf{x}) = \sin x_1 + 7 \sin^2 x_2 + 0.1 x_3^4 \sin x_1

    with :math:`\mathbf{x} \in [-\pi, \pi]^3`.

    Parameters
    ----------
    x : array_like ([x1, x2, x3], n)

    Returns
    -------
    f : array_like (n,)
        Function evaluation.

    References
    ----------
    .. [1] Ishigami, T. and T. Homma. "An importance quantification technique
       in uncertainty analysis for computer models." IEEE,
       :doi:`10.1109/ISUMA.1990.151285`, 1990.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00027">27</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d58/test__sensitivity__analysis_8py_source.html#l00044">scipy.stats.tests.test_sensitivity_analysis.f_ishigami_vec()</a>.</p>

</div>
</div>
<a id="a3394b5a581b10a87f91479884fd95a65" name="a3394b5a581b10a87f91479884fd95a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3394b5a581b10a87f91479884fd95a65">&#9670;&#160;</a></span>saltelli_2010()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[np.ndarray, np.ndarray] scipy.stats._sensitivity_analysis.saltelli_2010 </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>f_A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>f_B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray
</td>          <td class="paramname"><span class="paramname"><em>f_AB</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Saltelli2010 formulation.

.. math::

    S_i = \frac{1}{N} \sum_{j=1}^N
    f(\mathbf{B})_j (f(\mathbf{AB}^{(i)})_j - f(\mathbf{A})_j)

.. math::

    S_{T_i} = \frac{1}{N} \sum_{j=1}^N
    (f(\mathbf{A})_j - f(\mathbf{AB}^{(i)})_j)^2

Parameters
----------
f_A, f_B : array_like (s, n)
    Function values at A and B, respectively
f_AB : array_like (d, s, n)
    Function values at each of the AB pages

Returns
-------
s, st : array_like (s, d)
    First order and total order Sobol' indices.

References
----------
.. [1] Saltelli, A., P. Annoni, I. Azzini, F. Campolongo, M. Ratto, and
   S. Tarantola. "Variance based sensitivity analysis of model
   output. Design and estimator for the total sensitivity index."
   Computer Physics Communications, 181(2):259-270,
   :doi:`10.1016/j.cpc.2009.09.018`, 2010.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00110">110</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

</div>
</div>
<a id="a56a4ae12ce501b64edd12f5384277070" name="a56a4ae12ce501b64edd12f5384277070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a4ae12ce501b64edd12f5384277070">&#9670;&#160;</a></span>sample_A_B()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._sensitivity_analysis.sample_A_B </td>
          <td>(</td>
          <td class="paramtype">IntNumber</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="../../d2/dfb/classscipy_1_1stats_1_1__sensitivity__analysis_1_1PPFDist.html">PPFDist</a>]</td>          <td class="paramname"><span class="paramname"><em>dists</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SeedType </td>          <td class="paramname"><span class="paramname"><em>random_state</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sample two matrices A and B.

Uses a Sobol' sequence with 2`d` columns to have 2 uncorrelated matrices.
This is more efficient than using 2 random draw of Sobol'.
See sec. 5 from [1]_.

Output shape is (d, n).

References
----------
.. [1] Saltelli, A., P. Annoni, I. Azzini, F. Campolongo, M. Ratto, and
   S. Tarantola. "Variance based sensitivity analysis of model
   output. Design and estimator for the total sensitivity index."
   Computer Physics Communications, 181(2):259-270,
   :doi:`10.1016/j.cpc.2009.09.018`, 2010.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00060">60</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00256">sobol_indices()</a>.</p>

</div>
</div>
<a id="a51768cca60c87e5b5589432418d66b3c" name="a51768cca60c87e5b5589432418d66b3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51768cca60c87e5b5589432418d66b3c">&#9670;&#160;</a></span>sample_AB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._sensitivity_analysis.sample_AB </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>B</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">AB matrix.

AB: rows of B into A. Shape (d, d, n).
- Copy A into d "pages"
- In the first page, replace 1st rows of A with 1st row of B.
...
- In the dth page, replace dth row of A with dth row of B.
- return the stack of pages
</pre> 
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00093">93</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00256">sobol_indices()</a>.</p>

</div>
</div>
<a id="a7f7cabcfd790452d50dc83de8ae3377a" name="a7f7cabcfd790452d50dc83de8ae3377a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f7cabcfd790452d50dc83de8ae3377a">&#9670;&#160;</a></span>sobol_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="../../d1/de7/classscipy_1_1stats_1_1__sensitivity__analysis_1_1SobolResult.html">SobolResult</a> scipy.stats._sensitivity_analysis.sobol_indices </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable[[np.ndarray], npt.ArrayLike] |
          dict[Literal['f_A', 'f_B', 'f_AB'], np.ndarray]</td>          <td class="paramname"><span class="paramname"><em>func</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="../../d2/dfb/classscipy_1_1stats_1_1__sensitivity__analysis_1_1PPFDist.html">PPFDist</a>] | None </td>          <td class="paramname"><span class="paramname"><em>dists</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Callable | Literal['<a class="el" href="#a3394b5a581b10a87f91479884fd95a65">saltelli_2010</a>'] </td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'<a class="el" href="#a3394b5a581b10a87f91479884fd95a65">saltelli_2010</a>'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SeedType </td>          <td class="paramname"><span class="paramname"><em>random_state</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Global sensitivity indices of Sobol'.

Parameters
----------
func : callable or dict(str, array_like)
If `func` is a callable, function to compute the Sobol' indices from.
Its signature must be::

    func(x: ArrayLike) -&gt; ArrayLike

with ``x`` of shape ``(d, n)`` and output of shape ``(s, n)`` where:

- ``d`` is the input dimensionality of `func`
  (number of input variables),
- ``s`` is the output dimensionality of `func`
  (number of output variables), and
- ``n`` is the number of samples (see `n` below).

Function evaluation values must be finite.

If `func` is a dictionary, contains the function evaluations from three
different arrays. Keys must be: ``f_A``, ``f_B`` and ``f_AB``.
``f_A`` and ``f_B`` should have a shape ``(s, n)`` and ``f_AB``
should have a shape ``(d, s, n)``.
This is an advanced feature and misuse can lead to wrong analysis.
n : int
Number of samples used to generate the matrices ``A`` and ``B``.
Must be a power of 2. The total number of points at which `func` is
evaluated will be ``n*(d+2)``.
dists : list(distributions), optional
List of each parameter's distribution. The distribution of parameters
depends on the application and should be carefully chosen.
Parameters are assumed to be independently distributed, meaning there
is no constraint nor relationship between their values.

Distributions must be an instance of a class with a ``ppf``
method.

Must be specified if `func` is a callable, and ignored otherwise.
method : Callable or str, default: 'saltelli_2010'
Method used to compute the first and total Sobol' indices.

If a callable, its signature must be::

    func(f_A: np.ndarray, f_B: np.ndarray, f_AB: np.ndarray)
    -&gt; Tuple[np.ndarray, np.ndarray]

with ``f_A, f_B`` of shape ``(s, n)`` and ``f_AB`` of shape
``(d, s, n)``.
These arrays contain the function evaluations from three different sets
of samples.
The output is a tuple of the first and total indices with
shape ``(s, d)``.
This is an advanced feature and misuse can lead to wrong analysis.
random_state : {None, int, `numpy.random.Generator`}, optional
If `random_state` is an int or None, a new `numpy.random.Generator` is
created using ``np.random.default_rng(random_state)``.
If `random_state` is already a ``Generator`` instance, then the
provided instance is used.

Returns
-------
res : SobolResult
An object with attributes:

first_order : ndarray of shape (s, d)
    First order Sobol' indices.
total_order : ndarray of shape (s, d)
    Total order Sobol' indices.

And method:

bootstrap(confidence_level: float, n_resamples: int)
-&gt; BootstrapSobolResult

    A method providing confidence intervals on the indices.
    See `scipy.stats.bootstrap` for more details.

    The bootstrapping is done on both first and total order indices,
    and they are available in `BootstrapSobolResult` as attributes
    ``first_order`` and ``total_order``.

Notes
-----
The Sobol' method [1]_, [2]_ is a variance-based Sensitivity Analysis which
obtains the contribution of each parameter to the variance of the
quantities of interest (QoIs; i.e., the outputs of `func`).
Respective contributions can be used to rank the parameters and
also gauge the complexity of the model by computing the
model's effective (or mean) dimension.

.. note::

Parameters are assumed to be independently distributed. Each
parameter can still follow any distribution. In fact, the distribution
is very important and should match the real distribution of the
parameters.

It uses a functional decomposition of the variance of the function to
explore

.. math::

\mathbb{V}(Y) = \sum_{i}^{d} \mathbb{V}_i (Y) + \sum_{i&lt;j}^{d}
\mathbb{V}_{ij}(Y) + ... + \mathbb{V}_{1,2,...,d}(Y),

introducing conditional variances:

.. math::

\mathbb{V}_i(Y) = \mathbb{\mathbb{V}}[\mathbb{E}(Y|x_i)]
\qquad
\mathbb{V}_{ij}(Y) = \mathbb{\mathbb{V}}[\mathbb{E}(Y|x_i x_j)]
- \mathbb{V}_i(Y) - \mathbb{V}_j(Y),

Sobol' indices are expressed as

.. math::

S_i = \frac{\mathbb{V}_i(Y)}{\mathbb{V}[Y]}
\qquad
S_{ij} =\frac{\mathbb{V}_{ij}(Y)}{\mathbb{V}[Y]}.

:math:`S_{i}` corresponds to the first-order term which apprises the
contribution of the i-th parameter, while :math:`S_{ij}` corresponds to the
second-order term which informs about the contribution of interactions
between the i-th and the j-th parameters. These equations can be
generalized to compute higher order terms; however, they are expensive to
compute and their interpretation is complex.
This is why only first order indices are provided.

Total order indices represent the global contribution of the parameters
to the variance of the QoI and are defined as:

.. math::

S_{T_i} = S_i + \sum_j S_{ij} + \sum_{j,k} S_{ijk} + ...
= 1 - \frac{\mathbb{V}[\mathbb{E}(Y|x_{\sim i})]}{\mathbb{V}[Y]}.

First order indices sum to at most 1, while total order indices sum to at
least 1. If there are no interactions, then first and total order indices
are equal, and both first and total order indices sum to 1.

.. warning::

Negative Sobol' values are due to numerical errors. Increasing the
number of points `n` should help.

The number of sample required to have a good analysis increases with
the dimensionality of the problem. e.g. for a 3 dimension problem,
consider at minima ``n &gt;= 2**12``. The more complex the model is,
the more samples will be needed.

Even for a purely addiditive model, the indices may not sum to 1 due
to numerical noise.

References
----------
.. [1] Sobol, I. M.. "Sensitivity analysis for nonlinear mathematical
models." Mathematical Modeling and Computational Experiment, 1:407-414,
1993.
.. [2] Sobol, I. M. (2001). "Global sensitivity indices for nonlinear
mathematical models and their Monte Carlo estimates." Mathematics
and Computers in Simulation, 55(1-3):271-280,
:doi:`10.1016/S0378-4754(00)00270-6`, 2001.
.. [3] Saltelli, A. "Making best use of model evaluations to
compute sensitivity indices."  Computer Physics Communications,
145(2):280-297, :doi:`10.1016/S0010-4655(02)00280-1`, 2002.
.. [4] Saltelli, A., M. Ratto, T. Andres, F. Campolongo, J. Cariboni,
D. Gatelli, M. Saisana, and S. Tarantola. "Global Sensitivity Analysis.
The Primer." 2007.
.. [5] Saltelli, A., P. Annoni, I. Azzini, F. Campolongo, M. Ratto, and
S. Tarantola. "Variance based sensitivity analysis of model
output. Design and estimator for the total sensitivity index."
Computer Physics Communications, 181(2):259-270,
:doi:`10.1016/j.cpc.2009.09.018`, 2010.
.. [6] Ishigami, T. and T. Homma. "An importance quantification technique
in uncertainty analysis for computer models." IEEE,
:doi:`10.1109/ISUMA.1990.151285`, 1990.

Examples
--------
The following is an example with the Ishigami function [6]_

.. math::

Y(\mathbf{x}) = \sin x_1 + 7 \sin^2 x_2 + 0.1 x_3^4 \sin x_1,

with :math:`\mathbf{x} \in [-\pi, \pi]^3`. This function exhibits strong
non-linearity and non-monotonicity.

Remember, Sobol' indices assumes that samples are independently
distributed. In this case we use a uniform distribution on each marginals.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.stats import sobol_indices, uniform
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; def f_ishigami(x):
...     f_eval = (
...         np.sin(x[0])
...         + 7 * np.sin(x[1])**2
...         + 0.1 * (x[2]**4) * np.sin(x[0])
...     )
...     return f_eval
&gt;&gt;&gt; indices = sobol_indices(
...     func=f_ishigami, n=1024,
...     dists=[
...         uniform(loc=-np.pi, scale=2*np.pi),
...         uniform(loc=-np.pi, scale=2*np.pi),
...         uniform(loc=-np.pi, scale=2*np.pi)
...     ],
...     random_state=rng
... )
&gt;&gt;&gt; indices.first_order
array([0.31637954, 0.43781162, 0.00318825])
&gt;&gt;&gt; indices.total_order
array([0.56122127, 0.44287857, 0.24229595])

Confidence interval can be obtained using bootstrapping.

&gt;&gt;&gt; boot = indices.bootstrap()

Then, this information can be easily visualized.

&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; fig, axs = plt.subplots(1, 2, figsize=(9, 4))
&gt;&gt;&gt; _ = axs[0].errorbar(
...     [1, 2, 3], indices.first_order, fmt='o',
...     yerr=[
...         indices.first_order - boot.first_order.confidence_interval.low,
...         boot.first_order.confidence_interval.high - indices.first_order
...     ],
... )
&gt;&gt;&gt; axs[0].set_ylabel("First order Sobol' indices")
&gt;&gt;&gt; axs[0].set_xlabel('Input parameters')
&gt;&gt;&gt; axs[0].set_xticks([1, 2, 3])
&gt;&gt;&gt; _ = axs[1].errorbar(
...     [1, 2, 3], indices.total_order, fmt='o',
...     yerr=[
...         indices.total_order - boot.total_order.confidence_interval.low,
...         boot.total_order.confidence_interval.high - indices.total_order
...     ],
... )
&gt;&gt;&gt; axs[1].set_ylabel("Total order Sobol' indices")
&gt;&gt;&gt; axs[1].set_xlabel('Input parameters')
&gt;&gt;&gt; axs[1].set_xticks([1, 2, 3])
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()

.. note::

By default, `scipy.stats.uniform` has support ``[0, 1]``.
Using the parameters ``loc`` and ``scale``, one obtains the uniform
distribution on ``[loc, loc + scale]``.

This result is particularly interesting because the first order index
:math:`S_{x_3} = 0` whereas its total order is :math:`S_{T_{x_3}} = 0.244`.
This means that higher order interactions with :math:`x_3` are responsible
for the difference. Almost 25% of the observed variance
on the QoI is due to the correlations between :math:`x_3` and :math:`x_1`,
although :math:`x_3` by itself has no impact on the QoI.

The following gives a visual explanation of Sobol' indices on this
function. Let's generate 1024 samples in :math:`[-\pi, \pi]^3` and
calculate the value of the output.

&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; n_dim = 3
&gt;&gt;&gt; p_labels = ['$x_1$', '$x_2$', '$x_3$']
&gt;&gt;&gt; sample = qmc.Sobol(d=n_dim, seed=rng).random(1024)
&gt;&gt;&gt; sample = qmc.scale(
...     sample=sample,
...     l_bounds=[-np.pi, -np.pi, -np.pi],
...     u_bounds=[np.pi, np.pi, np.pi]
... )
&gt;&gt;&gt; output = f_ishigami(sample.T)

Now we can do scatter plots of the output with respect to each parameter.
This gives a visual way to understand how each parameter impacts the
output of the function.

&gt;&gt;&gt; fig, ax = plt.subplots(1, n_dim, figsize=(12, 4))
&gt;&gt;&gt; for i in range(n_dim):
...     xi = sample[:, i]
...     ax[i].scatter(xi, output, marker='+')
...     ax[i].set_xlabel(p_labels[i])
&gt;&gt;&gt; ax[0].set_ylabel('Y')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()

Now Sobol' goes a step further:
by conditioning the output value by given values of the parameter
(black lines), the conditional output mean is computed. It corresponds to
the term :math:`\mathbb{E}(Y|x_i)`. Taking the variance of this term gives
the numerator of the Sobol' indices.

&gt;&gt;&gt; mini = np.min(output)
&gt;&gt;&gt; maxi = np.max(output)
&gt;&gt;&gt; n_bins = 10
&gt;&gt;&gt; bins = np.linspace(-np.pi, np.pi, num=n_bins, endpoint=False)
&gt;&gt;&gt; dx = bins[1] - bins[0]
&gt;&gt;&gt; fig, ax = plt.subplots(1, n_dim, figsize=(12, 4))
&gt;&gt;&gt; for i in range(n_dim):
...     xi = sample[:, i]
...     ax[i].scatter(xi, output, marker='+')
...     ax[i].set_xlabel(p_labels[i])
...     for bin_ in bins:
...         idx = np.where((bin_ &lt;= xi) &amp; (xi &lt;= bin_ + dx))
...         xi_ = xi[idx]
...         y_ = output[idx]
...         ave_y_ = np.mean(y_)
...         ax[i].plot([bin_ + dx/2] * 2, [mini, maxi], c='k')
...         ax[i].scatter(bin_ + dx/2, ave_y_, c='r')
&gt;&gt;&gt; ax[0].set_ylabel('Y')
&gt;&gt;&gt; plt.tight_layout()
&gt;&gt;&gt; plt.show()

Looking at :math:`x_3`, the variance
of the mean is zero leading to :math:`S_{x_3} = 0`. But we can further
observe that the variance of the output is not constant along the parameter
values of :math:`x_3`. This heteroscedasticity is explained by higher order
interactions. Moreover, an heteroscedasticity is also noticeable on
:math:`x_1` leading to an interaction between :math:`x_3` and :math:`x_1`.
On :math:`x_2`, the variance seems to be constant and thus null interaction
with this parameter can be supposed.

This case is fairly simple to analyse visually---although it is only a
qualitative analysis. Nevertheless, when the number of input parameters
increases such analysis becomes unrealistic as it would be difficult to
conclude on high-order terms. Hence the benefit of using Sobol' indices.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00248">248</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

<p class="reference">References <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00064">sample_A_B()</a>, and <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00093">sample_AB()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad68542b9f3741053b0ab71dde9c102d3" name="ad68542b9f3741053b0ab71dde9c102d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad68542b9f3741053b0ab71dde9c102d3">&#9670;&#160;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.stats._sensitivity_analysis.__all__</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  [</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&#39;sobol_indices&#39;</span></div>
<div class="line"><span class="lineno">    3</span>]</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html#l00022">22</a> of file <a class="el" href="../../db/d1e/__sensitivity__analysis_8py_source.html">_sensitivity_analysis.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/d0f/namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="../../d0/df6/namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="../../d2/dc3/namespacescipy_1_1stats_1_1__sensitivity__analysis.html">_sensitivity_analysis</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
