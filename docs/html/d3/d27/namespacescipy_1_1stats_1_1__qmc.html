<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: scipy.stats._qmc Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d3/d27/namespacescipy_1_1stats_1_1__qmc.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._qmc Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d33/classscipy_1_1stats_1_1__qmc_1_1Halton.html">Halton</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dcf/classscipy_1_1stats_1_1__qmc_1_1LatinHypercube.html">LatinHypercube</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dcb/classscipy_1_1stats_1_1__qmc_1_1MultinomialQMC.html">MultinomialQMC</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d4e/classscipy_1_1stats_1_1__qmc_1_1MultivariateNormalQMC.html">MultivariateNormalQMC</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db0/classscipy_1_1stats_1_1__qmc_1_1PoissonDisk.html">PoissonDisk</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de6/classscipy_1_1stats_1_1__qmc_1_1QMCEngine.html">QMCEngine</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d58/classscipy_1_1stats_1_1__qmc_1_1Sobol.html">Sobol</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a99530aabb901c029b9c24e5cc9f0f5ec" id="r_a99530aabb901c029b9c24e5cc9f0f5ec"><td class="memItemLeft" align="right" valign="top">np.random.Generator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99530aabb901c029b9c24e5cc9f0f5ec">check_random_state</a> (IntNumber|None seed=...)</td></tr>
<tr class="separator:a99530aabb901c029b9c24e5cc9f0f5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2c5dc8605784ba0fdf9936b59df395" id="r_a2f2c5dc8605784ba0fdf9936b59df395"><td class="memItemLeft" align="right" valign="top">GeneratorType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f2c5dc8605784ba0fdf9936b59df395">check_random_state</a> (GeneratorType seed)</td></tr>
<tr class="separator:a2f2c5dc8605784ba0fdf9936b59df395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af3e5c60b0fbc5c4d257feb9e2a9423" id="r_a1af3e5c60b0fbc5c4d257feb9e2a9423"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1af3e5c60b0fbc5c4d257feb9e2a9423">check_random_state</a> (seed=None)</td></tr>
<tr class="separator:a1af3e5c60b0fbc5c4d257feb9e2a9423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76f690673ebcc776891798b0e128d4a" id="r_ae76f690673ebcc776891798b0e128d4a"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae76f690673ebcc776891798b0e128d4a">scale</a> (npt.ArrayLike sample, npt.ArrayLike l_bounds, npt.ArrayLike u_bounds, *, bool reverse=False)</td></tr>
<tr class="separator:ae76f690673ebcc776891798b0e128d4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bba96ae85ce5dcf83d9960340b9298c" id="r_a9bba96ae85ce5dcf83d9960340b9298c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9bba96ae85ce5dcf83d9960340b9298c">discrepancy</a> (npt.ArrayLike sample, *, bool iterative=False, Literal[&quot;CD&quot;, &quot;WD&quot;, &quot;MD&quot;, &quot;L2-star&quot;] method=&quot;CD&quot;, IntNumber workers=1)</td></tr>
<tr class="separator:a9bba96ae85ce5dcf83d9960340b9298c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33205602634d9d5ce04705a48d798551" id="r_a33205602634d9d5ce04705a48d798551"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33205602634d9d5ce04705a48d798551">update_discrepancy</a> (npt.ArrayLike x_new, npt.ArrayLike sample, DecimalNumber initial_disc)</td></tr>
<tr class="separator:a33205602634d9d5ce04705a48d798551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c28a8dac5cfeaeacca8c1cf345f9b05" id="r_a5c28a8dac5cfeaeacca8c1cf345f9b05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c28a8dac5cfeaeacca8c1cf345f9b05">_perturb_discrepancy</a> (np.ndarray sample, int i1, int i2, int k, float disc)</td></tr>
<tr class="separator:a5c28a8dac5cfeaeacca8c1cf345f9b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73db6f8ac0e878841d09657004b0649c" id="r_a73db6f8ac0e878841d09657004b0649c"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73db6f8ac0e878841d09657004b0649c">primes_from_2_to</a> (int n)</td></tr>
<tr class="separator:a73db6f8ac0e878841d09657004b0649c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2a87897d180c083d702531cdca44cf" id="r_a4a2a87897d180c083d702531cdca44cf"><td class="memItemLeft" align="right" valign="top">list[int]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a2a87897d180c083d702531cdca44cf">n_primes</a> (IntNumber n)</td></tr>
<tr class="separator:a4a2a87897d180c083d702531cdca44cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2dadc825d19fe30b9e0ab9f0c35df3" id="r_aac2dadc825d19fe30b9e0ab9f0c35df3"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac2dadc825d19fe30b9e0ab9f0c35df3">_van_der_corput_permutations</a> (IntNumber base, *, SeedType random_state=None)</td></tr>
<tr class="separator:aac2dadc825d19fe30b9e0ab9f0c35df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c0482d0724d18fd957cd241692c0b2" id="r_a43c0482d0724d18fd957cd241692c0b2"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43c0482d0724d18fd957cd241692c0b2">van_der_corput</a> (IntNumber n, IntNumber base=2, *, IntNumber start_index=0, bool scramble=False, npt.ArrayLike|None permutations=None, SeedType seed=None, IntNumber workers=1)</td></tr>
<tr class="separator:a43c0482d0724d18fd957cd241692c0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f12c2d08735f2790606871d9c479dfb" id="r_a4f12c2d08735f2790606871d9c479dfb"><td class="memItemLeft" align="right" valign="top">Callable|None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f12c2d08735f2790606871d9c479dfb">_select_optimizer</a> (Literal[&quot;random-cd&quot;, &quot;lloyd&quot;]|None optimization, dict config)</td></tr>
<tr class="separator:a4f12c2d08735f2790606871d9c479dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a6cb5783a79ae04ed930416584199f1" id="r_a7a6cb5783a79ae04ed930416584199f1"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a6cb5783a79ae04ed930416584199f1">_random_cd</a> (np.ndarray best_sample, int n_iters, int n_nochange, GeneratorType rng, **dict kwargs)</td></tr>
<tr class="separator:a7a6cb5783a79ae04ed930416584199f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1560e2d0fcca8df9754edd2c64589cf6" id="r_a1560e2d0fcca8df9754edd2c64589cf6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1560e2d0fcca8df9754edd2c64589cf6">_l1_norm</a> (np.ndarray sample)</td></tr>
<tr class="separator:a1560e2d0fcca8df9754edd2c64589cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939675ced92e21d78912310257cf3708" id="r_a939675ced92e21d78912310257cf3708"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a939675ced92e21d78912310257cf3708">_lloyd_iteration</a> (np.ndarray sample, float decay, str qhull_options)</td></tr>
<tr class="separator:a939675ced92e21d78912310257cf3708"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890631119b89c4f4f62bb023ad6c60f1" id="r_a890631119b89c4f4f62bb023ad6c60f1"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a890631119b89c4f4f62bb023ad6c60f1">_lloyd_centroidal_voronoi_tessellation</a> (npt.ArrayLike sample, *, DecimalNumber tol=1e-5, IntNumber maxiter=10, str|None qhull_options=None, **dict kwargs)</td></tr>
<tr class="separator:a890631119b89c4f4f62bb023ad6c60f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50556dec8eaef56be3606788d98bd945" id="r_a50556dec8eaef56be3606788d98bd945"><td class="memItemLeft" align="right" valign="top">IntNumber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50556dec8eaef56be3606788d98bd945">_validate_workers</a> (IntNumber workers=1)</td></tr>
<tr class="separator:a50556dec8eaef56be3606788d98bd945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c10cc54f2dedf13beea8285ed2fe079" id="r_a8c10cc54f2dedf13beea8285ed2fe079"><td class="memItemLeft" align="right" valign="top">tuple[np.ndarray,...]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c10cc54f2dedf13beea8285ed2fe079">_validate_bounds</a> (npt.ArrayLike l_bounds, npt.ArrayLike u_bounds, int d)</td></tr>
<tr class="separator:a8c10cc54f2dedf13beea8285ed2fe079"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a70091f28f1441e9df78adfb2a6c2e02b" id="r_a70091f28f1441e9df78adfb2a6c2e02b"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70091f28f1441e9df78adfb2a6c2e02b">__all__</a></td></tr>
<tr class="separator:a70091f28f1441e9df78adfb2a6c2e02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Quasi-Monte Carlo engines and helpers.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1560e2d0fcca8df9754edd2c64589cf6" name="a1560e2d0fcca8df9754edd2c64589cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1560e2d0fcca8df9754edd2c64589cf6">&#9670;&#160;</a></span>_l1_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc._l1_norm </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>sample</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02373">2373</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a890631119b89c4f4f62bb023ad6c60f1" name="a890631119b89c4f4f62bb023ad6c60f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a890631119b89c4f4f62bb023ad6c60f1">&#9670;&#160;</a></span>_lloyd_centroidal_voronoi_tessellation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc._lloyd_centroidal_voronoi_tessellation </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DecimalNumber </td>          <td class="paramname"><span class="paramname"><em>tol</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1e-5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>maxiter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">10</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>qhull_options</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**dict
</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Approximate Centroidal Voronoi Tessellation.

Perturb samples in N-dimensions using Lloyd-Max algorithm.

Parameters
----------
sample : array_like (n, d)
    The sample to iterate on. With ``n`` the number of samples and ``d``
    the dimension. Samples must be in :math:`[0, 1]^d`, with ``d&gt;=2``.
tol : float, optional
    Tolerance for termination. If the min of the L1-norm over the samples
    changes less than `tol`, it stops the algorithm. Default is 1e-5.
maxiter : int, optional
    Maximum number of iterations. It will stop the algorithm even if
    `tol` is above the threshold.
    Too many iterations tend to cluster the samples as a hypersphere.
    Default is 10.
qhull_options : str, optional
    Additional options to pass to Qhull. See Qhull manual
    for details. (Default: "Qbb Qc Qz Qj Qx" for ndim &gt; 4 and
    "Qbb Qc Qz Qj" otherwise.)

Returns
-------
sample : array_like (n, d)
    The sample after being processed by Lloyd-Max algorithm.

Notes
-----
Lloyd-Max algorithm is an iterative process with the purpose of improving
the dispersion of samples. For given sample: (i) compute a Voronoi
Tessellation; (ii) find the centroid of each Voronoi cell; (iii) move the
samples toward the centroid of their respective cell. See [1]_, [2]_.

A relaxation factor is used to control how fast samples can move at each
iteration. This factor is starting at 2 and ending at 1 after `maxiter`
following an exponential decay.

The process converges to equally spaced samples. It implies that measures
like the discrepancy could suffer from too many iterations. On the other
hand, L1 and L2 distances should improve. This is especially true with
QMC methods which tend to favor the discrepancy over other criteria.

.. note::

    The current implementation does not intersect the Voronoi Tessellation
    with the boundaries. This implies that for a low number of samples,
    empirically below 20, no Voronoi cell is touching the boundaries.
    Hence, samples cannot be moved close to the boundaries.

    Further improvements could consider the samples at infinity so that
    all boundaries are segments of some Voronoi cells. This would fix
    the computation of the centroid position.

.. warning::

   The Voronoi Tessellation step is expensive and quickly becomes
   intractable with dimensions as low as 10 even for a sample
   of size as low as 1000.

.. versionadded:: 1.9.0

References
----------
.. [1] Lloyd. "Least Squares Quantization in PCM".
   IEEE Transactions on Information Theory, 1982.
.. [2] Max J. "Quantizing for minimum distortion".
   IEEE Transactions on Information Theory, 1960.

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.spatial import distance
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; sample = rng.random((128, 2))

.. note::

    The samples need to be in :math:`[0, 1]^d`. `scipy.stats.qmc.scale`
    can be used to scale the samples from their
    original bounds to :math:`[0, 1]^d`. And back to their original bounds.

Compute the quality of the sample using the L1 criterion.

&gt;&gt;&gt; def l1_norm(sample):
...    return distance.pdist(sample, 'cityblock').min()

&gt;&gt;&gt; l1_norm(sample)
0.00161...  # random

Now process the sample using Lloyd's algorithm and check the improvement
on the L1. The value should increase.

&gt;&gt;&gt; sample = _lloyd_centroidal_voronoi_tessellation(sample)
&gt;&gt;&gt; l1_norm(sample)
0.0278...  # random
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02441">2441</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02381">_lloyd_iteration()</a>.</p>

</div>
</div>
<a id="a939675ced92e21d78912310257cf3708" name="a939675ced92e21d78912310257cf3708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939675ced92e21d78912310257cf3708">&#9670;&#160;</a></span>_lloyd_iteration()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc._lloyd_iteration </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>decay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str
</td>          <td class="paramname"><span class="paramname"><em>qhull_options</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Lloyd-Max algorithm iteration.

Based on the implementation of Stéfan van der Walt:

https://github.com/stefanv/lloyd

which is:

    Copyright (c) 2021-04-21 Stéfan van der Walt
    https://github.com/stefanv/lloyd
    MIT License

Parameters
----------
sample : array_like (n, d)
    The sample to iterate on.
decay : float
    Relaxation decay. A positive value would move the samples toward
    their centroid, and negative value would move them away.
    1 would move the samples to their centroid.
qhull_options : str
    Additional options to pass to Qhull. See Qhull manual
    for details. (Default: "Qbb Qc Qz Qj Qx" for ndim &gt; 4 and
    "Qbb Qc Qz Qj" otherwise.)

Returns
-------
sample : array_like (n, d)
    The sample after an iteration of Lloyd's algorithm.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02377">2377</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02448">_lloyd_centroidal_voronoi_tessellation()</a>.</p>

</div>
</div>
<a id="a5c28a8dac5cfeaeacca8c1cf345f9b05" name="a5c28a8dac5cfeaeacca8c1cf345f9b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c28a8dac5cfeaeacca8c1cf345f9b05">&#9670;&#160;</a></span>_perturb_discrepancy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._qmc._perturb_discrepancy </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>disc</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Centered discrepancy after an elementary perturbation of a LHS.

An elementary perturbation consists of an exchange of coordinates between
two points: ``sample[i1, k] &lt;-&gt; sample[i2, k]``. By construction,
this operation conserves the LHS properties.

Parameters
----------
sample : array_like (n, d)
    The sample (before permutation) to compute the discrepancy from.
i1 : int
    The first line of the elementary permutation.
i2 : int
    The second line of the elementary permutation.
k : int
    The column of the elementary permutation.
disc : float
    Centered discrepancy of the design before permutation.

Returns
-------
discrepancy : float
    Centered discrepancy of the design after permutation.

References
----------
.. [1] Jin et al. "An efficient algorithm for constructing optimal design
   of computer experiments", Journal of Statistical Planning and
   Inference, 2005.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00370">370</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02321">_random_cd()</a>.</p>

</div>
</div>
<a id="a7a6cb5783a79ae04ed930416584199f1" name="a7a6cb5783a79ae04ed930416584199f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a6cb5783a79ae04ed930416584199f1">&#9670;&#160;</a></span>_random_cd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc._random_cd </td>
          <td>(</td>
          <td class="paramtype">np.ndarray</td>          <td class="paramname"><span class="paramname"><em>best_sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_iters</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_nochange</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GeneratorType</td>          <td class="paramname"><span class="paramname"><em>rng</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**dict
</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Optimal LHS on CD.

Create a base LHS and do random permutations of coordinates to
lower the centered discrepancy.
Because it starts with a normal LHS, it also works with the
`centered` keyword argument.

Two stopping criterion are used to stop the algorithm: at most,
`n_iters` iterations are performed; or if there is no improvement
for `n_nochange` consecutive iterations.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02318">2318</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00371">_perturb_discrepancy()</a>, and <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00176">discrepancy()</a>.</p>

</div>
</div>
<a id="a4f12c2d08735f2790606871d9c479dfb" name="a4f12c2d08735f2790606871d9c479dfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f12c2d08735f2790606871d9c479dfb">&#9670;&#160;</a></span>_select_optimizer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> Callable | None scipy.stats._qmc._select_optimizer </td>
          <td>(</td>
          <td class="paramtype">Literal[&quot;random-cd&quot;, &quot;lloyd&quot;] | None</td>          <td class="paramname"><span class="paramname"><em>optimization</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict
</td>          <td class="paramname"><span class="paramname"><em>config</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">A factory for optimization methods.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02290">2290</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a8c10cc54f2dedf13beea8285ed2fe079" name="a8c10cc54f2dedf13beea8285ed2fe079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c10cc54f2dedf13beea8285ed2fe079">&#9670;&#160;</a></span>_validate_bounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[np.ndarray, ...] scipy.stats._qmc._validate_bounds </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>l_bounds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>u_bounds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int
</td>          <td class="paramname"><span class="paramname"><em>d</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Bounds input validation.

Parameters
----------
l_bounds, u_bounds : array_like (d,)
    Lower and upper bounds.
d : int
    Dimension to use for broadcasting.

Returns
-------
l_bounds, u_bounds : array_like (d,)
    Lower and upper bounds.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02620">2620</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00094">scale()</a>.</p>

</div>
</div>
<a id="a50556dec8eaef56be3606788d98bd945" name="a50556dec8eaef56be3606788d98bd945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50556dec8eaef56be3606788d98bd945">&#9670;&#160;</a></span>_validate_workers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> IntNumber scipy.stats._qmc._validate_workers </td>
          <td>(</td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>workers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Validate `workers` based on platform and value.

Parameters
----------
workers : int, optional
    Number of workers to use for parallel processing. If -1 is
    given all CPU threads are used. Default is 1.

Returns
-------
Workers : int
    Number of CPU used by the algorithm
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02590">2590</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l01053">scipy.stats._qmc.Halton._random()</a>, and <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00176">discrepancy()</a>.</p>

</div>
</div>
<a id="aac2dadc825d19fe30b9e0ab9f0c35df3" name="aac2dadc825d19fe30b9e0ab9f0c35df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac2dadc825d19fe30b9e0ab9f0c35df3">&#9670;&#160;</a></span>_van_der_corput_permutations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc._van_der_corput_permutations </td>
          <td>(</td>
          <td class="paramtype">IntNumber</td>          <td class="paramname"><span class="paramname"><em>base</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SeedType </td>          <td class="paramname"><span class="paramname"><em>random_state</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Permutations for scrambling a Van der Corput sequence.

Parameters
----------
base : int
    Base of the sequence.
random_state : {None, int, `numpy.random.Generator`}, optional
    If `seed` is an int or None, a new `numpy.random.Generator` is
    created using ``np.random.default_rng(seed)``.
    If `seed` is already a ``Generator`` instance, then the provided
    instance is used.

Returns
-------
permutations : array_like
    Permutation indices.

Notes
-----
In Algorithm 1 of Owen 2017, a permutation of `np.arange(base)` is
created for each positive integer `k` such that `1 - base**-k &lt; 1`
using floating-point arithmetic. For double precision floats, the
condition `1 - base**-k &lt; 1` can also be written as `base**-k &gt;
2**-54`, which makes it more apparent how many permutations we need
to create.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00531">531</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l01037">scipy.stats._qmc.Halton._initialize_permutations()</a>, and <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00577">van_der_corput()</a>.</p>

</div>
</div>
<a id="a2f2c5dc8605784ba0fdf9936b59df395" name="a2f2c5dc8605784ba0fdf9936b59df395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f2c5dc8605784ba0fdf9936b59df395">&#9670;&#160;</a></span>check_random_state() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> GeneratorType scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype">GeneratorType</td>          <td class="paramname"><span class="paramname"><em>seed</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00057">57</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a99530aabb901c029b9c24e5cc9f0f5ec" name="a99530aabb901c029b9c24e5cc9f0f5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99530aabb901c029b9c24e5cc9f0f5ec">&#9670;&#160;</a></span>check_random_state() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.random.Generator scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype">IntNumber | None </td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00052">52</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a1af3e5c60b0fbc5c4d257feb9e2a9423" name="a1af3e5c60b0fbc5c4d257feb9e2a9423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af3e5c60b0fbc5c4d257feb9e2a9423">&#9670;&#160;</a></span>check_random_state() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Turn `seed` into a `numpy.random.Generator` instance.

Parameters
----------
seed : {None, int, `numpy.random.Generator`, `numpy.random.RandomState`}, optional  # noqa
    If `seed` is an int or None, a new `numpy.random.Generator` is
    created using ``np.random.default_rng(seed)``.
    If `seed` is already a ``Generator`` or ``RandomState`` instance, then
    the provided instance is used.

Returns
-------
seed : {`numpy.random.Generator`, `numpy.random.RandomState`}
    Random number generator.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00062">62</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a9bba96ae85ce5dcf83d9960340b9298c" name="a9bba96ae85ce5dcf83d9960340b9298c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bba96ae85ce5dcf83d9960340b9298c">&#9670;&#160;</a></span>discrepancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc.discrepancy </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>iterative</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Literal[&quot;CD&quot;, &quot;WD&quot;, &quot;MD&quot;, &quot;L2-star&quot;] </td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval">&quot;CD&quot;</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>workers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Discrepancy of a given sample.

Parameters
----------
sample : array_like (n, d)
    The sample to compute the discrepancy from.
iterative : bool, optional
    Must be False if not using it for updating the discrepancy.
    Default is False. Refer to the notes for more details.
method : str, optional
    Type of discrepancy, can be ``CD``, ``WD``, ``MD`` or ``L2-star``.
    Refer to the notes for more details. Default is ``CD``.
workers : int, optional
    Number of workers to use for parallel processing. If -1 is given all
    CPU threads are used. Default is 1.

Returns
-------
discrepancy : float
    Discrepancy.

Notes
-----
The discrepancy is a uniformity criterion used to assess the space filling
of a number of samples in a hypercube. A discrepancy quantifies the
distance between the continuous uniform distribution on a hypercube and the
discrete uniform distribution on :math:`n` distinct sample points.

The lower the value is, the better the coverage of the parameter space is.

For a collection of subsets of the hypercube, the discrepancy is the
difference between the fraction of sample points in one of those
subsets and the volume of that subset. There are different definitions of
discrepancy corresponding to different collections of subsets. Some
versions take a root mean square difference over subsets instead of
a maximum.

A measure of uniformity is reasonable if it satisfies the following
criteria [1]_:

1. It is invariant under permuting factors and/or runs.
2. It is invariant under rotation of the coordinates.
3. It can measure not only uniformity of the sample over the hypercube,
   but also the projection uniformity of the sample over non-empty
   subset of lower dimension hypercubes.
4. There is some reasonable geometric meaning.
5. It is easy to compute.
6. It satisfies the Koksma-Hlawka-like inequality.
7. It is consistent with other criteria in experimental design.

Four methods are available:

* ``CD``: Centered Discrepancy - subspace involves a corner of the
  hypercube
* ``WD``: Wrap-around Discrepancy - subspace can wrap around bounds
* ``MD``: Mixture Discrepancy - mix between CD/WD covering more criteria
* ``L2-star``: L2-star discrepancy - like CD BUT variant to rotation

See [2]_ for precise definitions of each method.

Lastly, using ``iterative=True``, it is possible to compute the
discrepancy as if we had :math:`n+1` samples. This is useful if we want
to add a point to a sampling and check the candidate which would give the
lowest discrepancy. Then you could just update the discrepancy with
each candidate using `update_discrepancy`. This method is faster than
computing the discrepancy for a large number of candidates.

References
----------
.. [1] Fang et al. "Design and modeling for computer experiments".
   Computer Science and Data Analysis Series, 2006.
.. [2] Zhou Y.-D. et al. "Mixture discrepancy for quasi-random point sets."
   Journal of Complexity, 29 (3-4) , pp. 283-301, 2013.
.. [3] T. T. Warnock. "Computational investigations of low discrepancy
   point sets." Applications of Number Theory to Numerical
   Analysis, Academic Press, pp. 319-343, 1972.

Examples
--------
Calculate the quality of the sample using the discrepancy:

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])
&gt;&gt;&gt; l_bounds = [0.5, 0.5]
&gt;&gt;&gt; u_bounds = [6.5, 6.5]
&gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; space
array([[0.08333333, 0.41666667],
       [0.25      , 0.91666667],
       [0.41666667, 0.25      ],
       [0.58333333, 0.75      ],
       [0.75      , 0.08333333],
       [0.91666667, 0.58333333]])
&gt;&gt;&gt; qmc.discrepancy(space)
0.008142039609053464

We can also compute iteratively the ``CD`` discrepancy by using
``iterative=True``.

&gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)
&gt;&gt;&gt; disc_init
0.04769081147119336
&gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)
0.008142039609053513
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00171">171</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02590">_validate_workers()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02321">_random_cd()</a>.</p>

</div>
</div>
<a id="a4a2a87897d180c083d702531cdca44cf" name="a4a2a87897d180c083d702531cdca44cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2a87897d180c083d702531cdca44cf">&#9670;&#160;</a></span>n_primes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[int] scipy.stats._qmc.n_primes </td>
          <td>(</td>
          <td class="paramtype">IntNumber</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">List of the n-first prime numbers.

Parameters
----------
n : int
    Number of prime numbers wanted.

Returns
-------
primes : list(int)
    List of primes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00492">492</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00460">primes_from_2_to()</a>.</p>

</div>
</div>
<a id="a73db6f8ac0e878841d09657004b0649c" name="a73db6f8ac0e878841d09657004b0649c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73db6f8ac0e878841d09657004b0649c">&#9670;&#160;</a></span>primes_from_2_to()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.primes_from_2_to </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Prime numbers from 2 to *n*.

Parameters
----------
n : int
    Sup bound with ``n &gt;= 6``.

Returns
-------
primes : list(int)
    Primes in ``2 &lt;= p &lt; n``.

Notes
-----
Taken from [1]_ by P.T. Roy, written consent given on 23.04.2021
by the original author, Bruno Astrolino, for free use in SciPy under
the 3-clause BSD.

References
----------
.. [1] `StackOverflow &lt;https://stackoverflow.com/questions/2068372&gt;`_.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00460">460</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l01331">scipy.stats._qmc.LatinHypercube._random_oa_lhs()</a>, and <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00492">n_primes()</a>.</p>

</div>
</div>
<a id="ae76f690673ebcc776891798b0e128d4a" name="ae76f690673ebcc776891798b0e128d4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76f690673ebcc776891798b0e128d4a">&#9670;&#160;</a></span>scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.scale </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>l_bounds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>u_bounds</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>reverse</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sample scaling from unit hypercube to different bounds.

To convert a sample from :math:`[0, 1)` to :math:`[a, b), b&gt;a`,
with :math:`a` the lower bounds and :math:`b` the upper bounds.
The following transformation is used:

.. math::

(b - a) \cdot \text{sample} + a

Parameters
----------
sample : array_like (n, d)
Sample to scale.
l_bounds, u_bounds : array_like (d,)
Lower and upper bounds (resp. :math:`a`, :math:`b`) of transformed
data. If `reverse` is True, range of the original data to transform
to the unit hypercube.
reverse : bool, optional
Reverse the transformation from different bounds to the unit hypercube.
Default is False.

Returns
-------
sample : array_like (n, d)
Scaled sample.

Examples
--------
Transform 3 samples in the unit hypercube to bounds:

&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; l_bounds = [-2, 0]
&gt;&gt;&gt; u_bounds = [6, 5]
&gt;&gt;&gt; sample = [[0.5 , 0.75],
...           [0.5 , 0.5],
...           [0.75, 0.25]]
&gt;&gt;&gt; sample_scaled = qmc.scale(sample, l_bounds, u_bounds)
&gt;&gt;&gt; sample_scaled
array([[2.  , 3.75],
[2.  , 2.5 ],
[4.  , 1.25]])

And convert back to the unit hypercube:

&gt;&gt;&gt; sample_ = qmc.scale(sample_scaled, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; sample_
array([[0.5 , 0.75],
[0.5 , 0.5 ],
[0.75, 0.25]])
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00088">88</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l02622">_validate_bounds()</a>.</p>

</div>
</div>
<a id="a33205602634d9d5ce04705a48d798551" name="a33205602634d9d5ce04705a48d798551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33205602634d9d5ce04705a48d798551">&#9670;&#160;</a></span>update_discrepancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc.update_discrepancy </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>x_new</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike</td>          <td class="paramname"><span class="paramname"><em>sample</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DecimalNumber</td>          <td class="paramname"><span class="paramname"><em>initial_disc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update the centered discrepancy with a new sample.

Parameters
----------
x_new : array_like (1, d)
    The new sample to add in `sample`.
sample : array_like (n, d)
    The initial sample.
initial_disc : float
    Centered discrepancy of the `sample`.

Returns
-------
discrepancy : float
    Centered discrepancy of the sample composed of `x_new` and `sample`.

Examples
--------
We can also compute iteratively the discrepancy by using
``iterative=True``.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])
&gt;&gt;&gt; l_bounds = [0.5, 0.5]
&gt;&gt;&gt; u_bounds = [6.5, 6.5]
&gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)
&gt;&gt;&gt; disc_init
0.04769081147119336
&gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)
0.008142039609053513
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00309">309</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
<a id="a43c0482d0724d18fd957cd241692c0b2" name="a43c0482d0724d18fd957cd241692c0b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43c0482d0724d18fd957cd241692c0b2">&#9670;&#160;</a></span>van_der_corput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.van_der_corput </td>
          <td>(</td>
          <td class="paramtype">IntNumber</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>base</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>start_index</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>scramble</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike | None </td>          <td class="paramname"><span class="paramname"><em>permutations</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SeedType </td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber </td>          <td class="paramname"><span class="paramname"><em>workers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Van der Corput sequence.

Pseudo-random number generator based on a b-adic expansion.

Scrambling uses permutations of the remainders (see [1]_). Multiple
permutations are applied to construct a point. The sequence of
permutations has to be the same for all points of the sequence.

Parameters
----------
n : int
    Number of element of the sequence.
base : int, optional
    Base of the sequence. Default is 2.
start_index : int, optional
    Index to start the sequence from. Default is 0.
scramble : bool, optional
    If True, use Owen scrambling. Otherwise no scrambling is done.
    Default is True.
permutations : array_like, optional
    Permutations used for scrambling.
seed : {None, int, `numpy.random.Generator`}, optional
    If `seed` is an int or None, a new `numpy.random.Generator` is
    created using ``np.random.default_rng(seed)``.
    If `seed` is already a ``Generator`` instance, then the provided
    instance is used.
workers : int, optional
    Number of workers to use for parallel processing. If -1 is
    given all CPU threads are used. Default is 1.

Returns
-------
sequence : list (n,)
    Sequence of Van der Corput.

References
----------
.. [1] A. B. Owen. "A randomized Halton algorithm in R",
   :arxiv:`1706.02808`, 2017.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00569">569</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00533">_van_der_corput_permutations()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l01053">scipy.stats._qmc.Halton._random()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a70091f28f1441e9df78adfb2a6c2e02b" name="a70091f28f1441e9df78adfb2a6c2e02b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70091f28f1441e9df78adfb2a6c2e02b">&#9670;&#160;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.stats._qmc.__all__</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  [<span class="stringliteral">&#39;scale&#39;</span>, <span class="stringliteral">&#39;discrepancy&#39;</span>, <span class="stringliteral">&#39;update_discrepancy&#39;</span>,</div>
<div class="line"><span class="lineno">    2</span>           <span class="stringliteral">&#39;QMCEngine&#39;</span>, <span class="stringliteral">&#39;Sobol&#39;</span>, <span class="stringliteral">&#39;Halton&#39;</span>, <span class="stringliteral">&#39;LatinHypercube&#39;</span>, <span class="stringliteral">&#39;PoissonDisk&#39;</span>,</div>
<div class="line"><span class="lineno">    3</span>           <span class="stringliteral">&#39;MultinomialQMC&#39;</span>, <span class="stringliteral">&#39;MultivariateNormalQMC&#39;</span>]</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d1b/__qmc_8py_source.html#l00046">46</a> of file <a class="el" href="../../d6/d1b/__qmc_8py_source.html">_qmc.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/d0f/namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="../../d0/df6/namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="../../d3/d27/namespacescipy_1_1stats_1_1__qmc.html">_qmc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
