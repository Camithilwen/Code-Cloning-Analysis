<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: scipy.sparse.linalg._eigen._svds Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d6/d0b/namespacescipy_1_1sparse_1_1linalg_1_1__eigen_1_1__svds.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.sparse.linalg._eigen._svds Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa37f27c3dbc55eb6bc8798c6f8d49629" id="r_aa37f27c3dbc55eb6bc8798c6f8d49629"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa37f27c3dbc55eb6bc8798c6f8d49629">_herm</a> (x)</td></tr>
<tr class="separator:aa37f27c3dbc55eb6bc8798c6f8d49629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025b6bffa00e46ea20e6c745963fd1fb" id="r_a025b6bffa00e46ea20e6c745963fd1fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a025b6bffa00e46ea20e6c745963fd1fb">_iv</a> (A, k, ncv, tol, which, v0, maxiter, return_singular, solver, random_state)</td></tr>
<tr class="separator:a025b6bffa00e46ea20e6c745963fd1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207c9ba7c8aa59fb66523be6dd624a16" id="r_a207c9ba7c8aa59fb66523be6dd624a16"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a207c9ba7c8aa59fb66523be6dd624a16">svds</a> (A, k=6, ncv=None, tol=0, which='LM', v0=None, maxiter=None, return_singular_vectors=<a class="el" href="../../d8/d0b/classTrue.html">True</a>, solver='arpack', random_state=None, options=None)</td></tr>
<tr class="separator:a207c9ba7c8aa59fb66523be6dd624a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0e7da0870db531902289b33ec90bc393" id="r_a0e7da0870db531902289b33ec90bc393"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e7da0870db531902289b33ec90bc393">HAS_PROPACK</a> = <a class="el" href="../../d8/d0b/classTrue.html">True</a></td></tr>
<tr class="separator:a0e7da0870db531902289b33ec90bc393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597973bd0f3030465032c02bd455da26" id="r_a597973bd0f3030465032c02bd455da26"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a597973bd0f3030465032c02bd455da26">arpack_int</a> = _arpack.timing.nbx.dtype</td></tr>
<tr class="separator:a597973bd0f3030465032c02bd455da26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00ddb0be88d6cecc7f53d5a03d07c7a4" id="r_a00ddb0be88d6cecc7f53d5a03d07c7a4"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00ddb0be88d6cecc7f53d5a03d07c7a4">__all__</a> = ['<a class="el" href="#a207c9ba7c8aa59fb66523be6dd624a16">svds</a>']</td></tr>
<tr class="separator:a00ddb0be88d6cecc7f53d5a03d07c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa37f27c3dbc55eb6bc8798c6f8d49629" name="aa37f27c3dbc55eb6bc8798c6f8d49629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa37f27c3dbc55eb6bc8798c6f8d49629">&#9670;&#160;</a></span>_herm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen._svds._herm </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00021">21</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

</div>
</div>
<a id="a025b6bffa00e46ea20e6c745963fd1fb" name="a025b6bffa00e46ea20e6c745963fd1fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a025b6bffa00e46ea20e6c745963fd1fb">&#9670;&#160;</a></span>_iv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen._svds._iv </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ncv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>which</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>maxiter</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_singular</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>solver</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>random_state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00025">25</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

</div>
</div>
<a id="a207c9ba7c8aa59fb66523be6dd624a16" name="a207c9ba7c8aa59fb66523be6dd624a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a207c9ba7c8aa59fb66523be6dd624a16">&#9670;&#160;</a></span>svds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen._svds.svds </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>k</em></span><span class="paramdefsep"> = </span><span class="paramdefval">6</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ncv</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tol</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>which</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'LM'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>v0</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>maxiter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>return_singular_vectors</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../d8/d0b/classTrue.html">True</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>solver</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'arpack'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>random_state</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>options</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Partial singular value decomposition of a sparse matrix.

Compute the largest or smallest `k` singular values and corresponding
singular vectors of a sparse matrix `A`. The order in which the singular
values are returned is not guaranteed.

In the descriptions below, let ``M, N = A.shape``.

Parameters
----------
A : ndarray, sparse matrix, or LinearOperator
    Matrix to decompose of a floating point numeric dtype.
k : int, default: 6
    Number of singular values and singular vectors to compute.
    Must satisfy ``1 &lt;= k &lt;= kmax``, where ``kmax=min(M, N)`` for
    ``solver='propack'`` and ``kmax=min(M, N) - 1`` otherwise.
ncv : int, optional
    When ``solver='arpack'``, this is the number of Lanczos vectors
    generated. See :ref:`'arpack' &lt;sparse.linalg.svds-arpack&gt;` for details.
    When ``solver='lobpcg'`` or ``solver='propack'``, this parameter is
    ignored.
tol : float, optional
    Tolerance for singular values. Zero (default) means machine precision.
which : {'LM', 'SM'}
    Which `k` singular values to find: either the largest magnitude ('LM')
    or smallest magnitude ('SM') singular values.
v0 : ndarray, optional
    The starting vector for iteration; see method-specific
    documentation (:ref:`'arpack' &lt;sparse.linalg.svds-arpack&gt;`,
    :ref:`'lobpcg' &lt;sparse.linalg.svds-lobpcg&gt;`), or
    :ref:`'propack' &lt;sparse.linalg.svds-propack&gt;` for details.
maxiter : int, optional
    Maximum number of iterations; see method-specific
    documentation (:ref:`'arpack' &lt;sparse.linalg.svds-arpack&gt;`,
    :ref:`'lobpcg' &lt;sparse.linalg.svds-lobpcg&gt;`), or
    :ref:`'propack' &lt;sparse.linalg.svds-propack&gt;` for details.
return_singular_vectors : {True, False, "u", "vh"}
    Singular values are always computed and returned; this parameter
    controls the computation and return of singular vectors.

    - ``True``: return singular vectors.
    - ``False``: do not return singular vectors.
    - ``"u"``: if ``M &lt;= N``, compute only the left singular vectors and
      return ``None`` for the right singular vectors. Otherwise, compute
      all singular vectors.
    - ``"vh"``: if ``M &gt; N``, compute only the right singular vectors and
      return ``None`` for the left singular vectors. Otherwise, compute
      all singular vectors.

    If ``solver='propack'``, the option is respected regardless of the
    matrix shape.

solver :  {'arpack', 'propack', 'lobpcg'}, optional
        The solver used.
        :ref:`'arpack' &lt;sparse.linalg.svds-arpack&gt;`,
        :ref:`'lobpcg' &lt;sparse.linalg.svds-lobpcg&gt;`, and
        :ref:`'propack' &lt;sparse.linalg.svds-propack&gt;` are supported.
        Default: `'arpack'`.
random_state : {None, int, `numpy.random.Generator`,
                `numpy.random.RandomState`}, optional

    Pseudorandom number generator state used to generate resamples.

    If `random_state` is ``None`` (or `np.random`), the
    `numpy.random.RandomState` singleton is used.
    If `random_state` is an int, a new ``RandomState`` instance is used,
    seeded with `random_state`.
    If `random_state` is already a ``Generator`` or ``RandomState``
    instance then that instance is used.
options : dict, optional
    A dictionary of solver-specific options. No solver-specific options
    are currently supported; this parameter is reserved for future use.

Returns
-------
u : ndarray, shape=(M, k)
    Unitary matrix having left singular vectors as columns.
s : ndarray, shape=(k,)
    The singular values.
vh : ndarray, shape=(k, N)
    Unitary matrix having right singular vectors as rows.

Notes
-----
This is a naive implementation using ARPACK or LOBPCG as an eigensolver
on the matrix ``A.conj().T @ A`` or ``A @ A.conj().T``, depending on
which one is smaller size, followed by the Rayleigh-Ritz method
as postprocessing; see
Using the normal matrix, in Rayleigh-Ritz method, (2022, Nov. 19),
Wikipedia, https://w.wiki/4zms.

Alternatively, the PROPACK solver can be called.

Choices of the input matrix `A` numeric dtype may be limited.
Only ``solver="lobpcg"`` supports all floating point dtypes
real: 'np.single', 'np.double', 'np.longdouble' and
complex: 'np.csingle', 'np.cdouble', 'np.clongdouble'.
The ``solver="arpack"`` supports only
'np.single', 'np.double', and 'np.cdouble'.

Examples
--------
Construct a matrix `A` from singular values and vectors.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy import sparse, linalg, stats
&gt;&gt;&gt; from scipy.sparse.linalg import svds, aslinearoperator, LinearOperator

Construct a dense matrix `A` from singular values and vectors.

&gt;&gt;&gt; rng = np.random.default_rng(258265244568965474821194062361901728911)
&gt;&gt;&gt; orthogonal = stats.ortho_group.rvs(10, random_state=rng)
&gt;&gt;&gt; s = [1e-3, 1, 2, 3, 4]  # non-zero singular values
&gt;&gt;&gt; u = orthogonal[:, :5]         # left singular vectors
&gt;&gt;&gt; vT = orthogonal[:, 5:].T      # right singular vectors
&gt;&gt;&gt; A = u @ np.diag(s) @ vT

With only four singular values/vectors, the SVD approximates the original
matrix.

&gt;&gt;&gt; u4, s4, vT4 = svds(A, k=4)
&gt;&gt;&gt; A4 = u4 @ np.diag(s4) @ vT4
&gt;&gt;&gt; np.allclose(A4, A, atol=1e-3)
True

With all five non-zero singular values/vectors, we can reproduce
the original matrix more accurately.

&gt;&gt;&gt; u5, s5, vT5 = svds(A, k=5)
&gt;&gt;&gt; A5 = u5 @ np.diag(s5) @ vT5
&gt;&gt;&gt; np.allclose(A5, A)
True

The singular values match the expected singular values.

&gt;&gt;&gt; np.allclose(s5, s)
True

Since the singular values are not close to each other in this example,
every singular vector matches as expected up to a difference in sign.

&gt;&gt;&gt; (np.allclose(np.abs(u5), np.abs(u)) and
...  np.allclose(np.abs(vT5), np.abs(vT)))
True

The singular vectors are also orthogonal.

&gt;&gt;&gt; (np.allclose(u5.T @ u5, np.eye(5)) and
...  np.allclose(vT5 @ vT5.T, np.eye(5)))
True

If there are (nearly) multiple singular values, the corresponding
individual singular vectors may be unstable, but the whole invariant
subspace containing all such singular vectors is computed accurately
as can be measured by angles between subspaces via 'subspace_angles'.

&gt;&gt;&gt; rng = np.random.default_rng(178686584221410808734965903901790843963)
&gt;&gt;&gt; s = [1, 1 + 1e-6]  # non-zero singular values
&gt;&gt;&gt; u, _ = np.linalg.qr(rng.standard_normal((99, 2)))
&gt;&gt;&gt; v, _ = np.linalg.qr(rng.standard_normal((99, 2)))
&gt;&gt;&gt; vT = v.T
&gt;&gt;&gt; A = u @ np.diag(s) @ vT
&gt;&gt;&gt; A = A.astype(np.float32)
&gt;&gt;&gt; u2, s2, vT2 = svds(A, k=2, random_state=rng)
&gt;&gt;&gt; np.allclose(s2, s)
True

The angles between the individual exact and computed singular vectors
may not be so small. To check use:

&gt;&gt;&gt; (linalg.subspace_angles(u2[:, :1], u[:, :1]) +
...  linalg.subspace_angles(u2[:, 1:], u[:, 1:]))
array([0.06562513])  # may vary
&gt;&gt;&gt; (linalg.subspace_angles(vT2[:1, :].T, vT[:1, :].T) +
...  linalg.subspace_angles(vT2[1:, :].T, vT[1:, :].T))
array([0.06562507])  # may vary

As opposed to the angles between the 2-dimensional invariant subspaces
that these vectors span, which are small for rights singular vectors

&gt;&gt;&gt; linalg.subspace_angles(u2, u).sum() &lt; 1e-6
True

as well as for left singular vectors.

&gt;&gt;&gt; linalg.subspace_angles(vT2.T, vT.T).sum() &lt; 1e-6
True

The next example follows that of 'sklearn.decomposition.TruncatedSVD'.

&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; X_dense = rng.random(size=(100, 100))
&gt;&gt;&gt; X_dense[:, 2 * np.arange(50)] = 0
&gt;&gt;&gt; X = sparse.csr_matrix(X_dense)
&gt;&gt;&gt; _, singular_values, _ = svds(X, k=5, random_state=rng)
&gt;&gt;&gt; print(singular_values)
[ 4.3293...  4.4491...  4.5420...  4.5987... 35.2410...]

The function can be called without the transpose of the input matrix
ever explicitly constructed.

&gt;&gt;&gt; rng = np.random.default_rng(102524723947864966825913730119128190974)
&gt;&gt;&gt; G = sparse.rand(8, 9, density=0.5, random_state=rng)
&gt;&gt;&gt; Glo = aslinearoperator(G)
&gt;&gt;&gt; _, singular_values_svds, _ = svds(Glo, k=5, random_state=rng)
&gt;&gt;&gt; _, singular_values_svd, _ = linalg.svd(G.toarray())
&gt;&gt;&gt; np.allclose(singular_values_svds, singular_values_svd[-4::-1])
True

The most memory efficient scenario is where neither
the original matrix, nor its transpose, is explicitly constructed.
Our example computes the smallest singular values and vectors
of 'LinearOperator' constructed from the numpy function 'np.diff' used
column-wise to be consistent with 'LinearOperator' operating on columns.

&gt;&gt;&gt; diff0 = lambda a: np.diff(a, axis=0)

Let us create the matrix from 'diff0' to be used for validation only.

&gt;&gt;&gt; n = 5  # The dimension of the space.
&gt;&gt;&gt; M_from_diff0 = diff0(np.eye(n))
&gt;&gt;&gt; print(M_from_diff0.astype(int))
[[-1  1  0  0  0]
 [ 0 -1  1  0  0]
 [ 0  0 -1  1  0]
 [ 0  0  0 -1  1]]

The matrix 'M_from_diff0' is bi-diagonal and could be alternatively
created directly by

&gt;&gt;&gt; M = - np.eye(n - 1, n, dtype=int)
&gt;&gt;&gt; np.fill_diagonal(M[:,1:], 1)
&gt;&gt;&gt; np.allclose(M, M_from_diff0)
True

Its transpose

&gt;&gt;&gt; print(M.T)
[[-1  0  0  0]
 [ 1 -1  0  0]
 [ 0  1 -1  0]
 [ 0  0  1 -1]
 [ 0  0  0  1]]

can be viewed as the incidence matrix; see
Incidence matrix, (2022, Nov. 19), Wikipedia, https://w.wiki/5YXU,
of a linear graph with 5 vertices and 4 edges. The 5x5 normal matrix
``M.T @ M`` thus is

&gt;&gt;&gt; print(M.T @ M)
[[ 1 -1  0  0  0]
 [-1  2 -1  0  0]
 [ 0 -1  2 -1  0]
 [ 0  0 -1  2 -1]
 [ 0  0  0 -1  1]]

the graph Laplacian, while the actually used in 'svds' smaller size
4x4 normal matrix ``M @ M.T``

&gt;&gt;&gt; print(M @ M.T)
[[ 2 -1  0  0]
 [-1  2 -1  0]
 [ 0 -1  2 -1]
 [ 0  0 -1  2]]

is the so-called edge-based Laplacian; see
Symmetric Laplacian via the incidence matrix, in Laplacian matrix,
(2022, Nov. 19), Wikipedia, https://w.wiki/5YXW.

The 'LinearOperator' setup needs the options 'rmatvec' and 'rmatmat'
of multiplication by the matrix transpose ``M.T``, but we want to be
matrix-free to save memory, so knowing how ``M.T`` looks like, we
manually construct the following function to be
used in ``rmatmat=diff0t``.

&gt;&gt;&gt; def diff0t(a):
...     if a.ndim == 1:
...         a = a[:,np.newaxis]  # Turn 1D into 2D array
...     d = np.zeros((a.shape[0] + 1, a.shape[1]), dtype=a.dtype)
...     d[0, :] = - a[0, :]
...     d[1:-1, :] = a[0:-1, :] - a[1:, :]
...     d[-1, :] = a[-1, :]
...     return d

We check that our function 'diff0t' for the matrix transpose is valid.

&gt;&gt;&gt; np.allclose(M.T, diff0t(np.eye(n-1)))
True

Now we setup our matrix-free 'LinearOperator' called 'diff0_func_aslo'
and for validation the matrix-based 'diff0_matrix_aslo'.

&gt;&gt;&gt; def diff0_func_aslo_def(n):
...     return LinearOperator(matvec=diff0,
...                           matmat=diff0,
...                           rmatvec=diff0t,
...                           rmatmat=diff0t,
...                           shape=(n - 1, n))
&gt;&gt;&gt; diff0_func_aslo = diff0_func_aslo_def(n)
&gt;&gt;&gt; diff0_matrix_aslo = aslinearoperator(M_from_diff0)

And validate both the matrix and its transpose in 'LinearOperator'.

&gt;&gt;&gt; np.allclose(diff0_func_aslo(np.eye(n)),
...             diff0_matrix_aslo(np.eye(n)))
True
&gt;&gt;&gt; np.allclose(diff0_func_aslo.T(np.eye(n-1)),
...             diff0_matrix_aslo.T(np.eye(n-1)))
True

Having the 'LinearOperator' setup validated, we run the solver.

&gt;&gt;&gt; n = 100
&gt;&gt;&gt; diff0_func_aslo = diff0_func_aslo_def(n)
&gt;&gt;&gt; u, s, vT = svds(diff0_func_aslo, k=3, which='SM')

The singular values squared and the singular vectors are known
explicitly; see
Pure Dirichlet boundary conditions, in
Eigenvalues and eigenvectors of the second derivative,
(2022, Nov. 19), Wikipedia, https://w.wiki/5YX6,
since 'diff' corresponds to first
derivative, and its smaller size n-1 x n-1 normal matrix
``M @ M.T`` represent the discrete second derivative with the Dirichlet
boundary conditions. We use these analytic expressions for validation.

&gt;&gt;&gt; se = 2. * np.sin(np.pi * np.arange(1, 4) / (2. * n))
&gt;&gt;&gt; ue = np.sqrt(2 / n) * np.sin(np.pi * np.outer(np.arange(1, n),
...                              np.arange(1, 4)) / n)
&gt;&gt;&gt; np.allclose(s, se, atol=1e-3)
True
&gt;&gt;&gt; print(np.allclose(np.abs(u), np.abs(ue), atol=1e-6))
True
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00104">104</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d2c/arpack_8py_source.html#l01359">scipy.sparse.linalg._eigen.arpack.arpack.eigsh()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a00ddb0be88d6cecc7f53d5a03d07c7a4" name="a00ddb0be88d6cecc7f53d5a03d07c7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00ddb0be88d6cecc7f53d5a03d07c7a4">&#9670;&#160;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.sparse.linalg._eigen._svds.__all__ = ['<a class="el" href="#a207c9ba7c8aa59fb66523be6dd624a16">svds</a>']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00018">18</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

</div>
</div>
<a id="a597973bd0f3030465032c02bd455da26" name="a597973bd0f3030465032c02bd455da26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a597973bd0f3030465032c02bd455da26">&#9670;&#160;</a></span>arpack_int</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen._svds.arpack_int = _arpack.timing.nbx.dtype</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00017">17</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

</div>
</div>
<a id="a0e7da0870db531902289b33ec90bc393" name="a0e7da0870db531902289b33ec90bc393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e7da0870db531902289b33ec90bc393">&#9670;&#160;</a></span>HAS_PROPACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scipy.sparse.linalg._eigen._svds.HAS_PROPACK = <a class="el" href="../../d8/d0b/classTrue.html">True</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/dfd/__svds_8py_source.html#l00012">12</a> of file <a class="el" href="../../d8/dfd/__svds_8py_source.html">_svds.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/d0f/namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="../../dd/d6f/namespacescipy_1_1sparse.html">sparse</a></li><li class="navelem"><a class="el" href="../../d9/d41/namespacescipy_1_1sparse_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="../../d1/d70/namespacescipy_1_1sparse_1_1linalg_1_1__eigen.html">_eigen</a></li><li class="navelem"><a class="el" href="../../d6/d0b/namespacescipy_1_1sparse_1_1linalg_1_1__eigen_1_1__svds.html">_svds</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
