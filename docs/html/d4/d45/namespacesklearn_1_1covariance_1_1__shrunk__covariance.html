<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: sklearn.covariance._shrunk_covariance Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/d45/namespacesklearn_1_1covariance_1_1__shrunk__covariance.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.covariance._shrunk_covariance Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d2c/classsklearn_1_1covariance_1_1__shrunk__covariance_1_1LedoitWolf.html">LedoitWolf</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dca/classsklearn_1_1covariance_1_1__shrunk__covariance_1_1OAS.html">OAS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dc2/classsklearn_1_1covariance_1_1__shrunk__covariance_1_1ShrunkCovariance.html">ShrunkCovariance</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acc8fda222e3644301949d6c0074266b9" id="r_acc8fda222e3644301949d6c0074266b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc8fda222e3644301949d6c0074266b9">_ledoit_wolf</a> (X, *, assume_centered, block_size)</td></tr>
<tr class="separator:acc8fda222e3644301949d6c0074266b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aab57c784cdb1f0bde8e53e5fad6874" id="r_a1aab57c784cdb1f0bde8e53e5fad6874"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1aab57c784cdb1f0bde8e53e5fad6874">_oas</a> (X, *, assume_centered=False)</td></tr>
<tr class="separator:a1aab57c784cdb1f0bde8e53e5fad6874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a209d3d41c1355ac7f739fcddace238d8" id="r_a209d3d41c1355ac7f739fcddace238d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a209d3d41c1355ac7f739fcddace238d8">shrunk_covariance</a> (emp_cov, shrinkage=0.1)</td></tr>
<tr class="memdesc:a209d3d41c1355ac7f739fcddace238d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public API <a class="el" href="../../dd/dc2/classsklearn_1_1covariance_1_1__shrunk__covariance_1_1ShrunkCovariance.html">ShrunkCovariance</a> estimator.  <br /></td></tr>
<tr class="separator:a209d3d41c1355ac7f739fcddace238d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add11f8d21f68ce1d1a9bbe59a09d4248" id="r_add11f8d21f68ce1d1a9bbe59a09d4248"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add11f8d21f68ce1d1a9bbe59a09d4248">ledoit_wolf_shrinkage</a> (X, assume_centered=False, block_size=1000)</td></tr>
<tr class="separator:add11f8d21f68ce1d1a9bbe59a09d4248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a309742045bb2f34916b7fb24fcd668f6" id="r_a309742045bb2f34916b7fb24fcd668f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a309742045bb2f34916b7fb24fcd668f6">ledoit_wolf</a> (X, *, assume_centered=False, block_size=1000)</td></tr>
<tr class="separator:a309742045bb2f34916b7fb24fcd668f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b8e92e68f41a83b59e408263296eb1" id="r_af8b8e92e68f41a83b59e408263296eb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8b8e92e68f41a83b59e408263296eb1">oas</a> (X, *, assume_centered=False)</td></tr>
<tr class="separator:af8b8e92e68f41a83b59e408263296eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Covariance estimators using shrinkage.

Shrinkage corresponds to regularising `cov` using a convex combination:
shrunk_cov = (1-shrinkage)*cov + shrinkage*structured_estimate.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="acc8fda222e3644301949d6c0074266b9" name="acc8fda222e3644301949d6c0074266b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8fda222e3644301949d6c0074266b9">&#9670;&#160;</a></span>_ledoit_wolf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance._ledoit_wolf </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_centered</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>block_size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Estimate the shrunk Ledoit-Wolf covariance matrix.</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00025">25</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

<p class="reference">References <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00297">ledoit_wolf_shrinkage()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00584">sklearn.covariance._shrunk_covariance.LedoitWolf.fit()</a>.</p>

</div>
</div>
<a id="a1aab57c784cdb1f0bde8e53e5fad6874" name="a1aab57c784cdb1f0bde8e53e5fad6874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aab57c784cdb1f0bde8e53e5fad6874">&#9670;&#160;</a></span>_oas()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance._oas </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_centered</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Estimate covariance with the Oracle Approximating Shrinkage algorithm.

The formulation is based on [1]_.
[1] "Shrinkage algorithms for MMSE covariance estimation.",
    Chen, Y., Wiesel, A., Eldar, Y. C., &amp; Hero, A. O.
    IEEE Transactions on Signal Processing, 58(10), 5016-5029, 2010.
    https://arxiv.org/pdf/0907.4698.pdf
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00046">46</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00794">sklearn.covariance._shrunk_covariance.OAS.fit()</a>.</p>

</div>
</div>
<a id="a309742045bb2f34916b7fb24fcd668f6" name="a309742045bb2f34916b7fb24fcd668f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a309742045bb2f34916b7fb24fcd668f6">&#9670;&#160;</a></span>ledoit_wolf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance.ledoit_wolf </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_centered</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>block_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1000</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Estimate the shrunk Ledoit-Wolf covariance matrix.

Read more in the :ref:`User Guide &lt;shrunk_covariance&gt;`.

Parameters
----------
X : array-like of shape (n_samples, n_features)
    Data from which to compute the covariance estimate.

assume_centered : bool, default=False
    If True, data will not be centered before computation.
    Useful to work with data whose mean is significantly equal to
    zero but is not exactly zero.
    If False, data will be centered before computation.

block_size : int, default=1000
    Size of blocks into which the covariance matrix will be split.
    This is purely a memory optimization and does not affect results.

Returns
-------
shrunk_cov : ndarray of shape (n_features, n_features)
    Shrunk covariance.

shrinkage : float
    Coefficient in the convex combination used for the computation
    of the shrunk estimate.

Notes
-----
The regularized (shrunk) covariance is:

(1 - shrinkage) * cov + shrinkage * mu * np.identity(n_features)

where mu = trace(cov) / n_features

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.covariance import empirical_covariance, ledoit_wolf
&gt;&gt;&gt; real_cov = np.array([[.4, .2], [.2, .8]])
&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; X = rng.multivariate_normal(mean=[0, 0], cov=real_cov, size=50)
&gt;&gt;&gt; covariance, shrinkage = ledoit_wolf(X)
&gt;&gt;&gt; covariance
array([[0.44, 0.16],
       [0.16, 0.80]])
&gt;&gt;&gt; shrinkage
np.float64(0.23)
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00407">407</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

</div>
</div>
<a id="add11f8d21f68ce1d1a9bbe59a09d4248" name="add11f8d21f68ce1d1a9bbe59a09d4248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add11f8d21f68ce1d1a9bbe59a09d4248">&#9670;&#160;</a></span>ledoit_wolf_shrinkage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance.ledoit_wolf_shrinkage </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_centered</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>block_size</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1000</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Estimate the shrunk Ledoit-Wolf covariance matrix.

Read more in the :ref:`User Guide &lt;shrunk_covariance&gt;`.

Parameters
----------
X : array-like of shape (n_samples, n_features)
    Data from which to compute the Ledoit-Wolf shrunk covariance shrinkage.

assume_centered : bool, default=False
    If True, data will not be centered before computation.
    Useful to work with data whose mean is significantly equal to
    zero but is not exactly zero.
    If False, data will be centered before computation.

block_size : int, default=1000
    Size of blocks into which the covariance matrix will be split.

Returns
-------
shrinkage : float
    Coefficient in the convex combination used for the computation
    of the shrunk estimate.

Notes
-----
The regularized (shrunk) covariance is:

(1 - shrinkage) * cov + shrinkage * mu * np.identity(n_features)

where mu = trace(cov) / n_features

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.covariance import ledoit_wolf_shrinkage
&gt;&gt;&gt; real_cov = np.array([[.4, .2], [.2, .8]])
&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; X = rng.multivariate_normal(mean=[0, 0], cov=real_cov, size=50)
&gt;&gt;&gt; shrinkage_coefficient = ledoit_wolf_shrinkage(X)
&gt;&gt;&gt; shrinkage_coefficient
np.float64(0.23)
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00297">297</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00025">_ledoit_wolf()</a>.</p>

</div>
</div>
<a id="af8b8e92e68f41a83b59e408263296eb1" name="af8b8e92e68f41a83b59e408263296eb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b8e92e68f41a83b59e408263296eb1">&#9670;&#160;</a></span>oas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance.oas </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>assume_centered</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Estimate covariance with the Oracle Approximating Shrinkage.

Read more in the :ref:`User Guide &lt;shrunk_covariance&gt;`.

Parameters
----------
X : array-like of shape (n_samples, n_features)
    Data from which to compute the covariance estimate.

assume_centered : bool, default=False
  If True, data will not be centered before computation.
  Useful to work with data whose mean is significantly equal to
  zero but is not exactly zero.
  If False, data will be centered before computation.

Returns
-------
shrunk_cov : array-like of shape (n_features, n_features)
    Shrunk covariance.

shrinkage : float
    Coefficient in the convex combination used for the computation
    of the shrunk estimate.

Notes
-----
The regularised covariance is:

(1 - shrinkage) * cov + shrinkage * mu * np.identity(n_features),

where mu = trace(cov) / n_features and shrinkage is given by the OAS formula
(see [1]_).

The shrinkage formulation implemented here differs from Eq. 23 in [1]_. In
the original article, formula (23) states that 2/p (p being the number of
features) is multiplied by Trace(cov*cov) in both the numerator and
denominator, but this operation is omitted because for a large p, the value
of 2/p is so small that it doesn't affect the value of the estimator.

References
----------
.. [1] :arxiv:`"Shrinkage algorithms for MMSE covariance estimation.",
       Chen, Y., Wiesel, A., Eldar, Y. C., &amp; Hero, A. O.
       IEEE Transactions on Signal Processing, 58(10), 5016-5029, 2010.
       &lt;0907.4698&gt;`

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.covariance import oas
&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; real_cov = [[.8, .3], [.3, .4]]
&gt;&gt;&gt; X = rng.multivariate_normal(mean=[0, 0], cov=real_cov, size=500)
&gt;&gt;&gt; shrunk_cov, shrinkage = oas(X)
&gt;&gt;&gt; shrunk_cov
array([[0.7533, 0.2763],
       [0.2763, 0.3964]])
&gt;&gt;&gt; shrinkage
np.float64(0.0195)
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00621">621</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

</div>
</div>
<a id="a209d3d41c1355ac7f739fcddace238d8" name="a209d3d41c1355ac7f739fcddace238d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a209d3d41c1355ac7f739fcddace238d8">&#9670;&#160;</a></span>shrunk_covariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.covariance._shrunk_covariance.shrunk_covariance </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>emp_cov</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>shrinkage</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public API <a class="el" href="../../dd/dc2/classsklearn_1_1covariance_1_1__shrunk__covariance_1_1ShrunkCovariance.html">ShrunkCovariance</a> estimator. </p>
<pre class="fragment">Calculate covariance matrices shrunk on the diagonal.

Read more in the :ref:`User Guide &lt;shrunk_covariance&gt;`.

Parameters
----------
emp_cov : array-like of shape (..., n_features, n_features)
    Covariance matrices to be shrunk, at least 2D ndarray.

shrinkage : float, default=0.1
    Coefficient in the convex combination used for the computation
    of the shrunk estimate. Range is [0, 1].

Returns
-------
shrunk_cov : ndarray of shape (..., n_features, n_features)
    Shrunk covariance matrices.

Notes
-----
The regularized (shrunk) covariance is given by::

    (1 - shrinkage) * cov + shrinkage * mu * np.identity(n_features)

where `mu = trace(cov) / n_features`.

Examples
--------
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.datasets import make_gaussian_quantiles
&gt;&gt;&gt; from sklearn.covariance import empirical_covariance, shrunk_covariance
&gt;&gt;&gt; real_cov = np.array([[.8, .3], [.3, .4]])
&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; X = rng.multivariate_normal(mean=[0, 0], cov=real_cov, size=500)
&gt;&gt;&gt; shrunk_covariance(empirical_covariance(X))
array([[0.739, 0.254],
       [0.254, 0.411]])
</pre> 
<p class="definition">Definition at line <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00109">109</a> of file <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html">_shrunk_covariance.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d62/__shrunk__covariance_8py_source.html#l00255">sklearn.covariance._shrunk_covariance.ShrunkCovariance.fit()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d6/d1d/namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="../../d4/df6/namespacesklearn_1_1covariance.html">covariance</a></li><li class="navelem"><a class="el" href="../../d4/d45/namespacesklearn_1_1covariance_1_1__shrunk__covariance.html">_shrunk_covariance</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
