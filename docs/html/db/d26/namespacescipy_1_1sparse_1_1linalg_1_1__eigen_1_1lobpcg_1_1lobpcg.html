<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code Cloning Analysis: scipy.sparse.linalg._eigen.lobpcg.lobpcg Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Code Cloning Analysis
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('db/d26/namespacescipy_1_1sparse_1_1linalg_1_1__eigen_1_1lobpcg_1_1lobpcg.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.sparse.linalg._eigen.lobpcg.lobpcg Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a05b8200564699f6ef4260662cc4db5d7" id="r_a05b8200564699f6ef4260662cc4db5d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05b8200564699f6ef4260662cc4db5d7">_report_nonhermitian</a> (M, name)</td></tr>
<tr class="separator:a05b8200564699f6ef4260662cc4db5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45da5af0300b422573e93c0e672122a1" id="r_a45da5af0300b422573e93c0e672122a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45da5af0300b422573e93c0e672122a1">_as2d</a> (ar)</td></tr>
<tr class="separator:a45da5af0300b422573e93c0e672122a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c65b87aec5d4fb73f8851ab43a8e27" id="r_a84c65b87aec5d4fb73f8851ab43a8e27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84c65b87aec5d4fb73f8851ab43a8e27">_makeMatMat</a> (m)</td></tr>
<tr class="separator:a84c65b87aec5d4fb73f8851ab43a8e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46cba8ed7d23cbc51f6232303baa7d18" id="r_a46cba8ed7d23cbc51f6232303baa7d18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46cba8ed7d23cbc51f6232303baa7d18">_matmul_inplace</a> (x, y, verbosityLevel=0)</td></tr>
<tr class="separator:a46cba8ed7d23cbc51f6232303baa7d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf8b63bf56bf883a19b831c0a041ad80" id="r_aaf8b63bf56bf883a19b831c0a041ad80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf8b63bf56bf883a19b831c0a041ad80">_applyConstraints</a> (blockVectorV, factYBY, blockVectorBY, blockVectorY)</td></tr>
<tr class="separator:aaf8b63bf56bf883a19b831c0a041ad80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe3045667c318d3fac02cd06e9b559de" id="r_abe3045667c318d3fac02cd06e9b559de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe3045667c318d3fac02cd06e9b559de">_b_orthonormalize</a> (B, blockVectorV, blockVectorBV=None, verbosityLevel=0)</td></tr>
<tr class="separator:abe3045667c318d3fac02cd06e9b559de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5682a27b0eb65c08ffbd8d285fe59b53" id="r_a5682a27b0eb65c08ffbd8d285fe59b53"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5682a27b0eb65c08ffbd8d285fe59b53">_get_indx</a> (_lambda, num, largest)</td></tr>
<tr class="separator:a5682a27b0eb65c08ffbd8d285fe59b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1942f4339121ccbdf790f1ee8e33e297" id="r_a1942f4339121ccbdf790f1ee8e33e297"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1942f4339121ccbdf790f1ee8e33e297">_handle_gramA_gramB_verbosity</a> (gramA, gramB, verbosityLevel)</td></tr>
<tr class="separator:a1942f4339121ccbdf790f1ee8e33e297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6378c61b304e447240b89477881e677" id="r_ae6378c61b304e447240b89477881e677"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6378c61b304e447240b89477881e677">lobpcg</a> (A, X, B=None, M=None, Y=None, tol=None, maxiter=None, largest=<a class="el" href="../../d8/d0b/classTrue.html">True</a>, verbosityLevel=0, retLambdaHistory=False, retResidualNormsHistory=False, restartControl=20)</td></tr>
<tr class="separator:ae6378c61b304e447240b89477881e677"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4730f3ce2b8511c757a105c6112d3445" id="r_a4730f3ce2b8511c757a105c6112d3445"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4730f3ce2b8511c757a105c6112d3445">__all__</a> = [&quot;lobpcg&quot;]</td></tr>
<tr class="separator:a4730f3ce2b8511c757a105c6112d3445"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Locally Optimal Block Preconditioned Conjugate Gradient Method (LOBPCG).

References
----------
.. [1] A. V. Knyazev (2001),
       Toward the Optimal Preconditioned Eigensolver: Locally Optimal
       Block Preconditioned Conjugate Gradient Method.
       SIAM Journal on Scientific Computing 23, no. 2,
       pp. 517-541. :doi:`10.1137/S1064827500366124`

.. [2] A. V. Knyazev, I. Lashuk, M. E. Argentati, and E. Ovchinnikov (2007),
       Block Locally Optimal Preconditioned Eigenvalue Xolvers (BLOPEX)
       in hypre and PETSc.  :arxiv:`0705.2626`

.. [3] A. V. Knyazev's C and MATLAB implementations:
       https://github.com/lobpcg/blopex
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="aaf8b63bf56bf883a19b831c0a041ad80" name="aaf8b63bf56bf883a19b831c0a041ad80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf8b63bf56bf883a19b831c0a041ad80">&#9670;&#160;</a></span>_applyConstraints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._applyConstraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>blockVectorV</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>factYBY</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>blockVectorBY</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>blockVectorY</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Changes blockVectorV in-place.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00097">97</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00183">lobpcg()</a>.</p>

</div>
</div>
<a id="a45da5af0300b422573e93c0e672122a1" name="a45da5af0300b422573e93c0e672122a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45da5af0300b422573e93c0e672122a1">&#9670;&#160;</a></span>_as2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._as2d </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">If the input array is 2D return it, if it is 1D, append a dimension,
making it a column vector.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00047">47</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00183">lobpcg()</a>.</p>

</div>
</div>
<a id="abe3045667c318d3fac02cd06e9b559de" name="abe3045667c318d3fac02cd06e9b559de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3045667c318d3fac02cd06e9b559de">&#9670;&#160;</a></span>_b_orthonormalize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._b_orthonormalize </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>blockVectorV</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>blockVectorBV</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>verbosityLevel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">in-place B-orthonormalize the given block vector using Cholesky.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00104">104</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00069">_matmul_inplace()</a>, and <a class="el" href="../../d3/dd6/sparse_2linalg_2__matfuncs_8py_source.html#l00030">scipy.sparse.linalg._matfuncs.inv()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00183">lobpcg()</a>, and <a class="el" href="../../de/d46/test__lobpcg_8py_source.html#l00106">scipy.sparse.linalg._eigen.lobpcg.tests.test_lobpcg.test_b_orthonormalize()</a>.</p>

</div>
</div>
<a id="a5682a27b0eb65c08ffbd8d285fe59b53" name="a5682a27b0eb65c08ffbd8d285fe59b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5682a27b0eb65c08ffbd8d285fe59b53">&#9670;&#160;</a></span>_get_indx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._get_indx </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>_lambda</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>largest</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Get `num` indices into `_lambda` depending on `largest` option.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00153">153</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00030">_report_nonhermitian()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00183">lobpcg()</a>.</p>

</div>
</div>
<a id="a1942f4339121ccbdf790f1ee8e33e297" name="a1942f4339121ccbdf790f1ee8e33e297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1942f4339121ccbdf790f1ee8e33e297">&#9670;&#160;</a></span>_handle_gramA_gramB_verbosity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._handle_gramA_gramB_verbosity </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gramA</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>gramB</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>verbosityLevel</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00164">164</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

</div>
</div>
<a id="a84c65b87aec5d4fb73f8851ab43a8e27" name="a84c65b87aec5d4fb73f8851ab43a8e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c65b87aec5d4fb73f8851ab43a8e27">&#9670;&#160;</a></span>_makeMatMat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._makeMatMat </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>m</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00060">60</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

</div>
</div>
<a id="a46cba8ed7d23cbc51f6232303baa7d18" name="a46cba8ed7d23cbc51f6232303baa7d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46cba8ed7d23cbc51f6232303baa7d18">&#9670;&#160;</a></span>_matmul_inplace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._matmul_inplace </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>verbosityLevel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Perform 'np.matmul' in-place if possible.

If some sufficient conditions for inplace matmul are met, do so.
Otherwise try inplace update and fall back to overwrite if that fails.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00069">69</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00105">_b_orthonormalize()</a>, and <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00183">lobpcg()</a>.</p>

</div>
</div>
<a id="a05b8200564699f6ef4260662cc4db5d7" name="a05b8200564699f6ef4260662cc4db5d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b8200564699f6ef4260662cc4db5d7">&#9670;&#160;</a></span>_report_nonhermitian()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg._report_nonhermitian </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>M</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Report if `M` is not a Hermitian matrix given its type.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00030">30</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00153">_get_indx()</a>.</p>

</div>
</div>
<a id="ae6378c61b304e447240b89477881e677" name="ae6378c61b304e447240b89477881e677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6378c61b304e447240b89477881e677">&#9670;&#160;</a></span>lobpcg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.sparse.linalg._eigen.lobpcg.lobpcg.lobpcg </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>B</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>M</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>Y</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>tol</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>maxiter</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>largest</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="../../d8/d0b/classTrue.html">True</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>verbosityLevel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>retLambdaHistory</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>retResidualNormsHistory</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>restartControl</em></span><span class="paramdefsep"> = </span><span class="paramdefval">20</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Locally Optimal Block Preconditioned Conjugate Gradient Method (LOBPCG).

LOBPCG is a preconditioned eigensolver for large real symmetric and complex
Hermitian definite generalized eigenproblems.

Parameters
----------
A : {sparse matrix, ndarray, LinearOperator, callable object}
    The Hermitian linear operator of the problem, usually given by a
    sparse matrix.  Often called the "stiffness matrix".
X : ndarray, float32 or float64
    Initial approximation to the ``k`` eigenvectors (non-sparse).
    If `A` has ``shape=(n,n)`` then `X` must have ``shape=(n,k)``.
B : {sparse matrix, ndarray, LinearOperator, callable object}
    Optional. By default ``B = None``, which is equivalent to identity.
    The right hand side operator in a generalized eigenproblem if present.
    Often called the "mass matrix". Must be Hermitian positive definite.
M : {sparse matrix, ndarray, LinearOperator, callable object}
    Optional. By default ``M = None``, which is equivalent to identity.
    Preconditioner aiming to accelerate convergence.
Y : ndarray, float32 or float64, default: None
    An ``n-by-sizeY`` ndarray of constraints with ``sizeY &lt; n``.
    The iterations will be performed in the ``B``-orthogonal complement
    of the column-space of `Y`. `Y` must be full rank if present.
tol : scalar, optional
    The default is ``tol=n*sqrt(eps)``.
    Solver tolerance for the stopping criterion.
maxiter : int, default: 20
    Maximum number of iterations.
largest : bool, default: True
    When True, solve for the largest eigenvalues, otherwise the smallest.
verbosityLevel : int, optional
    By default ``verbosityLevel=0`` no output.
    Controls the solver standard/screen output.
retLambdaHistory : bool, default: False
    Whether to return iterative eigenvalue history.
retResidualNormsHistory : bool, default: False
    Whether to return iterative history of residual norms.
restartControl : int, optional.
    Iterations restart if the residuals jump ``2**restartControl`` times
    compared to the smallest recorded in ``retResidualNormsHistory``.
    The default is ``restartControl=20``, making the restarts rare for
    backward compatibility.

Returns
-------
lambda : ndarray of the shape ``(k, )``.
    Array of ``k`` approximate eigenvalues.
v : ndarray of the same shape as ``X.shape``.
    An array of ``k`` approximate eigenvectors.
lambdaHistory : ndarray, optional.
    The eigenvalue history, if `retLambdaHistory` is ``True``.
ResidualNormsHistory : ndarray, optional.
    The history of residual norms, if `retResidualNormsHistory`
    is ``True``.

Notes
-----
The iterative loop runs ``maxit=maxiter`` (20 if ``maxit=None``)
iterations at most and finishes earler if the tolerance is met.
Breaking backward compatibility with the previous version, LOBPCG
now returns the block of iterative vectors with the best accuracy rather
than the last one iterated, as a cure for possible divergence.

If ``X.dtype == np.float32`` and user-provided operations/multiplications
by `A`, `B`, and `M` all preserve the ``np.float32`` data type,
all the calculations and the output are in ``np.float32``.

The size of the iteration history output equals to the number of the best
(limited by `maxit`) iterations plus 3: initial, final, and postprocessing.

If both `retLambdaHistory` and `retResidualNormsHistory` are ``True``,
the return tuple has the following format
``(lambda, V, lambda history, residual norms history)``.

In the following ``n`` denotes the matrix size and ``k`` the number
of required eigenvalues (smallest or largest).

The LOBPCG code internally solves eigenproblems of the size ``3k`` on every
iteration by calling the dense eigensolver `eigh`, so if ``k`` is not
small enough compared to ``n``, it makes no sense to call the LOBPCG code.
Moreover, if one calls the LOBPCG algorithm for ``5k &gt; n``, it would likely
break internally, so the code calls the standard function `eigh` instead.
It is not that ``n`` should be large for the LOBPCG to work, but rather the
ratio ``n / k`` should be large. It you call LOBPCG with ``k=1``
and ``n=10``, it works though ``n`` is small. The method is intended
for extremely large ``n / k``.

The convergence speed depends basically on three factors:

1. Quality of the initial approximations `X` to the seeking eigenvectors.
   Randomly distributed around the origin vectors work well if no better
   choice is known.

2. Relative separation of the desired eigenvalues from the rest
   of the eigenvalues. One can vary ``k`` to improve the separation.

3. Proper preconditioning to shrink the spectral spread.
   For example, a rod vibration test problem (under tests
   directory) is ill-conditioned for large ``n``, so convergence will be
   slow, unless efficient preconditioning is used. For this specific
   problem, a good simple preconditioner function would be a linear solve
   for `A`, which is easy to code since `A` is tridiagonal.

References
----------
.. [1] A. V. Knyazev (2001),
       Toward the Optimal Preconditioned Eigensolver: Locally Optimal
       Block Preconditioned Conjugate Gradient Method.
       SIAM Journal on Scientific Computing 23, no. 2,
       pp. 517-541. :doi:`10.1137/S1064827500366124`

.. [2] A. V. Knyazev, I. Lashuk, M. E. Argentati, and E. Ovchinnikov
       (2007), Block Locally Optimal Preconditioned Eigenvalue Xolvers
       (BLOPEX) in hypre and PETSc. :arxiv:`0705.2626`

.. [3] A. V. Knyazev's C and MATLAB implementations:
       https://github.com/lobpcg/blopex

Examples
--------
Our first example is minimalistic - find the largest eigenvalue of
a diagonal matrix by solving the non-generalized eigenvalue problem
``A x = lambda x`` without constraints or preconditioning.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.sparse import spdiags
&gt;&gt;&gt; from scipy.sparse.linalg import LinearOperator, aslinearoperator
&gt;&gt;&gt; from scipy.sparse.linalg import lobpcg

The square matrix size is

&gt;&gt;&gt; n = 100

and its diagonal entries are 1, ..., 100 defined by

&gt;&gt;&gt; vals = np.arange(1, n + 1).astype(np.int16)

The first mandatory input parameter in this test is
the sparse diagonal matrix `A`
of the eigenvalue problem ``A x = lambda x`` to solve.

&gt;&gt;&gt; A = spdiags(vals, 0, n, n)
&gt;&gt;&gt; A = A.astype(np.int16)
&gt;&gt;&gt; A.toarray()
array([[  1,   0,   0, ...,   0,   0,   0],
       [  0,   2,   0, ...,   0,   0,   0],
       [  0,   0,   3, ...,   0,   0,   0],
       ...,
       [  0,   0,   0, ...,  98,   0,   0],
       [  0,   0,   0, ...,   0,  99,   0],
       [  0,   0,   0, ...,   0,   0, 100]], dtype=int16)

The second mandatory input parameter `X` is a 2D array with the
row dimension determining the number of requested eigenvalues.
`X` is an initial guess for targeted eigenvectors.
`X` must have linearly independent columns.
If no initial approximations available, randomly oriented vectors
commonly work best, e.g., with components normally distributed
around zero or uniformly distributed on the interval [-1 1].
Setting the initial approximations to dtype ``np.float32``
forces all iterative values to dtype ``np.float32`` speeding up
the run while still allowing accurate eigenvalue computations.

&gt;&gt;&gt; k = 1
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; X = rng.normal(size=(n, k))
&gt;&gt;&gt; X = X.astype(np.float32)

&gt;&gt;&gt; eigenvalues, _ = lobpcg(A, X, maxiter=60)
&gt;&gt;&gt; eigenvalues
array([100.])
&gt;&gt;&gt; eigenvalues.dtype
dtype('float32')

LOBPCG needs only access the matrix product with `A` rather
then the matrix itself. Since the matrix `A` is diagonal in
this example, one can write a function of the product
``A @ X`` using the diagonal values ``vals`` only, e.g., by
element-wise multiplication with broadcasting

&gt;&gt;&gt; A_f = lambda X: vals[:, np.newaxis] * X

and use the handle ``A_f`` to this callable function as an input

&gt;&gt;&gt; eigenvalues, _ = lobpcg(A_f, X, maxiter=60)
&gt;&gt;&gt; eigenvalues
array([100.])

The next example illustrates computing 3 smallest eigenvalues of
the same matrix given by the function handle ``A_f`` with
constraints and preconditioning.

&gt;&gt;&gt; k = 3
&gt;&gt;&gt; X = rng.normal(size=(n, k))

Constraints - an optional input parameter is a 2D array comprising
of column vectors that the eigenvectors must be orthogonal to

&gt;&gt;&gt; Y = np.eye(n, 3)

The preconditioner acts as the inverse of `A` in this example, but
in the reduced precision ``np.float32`` even though the initial `X`
and thus all iterates and the output are in full ``np.float64``.

&gt;&gt;&gt; inv_vals = 1./vals
&gt;&gt;&gt; inv_vals = inv_vals.astype(np.float32)
&gt;&gt;&gt; M = lambda X: inv_vals[:, np.newaxis] * X

Let us now solve the eigenvalue problem for the matrix `A` first
without preconditioning requesting 80 iterations

&gt;&gt;&gt; eigenvalues, _ = lobpcg(A_f, X, Y=Y, largest=False, maxiter=80)
&gt;&gt;&gt; eigenvalues
array([4., 5., 6.])
&gt;&gt;&gt; eigenvalues.dtype
dtype('float64')

With preconditioning we need only 20 iterations from the same `X`

&gt;&gt;&gt; eigenvalues, _ = lobpcg(A_f, X, Y=Y, M=M, largest=False, maxiter=20)
&gt;&gt;&gt; eigenvalues
array([4., 5., 6.])

Note that the vectors passed in `Y` are the eigenvectors of the 3
smallest eigenvalues. The results returned above are orthogonal to those.

Finally, the primary matrix `A` may be indefinite, e.g., after shifting
``vals`` by 50 from 1, ..., 100 to -49, ..., 50, we still can compute
the 3 smallest or largest eigenvalues.

&gt;&gt;&gt; vals = vals - 50
&gt;&gt;&gt; X = rng.normal(size=(n, k))
&gt;&gt;&gt; eigenvalues, _ = lobpcg(A_f, X, largest=False, maxiter=99)
&gt;&gt;&gt; eigenvalues
array([-49., -48., -47.])
&gt;&gt;&gt; eigenvalues, _ = lobpcg(A_f, X, largest=True, maxiter=99)
&gt;&gt;&gt; eigenvalues
array([50., 49., 48.])
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00170">170</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00097">_applyConstraints()</a>, <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00047">_as2d()</a>, <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00105">_b_orthonormalize()</a>, <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00153">_get_indx()</a>, <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00069">_matmul_inplace()</a>, and <a class="el" href="../../d3/d47/scipy_2sparse_2__base_8py_source.html#l01461">scipy.sparse._base.issparse()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4730f3ce2b8511c757a105c6112d3445" name="a4730f3ce2b8511c757a105c6112d3445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4730f3ce2b8511c757a105c6112d3445">&#9670;&#160;</a></span>__all__</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list scipy.sparse.linalg._eigen.lobpcg.lobpcg.__all__ = [&quot;lobpcg&quot;]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d7c/lobpcg_8py_source.html#l00027">27</a> of file <a class="el" href="../../d7/d7c/lobpcg_8py_source.html">lobpcg.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/d0f/namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="../../dd/d6f/namespacescipy_1_1sparse.html">sparse</a></li><li class="navelem"><a class="el" href="../../d9/d41/namespacescipy_1_1sparse_1_1linalg.html">linalg</a></li><li class="navelem"><a class="el" href="../../d1/d70/namespacescipy_1_1sparse_1_1linalg_1_1__eigen.html">_eigen</a></li><li class="navelem"><a class="el" href="../../d7/dbd/namespacescipy_1_1sparse_1_1linalg_1_1__eigen_1_1lobpcg.html">lobpcg</a></li><li class="navelem"><a class="el" href="../../db/d26/namespacescipy_1_1sparse_1_1linalg_1_1__eigen_1_1lobpcg_1_1lobpcg.html">lobpcg</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
