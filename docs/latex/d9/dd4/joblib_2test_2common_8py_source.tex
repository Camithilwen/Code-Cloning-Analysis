\doxysection{common.\+py}
\hypertarget{joblib_2test_2common_8py_source}{}\label{joblib_2test_2common_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/common.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/common.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1test_1_1common}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00002}00002\ \textcolor{stringliteral}{Small\ utilities\ for\ testing.}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00005}00005\ \textcolor{keyword}{import}\ gc}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00006}00006\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00007}00007\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00008}00008\ \textcolor{keyword}{import}\ sysconfig}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1__multiprocessing__helpers}{joblib.\_multiprocessing\_helpers}}\ \textcolor{keyword}{import}\ mp}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1testing}{joblib.testing}}\ \textcolor{keyword}{import}\ SkipTest,\ skipif}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00013}00013\ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00014}00014\ \ \ \ \ \textcolor{keyword}{import}\ lz4}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00015}00015\ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00016}00016\ \ \ \ \ lz4\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00018}00018\ \textcolor{comment}{\#\ TODO\ straight\ removal\ since\ in\ joblib.test.common?}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00019}00019\ IS\_PYPY\ =\ hasattr(sys,\ \textcolor{stringliteral}{"{}pypy\_version\_info"{}})}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00020}00020\ IS\_GIL\_DISABLED\ =\ (}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00021}00021\ \ \ \ \ sysconfig.get\_config\_var(\textcolor{stringliteral}{"{}Py\_GIL\_DISABLED"{}})\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ sys.\_is\_gil\_enabled()}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00022}00022\ )}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00024}00024\ \textcolor{comment}{\#\ A\ decorator\ to\ run\ tests\ only\ when\ numpy\ is\ available}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00025}00025\ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00026}00026\ \ \ \ \ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00028}\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_acaafed1ddda9f389d4e58dd38e6c26fe}{00028}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_acaafed1ddda9f389d4e58dd38e6c26fe}{with\_numpy}}(func):}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ decorator\ to\ skip\ tests\ requiring\ numpy."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ func}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00032}00032\ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00034}00034\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_acaafed1ddda9f389d4e58dd38e6c26fe}{with\_numpy}}(func):}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ decorator\ to\ skip\ tests\ requiring\ numpy."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }my\_func():}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ SkipTest(\textcolor{stringliteral}{"{}Test\ requires\ numpy"{}})}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ my\_func}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00042}00042\ \ \ \ \ np\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00044}00044\ \textcolor{comment}{\#\ TODO:\ Turn\ this\ back\ on\ after\ refactoring\ yield\ based\ tests\ in\ test\_hashing}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00045}00045\ \textcolor{comment}{\#\ with\_numpy\ =\ skipif(not\ np,\ reason='Test\ requires\ numpy.')}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00047}00047\ \textcolor{comment}{\#\ we\ use\ memory\_profiler\ library\ for\ memory\ consumption\ checks}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00048}00048\ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00049}00049\ \ \ \ \ \textcolor{keyword}{from}\ memory\_profiler\ \textcolor{keyword}{import}\ memory\_usage}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00051}\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_a33897b0dab29ee9f661d7e4fe552ecbc}{00051}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_a33897b0dab29ee9f661d7e4fe552ecbc}{with\_memory\_profiler}}(func):}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ decorator\ to\ skip\ tests\ requiring\ memory\_profiler."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ func}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00055}\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_afc837eb949aab67af0c32dca10a7f759}{00055}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_afc837eb949aab67af0c32dca10a7f759}{memory\_used}}(func,\ *args,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ memory\ usage\ when\ executing\ func."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ gc.collect()}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ mem\_use\ =\ memory\_usage((func,\ args,\ kwargs),\ interval=0.001)}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ max(mem\_use)\ -\/\ min(mem\_use)}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00061}00061\ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00063}00063\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1common_a33897b0dab29ee9f661d7e4fe552ecbc}{with\_memory\_profiler}}(func):}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ decorator\ to\ skip\ tests\ requiring\ memory\_profiler."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }dummy\_func():}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ SkipTest(\textcolor{stringliteral}{"{}Test\ requires\ memory\_profiler."{}})}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dummy\_func}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00071}00071\ \ \ \ \ memory\_usage\ =\ memory\_used\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00074}00074\ with\_multiprocessing\ =\ skipif(mp\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None},\ reason=\textcolor{stringliteral}{"{}Needs\ multiprocessing\ to\ run."{}})}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00077}00077\ with\_dev\_shm\ =\ skipif(}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00078}00078\ \ \ \ \ \textcolor{keywordflow}{not}\ os.path.exists(\textcolor{stringliteral}{"{}/dev/shm"{}}),}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00079}00079\ \ \ \ \ reason=\textcolor{stringliteral}{"{}This\ test\ requires\ a\ large\ /dev/shm\ shared\ memory\ fs."{}},}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00080}00080\ )}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00082}00082\ with\_lz4\ =\ skipif(lz4\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None},\ reason=\textcolor{stringliteral}{"{}Needs\ lz4\ compression\ to\ run"{}})}
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{joblib_2test_2common_8py_source_l00084}00084\ without\_lz4\ =\ skipif(lz4\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None},\ reason=\textcolor{stringliteral}{"{}Needs\ lz4\ not\ being\ installed\ to\ run"{}})}

\end{DoxyCode}
