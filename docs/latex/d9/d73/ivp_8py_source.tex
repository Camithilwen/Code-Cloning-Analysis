\doxysection{ivp.\+py}
\hypertarget{ivp_8py_source}{}\label{ivp_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/integrate/\_ivp/ivp.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/integrate/\_ivp/ivp.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp}{00001}}\ \textcolor{keyword}{import}\ inspect}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00002}00002\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00003}00003\ \textcolor{keyword}{from}\ .bdf\ \textcolor{keyword}{import}\ BDF}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00004}00004\ \textcolor{keyword}{from}\ .radau\ \textcolor{keyword}{import}\ Radau}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00005}00005\ \textcolor{keyword}{from}\ .rk\ \textcolor{keyword}{import}\ RK23,\ RK45,\ DOP853}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00006}00006\ \textcolor{keyword}{from}\ .lsoda\ \textcolor{keyword}{import}\ LSODA}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ OptimizeResult}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00008}00008\ \textcolor{keyword}{from}\ .common\ \textcolor{keyword}{import}\ EPS,\ OdeSolution}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00009}00009\ \textcolor{keyword}{from}\ .base\ \textcolor{keyword}{import}\ OdeSolver}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00012}00012\ METHODS\ =\ \{\textcolor{stringliteral}{'RK23'}:\ RK23,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00013}00013\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'RK45'}:\ RK45,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00014}00014\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'DOP853'}:\ DOP853,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00015}00015\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'Radau'}:\ Radau,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'BDF'}:\ BDF,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'LSODA'}:\ LSODA\}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00020}00020\ MESSAGES\ =\ \{0:\ \textcolor{stringliteral}{"{}The\ solver\ successfully\ reached\ the\ end\ of\ the\ integration\ interval."{}},}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ 1:\ \textcolor{stringliteral}{"{}A\ termination\ event\ occurred."{}}\}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00024}\mbox{\hyperlink{classscipy_1_1integrate_1_1__ivp_1_1ivp_1_1OdeResult}{00024}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1integrate_1_1__ivp_1_1ivp_1_1OdeResult}{OdeResult}}(\mbox{\hyperlink{classscipy_1_1optimize_1_1__optimize_1_1OptimizeResult}{OptimizeResult}}):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00028}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2bd524e6874fbf3d7eb6197e22f391f7}{00028}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2bd524e6874fbf3d7eb6197e22f391f7}{prepare\_events}}(events):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00029}00029\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Standardize\ event\ functions\ and\ extract\ is\_terminal\ and\ direction."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{if}\ callable(events):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ events\ =\ (events,)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{if}\ events\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ is\_terminal\ =\ np.empty(len(events),\ dtype=bool)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ direction\ =\ np.empty(len(events))}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ event\ \textcolor{keywordflow}{in}\ enumerate(events):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ is\_terminal[i]\ =\ event.terminal}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ AttributeError:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ is\_terminal[i]\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ direction[i]\ =\ event.direction}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ AttributeError:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ direction[i]\ =\ 0}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ is\_terminal\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ direction\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00050}00050\ \ \ \ \ \textcolor{keywordflow}{return}\ events,\ is\_terminal,\ direction}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00053}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_af69a224cb82ae44c7221aec878313de6}{00053}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_af69a224cb82ae44c7221aec878313de6}{solve\_event\_equation}}(event,\ sol,\ t\_old,\ t):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00054}00054\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Solve\ an\ equation\ corresponding\ to\ an\ ODE\ event.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00055}00055\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ The\ equation\ is\ \`{}\`{}event(t,\ y(t))\ =\ 0\`{}\`{},\ here\ \`{}\`{}y(t)\`{}\`{}\ is\ known\ from\ an}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ ODE\ solver\ using\ some\ sort\ of\ interpolation.\ It\ is\ solved\ by}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \`{}scipy.optimize.brentq\`{}\ with\ xtol=atol=4*EPS.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00059}00059\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ event\ :\ callable}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Function\ \`{}\`{}event(t,\ y)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ sol\ :\ callable}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Function\ \`{}\`{}sol(t)\`{}\`{}\ which\ evaluates\ an\ ODE\ solution\ between\ \`{}t\_old\`{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ \ \`{}t\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ t\_old,\ t\ :\ float}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Previous\ and\ new\ values\ of\ time.\ They\ will\ be\ used\ as\ a\ bracketing}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ interval.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00070}00070\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ root\ :\ float}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Found\ solution.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00076}00076\ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ brentq}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00077}00077\ \ \ \ \ \textcolor{keywordflow}{return}\ brentq(\textcolor{keyword}{lambda}\ t:\ event(t,\ sol(t)),\ t\_old,\ t,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xtol=4\ *\ EPS,\ rtol=4\ *\ EPS)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00081}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2e233bb8153b216ec17cdda179d98da2}{00081}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2e233bb8153b216ec17cdda179d98da2}{handle\_events}}(sol,\ events,\ active\_events,\ is\_terminal,\ t\_old,\ t):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00082}00082\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Helper\ function\ to\ handle\ events.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00083}00083\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ sol\ :\ DenseOutput}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Function\ \`{}\`{}sol(t)\`{}\`{}\ which\ evaluates\ an\ ODE\ solution\ between\ \`{}t\_old\`{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ \ \`{}t\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ events\ :\ list\ of\ callables,\ length\ n\_events}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Event\ functions\ with\ signatures\ \`{}\`{}event(t,\ y)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ active\_events\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Indices\ of\ events\ which\ occurred.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ is\_terminal\ :\ ndarray,\ shape\ (n\_events,)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Which\ events\ are\ terminal.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ t\_old,\ t\ :\ float}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Previous\ and\ new\ values\ of\ time.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00097}00097\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ root\_indices\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Indices\ of\ events\ which\ take\ zero\ between\ \`{}t\_old\`{}\ and\ \`{}t\`{}\ and\ before}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ possible\ termination.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ roots\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ of\ t\ at\ which\ events\ occurred.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ terminate\ :\ bool}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ a\ terminal\ event\ occurred.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00108}00108\ \ \ \ \ roots\ =\ [\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_af69a224cb82ae44c7221aec878313de6}{solve\_event\_equation}}(events[event\_index],\ sol,\ t\_old,\ t)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ event\_index\ \textcolor{keywordflow}{in}\ active\_events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00111}00111\ \ \ \ \ roots\ =\ np.asarray(roots)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00113}00113\ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(is\_terminal[active\_events]):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\ >\ t\_old:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ order\ =\ np.argsort(roots)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ order\ =\ np.argsort(-\/roots)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ active\_events\ =\ active\_events[order]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ roots\ =\ roots[order]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ t\ =\ np.nonzero(is\_terminal[active\_events])[0][0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ active\_events\ =\ active\_events[:t\ +\ 1]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ roots\ =\ roots[:t\ +\ 1]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ terminate\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ terminate\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00127}00127\ \ \ \ \ \textcolor{keywordflow}{return}\ active\_events,\ roots,\ terminate}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00130}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_aedb40a6f493108b392e598070ec378dc}{00130}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_aedb40a6f493108b392e598070ec378dc}{find\_active\_events}}(g,\ g\_new,\ direction):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00131}00131\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Find\ which\ event\ occurred\ during\ an\ integration\ step.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00132}00132\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ g,\ g\_new\ :\ array\_like,\ shape\ (n\_events,)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ of\ event\ functions\ at\ a\ current\ and\ next\ points.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ direction\ :\ ndarray,\ shape\ (n\_events,)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Event\ "{}direction"{}\ according\ to\ the\ definition\ in\ \`{}solve\_ivp\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00139}00139\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ active\_events\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Indices\ of\ events\ which\ occurred\ during\ the\ step.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00145}00145\ \ \ \ \ g,\ g\_new\ =\ np.asarray(g),\ np.asarray(g\_new)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00146}00146\ \ \ \ \ up\ =\ (g\ <=\ 0)\ \&\ (g\_new\ >=\ 0)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00147}00147\ \ \ \ \ down\ =\ (g\ >=\ 0)\ \&\ (g\_new\ <=\ 0)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00148}00148\ \ \ \ \ either\ =\ up\ |\ down}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00149}00149\ \ \ \ \ mask\ =\ (up\ \&\ (direction\ >\ 0)\ |}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ down\ \&\ (direction\ <\ 0)\ |}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ either\ \&\ (direction\ ==\ 0))}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00153}00153\ \ \ \ \ \textcolor{keywordflow}{return}\ np.nonzero(mask)[0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00156}\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2f365255db6d7cf4fcfeebdcc68ec11e}{00156}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2f365255db6d7cf4fcfeebdcc68ec11e}{solve\_ivp}}(fun,\ t\_span,\ y0,\ method='RK45',\ t\_eval=None,\ dense\_output=False,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ events=None,\ vectorized=False,\ args=None,\ **options):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00158}00158\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Solve\ an\ initial\ value\ problem\ for\ a\ system\ of\ ODEs.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00159}00159\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ This\ function\ numerically\ integrates\ a\ system\ of\ ordinary\ differential}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ equations\ given\ an\ initial\ value::}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00162}00162\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dy\ /\ dt\ =\ f(t,\ y)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y(t0)\ =\ y0}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00165}00165\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ Here\ t\ is\ a\ 1-\/D\ independent\ variable\ (time),\ y(t)\ is\ an}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ N-\/D\ vector-\/valued\ function\ (state),\ and\ an\ N-\/D}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ vector-\/valued\ function\ f(t,\ y)\ determines\ the\ differential\ equations.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ The\ goal\ is\ to\ find\ y(t)\ approximately\ satisfying\ the\ differential}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ equations,\ given\ an\ initial\ value\ y(t0)=y0.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00171}00171\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ Some\ of\ the\ solvers\ support\ integration\ in\ the\ complex\ domain,\ but\ note}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ that\ for\ stiff\ ODE\ solvers,\ the\ right-\/hand\ side\ must\ be}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ complex-\/differentiable\ (satisfy\ Cauchy-\/Riemann\ equations\ [11]\_).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ To\ solve\ a\ problem\ in\ the\ complex\ domain,\ pass\ y0\ with\ a\ complex\ data\ type.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ Another\ option\ always\ available\ is\ to\ rewrite\ your\ problem\ for\ real\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ imaginary\ parts\ separately.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00178}00178\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ fun\ :\ callable}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right-\/hand\ side\ of\ the\ system:\ the\ time\ derivative\ of\ the\ state\ \`{}\`{}y\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ at\ time\ \`{}\`{}t\`{}\`{}.\ The\ calling\ signature\ is\ \`{}\`{}fun(t,\ y)\`{}\`{},\ where\ \`{}\`{}t\`{}\`{}\ is\ a}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ scalar\ and\ \`{}\`{}y\`{}\`{}\ is\ an\ ndarray\ with\ \`{}\`{}len(y)\ =\ len(y0)\`{}\`{}.\ \`{}\`{}fun\`{}\`{}\ must}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\ an\ array\ of\ the\ same\ shape\ as\ \`{}\`{}y\`{}\`{}.\ See\ \`{}vectorized\`{}\ for\ more}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ information.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ t\_span\ :\ 2-\/member\ sequence}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interval\ of\ integration\ (t0,\ tf).\ The\ solver\ starts\ with\ t=t0\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ integrates\ until\ it\ reaches\ t=tf.\ Both\ t0\ and\ tf\ must\ be\ floats}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00190}00190\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ or\ values\ interpretable\ by\ the\ float\ conversion\ function.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00191}00191\ \textcolor{stringliteral}{\ \ \ \ y0\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ state.\ For\ problems\ in\ the\ complex\ domain,\ pass\ \`{}y0\`{}\ with\ a}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ complex\ data\ type\ (even\ if\ the\ initial\ value\ is\ purely\ real).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00194}00194\ \textcolor{stringliteral}{\ \ \ \ method\ :\ string\ or\ \`{}OdeSolver\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00195}00195\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Integration\ method\ to\ use:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00196}00196\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'RK45'\ (default):\ Explicit\ Runge-\/Kutta\ method\ of\ order\ 5(4)\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ The\ error\ is\ controlled\ assuming\ accuracy\ of\ the\ fourth-\/order}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ method,\ but\ steps\ are\ taken\ using\ the\ fifth-\/order\ accurate}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ formula\ (local\ extrapolation\ is\ done).\ A\ quartic\ interpolation}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ polynomial\ is\ used\ for\ the\ dense\ output\ [2]\_.\ Can\ be\ applied\ in}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ the\ complex\ domain.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'RK23':\ Explicit\ Runge-\/Kutta\ method\ of\ order\ 3(2)\ [3]\_.\ The\ error}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ is\ controlled\ assuming\ accuracy\ of\ the\ second-\/order\ method,\ but}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ steps\ are\ taken\ using\ the\ third-\/order\ accurate\ formula\ (local}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ extrapolation\ is\ done).\ A\ cubic\ Hermite\ polynomial\ is\ used\ for\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ dense\ output.\ Can\ be\ applied\ in\ the\ complex\ domain.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'DOP853':\ Explicit\ Runge-\/Kutta\ method\ of\ order\ 8\ [13]\_.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ Python\ implementation\ of\ the\ "{}DOP853"{}\ algorithm\ originally}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ written\ in\ Fortran\ [14]\_.\ A\ 7-\/th\ order\ interpolation\ polynomial}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ accurate\ to\ 7-\/th\ order\ is\ used\ for\ the\ dense\ output.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ Can\ be\ applied\ in\ the\ complex\ domain.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'Radau':\ Implicit\ Runge-\/Kutta\ method\ of\ the\ Radau\ IIA\ family\ of}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ order\ 5\ [4]\_.\ The\ error\ is\ controlled\ with\ a\ third-\/order\ accurate}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ embedded\ formula.\ A\ cubic\ polynomial\ which\ satisfies\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ collocation\ conditions\ is\ used\ for\ the\ dense\ output.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'BDF':\ Implicit\ multi-\/step\ variable-\/order\ (1\ to\ 5)\ method\ based}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ on\ a\ backward\ differentiation\ formula\ for\ the\ derivative}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ approximation\ [5]\_.\ The\ implementation\ follows\ the\ one\ described}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ [6]\_.\ A\ quasi-\/constant\ step\ scheme\ is\ used\ and\ accuracy\ is}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ enhanced\ using\ the\ NDF\ modification.\ Can\ be\ applied\ in\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ complex\ domain.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ 'LSODA':\ Adams/BDF\ method\ with\ automatic\ stiffness\ detection\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ switching\ [7]\_,\ [8]\_.\ This\ is\ a\ wrapper\ of\ the\ Fortran\ solver}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ from\ ODEPACK.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00226}00226\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Explicit\ Runge-\/Kutta\ methods\ ('RK23',\ 'RK45',\ 'DOP853')\ should\ be\ used}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ non-\/stiff\ problems\ and\ implicit\ methods\ ('Radau',\ 'BDF')\ for}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ stiff\ problems\ [9]\_.\ Among\ Runge-\/Kutta\ methods,\ 'DOP853'\ is\ recommended}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00230}00230\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ solving\ with\ high\ precision\ (low\ values\ of\ \`{}rtol\`{}\ and\ \`{}atol\`{}).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00231}00231\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00232}00232\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ not\ sure,\ first\ try\ to\ run\ 'RK45'.\ If\ it\ makes\ unusually\ many}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00233}00233\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ iterations,\ diverges,\ or\ fails,\ your\ problem\ is\ likely\ to\ be\ stiff\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ you\ should\ use\ 'Radau'\ or\ 'BDF'.\ 'LSODA'\ can\ also\ be\ a\ good\ universal}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00235}00235\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ choice,\ but\ it\ might\ be\ somewhat\ less\ convenient\ to\ work\ with\ as\ it}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ wraps\ old\ Fortran\ code.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00237}00237\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ You\ can\ also\ pass\ an\ arbitrary\ class\ derived\ from\ \`{}OdeSolver\`{}\ which}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00239}00239\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ implements\ the\ solver.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00240}00240\ \textcolor{stringliteral}{\ \ \ \ t\_eval\ :\ array\_like\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Times\ at\ which\ to\ store\ the\ computed\ solution,\ must\ be\ sorted\ and\ lie}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ within\ \`{}t\_span\`{}.\ If\ None\ (default),\ use\ points\ selected\ by\ the\ solver.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ dense\_output\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ compute\ a\ continuous\ solution.\ Default\ is\ False.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ events\ :\ callable,\ or\ list\ of\ callables,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Events\ to\ track.\ If\ None\ (default),\ no\ events\ will\ be\ tracked.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Each\ event\ occurs\ at\ the\ zeros\ of\ a\ continuous\ function\ of\ time\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ state.\ Each\ function\ must\ have\ the\ signature\ \`{}\`{}event(t,\ y)\`{}\`{}\ and\ return}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ float.\ The\ solver\ will\ find\ an\ accurate\ value\ of\ \`{}t\`{}\ at\ which}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}event(t,\ y(t))\ =\ 0\`{}\`{}\ using\ a\ root-\/finding\ algorithm.\ By\ default,\ all}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ zeros\ will\ be\ found.\ The\ solver\ looks\ for\ a\ sign\ change\ over\ each\ step,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ so\ if\ multiple\ zero\ crossings\ occur\ within\ one\ step,\ events\ may\ be}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ missed.\ Additionally\ each\ \`{}event\`{}\ function\ might\ have\ the\ following}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ attributes:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00255}00255\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ terminal:\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Whether\ to\ terminate\ integration\ if\ this\ event\ occurs.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Implicitly\ False\ if\ not\ assigned.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ direction:\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Direction\ of\ a\ zero\ crossing.\ If\ \`{}direction\`{}\ is\ positive,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}event\`{}\ will\ only\ trigger\ when\ going\ from\ negative\ to\ positive,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ and\ vice\ versa\ if\ \`{}direction\`{}\ is\ negative.\ If\ 0,\ then\ either}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ direction\ will\ trigger\ event.\ Implicitly\ 0\ if\ not\ assigned.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00264}00264\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ You\ can\ assign\ attributes\ like\ \`{}\`{}event.terminal\ =\ True\`{}\`{}\ to\ any}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ function\ in\ Python.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ vectorized\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ \`{}fun\`{}\ can\ be\ called\ in\ a\ vectorized\ fashion.\ Default\ is\ False.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00269}00269\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}vectorized\`{}\`{}\ is\ False,\ \`{}fun\`{}\ will\ always\ be\ called\ with\ \`{}\`{}y\`{}\`{}\ of}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ shape\ \`{}\`{}(n,)\`{}\`{},\ where\ \`{}\`{}n\ =\ len(y0)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00272}00272\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}vectorized\`{}\`{}\ is\ True,\ \`{}fun\`{}\ may\ be\ called\ with\ \`{}\`{}y\`{}\`{}\ of\ shape}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(n,\ k)\`{}\`{},\ where\ \`{}\`{}k\`{}\`{}\ is\ an\ integer.\ In\ this\ case,\ \`{}fun\`{}\ must\ behave}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ such\ that\ \`{}\`{}fun(t,\ y)[:,\ i]\ ==\ fun(t,\ y[:,\ i])\`{}\`{}\ (i.e.\ each\ column\ of}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ returned\ array\ is\ the\ time\ derivative\ of\ the\ state\ corresponding}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ with\ a\ column\ of\ \`{}\`{}y\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00278}00278\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00279}00279\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Setting\ \`{}\`{}vectorized=True\`{}\`{}\ allows\ for\ faster\ finite\ difference}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ approximation\ of\ the\ Jacobian\ by\ methods\ 'Radau'\ and\ 'BDF',\ but}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ result\ in\ slower\ execution\ for\ other\ methods\ and\ for\ 'Radau'\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'BDF'\ in\ some\ circumstances\ (e.g.\ small\ \`{}\`{}len(y0)\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00283}00283\ \textcolor{stringliteral}{\ \ \ \ args\ :\ tuple,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Additional\ arguments\ to\ pass\ to\ the\ user-\/defined\ functions.\ \ If\ given,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00285}00285\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ additional\ arguments\ are\ passed\ to\ all\ user-\/defined\ functions.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ So\ if,\ for\ example,\ \`{}fun\`{}\ has\ the\ signature\ \`{}\`{}fun(t,\ y,\ a,\ b,\ c)\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ then\ \`{}jac\`{}\ (if\ given)\ and\ any\ event\ functions\ must\ have\ the\ same}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ signature,\ and\ \`{}args\`{}\ must\ be\ a\ tuple\ of\ length\ 3.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00289}00289\ \textcolor{stringliteral}{\ \ \ \ **options}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Options\ passed\ to\ a\ chosen\ solver.\ All\ options\ available\ for\ already}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ implemented\ solvers\ are\ listed\ below.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ first\_step\ :\ float\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ step\ size.\ Default\ is\ \`{}None\`{}\ which\ means\ that\ the\ algorithm}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ should\ choose.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ max\_step\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ allowed\ step\ size.\ Default\ is\ np.inf,\ i.e.,\ the\ step\ size\ is\ not}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bounded\ and\ determined\ solely\ by\ the\ solver.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ rtol,\ atol\ :\ float\ or\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Relative\ and\ absolute\ tolerances.\ The\ solver\ keeps\ the\ local\ error}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ estimates\ less\ than\ \`{}\`{}atol\ +\ rtol\ *\ abs(y)\`{}\`{}.\ Here\ \`{}rtol\`{}\ controls\ a}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ relative\ accuracy\ (number\ of\ correct\ digits),\ while\ \`{}atol\`{}\ controls}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ absolute\ accuracy\ (number\ of\ correct\ decimal\ places).\ To\ achieve\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ desired\ \`{}rtol\`{},\ set\ \`{}atol\`{}\ to\ be\ smaller\ than\ the\ smallest\ value\ that}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ can\ be\ expected\ from\ \`{}\`{}rtol\ *\ abs(y)\`{}\`{}\ so\ that\ \`{}rtol\`{}\ dominates\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ allowable\ error.\ If\ \`{}atol\`{}\ is\ larger\ than\ \`{}\`{}rtol\ *\ abs(y)\`{}\`{}\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ of\ correct\ digits\ is\ not\ guaranteed.\ Conversely,\ to\ achieve\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ desired\ \`{}atol\`{}\ set\ \`{}rtol\`{}\ such\ that\ \`{}\`{}rtol\ *\ abs(y)\`{}\`{}\ is\ always\ smaller}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ than\ \`{}atol\`{}.\ If\ components\ of\ y\ have\ different\ scales,\ it\ might\ be}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ beneficial\ to\ set\ different\ \`{}atol\`{}\ values\ for\ different\ components\ by}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ passing\ array\_like\ with\ shape\ (n,)\ for\ \`{}atol\`{}.\ Default\ values\ are}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1e-\/3\ for\ \`{}rtol\`{}\ and\ 1e-\/6\ for\ \`{}atol\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ jac\ :\ array\_like,\ sparse\_matrix,\ callable\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Jacobian\ matrix\ of\ the\ right-\/hand\ side\ of\ the\ system\ with\ respect}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ y,\ required\ by\ the\ 'Radau',\ 'BDF'\ and\ 'LSODA'\ method.\ The}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Jacobian\ matrix\ has\ shape\ (n,\ n)\ and\ its\ element\ (i,\ j)\ is\ equal\ to}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}d\ f\_i\ /\ d\ y\_j\`{}\`{}.\ \ There\ are\ three\ ways\ to\ define\ the\ Jacobian:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00317}00317\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ If\ array\_like\ or\ sparse\_matrix,\ the\ Jacobian\ is\ assumed\ to}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ be\ constant.\ Not\ supported\ by\ 'LSODA'.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ If\ callable,\ the\ Jacobian\ is\ assumed\ to\ depend\ on\ both}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ t\ and\ y;\ it\ will\ be\ called\ as\ \`{}\`{}jac(t,\ y)\`{}\`{},\ as\ necessary.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ For\ 'Radau'\ and\ 'BDF'\ methods,\ the\ return\ value\ might\ be\ a}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ sparse\ matrix.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ If\ None\ (default),\ the\ Jacobian\ will\ be\ approximated\ by}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ finite\ differences.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00326}00326\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ It\ is\ generally\ recommended\ to\ provide\ the\ Jacobian\ rather\ than}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ relying\ on\ a\ finite-\/difference\ approximation.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ jac\_sparsity\ :\ array\_like,\ sparse\ matrix\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Defines\ a\ sparsity\ structure\ of\ the\ Jacobian\ matrix\ for\ a\ finite-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ difference\ approximation.\ Its\ shape\ must\ be\ (n,\ n).\ This\ argument}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ ignored\ if\ \`{}jac\`{}\ is\ not\ \`{}None\`{}.\ If\ the\ Jacobian\ has\ only\ few}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ non-\/zero\ elements\ in\ *each*\ row,\ providing\ the\ sparsity\ structure}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ greatly\ speed\ up\ the\ computations\ [10]\_.\ A\ zero\ entry\ means\ that}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ corresponding\ element\ in\ the\ Jacobian\ is\ always\ zero.\ If\ None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (default),\ the\ Jacobian\ is\ assumed\ to\ be\ dense.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Not\ supported\ by\ 'LSODA',\ see\ \`{}lband\`{}\ and\ \`{}uband\`{}\ instead.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ lband,\ uband\ :\ int\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters\ defining\ the\ bandwidth\ of\ the\ Jacobian\ for\ the\ 'LSODA'}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ method,\ i.e.,\ \`{}\`{}jac[i,\ j]\ !=\ 0\ only\ for\ i\ -\/\ lband\ <=\ j\ <=\ i\ +\ uband\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ None.\ Setting\ these\ requires\ your\ jac\ routine\ to\ return\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Jacobian\ in\ the\ packed\ format:\ the\ returned\ array\ must\ have\ \`{}\`{}n\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ columns\ and\ \`{}\`{}uband\ +\ lband\ +\ 1\`{}\`{}\ rows\ in\ which\ Jacobian\ diagonals\ are}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ written.\ Specifically\ \`{}\`{}jac\_packed[uband\ +\ i\ -\/\ j\ ,\ j]\ =\ jac[i,\ j]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ same\ format\ is\ used\ in\ \`{}scipy.linalg.solve\_banded\`{}\ (check\ for\ an}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ illustration).\ \ These\ parameters\ can\ be\ also\ used\ with\ \`{}\`{}jac=None\`{}\`{}\ to}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reduce\ the\ number\ of\ Jacobian\ elements\ estimated\ by\ finite\ differences.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ min\_step\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ minimum\ allowed\ step\ size\ for\ 'LSODA'\ method.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ By\ default\ \`{}min\_step\`{}\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00351}00351\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ Bunch\ object\ with\ the\ following\ fields\ defined:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00355}00355\ \textcolor{stringliteral}{\ \ \ \ t\ :\ ndarray,\ shape\ (n\_points,)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Time\ points.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ y\ :\ ndarray,\ shape\ (n,\ n\_points)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ of\ the\ solution\ at\ \`{}t\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ sol\ :\ \`{}OdeSolution\`{}\ or\ None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Found\ solution\ as\ \`{}OdeSolution\`{}\ instance;\ None\ if\ \`{}dense\_output\`{}\ was}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ set\ to\ False.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00362}00362\ \textcolor{stringliteral}{\ \ \ \ t\_events\ :\ list\ of\ ndarray\ or\ None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00363}00363\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Contains\ for\ each\ event\ type\ a\ list\ of\ arrays\ at\ which\ an\ event\ of}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ type\ event\ was\ detected.\ None\ if\ \`{}events\`{}\ was\ None.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00365}00365\ \textcolor{stringliteral}{\ \ \ \ y\_events\ :\ list\ of\ ndarray\ or\ None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ each\ value\ of\ \`{}t\_events\`{},\ the\ corresponding\ value\ of\ the\ solution.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ None\ if\ \`{}events\`{}\ was\ None.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ nfev\ :\ int}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ evaluations\ of\ the\ right-\/hand\ side.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ njev\ :\ int}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ evaluations\ of\ the\ Jacobian.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ nlu\ :\ int}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ LU\ decompositions.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ status\ :\ int}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Reason\ for\ algorithm\ termination:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00376}00376\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ -\/1:\ Integration\ step\ failed.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ \ 0:\ The\ solver\ successfully\ reached\ the\ end\ of\ \`{}tspan\`{}.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *\ \ 1:\ A\ termination\ event\ occurred.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00380}00380\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ message\ :\ string}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Human-\/readable\ description\ of\ the\ termination\ reason.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ success\ :\ bool}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True\ if\ the\ solver\ reached\ the\ interval\ end\ or\ a\ termination\ event}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ occurred\ (\`{}\`{}status\ >=\ 0\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00386}00386\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ J.\ R.\ Dormand,\ P.\ J.\ Prince,\ "{}A\ family\ of\ embedded\ Runge-\/Kutta}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ formulae"{},\ Journal\ of\ Computational\ and\ Applied\ Mathematics,\ Vol.\ 6,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ No.\ 1,\ pp.\ 19-\/26,\ 1980.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ L.\ W.\ Shampine,\ "{}Some\ Practical\ Runge-\/Kutta\ Formulas"{},\ Mathematics}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ of\ Computation,,\ Vol.\ 46,\ No.\ 173,\ pp.\ 135-\/150,\ 1986.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ P.\ Bogacki,\ L.F.\ Shampine,\ "{}A\ 3(2)\ Pair\ of\ Runge-\/Kutta\ Formulas"{},}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Appl.\ Math.\ Lett.\ Vol.\ 2,\ No.\ 4.\ pp.\ 321-\/325,\ 1989.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ ..\ [4]\ E.\ Hairer,\ G.\ Wanner,\ "{}Solving\ Ordinary\ Differential\ Equations\ II:}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Stiff\ and\ Differential-\/Algebraic\ Problems"{},\ Sec.\ IV.8.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ ..\ [5]\ \`{}Backward\ Differentiation\ Formula}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <https://en.wikipedia.org/wiki/Backward\_differentiation\_formula>\`{}\_}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ on\ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ ..\ [6]\ L.\ F.\ Shampine,\ M.\ W.\ Reichelt,\ "{}THE\ MATLAB\ ODE\ SUITE"{},\ SIAM\ J.\ SCI.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ COMPUTE.,\ Vol.\ 18,\ No.\ 1,\ pp.\ 1-\/22,\ January\ 1997.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ ..\ [7]\ A.\ C.\ Hindmarsh,\ "{}ODEPACK,\ A\ Systematized\ Collection\ of\ ODE}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00404}00404\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Solvers,"{}\ IMACS\ Transactions\ on\ Scientific\ Computation,\ Vol\ 1.,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ pp.\ 55-\/64,\ 1983.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ ..\ [8]\ L.\ Petzold,\ "{}Automatic\ selection\ of\ methods\ for\ solving\ stiff\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ nonstiff\ systems\ of\ ordinary\ differential\ equations"{},\ SIAM\ Journal}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ on\ Scientific\ and\ Statistical\ Computing,\ Vol.\ 4,\ No.\ 1,\ pp.\ 136-\/148,}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ 1983.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ ..\ [9]\ \`{}Stiff\ equation\ <https://en.wikipedia.org/wiki/Stiff\_equation>\`{}\_\ on}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ ..\ [10]\ A.\ Curtis,\ M.\ J.\ D.\ Powell,\ and\ J.\ Reid,\ "{}On\ the\ estimation\ of}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ sparse\ Jacobian\ matrices"{},\ Journal\ of\ the\ Institute\ of\ Mathematics}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ and\ its\ Applications,\ 13,\ pp.\ 117-\/120,\ 1974.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ ..\ [11]\ \`{}Cauchy-\/Riemann\ equations}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00416}00416\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ <https://en.wikipedia.org/wiki/Cauchy-\/Riemann\_equations>\`{}\_\ on}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ ..\ [12]\ \`{}Lotka-\/Volterra\ equations}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <https://en.wikipedia.org/wiki/Lotka\%E2\%80\%93Volterra\_equations>\`{}\_}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ on\ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ ..\ [13]\ E.\ Hairer,\ S.\ P.\ Norsett\ G.\ Wanner,\ "{}Solving\ Ordinary\ Differential}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00422}00422\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Equations\ I:\ Nonstiff\ Problems"{},\ Sec.\ II.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ ..\ [14]\ \`{}Page\ with\ original\ Fortran\ code\ of\ DOP853}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <http://www.unige.ch/\string~hairer/software.html>\`{}\_.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00425}00425\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ Basic\ exponential\ decay\ showing\ automatically\ chosen\ time\ points.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00429}00429\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.integrate\ import\ solve\_ivp}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ exponential\_decay(t,\ y):\ return\ -\/0.5\ *\ y}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ >>>\ sol\ =\ solve\_ivp(exponential\_decay,\ [0,\ 10],\ [2,\ 4,\ 8])}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ [\ 0.\ \ \ \ \ \ \ \ \ \ 0.11487653\ \ 1.26364188\ \ 3.06061781\ \ 4.81611105\ \ 6.57445806}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00436}00436\ \textcolor{stringliteral}{\ \ \ \ \ \ 8.33328988\ 10.\ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00437}00437\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.y)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ [[2.\ \ \ \ \ \ \ \ \ 1.88836035\ 1.06327177\ 0.43319312\ 0.18017253\ 0.07483045}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ \ \ 0.03107158\ 0.01350781]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ \ [4.\ \ \ \ \ \ \ \ \ 3.7767207\ \ 2.12654355\ 0.86638624\ 0.36034507\ 0.14966091}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ \ \ 0.06214316\ 0.02701561]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ \ [8.\ \ \ \ \ \ \ \ \ 7.5534414\ \ 4.25308709\ 1.73277247\ 0.72069014\ 0.29932181}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ \ \ 0.12428631\ 0.05403123]]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00444}00444\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ Specifying\ points\ where\ the\ solution\ is\ desired.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00446}00446\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ >>>\ sol\ =\ solve\_ivp(exponential\_decay,\ [0,\ 10],\ [2,\ 4,\ 8],}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00448}00448\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval=[0,\ 1,\ 2,\ 4,\ 10])}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ [\ 0\ \ 1\ \ 2\ \ 4\ 10]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.y)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ [[2.\ \ \ \ \ \ \ \ \ 1.21305369\ 0.73534021\ 0.27066736\ 0.01350938]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ \ [4.\ \ \ \ \ \ \ \ \ 2.42610739\ 1.47068043\ 0.54133472\ 0.02701876]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ [8.\ \ \ \ \ \ \ \ \ 4.85221478\ 2.94136085\ 1.08266944\ 0.05403753]]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00455}00455\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00456}00456\ \textcolor{stringliteral}{\ \ \ \ Cannon\ fired\ upward\ with\ terminal\ event\ upon\ impact.\ The\ \`{}\`{}terminal\`{}\`{}\ and}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}direction\`{}\`{}\ fields\ of\ an\ event\ are\ applied\ by\ monkey\ patching\ a\ function.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ Here\ \`{}\`{}y[0]\`{}\`{}\ is\ position\ and\ \`{}\`{}y[1]\`{}\`{}\ is\ velocity.\ The\ projectile\ starts}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ at\ position\ 0\ with\ velocity\ +10.\ Note\ that\ the\ integration\ never\ reaches}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ t=100\ because\ the\ event\ is\ terminal.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00461}00461\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ upward\_cannon(t,\ y):\ return\ [y[1],\ -\/0.5]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ hit\_ground(t,\ y):\ return\ y[0]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00464}00464\ \textcolor{stringliteral}{\ \ \ \ >>>\ hit\_ground.terminal\ =\ True}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00465}00465\ \textcolor{stringliteral}{\ \ \ \ >>>\ hit\_ground.direction\ =\ -\/1}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ >>>\ sol\ =\ solve\_ivp(upward\_cannon,\ [0,\ 100],\ [0,\ 10],\ events=hit\_ground)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00467}00467\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t\_events)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ [array([40.])]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00470}00470\ \textcolor{stringliteral}{\ \ \ \ [0.00000000e+00\ 9.99900010e-\/05\ 1.09989001e-\/03\ 1.10988901e-\/02}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ \ 1.11088891e-\/01\ 1.11098890e+00\ 1.11099890e+01\ 4.00000000e+01]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00472}00472\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ Use\ \`{}dense\_output\`{}\ and\ \`{}events\`{}\ to\ find\ position,\ which\ is\ 100,\ at\ the\ apex}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00474}00474\ \textcolor{stringliteral}{\ \ \ \ of\ the\ cannonball's\ trajectory.\ Apex\ is\ not\ defined\ as\ terminal,\ so\ both}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ apex\ and\ hit\_ground\ are\ found.\ There\ is\ no\ information\ at\ t=20,\ so\ the\ sol}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ attribute\ is\ used\ to\ evaluate\ the\ solution.\ The\ sol\ attribute\ is\ returned}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00477}00477\ \textcolor{stringliteral}{\ \ \ \ by\ setting\ \`{}\`{}dense\_output=True\`{}\`{}.\ Alternatively,\ the\ \`{}y\_events\`{}\ attribute}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00478}00478\ \textcolor{stringliteral}{\ \ \ \ can\ be\ used\ to\ access\ the\ solution\ at\ the\ time\ of\ the\ event.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00479}00479\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00480}00480\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ apex(t,\ y):\ return\ y[1]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ >>>\ sol\ =\ solve\_ivp(upward\_cannon,\ [0,\ 100],\ [0,\ 10],}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ events=(hit\_ground,\ apex),\ dense\_output=True)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t\_events)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ [array([40.]),\ array([20.])]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.t)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ [0.00000000e+00\ 9.99900010e-\/05\ 1.09989001e-\/03\ 1.10988901e-\/02}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ \ 1.11088891e-\/01\ 1.11098890e+00\ 1.11099890e+01\ 4.00000000e+01]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.sol(sol.t\_events[1][0]))}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ [100.\ \ \ 0.]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00490}00490\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(sol.y\_events)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ [array([[-\/5.68434189e-\/14,\ -\/1.00000000e+01]]),\ array([[1.00000000e+02,\ 1.77635684e-\/15]])]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00492}00492\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00493}00493\ \textcolor{stringliteral}{\ \ \ \ As\ an\ example\ of\ a\ system\ with\ additional\ parameters,\ we'll\ implement}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ the\ Lotka-\/Volterra\ equations\ [12]\_.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00495}00495\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ lotkavolterra(t,\ z,\ a,\ b,\ c,\ d):}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00497}00497\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ x,\ y\ =\ z}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ [a*x\ -\/\ b*x*y,\ -\/c*y\ +\ d*x*y]}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ ...}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00500}00500\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ We\ pass\ in\ the\ parameter\ values\ a=1.5,\ b=1,\ c=3\ and\ d=1\ with\ the\ \`{}args\`{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ argument.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00503}00503\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ >>>\ sol\ =\ solve\_ivp(lotkavolterra,\ [0,\ 15],\ [10,\ 5],\ args=(1.5,\ 1,\ 3,\ 1),}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dense\_output=True)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00506}00506\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ Compute\ a\ dense\ solution\ and\ plot\ it.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00508}00508\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ >>>\ t\ =\ np.linspace(0,\ 15,\ 300)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ >>>\ z\ =\ sol.sol(t)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00511}00511\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(t,\ z.T)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00513}00513\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.xlabel('t')}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00514}00514\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.legend(['x',\ 'y'],\ shadow=True)}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00515}00515\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.title('Lotka-\/Volterra\ System')}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00516}00516\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00517}00517\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00519}00519\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ METHODS\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ (}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ inspect.isclass(method)\ \textcolor{keywordflow}{and}\ issubclass(method,\ OdeSolver)):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}method`\ must\ be\ one\ of\ \{\}\ or\ OdeSolver\ class."{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00522}00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(METHODS))}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00523}00523\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00524}00524\ \ \ \ \ t0,\ tf\ =\ map(float,\ t\_span)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00525}00525\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00526}00526\ \ \ \ \ \textcolor{keywordflow}{if}\ args\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Wrap\ the\ user's\ fun\ (and\ jac,\ if\ given)\ in\ lambdas\ to\ hide\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00528}00528\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ additional\ parameters.\ \ Pass\ in\ the\ original\ fun\ as\ a\ keyword}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00529}00529\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ argument\ to\ keep\ it\ in\ the\ scope\ of\ the\ lambda.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00531}00531\ \ \ \ \ \ \ \ \ \ \ \ \ \_\ =\ [*(args)]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00532}00532\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError\ \textcolor{keyword}{as}\ exp:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00533}00533\ \ \ \ \ \ \ \ \ \ \ \ \ suggestion\_tuple\ =\ (}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00534}00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Supplied\ 'args'\ cannot\ be\ unpacked.\ Please\ supply\ \`{}args`"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00535}00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ as\ a\ tuple\ (e.g.\ \`{}args=(\{args\},)`)"{}}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00536}00536\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00537}00537\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(suggestion\_tuple)\ \textcolor{keyword}{from}\ exp}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00538}00538\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }fun(t,\ x,\ fun=fun):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fun(t,\ x,\ *args)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ jac\ =\ options.get(\textcolor{stringliteral}{'jac'})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ callable(jac):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00543}00543\ \ \ \ \ \ \ \ \ \ \ \ \ options[\textcolor{stringliteral}{'jac'}]\ =\ \textcolor{keyword}{lambda}\ t,\ x:\ jac(t,\ x,\ *args)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00544}00544\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00545}00545\ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00546}00546\ \ \ \ \ \ \ \ \ t\_eval\ =\ np.asarray(t\_eval)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00547}00547\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval.ndim\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00548}00548\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}t\_eval`\ must\ be\ 1-\/dimensional."{}})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00549}00549\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00550}00550\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(t\_eval\ <\ min(t0,\ tf))\ \textcolor{keywordflow}{or}\ np.any(t\_eval\ >\ max(t0,\ tf)):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00551}00551\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Values\ in\ \`{}t\_eval`\ are\ not\ within\ \`{}t\_span`."{}})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00552}00552\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ d\ =\ np.diff(t\_eval)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00554}00554\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tf\ >\ t0\ \textcolor{keywordflow}{and}\ np.any(d\ <=\ 0)\ \textcolor{keywordflow}{or}\ tf\ <\ t0\ \textcolor{keywordflow}{and}\ np.any(d\ >=\ 0):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00555}00555\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Values\ in\ \`{}t\_eval`\ are\ not\ properly\ sorted."{}})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00556}00556\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00557}00557\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tf\ >\ t0:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00558}00558\ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_i\ =\ 0}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ order\ of\ t\_eval\ decreasing\ to\ use\ np.searchsorted.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\ =\ t\_eval[::-\/1]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ will\ be\ an\ upper\ bound\ for\ slices.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00563}00563\ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_i\ =\ t\_eval.shape[0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00564}00564\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00565}00565\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ \textcolor{keywordflow}{in}\ METHODS:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ method\ =\ METHODS[method]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00567}00567\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00568}00568\ \ \ \ \ solver\ =\ method(fun,\ t0,\ y0,\ tf,\ vectorized=vectorized,\ **options)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00569}00569\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00570}00570\ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00571}00571\ \ \ \ \ \ \ \ \ ts\ =\ [t0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ ys\ =\ [y0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00573}00573\ \ \ \ \ \textcolor{keywordflow}{elif}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ dense\_output:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00574}00574\ \ \ \ \ \ \ \ \ ts\ =\ []}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00575}00575\ \ \ \ \ \ \ \ \ ti\ =\ [t0]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00576}00576\ \ \ \ \ \ \ \ \ ys\ =\ []}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00577}00577\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ ts\ =\ []}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00579}00579\ \ \ \ \ \ \ \ \ ys\ =\ []}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00580}00580\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00581}00581\ \ \ \ \ interpolants\ =\ []}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00582}00582\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00583}00583\ \ \ \ \ events,\ is\_terminal,\ event\_dir\ =\ \mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2bd524e6874fbf3d7eb6197e22f391f7}{prepare\_events}}(events)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00584}00584\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00585}00585\ \ \ \ \ \textcolor{keywordflow}{if}\ events\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ args\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Wrap\ user\ functions\ in\ lambdas\ to\ hide\ the\ additional\ parameters.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ original\ event\ function\ is\ passed\ as\ a\ keyword\ argument\ to\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ lambda\ to\ keep\ the\ original\ function\ in\ scope\ (i.e.,\ avoid\ the}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00590}00590\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ late\ binding\ closure\ "{}gotcha"{}).}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00591}00591\ \ \ \ \ \ \ \ \ \ \ \ \ events\ =\ [\textcolor{keyword}{lambda}\ t,\ x,\ event=event:\ event(t,\ x,\ *args)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00592}00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ event\ \textcolor{keywordflow}{in}\ events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00593}00593\ \ \ \ \ \ \ \ \ g\ =\ [event(t0,\ y0)\ \textcolor{keywordflow}{for}\ event\ \textcolor{keywordflow}{in}\ events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00594}00594\ \ \ \ \ \ \ \ \ t\_events\ =\ [[]\ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(len(events))]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00595}00595\ \ \ \ \ \ \ \ \ y\_events\ =\ [[]\ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(len(events))]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00596}00596\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00597}00597\ \ \ \ \ \ \ \ \ t\_events\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00598}00598\ \ \ \ \ \ \ \ \ y\_events\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00599}00599\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00600}00600\ \ \ \ \ status\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00601}00601\ \ \ \ \ \textcolor{keywordflow}{while}\ status\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ message\ =\ solver.step()}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00603}00603\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ solver.status\ ==\ \textcolor{stringliteral}{'finished'}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00605}00605\ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ 0}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ solver.status\ ==\ \textcolor{stringliteral}{'failed'}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00609}00609\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ t\_old\ =\ solver.t\_old}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ t\ =\ solver.t}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ y\ =\ solver.y}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00613}00613\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dense\_output:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ solver.dense\_output()}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ interpolants.append(sol)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00619}00619\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ events\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ \ \ \ \ g\_new\ =\ [event(t,\ y)\ \textcolor{keywordflow}{for}\ event\ \textcolor{keywordflow}{in}\ events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ \ \ \ \ active\_events\ =\ \mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_aedb40a6f493108b392e598070ec378dc}{find\_active\_events}}(g,\ g\_new,\ event\_dir)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ active\_events.size\ >\ 0:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sol\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ solver.dense\_output()}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00626}00626\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ root\_indices,\ roots,\ terminate\ =\ \mbox{\hyperlink{namespacescipy_1_1integrate_1_1__ivp_1_1ivp_a2e233bb8153b216ec17cdda179d98da2}{handle\_events}}(}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sol,\ events,\ active\_events,\ is\_terminal,\ t\_old,\ t)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00629}00629\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ e,\ te\ \textcolor{keywordflow}{in}\ zip(root\_indices,\ roots):}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_events[e].append(te)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\_events[e].append(sol(te))}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00633}00633\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ terminate:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status\ =\ 1}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ roots[-\/1]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ sol(t)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00638}00638\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ \ \ \ \ g\ =\ g\_new}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00640}00640\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ \ \ \ \ ts.append(t)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00643}00643\ \ \ \ \ \ \ \ \ \ \ \ \ ys.append(y)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00645}00645\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ value\ in\ t\_eval\ equal\ to\ t\ will\ be\ included.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00646}00646\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ solver.direction\ >\ 0:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_i\_new\ =\ np.searchsorted(t\_eval,\ t,\ side=\textcolor{stringliteral}{'right'})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_step\ =\ t\_eval[t\_eval\_i:t\_eval\_i\_new]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_i\_new\ =\ np.searchsorted(t\_eval,\ t,\ side=\textcolor{stringliteral}{'left'})}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ It\ has\ to\ be\ done\ with\ two\ slice\ operations,\ because}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ you\ can't\ slice\ to\ 0th\ element\ inclusive\ using\ backward}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ slicing.}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_step\ =\ t\_eval[t\_eval\_i\_new:t\_eval\_i][::-\/1]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00655}00655\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\_step.size\ >\ 0:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sol\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ solver.dense\_output()}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ts.append(t\_eval\_step)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ys.append(sol(t\_eval\_step))}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\_eval\_i\ =\ t\_eval\_i\_new}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00662}00662\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ dense\_output:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ ti.append(t)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00665}00665\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00666}00666\ \ \ \ \ message\ =\ MESSAGES.get(status,\ message)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00668}00668\ \ \ \ \ \textcolor{keywordflow}{if}\ t\_events\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00669}00669\ \ \ \ \ \ \ \ \ t\_events\ =\ [np.asarray(te)\ \textcolor{keywordflow}{for}\ te\ \textcolor{keywordflow}{in}\ t\_events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00670}00670\ \ \ \ \ \ \ \ \ y\_events\ =\ [np.asarray(ye)\ \textcolor{keywordflow}{for}\ ye\ \textcolor{keywordflow}{in}\ y\_events]}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00671}00671\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00672}00672\ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00673}00673\ \ \ \ \ \ \ \ \ ts\ =\ np.array(ts)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ ys\ =\ np.vstack(ys).T}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00675}00675\ \ \ \ \ \textcolor{keywordflow}{elif}\ ts:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00676}00676\ \ \ \ \ \ \ \ \ ts\ =\ np.hstack(ts)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00677}00677\ \ \ \ \ \ \ \ \ ys\ =\ np.hstack(ys)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00678}00678\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00679}00679\ \ \ \ \ \textcolor{keywordflow}{if}\ dense\_output:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t\_eval\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ \mbox{\hyperlink{classscipy_1_1integrate_1_1__ivp_1_1common_1_1OdeSolution}{OdeSolution}}(ts,\ interpolants)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ \ \ \ \ sol\ =\ \mbox{\hyperlink{classscipy_1_1integrate_1_1__ivp_1_1common_1_1OdeSolution}{OdeSolution}}(ti,\ interpolants)}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00684}00684\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00685}00685\ \ \ \ \ \ \ \ \ sol\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00686}00686\ }
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00687}00687\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1integrate_1_1__ivp_1_1ivp_1_1OdeResult}{OdeResult}}(t=ts,\ y=ys,\ sol=sol,\ t\_events=t\_events,\ y\_events=y\_events,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00688}00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nfev=solver.nfev,\ njev=solver.njev,\ nlu=solver.nlu,}
\DoxyCodeLine{\Hypertarget{ivp_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ status=status,\ message=message,\ success=status\ >=\ 0)}

\end{DoxyCode}
