\doxysection{test\+\_\+decomp\+\_\+ldl.\+py}
\hypertarget{test__decomp__ldl_8py_source}{}\label{test__decomp__ldl_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/tests/test\_decomp\_ldl.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/tests/test\_decomp\_ldl.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1tests_1_1test__decomp__ldl}{00001}}\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_array\_almost\_equal,\ assert\_allclose,\ assert\_}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00002}00002\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ (array,\ eye,\ zeros,\ empty\_like,\ empty,\ tril\_indices\_from,}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00003}00003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tril,\ triu\_indices\_from,\ spacing,\ float32,\ float64,}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00004}00004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ complex64,\ complex128)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1random}{numpy.random}}\ \textcolor{keyword}{import}\ rand,\ randint,\ seed}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1linalg}{scipy.linalg}}\ \textcolor{keyword}{import}\ ldl}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00007}00007\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00008}00008\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises,\ warns}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00009}00009\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ ComplexWarning}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00012}00012\ \textcolor{keyword}{def\ }test\_args():}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00013}00013\ \ \ \ \ A\ =\ eye(3)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00014}00014\ \ \ \ \ \textcolor{comment}{\#\ Nonsquare\ array}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00015}00015\ \ \ \ \ assert\_raises(ValueError,\ ldl,\ A[:,\ :2])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00016}00016\ \ \ \ \ \textcolor{comment}{\#\ Complex\ matrix\ with\ imaginary\ diagonal\ entries\ with\ "{}hermitian=True"{}}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00017}00017\ \ \ \ \ \textcolor{keyword}{with}\ warns(ComplexWarning):}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(A*1j)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00021}00021\ \textcolor{keyword}{def\ }test\_empty\_array():}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00022}00022\ \ \ \ \ a\ =\ empty((0,\ 0),\ dtype=complex)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00023}00023\ \ \ \ \ l,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(empty((0,\ 0)))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00024}00024\ \ \ \ \ assert\_array\_almost\_equal(l,\ empty\_like(a))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00025}00025\ \ \ \ \ assert\_array\_almost\_equal(d,\ empty\_like(a))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00026}00026\ \ \ \ \ assert\_array\_almost\_equal(p,\ array([],\ dtype=int))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00029}00029\ \textcolor{keyword}{def\ }test\_simple():}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00030}00030\ \ \ \ \ a\ =\ array([[-\/0.39-\/0.71j,\ 5.14-\/0.64j,\ -\/7.86-\/2.96j,\ 3.80+0.92j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5.14-\/0.64j,\ 8.86+1.81j,\ -\/3.52+0.58j,\ 5.32-\/1.59j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/7.86-\/2.96j,\ -\/3.52+0.58j,\ -\/2.83-\/0.03j,\ -\/1.54-\/2.86j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3.80+0.92j,\ 5.32-\/1.59j,\ -\/1.54-\/2.86j,\ -\/0.56+0.12j]])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00034}00034\ \ \ \ \ b\ =\ array([[5.,\ 10,\ 1,\ 18],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10.,\ 2,\ 11,\ 1],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.,\ 11,\ 19,\ 9],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [18.,\ 1,\ 9,\ 0]])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00038}00038\ \ \ \ \ c\ =\ array([[52.,\ 97,\ 112,\ 107,\ 50],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [97.,\ 114,\ 89,\ 98,\ 13],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [112.,\ 89,\ 64,\ 33,\ 6],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [107.,\ 98,\ 33,\ 60,\ 73],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [50.,\ 13,\ 6,\ 73,\ 77]])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00044}00044\ \ \ \ \ d\ =\ array([[2.,\ 2,\ -\/4,\ 0,\ 4],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.,\ -\/2,\ -\/2,\ 10,\ -\/8],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/4.,\ -\/2,\ 6,\ -\/8,\ -\/4],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 10,\ -\/8,\ 6,\ -\/6],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4.,\ -\/8,\ -\/4,\ -\/6,\ 10]])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00049}00049\ \ \ \ \ e\ =\ array([[-\/1.36+0.00j,\ 0+0j,\ 0+0j,\ 0+0j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.58-\/0.90j,\ -\/8.87+0j,\ 0+0j,\ 0+0j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.21+0.21j,\ -\/1.84+0.03j,\ -\/4.63+0j,\ 0+0j],}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3.91-\/1.50j,\ -\/1.78-\/1.18j,\ 0.11-\/0.11j,\ -\/1.84+0.00j]])}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ (b,\ c,\ d):}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ l,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ assert\_allclose(l.dot(d).dot(l.T),\ x,\ atol=spacing(1000.),\ rtol=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ u,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ assert\_allclose(u.dot(d).dot(u.T),\ x,\ atol=spacing(1000.),\ rtol=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00060}00060\ \ \ \ \ l,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(a,\ hermitian=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00061}00061\ \ \ \ \ assert\_allclose(l.dot(d).dot(l.T),\ a,\ atol=spacing(1000.),\ rtol=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00063}00063\ \ \ \ \ u,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(a,\ lower=\textcolor{keyword}{False},\ hermitian=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00064}00064\ \ \ \ \ assert\_allclose(u.dot(d).dot(u.T),\ a,\ atol=spacing(1000.),\ rtol=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00066}00066\ \ \ \ \ \textcolor{comment}{\#\ Use\ upper\ part\ for\ the\ computation\ and\ use\ the\ lower\ part\ for\ comparison}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00067}00067\ \ \ \ \ l,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(e.conj().T,\ lower=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00068}00068\ \ \ \ \ assert\_allclose(\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__special__matrices_a5e9df53d999e3af2182cfee51b697af2}{tril}}(l.dot(d).dot(l.conj().T)-\/e),\ zeros((4,\ 4)),}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ atol=spacing(1000.),\ rtol=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00072}00072\ \textcolor{keyword}{def\ }test\_permutations():}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00073}00073\ \ \ \ \ seed(1234)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00074}00074\ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(10):}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ n\ =\ randint(1,\ 100)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Random\ real/complex\ array}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ x\ =\ rand(n,\ n)\ \textcolor{keywordflow}{if}\ randint(2)\ \textcolor{keywordflow}{else}\ rand(n,\ n)\ +\ rand(n,\ n)*1j}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ x\ =\ x\ +\ x.conj().T}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ x\ +=\ eye(n)*randint(5,\ 1e6)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ l\_ind\ =\ tril\_indices\_from(x,\ k=-\/1)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ u\_ind\ =\ triu\_indices\_from(x,\ k=1)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ whether\ permutations\ lead\ to\ a\ triangular\ array}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ u,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ lower\ part\ should\ be\ zero}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ assert\_(\textcolor{keywordflow}{not}\ any(u[p,\ :][l\_ind]),\ f\textcolor{stringliteral}{'Spin\ \{\_\}\ failed'})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ l,\ d,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=1)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ upper\ part\ should\ be\ zero}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ assert\_(\textcolor{keywordflow}{not}\ any(l[p,\ :][u\_ind]),\ f\textcolor{stringliteral}{'Spin\ \{\_\}\ failed'})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00093}00093\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}dtype"{},\ [float32,\ float64])}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00094}00094\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n"{},\ [30,\ 150])}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00095}00095\ \textcolor{keyword}{def\ }test\_ldl\_type\_size\_combinations\_real(n,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00096}00096\ \ \ \ \ seed(1234)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00097}00097\ \ \ \ \ msg\ =\ (f\textcolor{stringliteral}{"{}Failed\ for\ size:\ \{n\},\ dtype:\ \{dtype\}"{}})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00099}00099\ \ \ \ \ x\ =\ rand(n,\ n).astype(dtype)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00100}00100\ \ \ \ \ x\ =\ x\ +\ x.T}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00101}00101\ \ \ \ \ x\ +=\ eye(n,\ dtype=dtype)*\mbox{\hyperlink{namespacedtype}{dtype}}(randint(5,\ 1e6))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00103}00103\ \ \ \ \ l,\ d1,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00104}00104\ \ \ \ \ u,\ d2,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00105}00105\ \ \ \ \ rtol\ =\ 1e-\/4\ \textcolor{keywordflow}{if}\ dtype\ \textcolor{keywordflow}{is}\ float32\ \textcolor{keywordflow}{else}\ 1e-\/10}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00106}00106\ \ \ \ \ assert\_allclose(l.dot(d1).dot(l.T),\ x,\ rtol=rtol,\ err\_msg=msg)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00107}00107\ \ \ \ \ assert\_allclose(u.dot(d2).dot(u.T),\ x,\ rtol=rtol,\ err\_msg=msg)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00110}00110\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}dtype"{},\ [complex64,\ complex128])}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00111}00111\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n"{},\ [30,\ 150])}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00112}00112\ \textcolor{keyword}{def\ }test\_ldl\_type\_size\_combinations\_complex(n,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00113}00113\ \ \ \ \ seed(1234)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00114}00114\ \ \ \ \ msg1\ =\ (f\textcolor{stringliteral}{"{}Her\ failed\ for\ size:\ \{n\},\ dtype:\ \{dtype\}"{}})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00115}00115\ \ \ \ \ msg2\ =\ (f\textcolor{stringliteral}{"{}Sym\ failed\ for\ size:\ \{n\},\ dtype:\ \{dtype\}"{}})}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00117}00117\ \ \ \ \ \textcolor{comment}{\#\ Complex\ hermitian\ upper/lower}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00118}00118\ \ \ \ \ x\ =\ (rand(n,\ n)+1j*rand(n,\ n)).astype(dtype)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00119}00119\ \ \ \ \ x\ =\ x+x.conj().T}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00120}00120\ \ \ \ \ x\ +=\ eye(n,\ dtype=dtype)*\mbox{\hyperlink{namespacedtype}{dtype}}(randint(5,\ 1e6))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00122}00122\ \ \ \ \ l,\ d1,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00123}00123\ \ \ \ \ u,\ d2,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00124}00124\ \ \ \ \ rtol\ =\ 2e-\/4\ \textcolor{keywordflow}{if}\ dtype\ \textcolor{keywordflow}{is}\ complex64\ \textcolor{keywordflow}{else}\ 1e-\/10}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00125}00125\ \ \ \ \ assert\_allclose(l.dot(d1).dot(l.conj().T),\ x,\ rtol=rtol,\ err\_msg=msg1)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00126}00126\ \ \ \ \ assert\_allclose(u.dot(d2).dot(u.conj().T),\ x,\ rtol=rtol,\ err\_msg=msg1)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00128}00128\ \ \ \ \ \textcolor{comment}{\#\ Complex\ symmetric\ upper/lower}}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00129}00129\ \ \ \ \ x\ =\ (rand(n,\ n)+1j*rand(n,\ n)).astype(dtype)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00130}00130\ \ \ \ \ x\ =\ x+x.T}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00131}00131\ \ \ \ \ x\ +=\ eye(n,\ dtype=dtype)*\mbox{\hyperlink{namespacedtype}{dtype}}(randint(5,\ 1e6))}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00133}00133\ \ \ \ \ l,\ d1,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ hermitian=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00134}00134\ \ \ \ \ u,\ d2,\ p\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(x,\ lower=0,\ hermitian=0)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00135}00135\ \ \ \ \ assert\_allclose(l.dot(d1).dot(l.T),\ x,\ rtol=rtol,\ err\_msg=msg2)}
\DoxyCodeLine{\Hypertarget{test__decomp__ldl_8py_source_l00136}00136\ \ \ \ \ assert\_allclose(u.dot(d2).dot(u.T),\ x,\ rtol=rtol,\ err\_msg=msg2)}

\end{DoxyCode}
