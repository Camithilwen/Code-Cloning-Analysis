\doxysection{test\+\_\+kernel\+\_\+pca.\+py}
\hypertarget{test__kernel__pca_8py_source}{}\label{test__kernel__pca_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/decomposition/tests/test\_kernel\_pca.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/decomposition/tests/test\_kernel\_pca.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca}{00001}}\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00004}00004\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00006}00006\ \textcolor{keyword}{import}\ sklearn}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1datasets}{sklearn.datasets}}\ \textcolor{keyword}{import}\ load\_iris,\ make\_blobs,\ make\_circles}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1decomposition}{sklearn.decomposition}}\ \textcolor{keyword}{import}\ PCA,\ KernelPCA}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1exceptions}{sklearn.exceptions}}\ \textcolor{keyword}{import}\ NotFittedError}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1linear__model}{sklearn.linear\_model}}\ \textcolor{keyword}{import}\ Perceptron}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1metrics_1_1pairwise}{sklearn.metrics.pairwise}}\ \textcolor{keyword}{import}\ rbf\_kernel}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00012}00012\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1model__selection}{sklearn.model\_selection}}\ \textcolor{keyword}{import}\ GridSearchCV}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00013}00013\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1pipeline}{sklearn.pipeline}}\ \textcolor{keyword}{import}\ Pipeline}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1preprocessing}{sklearn.preprocessing}}\ \textcolor{keyword}{import}\ StandardScaler}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00015}00015\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1__testing}{sklearn.utils.\_testing}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00016}00016\ \ \ \ \ assert\_allclose,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00017}00017\ \ \ \ \ assert\_array\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00018}00018\ \ \ \ \ assert\_array\_equal,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00019}00019\ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00020}00020\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1fixes}{sklearn.utils.fixes}}\ \textcolor{keyword}{import}\ CSR\_CONTAINERS}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00021}00021\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1validation}{sklearn.utils.validation}}\ \textcolor{keyword}{import}\ \_check\_psd\_eigenvalues}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00024}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a56b80857f8dfc7269d080aae24dabe4b}{00024}}\ \textcolor{keyword}{def\ }test\_kernel\_pca(global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00025}00025\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Nominal\ test\ for\ all\ solvers\ and\ all\ known\ kernels\ +\ a\ custom\ one}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00026}00026\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ It\ tests}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ \ -\/\ that\ fit\_transform\ is\ equivalent\ to\ fit+transform}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ -\/\ that\ the\ shapes\ of\ transforms\ and\ inverse\ transforms\ are\ correct}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00031}00031\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00032}00032\ \ \ \ \ X\_fit\ =\ rng.random\_sample((5,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00033}00033\ \ \ \ \ X\_pred\ =\ rng.random\_sample((2,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00035}00035\ \ \ \ \ \textcolor{keyword}{def\ }histogram(x,\ y,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Histogram\ kernel\ implemented\ as\ a\ callable.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ kwargs\ ==\ \{\}\ \ \textcolor{comment}{\#\ no\ kernel\_params\ that\ we\ didn't\ ask\ for}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.minimum(x,\ y).sum()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{for}\ eigen\_solver\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}auto"{}},\ \textcolor{stringliteral}{"{}dense"{}},\ \textcolor{stringliteral}{"{}arpack"{}},\ \textcolor{stringliteral}{"{}randomized"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ kernel\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}linear"{}},\ \textcolor{stringliteral}{"{}rbf"{}},\ \textcolor{stringliteral}{"{}poly"{}},\ histogram):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ histogram\ kernel\ produces\ singular\ matrix\ inside\ linalg.solve}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ XXX\ use\ a\ least-\/squares\ approximation?}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ inv\ =\ \textcolor{keywordflow}{not}\ callable(kernel)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ transform\ fit\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4,\ kernel=kernel,\ eigen\_solver=eigen\_solver,\ fit\_inverse\_transform=inv}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ X\_fit\_transformed\ =\ kpca.fit\_transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ X\_fit\_transformed2\ =\ kpca.fit(X\_fit).transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.abs(X\_fit\_transformed),\ np.abs(X\_fit\_transformed2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ non-\/regression\ test:\ previously,\ gamma\ would\ be\ 0\ by\ default,}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ forcing\ all\ eigenvalues\ to\ 0\ under\ the\ poly\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ X\_fit\_transformed.size\ !=\ 0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ transform\ new\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ X\_pred\_transformed\ =\ kpca.transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ X\_pred\_transformed.shape[1]\ ==\ X\_fit\_transformed.shape[1]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ inverse\ transform}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ inv:}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X\_pred2\ =\ kpca.inverse\_transform(X\_pred\_transformed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ X\_pred2.shape\ ==\ X\_pred.shape}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00070}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ae26000837a43eeb2a33ca48214ace902}{00070}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ae26000837a43eeb2a33ca48214ace902}{test\_kernel\_pca\_invalid\_parameters}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00071}00071\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ kPCA\ raises\ an\ error\ if\ the\ parameters\ are\ invalid}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00072}00072\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ Tests\ fitting\ inverse\ transform\ with\ a\ precomputed\ kernel\ raises\ a}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ ValueError.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00076}00076\ \ \ \ \ estimator\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ n\_components=10,\ fit\_inverse\_transform=\textcolor{keyword}{True},\ kernel=\textcolor{stringliteral}{"{}precomputed"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00078}00078\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00079}00079\ \ \ \ \ err\_ms\ =\ \textcolor{stringliteral}{"{}Cannot\ fit\_inverse\_transform\ with\ a\ precomputed\ kernel"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00080}00080\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=err\_ms):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ estimator.fit(np.random.randn(10,\ 10))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00084}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a5ef06d858decf90164965fdd6c6afc49}{00084}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a5ef06d858decf90164965fdd6c6afc49}{test\_kernel\_pca\_consistent\_transform}}(global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00085}00085\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ robustness\ to\ mutations\ in\ the\ original\ training\ array}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00086}00086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ Test\ that\ after\ fitting\ a\ kPCA\ model,\ it\ stays\ independent\ of\ any}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ mutation\ of\ the\ values\ of\ the\ original\ data\ object\ by\ relying\ on\ an}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ internal\ copy.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00091}00091\ \ \ \ \ \textcolor{comment}{\#\ X\_fit\_\ needs\ to\ retain\ the\ old,\ unmodified\ copy\ of\ X}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00092}00092\ \ \ \ \ state\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00093}00093\ \ \ \ \ X\ =\ state.rand(10,\ 10)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00094}00094\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(random\_state=state).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00095}00095\ \ \ \ \ transformed1\ =\ kpca.transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00097}00097\ \ \ \ \ X\_copy\ =\ X.copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00098}00098\ \ \ \ \ X[:,\ 0]\ =\ 666}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00099}00099\ \ \ \ \ transformed2\ =\ kpca.transform(X\_copy)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00100}00100\ \ \ \ \ assert\_array\_almost\_equal(transformed1,\ transformed2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00103}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ac8e498d8e71a2d052a330258fe76e15e}{00103}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ac8e498d8e71a2d052a330258fe76e15e}{test\_kernel\_pca\_deterministic\_output}}(global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00104}00104\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ Kernel\ PCA\ produces\ deterministic\ output}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00105}00105\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ Tests\ that\ the\ same\ inputs\ and\ random\ state\ produce\ the\ same\ output.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00108}00108\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00109}00109\ \ \ \ \ X\ =\ rng.rand(10,\ 10)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00110}00110\ \ \ \ \ eigen\_solver\ =\ (\textcolor{stringliteral}{"{}arpack"{}},\ \textcolor{stringliteral}{"{}dense"{}})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00112}00112\ \ \ \ \ \textcolor{keywordflow}{for}\ solver\ \textcolor{keywordflow}{in}\ eigen\_solver:}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ transformed\_X\ =\ np.zeros((20,\ 2))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(20):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2,\ eigen\_solver=solver,\ random\_state=rng)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ transformed\_X[i,\ :]\ =\ kpca.fit\_transform(X)[0]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ assert\_allclose(transformed\_X,\ np.tile(transformed\_X[0,\ :],\ 20).reshape(20,\ 2))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00120}00120\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}csr\_container"{},\ CSR\_CONTAINERS)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00121}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a8a6fb73c881b49d35e98a314de59760c}{00121}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a8a6fb73c881b49d35e98a314de59760c}{test\_kernel\_pca\_sparse}}(csr\_container,\ global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00122}00122\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ kPCA\ works\ on\ a\ sparse\ data\ input.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00123}00123\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ Same\ test\ as\ \`{}\`{}test\_kernel\_pca\ except\ inverse\_transform\`{}\`{}\ since\ it's\ not}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ implemented\ for\ sparse\ matrices.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00127}00127\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00128}00128\ \ \ \ \ X\_fit\ =\ csr\_container(rng.random\_sample((5,\ 4)))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00129}00129\ \ \ \ \ X\_pred\ =\ csr\_container(rng.random\_sample((2,\ 4)))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00131}00131\ \ \ \ \ \textcolor{keywordflow}{for}\ eigen\_solver\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}auto"{}},\ \textcolor{stringliteral}{"{}arpack"{}},\ \textcolor{stringliteral}{"{}randomized"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ kernel\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}linear"{}},\ \textcolor{stringliteral}{"{}rbf"{}},\ \textcolor{stringliteral}{"{}poly"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ transform\ fit\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kernel=kernel,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eigen\_solver=eigen\_solver,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fit\_inverse\_transform=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=0,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ X\_fit\_transformed\ =\ kpca.fit\_transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ X\_fit\_transformed2\ =\ kpca.fit(X\_fit).transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.abs(X\_fit\_transformed),\ np.abs(X\_fit\_transformed2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ transform\ new\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ X\_pred\_transformed\ =\ kpca.transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ X\_pred\_transformed.shape[1]\ ==\ X\_fit\_transformed.shape[1]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ inverse\ transform:\ not\ available\ for\ sparse\ matrices}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ XXX:\ should\ we\ raise\ another\ exception\ type\ here?\ For\ instance:}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ NotImplementedError.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(NotFittedError):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kpca.inverse\_transform(X\_pred\_transformed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00158}00158\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}solver"{},\ ["{}auto"{},\ "{}dense"{},\ "{}arpack"{},\ "{}randomized"{}])}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00159}00159\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_features"{},\ [4,\ 10])}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00160}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a4d8beb779cb648f9eb00c37e60354eb6}{00160}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a4d8beb779cb648f9eb00c37e60354eb6}{test\_kernel\_pca\_linear\_kernel}}(solver,\ n\_features,\ global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00161}00161\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ kPCA\ with\ linear\ kernel\ is\ equivalent\ to\ PCA\ for\ all\ solvers.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00162}00162\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ KernelPCA\ with\ linear\ kernel\ should\ produce\ the\ same\ output\ as\ PCA.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00165}00165\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00166}00166\ \ \ \ \ X\_fit\ =\ rng.random\_sample((5,\ n\_features))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00167}00167\ \ \ \ \ X\_pred\ =\ rng.random\_sample((2,\ n\_features))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00169}00169\ \ \ \ \ \textcolor{comment}{\#\ for\ a\ linear\ kernel,\ kernel\ PCA\ should\ find\ the\ same\ projection\ as\ PCA}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00170}00170\ \ \ \ \ \textcolor{comment}{\#\ modulo\ the\ sign\ (direction)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00171}00171\ \ \ \ \ \textcolor{comment}{\#\ fit\ only\ the\ first\ four\ components:\ fifth\ is\ near\ zero\ eigenvalue,\ so}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00172}00172\ \ \ \ \ \textcolor{comment}{\#\ can\ be\ trimmed\ due\ to\ roundoff\ error}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00173}00173\ \ \ \ \ n\_comps\ =\ 3\ \textcolor{keywordflow}{if}\ solver\ ==\ \textcolor{stringliteral}{"{}arpack"{}}\ \textcolor{keywordflow}{else}\ 4}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00174}00174\ \ \ \ \ assert\_array\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ np.abs(\mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_comps,\ eigen\_solver=solver).fit(X\_fit).transform(X\_pred)),}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ np.abs(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__pca_1_1PCA}{PCA}}(n\_comps,\ svd\_solver=solver\ \textcolor{keywordflow}{if}\ solver\ !=\ \textcolor{stringliteral}{"{}dense"{}}\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}full"{}})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ .fit(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ .transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00181}00181\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00184}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_aef694ad3ea1e56cef808894b724cc4a1}{00184}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_aef694ad3ea1e56cef808894b724cc4a1}{test\_kernel\_pca\_n\_components}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00185}00185\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ \`{}n\_components\`{}\ is\ correctly\ taken\ into\ account\ for\ projections}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00186}00186\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ For\ all\ solvers\ this\ tests\ that\ the\ output\ has\ the\ correct\ shape\ depending}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ on\ the\ selected\ number\ of\ components.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00190}00190\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00191}00191\ \ \ \ \ X\_fit\ =\ rng.random\_sample((5,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00192}00192\ \ \ \ \ X\_pred\ =\ rng.random\_sample((2,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00194}00194\ \ \ \ \ \textcolor{keywordflow}{for}\ eigen\_solver\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}dense"{}},\ \textcolor{stringliteral}{"{}arpack"{}},\ \textcolor{stringliteral}{"{}randomized"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ [1,\ 2,\ 4]:}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=c,\ eigen\_solver=eigen\_solver)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ shape\ =\ kpca.fit(X\_fit).transform(X\_pred).shape}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ shape\ ==\ (2,\ c)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00202}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ac14795984239fe7aa042c1fa998037ca}{00202}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ac14795984239fe7aa042c1fa998037ca}{test\_remove\_zero\_eig}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00203}00203\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ \`{}\`{}remove\_zero\_eig\`{}\`{}\ parameter\ works\ correctly.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00204}00204\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ Tests\ that\ the\ null-\/space\ (Zero)\ eigenvalues\ are\ removed\ when}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ remove\_zero\_eig=True,\ whereas\ they\ are\ not\ by\ default.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00208}00208\ \ \ \ \ X\ =\ np.array([[1\ -\/\ 1e-\/30,\ 1],\ [1,\ 1],\ [1,\ 1\ -\/\ 1e-\/20]])}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00210}00210\ \ \ \ \ \textcolor{comment}{\#\ n\_components=None\ (default)\ =>\ remove\_zero\_eig\ is\ True}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00211}00211\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00212}00212\ \ \ \ \ Xt\ =\ kpca.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00213}00213\ \ \ \ \ \textcolor{keyword}{assert}\ Xt.shape\ ==\ (3,\ 0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00215}00215\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00216}00216\ \ \ \ \ Xt\ =\ kpca.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00217}00217\ \ \ \ \ \textcolor{keyword}{assert}\ Xt.shape\ ==\ (3,\ 2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00219}00219\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2,\ remove\_zero\_eig=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00220}00220\ \ \ \ \ Xt\ =\ kpca.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00221}00221\ \ \ \ \ \textcolor{keyword}{assert}\ Xt.shape\ ==\ (3,\ 0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00224}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a59c4671e21d8ab727cc127097587c923}{00224}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a59c4671e21d8ab727cc127097587c923}{test\_leave\_zero\_eig}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00225}00225\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Non-\/regression\ test\ for\ issue\ \#12141\ (PR\ \#12143)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00226}00226\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ This\ test\ checks\ that\ fit().transform()\ returns\ the\ same\ result\ as}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ fit\_transform()\ in\ case\ of\ non-\/removed\ zero\ eigenvalue.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00230}00230\ \ \ \ \ X\_fit\ =\ np.array([[1,\ 1],\ [0,\ 0]])}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00232}00232\ \ \ \ \ \textcolor{comment}{\#\ Assert\ that\ even\ with\ all\ np\ warnings\ on,\ there\ is\ no\ div\ by\ zero\ warning}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00233}00233\ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ There\ might\ be\ warnings\ about\ the\ kernel\ being\ badly\ conditioned,}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ but\ there\ should\ not\ be\ warnings\ about\ division\ by\ zero.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (Numpy\ division\ by\ zero\ warning\ can\ have\ many\ message\ variants,\ but}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ at\ least\ we\ know\ that\ it\ is\ a\ RuntimeWarning\ so\ lets\ check\ only\ this)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}error"{}},\ RuntimeWarning)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{"{}warn"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ k\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2,\ remove\_zero\_eig=\textcolor{keyword}{False},\ eigen\_solver=\textcolor{stringliteral}{"{}dense"{}})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Fit,\ then\ transform}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ k.fit(X\_fit).transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Do\ both\ at\ once}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ B\ =\ k.fit\_transform(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compare}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.abs(A),\ np.abs(B))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00249}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_abc38ee144a7660030dcb356af56412db}{00249}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_abc38ee144a7660030dcb356af56412db}{test\_kernel\_pca\_precomputed}}(global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00250}00250\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ kPCA\ works\ with\ a\ precomputed\ kernel,\ for\ all\ solvers"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00251}00251\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00252}00252\ \ \ \ \ X\_fit\ =\ rng.random\_sample((5,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00253}00253\ \ \ \ \ X\_pred\ =\ rng.random\_sample((2,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00254}00254\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00255}00255\ \ \ \ \ \textcolor{keywordflow}{for}\ eigen\_solver\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{"{}dense"{}},\ \textcolor{stringliteral}{"{}arpack"{}},\ \textcolor{stringliteral}{"{}randomized"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ X\_kpca\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(4,\ eigen\_solver=eigen\_solver,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ .fit(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ .transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ X\_kpca2\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4,\ eigen\_solver=eigen\_solver,\ kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ .fit(np.dot(X\_fit,\ X\_fit.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ .transform(np.dot(X\_pred,\ X\_fit.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ X\_kpca\_train\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ 4,\ eigen\_solver=eigen\_solver,\ kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ ).fit\_transform(np.dot(X\_fit,\ X\_fit.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ X\_kpca\_train2\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4,\ eigen\_solver=eigen\_solver,\ kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ .fit(np.dot(X\_fit,\ X\_fit.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ .transform(np.dot(X\_fit,\ X\_fit.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.abs(X\_kpca),\ np.abs(X\_kpca2))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00283}00283\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.abs(X\_kpca\_train),\ np.abs(X\_kpca\_train2))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00285}00285\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00287}00287\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}solver"{},\ ["{}auto"{},\ "{}dense"{},\ "{}arpack"{},\ "{}randomized"{}])}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00288}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_af6f7af0a86aadc4bd8b9e597568e5710}{00288}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_af6f7af0a86aadc4bd8b9e597568e5710}{test\_kernel\_pca\_precomputed\_non\_symmetric}}(solver):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00289}00289\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ kernel\ centerer\ works.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00290}00290\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ Tests\ that\ a\ non\ symmetric\ precomputed\ kernel\ is\ actually\ accepted}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ because\ the\ kernel\ centerer\ does\ its\ job\ correctly.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00295}00295\ \ \ \ \ \textcolor{comment}{\#\ a\ non\ symmetric\ gram\ matrix}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00296}00296\ \ \ \ \ K\ =\ [[1,\ 2],\ [3,\ 40]]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00297}00297\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ eigen\_solver=solver,\ n\_components=1,\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00299}00299\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00300}00300\ \ \ \ \ kpca.fit(K)\ \ \textcolor{comment}{\#\ no\ error}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00302}00302\ \ \ \ \ \textcolor{comment}{\#\ same\ test\ with\ centered\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00303}00303\ \ \ \ \ Kc\ =\ [[9,\ -\/9],\ [-\/9,\ 9]]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00304}00304\ \ \ \ \ kpca\_c\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ eigen\_solver=solver,\ n\_components=1,\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00306}00306\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00307}00307\ \ \ \ \ kpca\_c.fit(Kc)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00309}00309\ \ \ \ \ \textcolor{comment}{\#\ comparison\ between\ the\ non-\/centered\ and\ centered\ versions}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00310}00310\ \ \ \ \ assert\_array\_equal(kpca.eigenvectors\_,\ kpca\_c.eigenvectors\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00311}00311\ \ \ \ \ assert\_array\_equal(kpca.eigenvalues\_,\ kpca\_c.eigenvalues\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00314}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ae656a51e9ef78d821d3ff5f10e6d3dd3}{00314}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_ae656a51e9ef78d821d3ff5f10e6d3dd3}{test\_gridsearch\_pipeline}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00315}00315\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ kPCA\ works\ as\ expected\ in\ a\ grid\ search\ pipeline}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00316}00316\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ Test\ if\ we\ can\ do\ a\ grid-\/search\ to\ find\ parameters\ to\ separate}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ circles\ with\ a\ perceptron\ model.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00320}00320\ \ \ \ \ X,\ y\ =\ make\_circles(n\_samples=400,\ factor=0.3,\ noise=0.05,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00321}00321\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(kernel=\textcolor{stringliteral}{"{}rbf"{}},\ n\_components=2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00322}00322\ \ \ \ \ pipeline\ =\ \mbox{\hyperlink{classsklearn_1_1pipeline_1_1Pipeline}{Pipeline}}([(\textcolor{stringliteral}{"{}kernel\_pca"{}},\ kpca),\ (\textcolor{stringliteral}{"{}Perceptron"{}},\ \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__perceptron_1_1Perceptron}{Perceptron}}(max\_iter=5))])}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00323}00323\ \ \ \ \ param\_grid\ =\ dict(kernel\_pca\_\_gamma=2.0\ **\ np.arange(-\/2,\ 2))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00324}00324\ \ \ \ \ grid\_search\ =\ \mbox{\hyperlink{classsklearn_1_1model__selection_1_1__search_1_1GridSearchCV}{GridSearchCV}}(pipeline,\ cv=3,\ param\_grid=param\_grid)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00325}00325\ \ \ \ \ grid\_search.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00326}00326\ \ \ \ \ \textcolor{keyword}{assert}\ grid\_search.best\_score\_\ ==\ 1}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00328}00328\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00329}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a1ed449a400d8a222e3819ec6b1ae0e3a}{00329}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a1ed449a400d8a222e3819ec6b1ae0e3a}{test\_gridsearch\_pipeline\_precomputed}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00330}00330\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ kPCA\ works\ as\ expected\ in\ a\ grid\ search\ pipeline\ (2)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00331}00331\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ Test\ if\ we\ can\ do\ a\ grid-\/search\ to\ find\ parameters\ to\ separate}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ circles\ with\ a\ perceptron\ model.\ This\ test\ uses\ a\ precomputed\ kernel.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00335}00335\ \ \ \ \ X,\ y\ =\ make\_circles(n\_samples=400,\ factor=0.3,\ noise=0.05,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00336}00336\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ n\_components=2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00337}00337\ \ \ \ \ pipeline\ =\ \mbox{\hyperlink{classsklearn_1_1pipeline_1_1Pipeline}{Pipeline}}([(\textcolor{stringliteral}{"{}kernel\_pca"{}},\ kpca),\ (\textcolor{stringliteral}{"{}Perceptron"{}},\ \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__perceptron_1_1Perceptron}{Perceptron}}(max\_iter=5))])}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00338}00338\ \ \ \ \ param\_grid\ =\ dict(Perceptron\_\_max\_iter=np.arange(1,\ 5))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00339}00339\ \ \ \ \ grid\_search\ =\ \mbox{\hyperlink{classsklearn_1_1model__selection_1_1__search_1_1GridSearchCV}{GridSearchCV}}(pipeline,\ cv=3,\ param\_grid=param\_grid)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00340}00340\ \ \ \ \ X\_kernel\ =\ rbf\_kernel(X,\ gamma=2.0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00341}00341\ \ \ \ \ grid\_search.fit(X\_kernel,\ y)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00342}00342\ \ \ \ \ \textcolor{keyword}{assert}\ grid\_search.best\_score\_\ ==\ 1}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00344}00344\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00345}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a87acadd5858af2492e400bc7003a82bd}{00345}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a87acadd5858af2492e400bc7003a82bd}{test\_nested\_circles}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00346}00346\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ kPCA\ projects\ in\ a\ space\ where\ nested\ circles\ are\ separable}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00347}00347\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ Tests\ that\ 2D\ nested\ circles\ become\ separable\ with\ a\ perceptron\ when}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ projected\ in\ the\ first\ 2\ kPCA\ using\ an\ RBF\ kernel,\ while\ raw\ samples}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ are\ not\ directly\ separable\ in\ the\ original\ space.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00352}00352\ \ \ \ \ X,\ y\ =\ make\_circles(n\_samples=400,\ factor=0.3,\ noise=0.05,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00353}00353\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00354}00354\ \ \ \ \ \textcolor{comment}{\#\ 2D\ nested\ circles\ are\ not\ linearly\ separable}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00355}00355\ \ \ \ \ train\_score\ =\ \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__perceptron_1_1Perceptron}{Perceptron}}(max\_iter=5).fit(X,\ y).score(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00356}00356\ \ \ \ \ \textcolor{keyword}{assert}\ train\_score\ <\ 0.8}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00358}00358\ \ \ \ \ \textcolor{comment}{\#\ Project\ the\ circles\ data\ into\ the\ first\ 2\ components\ of\ a\ RBF\ Kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00359}00359\ \ \ \ \ \textcolor{comment}{\#\ PCA\ model.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00360}00360\ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ the\ gamma\ value\ is\ data\ dependent.\ If\ this\ test\ breaks}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00361}00361\ \ \ \ \ \textcolor{comment}{\#\ and\ the\ gamma\ value\ has\ to\ be\ updated,\ the\ Kernel\ PCA\ example\ will}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00362}00362\ \ \ \ \ \textcolor{comment}{\#\ have\ to\ be\ updated\ too.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00363}00363\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ kernel=\textcolor{stringliteral}{"{}rbf"{}},\ n\_components=2,\ fit\_inverse\_transform=\textcolor{keyword}{True},\ gamma=2.0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00365}00365\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00366}00366\ \ \ \ \ X\_kpca\ =\ kpca.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00367}00367\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00368}00368\ \ \ \ \ \textcolor{comment}{\#\ The\ data\ is\ perfectly\ linearly\ separable\ in\ that\ space}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00369}00369\ \ \ \ \ train\_score\ =\ \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__perceptron_1_1Perceptron}{Perceptron}}(max\_iter=5).fit(X\_kpca,\ y).score(X\_kpca,\ y)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00370}00370\ \ \ \ \ \textcolor{keyword}{assert}\ train\_score\ ==\ 1.0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00372}00372\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00373}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a2c91197f96a58f755d0140f86ead3339}{00373}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a2c91197f96a58f755d0140f86ead3339}{test\_kernel\_conditioning}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00374}00374\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ \`{}\`{}\_check\_psd\_eigenvalues\`{}\`{}\ is\ correctly\ called\ in\ kPCA}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00375}00375\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for\ issue\ \#12140\ (PR\ \#12145).}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00378}00378\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00379}00379\ \ \ \ \ \textcolor{comment}{\#\ create\ a\ pathological\ X\ leading\ to\ small\ non-\/zero\ eigenvalue}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00380}00380\ \ \ \ \ X\ =\ [[5,\ 1],\ [5\ +\ 1e-\/8,\ 1e-\/8],\ [5\ +\ 1e-\/8,\ 0]]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00381}00381\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(kernel=\textcolor{stringliteral}{"{}linear"{}},\ n\_components=2,\ fit\_inverse\_transform=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00382}00382\ \ \ \ \ kpca.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00383}00383\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00384}00384\ \ \ \ \ \textcolor{comment}{\#\ check\ that\ the\ small\ non-\/zero\ eigenvalue\ was\ correctly\ set\ to\ zero}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00385}00385\ \ \ \ \ \textcolor{keyword}{assert}\ kpca.eigenvalues\_.min()\ ==\ 0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00386}00386\ \ \ \ \ \textcolor{keyword}{assert}\ np.all(kpca.eigenvalues\_\ ==\ \_check\_psd\_eigenvalues(kpca.eigenvalues\_))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00389}00389\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}solver"{},\ ["{}auto"{},\ "{}dense"{},\ "{}arpack"{},\ "{}randomized"{}])}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00390}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a9bf430b9a953ba8ce3d16cff0d2fde09}{00390}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a9bf430b9a953ba8ce3d16cff0d2fde09}{test\_precomputed\_kernel\_not\_psd}}(solver):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00391}00391\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ how\ KernelPCA\ works\ with\ non-\/PSD\ kernels\ depending\ on\ n\_components}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00392}00392\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ Tests\ for\ all\ methods\ what\ happens\ with\ a\ non\ PSD\ gram\ matrix\ (this}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ can\ happen\ in\ an\ isomap\ scenario,\ or\ with\ custom\ kernel\ functions,\ or}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ maybe\ with\ ill-\/posed\ datasets).}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00396}00396\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}n\_component\`{}\`{}\ is\ large\ enough\ to\ capture\ a\ negative\ eigenvalue,\ an}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ error\ should\ be\ raised.\ Otherwise,\ KernelPCA\ should\ run\ without\ error}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ since\ the\ negative\ eigenvalues\ are\ not\ selected.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00401}00401\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00402}00402\ \ \ \ \ \textcolor{comment}{\#\ a\ non\ PSD\ kernel\ with\ large\ eigenvalues,\ already\ centered}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00403}00403\ \ \ \ \ \textcolor{comment}{\#\ it\ was\ captured\ from\ an\ isomap\ call\ and\ multiplied\ by\ 100\ for\ compacity}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00404}00404\ \ \ \ \ K\ =\ [}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ [4.48,\ -\/1.0,\ 8.07,\ 2.33,\ 2.33,\ 2.33,\ -\/5.76,\ -\/12.78],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ [-\/1.0,\ -\/6.48,\ 4.5,\ -\/1.24,\ -\/1.24,\ -\/1.24,\ -\/0.81,\ 7.49],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ [8.07,\ 4.5,\ 15.48,\ 2.09,\ 2.09,\ 2.09,\ -\/11.1,\ -\/23.23],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ [2.33,\ -\/1.24,\ 2.09,\ 4.0,\ -\/3.65,\ -\/3.65,\ 1.02,\ -\/0.9],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ [2.33,\ -\/1.24,\ 2.09,\ -\/3.65,\ 4.0,\ -\/3.65,\ 1.02,\ -\/0.9],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ [2.33,\ -\/1.24,\ 2.09,\ -\/3.65,\ -\/3.65,\ 4.0,\ 1.02,\ -\/0.9],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ [-\/5.76,\ -\/0.81,\ -\/11.1,\ 1.02,\ 1.02,\ 1.02,\ 4.86,\ 9.75],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ [-\/12.78,\ 7.49,\ -\/23.23,\ -\/0.9,\ -\/0.9,\ -\/0.9,\ 9.75,\ 21.46],}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00413}00413\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00414}00414\ \ \ \ \ \textcolor{comment}{\#\ this\ gram\ matrix\ has\ 5\ positive\ eigenvalues\ and\ 3\ negative\ ones}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00415}00415\ \ \ \ \ \textcolor{comment}{\#\ [\ 52.72,\ \ \ 7.65,\ \ \ 7.65,\ \ \ 5.02,\ \ \ 0.\ \ ,\ \ -\/0.\ \ ,\ \ -\/6.13,\ -\/15.11]}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00417}00417\ \ \ \ \ \textcolor{comment}{\#\ 1.\ ask\ for\ enough\ components\ to\ get\ a\ significant\ negative\ one}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00418}00418\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ eigen\_solver=solver,\ n\_components=7)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00419}00419\ \ \ \ \ \textcolor{comment}{\#\ make\ sure\ that\ the\ appropriate\ error\ is\ raised}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00420}00420\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}There\ are\ significant\ negative\ eigenvalues"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ kpca.fit(K)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00422}00422\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00423}00423\ \ \ \ \ \textcolor{comment}{\#\ 2.\ ask\ for\ a\ small\ enough\ n\_components\ to\ get\ only\ positive\ ones}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00424}00424\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ eigen\_solver=solver,\ n\_components=2)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00425}00425\ \ \ \ \ \textcolor{keywordflow}{if}\ solver\ ==\ \textcolor{stringliteral}{"{}randomized"{}}:}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ randomized\ method\ is\ still\ inconsistent\ with\ the\ others\ on\ this}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ since\ it\ selects\ the\ eigenvalues\ based\ on\ the\ largest\ 2\ modules,\ not}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00428}00428\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ on\ the\ largest\ 2\ values.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ At\ least\ we\ can\ ensure\ that\ we\ return\ an\ error\ instead\ of\ returning}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ wrong\ eigenvalues}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ ValueError,\ match=\textcolor{stringliteral}{"{}There\ are\ significant\ negative\ eigenvalues"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ kpca.fit(K)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00436}00436\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ general\ case:\ make\ sure\ that\ it\ works}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ kpca.fit(K)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00439}00439\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00440}00440\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00441}00441\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_components"{},\ [4,\ 10,\ 20])}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00442}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a4170797d0cb93eec99925b25e97059d1}{00442}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a4170797d0cb93eec99925b25e97059d1}{test\_kernel\_pca\_solvers\_equivalence}}(n\_components):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00443}00443\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ 'dense'\ 'arpack'\ \&\ 'randomized'\ solvers\ give\ similar\ results"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00445}00445\ \ \ \ \ \textcolor{comment}{\#\ Generate\ random\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00446}00446\ \ \ \ \ n\_train,\ n\_test\ =\ 1\_000,\ 100}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00447}00447\ \ \ \ \ X,\ \_\ =\ make\_circles(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ n\_samples=(n\_train\ +\ n\_test),\ factor=0.3,\ noise=0.05,\ random\_state=0}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00449}00449\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00450}00450\ \ \ \ \ X\_fit,\ X\_pred\ =\ X[:n\_train,\ :],\ X[n\_train:,\ :]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00451}00451\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00452}00452\ \ \ \ \ \textcolor{comment}{\#\ reference\ (full)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00453}00453\ \ \ \ \ ref\_pred\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components,\ eigen\_solver=\textcolor{stringliteral}{"{}dense"{}},\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00455}00455\ \ \ \ \ \ \ \ \ .fit(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00456}00456\ \ \ \ \ \ \ \ \ .transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00457}00457\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00458}00458\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00459}00459\ \ \ \ \ \textcolor{comment}{\#\ arpack}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00460}00460\ \ \ \ \ a\_pred\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00461}00461\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components,\ eigen\_solver=\textcolor{stringliteral}{"{}arpack"{}},\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00462}00462\ \ \ \ \ \ \ \ \ .fit(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00463}00463\ \ \ \ \ \ \ \ \ .transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00464}00464\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00465}00465\ \ \ \ \ \textcolor{comment}{\#\ check\ that\ the\ result\ is\ still\ correct\ despite\ the\ approx}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00466}00466\ \ \ \ \ assert\_array\_almost\_equal(np.abs(a\_pred),\ np.abs(ref\_pred))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00468}00468\ \ \ \ \ \textcolor{comment}{\#\ randomized}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00469}00469\ \ \ \ \ r\_pred\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00470}00470\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components,\ eigen\_solver=\textcolor{stringliteral}{"{}randomized"{}},\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ .fit(X\_fit)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ .transform(X\_pred)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00473}00473\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00474}00474\ \ \ \ \ \textcolor{comment}{\#\ check\ that\ the\ result\ is\ still\ correct\ despite\ the\ approximation}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00475}00475\ \ \ \ \ assert\_array\_almost\_equal(np.abs(r\_pred),\ np.abs(ref\_pred))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00476}00476\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00477}00477\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00478}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a6f2572b7e94433c13a6a3912054de544}{00478}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a6f2572b7e94433c13a6a3912054de544}{test\_kernel\_pca\_inverse\_transform\_reconstruction}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00479}00479\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ if\ the\ reconstruction\ is\ a\ good\ approximation.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00480}00480\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ in\ general\ it\ is\ not\ possible\ to\ get\ an\ arbitrarily\ good}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ reconstruction\ because\ of\ kernel\ centering\ that\ does\ not}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ preserve\ all\ the\ information\ of\ the\ original\ data.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00485}00485\ \ \ \ \ X,\ *\_\ =\ make\_blobs(n\_samples=100,\ n\_features=4,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00486}00486\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00487}00487\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00488}00488\ \ \ \ \ \ \ \ \ n\_components=20,\ kernel=\textcolor{stringliteral}{"{}rbf"{}},\ fit\_inverse\_transform=\textcolor{keyword}{True},\ alpha=1e-\/3}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00489}00489\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00490}00490\ \ \ \ \ X\_trans\ =\ kpca.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00491}00491\ \ \ \ \ X\_reconst\ =\ kpca.inverse\_transform(X\_trans)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00492}00492\ \ \ \ \ \textcolor{keyword}{assert}\ np.linalg.norm(X\ -\/\ X\_reconst)\ /\ np.linalg.norm(X)\ <\ 1e-\/1}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00493}00493\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00494}00494\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00495}00495\ \textcolor{keyword}{def\ }test\_kernel\_pca\_raise\_not\_fitted\_error():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00496}00496\ \ \ \ \ X\ =\ np.random.randn(15).reshape(5,\ 3)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00497}00497\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00498}00498\ \ \ \ \ kpca.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00499}00499\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(NotFittedError):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ kpca.inverse\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00501}00501\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00502}00502\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00503}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a3a0d63847a2f77c4b2792328d6c6d31d}{00503}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a3a0d63847a2f77c4b2792328d6c6d31d}{test\_32\_64\_decomposition\_shape}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00504}00504\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ that\ the\ decomposition\ is\ similar\ for\ 32\ and\ 64\ bits\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00505}00505\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ Non\ regression\ test\ for}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/18146}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00508}00508\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00509}00509\ \ \ \ \ X,\ y\ =\ make\_blobs(}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ n\_samples=30,\ centers=[[0,\ 0,\ 0],\ [1,\ 1,\ 1]],\ random\_state=0,\ cluster\_std=0.1}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00511}00511\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00512}00512\ \ \ \ \ X\ =\ \mbox{\hyperlink{classsklearn_1_1preprocessing_1_1__data_1_1StandardScaler}{StandardScaler}}().fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00513}00513\ \ \ \ \ X\ -\/=\ X.min()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00514}00514\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00515}00515\ \ \ \ \ \textcolor{comment}{\#\ Compare\ the\ shapes\ (corresponds\ to\ the\ number\ of\ non-\/zero\ eigenvalues)}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00516}00516\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00517}00517\ \ \ \ \ \textcolor{keyword}{assert}\ kpca.fit\_transform(X).shape\ ==\ kpca.fit\_transform(X.astype(np.float32)).shape}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00518}00518\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00519}00519\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00520}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a79d891fd3914611621ae6067f662f4ea}{00520}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a79d891fd3914611621ae6067f662f4ea}{test\_kernel\_pca\_feature\_names\_out}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00521}00521\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ feature\ names\ out\ for\ KernelPCA."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00522}00522\ \ \ \ \ X,\ *\_\ =\ make\_blobs(n\_samples=100,\ n\_features=4,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00523}00523\ \ \ \ \ kpca\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00524}00524\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00525}00525\ \ \ \ \ names\ =\ kpca.get\_feature\_names\_out()}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00526}00526\ \ \ \ \ assert\_array\_equal([f\textcolor{stringliteral}{"{}kernelpca\{i\}"{}}\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(2)],\ names)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00527}00527\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00528}00528\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00529}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a020fc1c04ad6f2dbced08378581bcbfe}{00529}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a020fc1c04ad6f2dbced08378581bcbfe}{test\_kernel\_pca\_inverse\_correct\_gamma}}(global\_random\_seed):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00530}00530\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ gamma\ is\ set\ correctly\ when\ not\ provided.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00531}00531\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for\ \#26280}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00534}00534\ \ \ \ \ rng\ =\ np.random.RandomState(global\_random\_seed)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00535}00535\ \ \ \ \ X\ =\ rng.random\_sample((5,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00536}00536\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00537}00537\ \ \ \ \ kwargs\ =\ \{}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00538}00538\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}n\_components"{}}:\ 2,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}random\_state"{}}:\ rng,}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}fit\_inverse\_transform"{}}:\ \textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}kernel"{}}:\ \textcolor{stringliteral}{"{}rbf"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00542}00542\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00544}00544\ \ \ \ \ expected\_gamma\ =\ 1\ /\ X.shape[1]}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00545}00545\ \ \ \ \ kpca1\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(gamma=\textcolor{keywordtype}{None},\ **kwargs).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00546}00546\ \ \ \ \ kpca2\ =\ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(gamma=expected\_gamma,\ **kwargs).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00547}00547\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00548}00548\ \ \ \ \ \textcolor{keyword}{assert}\ kpca1.gamma\_\ ==\ expected\_gamma}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00549}00549\ \ \ \ \ \textcolor{keyword}{assert}\ kpca2.gamma\_\ ==\ expected\_gamma}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00550}00550\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00551}00551\ \ \ \ \ X1\_recon\ =\ kpca1.inverse\_transform(kpca1.transform(X))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00552}00552\ \ \ \ \ X2\_recon\ =\ kpca2.inverse\_transform(kpca1.transform(X))}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00553}00553\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00554}00554\ \ \ \ \ assert\_allclose(X1\_recon,\ X2\_recon)}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00555}00555\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00556}00556\ }
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00557}\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a6267224f92a75b24e74fe58c6720a525}{00557}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1decomposition_1_1tests_1_1test__kernel__pca_a6267224f92a75b24e74fe58c6720a525}{test\_kernel\_pca\_pandas\_output}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00558}00558\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ KernelPCA\ works\ with\ pandas\ output\ when\ the\ solver\ is\ arpack.}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00559}00559\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00561}00561\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/27579}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00562}00562\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00563}00563\ \ \ \ \ pytest.importorskip(\textcolor{stringliteral}{"{}pandas"{}})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00564}00564\ \ \ \ \ X,\ \_\ =\ load\_iris(as\_frame=\textcolor{keyword}{True},\ return\_X\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00565}00565\ \ \ \ \ \textcolor{keyword}{with}\ sklearn.config\_context(transform\_output=\textcolor{stringliteral}{"{}pandas"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__pca_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1decomposition_1_1__kernel__pca_1_1KernelPCA}{KernelPCA}}(n\_components=2,\ eigen\_solver=\textcolor{stringliteral}{"{}arpack"{}}).fit\_transform(X)}

\end{DoxyCode}
