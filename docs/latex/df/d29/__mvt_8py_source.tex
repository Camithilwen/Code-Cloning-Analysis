\doxysection{\+\_\+mvt.\+py}
\hypertarget{__mvt_8py_source}{}\label{__mvt_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/data/\_mvt.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/data/\_mvt.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00001}\mbox{\hyperlink{namespace__mvt}{00001}}\ \textcolor{comment}{\#\ flake8:\ noqa}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00002}00002\ \textcolor{keyword}{import}\ math}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00004}00004\ \textcolor{keyword}{from}\ scipy\ \textcolor{keyword}{import}\ special}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__qmc}{scipy.stats.\_qmc}}\ \textcolor{keyword}{import}\ primes\_from\_2\_to}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00008}00008\ \textcolor{keyword}{def\ }\_primes(n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00009}00009\ \ \ \ \ \textcolor{comment}{\#\ Defined\ to\ facilitate\ comparison\ between\ translation\ and\ source}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00010}00010\ \ \ \ \ \textcolor{comment}{\#\ In\ Matlab,\ primes(10.5)\ -\/>\ first\ four\ primes,\ primes(11.5)\ -\/>\ first\ five}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00011}00011\ \ \ \ \ \textcolor{keywordflow}{return}\ primes\_from\_2\_to(math.ceil(n))}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00014}00014\ \textcolor{keyword}{def\ }\_gaminv(a,\ b):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00015}00015\ \ \ \ \ \textcolor{comment}{\#\ Defined\ to\ facilitate\ comparison\ between\ translation\ and\ source}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00016}00016\ \ \ \ \ \textcolor{comment}{\#\ Matlab's\ \`{}gaminv`\ is\ like\ \`{}special.gammaincinv`\ but\ args\ are\ reversed}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00017}00017\ \ \ \ \ \textcolor{keywordflow}{return}\ special.gammaincinv(b,\ a)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00020}\mbox{\hyperlink{namespace__mvt_af6bf4e7e965bc032c9b0fa823e93ee71}{00020}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespace__mvt_af6bf4e7e965bc032c9b0fa823e93ee71}{\_qsimvtv}}(m,\ nu,\ sigma,\ a,\ b,\ rng):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00021}00021\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Estimates\ the\ multivariate\ t\ CDF\ using\ randomized\ QMC}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00022}00022\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ m\ :\ int}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ points}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ nu\ :\ float}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Degrees\ of\ freedom}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ sigma\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ 2D\ positive\ semidefinite\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ a\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lower\ integration\ limits}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ b\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ integration\ limits.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ rng\ :\ Generator}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Pseudorandom\ number\ generator}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00037}00037\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ p\ :\ float}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ estimated\ CDF.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ e\ :\ float}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ absolute\ error\ estimate.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00044}00044\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00046}00046\ \ \ \ \ \textcolor{comment}{\#\ \_qsimvtv\ is\ a\ Python\ translation\ of\ the\ Matlab\ function\ qsimvtv,}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00047}00047\ \ \ \ \ \textcolor{comment}{\#\ semicolons\ and\ all.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00048}00048\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00049}00049\ \ \ \ \ \textcolor{comment}{\#\ \ \ This\ function\ uses\ an\ algorithm\ given\ in\ the\ paper}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00050}00050\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ "{}Comparison\ of\ Methods\ for\ the\ Numerical\ Computation\ of}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00051}00051\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ Multivariate\ t\ Probabilities"{},\ in}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00052}00052\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ J.\ of\ Computational\ and\ Graphical\ Stat.,\ 11(2002),\ pp.\ 950-\/971,\ by}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00053}00053\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ Alan\ Genz\ and\ Frank\ Bretz}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00054}00054\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00055}00055\ \ \ \ \ \textcolor{comment}{\#\ \ \ The\ primary\ references\ for\ the\ numerical\ integration\ are}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00056}00056\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ "{}On\ a\ Number-\/Theoretical\ Integration\ Method"{}}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00057}00057\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ H.\ Niederreiter,\ Aequationes\ Mathematicae,\ 8(1972),\ pp.\ 304-\/11.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00058}00058\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ and}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ "{}Randomization\ of\ Number\ Theoretic\ Methods\ for\ Multiple\ Integration"{}}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00060}00060\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ R.\ Cranley\ \&\ T.N.L.\ Patterson,\ SIAM\ J\ Numer\ Anal,\ 13(1976),\ pp.\ 904-\/14.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00061}00061\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00062}00062\ \ \ \ \ \textcolor{comment}{\#\ \ \ Alan\ Genz\ is\ the\ author\ of\ this\ function\ and\ following\ Matlab\ functions.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00063}00063\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ Alan\ Genz,\ WSU\ Math,\ PO\ Box\ 643113,\ Pullman,\ WA\ 99164-\/3113}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00064}00064\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ Email\ :\ alangenz@wsu.edu}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00065}00065\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00066}00066\ \ \ \ \ \textcolor{comment}{\#\ Copyright\ (C)\ 2013,\ Alan\ Genz,\ \ All\ rights\ reserved.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00067}00067\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00068}00068\ \ \ \ \ \textcolor{comment}{\#\ Redistribution\ and\ use\ in\ source\ and\ binary\ forms,\ with\ or\ without}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00069}00069\ \ \ \ \ \textcolor{comment}{\#\ modification,\ are\ permitted\ provided\ the\ following\ conditions\ are\ met:}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00070}00070\ \ \ \ \ \textcolor{comment}{\#\ \ \ 1.\ Redistributions\ of\ source\ code\ must\ retain\ the\ above\ copyright}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00071}00071\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00072}00072\ \ \ \ \ \textcolor{comment}{\#\ \ \ 2.\ Redistributions\ in\ binary\ form\ must\ reproduce\ the\ above\ copyright}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00073}00073\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer\ in}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00074}00074\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ the\ documentation\ and/or\ other\ materials\ provided\ with\ the}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00075}00075\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ distribution.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00076}00076\ \ \ \ \ \textcolor{comment}{\#\ \ \ 3.\ The\ contributor\ name(s)\ may\ not\ be\ used\ to\ endorse\ or\ promote}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00077}00077\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ products\ derived\ from\ this\ software\ without\ specific\ prior}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00078}00078\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ written\ permission.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00079}00079\ \ \ \ \ \textcolor{comment}{\#\ THIS\ SOFTWARE\ IS\ PROVIDED\ BY\ THE\ COPYRIGHT\ HOLDERS\ AND\ CONTRIBUTORS}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00080}00080\ \ \ \ \ \textcolor{comment}{\#\ "{}AS\ IS"{}\ AND\ ANY\ EXPRESS\ OR\ IMPLIED\ WARRANTIES,\ INCLUDING,\ BUT\ NOT}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00081}00081\ \ \ \ \ \textcolor{comment}{\#\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND\ FITNESS}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00082}00082\ \ \ \ \ \textcolor{comment}{\#\ FOR\ A\ PARTICULAR\ PURPOSE\ ARE\ DISCLAIMED.\ IN\ NO\ EVENT\ SHALL\ THE}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00083}00083\ \ \ \ \ \textcolor{comment}{\#\ COPYRIGHT\ OWNER\ OR\ CONTRIBUTORS\ BE\ LIABLE\ FOR\ ANY\ DIRECT,\ INDIRECT,}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00084}00084\ \ \ \ \ \textcolor{comment}{\#\ INCIDENTAL,\ SPECIAL,\ EXEMPLARY,\ OR\ CONSEQUENTIAL\ DAMAGES\ (INCLUDING,}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00085}00085\ \ \ \ \ \textcolor{comment}{\#\ BUT\ NOT\ LIMITED\ TO,\ PROCUREMENT\ OF\ SUBSTITUTE\ GOODS\ OR\ SERVICES;\ LOSS}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00086}00086\ \ \ \ \ \textcolor{comment}{\#\ OF\ USE,\ DATA,\ OR\ PROFITS;\ OR\ BUSINESS\ INTERRUPTION)\ HOWEVER\ CAUSED\ AND}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00087}00087\ \ \ \ \ \textcolor{comment}{\#\ ON\ ANY\ THEORY\ OF\ LIABILITY,\ WHETHER\ IN\ CONTRACT,\ STRICT\ LIABILITY,\ OR}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00088}00088\ \ \ \ \ \textcolor{comment}{\#\ TORT\ (INCLUDING\ NEGLIGENCE\ OR\ OTHERWISE)\ ARISING\ IN\ ANY\ WAY\ OUT\ OF\ USE}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00089}00089\ \ \ \ \ \textcolor{comment}{\#\ OF\ THIS\ SOFTWARE,\ EVEN\ IF\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH\ DAMAGE.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00091}00091\ \ \ \ \ \textcolor{comment}{\#\ Initialization}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00092}00092\ \ \ \ \ sn\ =\ max(1,\ math.sqrt(nu));\ ch,\ az,\ bz\ =\ \mbox{\hyperlink{namespace__mvt_a4fcfac81458e6e33e98c2541849b950a}{\_chlrps}}(sigma,\ a/sn,\ b/sn)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00093}00093\ \ \ \ \ n\ =\ len(sigma);\ N\ =\ 10;\ P\ =\ math.ceil(m/N);\ on\ =\ np.ones(P);\ p\ =\ 0;\ e\ =\ 0}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00094}00094\ \ \ \ \ ps\ =\ np.sqrt(\_primes(5*n*math.log(n+4)/4));\ q\ =\ ps[:,\ np.newaxis]\ \ \textcolor{comment}{\#\ Richtmyer\ gens.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00096}00096\ \ \ \ \ \textcolor{comment}{\#\ Randomization\ loop\ for\ ns\ samples}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00097}00097\ \ \ \ \ c\ =\ \textcolor{keywordtype}{None};\ dc\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00098}00098\ \ \ \ \ \textcolor{keywordflow}{for}\ S\ \textcolor{keywordflow}{in}\ range(N):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ vp\ =\ on.copy();\ s\ =\ np.zeros((n,\ P))}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ np.abs(2*np.mod(q[i]*np.arange(1,\ P+1)\ +\ rng.random(),\ 1)-\/1)\ \ \textcolor{comment}{\#\ periodizing\ transform}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ on}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ nu\ >\ 0:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ np.sqrt(2*\_gaminv(x,\ nu/2))}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ \_Phinv(c\ +\ x*dc)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s[i:]\ +=\ ch[i:,\ i-\/1:i]\ *\ y}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ si\ =\ s[i,\ :];\ c\ =\ on.copy();\ ai\ =\ az[i]*r\ -\/\ si;\ d\ =\ on.copy();\ bi\ =\ bz[i]*r\ -\/\ si}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ c[ai\ <=\ -\/9]\ =\ 0;\ tl\ =\ abs(ai)\ <\ 9;\ c[tl]\ =\ \_Phi(ai[tl])}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ d[bi\ <=\ -\/9]\ =\ 0;\ tl\ =\ abs(bi)\ <\ 9;\ d[tl]\ =\ \_Phi(bi[tl])}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ dc\ =\ d\ -\/\ c;\ vp\ =\ vp\ *\ dc}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ d\ =\ (np.mean(vp)\ -\/\ p)/(S\ +\ 1);\ p\ =\ p\ +\ d;\ e\ =\ (S\ -\/\ 1)*e/(S\ +\ 1)\ +\ d**2}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00114}00114\ \ \ \ \ e\ =\ math.sqrt(e)\ \ \textcolor{comment}{\#\ error\ estimate\ is\ 3\ times\ std\ error\ with\ N\ samples.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{return}\ p,\ e}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00118}00118\ \textcolor{comment}{\#\ \ Standard\ statistical\ normal\ distribution\ functions}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00119}00119\ \textcolor{keyword}{def\ }\_Phi(z):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00120}00120\ \ \ \ \ \textcolor{keywordflow}{return}\ special.ndtr(z)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00123}00123\ \textcolor{keyword}{def\ }\_Phinv(p):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{return}\ special.ndtri(p)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00127}\mbox{\hyperlink{namespace__mvt_a4fcfac81458e6e33e98c2541849b950a}{00127}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespace__mvt_a4fcfac81458e6e33e98c2541849b950a}{\_chlrps}}(R,\ a,\ b):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00128}00128\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ Computes\ permuted\ and\ scaled\ lower\ Cholesky\ factor\ c\ for\ R\ which\ may\ be}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00130}00130\ \textcolor{stringliteral}{\ \ \ \ singular,\ also\ permuting\ and\ scaling\ integration\ limit\ vectors\ a\ and\ b.}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00132}00132\ \ \ \ \ ep\ =\ 1e-\/10\ \ \textcolor{comment}{\#\ singularity\ tolerance}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00133}00133\ \ \ \ \ eps\ =\ np.finfo(R.dtype).eps}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00135}00135\ \ \ \ \ n\ =\ len(R);\ c\ =\ R.copy();\ ap\ =\ a.copy();\ bp\ =\ b.copy();\ d\ =\ np.sqrt(np.maximum(np.diag(c),\ 0))}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00136}00136\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ d[i]\ >\ 0:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ c[:,\ i]\ /=\ d[i];\ c[i,\ :]\ /=\ d[i]}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ ap[i]\ /=\ d[i];\ bp[i]\ /=\ d[i]}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00140}00140\ \ \ \ \ y\ =\ np.zeros((n,\ 1));\ sqtp\ =\ math.sqrt(2*math.pi)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00142}00142\ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ im\ =\ k;\ ckk\ =\ 0;\ dem\ =\ 1;\ s\ =\ 0}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(k,\ n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ c[i,\ i]\ >\ eps:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cii\ =\ math.sqrt(max(c[i,\ i],\ 0))}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i\ >\ 0:\ s\ =\ c[i,\ :k]\ @\ y[:k]}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ai\ =\ (ap[i]-\/s)/cii;\ bi\ =\ (bp[i]-\/s)/cii;\ de\ =\ \_Phi(bi)-\/\_Phi(ai)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ de\ <=\ dem:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ckk\ =\ cii;\ dem\ =\ de;\ am\ =\ ai;\ bm\ =\ bi;\ im\ =\ i}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ im\ >\ k:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ ap[[im,\ k]]\ =\ ap[[k,\ im]];\ bp[[im,\ k]]\ =\ bp[[k,\ im]];\ c[im,\ im]\ =\ c[k,\ k]}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ c[im,\ :k].copy();\ c[im,\ :k]\ =\ c[k,\ :k];\ c[k,\ :k]\ =\ t}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ c[im+1:,\ im].copy();\ c[im+1:,\ im]\ =\ c[im+1:,\ k];\ c[im+1:,\ k]\ =\ t}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ c[k+1:im,\ k].copy();\ c[k+1:im,\ k]\ =\ c[im,\ k+1:im].T;\ c[im,\ k+1:im]\ =\ t.T}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ckk\ >\ ep*(k+1):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ c[k,\ k]\ =\ ckk;\ c[k,\ k+1:]\ =\ 0}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(k+1,\ n):}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[i,\ k]\ =\ c[i,\ k]/ckk;\ c[i,\ k+1:i+1]\ =\ c[i,\ k+1:i+1]\ -\/\ c[i,\ k]*c[k+1:i+1,\ k].T}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ abs(dem)\ >\ ep:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y[k]\ =\ (np.exp(-\/am**2/2)\ -\/\ np.exp(-\/bm**2/2))\ /\ (sqtp*dem)}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y[k]\ =\ (am\ +\ bm)\ /\ 2}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ am\ <\ -\/10:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y[k]\ =\ bm}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bm\ >\ 10:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y[k]\ =\ am}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ c[k,\ :k+1]\ /=\ ckk;\ ap[k]\ /=\ ckk;\ bp[k]\ /=\ ckk}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ c[k:,\ k]\ =\ 0;\ y[k]\ =\ (ap[k]\ +\ bp[k])/2}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{__mvt_8py_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{return}\ c,\ ap,\ bp}

\end{DoxyCode}
