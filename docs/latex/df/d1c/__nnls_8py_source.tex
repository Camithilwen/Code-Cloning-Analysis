\doxysection{\+\_\+nnls.\+py}
\hypertarget{__nnls_8py_source}{}\label{__nnls_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_nnls.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_nnls.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__nnls}{00001}}\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ \_\_nnls}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00002}00002\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ asarray\_chkfinite,\ zeros,\ double}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00004}00004\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'nnls'}]}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00007}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__nnls_a135dfea7fa444e259fd0fa3b96e0428d}{00007}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__nnls_a135dfea7fa444e259fd0fa3b96e0428d}{nnls}}(A,\ b,\ maxiter=None):}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00008}00008\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00009}00009\ \textcolor{stringliteral}{\ \ \ \ Solve\ \`{}\`{}argmin\_x\ ||\ Ax\ -\/\ b\ ||\_2\`{}\`{}\ for\ \`{}\`{}x>=0\`{}\`{}.\ This\ is\ a\ wrapper}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00010}00010\ \textcolor{stringliteral}{\ \ \ \ for\ a\ FORTRAN\ non-\/negative\ least\ squares\ solver.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00011}00011\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00012}00012\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ A\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Matrix\ \`{}\`{}A\`{}\`{}\ as\ shown\ above.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ b\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right-\/hand\ side\ vector.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ maxiter:\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations,\ optional.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ \`{}\`{}3\ *\ A.shape[1]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00021}00021\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Solution\ vector.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ rnorm\ :\ float}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ residual,\ \`{}\`{}||\ Ax-\/b\ ||\_2\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00028}00028\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ lsq\_linear\ :\ Linear\ least\ squares\ with\ bounds\ on\ the\ variables}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00032}00032\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ The\ FORTRAN\ code\ was\ published\ in\ the\ book\ below.\ The\ algorithm}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ is\ an\ active\ set\ method.\ It\ solves\ the\ KKT\ (Karush-\/Kuhn-\/Tucker)}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ conditions\ for\ the\ non-\/negative\ least\ squares\ problem.}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00038}00038\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ Lawson\ C.,\ Hanson\ R.J.,\ (1987)\ Solving\ Least\ Squares\ Problems,\ SIAM}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00042}00042\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.optimize\ import\ nnls}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ ...}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ >>>\ A\ =\ np.array([[1,\ 0],\ [1,\ 0],\ [0,\ 1]])}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ >>>\ b\ =\ np.array([2,\ 1,\ 1])}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ >>>\ nnls(A,\ b)}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ (array([1.5,\ 1.\ ]),\ 0.7071067811865475)}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00052}00052\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ >>>\ b\ =\ np.array([-\/1,\ -\/1,\ -\/1])}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ >>>\ nnls(A,\ b)}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ (array([0.,\ 0.]),\ 1.7320508075688772)}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00056}00056\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00059}00059\ \ \ \ \ A,\ b\ =\ map(asarray\_chkfinite,\ (A,\ b))}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{if}\ len(A.shape)\ !=\ 2:}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Expected\ a\ two-\/dimensional\ array\ (matrix)"{}}\ +}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{},\ but\ the\ shape\ of\ A\ is\ \{A.shape\}"{}})}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{if}\ len(b.shape)\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Expected\ a\ one-\/dimensional\ array\ (vector)"{}}\ +}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{},\ but\ the\ shape\ of\ b\ is\ \{b.shape\}"{}})}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00068}00068\ \ \ \ \ m,\ n\ =\ A.shape}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{if}\ m\ !=\ b.shape[0]:}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Incompatible\ dimensions.\ The\ first\ dimension\ of\ "{}}\ +}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}A\ is\ \{m\},\ while\ the\ shape\ of\ b\ is\ \{(b.shape[0],\ )\}"{}})}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00075}00075\ \ \ \ \ maxiter\ =\ -\/1\ \textcolor{keywordflow}{if}\ maxiter\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ int(maxiter)}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00077}00077\ \ \ \ \ w\ =\ zeros((n,),\ dtype=double)}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00078}00078\ \ \ \ \ zz\ =\ zeros((m,),\ dtype=double)}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00079}00079\ \ \ \ \ index\ =\ zeros((n,),\ dtype=int)}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00081}00081\ \ \ \ \ x,\ rnorm,\ mode\ =\ \_\_nnls.nnls(A,\ m,\ n,\ b,\ w,\ zz,\ index,\ maxiter)}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00082}00082\ \ \ \ \ \textcolor{keywordflow}{if}\ mode\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classRuntimeError}{RuntimeError}}(\textcolor{stringliteral}{"{}too\ many\ iterations"{}})}
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{__nnls_8py_source_l00085}00085\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ rnorm}

\end{DoxyCode}
