\doxysection{test\+\_\+kernel\+\_\+approximation.\+py}
\hypertarget{test__kernel__approximation_8py_source}{}\label{test__kernel__approximation_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/tests/test\_kernel\_approximation.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/tests/test\_kernel\_approximation.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation}{00001}}\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00004}00004\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1datasets}{sklearn.datasets}}\ \textcolor{keyword}{import}\ make\_classification}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1kernel__approximation}{sklearn.kernel\_approximation}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00008}00008\ \ \ \ \ AdditiveChi2Sampler,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00009}00009\ \ \ \ \ Nystroem,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00010}00010\ \ \ \ \ PolynomialCountSketch,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00011}00011\ \ \ \ \ RBFSampler,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00012}00012\ \ \ \ \ SkewedChi2Sampler,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00013}00013\ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1metrics_1_1pairwise}{sklearn.metrics.pairwise}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00015}00015\ \ \ \ \ chi2\_kernel,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00016}00016\ \ \ \ \ kernel\_metrics,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00017}00017\ \ \ \ \ polynomial\_kernel,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00018}00018\ \ \ \ \ rbf\_kernel,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00019}00019\ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00020}00020\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1__testing}{sklearn.utils.\_testing}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00021}00021\ \ \ \ \ assert\_allclose,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00022}00022\ \ \ \ \ assert\_array\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00023}00023\ \ \ \ \ assert\_array\_equal,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00024}00024\ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00025}00025\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1fixes}{sklearn.utils.fixes}}\ \textcolor{keyword}{import}\ CSR\_CONTAINERS}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00027}00027\ \textcolor{comment}{\#\ generate\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00028}00028\ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00029}00029\ X\ =\ rng.random\_sample(size=(300,\ 50))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00030}00030\ Y\ =\ rng.random\_sample(size=(300,\ 50))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00031}00031\ X\ /=\ X.sum(axis=1)[:,\ np.newaxis]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00032}00032\ Y\ /=\ Y.sum(axis=1)[:,\ np.newaxis]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00034}00034\ \textcolor{comment}{\#\ Make\ sure\ X\ and\ Y\ are\ not\ writable\ to\ avoid\ introducing\ dependencies\ between}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00035}00035\ \textcolor{comment}{\#\ tests.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00036}00036\ X.flags.writeable\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00037}00037\ Y.flags.writeable\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00040}00040\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}gamma"{},\ [0.1,\ 1,\ 2.5])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00041}00041\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}degree,\ n\_components"{},\ [(1,\ 500)},\ (2,\ 500),\ (3,\ 5000)])}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00042}00042\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}coef0"{},\ [0,\ 2.5])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00043}00043\ \textcolor{keyword}{def\ }test\_polynomial\_count\_sketch(gamma,\ degree,\ coef0,\ n\_components):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00044}00044\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ PolynomialCountSketch\ approximates\ polynomial}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00045}00045\ \ \ \ \ \textcolor{comment}{\#\ kernel\ on\ random\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00047}00047\ \ \ \ \ \textcolor{comment}{\#\ compute\ exact\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00048}00048\ \ \ \ \ kernel\ =\ polynomial\_kernel(X,\ Y,\ gamma=gamma,\ degree=degree,\ coef0=coef0)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00050}00050\ \ \ \ \ \textcolor{comment}{\#\ approximate\ kernel\ mapping}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00051}00051\ \ \ \ \ ps\_transform\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1PolynomialCountSketch}{PolynomialCountSketch}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ n\_components=n\_components,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ gamma=gamma,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ coef0=coef0,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ degree=degree,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ random\_state=42,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00057}00057\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00058}00058\ \ \ \ \ X\_trans\ =\ ps\_transform.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00059}00059\ \ \ \ \ Y\_trans\ =\ ps\_transform.transform(Y)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00060}00060\ \ \ \ \ kernel\_approx\ =\ np.dot(X\_trans,\ Y\_trans.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00062}00062\ \ \ \ \ error\ =\ kernel\ -\/\ kernel\_approx}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00063}00063\ \ \ \ \ \textcolor{keyword}{assert}\ np.abs(np.mean(error))\ <=\ 0.05\ \ \textcolor{comment}{\#\ close\ to\ unbiased}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00064}00064\ \ \ \ \ np.abs(error,\ out=error)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00065}00065\ \ \ \ \ \textcolor{keyword}{assert}\ np.max(error)\ <=\ 0.1\ \ \textcolor{comment}{\#\ nothing\ too\ far\ off}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00066}00066\ \ \ \ \ \textcolor{keyword}{assert}\ np.mean(error)\ <=\ 0.05\ \ \textcolor{comment}{\#\ mean\ is\ fairly\ close}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00069}00069\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}csr\_container"{},\ CSR\_CONTAINERS)}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00070}00070\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}gamma"{},\ [0.1,\ 1.0])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00071}00071\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}degree"{},\ [1,\ 2,\ 3])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00072}00072\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}coef0"{},\ [0,\ 2.5])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00073}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a9515da94c0fd78bd8db8f68d03eb716a}{00073}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a9515da94c0fd78bd8db8f68d03eb716a}{test\_polynomial\_count\_sketch\_dense\_sparse}}(gamma,\ degree,\ coef0,\ csr\_container):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00074}00074\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ PolynomialCountSketch\ results\ are\ the\ same\ for\ dense\ and\ sparse}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ input.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00077}00077\ \ \ \ \ ps\_dense\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1PolynomialCountSketch}{PolynomialCountSketch}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ n\_components=500,\ gamma=gamma,\ degree=degree,\ coef0=coef0,\ random\_state=42}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00079}00079\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00080}00080\ \ \ \ \ Xt\_dense\ =\ ps\_dense.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00081}00081\ \ \ \ \ Yt\_dense\ =\ ps\_dense.transform(Y)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00083}00083\ \ \ \ \ ps\_sparse\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1PolynomialCountSketch}{PolynomialCountSketch}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ n\_components=500,\ gamma=gamma,\ degree=degree,\ coef0=coef0,\ random\_state=42}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00085}00085\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00086}00086\ \ \ \ \ Xt\_sparse\ =\ ps\_sparse.fit\_transform(csr\_container(X))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00087}00087\ \ \ \ \ Yt\_sparse\ =\ ps\_sparse.transform(csr\_container(Y))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00089}00089\ \ \ \ \ assert\_allclose(Xt\_dense,\ Xt\_sparse)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00090}00090\ \ \ \ \ assert\_allclose(Yt\_dense,\ Yt\_sparse)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00093}00093\ \textcolor{keyword}{def\ }\_linear\_kernel(X,\ Y):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{return}\ np.dot(X,\ Y.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00097}00097\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}csr\_container"{},\ CSR\_CONTAINERS)}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00098}00098\ \textcolor{keyword}{def\ }test\_additive\_chi2\_sampler(csr\_container):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00099}00099\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ AdditiveChi2Sampler\ approximates\ kernel\ on\ random\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00101}00101\ \ \ \ \ \textcolor{comment}{\#\ compute\ exact\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00102}00102\ \ \ \ \ \textcolor{comment}{\#\ abbreviations\ for\ easier\ formula}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00103}00103\ \ \ \ \ X\_\ =\ X[:,\ np.newaxis,\ :].copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00104}00104\ \ \ \ \ Y\_\ =\ Y[np.newaxis,\ :,\ :].copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00106}00106\ \ \ \ \ large\_kernel\ =\ 2\ *\ X\_\ *\ Y\_\ /\ (X\_\ +\ Y\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00108}00108\ \ \ \ \ \textcolor{comment}{\#\ reduce\ to\ n\_samples\_x\ x\ n\_samples\_y\ by\ summing\ over\ features}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00109}00109\ \ \ \ \ kernel\ =\ large\_kernel.sum(axis=2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00111}00111\ \ \ \ \ \textcolor{comment}{\#\ approximate\ kernel\ mapping}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00112}00112\ \ \ \ \ transform\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}(sample\_steps=3)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00113}00113\ \ \ \ \ X\_trans\ =\ transform.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00114}00114\ \ \ \ \ Y\_trans\ =\ transform.transform(Y)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00116}00116\ \ \ \ \ kernel\_approx\ =\ np.dot(X\_trans,\ Y\_trans.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00118}00118\ \ \ \ \ assert\_array\_almost\_equal(kernel,\ kernel\_approx,\ 1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00120}00120\ \ \ \ \ X\_sp\_trans\ =\ transform.fit\_transform(csr\_container(X))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00121}00121\ \ \ \ \ Y\_sp\_trans\ =\ transform.transform(csr\_container(Y))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00123}00123\ \ \ \ \ assert\_array\_equal(X\_trans,\ X\_sp\_trans.toarray())}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00124}00124\ \ \ \ \ assert\_array\_equal(Y\_trans,\ Y\_sp\_trans.toarray())}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00126}00126\ \ \ \ \ \textcolor{comment}{\#\ test\ error\ is\ raised\ on\ negative\ input}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00127}00127\ \ \ \ \ Y\_neg\ =\ Y.copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00128}00128\ \ \ \ \ Y\_neg[0,\ 0]\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00129}00129\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Negative\ values\ in\ data\ passed\ to"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00130}00130\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ transform.fit(Y\_neg)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00134}00134\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}method"{},\ ["{}fit"{},\ "{}fit\_transform"{},\ "{}transform"{}])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00135}00135\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}sample\_steps"{},\ range(1,\ 4)})}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00136}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a4469b29060cbc7dbd90e42765ada575d}{00136}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a4469b29060cbc7dbd90e42765ada575d}{test\_additive\_chi2\_sampler\_sample\_steps}}(method,\ sample\_steps):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00137}00137\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ input\ sample\ step\ doesn't\ raise\ an\ error}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ and\ that\ sample\ interval\ doesn't\ change\ after\ fit.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00140}00140\ \ \ \ \ transformer\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}(sample\_steps=sample\_steps)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00141}00141\ \ \ \ \ getattr(transformer,\ method)(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00143}00143\ \ \ \ \ sample\_interval\ =\ 0.5}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00144}00144\ \ \ \ \ transformer\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ sample\_steps=sample\_steps,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ sample\_interval=sample\_interval,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00147}00147\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00148}00148\ \ \ \ \ getattr(transformer,\ method)(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00149}00149\ \ \ \ \ \textcolor{keyword}{assert}\ transformer.sample\_interval\ ==\ sample\_interval}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00152}00152\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}method"{},\ ["{}fit"{},\ "{}fit\_transform"{},\ "{}transform"{}])}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00153}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a603c677f184b871da87ca5f1237afb92}{00153}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a603c677f184b871da87ca5f1237afb92}{test\_additive\_chi2\_sampler\_wrong\_sample\_steps}}(method):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00154}00154\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ we\ raise\ a\ ValueError\ on\ invalid\ sample\_steps"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00155}00155\ \ \ \ \ transformer\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}(sample\_steps=4)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00156}00156\ \ \ \ \ msg\ =\ re.escape(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}If\ sample\_steps\ is\ not\ in\ [1,\ 2,\ 3],\ you\ need\ to\ provide\ sample\_interval"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00158}00158\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00159}00159\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ getattr(transformer,\ method)(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00163}00163\ \textcolor{keyword}{def\ }test\_skewed\_chi2\_sampler():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00164}00164\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ RBFSampler\ approximates\ kernel\ on\ random\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00166}00166\ \ \ \ \ \textcolor{comment}{\#\ compute\ exact\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00167}00167\ \ \ \ \ c\ =\ 0.03}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00168}00168\ \ \ \ \ \textcolor{comment}{\#\ set\ on\ negative\ component\ but\ greater\ than\ c\ to\ ensure\ that\ the\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00169}00169\ \ \ \ \ \textcolor{comment}{\#\ approximation\ is\ valid\ on\ the\ group\ (-\/c;\ +\(\backslash\)infty)\ endowed\ with\ the\ skewed}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00170}00170\ \ \ \ \ \textcolor{comment}{\#\ multiplication.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00171}00171\ \ \ \ \ Y\_\ =\ Y.copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00172}00172\ \ \ \ \ Y\_[0,\ 0]\ =\ -\/c\ /\ 2.0}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00174}00174\ \ \ \ \ \textcolor{comment}{\#\ abbreviations\ for\ easier\ formula}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00175}00175\ \ \ \ \ X\_c\ =\ (X\ +\ c)[:,\ np.newaxis,\ :]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00176}00176\ \ \ \ \ Y\_c\ =\ (Y\_\ +\ c)[np.newaxis,\ :,\ :]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00178}00178\ \ \ \ \ \textcolor{comment}{\#\ we\ do\ it\ in\ log-\/space\ in\ the\ hope\ that\ it's\ more\ stable}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00179}00179\ \ \ \ \ \textcolor{comment}{\#\ this\ array\ is\ n\_samples\_x\ x\ n\_samples\_y\ big\ x\ n\_features}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00180}00180\ \ \ \ \ log\_kernel\ =\ (}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ (np.log(X\_c)\ /\ 2.0)\ +\ (np.log(Y\_c)\ /\ 2.0)\ +\ np.log(2.0)\ -\/\ np.log(X\_c\ +\ Y\_c)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00182}00182\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00183}00183\ \ \ \ \ \textcolor{comment}{\#\ reduce\ to\ n\_samples\_x\ x\ n\_samples\_y\ by\ summing\ over\ features\ in\ log-\/space}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00184}00184\ \ \ \ \ kernel\ =\ np.exp(log\_kernel.sum(axis=2))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00186}00186\ \ \ \ \ \textcolor{comment}{\#\ approximate\ kernel\ mapping}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00187}00187\ \ \ \ \ transform\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1SkewedChi2Sampler}{SkewedChi2Sampler}}(skewedness=c,\ n\_components=1000,\ random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00188}00188\ \ \ \ \ X\_trans\ =\ transform.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00189}00189\ \ \ \ \ Y\_trans\ =\ transform.transform(Y\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00191}00191\ \ \ \ \ kernel\_approx\ =\ np.dot(X\_trans,\ Y\_trans.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00192}00192\ \ \ \ \ assert\_array\_almost\_equal(kernel,\ kernel\_approx,\ 1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00193}00193\ \ \ \ \ \textcolor{keyword}{assert}\ np.isfinite(kernel).all(),\ \textcolor{stringliteral}{"{}NaNs\ found\ in\ the\ Gram\ matrix"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00194}00194\ \ \ \ \ \textcolor{keyword}{assert}\ np.isfinite(kernel\_approx).all(),\ \textcolor{stringliteral}{"{}NaNs\ found\ in\ the\ approximate\ Gram\ matrix"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00196}00196\ \ \ \ \ \textcolor{comment}{\#\ test\ error\ is\ raised\ on\ when\ inputs\ contains\ values\ smaller\ than\ -\/c}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00197}00197\ \ \ \ \ Y\_neg\ =\ Y\_.copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00198}00198\ \ \ \ \ Y\_neg[0,\ 0]\ =\ -\/c\ *\ 2.0}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00199}00199\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}X\ may\ not\ contain\ entries\ smaller\ than\ -\/skewedness"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00200}00200\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ transform.transform(Y\_neg)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00204}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a9d6f4db722c333b1f769e2cb9be829c7}{00204}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a9d6f4db722c333b1f769e2cb9be829c7}{test\_additive\_chi2\_sampler\_exceptions}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00205}00205\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Ensures\ correct\ error\ message"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00206}00206\ \ \ \ \ transformer\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00207}00207\ \ \ \ \ X\_neg\ =\ X.copy()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00208}00208\ \ \ \ \ X\_neg[0,\ 0]\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00209}00209\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}X\ in\ AdditiveChi2Sampler"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ transformer.fit(X\_neg)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00211}00211\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}X\ in\ AdditiveChi2Sampler"{}}):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ transformer.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ transformer.transform(X\_neg)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00216}00216\ \textcolor{keyword}{def\ }test\_rbf\_sampler():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00217}00217\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ RBFSampler\ approximates\ kernel\ on\ random\ data}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00218}00218\ \ \ \ \ \textcolor{comment}{\#\ compute\ exact\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00219}00219\ \ \ \ \ gamma\ =\ 10.0}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00220}00220\ \ \ \ \ kernel\ =\ rbf\_kernel(X,\ Y,\ gamma=gamma)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00222}00222\ \ \ \ \ \textcolor{comment}{\#\ approximate\ kernel\ mapping}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00223}00223\ \ \ \ \ rbf\_transform\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}(gamma=gamma,\ n\_components=1000,\ random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00224}00224\ \ \ \ \ X\_trans\ =\ rbf\_transform.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00225}00225\ \ \ \ \ Y\_trans\ =\ rbf\_transform.transform(Y)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00226}00226\ \ \ \ \ kernel\_approx\ =\ np.dot(X\_trans,\ Y\_trans.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00228}00228\ \ \ \ \ error\ =\ kernel\ -\/\ kernel\_approx}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00229}00229\ \ \ \ \ \textcolor{keyword}{assert}\ np.abs(np.mean(error))\ <=\ 0.01\ \ \textcolor{comment}{\#\ close\ to\ unbiased}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00230}00230\ \ \ \ \ np.abs(error,\ out=error)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00231}00231\ \ \ \ \ \textcolor{keyword}{assert}\ np.max(error)\ <=\ 0.1\ \ \textcolor{comment}{\#\ nothing\ too\ far\ off}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00232}00232\ \ \ \ \ \textcolor{keyword}{assert}\ np.mean(error)\ <=\ 0.05\ \ \textcolor{comment}{\#\ mean\ is\ fairly\ close}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00235}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a52259fdb01ca09d30017f4e11784903a}{00235}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a52259fdb01ca09d30017f4e11784903a}{test\_rbf\_sampler\_fitted\_attributes\_dtype}}(global\_dtype):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00236}00236\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ fitted\ attributes\ are\ stored\ accordingly\ to\ the}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ data\ type\ of\ X."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00238}00238\ \ \ \ \ rbf\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00240}00240\ \ \ \ \ X\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=global\_dtype)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00242}00242\ \ \ \ \ rbf.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00244}00244\ \ \ \ \ \textcolor{keyword}{assert}\ rbf.random\_offset\_.dtype\ ==\ global\_dtype}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00245}00245\ \ \ \ \ \textcolor{keyword}{assert}\ rbf.random\_weights\_.dtype\ ==\ global\_dtype}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00248}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a55476065878372114a2b714b0bdbe2ef}{00248}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a55476065878372114a2b714b0bdbe2ef}{test\_rbf\_sampler\_dtype\_equivalence}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00249}00249\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ equivalence\ of\ the\ results\ with\ 32\ and\ 64\ bits\ input."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00250}00250\ \ \ \ \ rbf32\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}(random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00251}00251\ \ \ \ \ X32\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=np.float32)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00252}00252\ \ \ \ \ rbf32.fit(X32)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00254}00254\ \ \ \ \ rbf64\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}(random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00255}00255\ \ \ \ \ X64\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00256}00256\ \ \ \ \ rbf64.fit(X64)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00258}00258\ \ \ \ \ assert\_allclose(rbf32.random\_offset\_,\ rbf64.random\_offset\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00259}00259\ \ \ \ \ assert\_allclose(rbf32.random\_weights\_,\ rbf64.random\_weights\_)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00262}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a4de31aedb86fc3cc716a3f2f91ee11c3}{00262}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a4de31aedb86fc3cc716a3f2f91ee11c3}{test\_rbf\_sampler\_gamma\_scale}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00263}00263\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ inner\ value\ computed\ when\ \`{}gamma='scale'\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00264}00264\ \ \ \ \ X,\ y\ =\ [[0.0],\ [1.0]],\ [0,\ 1]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00265}00265\ \ \ \ \ rbf\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}(gamma=\textcolor{stringliteral}{"{}scale"{}})}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00266}00266\ \ \ \ \ rbf.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00267}00267\ \ \ \ \ \textcolor{keyword}{assert}\ rbf.\_gamma\ ==\ pytest.approx(4)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00270}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a5029a4815fadf14850b530965138c1d0}{00270}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a5029a4815fadf14850b530965138c1d0}{test\_skewed\_chi2\_sampler\_fitted\_attributes\_dtype}}(global\_dtype):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00271}00271\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ fitted\ attributes\ are\ stored\ accordingly\ to\ the}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ data\ type\ of\ X."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00273}00273\ \ \ \ \ skewed\_chi2\_sampler\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1SkewedChi2Sampler}{SkewedChi2Sampler}}()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00274}00274\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00275}00275\ \ \ \ \ X\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=global\_dtype)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00277}00277\ \ \ \ \ skewed\_chi2\_sampler.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00279}00279\ \ \ \ \ \textcolor{keyword}{assert}\ skewed\_chi2\_sampler.random\_offset\_.dtype\ ==\ global\_dtype}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00280}00280\ \ \ \ \ \textcolor{keyword}{assert}\ skewed\_chi2\_sampler.random\_weights\_.dtype\ ==\ global\_dtype}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00283}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a05022a1aee88d02352fd3d4db1271219}{00283}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a05022a1aee88d02352fd3d4db1271219}{test\_skewed\_chi2\_sampler\_dtype\_equivalence}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00284}00284\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ equivalence\ of\ the\ results\ with\ 32\ and\ 64\ bits\ input."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00285}00285\ \ \ \ \ skewed\_chi2\_sampler\_32\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1SkewedChi2Sampler}{SkewedChi2Sampler}}(random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00286}00286\ \ \ \ \ X\_32\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=np.float32)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00287}00287\ \ \ \ \ skewed\_chi2\_sampler\_32.fit(X\_32)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00288}00288\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00289}00289\ \ \ \ \ skewed\_chi2\_sampler\_64\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1SkewedChi2Sampler}{SkewedChi2Sampler}}(random\_state=42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00290}00290\ \ \ \ \ X\_64\ =\ np.array([[1,\ 2],\ [3,\ 4],\ [5,\ 6]],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00291}00291\ \ \ \ \ skewed\_chi2\_sampler\_64.fit(X\_64)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00292}00292\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00293}00293\ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ skewed\_chi2\_sampler\_32.random\_offset\_,\ skewed\_chi2\_sampler\_64.random\_offset\_}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00295}00295\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00296}00296\ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ skewed\_chi2\_sampler\_32.random\_weights\_,\ skewed\_chi2\_sampler\_64.random\_weights\_}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00298}00298\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00299}00299\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00301}00301\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}csr\_container"{},\ CSR\_CONTAINERS)}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00302}00302\ \textcolor{keyword}{def\ }test\_input\_validation(csr\_container):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00303}00303\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test:\ kernel\ approx.\ transformers\ should\ work\ on\ lists}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00304}00304\ \ \ \ \ \textcolor{comment}{\#\ No\ assertions;\ the\ old\ versions\ would\ simply\ crash}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00305}00305\ \ \ \ \ X\ =\ [[1,\ 2],\ [3,\ 4],\ [5,\ 6]]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00306}00306\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}().fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00307}00307\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1SkewedChi2Sampler}{SkewedChi2Sampler}}().fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00308}00308\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}().fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00310}00310\ \ \ \ \ X\ =\ csr\_container(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00311}00311\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1RBFSampler}{RBFSampler}}().fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00314}00314\ \textcolor{keyword}{def\ }test\_nystroem\_approximation():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00315}00315\ \ \ \ \ \textcolor{comment}{\#\ some\ basic\ tests}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00316}00316\ \ \ \ \ rnd\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00317}00317\ \ \ \ \ X\ =\ rnd.uniform(size=(10,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00318}00318\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00319}00319\ \ \ \ \ \textcolor{comment}{\#\ With\ n\_components\ =\ n\_samples\ this\ is\ exact}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00320}00320\ \ \ \ \ X\_transformed\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(n\_components=X.shape[0]).fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00321}00321\ \ \ \ \ K\ =\ rbf\_kernel(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00322}00322\ \ \ \ \ assert\_array\_almost\_equal(np.dot(X\_transformed,\ X\_transformed.T),\ K)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00323}00323\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00324}00324\ \ \ \ \ trans\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(n\_components=2,\ random\_state=rnd)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00325}00325\ \ \ \ \ X\_transformed\ =\ trans.fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00326}00326\ \ \ \ \ \textcolor{keyword}{assert}\ X\_transformed.shape\ ==\ (X.shape[0],\ 2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00328}00328\ \ \ \ \ \textcolor{comment}{\#\ test\ callable\ kernel}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00329}00329\ \ \ \ \ trans\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(n\_components=2,\ kernel=\_linear\_kernel,\ random\_state=rnd)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00330}00330\ \ \ \ \ X\_transformed\ =\ trans.fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00331}00331\ \ \ \ \ \textcolor{keyword}{assert}\ X\_transformed.shape\ ==\ (X.shape[0],\ 2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00332}00332\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00333}00333\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ available\ kernels\ fit\ and\ transform}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00334}00334\ \ \ \ \ kernels\_available\ =\ kernel\_metrics()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00335}00335\ \ \ \ \ \textcolor{keywordflow}{for}\ kern\ \textcolor{keywordflow}{in}\ kernels\_available:}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ trans\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(n\_components=2,\ kernel=kern,\ random\_state=rnd)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ X\_transformed\ =\ trans.fit(X).transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ X\_transformed.shape\ ==\ (X.shape[0],\ 2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00341}00341\ \textcolor{keyword}{def\ }test\_nystroem\_default\_parameters():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00342}00342\ \ \ \ \ rnd\ =\ np.random.RandomState(42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00343}00343\ \ \ \ \ X\ =\ rnd.uniform(size=(10,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00344}00344\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00345}00345\ \ \ \ \ \textcolor{comment}{\#\ rbf\ kernel\ should\ behave\ as\ gamma=None\ by\ default}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00346}00346\ \ \ \ \ \textcolor{comment}{\#\ aka\ gamma\ =\ 1\ /\ n\_features}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00347}00347\ \ \ \ \ nystroem\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(n\_components=10)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00348}00348\ \ \ \ \ X\_transformed\ =\ nystroem.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00349}00349\ \ \ \ \ K\ =\ rbf\_kernel(X,\ gamma=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00350}00350\ \ \ \ \ K2\ =\ np.dot(X\_transformed,\ X\_transformed.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00351}00351\ \ \ \ \ assert\_array\_almost\_equal(K,\ K2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00352}00352\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00353}00353\ \ \ \ \ \textcolor{comment}{\#\ chi2\ kernel\ should\ behave\ as\ gamma=1\ by\ default}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00354}00354\ \ \ \ \ nystroem\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(kernel=\textcolor{stringliteral}{"{}chi2"{}},\ n\_components=10)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00355}00355\ \ \ \ \ X\_transformed\ =\ nystroem.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00356}00356\ \ \ \ \ K\ =\ chi2\_kernel(X,\ gamma=1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00357}00357\ \ \ \ \ K2\ =\ np.dot(X\_transformed,\ X\_transformed.T)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00358}00358\ \ \ \ \ assert\_array\_almost\_equal(K,\ K2)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00360}00360\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00361}00361\ \textcolor{keyword}{def\ }test\_nystroem\_singular\_kernel():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00362}00362\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ nystroem\ works\ with\ singular\ kernel\ matrix}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00363}00363\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00364}00364\ \ \ \ \ X\ =\ rng.rand(10,\ 20)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00365}00365\ \ \ \ \ X\ =\ np.vstack([X]\ *\ 2)\ \ \textcolor{comment}{\#\ duplicate\ samples}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00367}00367\ \ \ \ \ gamma\ =\ 100}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00368}00368\ \ \ \ \ N\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(gamma=gamma,\ n\_components=X.shape[0]).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00369}00369\ \ \ \ \ X\_transformed\ =\ N.transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00371}00371\ \ \ \ \ K\ =\ rbf\_kernel(X,\ gamma=gamma)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00372}00372\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00373}00373\ \ \ \ \ assert\_array\_almost\_equal(K,\ np.dot(X\_transformed,\ X\_transformed.T))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00374}00374\ \ \ \ \ \textcolor{keyword}{assert}\ np.all(np.isfinite(Y))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00375}00375\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00376}00376\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00377}00377\ \textcolor{keyword}{def\ }test\_nystroem\_poly\_kernel\_params():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00378}00378\ \ \ \ \ \textcolor{comment}{\#\ Non-\/regression:\ Nystroem\ should\ pass\ other\ parameters\ beside\ gamma.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00379}00379\ \ \ \ \ rnd\ =\ np.random.RandomState(37)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00380}00380\ \ \ \ \ X\ =\ rnd.uniform(size=(10,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00381}00381\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00382}00382\ \ \ \ \ K\ =\ polynomial\_kernel(X,\ degree=3.1,\ coef0=0.1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00383}00383\ \ \ \ \ nystroem\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00384}00384\ \ \ \ \ \ \ \ \ kernel=\textcolor{stringliteral}{"{}polynomial"{}},\ n\_components=X.shape[0],\ degree=3.1,\ coef0=0.1}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00385}00385\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00386}00386\ \ \ \ \ X\_transformed\ =\ nystroem.fit\_transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00387}00387\ \ \ \ \ assert\_array\_almost\_equal(np.dot(X\_transformed,\ X\_transformed.T),\ K)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00389}00389\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00390}00390\ \textcolor{keyword}{def\ }test\_nystroem\_callable():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00391}00391\ \ \ \ \ \textcolor{comment}{\#\ Test\ Nystroem\ on\ a\ callable.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00392}00392\ \ \ \ \ rnd\ =\ np.random.RandomState(42)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00393}00393\ \ \ \ \ n\_samples\ =\ 10}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00394}00394\ \ \ \ \ X\ =\ rnd.uniform(size=(n\_samples,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00395}00395\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00396}00396\ \ \ \ \ \textcolor{keyword}{def\ }logging\_histogram\_kernel(x,\ y,\ log):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Histogram\ kernel\ that\ writes\ to\ a\ log."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00398}00398\ \ \ \ \ \ \ \ \ log.append(1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.minimum(x,\ y).sum()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00400}00400\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00401}00401\ \ \ \ \ kernel\_log\ =\ []}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00402}00402\ \ \ \ \ X\ =\ list(X)\ \ \textcolor{comment}{\#\ test\ input\ validation}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00403}00403\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ kernel=logging\_histogram\_kernel,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ n\_components=(n\_samples\ -\/\ 1),}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ kernel\_params=\{\textcolor{stringliteral}{"{}log"{}}:\ kernel\_log\},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00407}00407\ \ \ \ \ ).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00408}00408\ \ \ \ \ \textcolor{keyword}{assert}\ len(kernel\_log)\ ==\ n\_samples\ *\ (n\_samples\ -\/\ 1)\ /\ 2}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00409}00409\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00410}00410\ \ \ \ \ \textcolor{comment}{\#\ if\ degree,\ gamma\ or\ coef0\ is\ passed,\ we\ raise\ a\ ValueError}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00411}00411\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Don't\ pass\ gamma,\ coef0\ or\ degree\ to\ Nystroem"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00412}00412\ \ \ \ \ params\ =\ (\{\textcolor{stringliteral}{"{}gamma"{}}:\ 1\},\ \{\textcolor{stringliteral}{"{}coef0"{}}:\ 1\},\ \{\textcolor{stringliteral}{"{}degree"{}}:\ 2\})}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00413}00413\ \ \ \ \ \textcolor{keywordflow}{for}\ param\ \textcolor{keywordflow}{in}\ params:}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ ny\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(kernel=\_linear\_kernel,\ n\_components=(n\_samples\ -\/\ 1),\ **param)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ ny.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00417}00417\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00418}00418\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00419}00419\ \textcolor{keyword}{def\ }test\_nystroem\_precomputed\_kernel():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00420}00420\ \ \ \ \ \textcolor{comment}{\#\ Non-\/regression:\ test\ Nystroem\ on\ precomputed\ kernel.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00421}00421\ \ \ \ \ \textcolor{comment}{\#\ PR\ -\/\ 14706}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00422}00422\ \ \ \ \ rnd\ =\ np.random.RandomState(12)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00423}00423\ \ \ \ \ X\ =\ rnd.uniform(size=(10,\ 4))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00424}00424\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00425}00425\ \ \ \ \ K\ =\ polynomial\_kernel(X,\ degree=2,\ coef0=0.1)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00426}00426\ \ \ \ \ nystroem\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ n\_components=X.shape[0])}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00427}00427\ \ \ \ \ X\_transformed\ =\ nystroem.fit\_transform(K)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00428}00428\ \ \ \ \ assert\_array\_almost\_equal(np.dot(X\_transformed,\ X\_transformed.T),\ K)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00429}00429\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00430}00430\ \ \ \ \ \textcolor{comment}{\#\ if\ degree,\ gamma\ or\ coef0\ is\ passed,\ we\ raise\ a\ ValueError}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00431}00431\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Don't\ pass\ gamma,\ coef0\ or\ degree\ to\ Nystroem"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00432}00432\ \ \ \ \ params\ =\ (\{\textcolor{stringliteral}{"{}gamma"{}}:\ 1\},\ \{\textcolor{stringliteral}{"{}coef0"{}}:\ 1\},\ \{\textcolor{stringliteral}{"{}degree"{}}:\ 2\})}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00433}00433\ \ \ \ \ \textcolor{keywordflow}{for}\ param\ \textcolor{keywordflow}{in}\ params:}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ ny\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(kernel=\textcolor{stringliteral}{"{}precomputed"{}},\ n\_components=X.shape[0],\ **param)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ ny.fit(K)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00437}00437\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00439}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_aba20be2ff69c69502b0b3f92122b78b8}{00439}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_aba20be2ff69c69502b0b3f92122b78b8}{test\_nystroem\_component\_indices}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00440}00440\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ \`{}component\_indices\_\`{}\ corresponds\ to\ the\ subset\ of}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ training\ points\ used\ to\ construct\ the\ feature\ map.}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/20474}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00444}00444\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00445}00445\ \ \ \ \ X,\ \_\ =\ make\_classification(n\_samples=100,\ n\_features=20)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00446}00446\ \ \ \ \ feature\_map\_nystroem\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1Nystroem}{Nystroem}}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ n\_components=10,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ random\_state=0,}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00449}00449\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00450}00450\ \ \ \ \ feature\_map\_nystroem.fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00451}00451\ \ \ \ \ \textcolor{keyword}{assert}\ feature\_map\_nystroem.component\_indices\_.shape\ ==\ (10,)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00452}00452\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00453}00453\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00454}00454\ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00455}00455\ \ \ \ \ \textcolor{stringliteral}{"{}Estimator"{}},\ [PolynomialCountSketch,\ RBFSampler,\ SkewedChi2Sampler,\ Nystroem]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00456}00456\ )}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00457}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a45fb24179607d2cced7074df016c930d}{00457}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a45fb24179607d2cced7074df016c930d}{test\_get\_feature\_names\_out}}(Estimator):}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00458}00458\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ get\_feature\_names\_out"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00459}00459\ \ \ \ \ est\ =\ Estimator().fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00460}00460\ \ \ \ \ X\_trans\ =\ est.transform(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00461}00461\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00462}00462\ \ \ \ \ names\_out\ =\ est.get\_feature\_names\_out()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00463}00463\ \ \ \ \ class\_name\ =\ Estimator.\_\_name\_\_.lower()}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00464}00464\ \ \ \ \ expected\_names\ =\ [f\textcolor{stringliteral}{"{}\{class\_name\}\{i\}"{}}\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(X\_trans.shape[1])]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00465}00465\ \ \ \ \ assert\_array\_equal(names\_out,\ expected\_names)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00466}00466\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00468}\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a920474546f99422a0ba192b41a125133}{00468}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1tests_1_1test__kernel__approximation_a920474546f99422a0ba192b41a125133}{test\_additivechi2sampler\_get\_feature\_names\_out}}():}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00469}00469\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ get\_feature\_names\_out\ for\ AdditiveChi2Sampler."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00470}00470\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00471}00471\ \ \ \ \ X\ =\ rng.random\_sample(size=(300,\ 3))}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00472}00472\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00473}00473\ \ \ \ \ chi2\_sampler\ =\ \mbox{\hyperlink{classsklearn_1_1kernel__approximation_1_1AdditiveChi2Sampler}{AdditiveChi2Sampler}}(sample\_steps=3).fit(X)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00474}00474\ \ \ \ \ input\_names\ =\ [\textcolor{stringliteral}{"{}f0"{}},\ \textcolor{stringliteral}{"{}f1"{}},\ \textcolor{stringliteral}{"{}f2"{}}]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00475}00475\ \ \ \ \ suffixes\ =\ [}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f0\_sqrt"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f1\_sqrt"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f2\_sqrt"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f0\_cos1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f1\_cos1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f2\_cos1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f0\_sin1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00483}00483\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f1\_sin1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00484}00484\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f2\_sin1"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00485}00485\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f0\_cos2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f1\_cos2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00487}00487\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f2\_cos2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00488}00488\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f0\_sin2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00489}00489\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f1\_sin2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00490}00490\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}f2\_sin2"{}},}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00491}00491\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00492}00492\ }
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00493}00493\ \ \ \ \ names\_out\ =\ chi2\_sampler.get\_feature\_names\_out(input\_features=input\_names)}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00494}00494\ \ \ \ \ expected\_names\ =\ [f\textcolor{stringliteral}{"{}additivechi2sampler\_\{suffix\}"{}}\ \textcolor{keywordflow}{for}\ suffix\ \textcolor{keywordflow}{in}\ suffixes]}
\DoxyCodeLine{\Hypertarget{test__kernel__approximation_8py_source_l00495}00495\ \ \ \ \ assert\_array\_equal(names\_out,\ expected\_names)}

\end{DoxyCode}
