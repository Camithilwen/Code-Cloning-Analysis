\doxysection{test\+\_\+mstats\+\_\+extras.\+py}
\hypertarget{test__mstats__extras_8py_source}{}\label{test__mstats__extras_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/test\_mstats\_extras.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/test\_mstats\_extras.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__mstats__extras}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00002}00002\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacenumpy_1_1ma}{numpy.ma}}\ \textcolor{keyword}{as}\ ma}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00003}00003\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1mstats}{scipy.stats.mstats}}\ \textcolor{keyword}{as}\ ms}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ (assert\_equal,\ assert\_almost\_equal,\ assert\_,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00006}00006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00009}00009\ \textcolor{keyword}{def\ }test\_compare\_medians\_ms():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00010}00010\ \ \ \ \ x\ =\ np.arange(7)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00011}00011\ \ \ \ \ y\ =\ x\ +\ 10}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00012}00012\ \ \ \ \ assert\_almost\_equal(ms.compare\_medians\_ms(x,\ y),\ 0)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00014}00014\ \ \ \ \ y2\ =\ np.linspace(0,\ 1,\ num=10)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00015}00015\ \ \ \ \ assert\_almost\_equal(ms.compare\_medians\_ms(x,\ y2),\ 0.017116406778)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00018}00018\ \textcolor{keyword}{def\ }test\_hdmedian():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00019}00019\ \ \ \ \ \textcolor{comment}{\#\ 1-\/D\ array}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00020}00020\ \ \ \ \ x\ =\ ma.arange(11)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00021}00021\ \ \ \ \ assert\_allclose(ms.hdmedian(x),\ 5,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00022}00022\ \ \ \ \ x.mask\ =\ ma.make\_mask(x)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00023}00023\ \ \ \ \ x.mask[:7]\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00024}00024\ \ \ \ \ assert\_allclose(ms.hdmedian(x),\ 3,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00026}00026\ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ \`{}var`\ keyword\ returns\ a\ value.\ \ TODO:\ check\ whether\ returned}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00027}00027\ \ \ \ \ \textcolor{comment}{\#\ value\ is\ actually\ correct.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00028}00028\ \ \ \ \ assert\_(ms.hdmedian(x,\ var=\textcolor{keyword}{True}).size\ ==\ 2)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00030}00030\ \ \ \ \ \textcolor{comment}{\#\ 2-\/D\ array}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00031}00031\ \ \ \ \ x2\ =\ ma.arange(22).reshape((11,\ 2))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00032}00032\ \ \ \ \ assert\_allclose(ms.hdmedian(x2,\ axis=0),\ [10,\ 11])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00033}00033\ \ \ \ \ x2.mask\ =\ ma.make\_mask(x2)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00034}00034\ \ \ \ \ x2.mask[:7,\ :]\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00035}00035\ \ \ \ \ assert\_allclose(ms.hdmedian(x2,\ axis=0),\ [6,\ 7])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00038}00038\ \textcolor{keyword}{def\ }test\_rsh():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00039}00039\ \ \ \ \ np.random.seed(132345)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00040}00040\ \ \ \ \ x\ =\ np.random.randn(100)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00041}00041\ \ \ \ \ res\ =\ ms.rsh(x)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00042}00042\ \ \ \ \ \textcolor{comment}{\#\ Just\ a\ sanity\ check\ that\ the\ code\ runs\ and\ output\ shape\ is\ correct.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00043}00043\ \ \ \ \ \textcolor{comment}{\#\ TODO:\ check\ that\ implementation\ is\ correct.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00044}00044\ \ \ \ \ assert\_(res.shape\ ==\ x.shape)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00046}00046\ \ \ \ \ \textcolor{comment}{\#\ Check\ points\ keyword}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00047}00047\ \ \ \ \ res\ =\ ms.rsh(x,\ points=[0,\ 1.])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00048}00048\ \ \ \ \ assert\_(res.size\ ==\ 2)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00051}00051\ \textcolor{keyword}{def\ }test\_mjci():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00052}00052\ \ \ \ \ \textcolor{comment}{\#\ Tests\ the\ Marits-\/Jarrett\ estimator}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00053}00053\ \ \ \ \ data\ =\ ma.array([77,\ 87,\ 88,114,151,210,219,246,253,262,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 296,299,306,376,428,515,666,1310,2611])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00055}00055\ \ \ \ \ assert\_almost\_equal(ms.mjci(data),[55.76819,45.84028,198.87875],5)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00058}00058\ \textcolor{keyword}{def\ }test\_trimmed\_mean\_ci():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ Tests\ the\ confidence\ intervals\ of\ the\ trimmed\ mean.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00060}00060\ \ \ \ \ data\ =\ ma.array([545,555,558,572,575,576,578,580,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 594,605,635,651,653,661,666])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00062}00062\ \ \ \ \ assert\_almost\_equal(ms.trimmed\_mean(data,0.2),\ 596.2,\ 1)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00063}00063\ \ \ \ \ assert\_equal(np.round(ms.trimmed\_mean\_ci(data,(0.2,0.2)),1),}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [561.8,\ 630.6])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00067}00067\ \textcolor{keyword}{def\ }test\_idealfourths():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00068}00068\ \ \ \ \ \textcolor{comment}{\#\ Tests\ ideal-\/fourths}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00069}00069\ \ \ \ \ test\ =\ np.arange(100)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00070}00070\ \ \ \ \ assert\_almost\_equal(np.asarray(ms.idealfourths(test)),}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [24.416667,74.583333],6)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00072}00072\ \ \ \ \ test\_2D\ =\ test.repeat(3).reshape(-\/1,3)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00073}00073\ \ \ \ \ assert\_almost\_equal(ms.idealfourths(test\_2D,\ axis=0),}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[24.416667,24.416667,24.416667],}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [74.583333,74.583333,74.583333]],6)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00076}00076\ \ \ \ \ assert\_almost\_equal(ms.idealfourths(test\_2D,\ axis=1),}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test.repeat(2).reshape(-\/1,2))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00078}00078\ \ \ \ \ test\ =\ [0,\ 0]}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00079}00079\ \ \ \ \ \_result\ =\ ms.idealfourths(test)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00080}00080\ \ \ \ \ assert\_(np.isnan(\_result).all())}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00083}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles}{00083}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles}{TestQuantiles}}:}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00084}00084\ \ \ \ \ data\ =\ [0.706560797,0.727229578,0.990399276,0.927065621,0.158953014,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ 0.887764025,0.239407086,0.349638551,0.972791145,0.149789972,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ 0.936947700,0.132359948,0.046041972,0.641675031,0.945530547,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ 0.224218684,0.771450991,0.820257774,0.336458052,0.589113496,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ 0.509736129,0.696838829,0.491323573,0.622767425,0.775189248,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ 0.641461450,0.118455200,0.773029450,0.319280007,0.752229111,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ 0.047841438,0.466295911,0.583850781,0.840581845,0.550086491,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ 0.466470062,0.504765074,0.226855960,0.362641207,0.891620942,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ 0.127898691,0.490094097,0.044882048,0.041441695,0.317976349,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ 0.504135618,0.567353033,0.434617473,0.636243375,0.231803616,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ 0.230154113,0.160011327,0.819464108,0.854706985,0.438809221,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ 0.487427267,0.786907310,0.408367937,0.405534192,0.250444460,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ 0.995309248,0.144389588,0.739947527,0.953543606,0.680051621,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ 0.388382017,0.863530727,0.006514031,0.118007779,0.924024803,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ 0.384236354,0.893687694,0.626534881,0.473051932,0.750134705,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ 0.241843555,0.432947602,0.689538104,0.136934797,0.150206859,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ 0.474335206,0.907775349,0.525869295,0.189184225,0.854284286,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ 0.831089744,0.251637345,0.587038213,0.254475554,0.237781276,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ 0.827928620,0.480283781,0.594514455,0.213641488,0.024194386,}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ 0.536668589,0.699497811,0.892804071,0.093835427,0.731107772]}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00105}00105\ \ \ \ \ \textcolor{keyword}{def\ }test\_hdquantiles(self):}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ data\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles_a429c2b8ff1a26c30c01721adb83aef06}{data}}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ assert\_almost\_equal(ms.hdquantiles(data,[0.,\ 1.]),}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.006514031,\ 0.995309248])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ hdq\ =\ ms.hdquantiles(data,[0.25,\ 0.5,\ 0.75])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hdq,\ [0.253210762,\ 0.512847491,\ 0.762232442,])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ data\ =\ np.array(data).reshape(10,10)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ hdq\ =\ ms.hdquantiles(data,[0.25,0.5,0.75],axis=0)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hdq[:,0],\ ms.hdquantiles(data[:,0],[0.25,0.5,0.75]))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hdq[:,-\/1],\ ms.hdquantiles(data[:,-\/1],[0.25,0.5,0.75]))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ hdq\ =\ ms.hdquantiles(data,[0.25,0.5,0.75],axis=0,var=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hdq[...,0],}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ms.hdquantiles(data[:,0],[0.25,0.5,0.75],var=\textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hdq[...,-\/1],}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ms.hdquantiles(data[:,-\/1],[0.25,0.5,0.75],\ var=\textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00122}00122\ \ \ \ \ \textcolor{keyword}{def\ }test\_hdquantiles\_sd(self):}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Standard\ deviation\ is\ a\ jackknife\ estimator,\ so\ we\ can\ check\ if}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ efficient\ version\ (hdquantiles\_sd)\ matches\ a\ rudimentary,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ but\ clear\ version\ here.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ hd\_std\_errs\ =\ ms.hdquantiles\_sd(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles_a429c2b8ff1a26c30c01721adb83aef06}{data}})}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ jacknnife\ standard\ error,\ Introduction\ to\ the\ Bootstrap\ Eq.\ 11.5}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ n\ =\ len(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles_a429c2b8ff1a26c30c01721adb83aef06}{data}})}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ jdata\ =\ np.broadcast\_to(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles_a429c2b8ff1a26c30c01721adb83aef06}{data}},\ (n,\ n))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ jselector\ =\ np.logical\_not(np.eye(n))\ \ \textcolor{comment}{\#\ leave\ out\ one\ sample\ each\ row}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ jdata\ =\ jdata[jselector].reshape(n,\ n-\/1)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ jdist\ =\ ms.hdquantiles(jdata,\ axis=1)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ jdist\_mean\ =\ np.mean(jdist,\ axis=0)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ jstd\ =\ ((n-\/1)/n\ *\ np.sum((jdist\ -\/\ jdist\_mean)**2,\ axis=0))**.5}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hd\_std\_errs,\ jstd)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ actual\ values\ for\ good\ measure}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ assert\_almost\_equal(hd\_std\_errs,\ [0.0379258,\ 0.0380656,\ 0.0380013])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ two\_data\_points\ =\ ms.hdquantiles\_sd([1,\ 2])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ assert\_almost\_equal(two\_data\_points,\ [0.5,\ 0.5,\ 0.5])}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00145}00145\ \ \ \ \ \textcolor{keyword}{def\ }test\_mquantiles\_cimj(self):}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Only\ test\ that\ code\ runs,\ implementation\ not\ checked\ for\ correctness}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ ci\_lower,\ ci\_upper\ =\ ms.mquantiles\_cimj(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__mstats__extras_1_1TestQuantiles_a429c2b8ff1a26c30c01721adb83aef06}{data}})}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ assert\_(ci\_lower.size\ ==\ ci\_upper.size\ ==\ 3)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00151}00151\ \textcolor{keyword}{def\ }test\_median\_cihs():}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00152}00152\ \ \ \ \ \textcolor{comment}{\#\ Basic\ test\ against\ R\ library\ EnvStats\ function\ \`{}eqnpar`,\ e.g.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00153}00153\ \ \ \ \ \textcolor{comment}{\#\ library(EnvStats)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00154}00154\ \ \ \ \ \textcolor{comment}{\#\ options(digits=8)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00155}00155\ \ \ \ \ \textcolor{comment}{\#\ x\ =\ c(0.88612955,\ 0.35242375,\ 0.66240904,\ 0.94617974,\ 0.10929913,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00156}00156\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ 0.76699506,\ 0.88550655,\ 0.62763754,\ 0.76818588,\ 0.68506508,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00157}00157\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ 0.88043148,\ 0.03911248,\ 0.93805564,\ 0.95326961,\ 0.25291112,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00158}00158\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ 0.16128487,\ 0.49784577,\ 0.24588924,\ 0.6597,\ 0.92239679)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00159}00159\ \ \ \ \ \textcolor{comment}{\#\ eqnpar(x,\ p=0.5,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00160}00160\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ ci.method\ =\ "{}interpolate"{},\ approx.conf.level\ =\ 0.95,\ ci\ =\ TRUE)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00161}00161\ \ \ \ \ rng\ =\ np.random.default\_rng(8824288259505800535)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00162}00162\ \ \ \ \ x\ =\ rng.random(size=20)}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00163}00163\ \ \ \ \ assert\_allclose(ms.median\_cihs(x),\ (0.38663198,\ 0.88431272))}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00165}00165\ \ \ \ \ \textcolor{comment}{\#\ SciPy's\ 90\%\ CI\ upper\ limit\ doesn't\ match\ that\ of\ EnvStats\ eqnpar.\ SciPy}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00166}00166\ \ \ \ \ \textcolor{comment}{\#\ doesn't\ look\ wrong,\ and\ it\ agrees\ with\ a\ different\ reference,}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00167}00167\ \ \ \ \ \textcolor{comment}{\#\ \`{}median\_confint\_hs`\ from\ \`{}hoehleatsu/quantileCI`.}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00168}00168\ \ \ \ \ \textcolor{comment}{\#\ In\ (e.g.)\ Colab\ with\ R\ runtime:}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00169}00169\ \ \ \ \ \textcolor{comment}{\#\ devtools::install\_github("{}hoehleatsu/quantileCI"{})}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00170}00170\ \ \ \ \ \textcolor{comment}{\#\ library(quantileCI)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00171}00171\ \ \ \ \ \textcolor{comment}{\#\ median\_confint\_hs(x=x,\ conf.level=0.90,\ interpolate=TRUE)}}
\DoxyCodeLine{\Hypertarget{test__mstats__extras_8py_source_l00172}00172\ \ \ \ \ assert\_allclose(ms.median\_cihs(x,\ 0.1),\ (0.48319773366,\ 0.88094268050))}

\end{DoxyCode}
