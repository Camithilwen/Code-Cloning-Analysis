\doxysection{test\+\_\+backports.\+py}
\hypertarget{test__backports_8py_source}{}\label{test__backports_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/test\_backports.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/test\_backports.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1test_1_1test__backports}{00001}}\ \textcolor{keyword}{import}\ mmap}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00003}00003\ \textcolor{keyword}{from}\ joblib\ \textcolor{keyword}{import}\ Parallel,\ delayed}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1backports}{joblib.backports}}\ \textcolor{keyword}{import}\ concurrency\_safe\_rename,\ make\_memmap}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1test_1_1common}{joblib.test.common}}\ \textcolor{keyword}{import}\ with\_numpy}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1testing}{joblib.testing}}\ \textcolor{keyword}{import}\ parametrize}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00009}00009\ \textcolor{preprocessor}{@with\_numpy}}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00010}00010\ \textcolor{keyword}{def\ }test\_memmap(tmpdir):}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00011}00011\ \ \ \ \ fname\ =\ tmpdir.join(\textcolor{stringliteral}{"{}test.mmap"{}}).strpath}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00012}00012\ \ \ \ \ size\ =\ 5\ *\ mmap.ALLOCATIONGRANULARITY}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00013}00013\ \ \ \ \ offset\ =\ mmap.ALLOCATIONGRANULARITY\ +\ 1}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00014}00014\ \ \ \ \ memmap\_obj\ =\ make\_memmap(fname,\ shape=size,\ mode=\textcolor{stringliteral}{"{}w+"{}},\ offset=offset)}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00015}00015\ \ \ \ \ \textcolor{keyword}{assert}\ memmap\_obj.offset\ ==\ offset}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00018}00018\ \textcolor{preprocessor}{@parametrize("{}dst\_content"{},\ [None,\ "{}dst\ content"{}])}}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00019}00019\ \textcolor{preprocessor}{@parametrize("{}backend"{},\ [None,\ "{}threading"{}])}}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00020}00020\ \textcolor{keyword}{def\ }test\_concurrency\_safe\_rename(tmpdir,\ dst\_content,\ backend):}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00021}00021\ \ \ \ \ src\_paths\ =\ [tmpdir.join(\textcolor{stringliteral}{"{}src\_\%d"{}}\ \%\ i)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(4)]}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{for}\ src\_path\ \textcolor{keywordflow}{in}\ src\_paths:}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ src\_path.write(\textcolor{stringliteral}{"{}src\ content"{}})}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00024}00024\ \ \ \ \ dst\_path\ =\ tmpdir.join(\textcolor{stringliteral}{"{}dst"{}})}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{if}\ dst\_content\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ dst\_path.write(dst\_content)}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00028}00028\ \ \ \ \ \mbox{\hyperlink{classjoblib_1_1parallel_1_1Parallel}{Parallel}}(n\_jobs=4,\ backend=backend)(}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ delayed(concurrency\_safe\_rename)(src\_path.strpath,\ dst\_path.strpath)}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ src\_path\ \textcolor{keywordflow}{in}\ src\_paths}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00031}00031\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00032}00032\ \ \ \ \ \textcolor{keyword}{assert}\ dst\_path.exists()}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{assert}\ dst\_path.read()\ ==\ \textcolor{stringliteral}{"{}src\ content"{}}}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00034}00034\ \ \ \ \ \textcolor{keywordflow}{for}\ src\_path\ \textcolor{keywordflow}{in}\ src\_paths:}
\DoxyCodeLine{\Hypertarget{test__backports_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ src\_path.exists()}

\end{DoxyCode}
