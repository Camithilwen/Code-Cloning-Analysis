\doxysection{test\+\_\+interface.\+py}
\hypertarget{test__interface_8py_source}{}\label{test__interface_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/sparse/linalg/tests/test\_interface.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/sparse/linalg/tests/test\_interface.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Test\ functions\ for\ the\ sparse.linalg.\_interface\ module}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00002}00002\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00004}00004\ \textcolor{keyword}{from}\ functools\ \textcolor{keyword}{import}\ partial}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00005}00005\ \textcolor{keyword}{from}\ itertools\ \textcolor{keyword}{import}\ product}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00006}00006\ \textcolor{keyword}{import}\ operator}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00007}00007\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises,\ warns}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_,\ assert\_equal}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00010}00010\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00011}00011\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1sparse}{scipy.sparse}}\ \textcolor{keyword}{as}\ sparse}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00013}00013\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__interface}{scipy.sparse.linalg.\_interface}}\ \textcolor{keyword}{as}\ interface}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1sparse_1_1__sputils}{scipy.sparse.\_sputils}}\ \textcolor{keyword}{import}\ matrix}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00017}\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator}{00017}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator}{TestLinearOperator}}:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00018}00018\ \ \ \ \ \textcolor{keyword}{def\ }setup\_method(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ =\ np.array([[1,2,3],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,5,6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ad1464ec2b5d18cc410bc2daabb0e5130}{B}}\ =\ np.array([[1,2],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,4],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_a411aaa15c6a56a9803330c958fed4c51}{C}}\ =\ np.array([[1,2],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,4]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{def\ }test\_matvec(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }get\_matvecs(A):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [\{}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'shape'}:\ A.shape,}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'matvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A,\ x).reshape(A.shape[0]),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'rmatvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A.T.conj(),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x).reshape(A.shape[1])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'shape'}:\ A.shape,}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'matvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A,\ x),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'rmatvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A.T.conj(),\ x),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'rmatmat'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A.T.conj(),\ x),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'matmat'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(A,\ x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ matvecs\ \textcolor{keywordflow}{in}\ get\_matvecs(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ interface.LinearOperator(**matvecs)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(A.args\ ==\ ())}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.matvec(np.array([1,2,3])),\ [14,32])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.matvec(np.array([[1],[2],[3]])),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ *\ np.array([1,2,3]),\ [14,32])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ *\ np.array([[1],[2],[3]]),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(np.array([1,2,3])),\ [14,32])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(np.array([[1],[2],[3]])),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.matvec(matrix([[1],[2],[3]])),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ *\ matrix([[1],[2],[3]]),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(matrix([[1],[2],[3]])),\ [[14],[32]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2*A)*[1,1,1],\ [12,30])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2\ *\ A).rmatvec([1,\ 1]),\ [10,\ 14,\ 18])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2*A).H.matvec([1,1]),\ [10,\ 14,\ 18])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2*A)*[[1],[1],[1]],\ [[12],[30]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2\ *\ A).matmat([[1],\ [1],\ [1]]),\ [[12],\ [30]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A*2)*[1,1,1],\ [12,30])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A*2)*[[1],[1],[1]],\ [[12],[30]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2j*A)*[1,1,1],\ [12j,30j])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A+A)*[1,1,1],\ [12,\ 30])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ +\ A).rmatvec([1,\ 1]),\ [10,\ 14,\ 18])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A+A).H.matvec([1,1]),\ [10,\ 14,\ 18])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A+A)*[[1],[1],[1]],\ [[12],\ [30]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A+A).matmat([[1],[1],[1]]),\ [[12],\ [30]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((-\/A)*[1,1,1],\ [-\/6,-\/15])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((-\/A)*[[1],[1],[1]],\ [[-\/6],[-\/15]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A-\/A)*[1,1,1],\ [0,0])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ -\/\ A)\ *\ [[1],\ [1],\ [1]],\ [[0],\ [0]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ X\ =\ np.array([[1,\ 2],\ [3,\ 4]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\_asarray\ =\ np.array([[1,\ 2,\ 3],\ [4,\ 5,\ 6]])}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2\ *\ A).rmatmat(X),\ np.dot((2\ *\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ *\ 2).rmatmat(X),\ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ *\ 2).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2j\ *\ A).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((2j\ *\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T.conj(),\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ *\ 2j).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ *\ 2j).T.conj(),\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ +\ A).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ +\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ +\ 2j\ *\ A).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ +\ 2j\ *\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T.conj(),\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((-\/A).rmatmat(X),\ np.dot((-\/self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ -\/\ A).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}\ -\/\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2j\ *\ A).rmatmat(2j\ *\ X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((2j\ *\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}).T.conj(),\ 2j\ *\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ A+A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(len(z.args)\ ==\ 2\ \textcolor{keywordflow}{and}\ z.args[0]\ \textcolor{keywordflow}{is}\ A\ \textcolor{keywordflow}{and}\ z.args[1]\ \textcolor{keywordflow}{is}\ A)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ 2*A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(len(z.args)\ ==\ 2\ \textcolor{keywordflow}{and}\ z.args[0]\ \textcolor{keywordflow}{is}\ A\ \textcolor{keywordflow}{and}\ z.args[1]\ ==\ 2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.matvec([1,\ 2,\ 3]),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.matvec(np.array([[1],[2],[3]])),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A\ *\ np.array([1,2,3]),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A\ *\ np.array([[1],[2],[3]]),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.dot(np.array([1,2,3])),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.dot(np.array([[1],[2],[3]])),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.matvec(matrix([[1],[2],[3]])),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A\ *\ matrix([[1],[2],[3]]),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A.dot(matrix([[1],[2],[3]])),\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(2*A,\ interface.\_ScaledLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(2j*A,\ interface.\_ScaledLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A+A,\ interface.\_SumLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(-\/A,\ interface.\_ScaledLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A-\/A,\ interface.\_SumLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A/2,\ interface.\_ScaledLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A/2j,\ interface.\_ScaledLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(((A\ *\ 3)\ /\ 3).args[0]\ \textcolor{keywordflow}{is}\ A)\ \ \textcolor{comment}{\#\ check\ for\ simplification}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ prefactor\ is\ of\ \_ScaledLinearOperator\ is\ not\ mutated}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ when\ the\ operator\ is\ multiplied\ by\ a\ number}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ A\ @\ np.array([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ B\ =\ A\ *\ 3}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ C\ =\ A\ /\ 5}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ @\ np.array([1,\ 2,\ 3]),\ result)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_((2j*A).dtype\ ==\ np.complex\_)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ division\ by\ non-\/scalar}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Can\ only\ divide\ a\ linear\ operator\ by\ a\ scalar."{}}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A\ /\ np.array([1,\ 2])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ A.matvec,\ np.array([1,2]))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ A.matvec,\ np.array([1,2,3,4]))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ A.matvec,\ np.array([[1],[2]]))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ A.matvec,\ np.array([[1],[2],[3],[4]]))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ \textcolor{keyword}{lambda}:\ A*A)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ \textcolor{keyword}{lambda}:\ A**2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ matvecsA,\ matvecsB\ \textcolor{keywordflow}{in}\ product(get\_matvecs(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_matvecs(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ad1464ec2b5d18cc410bc2daabb0e5130}{B}})):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ interface.LinearOperator(**matvecsA)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ B\ =\ interface.LinearOperator(**matvecsB)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ AtimesB\ =\ np.array([[22,\ 28],\ [49,\ 64]])}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ AtimesB\ =\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ad1464ec2b5d18cc410bc2daabb0e5130}{B}})}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ X\ =\ np.array([[1,\ 2],\ [3,\ 4]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ *\ B).rmatmat(X),\ np.dot((AtimesB).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((2j\ *\ A\ *\ B).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((2j\ *\ AtimesB).T.conj(),\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A*B)*[1,1],\ [50,113])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A*B)*[[1],[1]],\ [[50],[113]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A*B).matmat([[1],[1]]),\ [[50],[113]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ *\ B).rmatvec([1,\ 1]),\ [71,\ 92])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((A\ *\ B).H.matvec([1,\ 1]),\ [71,\ 92])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(A*B,\ interface.\_ProductLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ \textcolor{keyword}{lambda}:\ A+B)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ \textcolor{keyword}{lambda}:\ A**2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ A*B}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(len(z.args)\ ==\ 2\ \textcolor{keywordflow}{and}\ z.args[0]\ \textcolor{keywordflow}{is}\ A\ \textcolor{keywordflow}{and}\ z.args[1]\ \textcolor{keywordflow}{is}\ B)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ matvecsC\ \textcolor{keywordflow}{in}\ get\_matvecs(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_a411aaa15c6a56a9803330c958fed4c51}{C}}):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ C\ =\ interface.LinearOperator(**matvecsC)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ X\ =\ np.array([[1,\ 2],\ [3,\ 4]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(C.rmatmat(X),\ np.dot((self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_a411aaa15c6a56a9803330c958fed4c51}{C}}).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((C**2).rmatmat(X),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.dot((np.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_a411aaa15c6a56a9803330c958fed4c51}{C}},\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_a411aaa15c6a56a9803330c958fed4c51}{C}})).T,\ X))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((C**2)*[1,1],\ [17,37])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((C**2).rmatvec([1,\ 1]),\ [22,\ 32])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((C**2).H.matvec([1,\ 1]),\ [22,\ 32])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal((C**2).matmat([[1],[1]]),\ [[17],[37]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(isinstance(C**2,\ interface.\_PowerLinearOperator))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00184}00184\ \ \ \ \ \textcolor{keyword}{def\ }test\_matmul(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ D\ =\ \{\textcolor{stringliteral}{'shape'}:\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.shape,}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'matvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}},\ x).reshape(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.shape[0]),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'rmatvec'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.T.conj(),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x).reshape(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.shape[1]),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'rmatmat'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}}.T.conj(),\ x),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'matmat'}:\ \textcolor{keyword}{lambda}\ x:\ np.dot(self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestLinearOperator_ada3c38d6009e8509c7e2d0402c56c06d}{A}},\ x)\}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ A\ =\ interface.LinearOperator(**D)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ B\ =\ np.array([[1\ +\ 1j,\ 2,\ 3],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 5,\ 6],}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [7,\ 8,\ 9]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ b\ =\ B[0]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(A,\ b),\ A\ *\ b)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(A,\ b.reshape(-\/1,\ 1)),\ A\ *\ b.reshape(-\/1,\ 1))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(A,\ B),\ A\ *\ B)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(b,\ A.H),\ b\ *\ A.H)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(b.reshape(1,\ -\/1),\ A.H),\ b.reshape(1,\ -\/1)\ *\ A.H)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ assert\_equal(operator.matmul(B,\ A.H),\ B\ *\ A.H)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ operator.matmul,\ A,\ 2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ operator.matmul,\ 2,\ A)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00207}\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator}{00207}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator}{TestAsLinearOperator}}:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00208}00208\ \ \ \ \ \textcolor{keyword}{def\ }setup\_method(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ =\ []}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }make\_cases(original,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ cases\ =\ []}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((matrix(original,\ dtype=dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((np.array(original,\ dtype=dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((\mbox{\hyperlink{classscipy_1_1sparse_1_1__csr_1_1csr__matrix}{sparse.csr\_matrix}}(original,\ dtype=dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ default\ implementations\ of\ \_adjoint\ and\ \_rmatvec,\ which}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ refer\ to\ each\ other.}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }mv(x,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ original.dot(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(x.shape)\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ y.reshape(-\/1,\ 1)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ y}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }rmv(x,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ original.T.conj().dot(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }BaseMatlike(interface.LinearOperator):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args\ =\ ()}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ dtype):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}}\ =\ np.dtype(dtype)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a0440cef7644958410dc10029a8999dff}{shape}}\ =\ original.shape}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00235}00235\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_matvec(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mv(x,\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}})}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00238}00238\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }HasRmatvec(BaseMatlike):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args\ =\ ()}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_rmatvec(self,x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ rmv(x,\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}})}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }HasAdjoint(BaseMatlike):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args\ =\ ()}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_adjoint(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shape\ =\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a0440cef7644958410dc10029a8999dff}{shape}}[1],\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a0440cef7644958410dc10029a8999dff}{shape}}[0]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ matvec\ =\ partial(rmv,\ dtype=self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}})}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rmatvec\ =\ partial(mv,\ dtype=self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}})}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ interface.LinearOperator(matvec=matvec,}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rmatvec=rmatvec,}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a378bb501a2d0da2bca300b40e5095f36}{dtype}},}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shape=shape)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }HasRmatmat(HasRmatvec):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_matmat(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ original.dot(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_rmatmat(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ original.T.conj().dot(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00263}00263\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((HasRmatvec(dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((HasAdjoint(dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ cases.append((HasRmatmat(dtype),\ original))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cases}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ original\ =\ np.array([[1,2,3],\ [4,5,6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ make\_cases(original,\ np.int32)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ make\_cases(original,\ np.float32)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ make\_cases(original,\ np.float64)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ [(interface.aslinearoperator(M).T,\ A.T)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\ \textcolor{keywordflow}{in}\ make\_cases(original.T,\ np.float64)]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ [(interface.aslinearoperator(M).H,\ A.T.conj())}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\ \textcolor{keywordflow}{in}\ make\_cases(original.T,\ np.float64)]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ original\ =\ np.array([[1,\ 2j,\ 3j],\ [4j,\ 5j,\ 6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ make\_cases(original,\ np.complex\_)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ [(interface.aslinearoperator(M).T,\ A.T)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\ \textcolor{keywordflow}{in}\ make\_cases(original.T,\ np.complex\_)]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}\ +=\ [(interface.aslinearoperator(M).H,\ A.T.conj())}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\ \textcolor{keywordflow}{in}\ make\_cases(original.T,\ np.complex\_)]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00284}00284\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00285}00285\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\_array\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ interface.aslinearoperator(M)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ M,N\ =\ A.shape}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ xs\ =\ [np.array([1,\ 2,\ 3]),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([[1],\ [2],\ [3]])]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ ys\ =\ [np.array([1,\ 2]),\ np.array([[1],\ [2]])]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ A.dtype\ ==\ np.complex\_:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xs\ +=\ [np.array([1,\ 2j,\ 3j]),}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([[1],\ [2j],\ [3j]])]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ys\ +=\ [np.array([1,\ 2j]),\ np.array([[1],\ [2j]])]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00299}00299\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ \ \ \ \ x2\ =\ np.array([[1,\ 4],\ [2,\ 5],\ [3,\ 6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ xs:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.matvec(x),\ A\_array.dot(x))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ *\ x,\ A\_array.dot(x))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.matmat(x2),\ A\_array.dot(x2))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A\ *\ x2,\ A\_array.dot(x2))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ y\ \textcolor{keywordflow}{in}\ ys:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.rmatvec(y),\ A\_array.T.conj().dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.T.matvec(y),\ A\_array.T.dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.H.matvec(y),\ A\_array.T.conj().dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ y\ \textcolor{keywordflow}{in}\ ys:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y.ndim\ <\ 2:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.rmatmat(y),\ A\_array.T.conj().dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.T.matmat(y),\ A\_array.T.dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.H.matmat(y),\ A\_array.T.conj().dot(y))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00320}00320\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(M,\textcolor{stringliteral}{'dtype'}):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00322}00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dtype,\ M.dtype)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00323}00323\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(hasattr(A,\ \textcolor{stringliteral}{'args'}))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00326}00326\ \ \ \ \ \textcolor{keyword}{def\ }test\_dot(self):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ M,\ A\_array\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_1_1TestAsLinearOperator_a83a6fd635deb9a8d728862f4800b34a8}{cases}}:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ interface.aslinearoperator(M)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ M,N\ =\ A.shape}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ x0\ =\ np.array([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ np.array([[1],\ [2],\ [3]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ x2\ =\ np.array([[1,\ 4],\ [2,\ 5],\ [3,\ 6]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(x0),\ A\_array.dot(x0))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(x1),\ A\_array.dot(x1))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(A.dot(x2),\ A\_array.dot(x2))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00341}00341\ \textcolor{keyword}{def\ }test\_repr():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00342}00342\ \ \ \ \ A\ =\ interface.LinearOperator(shape=(1,\ 1),\ matvec=\textcolor{keyword}{lambda}\ x:\ 1)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00343}00343\ \ \ \ \ repr\_A\ =\ repr(A)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00344}00344\ \ \ \ \ assert\_(\textcolor{stringliteral}{'unspecified\ dtype'}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ repr\_A,\ repr\_A)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00345}00345\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00346}00346\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00347}00347\ \textcolor{keyword}{def\ }test\_identity():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00348}00348\ \ \ \ \ ident\ =\ interface.IdentityOperator((3,\ 3))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00349}00349\ \ \ \ \ assert\_equal(ident\ *\ [1,\ 2,\ 3],\ [1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00350}00350\ \ \ \ \ assert\_equal(ident.dot(np.arange(9).reshape(3,\ 3)).ravel(),\ np.arange(9))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00351}00351\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00352}00352\ \ \ \ \ assert\_raises(ValueError,\ ident.matvec,\ [1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00353}00353\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00354}00354\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00355}00355\ \textcolor{keyword}{def\ }test\_attributes():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00356}00356\ \ \ \ \ A\ =\ interface.aslinearoperator(np.arange(16).reshape(4,\ 4))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00358}00358\ \ \ \ \ \textcolor{keyword}{def\ }always\_four\_ones(x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00359}00359\ \ \ \ \ \ \ \ \ x\ =\ np.asarray(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ assert\_(x.shape\ ==\ (3,)\ \textcolor{keywordflow}{or}\ x.shape\ ==\ (3,\ 1))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.ones(4)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00362}00362\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00363}00363\ \ \ \ \ B\ =\ interface.LinearOperator(shape=(4,\ 3),\ matvec=always\_four\_ones)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00364}00364\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00365}00365\ \ \ \ \ \textcolor{keywordflow}{for}\ op\ \textcolor{keywordflow}{in}\ [A,\ B,\ A\ *\ B,\ A.H,\ A\ +\ A,\ B\ +\ B,\ A**4]:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ assert\_(hasattr(op,\ \textcolor{stringliteral}{"{}dtype"{}}))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ assert\_(hasattr(op,\ \textcolor{stringliteral}{"{}shape"{}}))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ assert\_(hasattr(op,\ \textcolor{stringliteral}{"{}\_matvec"{}}))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00369}00369\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00370}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_a27c5336dc44d97d3e682ea3b951cc9e6}{00370}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_a27c5336dc44d97d3e682ea3b951cc9e6}{matvec}}(x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00371}00371\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Needed\ for\ test\_pickle\ as\ local\ functions\ are\ not\ pickleable\ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00372}00372\ \ \ \ \ \textcolor{keywordflow}{return}\ np.zeros(3)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00373}00373\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00374}00374\ \textcolor{keyword}{def\ }test\_pickle():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00375}00375\ \ \ \ \ \textcolor{keyword}{import}\ pickle}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00376}00376\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00377}00377\ \ \ \ \ \textcolor{keywordflow}{for}\ protocol\ \textcolor{keywordflow}{in}\ range(pickle.HIGHEST\_PROTOCOL\ +\ 1):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00378}00378\ \ \ \ \ \ \ \ \ A\ =\ interface.LinearOperator((3,\ 3),\ matvec)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00379}00379\ \ \ \ \ \ \ \ \ s\ =\ pickle.dumps(A,\ protocol=protocol)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00380}00380\ \ \ \ \ \ \ \ \ B\ =\ pickle.loads(s)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00381}00381\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00382}00382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ A.\_\_dict\_\_:}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(getattr(A,\ k),\ getattr(B,\ k))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00385}00385\ \textcolor{keyword}{def\ }test\_inheritance():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00386}00386\ \ \ \ \ \textcolor{keyword}{class\ }Empty(interface.LinearOperator):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00387}00387\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00389}00389\ \ \ \ \ \textcolor{keyword}{with}\ warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}should\ implement\ at\ least"{}}):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00390}00390\ \ \ \ \ \ \ \ \ assert\_raises(TypeError,\ Empty)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00391}00391\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00392}00392\ \ \ \ \ \textcolor{keyword}{class\ }Identity(interface.LinearOperator):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00393}00393\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ n):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ super().\_\_init\_\_(dtype=\textcolor{keywordtype}{None},\ shape=(n,\ n))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00395}00395\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_matvec(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00399}00399\ \ \ \ \ id3\ =\ Identity(3)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00400}00400\ \ \ \ \ assert\_equal(id3.matvec([1,\ 2,\ 3]),\ [1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00401}00401\ \ \ \ \ assert\_raises(NotImplementedError,\ id3.rmatvec,\ [4,\ 5,\ 6])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00402}00402\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00403}00403\ \ \ \ \ \textcolor{keyword}{class\ }MatmatOnly(interface.LinearOperator):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ A):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ super().\_\_init\_\_(A.dtype,\ A.shape)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ \ \ \ \ self.A\ =\ A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00407}00407\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_matmat(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.A.dot(x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00410}00410\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00411}00411\ \ \ \ \ mm\ =\ MatmatOnly(np.random.randn(5,\ 3))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00412}00412\ \ \ \ \ assert\_equal(mm.matvec(np.random.randn(3)).shape,\ (5,))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00413}00413\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00414}00414\ \textcolor{keyword}{def\ }test\_dtypes\_of\_operator\_sum():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00415}00415\ \ \ \ \ \textcolor{comment}{\#\ gh-\/6078}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00417}00417\ \ \ \ \ mat\_complex\ =\ np.random.rand(2,2)\ +\ 1j\ *\ np.random.rand(2,2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00418}00418\ \ \ \ \ mat\_real\ =\ np.random.rand(2,2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00419}00419\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00420}00420\ \ \ \ \ complex\_operator\ =\ interface.aslinearoperator(mat\_complex)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00421}00421\ \ \ \ \ real\_operator\ =\ interface.aslinearoperator(mat\_real)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00422}00422\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00423}00423\ \ \ \ \ sum\_complex\ =\ complex\_operator\ +\ complex\_operator}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00424}00424\ \ \ \ \ sum\_real\ =\ real\_operator\ +\ real\_operator}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00425}00425\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00426}00426\ \ \ \ \ assert\_equal(sum\_real.dtype,\ np.float64)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00427}00427\ \ \ \ \ assert\_equal(sum\_complex.dtype,\ np.complex128)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00428}00428\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00429}00429\ \textcolor{keyword}{def\ }test\_no\_double\_init():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00430}00430\ \ \ \ \ call\_count\ =\ [0]}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00431}00431\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00432}00432\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1tests_1_1test__interface_a27c5336dc44d97d3e682ea3b951cc9e6}{matvec}}(v):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ call\_count[0]\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ v}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00435}00435\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00436}00436\ \ \ \ \ \textcolor{comment}{\#\ It\ should\ call\ matvec\ exactly\ once\ (in\ order\ to\ determine\ the}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00437}00437\ \ \ \ \ \textcolor{comment}{\#\ operator\ dtype)}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00438}00438\ \ \ \ \ interface.LinearOperator((2,\ 2),\ matvec=matvec)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00439}00439\ \ \ \ \ assert\_equal(call\_count[0],\ 1)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00440}00440\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00441}00441\ \textcolor{keyword}{def\ }test\_adjoint\_conjugate():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00442}00442\ \ \ \ \ X\ =\ np.array([[1j]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00443}00443\ \ \ \ \ A\ =\ interface.aslinearoperator(X)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00445}00445\ \ \ \ \ B\ =\ 1j\ *\ A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00446}00446\ \ \ \ \ Y\ =\ 1j\ *\ X}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00448}00448\ \ \ \ \ v\ =\ np.array([1])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00449}00449\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00450}00450\ \ \ \ \ assert\_equal(B.dot(v),\ Y.dot(v))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00451}00451\ \ \ \ \ assert\_equal(B.H.dot(v),\ Y.T.conj().dot(v))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00452}00452\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00453}00453\ \textcolor{keyword}{def\ }test\_ndim():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00454}00454\ \ \ \ \ X\ =\ np.array([[1]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00455}00455\ \ \ \ \ A\ =\ interface.aslinearoperator(X)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00456}00456\ \ \ \ \ assert\_equal(A.ndim,\ 2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00458}00458\ \textcolor{keyword}{def\ }test\_transpose\_noconjugate():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00459}00459\ \ \ \ \ X\ =\ np.array([[1j]])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00460}00460\ \ \ \ \ A\ =\ interface.aslinearoperator(X)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00461}00461\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00462}00462\ \ \ \ \ B\ =\ 1j\ *\ A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00463}00463\ \ \ \ \ Y\ =\ 1j\ *\ X}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00464}00464\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00465}00465\ \ \ \ \ v\ =\ np.array([1])}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00466}00466\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00467}00467\ \ \ \ \ assert\_equal(B.dot(v),\ Y.dot(v))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00468}00468\ \ \ \ \ assert\_equal(B.T.dot(v),\ Y.T.dot(v))}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00469}00469\ }
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00470}00470\ \textcolor{keyword}{def\ }test\_sparse\_matmat\_exception():}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00471}00471\ \ \ \ \ A\ =\ interface.LinearOperator((2,\ 2),\ matvec=\textcolor{keyword}{lambda}\ x:\ x)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00472}00472\ \ \ \ \ B\ =\ sparse.identity(2)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00473}00473\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Unable\ to\ multiply\ a\ LinearOperator\ with\ a\ sparse\ matrix."{}}}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00474}00474\ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(TypeError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ A\ @\ B}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00476}00476\ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(TypeError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ B\ @\ A}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00478}00478\ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ A\ @\ np.identity(4)}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00480}00480\ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError):}
\DoxyCodeLine{\Hypertarget{test__interface_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ np.identity(4)\ @\ A}

\end{DoxyCode}
