\doxysection{test\+\_\+mio5\+\_\+utils.\+py}
\hypertarget{test__mio5__utils_8py_source}{}\label{test__mio5__utils_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/io/matlab/tests/test\_mio5\_utils.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/io/matlab/tests/test\_mio5\_utils.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}\ Testing\ mio5\_utils\ Cython\ module}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00002}00002\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00004}00004\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00006}00006\ \textcolor{keyword}{from}\ io\ \textcolor{keyword}{import}\ BytesIO}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00008}00008\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_array\_equal,\ assert\_equal,\ assert\_}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00011}00011\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00013}00013\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1__byteordercodes}{scipy.io.matlab.\_byteordercodes}}\ \textcolor{keyword}{as}\ boc}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00014}00014\ \textcolor{keyword}{import}\ scipy.io.matlab.\_streams\ \textcolor{keyword}{as}\ streams}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00015}00015\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1__mio5__params}{scipy.io.matlab.\_mio5\_params}}\ \textcolor{keyword}{as}\ mio5p}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00016}00016\ \textcolor{keyword}{import}\ scipy.io.matlab.\_mio5\_utils\ \textcolor{keyword}{as}\ m5u}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00019}00019\ \textcolor{keyword}{def\ }test\_byteswap():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00020}00020\ \ \ \ \ \textcolor{keywordflow}{for}\ val\ \textcolor{keywordflow}{in}\ (}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ 0x100,}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ 0x10000):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ a\ =\ np.array(val,\ dtype=np.uint32)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ b\ =\ a.byteswap()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ c\ =\ m5u.byteswap\_u4(a)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ assert\_equal(b.item(),\ c)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ d\ =\ m5u.byteswap\_u4(c)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ assert\_equal(a.item(),\ d)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00032}\mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{00032}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{\_make\_tag}}(base\_dt,\ val,\ mdtype,\ sde=False):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00033}00033\ \ \ \ \ \textcolor{stringliteral}{'''\ Makes\ a\ simple\ matlab\ tag,\ full\ or\ sde\ '''}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00034}00034\ \ \ \ \ base\_dt\ =\ np.dtype(base\_dt)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00035}00035\ \ \ \ \ bo\ =\ boc.to\_numpy\_code(base\_dt.byteorder)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00036}00036\ \ \ \ \ byte\_count\ =\ base\_dt.itemsize}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00037}00037\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ sde:}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ udt\ =\ bo\ +\ \textcolor{stringliteral}{'u4'}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ padding\ =\ 8\ -\/\ (byte\_count\ \%\ 8)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ all\_dt\ =\ [(\textcolor{stringliteral}{'mdtype'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'byte\_count'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'val'},\ base\_dt)]}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ padding:}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ all\_dt.append((\textcolor{stringliteral}{'padding'},\ \textcolor{stringliteral}{'u1'},\ padding))}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00045}00045\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ is\ sde}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ udt\ =\ bo\ +\ \textcolor{stringliteral}{'u2'}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ padding\ =\ 4-\/byte\_count}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bo\ ==\ \textcolor{stringliteral}{'<'}:\ \ \textcolor{comment}{\#\ little\ endian}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ all\_dt\ =\ [(\textcolor{stringliteral}{'mdtype'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'byte\_count'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'val'},\ base\_dt)]}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ big\ endian}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ all\_dt\ =\ [(\textcolor{stringliteral}{'byte\_count'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'mdtype'},\ udt),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'val'},\ base\_dt)]}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ padding:}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ all\_dt.append((\textcolor{stringliteral}{'padding'},\ \textcolor{stringliteral}{'u1'},\ padding))}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00058}00058\ \ \ \ \ tag\ =\ np.zeros((1,),\ dtype=all\_dt)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00059}00059\ \ \ \ \ tag[\textcolor{stringliteral}{'mdtype'}]\ =\ mdtype}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00060}00060\ \ \ \ \ tag[\textcolor{stringliteral}{'byte\_count'}]\ =\ byte\_count}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00061}00061\ \ \ \ \ tag[\textcolor{stringliteral}{'val'}]\ =\ val}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00062}00062\ \ \ \ \ \textcolor{keywordflow}{return}\ tag}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00065}00065\ \textcolor{keyword}{def\ }\_write\_stream(stream,\ *strings):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00066}00066\ \ \ \ \ stream.truncate(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00067}00067\ \ \ \ \ stream.seek(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ strings:}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ stream.write(s)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00070}00070\ \ \ \ \ stream.seek(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00073}00073\ \textcolor{keyword}{def\ }\_make\_readerlike(stream,\ byte\_order=boc.native\_code):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00074}00074\ \ \ \ \ \textcolor{keyword}{class\ }R:}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00076}00076\ \ \ \ \ r\ =\ R()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00077}00077\ \ \ \ \ r.mat\_stream\ =\ stream}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00078}00078\ \ \ \ \ r.byte\_order\ =\ byte\_order}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00079}00079\ \ \ \ \ r.struct\_as\_record\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00080}00080\ \ \ \ \ r.uint16\_codec\ =\ sys.getdefaultencoding()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00081}00081\ \ \ \ \ r.chars\_as\_strings\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00082}00082\ \ \ \ \ r.mat\_dtype\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00083}00083\ \ \ \ \ r.squeeze\_me\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00084}00084\ \ \ \ \ \textcolor{keywordflow}{return}\ r}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00087}00087\ \textcolor{keyword}{def\ }test\_read\_tag():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00088}00088\ \ \ \ \ \textcolor{comment}{\#\ mainly\ to\ test\ errors}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00089}00089\ \ \ \ \ \textcolor{comment}{\#\ make\ reader-\/like\ thing}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00090}00090\ \ \ \ \ str\_io\ =\ \mbox{\hyperlink{classBytesIO}{BytesIO}}()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00091}00091\ \ \ \ \ r\ =\ \_make\_readerlike(str\_io)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00092}00092\ \ \ \ \ c\_reader\ =\ m5u.VarReader5(r)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00093}00093\ \ \ \ \ \textcolor{comment}{\#\ This\ works\ for\ StringIO\ but\ \_not\_\ BytesIO}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00094}00094\ \ \ \ \ assert\_raises(OSError,\ c\_reader.read\_tag)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00095}00095\ \ \ \ \ \textcolor{comment}{\#\ bad\ SDE}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00096}00096\ \ \ \ \ tag\ =\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{\_make\_tag}}(\textcolor{stringliteral}{'i4'},\ 1,\ mio5p.miINT32,\ sde=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00097}00097\ \ \ \ \ tag[\textcolor{stringliteral}{'byte\_count'}]\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00098}00098\ \ \ \ \ \_write\_stream(str\_io,\ tag.tobytes())}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00099}00099\ \ \ \ \ assert\_raises(ValueError,\ c\_reader.read\_tag)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00102}00102\ \textcolor{keyword}{def\ }test\_read\_stream():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00103}00103\ \ \ \ \ tag\ =\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{\_make\_tag}}(\textcolor{stringliteral}{'i4'},\ 1,\ mio5p.miINT32,\ sde=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00104}00104\ \ \ \ \ tag\_str\ =\ tag.tobytes()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00105}00105\ \ \ \ \ str\_io\ =\ \mbox{\hyperlink{classBytesIO}{BytesIO}}(tag\_str)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00106}00106\ \ \ \ \ st\ =\ streams.make\_stream(str\_io)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00107}00107\ \ \ \ \ s\ =\ streams.\_read\_into(st,\ tag.itemsize)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00108}00108\ \ \ \ \ assert\_equal(s,\ tag.tobytes())}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00111}00111\ \textcolor{keyword}{def\ }test\_read\_numeric():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00112}00112\ \ \ \ \ \textcolor{comment}{\#\ make\ reader-\/like\ thing}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00113}00113\ \ \ \ \ str\_io\ =\ \mbox{\hyperlink{classBytesIO}{BytesIO}}()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00114}00114\ \ \ \ \ r\ =\ \_make\_readerlike(str\_io)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00115}00115\ \ \ \ \ \textcolor{comment}{\#\ check\ simplest\ of\ tags}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00116}00116\ \ \ \ \ \textcolor{keywordflow}{for}\ base\_dt,\ val,\ mdtype\ \textcolor{keywordflow}{in}\ ((\textcolor{stringliteral}{'u2'},\ 30,\ mio5p.miUINT16),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'i4'},\ 1,\ mio5p.miINT32),}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'i2'},\ -\/1,\ mio5p.miINT16)):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ byte\_code\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'<'},\ \textcolor{stringliteral}{'>'}):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ r.byte\_order\ =\ byte\_code}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ c\_reader\ =\ m5u.VarReader5(r)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(c\_reader.little\_endian,\ byte\_code\ ==\ \textcolor{stringliteral}{'<'})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(c\_reader.is\_swapped,\ byte\_code\ !=\ boc.native\_code)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sde\_f\ \textcolor{keywordflow}{in}\ (\textcolor{keyword}{False},\ \textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dt\ =\ np.dtype(base\_dt).newbyteorder(byte\_code)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{\_make\_tag}}(dt,\ val,\ mdtype,\ sde\_f)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_str\ =\ a.tobytes()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_write\_stream(str\_io,\ a\_str)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ el\ =\ c\_reader.read\_numeric()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(el,\ val)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ two\ sequential\ reads}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_write\_stream(str\_io,\ a\_str,\ a\_str)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ el\ =\ c\_reader.read\_numeric()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(el,\ val)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ el\ =\ c\_reader.read\_numeric()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(el,\ val)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00139}00139\ \textcolor{keyword}{def\ }test\_read\_numeric\_writeable():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00140}00140\ \ \ \ \ \textcolor{comment}{\#\ make\ reader-\/like\ thing}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00141}00141\ \ \ \ \ str\_io\ =\ \mbox{\hyperlink{classBytesIO}{BytesIO}}()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00142}00142\ \ \ \ \ r\ =\ \_make\_readerlike(str\_io,\ \textcolor{stringliteral}{'<'})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00143}00143\ \ \ \ \ c\_reader\ =\ m5u.VarReader5(r)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00144}00144\ \ \ \ \ dt\ =\ np.dtype(\textcolor{stringliteral}{'<u2'})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00145}00145\ \ \ \ \ a\ =\ \mbox{\hyperlink{namespacescipy_1_1io_1_1matlab_1_1tests_1_1test__mio5__utils_ac588878741a341602f3239f11221d3f5}{\_make\_tag}}(dt,\ 30,\ mio5p.miUINT16,\ 0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00146}00146\ \ \ \ \ a\_str\ =\ a.tobytes()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00147}00147\ \ \ \ \ \_write\_stream(str\_io,\ a\_str)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00148}00148\ \ \ \ \ el\ =\ c\_reader.read\_numeric()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00149}00149\ \ \ \ \ assert\_(el.flags.writeable\ \textcolor{keywordflow}{is}\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00152}00152\ \textcolor{keyword}{def\ }test\_zero\_byte\_string():}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00153}00153\ \ \ \ \ \textcolor{comment}{\#\ Tests\ hack\ to\ allow\ chars\ of\ non-\/zero\ length,\ but\ 0\ bytes}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00154}00154\ \ \ \ \ \textcolor{comment}{\#\ make\ reader-\/like\ thing}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00155}00155\ \ \ \ \ str\_io\ =\ \mbox{\hyperlink{classBytesIO}{BytesIO}}()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00156}00156\ \ \ \ \ r\ =\ \_make\_readerlike(str\_io,\ boc.native\_code)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00157}00157\ \ \ \ \ c\_reader\ =\ m5u.VarReader5(r)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00158}00158\ \ \ \ \ tag\_dt\ =\ np.dtype([(\textcolor{stringliteral}{'mdtype'},\ \textcolor{stringliteral}{'u4'}),\ (\textcolor{stringliteral}{'byte\_count'},\ \textcolor{stringliteral}{'u4'})])}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00159}00159\ \ \ \ \ tag\ =\ np.zeros((1,),\ dtype=tag\_dt)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00160}00160\ \ \ \ \ tag[\textcolor{stringliteral}{'mdtype'}]\ =\ mio5p.miINT8}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00161}00161\ \ \ \ \ tag[\textcolor{stringliteral}{'byte\_count'}]\ =\ 1}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00162}00162\ \ \ \ \ hdr\ =\ m5u.VarHeader5()}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00163}00163\ \ \ \ \ \textcolor{comment}{\#\ Try\ when\ string\ is\ 1\ length}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00164}00164\ \ \ \ \ hdr.set\_dims([1,])}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00165}00165\ \ \ \ \ \_write\_stream(str\_io,\ tag.tobytes()\ +\ b\textcolor{stringliteral}{'\ \ \ \ \ \ \ \ '})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00166}00166\ \ \ \ \ str\_io.seek(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00167}00167\ \ \ \ \ val\ =\ c\_reader.read\_char(hdr)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00168}00168\ \ \ \ \ assert\_equal(val,\ \textcolor{stringliteral}{'\ '})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00169}00169\ \ \ \ \ \textcolor{comment}{\#\ Now\ when\ string\ has\ 0\ bytes\ 1\ length}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00170}00170\ \ \ \ \ tag[\textcolor{stringliteral}{'byte\_count'}]\ =\ 0}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00171}00171\ \ \ \ \ \_write\_stream(str\_io,\ tag.tobytes())}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00172}00172\ \ \ \ \ str\_io.seek(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00173}00173\ \ \ \ \ val\ =\ c\_reader.read\_char(hdr)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00174}00174\ \ \ \ \ assert\_equal(val,\ \textcolor{stringliteral}{'\ '})}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00175}00175\ \ \ \ \ \textcolor{comment}{\#\ Now\ when\ string\ has\ 0\ bytes\ 4\ length}}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00176}00176\ \ \ \ \ str\_io.seek(0)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00177}00177\ \ \ \ \ hdr.set\_dims([4,])}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00178}00178\ \ \ \ \ val\ =\ c\_reader.read\_char(hdr)}
\DoxyCodeLine{\Hypertarget{test__mio5__utils_8py_source_l00179}00179\ \ \ \ \ assert\_array\_equal(val,\ [\textcolor{stringliteral}{'\ '}]\ *\ 4)}

\end{DoxyCode}
