\doxysection{\+\_\+decomp\+\_\+cossin.\+py}
\hypertarget{__decomp__cossin_8py_source}{}\label{__decomp__cossin_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/\_decomp\_cossin.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/\_decomp\_cossin.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__cossin}{00001}}\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Iterable}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00002}00002\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1__lib_1_1__util}{scipy.\_lib.\_util}}\ \textcolor{keyword}{import}\ \_asarray\_validated}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1linalg}{scipy.linalg}}\ \textcolor{keyword}{import}\ block\_diag,\ LinAlgError}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00006}00006\ \textcolor{keyword}{from}\ .lapack\ \textcolor{keyword}{import}\ \_compute\_lwork,\ get\_lapack\_funcs}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00008}00008\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'cossin'}]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00011}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__cossin_a7902d9a76bdf904ade4193f2b2bb3354}{00011}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__cossin_a7902d9a76bdf904ade4193f2b2bb3354}{cossin}}(X,\ p=None,\ q=None,\ separate=False,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ \ \ \ swap\_sign=False,\ compute\_u=True,\ compute\_vh=True):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00013}00013\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ Compute\ the\ cosine-\/sine\ (CS)\ decomposition\ of\ an\ orthogonal/unitary\ matrix.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00015}00015\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ X\ is\ an\ \`{}\`{}(m,\ m)\`{}\`{}\ orthogonal/unitary\ matrix,\ partitioned\ as\ the\ following}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ where\ upper\ left\ block\ has\ the\ shape\ of\ \`{}\`{}(p,\ q)\`{}\`{}::}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00018}00018\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ┌\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ┐}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ │\ I\ \ 0\ \ 0\ │\ 0\ \ 0\ \ 0\ │}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ┌\ \ \ \ \ \ \ \ \ \ \ ┐\ \ \ ┌\ \ \ \ \ \ \ \ \ ┐│\ 0\ \ C\ \ 0\ │\ 0\ -\/S\ \ 0\ │┌\ \ \ \ \ \ \ \ \ ┐*}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ │\ X11\ │\ X12\ │\ \ \ │\ U1\ │\ \ \ \ ││\ 0\ \ 0\ \ 0\ │\ 0\ \ 0\ -\/I\ ││\ V1\ │\ \ \ \ │}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ │\ ────┼────\ │\ =\ │────┼────││─────────┼─────────││────┼────│}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ │\ X21\ │\ X22\ │\ \ \ │\ \ \ \ │\ U2\ ││\ 0\ \ 0\ \ 0\ │\ I\ \ 0\ \ 0\ ││\ \ \ \ │\ V2\ │}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ └\ \ \ \ \ \ \ \ \ \ \ ┘\ \ \ └\ \ \ \ \ \ \ \ \ ┘│\ 0\ \ S\ \ 0\ │\ 0\ \ C\ \ 0\ │└\ \ \ \ \ \ \ \ \ ┘}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ │\ 0\ \ 0\ \ I\ │\ 0\ \ 0\ \ 0\ │}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ └\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ┘}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00028}00028\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}U1\`{}\`{},\ \`{}\`{}U2\`{}\`{},\ \`{}\`{}V1\`{}\`{},\ \`{}\`{}V2\`{}\`{}\ are\ square\ orthogonal/unitary\ matrices\ of}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ dimensions\ \`{}\`{}(p,p)\`{}\`{},\ \`{}\`{}(m-\/p,m-\/p)\`{}\`{},\ \`{}\`{}(q,q)\`{}\`{},\ and\ \`{}\`{}(m-\/q,m-\/q)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ respectively,\ and\ \`{}\`{}C\`{}\`{}\ and\ \`{}\`{}S\`{}\`{}\ are\ \`{}\`{}(r,\ r)\`{}\`{}\ nonnegative\ diagonal}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ matrices\ satisfying\ \`{}\`{}C\string^2\ +\ S\string^2\ =\ I\`{}\`{}\ where\ \`{}\`{}r\ =\ min(p,\ m-\/p,\ q,\ m-\/q)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00033}00033\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ Moreover,\ the\ rank\ of\ the\ identity\ matrices\ are\ \`{}\`{}min(p,\ q)\ -\/\ r\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}min(p,\ m\ -\/\ q)\ -\/\ r\`{}\`{},\ \`{}\`{}min(m\ -\/\ p,\ q)\ -\/\ r\`{}\`{},\ and\ \`{}\`{}min(m\ -\/\ p,\ m\ -\/\ q)\ -\/\ r\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ respectively.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00037}00037\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ X\ can\ be\ supplied\ either\ by\ itself\ and\ block\ specifications\ p,\ q\ or\ its}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ subblocks\ in\ an\ iterable\ from\ which\ the\ shapes\ would\ be\ derived.\ See\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ examples\ below.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00041}00041\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ X\ :\ array\_like,\ iterable}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ complex\ unitary\ or\ real\ orthogonal\ matrix\ to\ be\ decomposed,\ or\ iterable}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ subblocks\ \`{}\`{}X11\`{}\`{},\ \`{}\`{}X12\`{}\`{},\ \`{}\`{}X21\`{}\`{},\ \`{}\`{}X22\`{}\`{},\ when\ \`{}\`{}p\`{}\`{},\ \`{}\`{}q\`{}\`{}\ are}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ omitted.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ p\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ rows\ of\ the\ upper\ left\ block\ \`{}\`{}X11\`{}\`{},\ used\ only\ when\ X\ is}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ given\ as\ an\ array.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ q\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ columns\ of\ the\ upper\ left\ block\ \`{}\`{}X11\`{}\`{},\ used\ only\ when\ X\ is}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ given\ as\ an\ array.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ separate\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ \`{}\`{}True\`{}\`{},\ the\ low\ level\ components\ are\ returned\ instead\ of\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ matrix\ factors,\ i.e.\ \`{}\`{}(u1,u2)\`{}\`{},\ \`{}\`{}theta\`{}\`{},\ \`{}\`{}(v1h,v2h)\`{}\`{}\ instead\ of}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}u\`{}\`{},\ \`{}\`{}cs\`{}\`{},\ \`{}\`{}vh\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ swap\_sign\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ \`{}\`{}True\`{}\`{},\ the\ \`{}\`{}-\/S\`{}\`{},\ \`{}\`{}-\/I\`{}\`{}\ block\ will\ be\ the\ bottom\ left,}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ otherwise\ (by\ default)\ they\ will\ be\ in\ the\ upper\ right\ block.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ compute\_u\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ \`{}\`{}False\`{}\`{},\ \`{}\`{}u\`{}\`{}\ won't\ be\ computed\ and\ an\ empty\ array\ is\ returned.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ compute\_vh\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ \`{}\`{}False\`{}\`{},\ \`{}\`{}vh\`{}\`{}\ won't\ be\ computed\ and\ an\ empty\ array\ is\ returned.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00065}00065\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ u\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}compute\_u=True\`{}\`{},\ contains\ the\ block\ diagonal\ orthogonal/unitary}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ matrix\ consisting\ of\ the\ blocks\ \`{}\`{}U1\`{}\`{}\ (\`{}\`{}p\`{}\`{}\ x\ \`{}\`{}p\`{}\`{})\ and\ \`{}\`{}U2\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (\`{}\`{}m-\/p\`{}\`{}\ x\ \`{}\`{}m-\/p\`{}\`{})\ orthogonal/unitary\ matrices.\ If\ \`{}\`{}separate=True\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ this\ contains\ the\ tuple\ of\ \`{}\`{}(U1,\ U2)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ cs\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ cosine-\/sine\ factor\ with\ the\ structure\ described\ above.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ If\ \`{}\`{}separate=True\`{}\`{},\ this\ contains\ the\ \`{}\`{}theta\`{}\`{}\ array\ containing\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ angles\ in\ radians.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ vh\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}compute\_vh=True\`{},\ contains\ the\ block\ diagonal\ orthogonal/unitary}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ matrix\ consisting\ of\ the\ blocks\ \`{}\`{}V1H\`{}\`{}\ (\`{}\`{}q\`{}\`{}\ x\ \`{}\`{}q\`{}\`{})\ and\ \`{}\`{}V2H\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (\`{}\`{}m-\/q\`{}\`{}\ x\ \`{}\`{}m-\/q\`{}\`{})\ orthogonal/unitary\ matrices.\ If\ \`{}\`{}separate=True\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ this\ contains\ the\ tuple\ of\ \`{}\`{}(V1H,\ V2H)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00082}00082\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Brian\ D.\ Sutton.\ Computing\ the\ complete\ CS\ decomposition.\ Numer.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Algorithms,\ 50(1):33-\/65,\ 2009.}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00087}00087\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.linalg\ import\ cossin}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ unitary\_group}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ unitary\_group.rvs(4)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ >>>\ u,\ cs,\ vdh\ =\ cossin(x,\ p=2,\ q=2)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ >>>\ np.allclose(x,\ u\ @\ cs\ @\ vdh)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00097}00097\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ Same\ can\ be\ entered\ via\ subblocks\ without\ the\ need\ of\ \`{}\`{}p\`{}\`{}\ and\ \`{}\`{}q\`{}\`{}.\ Also}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ let's\ skip\ the\ computation\ of\ \`{}\`{}u\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00100}00100\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ >>>\ ue,\ cs,\ vdh\ =\ cossin((x[:2,\ :2],\ x[:2,\ 2:],\ x[2:,\ :2],\ x[2:,\ 2:]),}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_u=False)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(ue)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ []}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ >>>\ np.allclose(x,\ u\ @\ cs\ @\ vdh)}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00107}00107\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00110}00110\ \ \ \ \ \textcolor{keywordflow}{if}\ p\ \textcolor{keywordflow}{or}\ q:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ p\ =\ 1\ \textcolor{keywordflow}{if}\ p\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ int(p)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ q\ =\ 1\ \textcolor{keywordflow}{if}\ q\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ int(q)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ X\ =\ \_asarray\_validated(X,\ check\_finite=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.equal(*X.shape):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Cosine\ Sine\ decomposition\ only\ supports\ square"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ matrices,\ got\ \{\}"{}}.format(X.shape))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ m\ =\ X.shape[0]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p\ >=\ m\ \textcolor{keywordflow}{or}\ p\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}invalid\ p=\{\},\ 0<p<\{\}\ must\ hold"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(p,\ X.shape[0]))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ q\ >=\ m\ \textcolor{keywordflow}{or}\ q\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}invalid\ q=\{\},\ 0<q<\{\}\ must\ hold"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(q,\ X.shape[0]))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ x11,\ x12,\ x21,\ x22\ =\ X[:p,\ :q],\ X[:p,\ q:],\ X[p:,\ :q],\ X[p:,\ q:]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00126}00126\ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{keywordflow}{not}\ isinstance(X,\ Iterable):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}When\ p\ and\ q\ are\ None,\ X\ must\ be\ an\ Iterable"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ containing\ the\ subblocks\ of\ X"{}})}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00129}00129\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(X)\ !=\ 4:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}When\ p\ and\ q\ are\ None,\ exactly\ four\ arrays"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ be\ in\ X,\ got\ \{\}"{}}.format(len(X)))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ x11,\ x12,\ x21,\ x22\ =\ (np.atleast\_2d(x)\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ X)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ name,\ block\ \textcolor{keywordflow}{in}\ zip([\textcolor{stringliteral}{"{}x11"{}},\ \textcolor{stringliteral}{"{}x12"{}},\ \textcolor{stringliteral}{"{}x21"{}},\ \textcolor{stringliteral}{"{}x22"{}}],}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [x11,\ x12,\ x21,\ x22]):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ block.shape[1]\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\{name\}\ can't\ be\ empty"{}})}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ p,\ q\ =\ x11.shape}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ mmp,\ mmq\ =\ x22.shape}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x12.shape\ !=\ (p,\ mmq):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Invalid\ x12\ dimensions:\ desired\ \{\},\ "{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}got\ \{\}"{}}.format((p,\ mmq),\ x12.shape))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x21.shape\ !=\ (mmp,\ q):}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Invalid\ x21\ dimensions:\ desired\ \{\},\ "{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}got\ \{\}"{}}.format((mmp,\ q),\ x21.shape))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ p\ +\ mmp\ !=\ q\ +\ mmq:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ subblocks\ have\ compatible\ sizes\ but\ "{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}don't\ form\ a\ square\ array\ (instead\ they\ form\ a"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \{\}x\{\}\ array).\ This\ might\ be\ due\ to\ missing\ "{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}p,\ q\ arguments."{}}.format(p\ +\ mmp,\ q\ +\ mmq))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ m\ =\ p\ +\ mmp}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00158}00158\ \ \ \ \ cplx\ =\ any([np.iscomplexobj(x)\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ [x11,\ x12,\ x21,\ x22]])}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00159}00159\ \ \ \ \ driver\ =\ \textcolor{stringliteral}{"{}uncsd"{}}\ \textcolor{keywordflow}{if}\ cplx\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}orcsd"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00160}00160\ \ \ \ \ csd,\ csd\_lwork\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1lapack_ac91f10877b228186bc36e9f3c9c82e3f}{get\_lapack\_funcs}}([driver,\ driver\ +\ \textcolor{stringliteral}{"{}\_lwork"{}}],}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [x11,\ x12,\ x21,\ x22])}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00162}00162\ \ \ \ \ lwork\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1lapack_abbd01dcbd4e8fef0d61be684a003b7e5}{\_compute\_lwork}}(csd\_lwork,\ m=m,\ p=p,\ q=q)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00163}00163\ \ \ \ \ lwork\_args\ =\ (\{\textcolor{stringliteral}{'lwork'}:\ lwork[0],\ \textcolor{stringliteral}{'lrwork'}:\ lwork[1]\}\ \textcolor{keywordflow}{if}\ cplx\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'lwork'}:\ lwork\})}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00165}00165\ \ \ \ \ *\_,\ theta,\ u1,\ u2,\ v1h,\ v2h,\ info\ =\ csd(x11=x11,\ x12=x12,\ x21=x21,\ x22=x22,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_u1=compute\_u,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_u2=compute\_u,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_v1t=compute\_vh,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_v2t=compute\_vh,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trans=\textcolor{keyword}{False},\ signs=swap\_sign,}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ **lwork\_args)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00173}00173\ \ \ \ \ method\_name\ =\ csd.typecode\ +\ driver}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00174}00174\ \ \ \ \ \textcolor{keywordflow}{if}\ info\ <\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'illegal\ value\ in\ argument\ \{\}\ of\ internal\ \{\}'}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(-\/info,\ method\_name))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00177}00177\ \ \ \ \ \textcolor{keywordflow}{if}\ info\ >\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classnumpy_1_1linalg_1_1linalg_1_1LinAlgError}{LinAlgError}}(f\textcolor{stringliteral}{"{}\{method\_name\}\ did\ not\ converge:\ \{info\}"{}})}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00180}00180\ \ \ \ \ \textcolor{keywordflow}{if}\ separate:}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (u1,\ u2),\ theta,\ (v1h,\ v2h)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00183}00183\ \ \ \ \ U\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__special__matrices_ae014151e4a6a5a1fb0d0607d52ac78c2}{block\_diag}}(u1,\ u2)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00184}00184\ \ \ \ \ VDH\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__special__matrices_ae014151e4a6a5a1fb0d0607d52ac78c2}{block\_diag}}(v1h,\ v2h)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00186}00186\ \ \ \ \ \textcolor{comment}{\#\ Construct\ the\ middle\ factor\ CS}}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00187}00187\ \ \ \ \ c\ =\ np.diag(np.cos(theta))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00188}00188\ \ \ \ \ s\ =\ np.diag(np.sin(theta))}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00189}00189\ \ \ \ \ r\ =\ min(p,\ q,\ m\ -\/\ p,\ m\ -\/\ q)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00190}00190\ \ \ \ \ n11\ =\ min(p,\ q)\ -\/\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00191}00191\ \ \ \ \ n12\ =\ min(p,\ m\ -\/\ q)\ -\/\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00192}00192\ \ \ \ \ n21\ =\ min(m\ -\/\ p,\ q)\ -\/\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00193}00193\ \ \ \ \ n22\ =\ min(m\ -\/\ p,\ m\ -\/\ q)\ -\/\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00194}00194\ \ \ \ \ Id\ =\ np.eye(np.max([n11,\ n12,\ n21,\ n22,\ r]),\ dtype=theta.dtype)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00195}00195\ \ \ \ \ CS\ =\ np.zeros((m,\ m),\ dtype=theta.dtype)}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00197}00197\ \ \ \ \ CS[:n11,\ :n11]\ =\ Id[:n11,\ :n11]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00199}00199\ \ \ \ \ xs\ =\ n11\ +\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00200}00200\ \ \ \ \ xe\ =\ n11\ +\ r\ +\ n12}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00201}00201\ \ \ \ \ ys\ =\ n11\ +\ n21\ +\ n22\ +\ 2\ *\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00202}00202\ \ \ \ \ ye\ =\ n11\ +\ n21\ +\ n22\ +\ 2\ *\ r\ +\ n12}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00203}00203\ \ \ \ \ CS[xs:\ xe,\ ys:ye]\ =\ Id[:n12,\ :n12]\ \textcolor{keywordflow}{if}\ swap\_sign\ \textcolor{keywordflow}{else}\ -\/Id[:n12,\ :n12]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00205}00205\ \ \ \ \ xs\ =\ p\ +\ n22\ +\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00206}00206\ \ \ \ \ xe\ =\ p\ +\ n22\ +\ r\ +\ +\ n21}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00207}00207\ \ \ \ \ ys\ =\ n11\ +\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00208}00208\ \ \ \ \ ye\ =\ n11\ +\ r\ +\ n21}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00209}00209\ \ \ \ \ CS[xs:xe,\ ys:ye]\ =\ -\/Id[:n21,\ :n21]\ \textcolor{keywordflow}{if}\ swap\_sign\ \textcolor{keywordflow}{else}\ Id[:n21,\ :n21]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00211}00211\ \ \ \ \ CS[p:p\ +\ n22,\ q:q\ +\ n22]\ =\ Id[:n22,\ :n22]}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00212}00212\ \ \ \ \ CS[n11:n11\ +\ r,\ n11:n11\ +\ r]\ =\ c}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00213}00213\ \ \ \ \ CS[p\ +\ n22:p\ +\ n22\ +\ r,\ r\ +\ n21\ +\ n22:2\ *\ r\ +\ n21\ +\ n22]\ =\ c}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00215}00215\ \ \ \ \ xs\ =\ n11}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00216}00216\ \ \ \ \ xe\ =\ n11\ +\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00217}00217\ \ \ \ \ ys\ =\ n11\ +\ n21\ +\ n22\ +\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00218}00218\ \ \ \ \ ye\ =\ n11\ +\ n21\ +\ n22\ +\ 2\ *\ r}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00219}00219\ \ \ \ \ CS[xs:xe,\ ys:ye]\ =\ s\ \textcolor{keywordflow}{if}\ swap\_sign\ \textcolor{keywordflow}{else}\ -\/s}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00221}00221\ \ \ \ \ CS[p\ +\ n22:p\ +\ n22\ +\ r,\ n11:n11\ +\ r]\ =\ -\/s\ \textcolor{keywordflow}{if}\ swap\_sign\ \textcolor{keywordflow}{else}\ s}
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{__decomp__cossin_8py_source_l00223}00223\ \ \ \ \ \textcolor{keywordflow}{return}\ U,\ CS,\ VDH}

\end{DoxyCode}
