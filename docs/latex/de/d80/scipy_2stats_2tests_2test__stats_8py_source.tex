\doxysection{test\+\_\+stats.\+py}
\hypertarget{scipy_2stats_2tests_2test__stats_8py_source}{}\label{scipy_2stats_2tests_2test__stats_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/test\_stats.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/tests/test\_stats.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__stats}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}\ Test\ functions\ for\ stats\ module}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00002}00002\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00003}00003\ \textcolor{stringliteral}{\ \ \ \ WRITTEN\ BY\ LOUIS\ LUANGKESORN\ <lluang@yahoo.com>\ FOR\ THE\ STATS\ MODULE}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00004}00004\ \textcolor{stringliteral}{\ \ \ \ BASED\ ON\ WILKINSON'S\ STATISTICS\ QUIZ}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00005}00005\ \textcolor{stringliteral}{\ \ \ \ https://www.stanford.edu/\string~clint/bench/wilk.txt}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00006}00006\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00007}00007\ \textcolor{stringliteral}{\ \ \ \ Additional\ tests\ by\ a\ host\ of\ SciPy\ developers.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00008}00008\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00009}00009\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00010}00010\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00011}00011\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00012}00012\ \textcolor{keyword}{from}\ collections\ \textcolor{keyword}{import}\ namedtuple}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00013}00013\ \textcolor{keyword}{from}\ itertools\ \textcolor{keyword}{import}\ product}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00015}00015\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ (assert\_,\ assert\_equal,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_almost\_equal,\ assert\_array\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal,\ assert\_approx\_equal,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose,\ assert\_warns,\ suppress\_warnings,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_less)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00020}00020\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00021}00021\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00022}00022\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacenumpy_1_1ma_1_1testutils}{numpy.ma.testutils}}\ \textcolor{keyword}{as}\ mat}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00023}00023\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ array,\ arange,\ float32,\ float64,\ power}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00024}00024\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00026}00026\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1stats}{scipy.stats}}\ \textcolor{keyword}{as}\ stats}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00027}00027\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1mstats}{scipy.stats.mstats}}\ \textcolor{keyword}{as}\ mstats}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00028}00028\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__mstats__basic}{scipy.stats.\_mstats\_basic}}\ \textcolor{keyword}{as}\ mstats\_basic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00029}00029\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__ksstats}{scipy.stats.\_ksstats}}\ \textcolor{keyword}{import}\ kolmogn}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00030}00030\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special_1_1__testutils}{scipy.special.\_testutils}}\ \textcolor{keyword}{import}\ FuncData}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00031}00031\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special}{scipy.special}}\ \textcolor{keyword}{import}\ binom}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00032}00032\ \textcolor{keyword}{from}\ scipy\ \textcolor{keyword}{import}\ optimize}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00033}00033\ \textcolor{keyword}{from}\ .common\_tests\ \textcolor{keyword}{import}\ check\_named\_results}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00034}00034\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1spatial_1_1distance}{scipy.spatial.distance}}\ \textcolor{keyword}{import}\ cdist}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00035}00035\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1lib}{numpy.lib}}\ \textcolor{keyword}{import}\ NumpyVersion}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00036}00036\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__axis__nan__policy}{scipy.stats.\_axis\_nan\_policy}}\ \textcolor{keyword}{import}\ \_broadcast\_concatenate}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00037}00037\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py}{scipy.stats.\_stats\_py}}\ \textcolor{keyword}{import}\ \_permutation\_distribution\_t}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00040}00040\ \textcolor{stringliteral}{"{}"{}"{}\ Numbers\ in\ docstrings\ beginning\ with\ 'W'\ refer\ to\ the\ section\ numbers}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ and\ headings\ found\ in\ the\ STATISTICS\ QUIZ\ of\ Leland\ Wilkinson.\ \ These\ are}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ considered\ to\ be\ essential\ functionality.\ \ True\ testing\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ evaluation\ of\ a\ statistics\ package\ requires\ use\ of\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ NIST\ Statistical\ test\ data.\ \ See\ McCoullough(1999)\ Assessing\ The\ Reliability}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ of\ Statistical\ Software\ for\ a\ test\ methodology\ and\ its}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ implementation\ in\ testing\ SAS,\ SPSS,\ and\ S-\/Plus}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00047}00047\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00049}00049\ \textcolor{comment}{\#\ \ Datasets}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00050}00050\ \textcolor{comment}{\#\ \ These\ data\ sets\ are\ from\ the\ nasty.dat\ sets\ used\ by\ Wilkinson}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00051}00051\ \textcolor{comment}{\#\ \ For\ completeness,\ I\ should\ write\ the\ relevant\ tests\ and\ count\ them\ as\ failures}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00052}00052\ \textcolor{comment}{\#\ \ Somewhat\ acceptable,\ since\ this\ is\ still\ beta\ software.\ \ It\ would\ count\ as\ a}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00053}00053\ \textcolor{comment}{\#\ \ good\ target\ for\ 1.0\ status}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00054}00054\ X\ =\ array([1,2,3,4,5,6,7,8,9],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00055}00055\ ZERO\ =\ array([0,0,0,0,0,0,0,0,0],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00056}00056\ BIG\ =\ array([99999991,99999992,99999993,99999994,99999995,99999996,99999997,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ 99999998,99999999],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00058}00058\ LITTLE\ =\ array([0.99999991,0.99999992,0.99999993,0.99999994,0.99999995,0.99999996,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.99999997,0.99999998,0.99999999],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00060}00060\ HUGE\ =\ array([1e+12,2e+12,3e+12,4e+12,5e+12,6e+12,7e+12,8e+12,9e+12],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00061}00061\ TINY\ =\ array([1e-\/12,2e-\/12,3e-\/12,4e-\/12,5e-\/12,6e-\/12,7e-\/12,8e-\/12,9e-\/12],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00062}00062\ ROUND\ =\ array([0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5],\ float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00065}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats}{00065}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats}{TestTrimmedStats}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00066}00066\ \ \ \ \ \textcolor{comment}{\#\ TODO:\ write\ these\ tests\ to\ handle\ missing\ values\ properly}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00067}00067\ \ \ \ \ dprec\ =\ np.finfo(np.float64).precision}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00069}00069\ \ \ \ \ \textcolor{keyword}{def\ }test\_tmean(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(X,\ (2,\ 8),\ (\textcolor{keyword}{True},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 5.0,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ y1\ =\ stats.tmean(X,\ limits=(2,\ 8),\ inclusive=(\textcolor{keyword}{False},\ \textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ y2\ =\ stats.tmean(X,\ limits=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y1,\ y2,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ x\_2d\ =\ arange(63,\ dtype=float64).reshape(9,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ x\_2d.mean(),\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ x\_2d.mean(axis=0),\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ x\_2d.mean(axis=1),\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ limits=(2,\ 61),\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 31.5,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ limits=(2,\ 21),\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ y\_true\ =\ [14,\ 11.5,\ 9,\ 10,\ 11,\ 12,\ 13]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ y\_true,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ limits=(2,\ 21),\ inclusive=(\textcolor{keyword}{True},\ \textcolor{keyword}{False}),\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ y\_true\ =\ [10.5,\ 11.5,\ 9,\ 10,\ 11,\ 12,\ 13]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ y\_true,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ x\_2d\_with\_nan\ =\ np.array(x\_2d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ x\_2d\_with\_nan[-\/1,\ -\/3:]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d\_with\_nan,\ limits=(1,\ 13),\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ y\_true\ =\ [7,\ 4.5,\ 5.5,\ 6.5,\ np.nan,\ np.nan,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ y\_true,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ limits=(2,\ 21),\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ y\_true\ =\ [4,\ 10,\ 17,\ 21,\ np.nan,\ np.nan,\ np.nan,\ np.nan,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ y\_true,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.tmean(x\_2d,\ limits=(2,\ 21),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inclusive=(\textcolor{keyword}{False},\ \textcolor{keyword}{True}),\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ y\_true\ =\ [4.5,\ 10,\ 17,\ 21,\ np.nan,\ np.nan,\ np.nan,\ np.nan,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y,\ y\_true,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00116}00116\ \ \ \ \ \textcolor{keyword}{def\ }test\_tvar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(X,\ limits=(2,\ 8),\ inclusive=(\textcolor{keyword}{True},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 4.6666666666666661,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(X,\ limits=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ X.var(ddof=1),\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ x\_2d\ =\ arange(63,\ dtype=float64).reshape((9,\ 7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ x\_2d.var(ddof=1),\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y[0],\ np.full((1,\ 7),\ 367.50000000),\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(y[0],\ np.full((1,\ 9),\ 4.66666667),\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d[3,\ :])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 4.666666666666667,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice."{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Limiting\ some\ values\ along\ one\ axis}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d,\ limits=(1,\ 5),\ axis=1,\ inclusive=(\textcolor{keyword}{True},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_approx\_equal(y[0],\ 2.5,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Limiting\ all\ values\ along\ one\ axis}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.tvar(x\_2d,\ limits=(0,\ 6),\ axis=1,\ inclusive=(\textcolor{keyword}{True},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_approx\_equal(y[0],\ 4.666666666666667,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(y[1],\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00148}00148\ \ \ \ \ \textcolor{keyword}{def\ }test\_tstd(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ y\ =\ stats.tstd(X,\ (2,\ 8),\ (\textcolor{keyword}{True},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 2.1602468994692865,\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ y\ =\ stats.tstd(X,\ limits=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ X.std(ddof=1),\ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00155}00155\ \ \ \ \ \textcolor{keyword}{def\ }test\_tmin(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(4),\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ lowerlimit=0),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ lowerlimit=0,\ inclusive=\textcolor{keyword}{False}),\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ x\ =\ x.reshape((5,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ lowerlimit=0,\ inclusive=\textcolor{keyword}{False}),\ [2,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ axis=1),\ [0,\ 2,\ 4,\ 6,\ 8])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ axis=\textcolor{keywordtype}{None}),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}invalid\ value*"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.tmin(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 0.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.tmin,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.tmin,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}'propagate',\ 'raise',\ 'omit'"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.tmin(x,\ nan\_policy=\textcolor{stringliteral}{'foo'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00180}00180\ \ \ \ \ \textcolor{keyword}{def\ }test\_tmax(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(4),\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x),\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ upperlimit=9),\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ upperlimit=9,\ inclusive=\textcolor{keyword}{False}),\ 8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ x\ =\ x.reshape((5,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ upperlimit=9,\ inclusive=\textcolor{keyword}{False}),\ [8,\ 7])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ axis=1),\ [1,\ 3,\ 5,\ 7,\ 9])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ axis=\textcolor{keywordtype}{None}),\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00192}00192\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ x[6]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}invalid\ value*"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.tmax(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 9.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.tmax,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.tmax,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00202}00202\ \ \ \ \ \textcolor{keyword}{def\ }test\_tsem(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ y\ =\ stats.tsem(X,\ limits=(3,\ 8),\ inclusive=(\textcolor{keyword}{False},\ \textcolor{keyword}{True}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ y\_ref\ =\ np.array([4,\ 5,\ 6,\ 7,\ 8])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ y\_ref.std(ddof=1)\ /\ np.sqrt(y\_ref.size),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stats.tsem(X,\ limits=[-\/1,\ 10]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.tsem(X,\ limits=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestTrimmedStats_abade75a1e337417a6e47defd7ef590b5}{dprec}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00212}00212\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00213}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrPearsonr}{00213}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrPearsonr}{TestCorrPearsonr}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00214}00214\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ W.II.D.\ Compute\ a\ correlation\ matrix\ on\ all\ the\ variables.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00215}00215\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ All\ the\ correlations,\ except\ for\ ZERO\ and\ MISS,\ should\ be\ exactly\ 1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ZERO\ and\ MISS\ should\ have\ undefined\ or\ missing\ correlations\ with\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ other\ variables.\ \ The\ same\ should\ go\ for\ SPEARMAN\ correlations,\ if}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ your\ program\ has\ them.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00222}00222\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXX(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00227}00227\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXBIG(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,BIG)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00232}00232\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXLITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00237}00237\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00242}00242\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00247}00247\ \ \ \ \ \textcolor{keyword}{def\ }test\_pXROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(X,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00252}00252\ \ \ \ \ \textcolor{keyword}{def\ }test\_pBIGBIG(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(BIG,BIG)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00257}00257\ \ \ \ \ \textcolor{keyword}{def\ }test\_pBIGLITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(BIG,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00262}00262\ \ \ \ \ \textcolor{keyword}{def\ }test\_pBIGHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(BIG,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00266}00266\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00267}00267\ \ \ \ \ \textcolor{keyword}{def\ }test\_pBIGTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(BIG,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00271}00271\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00272}00272\ \ \ \ \ \textcolor{keyword}{def\ }test\_pBIGROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(BIG,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00277}00277\ \ \ \ \ \textcolor{keyword}{def\ }test\_pLITTLELITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(LITTLE,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00282}00282\ \ \ \ \ \textcolor{keyword}{def\ }test\_pLITTLEHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(LITTLE,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00287}00287\ \ \ \ \ \textcolor{keyword}{def\ }test\_pLITTLETINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(LITTLE,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00291}00291\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00292}00292\ \ \ \ \ \textcolor{keyword}{def\ }test\_pLITTLEROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(LITTLE,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00297}00297\ \ \ \ \ \textcolor{keyword}{def\ }test\_pHUGEHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(HUGE,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00302}00302\ \ \ \ \ \textcolor{keyword}{def\ }test\_pHUGETINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(HUGE,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00306}00306\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00307}00307\ \ \ \ \ \textcolor{keyword}{def\ }test\_pHUGEROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(HUGE,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00311}00311\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00312}00312\ \ \ \ \ \textcolor{keyword}{def\ }test\_pTINYTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(TINY,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00316}00316\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00317}00317\ \ \ \ \ \textcolor{keyword}{def\ }test\_pTINYROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(TINY,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00322}00322\ \ \ \ \ \textcolor{keyword}{def\ }test\_pROUNDROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00323}00323\ \ \ \ \ \ \ \ \ y\ =\ stats.pearsonr(ROUND,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00326}00326\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00327}00327\ \ \ \ \ \textcolor{keyword}{def\ }test\_pearsonr\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr(X,\ X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'correlation'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ assert\_equal(res.correlation,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00332}00332\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00333}00333\ \ \ \ \ \textcolor{keyword}{def\ }test\_r\_almost\_exactly\_pos1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ a\ =\ arange(3.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ r,\ prob\ =\ stats.pearsonr(a,\ a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00336}00336\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ 1.0,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ With\ n\ =\ len(a)\ =\ 3,\ the\ error\ in\ prob\ grows\ like\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ square\ root\ of\ the\ error\ in\ r.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ assert\_allclose(prob,\ 0.0,\ atol=np.sqrt(2*np.spacing(1.0)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00341}00341\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00342}00342\ \ \ \ \ \textcolor{keyword}{def\ }test\_r\_almost\_exactly\_neg1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ a\ =\ arange(3.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ r,\ prob\ =\ stats.pearsonr(a,\ -\/a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00345}00345\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ -\/1.0,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ With\ n\ =\ len(a)\ =\ 3,\ the\ error\ in\ prob\ grows\ like\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ square\ root\ of\ the\ error\ in\ r.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ assert\_allclose(prob,\ 0.0,\ atol=np.sqrt(2*np.spacing(1.0)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00350}00350\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00351}00351\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ basic\ test,\ with\ a\ correlation\ coefficient}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ that\ is\ not\ 1\ or\ -\/1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ a\ =\ array([-\/1,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ b\ =\ array([0,\ 0,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ r,\ prob\ =\ stats.pearsonr(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00357}00357\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,\ np.sqrt(3)/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00358}00358\ \ \ \ \ \ \ \ \ assert\_approx\_equal(prob,\ 1/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00360}00360\ \ \ \ \ \textcolor{keyword}{def\ }test\_constant\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Zero\ variance\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/scipy/scipy/issues/3728}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ constant"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr([0.667,\ 0.667,\ 0.667],\ [0.123,\ 0.456,\ 0.789])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00368}00368\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00369}00369\ \ \ \ \ \textcolor{keyword}{def\ }test\_near\_constant\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Near\ constant\ input\ (but\ not\ constant):}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ x\ =\ [2,\ 2,\ 2\ +\ np.spacing(2)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ y\ =\ [3,\ 3,\ 3\ +\ 6*np.spacing(3)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00373}00373\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ nearly\ constant;\ the\ computed"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00374}00374\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1NearConstantInputWarning}{stats.NearConstantInputWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ r\ and\ p\ are\ garbage,\ so\ don't\ bother\ checking\ them\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00376}00376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (The\ exact\ value\ of\ r\ would\ be\ 1.)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00378}00378\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00379}00379\ \ \ \ \ \textcolor{keyword}{def\ }test\_very\_small\_input\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00380}00380\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Very\ small\ values\ in\ an\ input.\ \ A\ naive\ implementation\ will}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00381}00381\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ suffer\ from\ underflow.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00382}00382\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/scipy/scipy/issues/9353}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ x\ =\ [0.004434375,\ 0.004756007,\ 0.003911996,\ 0.0038005,\ 0.003409971]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00384}00384\ \ \ \ \ \ \ \ \ y\ =\ [2.48e-\/188,\ 7.41e-\/181,\ 4.09e-\/208,\ 2.08e-\/223,\ 2.66e-\/245]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr(x,y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00386}00386\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00387}00387\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ expected\ values\ were\ computed\ using\ mpmath\ with\ 80\ digits}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00388}00388\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00389}00389\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ 0.7272930540750450)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00390}00390\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ 0.1637805429533202)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00391}00391\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00392}00392\ \ \ \ \ \textcolor{keyword}{def\ }test\_very\_large\_input\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00393}00393\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Very\ large\ values\ in\ an\ input.\ \ A\ naive\ implementation\ will}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ suffer\ from\ overflow.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00395}00395\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/scipy/scipy/issues/8980}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ x\ =\ 1e90*np.array([0,\ 0,\ 0,\ 1,\ 1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ y\ =\ 1e90*np.arange(7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00400}00400\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ expected\ values\ were\ computed\ using\ mpmath\ with\ 80\ digits}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ 0.8660254037844386)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ 0.011724811003954638)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00405}00405\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00406}00406\ \ \ \ \ \textcolor{keyword}{def\ }test\_extremely\_large\_input\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Extremely\ large\ values\ in\ x\ and\ y.\ \ These\ values\ would\ cause\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ product\ sigma\_x\ *\ sigma\_y\ to\ overflow\ if\ the\ two\ factors\ were}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ computed\ independently.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ x\ =\ np.array([2.3e200,\ 4.5e200,\ 6.7e200,\ 8e200])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ y\ =\ np.array([1.2e199,\ 5.5e200,\ 3.3e201,\ 1.0e200])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00413}00413\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ expected\ values\ were\ computed\ using\ mpmath\ with\ 80\ digits}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ 0.351312332103289)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ 0.648687667896711)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00418}00418\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00419}00419\ \ \ \ \ \textcolor{keyword}{def\ }test\_length\_two\_pos1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Inputs\ with\ length\ 2.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/scipy/scipy/issues/7730}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr([1,\ 2],\ [3,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ r,\ p\ =\ res}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ assert\_equal(r,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ assert\_equal(p,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ assert\_equal(res.confidence\_interval(),\ (-\/1,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00427}00427\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00428}00428\ \ \ \ \ \textcolor{keyword}{def\ }test\_length\_two\_neg2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Inputs\ with\ length\ 2.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/scipy/scipy/issues/7730}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.pearsonr([2,\ 1],\ [3,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ assert\_equal(r,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ assert\_equal(p,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00434}00434\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00435}00435\ \ \ \ \ \textcolor{comment}{\#\ Expected\ values\ computed\ with\ R\ 3.6.2\ cor.test,\ e.g.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00436}00436\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00437}00437\ \ \ \ \ \textcolor{comment}{\#\ x\ <-\/\ c(1,\ 2,\ 3,\ 4)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00438}00438\ \ \ \ \ \textcolor{comment}{\#\ y\ <-\/\ c(0,\ 1,\ 0.5,\ 1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00439}00439\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,\ y,\ method\ =\ "{}pearson"{},\ alternative\ =\ "{}g"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00440}00440\ \ \ \ \ \textcolor{comment}{\#\ correlation\ coefficient\ and\ p-\/value\ for\ alternative='two-\/sided'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00441}00441\ \ \ \ \ \textcolor{comment}{\#\ calculated\ with\ mpmath\ agree\ to\ 16\ digits.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00442}00442\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'alternative,\ pval,\ rlow,\ rhigh,\ sign'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ \ \ \ \ [(\textcolor{stringliteral}{'two-\/sided'},\ 0.325800137536,\ -\/0.814938968841,\ 0.99230697523,\ 1),\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'less'},\ 0.8370999312316,\ -\/1,\ 0.985600937290653,\ 1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'greater'},\ 0.1629000687684,\ -\/0.6785654158217636,\ 1,\ 1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'two-\/sided'},\ 0.325800137536,\ -\/0.992306975236,\ 0.81493896884,\ -\/1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'less'},\ 0.1629000687684,\ -\/1.0,\ 0.6785654158217636,\ -\/1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'greater'},\ 0.8370999312316,\ -\/0.985600937290653,\ 1.0,\ -\/1)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00449}00449\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic\_example(self,\ alternative,\ pval,\ rlow,\ rhigh,\ sign):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 2,\ 3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00451}00451\ \ \ \ \ \ \ \ \ y\ =\ np.array([0,\ 1,\ 0.5,\ 1])\ *\ sign}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00452}00452\ \ \ \ \ \ \ \ \ result\ =\ stats.pearsonr(x,\ y,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00453}00453\ \ \ \ \ \ \ \ \ assert\_allclose(result.statistic,\ 0.6741998624632421*sign,\ rtol=1e-\/12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ assert\_allclose(result.pvalue,\ pval,\ rtol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00455}00455\ \ \ \ \ \ \ \ \ ci\ =\ result.confidence\_interval()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00456}00456\ \ \ \ \ \ \ \ \ assert\_allclose(ci,\ (rlow,\ rhigh),\ rtol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00457}00457\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00458}00458\ \ \ \ \ \textcolor{keyword}{def\ }test\_negative\_correlation\_pvalue\_gh17795(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00459}00459\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ y\ =\ -\/x}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00461}00461\ \ \ \ \ \ \ \ \ test\_greater\ =\ stats.pearsonr(x,\ y,\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00462}00462\ \ \ \ \ \ \ \ \ test\_less\ =\ stats.pearsonr(x,\ y,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00463}00463\ \ \ \ \ \ \ \ \ assert\_allclose(test\_greater.pvalue,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00464}00464\ \ \ \ \ \ \ \ \ assert\_allclose(test\_less.pvalue,\ 0,\ atol=1e-\/20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00465}00465\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00466}00466\ \ \ \ \ \textcolor{keyword}{def\ }test\_length3\_r\_exactly\_negative\_one(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ y\ =\ [5,\ -\/4,\ -\/13]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00469}00469\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00470}00470\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ expected\ r\ and\ p\ are\ exact.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ r,\ p\ =\ res}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00473}00473\ \ \ \ \ \ \ \ \ assert\_allclose(r,\ -\/1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ 0.0,\ atol=1e-\/7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00475}00475\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ assert\_equal(res.confidence\_interval(),\ (-\/1,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00477}00477\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00478}00478\ \ \ \ \ \textcolor{keyword}{def\ }test\_unequal\_lengths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ y\ =\ [4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.pearsonr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00482}00482\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00483}00483\ \ \ \ \ \textcolor{keyword}{def\ }test\_len1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00484}00484\ \ \ \ \ \ \ \ \ x\ =\ [1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00485}00485\ \ \ \ \ \ \ \ \ y\ =\ [2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.pearsonr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00488}00488\ \ \ \ \ \textcolor{keyword}{def\ }test\_complex\_data(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00489}00489\ \ \ \ \ \ \ \ \ x\ =\ [-\/1j,\ -\/2j,\ -\/3.0j]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00490}00490\ \ \ \ \ \ \ \ \ y\ =\ [-\/1j,\ -\/2j,\ -\/3.0j]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00491}00491\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{'This\ function\ does\ not\ support\ complex\ data'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00492}00492\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00493}00493\ \ \ \ \ \ \ \ \ \ \ \ \ stats.pearsonr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00494}00494\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00495}00495\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.xslow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00496}00496\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('alternative',\ ('less',\ 'greater',\ 'two-\/sided')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00497}00497\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('method',\ ('permutation',\ 'monte\_carlo')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00498}00498\ \ \ \ \ \textcolor{keyword}{def\ }test\_resampling\_pvalue(self,\ method,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00499}00499\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(24623935790378923)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ size\ =\ 100\ \textcolor{keywordflow}{if}\ method\ ==\ \textcolor{stringliteral}{'permutation'}\ \textcolor{keywordflow}{else}\ 1000}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ x\ =\ rng.normal(size=size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00502}00502\ \ \ \ \ \ \ \ \ y\ =\ rng.normal(size=size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00503}00503\ \ \ \ \ \ \ \ \ methods\ =\ \{\textcolor{stringliteral}{'permutation'}:\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationMethod}{stats.PermutationMethod}}(random\_state=rng),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00504}00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'monte\_carlo'}:\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloMethod}{stats.MonteCarloMethod}}(rvs=(rng.normal,)*2)\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00505}00505\ \ \ \ \ \ \ \ \ method\ =\ methods[method]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00506}00506\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr(x,\ y,\ alternative=alternative,\ method=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00507}00507\ \ \ \ \ \ \ \ \ ref\ =\ stats.pearsonr(x,\ y,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00508}00508\ \ \ \ \ \ \ \ \ assert\_allclose(res.statistic,\ ref.statistic,\ rtol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue,\ ref.pvalue,\ rtol=1e-\/2,\ atol=1e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00510}00510\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00511}00511\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.xslow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00512}00512\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('alternative',\ ('less',\ 'greater',\ 'two-\/sided')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00513}00513\ \ \ \ \ \textcolor{keyword}{def\ }test\_bootstrap\_ci(self,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00514}00514\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(24623935790378923)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00515}00515\ \ \ \ \ \ \ \ \ x\ =\ rng.normal(size=100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00516}00516\ \ \ \ \ \ \ \ \ y\ =\ rng.normal(size=100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00517}00517\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr(x,\ y,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00518}00518\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ method\ =\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapMethod}{stats.BootstrapMethod}}(random\_state=rng)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ res\_ci\ =\ res.confidence\_interval(method=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ ref\_ci\ =\ res.confidence\_interval()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00523}00523\ \ \ \ \ \ \ \ \ assert\_allclose(res\_ci,\ ref\_ci,\ atol=1e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00524}00524\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00525}00525\ \ \ \ \ \textcolor{keyword}{def\ }test\_invalid\_method(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00526}00526\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}\`{}method`\ must\ be\ an\ instance\ of..."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00528}00528\ \ \ \ \ \ \ \ \ \ \ \ \ stats.pearsonr([1,\ 2],\ [3,\ 4],\ method=\textcolor{stringliteral}{"{}asymptotic"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00529}00529\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ res\ =\ stats.pearsonr([1,\ 2],\ [3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00531}00531\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00532}00532\ \ \ \ \ \ \ \ \ \ \ \ \ res.confidence\_interval(method=\textcolor{stringliteral}{"{}exact"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00533}00533\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00534}00534\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00535}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestFisherExact}{00535}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestFisherExact}{TestFisherExact}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00536}00536\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Some\ tests\ to\ show\ that\ fisher\_exact()\ works\ correctly.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00537}00537\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ in\ SciPy\ 0.9.0\ this\ was\ not\ working\ well\ for\ large\ numbers\ due\ to}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00539}00539\ \textcolor{stringliteral}{\ \ \ \ inaccuracy\ of\ the\ hypergeom\ distribution\ (see\ \#1218).\ Fixed\ now.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00540}00540\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00541}00541\ \textcolor{stringliteral}{\ \ \ \ Also\ note\ that\ R\ and\ SciPy\ have\ different\ argument\ formats\ for\ their}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00542}00542\ \textcolor{stringliteral}{\ \ \ \ hypergeometric\ distribution\ functions.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00543}00543\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00544}00544\ \textcolor{stringliteral}{\ \ \ \ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00545}00545\ \textcolor{stringliteral}{\ \ \ \ >\ phyper(18999,\ 99000,\ 110000,\ 39000,\ lower.tail\ =\ FALSE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00546}00546\ \textcolor{stringliteral}{\ \ \ \ [1]\ 1.701815e-\/09}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00547}00547\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00548}00548\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00549}00549\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00550}00550\ \ \ \ \ \ \ \ \ fisher\_exact\ =\ stats.fisher\_exact}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00551}00551\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00552}00552\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[14500,\ 20000],\ [30000,\ 40000]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.01106,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00554}00554\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[100,\ 2],\ [1000,\ 5]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00555}00555\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.1301,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00556}00556\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[2,\ 7],\ [8,\ 2]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00557}00557\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.0230141,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00558}00558\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[5,\ 1],\ [10,\ 10]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.1973244,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[5,\ 15],\ [20,\ 20]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.0958044,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[5,\ 16],\ [20,\ 25]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00563}00563\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.1725862,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00564}00564\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[10,\ 5],\ [10,\ 1]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00565}00565\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.1973244,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[5,\ 0],\ [1,\ 4]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00567}00567\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.04761904,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00568}00568\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[0,\ 1],\ [3,\ 2]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00569}00569\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00570}00570\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[0,\ 2],\ [6,\ 4]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00571}00571\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.4545454545)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_aec971e2362ba3d1144450412cfb4d674}{fisher\_exact}}([[2,\ 7],\ [8,\ 2]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00573}00573\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ 0.0230141,\ significant=6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00574}00574\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ 4.0\ /\ 56)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00575}00575\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00576}00576\ \ \ \ \ \textcolor{keyword}{def\ }test\_precise(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00577}00577\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ results\ from\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00579}00579\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ R\ defines\ oddsratio\ differently\ (see\ Notes\ section\ of\ fisher\_exact}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00580}00580\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ docstring),\ so\ those\ will\ not\ match.\ \ We\ leave\ them\ in\ anyway,\ in}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00581}00581\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ case\ they\ will\ be\ useful\ later\ on.\ We\ test\ only\ the\ p-\/value.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00582}00582\ \ \ \ \ \ \ \ \ tablist\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ \ \ \ \ ([[100,\ 2],\ [1000,\ 5]],\ (2.505583993422285e-\/001,\ 1.300759363430016e-\/001)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00584}00584\ \ \ \ \ \ \ \ \ \ \ \ \ ([[2,\ 7],\ [8,\ 2]],\ (8.586235135736206e-\/002,\ 2.301413756522114e-\/002)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00585}00585\ \ \ \ \ \ \ \ \ \ \ \ \ ([[5,\ 1],\ [10,\ 10]],\ (4.725646047336584e+000,\ 1.973244147157190e-\/001)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ \ \ \ \ ([[5,\ 15],\ [20,\ 20]],\ (3.394396617440852e-\/001,\ 9.580440012477637e-\/002)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ \ \ \ \ ([[5,\ 16],\ [20,\ 25]],\ (3.960558326183334e-\/001,\ 1.725864953812994e-\/001)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \ \ \ \ ([[10,\ 5],\ [10,\ 1]],\ (2.116112781158483e-\/001,\ 1.973244147157190e-\/001)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ \ \ \ \ ([[10,\ 5],\ [10,\ 0]],\ (0.000000000000000e+000,\ 6.126482213438734e-\/002)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00590}00590\ \ \ \ \ \ \ \ \ \ \ \ \ ([[5,\ 0],\ [1,\ 4]],\ (np.inf,\ 4.761904761904762e-\/002)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00591}00591\ \ \ \ \ \ \ \ \ \ \ \ \ ([[0,\ 5],\ [1,\ 4]],\ (0.000000000000000e+000,\ 1.000000000000000e+000)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00592}00592\ \ \ \ \ \ \ \ \ \ \ \ \ ([[5,\ 1],\ [0,\ 4]],\ (np.inf,\ 4.761904761904758e-\/002)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00593}00593\ \ \ \ \ \ \ \ \ \ \ \ \ ([[0,\ 1],\ [3,\ 2]],\ (0.000000000000000e+000,\ 1.000000000000000e+000))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00594}00594\ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00595}00595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ table,\ res\_r\ \textcolor{keywordflow}{in}\ tablist:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00596}00596\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(np.asarray(table))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00597}00597\ \ \ \ \ \ \ \ \ \ \ \ \ np.testing.assert\_almost\_equal(res[1],\ res\_r[1],\ decimal=11,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00598}00598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verbose=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00599}00599\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00600}00600\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh4130(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Previously,\ a\ fudge\ factor\ used\ to\ distinguish\ between\ theoeretically}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ numerically\ different\ probability\ masses\ was\ 1e-\/4;\ it\ has\ been}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00603}00603\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ tightened\ to\ fix\ gh4130.\ Accuracy\ checked\ against\ R\ fisher.test.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00605}00605\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ table\ <-\/\ matrix(c(6,\ 108,\ 37,\ 200),\ nrow\ =\ 2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ fisher.test(table,\ alternative\ =\ "{}t"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ x\ =\ [[6,\ 37],\ [108,\ 200]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 0.005092697748126)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00610}00610\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ case\ from\ https://github.com/brentp/fishers\_exact\_test/issues/27}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ That\ package\ has\ an\ (absolute?)\ fudge\ factor\ of\ 1e-\/6;\ too\ big}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ x\ =\ [[22,\ 0],\ [0,\ 102]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 7.175066786244549e-\/25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00616}00616\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ case\ from\ https://github.com/brentp/fishers\_exact\_test/issues/1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ x\ =\ [[94,\ 48],\ [3577,\ 16988]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 2.069356340993818e-\/37)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00621}00621\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00622}00622\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh9231(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Previously,\ fisher\_exact\ was\ extremely\ slow\ for\ this\ table}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ As\ reported\ in\ gh-\/9231,\ the\ p-\/value\ should\ be\ very\ nearly\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ x\ =\ [[5829225,\ 5692693],\ [5760959,\ 5760959]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 0,\ atol=1e-\/170)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00628}00628\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00629}00629\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00630}00630\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_numbers(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ with\ some\ large\ numbers.\ Regression\ test\ for\ \#1401}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ pvals\ =\ [5.56e-\/11,\ 2.666e-\/11,\ 1.363e-\/11]\ \ \textcolor{comment}{\#\ from\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ pval,\ num\ \textcolor{keywordflow}{in}\ zip(pvals,\ [75,\ 76,\ 77]):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact([[17704,\ 496],\ [1065,\ num]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ pval,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00636}00636\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact([[18000,\ 80000],\ [20000,\ 90000]])[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00638}00638\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res,\ 0.2751,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00639}00639\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00640}00640\ \ \ \ \ \textcolor{keyword}{def\ }test\_raises(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ we\ raise\ an\ error\ for\ wrong\ shape\ of\ input.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.fisher\_exact,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00643}00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(6).reshape(2,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00644}00644\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00645}00645\ \ \ \ \ \textcolor{keyword}{def\ }test\_row\_or\_col\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00646}00646\ \ \ \ \ \ \ \ \ tables\ =\ ([[0,\ 0],\ [5,\ 10]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[5,\ 10],\ [0,\ 0]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[0,\ 5],\ [0,\ 10]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[5,\ 0],\ [10,\ 0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ table\ \textcolor{keywordflow}{in}\ tables:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ oddsratio,\ pval\ =\ stats.fisher\_exact(table)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(pval,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(oddsratio,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00654}00654\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00655}00655\ \ \ \ \ \textcolor{keyword}{def\ }test\_less\_greater(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ tables\ =\ (}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Some\ tables\ to\ compare\ with\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \ \ \ \ [[2,\ 7],\ [8,\ 2]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ [[200,\ 7],\ [8,\ 300]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ [[28,\ 21],\ [6,\ 1957]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ [[190,\ 800],\ [200,\ 900]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00662}00662\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Some\ tables\ with\ simple\ exact\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (includes\ regression\ test\ for\ ticket\ \#1568):}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ [[0,\ 2],\ [3,\ 0]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ \ \ \ \ [[1,\ 1],\ [2,\ 1]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00666}00666\ \ \ \ \ \ \ \ \ \ \ \ \ [[2,\ 0],\ [1,\ 2]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00667}00667\ \ \ \ \ \ \ \ \ \ \ \ \ [[0,\ 1],\ [2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00668}00668\ \ \ \ \ \ \ \ \ \ \ \ \ [[1,\ 0],\ [1,\ 4]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00669}00669\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00670}00670\ \ \ \ \ \ \ \ \ pvals\ =\ (}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00671}00671\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00672}00672\ \ \ \ \ \ \ \ \ \ \ \ \ [0.018521725952066501,\ 0.9990149169715733],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00673}00673\ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 2.0056578803889148e-\/122],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 5.7284374608319831e-\/44],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00675}00675\ \ \ \ \ \ \ \ \ \ \ \ \ [0.7416227,\ 0.2959826],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00676}00676\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Exact:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00677}00677\ \ \ \ \ \ \ \ \ \ \ \ \ [0.1,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00678}00678\ \ \ \ \ \ \ \ \ \ \ \ \ [0.7,\ 0.9],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00679}00679\ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 0.3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \ \ \ \ [2./3,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 1./3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ table,\ pval\ \textcolor{keywordflow}{in}\ zip(tables,\ pvals):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00684}00684\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00685}00685\ \ \ \ \ \ \ \ \ \ \ \ \ res.append(stats.fisher\_exact(table,\ alternative=\textcolor{stringliteral}{"{}less"{}})[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00686}00686\ \ \ \ \ \ \ \ \ \ \ \ \ res.append(stats.fisher\_exact(table,\ alternative=\textcolor{stringliteral}{"{}greater"{}})[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00687}00687\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res,\ pval,\ atol=0,\ rtol=1e-\/7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00688}00688\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00689}00689\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh3014(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00690}00690\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ if\ issue\ \#3014\ has\ been\ fixed.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00691}00691\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ before,\ this\ would\ have\ risen\ a\ ValueError}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ odds,\ pvalue\ =\ stats.fisher\_exact([[1,\ 2],\ [9,\ 84419233]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00693}00693\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00694}00694\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative"{},\ ['two-\/sided',\ 'less',\ 'greater'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00695}00695\ \ \ \ \ \textcolor{keyword}{def\ }test\_result(self,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ table\ =\ np.array([[14500,\ 20000],\ [30000,\ 40000]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00697}00697\ \ \ \ \ \ \ \ \ res\ =\ stats.fisher\_exact(table,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00698}00698\ \ \ \ \ \ \ \ \ assert\_equal((res.statistic,\ res.pvalue),\ res)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00699}00699\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00700}00700\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00701}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrSpearmanr}{00701}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrSpearmanr}{TestCorrSpearmanr}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00702}00702\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ W.II.D.\ Compute\ a\ correlation\ matrix\ on\ all\ the\ variables.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00703}00703\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00704}00704\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ All\ the\ correlations,\ except\ for\ ZERO\ and\ MISS,\ should\ be\ exactly\ 1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00705}00705\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ZERO\ and\ MISS\ should\ have\ undefined\ or\ missing\ correlations\ with\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00706}00706\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ other\ variables.\ \ The\ same\ should\ go\ for\ SPEARMAN\ correlations,\ if}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00707}00707\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ your\ program\ has\ them.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00708}00708\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00709}00709\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00710}00710\ \ \ \ \ \textcolor{keyword}{def\ }test\_scalar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00711}00711\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(4.,\ 2.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00712}00712\ \ \ \ \ \ \ \ \ assert\_(np.isnan(y).all())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00713}00713\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00714}00714\ \ \ \ \ \textcolor{keyword}{def\ }test\_uneven\_lengths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00715}00715\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ [1,\ 2,\ 1],\ [8,\ 9])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00716}00716\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ [1,\ 2,\ 1],\ 8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00717}00717\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00718}00718\ \ \ \ \ \textcolor{keyword}{def\ }test\_uneven\_2d\_shapes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00719}00719\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Different\ number\ of\ columns\ should\ work\ -\/\ those\ just\ get\ concatenated.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00720}00720\ \ \ \ \ \ \ \ \ np.random.seed(232324)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00721}00721\ \ \ \ \ \ \ \ \ x\ =\ np.random.randn(4,\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00722}00722\ \ \ \ \ \ \ \ \ y\ =\ np.random.randn(4,\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00723}00723\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ stats.spearmanr(x,\ y).statistic.shape\ ==\ (5,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00724}00724\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ stats.spearmanr(x.T,\ y.T,\ axis=1).pvalue.shape\ ==\ (5,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00725}00725\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00726}00726\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ y,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00727}00727\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x.T,\ y.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00728}00728\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00729}00729\ \ \ \ \ \textcolor{keyword}{def\ }test\_ndim\_too\_high(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ np.random.seed(232324)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00731}00731\ \ \ \ \ \ \ \ \ x\ =\ np.random.randn(4,\ 3,\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00735}00735\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ But\ should\ work\ with\ axis=None\ (raveling\ axes)\ for\ two\ input\ arrays}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00736}00736\ \ \ \ \ \ \ \ \ assert\_allclose(stats.spearmanr(x,\ x,\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00737}00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.spearmanr(x.flatten(),\ x.flatten(),\ axis=0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00738}00738\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00739}00739\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00740}00740\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00741}00741\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.spearmanr(x,\ x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.spearmanr(x,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1.0,\ 0.0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00745}00745\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00746}00746\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00747}00747\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00748}00748\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_bug\_12458(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00749}00749\ \ \ \ \ \ \ \ \ np.random.seed(5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00750}00750\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(5,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00751}00751\ \ \ \ \ \ \ \ \ k\ =\ 6}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ x[:,\ k]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00753}00753\ \ \ \ \ \ \ \ \ y\ =\ np.delete(x,\ k,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00754}00754\ \ \ \ \ \ \ \ \ corx,\ px\ =\ stats.spearmanr(x,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00755}00755\ \ \ \ \ \ \ \ \ cory,\ py\ =\ stats.spearmanr(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00756}00756\ \ \ \ \ \ \ \ \ corx\ =\ np.delete(np.delete(corx,\ k,\ axis=1),\ k,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00757}00757\ \ \ \ \ \ \ \ \ px\ =\ np.delete(np.delete(px,\ k,\ axis=1),\ k,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00758}00758\ \ \ \ \ \ \ \ \ assert\_allclose(corx,\ cory,\ atol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00759}00759\ \ \ \ \ \ \ \ \ assert\_allclose(px,\ py,\ atol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00760}00760\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00761}00761\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_bug\_12411(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00762}00762\ \ \ \ \ \ \ \ \ np.random.seed(5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00763}00763\ \ \ \ \ \ \ \ \ m\ =\ 5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00764}00764\ \ \ \ \ \ \ \ \ n\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00765}00765\ \ \ \ \ \ \ \ \ x\ =\ np.random.randn(m,\ n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00766}00766\ \ \ \ \ \ \ \ \ x[1,\ 0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00767}00767\ \ \ \ \ \ \ \ \ x[3,\ -\/1]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00768}00768\ \ \ \ \ \ \ \ \ corr,\ pvalue\ =\ stats.spearmanr(x,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00769}00769\ \ \ \ \ \ \ \ \ res\ =\ [[stats.spearmanr(x[i,\ :],\ x[j,\ :]).statistic\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(m)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00770}00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(m)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00771}00771\ \ \ \ \ \ \ \ \ assert\_allclose(corr,\ res)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00772}00772\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00773}00773\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXX(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00774}00774\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00775}00775\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00776}00776\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00777}00777\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00778}00778\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXBIG(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00779}00779\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,BIG)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00780}00780\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00781}00781\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00782}00782\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00783}00783\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXLITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00784}00784\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00785}00785\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00786}00786\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00787}00787\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00788}00788\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00789}00789\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00790}00790\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00791}00791\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00792}00792\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00793}00793\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00794}00794\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00795}00795\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00796}00796\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00797}00797\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00798}00798\ \ \ \ \ \textcolor{keyword}{def\ }test\_sXROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00799}00799\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(X,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00800}00800\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00801}00801\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00802}00802\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00803}00803\ \ \ \ \ \textcolor{keyword}{def\ }test\_sBIGBIG(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00804}00804\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(BIG,BIG)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00805}00805\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00806}00806\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00807}00807\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00808}00808\ \ \ \ \ \textcolor{keyword}{def\ }test\_sBIGLITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00809}00809\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(BIG,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00810}00810\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00811}00811\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00812}00812\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00813}00813\ \ \ \ \ \textcolor{keyword}{def\ }test\_sBIGHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00814}00814\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(BIG,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00815}00815\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00816}00816\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00817}00817\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00818}00818\ \ \ \ \ \textcolor{keyword}{def\ }test\_sBIGTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00819}00819\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(BIG,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00820}00820\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00821}00821\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00822}00822\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00823}00823\ \ \ \ \ \textcolor{keyword}{def\ }test\_sBIGROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00824}00824\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(BIG,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00825}00825\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00826}00826\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00827}00827\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00828}00828\ \ \ \ \ \textcolor{keyword}{def\ }test\_sLITTLELITTLE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00829}00829\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(LITTLE,LITTLE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00830}00830\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00831}00831\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00832}00832\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00833}00833\ \ \ \ \ \textcolor{keyword}{def\ }test\_sLITTLEHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00834}00834\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(LITTLE,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00835}00835\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00836}00836\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00837}00837\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00838}00838\ \ \ \ \ \textcolor{keyword}{def\ }test\_sLITTLETINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00839}00839\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(LITTLE,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00840}00840\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00841}00841\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00842}00842\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00843}00843\ \ \ \ \ \textcolor{keyword}{def\ }test\_sLITTLEROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00844}00844\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(LITTLE,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00845}00845\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00846}00846\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00847}00847\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00848}00848\ \ \ \ \ \textcolor{keyword}{def\ }test\_sHUGEHUGE(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00849}00849\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(HUGE,HUGE)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00850}00850\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00851}00851\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00852}00852\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00853}00853\ \ \ \ \ \textcolor{keyword}{def\ }test\_sHUGETINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00854}00854\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(HUGE,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00855}00855\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00856}00856\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00857}00857\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00858}00858\ \ \ \ \ \textcolor{keyword}{def\ }test\_sHUGEROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00859}00859\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(HUGE,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00860}00860\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00861}00861\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00862}00862\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00863}00863\ \ \ \ \ \textcolor{keyword}{def\ }test\_sTINYTINY(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00864}00864\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(TINY,TINY)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00865}00865\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00866}00866\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00867}00867\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00868}00868\ \ \ \ \ \textcolor{keyword}{def\ }test\_sTINYROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00869}00869\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(TINY,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00870}00870\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00871}00871\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00872}00872\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00873}00873\ \ \ \ \ \textcolor{keyword}{def\ }test\_sROUNDROUND(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00874}00874\ \ \ \ \ \ \ \ \ y\ =\ stats.spearmanr(ROUND,ROUND)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00875}00875\ \ \ \ \ \ \ \ \ r\ =\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00876}00876\ \ \ \ \ \ \ \ \ assert\_approx\_equal(r,1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00877}00877\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00878}00878\ \ \ \ \ \textcolor{keyword}{def\ }test\_spearmanr\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00879}00879\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(X,\ X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00880}00880\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'correlation'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00881}00881\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00882}00882\ \ \ \ \ \ \ \ \ assert\_equal(res.correlation,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00883}00883\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00884}00884\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_vs\_2d(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00885}00885\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00886}00886\ \ \ \ \ \ \ \ \ x2\ =\ [1,\ 2,\ 3,\ 4,\ 6,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00887}00887\ \ \ \ \ \ \ \ \ res1\ =\ stats.spearmanr(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00888}00888\ \ \ \ \ \ \ \ \ res2\ =\ stats.spearmanr(np.asarray([x1,\ x2]).T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00889}00889\ \ \ \ \ \ \ \ \ assert\_allclose(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00890}00890\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00891}00891\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_vs\_2d\_nans(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00892}00892\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Now\ the\ same\ with\ NaNs\ present.\ \ Regression\ test\ for\ gh-\/9103.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00893}00893\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ nan\_policy\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'propagate'},\ \textcolor{stringliteral}{'omit'}]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00894}00894\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ [1,\ np.nan,\ 3,\ 4,\ 5,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00895}00895\ \ \ \ \ \ \ \ \ \ \ \ \ x2\ =\ [1,\ 2,\ 3,\ 4,\ 6,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00896}00896\ \ \ \ \ \ \ \ \ \ \ \ \ res1\ =\ stats.spearmanr(x1,\ x2,\ nan\_policy=nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00897}00897\ \ \ \ \ \ \ \ \ \ \ \ \ res2\ =\ stats.spearmanr(np.asarray([x1,\ x2]).T,\ nan\_policy=nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00898}00898\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00899}00899\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00900}00900\ \ \ \ \ \textcolor{keyword}{def\ }test\_3cols(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00901}00901\ \ \ \ \ \ \ \ \ x1\ =\ np.arange(6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00902}00902\ \ \ \ \ \ \ \ \ x2\ =\ -\/x1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00903}00903\ \ \ \ \ \ \ \ \ x3\ =\ np.array([0,\ 1,\ 2,\ 3,\ 5,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00904}00904\ \ \ \ \ \ \ \ \ x\ =\ np.asarray([x1,\ x2,\ x3]).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00905}00905\ \ \ \ \ \ \ \ \ actual\ =\ stats.spearmanr(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00906}00906\ \ \ \ \ \ \ \ \ expected\_corr\ =\ np.array([[1,\ -\/1,\ 0.94285714],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00907}00907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1,\ 1,\ -\/0.94285714],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00908}00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.94285714,\ -\/0.94285714,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00909}00909\ \ \ \ \ \ \ \ \ expected\_pvalue\ =\ np.zeros((3,\ 3),\ dtype=float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00910}00910\ \ \ \ \ \ \ \ \ expected\_pvalue[2,\ 0:2]\ =\ 0.00480466472}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00911}00911\ \ \ \ \ \ \ \ \ expected\_pvalue[0:2,\ 2]\ =\ 0.00480466472}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00912}00912\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00913}00913\ \ \ \ \ \ \ \ \ assert\_allclose(actual.statistic,\ expected\_corr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00914}00914\ \ \ \ \ \ \ \ \ assert\_allclose(actual.pvalue,\ expected\_pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00915}00915\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00916}00916\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh\_9103(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00917}00917\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/9103.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00918}00918\ \ \ \ \ \ \ \ \ x\ =\ np.array([[np.nan,\ 3.0,\ 4.0,\ 5.0,\ 5.1,\ 6.0,\ 9.2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00919}00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5.0,\ np.nan,\ 4.1,\ 4.8,\ 4.9,\ 5.0,\ 4.1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00920}00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.5,\ 4.0,\ 7.1,\ 3.8,\ 8.0,\ 5.1,\ 7.6]]).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00921}00921\ \ \ \ \ \ \ \ \ corr\ =\ np.array([[np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00922}00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00923}00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ np.nan,\ 1.]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00924}00924\ \ \ \ \ \ \ \ \ assert\_allclose(stats.spearmanr(x,\ nan\_policy=\textcolor{stringliteral}{'propagate'}).statistic,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00925}00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ corr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00926}00926\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00927}00927\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}).statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00928}00928\ \ \ \ \ \ \ \ \ assert\_allclose((res[0][1],\ res[0][2],\ res[1][2]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00929}00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (0.2051957,\ 0.4857143,\ -\/0.4707919),\ rtol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00930}00930\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00931}00931\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh\_8111(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00932}00932\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/8111\ (different\ result\ for\ float/int/bool).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00933}00933\ \ \ \ \ \ \ \ \ n\ =\ 100}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00934}00934\ \ \ \ \ \ \ \ \ np.random.seed(234568)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00935}00935\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00936}00936\ \ \ \ \ \ \ \ \ m\ =\ np.random.rand(n)\ >\ 0.7}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00937}00937\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00938}00938\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bool\ against\ float,\ no\ nans}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00939}00939\ \ \ \ \ \ \ \ \ a\ =\ (x\ >\ .5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00940}00940\ \ \ \ \ \ \ \ \ b\ =\ np.array(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00941}00941\ \ \ \ \ \ \ \ \ res1\ =\ stats.spearmanr(a,\ b,\ nan\_policy=\textcolor{stringliteral}{'omit'}).statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00942}00942\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00943}00943\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bool\ against\ float\ with\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00944}00944\ \ \ \ \ \ \ \ \ b[m]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00945}00945\ \ \ \ \ \ \ \ \ res2\ =\ stats.spearmanr(a,\ b,\ nan\_policy=\textcolor{stringliteral}{'omit'}).statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00946}00946\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00947}00947\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ int\ against\ float\ with\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00948}00948\ \ \ \ \ \ \ \ \ a\ =\ a.astype(np.int32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00949}00949\ \ \ \ \ \ \ \ \ res3\ =\ stats.spearmanr(a,\ b,\ nan\_policy=\textcolor{stringliteral}{'omit'}).statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00950}00950\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00951}00951\ \ \ \ \ \ \ \ \ expected\ =\ [0.865895477,\ 0.866100381,\ 0.866100381]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00952}00952\ \ \ \ \ \ \ \ \ assert\_allclose([res1,\ res2,\ res3],\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00953}00953\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00954}00954\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00955}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrSpearmanr2}{00955}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestCorrSpearmanr2}{TestCorrSpearmanr2}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00956}00956\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Some\ further\ tests\ of\ the\ spearmanr\ function."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00957}00957\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00958}00958\ \ \ \ \ \textcolor{keyword}{def\ }test\_spearmanr\_vs\_r(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00959}00959\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00960}00960\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cor.test(c(1,2,3,4,5),c(5,6,7,8,7),method="{}spearmanr"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00961}00961\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00962}00962\ \ \ \ \ \ \ \ \ x2\ =\ [5,\ 6,\ 7,\ 8,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00963}00963\ \ \ \ \ \ \ \ \ expected\ =\ (0.82078268166812329,\ 0.088587005313543798)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00964}00964\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00965}00965\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00966}00966\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00967}00967\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00968}00968\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_arrays(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00969}00969\ \ \ \ \ \ \ \ \ assert\_equal(stats.spearmanr([],\ []),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00970}00970\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00971}00971\ \ \ \ \ \textcolor{keyword}{def\ }test\_normal\_draws(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00972}00972\ \ \ \ \ \ \ \ \ np.random.seed(7546)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00973}00973\ \ \ \ \ \ \ \ \ x\ =\ np.array([np.random.normal(loc=1,\ scale=1,\ size=500),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00974}00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.random.normal(loc=1,\ scale=1,\ size=500)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00975}00975\ \ \ \ \ \ \ \ \ corr\ =\ [[1.0,\ 0.3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00976}00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.3,\ 1.0]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00977}00977\ \ \ \ \ \ \ \ \ x\ =\ np.dot(np.linalg.cholesky(corr),\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00978}00978\ \ \ \ \ \ \ \ \ expected\ =\ (0.28659685838743354,\ 6.579862219051161e-\/11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00979}00979\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(x[0],\ x[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00980}00980\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00981}00981\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00982}00982\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00983}00983\ \ \ \ \ \textcolor{keyword}{def\ }test\_corr\_1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00984}00984\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stats.spearmanr([1,\ 1,\ 2],\ [1,\ 1,\ 2])[0],\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00985}00985\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00986}00986\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policies(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00987}00987\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00988}00988\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00989}00989\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.spearmanr(x,\ x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00990}00990\ \ \ \ \ \ \ \ \ assert\_allclose(stats.spearmanr(x,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00991}00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1.0,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00992}00992\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00993}00993\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00994}00994\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00995}00995\ \ \ \ \ \textcolor{keyword}{def\ }test\_unequal\_lengths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00996}00996\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00997}00997\ \ \ \ \ \ \ \ \ y\ =\ np.arange(20.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00998}00998\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l00999}00999\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01000}01000\ \ \ \ \ \textcolor{keyword}{def\ }test\_omit\_paired\_value(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01001}01001\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01002}01002\ \ \ \ \ \ \ \ \ x2\ =\ [8,\ 7,\ 6,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01003}01003\ \ \ \ \ \ \ \ \ res1\ =\ stats.spearmanr(x1,\ x2,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01004}01004\ \ \ \ \ \ \ \ \ res2\ =\ stats.spearmanr(x1[:3],\ x2[:3],\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01005}01005\ \ \ \ \ \ \ \ \ assert\_equal(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01006}01006\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01007}01007\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh\_issue\_6061\_windows\_overflow(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01008}01008\ \ \ \ \ \ \ \ \ x\ =\ list(range(2000))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01009}01009\ \ \ \ \ \ \ \ \ y\ =\ list(range(2000))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01010}01010\ \ \ \ \ \ \ \ \ y[0],\ y[9]\ =\ y[9],\ y[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01011}01011\ \ \ \ \ \ \ \ \ y[10],\ y[434]\ =\ y[434],\ y[10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01012}01012\ \ \ \ \ \ \ \ \ y[435],\ y[1509]\ =\ y[1509],\ y[435]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01013}01013\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rho\ =\ 1\ -\/\ 6\ *\ (2\ *\ (9\string^2\ +\ 424\string^2\ +\ 1074\string^2))/(2000\ *\ (2000\string^2\ -\/\ 1))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01014}01014\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ =\ 1\ -\/\ (1\ /\ 500)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01015}01015\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ =\ 0.998}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01016}01016\ \ \ \ \ \ \ \ \ x.append(np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01017}01017\ \ \ \ \ \ \ \ \ y.append(3.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01018}01018\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.spearmanr(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'})[0],\ 0.998)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01019}01019\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01020}01020\ \ \ \ \ \textcolor{keyword}{def\ }test\_tie0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01021}01021\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ only\ ties\ in\ one\ or\ both\ inputs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01022}01022\ \ \ \ \ \ \ \ \ warn\_msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ constant"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01023}01023\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=warn\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01024}01024\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr([2,\ 2,\ 2],\ [2,\ 2,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01025}01025\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01026}01026\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01027}01027\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr([2,\ 0,\ 2],\ [2,\ 2,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01028}01028\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01029}01029\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01030}01030\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr([2,\ 2,\ 2],\ [2,\ 0,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01031}01031\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01032}01032\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01033}01033\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01034}01034\ \ \ \ \ \textcolor{keyword}{def\ }test\_tie1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01035}01035\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Data}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01036}01036\ \ \ \ \ \ \ \ \ x\ =\ [1.0,\ 2.0,\ 3.0,\ 4.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01037}01037\ \ \ \ \ \ \ \ \ y\ =\ [1.0,\ 2.0,\ 2.0,\ 3.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01038}01038\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ranks\ of\ the\ data,\ with\ tie-\/handling.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01039}01039\ \ \ \ \ \ \ \ \ xr\ =\ [1.0,\ 2.0,\ 3.0,\ 4.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01040}01040\ \ \ \ \ \ \ \ \ yr\ =\ [1.0,\ 2.5,\ 2.5,\ 4.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01041}01041\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Result\ of\ spearmanr\ should\ be\ the\ same\ as\ applying}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01042}01042\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ pearsonr\ to\ the\ ranks.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01043}01043\ \ \ \ \ \ \ \ \ sr\ =\ stats.spearmanr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01044}01044\ \ \ \ \ \ \ \ \ pr\ =\ stats.pearsonr(xr,\ yr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01045}01045\ \ \ \ \ \ \ \ \ assert\_almost\_equal(sr,\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01046}01046\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01047}01047\ \ \ \ \ \textcolor{keyword}{def\ }test\_tie2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01048}01048\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ tie-\/handling\ if\ inputs\ contain\ nan's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01049}01049\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Data\ without\ nan's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01050}01050\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 2.5,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01051}01051\ \ \ \ \ \ \ \ \ y1\ =\ [1,\ 3,\ 2.5,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01052}01052\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Same\ data\ with\ nan's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01053}01053\ \ \ \ \ \ \ \ \ x2\ =\ [1,\ 2,\ 2.5,\ 2,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01054}01054\ \ \ \ \ \ \ \ \ y2\ =\ [1,\ 3,\ 2.5,\ 4,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01055}01055\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01056}01056\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Results\ for\ two\ data\ sets\ should\ be\ the\ same\ if\ nan's\ are\ ignored}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01057}01057\ \ \ \ \ \ \ \ \ sr1\ =\ stats.spearmanr(x1,\ y1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01058}01058\ \ \ \ \ \ \ \ \ sr2\ =\ stats.spearmanr(x2,\ y2,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01059}01059\ \ \ \ \ \ \ \ \ assert\_almost\_equal(sr1,\ sr2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01060}01060\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01061}01061\ \ \ \ \ \textcolor{keyword}{def\ }test\_ties\_axis\_1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01062}01062\ \ \ \ \ \ \ \ \ z1\ =\ np.array([[1,\ 1,\ 1,\ 1],\ [1,\ 2,\ 3,\ 4]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01063}01063\ \ \ \ \ \ \ \ \ z2\ =\ np.array([[1,\ 2,\ 3,\ 4],\ [1,\ 1,\ 1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01064}01064\ \ \ \ \ \ \ \ \ z3\ =\ np.array([[1,\ 1,\ 1,\ 1],\ [1,\ 1,\ 1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01065}01065\ \ \ \ \ \ \ \ \ warn\_msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ constant"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01066}01066\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=warn\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01067}01067\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr(z1,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01068}01068\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01069}01069\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01070}01070\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr(z2,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01071}01071\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01072}01072\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01073}01073\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr(z3,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01074}01074\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01075}01075\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01076}01076\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01077}01077\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh\_11111(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01078}01078\ \ \ \ \ \ \ \ \ x\ =\ np.array([1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01079}01079\ \ \ \ \ \ \ \ \ y\ =\ np.array([0,\ 0.009783728115345005,\ 0,\ 0,\ 0.0019759230121848587,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01080}01080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0007535430349118562,\ 0.0002661781514710257,\ 0,\ 0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01081}01081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0007835762419683435])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01082}01082\ \ \ \ \ \ \ \ \ warn\_msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ constant"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01083}01083\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=warn\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01084}01084\ \ \ \ \ \ \ \ \ \ \ \ \ r,\ p\ =\ stats.spearmanr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01085}01085\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(r,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01086}01086\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01087}01087\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01088}01088\ \ \ \ \ \textcolor{keyword}{def\ }test\_index\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01089}01089\ \ \ \ \ \ \ \ \ x\ =\ np.array([1.0,\ 7.0,\ 2.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0,\ 1.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01090}01090\ \ \ \ \ \ \ \ \ y\ =\ np.array([0,\ 0.009783728115345005,\ 0,\ 0,\ 0.0019759230121848587,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01091}01091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0007535430349118562,\ 0.0002661781514710257,\ 0,\ 0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01092}01092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0007835762419683435])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01093}01093\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.spearmanr,\ x,\ y,\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01094}01094\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01095}01095\ \ \ \ \ \textcolor{keyword}{def\ }test\_alternative(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01096}01096\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ alternative\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01097}01097\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01098}01098\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Simple\ test\ -\/\ Based\ on\ the\ above\ \`{}\`{}test\_spearmanr\_vs\_r``}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01099}01099\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01100}01100\ \ \ \ \ \ \ \ \ x2\ =\ [5,\ 6,\ 7,\ 8,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01101}01101\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01102}01102\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ strong\ positive\ correlation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01103}01103\ \ \ \ \ \ \ \ \ expected\ =\ (0.82078268166812329,\ 0.088587005313543798)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01104}01104\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01105}01105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ correlation\ >\ 0\ -\/>\ large\ "{}less"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01106}01106\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01107}01107\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01108}01108\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ 1\ -\/\ (expected[1]\ /\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01109}01109\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01110}01110\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ correlation\ >\ 0\ -\/>\ small\ "{}less"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01111}01111\ \ \ \ \ \ \ \ \ res\ =\ stats.spearmanr(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01112}01112\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01113}01113\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1]\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01114}01114\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01115}01115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}alternative\ must\ be\ 'less'..."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01116}01116\ \ \ \ \ \ \ \ \ \ \ \ \ stats.spearmanr(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}ekki-\/ekki"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01117}01117\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01118}01118\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative"{},\ ('two-\/sided',\ 'less',\ 'greater')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01119}01119\ \ \ \ \ \textcolor{keyword}{def\ }test\_alternative\_nan\_policy(self,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01120}01120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ nan\ policies}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01121}01121\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01122}01122\ \ \ \ \ \ \ \ \ x2\ =\ [5,\ 6,\ 7,\ 8,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01123}01123\ \ \ \ \ \ \ \ \ x1nan\ =\ x1\ +\ [np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01124}01124\ \ \ \ \ \ \ \ \ x2nan\ =\ x2\ +\ [np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01125}01125\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01126}01126\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}propagate"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01127}01127\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.spearmanr(x1nan,\ x2nan),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01128}01128\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01129}01129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}omit"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01130}01130\ \ \ \ \ \ \ \ \ res\_actual\ =\ stats.spearmanr(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01131}01131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01132}01132\ \ \ \ \ \ \ \ \ res\_expected\ =\ stats.spearmanr(x1,\ x2,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01133}01133\ \ \ \ \ \ \ \ \ assert\_allclose(res\_actual,\ res\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01134}01134\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01135}01135\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}raise"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01136}01136\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{'The\ input\ contains\ nan\ values'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01137}01137\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01138}01138\ \ \ \ \ \ \ \ \ \ \ \ \ stats.spearmanr(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'raise'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01139}01139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01140}01140\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01141}01141\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ invalid\ nan\_policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01142}01142\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}nan\_policy\ must\ be\ one\ of..."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01143}01143\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01144}01144\ \ \ \ \ \ \ \ \ \ \ \ \ stats.spearmanr(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'ekki-\/ekki'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01145}01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01146}01146\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01147}01147\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01148}01148\ \textcolor{comment}{\#\ \ \ \ W.II.E.\ \ Tabulate\ X\ against\ X,\ using\ BIG\ as\ a\ case\ weight.\ \ The\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01149}01149\ \textcolor{comment}{\#\ \ \ \ should\ appear\ on\ the\ diagonal\ and\ the\ total\ should\ be\ 899999955.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01150}01150\ \textcolor{comment}{\#\ \ \ \ If\ the\ table\ cannot\ hold\ these\ values,\ forget\ about\ working\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01151}01151\ \textcolor{comment}{\#\ \ \ \ census\ data.\ \ You\ can\ also\ tabulate\ HUGE\ against\ TINY.\ \ There\ is\ no}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01152}01152\ \textcolor{comment}{\#\ \ \ \ reason\ a\ tabulation\ program\ should\ not\ be\ able\ to\ distinguish}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01153}01153\ \textcolor{comment}{\#\ \ \ \ different\ values\ regardless\ of\ their\ magnitude.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01154}01154\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01155}01155\ \textcolor{comment}{\#\ I\ need\ to\ figure\ out\ how\ to\ do\ this\ one.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01156}01156\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01157}01157\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01158}01158\ \textcolor{keyword}{def\ }test\_kendalltau():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01159}01159\ \ \ \ \ \textcolor{comment}{\#\ For\ the\ cases\ without\ ties,\ both\ variants\ should\ give\ the\ same}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01160}01160\ \ \ \ \ \textcolor{comment}{\#\ result.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01161}01161\ \ \ \ \ variants\ =\ (\textcolor{stringliteral}{'b'},\ \textcolor{stringliteral}{'c'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01162}01162\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01163}01163\ \ \ \ \ \textcolor{comment}{\#\ case\ without\ ties,\ con-\/dis\ equal\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01164}01164\ \ \ \ \ x\ =\ [5,\ 2,\ 1,\ 3,\ 6,\ 4,\ 7,\ 8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01165}01165\ \ \ \ \ y\ =\ [5,\ 2,\ 6,\ 3,\ 1,\ 8,\ 7,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01166}01166\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01167}01167\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01168}01168\ \ \ \ \ expected\ =\ (0.0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01169}01169\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01170}01170\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01171}01171\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01172}01172\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01173}01173\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01174}01174\ \ \ \ \ \textcolor{comment}{\#\ case\ without\ ties,\ con-\/dis\ equal\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01175}01175\ \ \ \ \ x\ =\ [0,\ 5,\ 2,\ 1,\ 3,\ 6,\ 4,\ 7,\ 8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01176}01176\ \ \ \ \ y\ =\ [5,\ 2,\ 0,\ 6,\ 3,\ 1,\ 8,\ 7,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01177}01177\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01178}01178\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01179}01179\ \ \ \ \ expected\ =\ (0.0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01180}01180\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01181}01181\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01182}01182\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01183}01183\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01184}01184\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01185}01185\ \ \ \ \ \textcolor{comment}{\#\ case\ without\ ties,\ con-\/dis\ close\ to\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01186}01186\ \ \ \ \ x\ =\ [5,\ 2,\ 1,\ 3,\ 6,\ 4,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01187}01187\ \ \ \ \ y\ =\ [5,\ 2,\ 6,\ 3,\ 1,\ 7,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01188}01188\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01189}01189\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01190}01190\ \ \ \ \ expected\ =\ (-\/0.14285714286,\ 0.77261904762)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01191}01191\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01192}01192\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01193}01193\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01194}01194\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01195}01195\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01196}01196\ \ \ \ \ \textcolor{comment}{\#\ case\ without\ ties,\ con-\/dis\ close\ to\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01197}01197\ \ \ \ \ x\ =\ [2,\ 1,\ 3,\ 6,\ 4,\ 7,\ 8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01198}01198\ \ \ \ \ y\ =\ [2,\ 6,\ 3,\ 1,\ 8,\ 7,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01199}01199\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01200}01200\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01201}01201\ \ \ \ \ expected\ =\ (0.047619047619,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01202}01202\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01203}01203\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01204}01204\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01205}01205\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01206}01206\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01207}01207\ \ \ \ \ \textcolor{comment}{\#\ simple\ case\ without\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01208}01208\ \ \ \ \ x\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01209}01209\ \ \ \ \ y\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01210}01210\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01211}01211\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01212}01212\ \ \ \ \ expected\ =\ (1.0,\ 5.511463844797e-\/07)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01213}01213\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01214}01214\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01215}01215\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01216}01216\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01217}01217\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01218}01218\ \ \ \ \ \textcolor{comment}{\#\ swap\ a\ couple\ of\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01219}01219\ \ \ \ \ b\ =\ y[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01220}01220\ \ \ \ \ y[1]\ =\ y[2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01221}01221\ \ \ \ \ y[2]\ =\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01222}01222\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01223}01223\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01224}01224\ \ \ \ \ expected\ =\ (0.9555555555555556,\ 5.511463844797e-\/06)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01225}01225\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01226}01226\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01227}01227\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01228}01228\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01229}01229\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01230}01230\ \ \ \ \ \textcolor{comment}{\#\ swap\ a\ couple\ more}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01231}01231\ \ \ \ \ b\ =\ y[5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01232}01232\ \ \ \ \ y[5]\ =\ y[6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01233}01233\ \ \ \ \ y[6]\ =\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01234}01234\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01235}01235\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01236}01236\ \ \ \ \ expected\ =\ (0.9111111111111111,\ 2.976190476190e-\/05)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01237}01237\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01238}01238\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01239}01239\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01240}01240\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01241}01241\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01242}01242\ \ \ \ \ \textcolor{comment}{\#\ same\ in\ opposite\ direction}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01243}01243\ \ \ \ \ x\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01244}01244\ \ \ \ \ y\ =\ np.arange(10)[::-\/1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01245}01245\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01246}01246\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01247}01247\ \ \ \ \ expected\ =\ (-\/1.0,\ 5.511463844797e-\/07)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01248}01248\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01249}01249\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01250}01250\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01251}01251\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01252}01252\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01253}01253\ \ \ \ \ \textcolor{comment}{\#\ swap\ a\ couple\ of\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01254}01254\ \ \ \ \ b\ =\ y[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01255}01255\ \ \ \ \ y[1]\ =\ y[2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01256}01256\ \ \ \ \ y[2]\ =\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01257}01257\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01258}01258\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01259}01259\ \ \ \ \ expected\ =\ (-\/0.9555555555555556,\ 5.511463844797e-\/06)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01260}01260\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01261}01261\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01262}01262\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01263}01263\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01264}01264\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01265}01265\ \ \ \ \ \textcolor{comment}{\#\ swap\ a\ couple\ more}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01266}01266\ \ \ \ \ b\ =\ y[5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01267}01267\ \ \ \ \ y[5]\ =\ y[6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01268}01268\ \ \ \ \ y[6]\ =\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01269}01269\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ exact\ result\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01270}01270\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,y,method="{}kendall"{},exact=1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01271}01271\ \ \ \ \ expected\ =\ (-\/0.9111111111111111,\ 2.976190476190e-\/05)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01272}01272\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01273}01273\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01274}01274\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01275}01275\ \ \ \ \ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01276}01276\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01277}01277\ \ \ \ \ \textcolor{comment}{\#\ Check\ a\ case\ where\ variants\ are\ different}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01278}01278\ \ \ \ \ \textcolor{comment}{\#\ Example\ values\ found\ from\ Kendall\ (1970).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01279}01279\ \ \ \ \ \textcolor{comment}{\#\ P-\/value\ is\ the\ same\ for\ the\ both\ variants}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01280}01280\ \ \ \ \ x\ =\ array([1,\ 2,\ 2,\ 4,\ 4,\ 6,\ 6,\ 8,\ 9,\ 9])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01281}01281\ \ \ \ \ y\ =\ array([1,\ 2,\ 4,\ 4,\ 4,\ 4,\ 8,\ 8,\ 8,\ 10])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01282}01282\ \ \ \ \ expected\ =\ 0.85895569}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01283}01283\ \ \ \ \ assert\_approx\_equal(stats.kendalltau(x,\ y,\ variant=\textcolor{stringliteral}{'b'})[0],\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01284}01284\ \ \ \ \ expected\ =\ 0.825}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01285}01285\ \ \ \ \ assert\_approx\_equal(stats.kendalltau(x,\ y,\ variant=\textcolor{stringliteral}{'c'})[0],\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01286}01286\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01287}01287\ \ \ \ \ \textcolor{comment}{\#\ check\ exception\ in\ case\ of\ ties\ and\ method='exact'\ requested}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01288}01288\ \ \ \ \ y[2]\ =\ y[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01289}01289\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ y,\ method=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01290}01290\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01291}01291\ \ \ \ \ \textcolor{comment}{\#\ check\ exception\ in\ case\ of\ invalid\ method\ keyword}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01292}01292\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ y,\ method=\textcolor{stringliteral}{'banana'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01293}01293\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01294}01294\ \ \ \ \ \textcolor{comment}{\#\ check\ exception\ in\ case\ of\ invalid\ variant\ keyword}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01295}01295\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ y,\ variant=\textcolor{stringliteral}{'rms'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01296}01296\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01297}01297\ \ \ \ \ \textcolor{comment}{\#\ tau-\/b\ with\ some\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01298}01298\ \ \ \ \ \textcolor{comment}{\#\ Cross-\/check\ with\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01299}01299\ \ \ \ \ \textcolor{comment}{\#\ cor.test(c(12,2,1,12,2),c(1,4,7,1,0),method="{}kendall"{},exact=FALSE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01300}01300\ \ \ \ \ x1\ =\ [12,\ 2,\ 1,\ 12,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01301}01301\ \ \ \ \ x2\ =\ [1,\ 4,\ 7,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01302}01302\ \ \ \ \ expected\ =\ (-\/0.47140452079103173,\ 0.28274545993277478)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01303}01303\ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01304}01304\ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01305}01305\ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01306}01306\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01307}01307\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01308}01308\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'correlation'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01309}01309\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01310}01310\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2,\ variant=taux)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01311}01311\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01312}01312\ \ \ \ \ \ \ \ \ assert\_equal(res.correlation,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01313}01313\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01314}01314\ \ \ \ \ \textcolor{comment}{\#\ with\ only\ ties\ in\ one\ or\ both\ inputs\ in\ tau-\/b\ or\ tau-\/c}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01315}01315\ \ \ \ \ \textcolor{keywordflow}{for}\ taux\ \textcolor{keywordflow}{in}\ variants:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01316}01316\ \ \ \ \ \ \ \ \ assert\_equal(stats.kendalltau([2,\ 2,\ 2],\ [2,\ 2,\ 2],\ variant=taux),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01317}01317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01318}01318\ \ \ \ \ \ \ \ \ assert\_equal(stats.kendalltau([2,\ 0,\ 2],\ [2,\ 2,\ 2],\ variant=taux),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01319}01319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01320}01320\ \ \ \ \ \ \ \ \ assert\_equal(stats.kendalltau([2,\ 2,\ 2],\ [2,\ 0,\ 2],\ variant=taux),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01321}01321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01322}01322\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01323}01323\ \ \ \ \ \textcolor{comment}{\#\ empty\ arrays\ provided\ as\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01324}01324\ \ \ \ \ assert\_equal(stats.kendalltau([],\ []),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01325}01325\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01326}01326\ \ \ \ \ \textcolor{comment}{\#\ check\ with\ larger\ arrays}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01327}01327\ \ \ \ \ np.random.seed(7546)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01328}01328\ \ \ \ \ x\ =\ np.array([np.random.normal(loc=1,\ scale=1,\ size=500),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01329}01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.random.normal(loc=1,\ scale=1,\ size=500)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01330}01330\ \ \ \ \ corr\ =\ [[1.0,\ 0.3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01331}01331\ \ \ \ \ \ \ \ \ \ \ \ \ [0.3,\ 1.0]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01332}01332\ \ \ \ \ x\ =\ np.dot(np.linalg.cholesky(corr),\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01333}01333\ \ \ \ \ expected\ =\ (0.19291382765531062,\ 1.1337095377742629e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01334}01334\ \ \ \ \ res\ =\ stats.kendalltau(x[0],\ x[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01335}01335\ \ \ \ \ assert\_approx\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01336}01336\ \ \ \ \ assert\_approx\_equal(res[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01337}01337\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01338}01338\ \ \ \ \ \textcolor{comment}{\#\ this\ should\ result\ in\ 1\ for\ taub\ but\ not\ tau-\/c}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01339}01339\ \ \ \ \ assert\_approx\_equal(stats.kendalltau([1,\ 1,\ 2],\ [1,\ 1,\ 2],\ variant=\textcolor{stringliteral}{'b'})[0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01340}01340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01341}01341\ \ \ \ \ assert\_approx\_equal(stats.kendalltau([1,\ 1,\ 2],\ [1,\ 1,\ 2],\ variant=\textcolor{stringliteral}{'c'})[0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01342}01342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.88888888)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01343}01343\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01344}01344\ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01345}01345\ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01346}01346\ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01347}01347\ \ \ \ \ assert\_array\_equal(stats.kendalltau(x,\ x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01348}01348\ \ \ \ \ assert\_allclose(stats.kendalltau(x,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01349}01349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1.0,\ 5.5114638e-\/6),\ rtol=1e-\/06)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01350}01350\ \ \ \ \ assert\_allclose(stats.kendalltau(x,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ method=\textcolor{stringliteral}{'asymptotic'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01351}01351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1.0,\ 0.00017455009626808976),\ rtol=1e-\/06)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01352}01352\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01353}01353\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01354}01354\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01355}01355\ \ \ \ \ \textcolor{comment}{\#\ test\ unequal\ length\ inputs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01356}01356\ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01357}01357\ \ \ \ \ y\ =\ np.arange(20.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01358}01358\ \ \ \ \ assert\_raises(ValueError,\ stats.kendalltau,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01359}01359\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01360}01360\ \ \ \ \ \textcolor{comment}{\#\ test\ all\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01361}01361\ \ \ \ \ tau,\ p\_value\ =\ stats.kendalltau([],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01362}01362\ \ \ \ \ assert\_equal(np.nan,\ tau)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01363}01363\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01364}01364\ \ \ \ \ tau,\ p\_value\ =\ stats.kendalltau([0],\ [0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01365}01365\ \ \ \ \ assert\_equal(np.nan,\ tau)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01366}01366\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01367}01367\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01368}01368\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ GitHub\ issue\ \#6061\ -\/\ Overflow\ on\ Windows}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01369}01369\ \ \ \ \ x\ =\ np.arange(2000,\ dtype=float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01370}01370\ \ \ \ \ x\ =\ np.ma.masked\_greater(x,\ 1995)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01371}01371\ \ \ \ \ y\ =\ np.arange(2000,\ dtype=float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01372}01372\ \ \ \ \ y\ =\ np.concatenate((y[1000:],\ y[:1000]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01373}01373\ \ \ \ \ assert\_(np.isfinite(stats.kendalltau(x,y)[1]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01374}01374\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01375}01375\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01376}01376\ \textcolor{keyword}{def\ }test\_kendalltau\_vs\_mstats\_basic():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01377}01377\ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01378}01378\ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ range(2,10):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01379}01379\ \ \ \ \ \ \ \ \ a\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01380}01380\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ rankings\ with\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01381}01381\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(s):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01382}01382\ \ \ \ \ \ \ \ \ \ \ \ \ a\ +=\ [i]*i}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01383}01383\ \ \ \ \ \ \ \ \ b\ =\ list(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01384}01384\ \ \ \ \ \ \ \ \ np.random.shuffle(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01385}01385\ \ \ \ \ \ \ \ \ np.random.shuffle(b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01386}01386\ \ \ \ \ \ \ \ \ expected\ =\ mstats\_basic.kendalltau(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01387}01387\ \ \ \ \ \ \ \ \ actual\ =\ stats.kendalltau(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01388}01388\ \ \ \ \ \ \ \ \ assert\_approx\_equal(actual[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01389}01389\ \ \ \ \ \ \ \ \ assert\_approx\_equal(actual[1],\ expected[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01390}01390\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01391}01391\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01392}01392\ \textcolor{keyword}{def\ }test\_kendalltau\_nan\_2nd\_arg():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01393}01393\ \ \ \ \ \textcolor{comment}{\#\ regression\ test\ for\ gh-\/6134:\ nans\ in\ the\ second\ arg\ were\ not\ handled}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01394}01394\ \ \ \ \ x\ =\ [1.,\ 2.,\ 3.,\ 4.]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01395}01395\ \ \ \ \ y\ =\ [np.nan,\ 2.4,\ 3.4,\ 3.4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01396}01396\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01397}01397\ \ \ \ \ r1\ =\ stats.kendalltau(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01398}01398\ \ \ \ \ r2\ =\ stats.kendalltau(x[1:],\ y[1:])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01399}01399\ \ \ \ \ assert\_allclose(r1.statistic,\ r2.statistic,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01400}01400\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01401}01401\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01402}01402\ \textcolor{keyword}{def\ }test\_kendalltau\_dep\_initial\_lexsort():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01403}01403\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01404}01404\ \ \ \ \ \ \ \ \ DeprecationWarning,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01405}01405\ \ \ \ \ \ \ \ \ match=\textcolor{stringliteral}{"{}'kendalltau'\ keyword\ argument\ 'initial\_lexsort'"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01406}01406\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01407}01407\ \ \ \ \ \ \ \ \ stats.kendalltau([],\ [],\ initial\_lexsort=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01408}01408\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01409}01409\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01410}01410\ \textcolor{keyword}{def\ }test\_kendalltau\_gh18139\_overflow():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01411}01411\ \ \ \ \ \textcolor{comment}{\#\ gh-\/18139\ reported\ an\ overflow\ in\ \`{}kendalltau`\ that\ appeared\ after}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01412}01412\ \ \ \ \ \textcolor{comment}{\#\ SciPy\ 0.15.1.\ Check\ that\ this\ particular\ overflow\ does\ not\ occur.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01413}01413\ \ \ \ \ \textcolor{comment}{\#\ (Test\ would\ fail\ if\ warning\ were\ emitted.)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01414}01414\ \ \ \ \ \textcolor{keyword}{import}\ random}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01415}01415\ \ \ \ \ random.seed(6272161)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01416}01416\ \ \ \ \ classes\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01417}01417\ \ \ \ \ n\_samples\ =\ 2\ *\ 10\ **\ 5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01418}01418\ \ \ \ \ x\ =\ random.choices(classes,\ k=n\_samples)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01419}01419\ \ \ \ \ y\ =\ random.choices(classes,\ k=n\_samples)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01420}01420\ \ \ \ \ res\ =\ stats.kendalltau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01421}01421\ \ \ \ \ \textcolor{comment}{\#\ Reference\ value\ from\ SciPy\ 0.15.1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01422}01422\ \ \ \ \ assert\_allclose(res.statistic,\ 0.0011816493905730343)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01423}01423\ \ \ \ \ \textcolor{comment}{\#\ Reference\ p-\/value\ from\ \`{}permutation\_test`\ w/\ n\_resamples=9999\ (default).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01424}01424\ \ \ \ \ \textcolor{comment}{\#\ Expected\ to\ be\ accurate\ to\ at\ least\ two\ digits.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01425}01425\ \ \ \ \ assert\_allclose(res.pvalue,\ 0.4894,\ atol=2e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01426}01426\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01427}01427\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01428}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative}{01428}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative}{TestKendallTauAlternative}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01429}01429\ \ \ \ \ \textcolor{keyword}{def\ }test\_kendalltau\_alternative\_asymptotic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01430}01430\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ alternative\ parameter,\ asymptotic\ method\ (due\ to\ tie)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01431}01431\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01432}01432\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Based\ on\ TestCorrSpearman2::test\_alternative}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01433}01433\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01434}01434\ \ \ \ \ \ \ \ \ x2\ =\ [5,\ 6,\ 7,\ 8,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01435}01435\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01436}01436\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ strong\ positive\ correlation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01437}01437\ \ \ \ \ \ \ \ \ expected\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01438}01438\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ expected[0]\ >\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01439}01439\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01440}01440\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rank\ correlation\ >\ 0\ -\/>\ large\ "{}less"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01441}01441\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01442}01442\ \ \ \ \ \ \ \ \ assert\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01443}01443\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 1\ -\/\ (expected[1]\ /\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01444}01444\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01445}01445\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rank\ correlation\ >\ 0\ -\/>\ small\ "{}greater"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01446}01446\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01447}01447\ \ \ \ \ \ \ \ \ assert\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01448}01448\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ expected[1]\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01449}01449\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01450}01450\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ reverse\ the\ direction\ of\ rank\ correlation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01451}01451\ \ \ \ \ \ \ \ \ x2.reverse()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01452}01452\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01453}01453\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ strong\ negative\ correlation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01454}01454\ \ \ \ \ \ \ \ \ expected\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01455}01455\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ expected[0]\ <\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01456}01456\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01457}01457\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rank\ correlation\ <\ 0\ -\/>\ large\ "{}greater"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01458}01458\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01459}01459\ \ \ \ \ \ \ \ \ assert\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01460}01460\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 1\ -\/\ (expected[1]\ /\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01461}01461\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01462}01462\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ rank\ correlation\ <\ 0\ -\/>\ small\ "{}less"{}\ p-\/value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01463}01463\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01464}01464\ \ \ \ \ \ \ \ \ assert\_equal(res[0],\ expected[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01465}01465\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ expected[1]\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01466}01466\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01467}01467\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}alternative\ must\ be\ 'less'..."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01468}01468\ \ \ \ \ \ \ \ \ \ \ \ \ stats.kendalltau(x1,\ x2,\ alternative=\textcolor{stringliteral}{"{}ekki-\/ekki"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01469}01469\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01470}01470\ \ \ \ \ \textcolor{comment}{\#\ There\ are\ a\ lot\ of\ special\ cases\ considered\ in\ the\ calculation\ of\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01471}01471\ \ \ \ \ \textcolor{comment}{\#\ exact\ p-\/value,\ so\ we\ test\ each\ separately.\ We\ also\ need\ to\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01472}01472\ \ \ \ \ \textcolor{comment}{\#\ separately\ when\ the\ observed\ statistic\ is\ in\ the\ left\ tail\ vs\ the\ right}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01473}01473\ \ \ \ \ \textcolor{comment}{\#\ tail\ because\ the\ code\ leverages\ symmetry\ of\ the\ null\ distribution;\ to}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01474}01474\ \ \ \ \ \textcolor{comment}{\#\ do\ that\ we\ use\ the\ same\ test\ case\ but\ negate\ one\ of\ the\ samples.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01475}01475\ \ \ \ \ \textcolor{comment}{\#\ Reference\ values\ computed\ using\ R\ cor.test,\ e.g.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01476}01476\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01477}01477\ \ \ \ \ \textcolor{comment}{\#\ x\ <-\/\ c(44.4,\ 45.9,\ 41.9,\ 53.3,\ 44.7,\ 44.1,\ 50.7,\ 45.2,\ 60.1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01478}01478\ \ \ \ \ \textcolor{comment}{\#\ y\ <-\/\ c(\ 2.6,\ \ 3.1,\ \ 2.5,\ \ 5.0,\ \ 3.6,\ \ 4.0,\ \ 5.2,\ \ 2.8,\ \ 3.8)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01479}01479\ \ \ \ \ \textcolor{comment}{\#\ cor.test(x,\ y,\ method\ =\ "{}kendall"{},\ alternative\ =\ "{}g"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01480}01480\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01481}01481\ \ \ \ \ alternatives\ =\ (\textcolor{stringliteral}{'less'},\ \textcolor{stringliteral}{'two-\/sided'},\ \textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01482}01482\ \ \ \ \ p\_n1\ =\ [np.nan,\ np.nan,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01483}01483\ \ \ \ \ p\_n2\ =\ [1,\ 1,\ 0.5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01484}01484\ \ \ \ \ p\_c0\ =\ [1,\ 0.3333333333333,\ 0.1666666666667]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01485}01485\ \ \ \ \ p\_c1\ =\ [0.9583333333333,\ 0.3333333333333,\ 0.1666666666667]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01486}01486\ \ \ \ \ p\_no\_correlation\ =\ [0.5916666666667,\ 1,\ 0.5916666666667]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01487}01487\ \ \ \ \ p\_no\_correlationb\ =\ [0.5475694444444,\ 1,\ 0.5475694444444]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01488}01488\ \ \ \ \ p\_n\_lt\_171\ =\ [0.9624118165785,\ 0.1194389329806,\ 0.0597194664903]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01489}01489\ \ \ \ \ p\_n\_lt\_171b\ =\ [0.246236925303,\ 0.4924738506059,\ 0.755634083327]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01490}01490\ \ \ \ \ p\_n\_lt\_171c\ =\ [0.9847475308925,\ 0.03071385306533,\ 0.01535692653267]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01491}01491\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01492}01492\ \ \ \ \ \textcolor{keyword}{def\ }exact\_test(self,\ x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01493}01493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ rev:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01494}01494\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ -\/np.asarray(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01495}01495\ \ \ \ \ \ \ \ \ \ \ \ \ stat\_expected\ *=\ -\/1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01496}01496\ \ \ \ \ \ \ \ \ res\ =\ stats.kendalltau(x,\ y,\ method=\textcolor{stringliteral}{'exact'},\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01497}01497\ \ \ \ \ \ \ \ \ res\_expected\ =\ stat\_expected,\ p\_expected}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01498}01498\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ res\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01499}01499\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01500}01500\ \ \ \ \ case\_R\_n1\ =\ (list(zip(alternatives,\ p\_n1,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01501}01501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_n1),\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01502}01502\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01503}01503\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_n1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01504}01504\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_n1(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01505}01505\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1],\ [2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01506}01506\ \ \ \ \ \ \ \ \ stat\_expected\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01507}01507\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01508}01508\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01509}01509\ \ \ \ \ case\_R\_n2\ =\ (list(zip(alternatives,\ p\_n2,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01510}01510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_n2),\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01511}01511\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01512}01512\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_n2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01513}01513\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_n2(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01514}01514\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1,\ 2],\ [3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01515}01515\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0.9999999999999998}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01516}01516\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01517}01517\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01518}01518\ \ \ \ \ case\_R\_c0\ =\ (list(zip(alternatives,\ p\_c0,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01519}01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_c0),\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01520}01520\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01521}01521\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_c0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01522}01522\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_c0(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01523}01523\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1,\ 2,\ 3],\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01524}01524\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01525}01525\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01526}01526\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01527}01527\ \ \ \ \ case\_R\_c1\ =\ (list(zip(alternatives,\ p\_c1,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01528}01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_c1),\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01529}01529\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01530}01530\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_c1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01531}01531\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_c1(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01532}01532\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 4,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01533}01533\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0.6666666666666667}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01534}01534\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01535}01535\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01536}01536\ \ \ \ \ case\_R\_no\_corr\ =\ (list(zip(alternatives,\ p\_no\_correlation,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01537}01537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_no\_correlation),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01538}01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01539}01539\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01540}01540\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_no\_corr)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01541}01541\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_no\_correlation(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01542}01542\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1,\ 2,\ 3,\ 4,\ 5],\ [1,\ 5,\ 4,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01543}01543\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01544}01544\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01545}01545\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01546}01546\ \ \ \ \ case\_no\_cor\_b\ =\ (list(zip(alternatives,\ p\_no\_correlationb,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01547}01547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_no\_correlationb),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01548}01548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01549}01549\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01550}01550\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_no\_cor\_b)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01551}01551\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_no\_correlationb(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01552}01552\ \ \ \ \ \ \ \ \ x,\ y\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8],\ [8,\ 6,\ 1,\ 3,\ 2,\ 5,\ 4,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01553}01553\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01554}01554\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01555}01555\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01556}01556\ \ \ \ \ case\_R\_lt\_171\ =\ (list(zip(alternatives,\ p\_n\_lt\_171,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01557}01557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_n\_lt\_171),\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01558}01558\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01559}01559\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_lt\_171)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01560}01560\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_lt\_171(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01561}01561\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Data\ from\ Hollander\ \&\ Wolfe\ (1973),\ p.\ 187f.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01562}01562\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Used\ from\ https://rdrr.io/r/stats/cor.test.html}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01563}01563\ \ \ \ \ \ \ \ \ x\ =\ [44.4,\ 45.9,\ 41.9,\ 53.3,\ 44.7,\ 44.1,\ 50.7,\ 45.2,\ 60.1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01564}01564\ \ \ \ \ \ \ \ \ y\ =\ [2.6,\ 3.1,\ 2.5,\ 5.0,\ 3.6,\ 4.0,\ 5.2,\ 2.8,\ 3.8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01565}01565\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0.4444444444444445}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01566}01566\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01567}01567\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01568}01568\ \ \ \ \ case\_R\_lt\_171b\ =\ (list(zip(alternatives,\ p\_n\_lt\_171b,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01569}01569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_n\_lt\_171b),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01570}01570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01571}01571\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01572}01572\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_lt\_171b)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01573}01573\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_lt\_171b(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01574}01574\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01575}01575\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01576}01576\ \ \ \ \ \ \ \ \ y\ =\ np.random.rand(100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01577}01577\ \ \ \ \ \ \ \ \ stat\_expected\ =\ -\/0.04686868686868687}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01578}01578\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01579}01579\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01580}01580\ \ \ \ \ case\_R\_lt\_171c\ =\ (list(zip(alternatives,\ p\_n\_lt\_171c,\ [\textcolor{keyword}{False}]*3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01581}01581\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ list(zip(alternatives,\ reversed(p\_n\_lt\_171c),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01582}01582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01583}01583\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01584}01584\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ p\_expected,\ rev"{},\ case\_R\_lt\_171c)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01585}01585\ \ \ \ \ \textcolor{keyword}{def\ }test\_against\_R\_lt\_171c(self,\ alternative,\ p\_expected,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01586}01586\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01587}01587\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(170)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01588}01588\ \ \ \ \ \ \ \ \ y\ =\ np.random.rand(170)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01589}01589\ \ \ \ \ \ \ \ \ stat\_expected\ =\ 0.1115906717716673}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01590}01590\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestKendallTauAlternative_a33ddbc64c00b2cda32ece496cb5751f6}{exact\_test}}(x,\ y,\ alternative,\ rev,\ stat\_expected,\ p\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01591}01591\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01592}01592\ \ \ \ \ case\_gt\_171\ =\ (list(zip(alternatives,\ [\textcolor{keyword}{False}]*3))\ +}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01593}01593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ list(zip(alternatives,\ [\textcolor{keyword}{True}]*3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01594}01594\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01595}01595\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative,\ rev"{},\ case\_gt\_171)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01596}01596\ \ \ \ \ \textcolor{keyword}{def\ }test\_gt\_171(self,\ alternative,\ rev):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01597}01597\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01598}01598\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(400)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01599}01599\ \ \ \ \ \ \ \ \ y\ =\ np.random.rand(400)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01600}01600\ \ \ \ \ \ \ \ \ res0\ =\ stats.kendalltau(x,\ y,\ method=\textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01601}01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01602}01602\ \ \ \ \ \ \ \ \ res1\ =\ stats.kendalltau(x,\ y,\ method=\textcolor{stringliteral}{'asymptotic'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01603}01603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01604}01604\ \ \ \ \ \ \ \ \ assert\_equal(res0[0],\ res1[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01605}01605\ \ \ \ \ \ \ \ \ assert\_allclose(res0[1],\ res1[1],\ rtol=1e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01606}01606\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01607}01607\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}method"{},\ ('exact',\ 'asymptotic')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01608}01608\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative"{},\ ('two-\/sided',\ 'less',\ 'greater')})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01609}01609\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy(self,\ method,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01610}01610\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ nan\ policies}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01611}01611\ \ \ \ \ \ \ \ \ x1\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01612}01612\ \ \ \ \ \ \ \ \ x2\ =\ [5,\ 6,\ 7,\ 8,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01613}01613\ \ \ \ \ \ \ \ \ x1nan\ =\ x1\ +\ [np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01614}01614\ \ \ \ \ \ \ \ \ x2nan\ =\ x2\ +\ [np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01615}01615\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01616}01616\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}propagate"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01617}01617\ \ \ \ \ \ \ \ \ res\_actual\ =\ stats.kendalltau(x1nan,\ x2nan,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01618}01618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=method,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01619}01619\ \ \ \ \ \ \ \ \ res\_expected\ =\ (np.nan,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01620}01620\ \ \ \ \ \ \ \ \ assert\_allclose(res\_actual,\ res\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01621}01621\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01622}01622\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}omit"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01623}01623\ \ \ \ \ \ \ \ \ res\_actual\ =\ stats.kendalltau(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01624}01624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=method,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01625}01625\ \ \ \ \ \ \ \ \ res\_expected\ =\ stats.kendalltau(x1,\ x2,\ method=method,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01626}01626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01627}01627\ \ \ \ \ \ \ \ \ assert\_allclose(res\_actual,\ res\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01628}01628\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01629}01629\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy="{}raise"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01630}01630\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{'The\ input\ contains\ nan\ values'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01631}01631\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01632}01632\ \ \ \ \ \ \ \ \ \ \ \ \ stats.kendalltau(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'raise'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01633}01633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=method,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01634}01634\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01635}01635\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ invalid\ nan\_policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01636}01636\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}nan\_policy\ must\ be\ one\ of..."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01637}01637\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01638}01638\ \ \ \ \ \ \ \ \ \ \ \ \ stats.kendalltau(x1nan,\ x2nan,\ nan\_policy=\textcolor{stringliteral}{'ekki-\/ekki'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01639}01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=method,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01640}01640\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01641}01641\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01642}01642\ \textcolor{keyword}{def\ }test\_weightedtau():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01643}01643\ \ \ \ \ x\ =\ [12,\ 2,\ 1,\ 12,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01644}01644\ \ \ \ \ y\ =\ [1,\ 4,\ 7,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01645}01645\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01646}01646\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01647}01647\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01648}01648\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ additive=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01649}01649\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.62205716951801038)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01650}01650\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01651}01651\ \ \ \ \ \textcolor{comment}{\#\ This\ must\ be\ exactly\ Kendall's\ tau}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01652}01652\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ weigher=\textcolor{keyword}{lambda}\ x:\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01653}01653\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.47140452079103173)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01654}01654\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01655}01655\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01656}01656\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01657}01657\ \ \ \ \ res\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01658}01658\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'correlation'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01659}01659\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01660}01660\ \ \ \ \ assert\_equal(res.correlation,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01661}01661\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01662}01662\ \ \ \ \ \textcolor{comment}{\#\ Asymmetric,\ ranked\ version}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01663}01663\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ rank=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01664}01664\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.4157652301037516)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01665}01665\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01666}01666\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(y,\ x,\ rank=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01667}01667\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.7181341329699029)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01668}01668\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01669}01669\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ rank=\textcolor{keywordtype}{None},\ additive=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01670}01670\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.40644850966246893)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01671}01671\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01672}01672\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(y,\ x,\ rank=\textcolor{keywordtype}{None},\ additive=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01673}01673\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.83766582937355172)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01674}01674\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01675}01675\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ rank=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01676}01676\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.51604397940261848)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01677}01677\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01678}01678\ \ \ \ \ \textcolor{comment}{\#\ This\ must\ be\ exactly\ Kendall's\ tau}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01679}01679\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y,\ rank=\textcolor{keyword}{True},\ weigher=\textcolor{keyword}{lambda}\ x:\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01680}01680\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.47140452079103173)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01681}01681\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01682}01682\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(y,\ x,\ rank=\textcolor{keyword}{True},\ weigher=\textcolor{keyword}{lambda}\ x:\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01683}01683\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.47140452079103173)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01684}01684\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01685}01685\ \ \ \ \ \textcolor{comment}{\#\ Test\ argument\ conversion}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01686}01686\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(np.asarray(x,\ dtype=np.float64),\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01687}01687\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01688}01688\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(np.asarray(x,\ dtype=np.int16),\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01689}01689\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01690}01690\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(np.asarray(x,\ dtype=np.float64),\ np.asarray(y,\ dtype=np.float64))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01691}01691\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01692}01692\ \ \ \ \ \textcolor{comment}{\#\ All\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01693}01693\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau([],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01694}01694\ \ \ \ \ assert\_equal(np.nan,\ tau)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01695}01695\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01696}01696\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau([0],\ [0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01697}01697\ \ \ \ \ assert\_equal(np.nan,\ tau)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01698}01698\ \ \ \ \ assert\_equal(np.nan,\ p\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01699}01699\ \ \ \ \ \textcolor{comment}{\#\ Size\ mismatches}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01700}01700\ \ \ \ \ assert\_raises(ValueError,\ stats.weightedtau,\ [0,\ 1],\ [0,\ 1,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01701}01701\ \ \ \ \ assert\_raises(ValueError,\ stats.weightedtau,\ [0,\ 1],\ [0,\ 1],\ [0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01702}01702\ \ \ \ \ \textcolor{comment}{\#\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01703}01703\ \ \ \ \ x\ =\ [12,\ 2,\ 1,\ 12,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01704}01704\ \ \ \ \ y\ =\ [1,\ 4,\ 7,\ 1,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01705}01705\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01706}01706\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01707}01707\ \ \ \ \ x\ =\ [12,\ 2,\ np.nan,\ 12,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01708}01708\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01709}01709\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01710}01710\ \ \ \ \ \textcolor{comment}{\#\ NaNs\ when\ the\ dtype\ of\ x\ and\ y\ are\ all\ np.float64}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01711}01711\ \ \ \ \ x\ =\ [12.0,\ 2.0,\ 1.0,\ 12.0,\ 2.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01712}01712\ \ \ \ \ y\ =\ [1.0,\ 4.0,\ 7.0,\ 1.0,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01713}01713\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01714}01714\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01715}01715\ \ \ \ \ x\ =\ [12.0,\ 2.0,\ np.nan,\ 12.0,\ 2.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01716}01716\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01717}01717\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.56694968153682723)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01718}01718\ \ \ \ \ \textcolor{comment}{\#\ NaNs\ when\ there\ are\ more\ than\ one\ NaN\ in\ x\ or\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01719}01719\ \ \ \ \ x\ =\ [12.0,\ 2.0,\ 1.0,\ 12.0,\ 1.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01720}01720\ \ \ \ \ y\ =\ [1.0,\ 4.0,\ 7.0,\ 1.0,\ 1.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01721}01721\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01722}01722\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.6615242347139803)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01723}01723\ \ \ \ \ x\ =\ [12.0,\ 2.0,\ np.nan,\ 12.0,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01724}01724\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01725}01725\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.6615242347139803)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01726}01726\ \ \ \ \ y\ =\ [np.nan,\ 4.0,\ 7.0,\ np.nan,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01727}01727\ \ \ \ \ tau,\ p\_value\ =\ stats.weightedtau(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01728}01728\ \ \ \ \ assert\_approx\_equal(tau,\ -\/0.6615242347139803)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01729}01729\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01730}01730\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01731}01731\ \textcolor{keyword}{def\ }test\_segfault\_issue\_9710():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01732}01732\ \ \ \ \ \textcolor{comment}{\#\ https://github.com/scipy/scipy/issues/9710}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01733}01733\ \ \ \ \ \textcolor{comment}{\#\ This\ test\ was\ created\ to\ check\ segfault}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01734}01734\ \ \ \ \ \textcolor{comment}{\#\ In\ issue\ SEGFAULT\ only\ repros\ in\ optimized\ builds\ after\ calling\ the\ function\ twice}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01735}01735\ \ \ \ \ stats.weightedtau([1],\ [1.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01736}01736\ \ \ \ \ stats.weightedtau([1],\ [1.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01737}01737\ \ \ \ \ \textcolor{comment}{\#\ The\ code\ below\ also\ caused\ SEGFAULT}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01738}01738\ \ \ \ \ stats.weightedtau([np.nan],\ [52])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01739}01739\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01740}01740\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01741}01741\ \textcolor{keyword}{def\ }test\_kendall\_tau\_large():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01742}01742\ \ \ \ \ n\ =\ 172}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01743}01743\ \ \ \ \ \textcolor{comment}{\#\ Test\ omit\ policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01744}01744\ \ \ \ \ x\ =\ np.arange(n\ +\ 1).astype(float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01745}01745\ \ \ \ \ y\ =\ np.arange(n\ +\ 1).astype(float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01746}01746\ \ \ \ \ y[-\/1]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01747}01747\ \ \ \ \ \_,\ pval\ =\ stats.kendalltau(x,\ y,\ method=\textcolor{stringliteral}{'exact'},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01748}01748\ \ \ \ \ assert\_equal(pval,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01749}01749\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01750}01750\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01751}01751\ \textcolor{keyword}{def\ }test\_weightedtau\_vs\_quadratic():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01752}01752\ \ \ \ \ \textcolor{comment}{\#\ Trivial\ quadratic\ implementation,\ all\ parameters\ mandatory}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01753}01753\ \ \ \ \ \textcolor{keyword}{def\ }wkq(x,\ y,\ rank,\ weigher,\ add):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01754}01754\ \ \ \ \ \ \ \ \ tot\ =\ conc\ =\ disc\ =\ u\ =\ v\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01755}01755\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i,\ j)\ \textcolor{keywordflow}{in}\ product(range(len(x)),\ range(len(x))):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01756}01756\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ weigher(rank[i])\ +\ weigher(rank[j])\ \textcolor{keywordflow}{if}\ add\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01757}01757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ weigher(rank[i])\ *\ weigher(rank[j])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01758}01758\ \ \ \ \ \ \ \ \ \ \ \ \ tot\ +=\ w}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01759}01759\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x[i]\ ==\ x[j]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01760}01760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u\ +=\ w}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01761}01761\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y[i]\ ==\ y[j]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01762}01762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ v\ +=\ w}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01763}01763\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x[i]\ <\ x[j]\ \textcolor{keywordflow}{and}\ y[i]\ <\ y[j]\ \textcolor{keywordflow}{or}\ x[i]\ >\ x[j]\ \textcolor{keywordflow}{and}\ y[i]\ >\ y[j]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01764}01764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conc\ +=\ w}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01765}01765\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ x[i]\ <\ x[j]\ \textcolor{keywordflow}{and}\ y[i]\ >\ y[j]\ \textcolor{keywordflow}{or}\ x[i]\ >\ x[j]\ \textcolor{keywordflow}{and}\ y[i]\ <\ y[j]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01766}01766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disc\ +=\ w}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01767}01767\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (conc\ -\/\ disc)\ /\ np.sqrt(tot\ -\/\ u)\ /\ np.sqrt(tot\ -\/\ v)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01768}01768\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01769}01769\ \ \ \ \ \textcolor{keyword}{def\ }weigher(x):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01770}01770\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1.\ /\ (x\ +\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01771}01771\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01772}01772\ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01773}01773\ \ \ \ \ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ range(3,10):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01774}01774\ \ \ \ \ \ \ \ \ a\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01775}01775\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ rankings\ with\ ties}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01776}01776\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(s):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01777}01777\ \ \ \ \ \ \ \ \ \ \ \ \ a\ +=\ [i]*i}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01778}01778\ \ \ \ \ \ \ \ \ b\ =\ list(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01779}01779\ \ \ \ \ \ \ \ \ np.random.shuffle(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01780}01780\ \ \ \ \ \ \ \ \ np.random.shuffle(b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01781}01781\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ First\ pass:\ use\ element\ indices\ as\ ranks}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01782}01782\ \ \ \ \ \ \ \ \ rank\ =\ np.arange(len(a),\ dtype=np.intp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01783}01783\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(2):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01784}01784\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ add\ \textcolor{keywordflow}{in}\ [\textcolor{keyword}{True},\ \textcolor{keyword}{False}]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01785}01785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expected\ =\ wkq(a,\ b,\ rank,\ weigher,\ add)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01786}01786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ actual\ =\ stats.weightedtau(a,\ b,\ rank,\ weigher,\ add).statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01787}01787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_approx\_equal(expected,\ actual)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01788}01788\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Second\ pass:\ use\ a\ random\ rank}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01789}01789\ \ \ \ \ \ \ \ \ \ \ \ \ np.random.shuffle(rank)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01790}01790\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01791}01791\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01792}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestFindRepeats}{01792}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestFindRepeats}{TestFindRepeats}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01793}01793\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01794}01794\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01795}01795\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 1,\ 2,\ 3,\ 4,\ 1,\ 2,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01796}01796\ \ \ \ \ \ \ \ \ res,\ nums\ =\ stats.find\_repeats(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01797}01797\ \ \ \ \ \ \ \ \ assert\_array\_equal(res,\ [1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01798}01798\ \ \ \ \ \ \ \ \ assert\_array\_equal(nums,\ [3,\ 3,\ 2,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01799}01799\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01800}01800\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_result(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01801}01801\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ empty\ arrays\ are\ returned\ when\ there\ are\ no\ repeats.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01802}01802\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ a\ \textcolor{keywordflow}{in}\ [[10,\ 20,\ 50,\ 30,\ 40],\ []]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01803}01803\ \ \ \ \ \ \ \ \ \ \ \ \ repeated,\ counts\ =\ stats.find\_repeats(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01804}01804\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(repeated,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01805}01805\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(counts,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01806}01806\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01807}01807\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01808}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestRegression}{01808}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestRegression}{TestRegression}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01809}01809\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01810}01810\ \ \ \ \ \textcolor{keyword}{def\ }test\_linregressBIGX(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01811}01811\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ W.II.F.\ \ Regress\ BIG\ on\ X.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01812}01812\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(X,\ BIG)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01813}01813\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept,\ 99999990)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01814}01814\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.rvalue,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01815}01815\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ uncertainty\ ought\ to\ be\ almost\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01816}01816\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ since\ all\ points\ lie\ on\ a\ line}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01817}01817\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01818}01818\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01819}01819\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01820}01820\ \ \ \ \ \textcolor{keyword}{def\ }test\_regressXX(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01821}01821\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ W.IV.B.\ \ Regress\ X\ on\ X.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01822}01822\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ constant\ should\ be\ exactly\ 0\ and\ the\ regression\ coefficient}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01823}01823\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ should\ be\ 1.\ \ This\ is\ a\ perfectly\ valid\ regression\ and\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01824}01824\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ program\ should\ not\ complain.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01825}01825\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(X,\ X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01826}01826\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01827}01827\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.rvalue,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01828}01828\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ uncertainly\ on\ regression\ through\ two\ points\ ought\ to\ be\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01829}01829\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01830}01830\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01831}01831\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01832}01832\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ W.IV.C.\ Regress\ X\ on\ BIG\ and\ LITTLE\ (two\ predictors).\ \ The\ program}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01833}01833\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ should\ tell\ you\ that\ this\ model\ is\ "{}singular"{}\ because\ BIG\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01834}01834\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ LITTLE\ are\ linear\ combinations\ of\ each\ other.\ \ Cryptic\ error}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01835}01835\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ messages\ are\ unacceptable\ here.\ \ Singularity\ is\ the\ most}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01836}01836\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ fundamental\ regression\ error.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01837}01837\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01838}01838\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Need\ to\ figure\ out\ how\ to\ handle\ multiple\ linear\ regression.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01839}01839\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ not\ obvious}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01840}01840\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01841}01841\ \ \ \ \ \textcolor{keyword}{def\ }test\_regressZEROX(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01842}01842\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ W.IV.D.\ Regress\ ZERO\ on\ X.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01843}01843\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ program\ should\ inform\ you\ that\ ZERO\ has\ no\ variance\ or\ it\ should}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01844}01844\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ go\ ahead\ and\ compute\ the\ regression\ and\ report\ a\ correlation\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01845}01845\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ total\ sum\ of\ squares\ of\ exactly\ 0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01846}01846\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(X,\ ZERO)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01847}01847\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01848}01848\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.rvalue,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01849}01849\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01850}01850\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_simple(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01851}01851\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regress\ a\ line\ with\ sinusoidal\ noise.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01852}01852\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01853}01853\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01854}01854\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01855}01855\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01856}01856\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01857}01857\ \ \ \ \ \ \ \ \ lr\ =\ stats.\_stats\_mstats\_common.LinregressResult}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01858}01858\ \ \ \ \ \ \ \ \ assert\_(isinstance(result,\ lr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01859}01859\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 2.3957814497838803e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01860}01860\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01861}01861\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_alternative(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01862}01862\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01863}01863\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01864}01864\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10\ \ \textcolor{comment}{\#\ slope\ is\ greater\ than\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01865}01865\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01866}01866\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01867}01867\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}alternative\ must\ be\ 'less'..."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01868}01868\ \ \ \ \ \ \ \ \ \ \ \ \ stats.linregress(x,\ y,\ alternative=\textcolor{stringliteral}{"{}ekki-\/ekki"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01869}01869\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01870}01870\ \ \ \ \ \ \ \ \ res1\ =\ stats.linregress(x,\ y,\ alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01871}01871\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01872}01872\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ slope\ is\ greater\ than\ zero,\ so\ "{}less"{}\ p-\/value\ should\ be\ large}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01873}01873\ \ \ \ \ \ \ \ \ res2\ =\ stats.linregress(x,\ y,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01874}01874\ \ \ \ \ \ \ \ \ assert\_allclose(res2.pvalue,\ 1\ -\/\ (res1.pvalue\ /\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01875}01875\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01876}01876\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ slope\ is\ greater\ than\ zero,\ so\ "{}greater"{}\ p-\/value\ should\ be\ small}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01877}01877\ \ \ \ \ \ \ \ \ res3\ =\ stats.linregress(x,\ y,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01878}01878\ \ \ \ \ \ \ \ \ assert\_allclose(res3.pvalue,\ res1.pvalue\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01879}01879\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01880}01880\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res1.rvalue\ ==\ res2.rvalue\ ==\ res3.rvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01881}01881\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01882}01882\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_against\_R(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01883}01883\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ against\ R\ \`{}lm`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01884}01884\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01885}01885\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x\ <-\/\ c(151,\ 174,\ 138,\ 186,\ 128,\ 136,\ 179,\ 163,\ 152,\ 131)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01886}01886\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ y\ <-\/\ c(63,\ 81,\ 56,\ 91,\ 47,\ 57,\ 76,\ 72,\ 62,\ 48)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01887}01887\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ relation\ <-\/\ lm(y\string~x)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01888}01888\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print(summary(relation))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01889}01889\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01890}01890\ \ \ \ \ \ \ \ \ x\ =\ [151,\ 174,\ 138,\ 186,\ 128,\ 136,\ 179,\ 163,\ 152,\ 131]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01891}01891\ \ \ \ \ \ \ \ \ y\ =\ [63,\ 81,\ 56,\ 91,\ 47,\ 57,\ 76,\ 72,\ 62,\ 48]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01892}01892\ \ \ \ \ \ \ \ \ res\ =\ stats.linregress(x,\ y,\ alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01893}01893\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expected\ values\ from\ R's\ \`{}lm`\ above}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01894}01894\ \ \ \ \ \ \ \ \ assert\_allclose(res.slope,\ 0.6746104491292)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01895}01895\ \ \ \ \ \ \ \ \ assert\_allclose(res.intercept,\ -\/38.4550870760770)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01896}01896\ \ \ \ \ \ \ \ \ assert\_allclose(res.rvalue,\ np.sqrt(0.95478224775))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01897}01897\ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue,\ 1.16440531074e-\/06)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01898}01898\ \ \ \ \ \ \ \ \ assert\_allclose(res.stderr,\ 0.0519051424731)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01899}01899\ \ \ \ \ \ \ \ \ assert\_allclose(res.intercept\_stderr,\ 8.0490133029927)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01900}01900\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01901}01901\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_simple\_onearg\_rows(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01902}01902\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regress\ a\ line\ w\ sinusoidal\ noise,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01903}01903\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ a\ single\ input\ of\ shape\ (2,\ N)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01904}01904\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01905}01905\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01906}01906\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01907}01907\ \ \ \ \ \ \ \ \ rows\ =\ np.vstack((x,\ y))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01908}01908\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01909}01909\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(rows)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01910}01910\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 2.3957814497838803e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01911}01911\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 1.3866936078570702e-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01912}01912\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01913}01913\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_simple\_onearg\_cols(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01914}01914\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01915}01915\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01916}01916\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01917}01917\ \ \ \ \ \ \ \ \ columns\ =\ np.hstack((np.expand\_dims(x,\ 1),\ np.expand\_dims(y,\ 1)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01918}01918\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01919}01919\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(columns)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01920}01920\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 2.3957814497838803e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01921}01921\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 1.3866936078570702e-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01922}01922\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01923}01923\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_shape\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01924}01924\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ a\ single\ input\ argument\ to\ linregress\ with\ wrong\ shape}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01925}01925\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ results\ in\ a\ ValueError.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01926}01926\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.linregress,\ np.ones((3,\ 3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01927}01927\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01928}01928\ \ \ \ \ \textcolor{keyword}{def\ }test\_linregress(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01929}01929\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ compared\ with\ multivariate\ ols\ with\ pinv}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01930}01930\ \ \ \ \ \ \ \ \ x\ =\ np.arange(11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01931}01931\ \ \ \ \ \ \ \ \ y\ =\ np.arange(5,\ 16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01932}01932\ \ \ \ \ \ \ \ \ y[[(1),\ (-\/2)]]\ -\/=\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01933}01933\ \ \ \ \ \ \ \ \ y[[(0),\ (-\/1)]]\ +=\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01934}01934\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01935}01935\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01936}01936\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01937}01937\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ test\ used\ to\ use\ 'assert\_array\_almost\_equal'\ but\ its}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01938}01938\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ formualtion\ got\ confusing\ since\ LinregressResult\ became}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01939}01939\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \_lib.\_bunch.\_make\_tuple\_bunch\ instead\ of\ namedtuple}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01940}01940\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (for\ backwards\ compatibility,\ see\ PR\ \#12983)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01941}01941\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }assert\_ae(x,\ y):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01942}01942\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ assert\_almost\_equal(x,\ y,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01943}01943\ \ \ \ \ \ \ \ \ assert\_ae(result.slope,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01944}01944\ \ \ \ \ \ \ \ \ assert\_ae(result.intercept,\ 5.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01945}01945\ \ \ \ \ \ \ \ \ assert\_ae(result.rvalue,\ 0.98229948625750)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01946}01946\ \ \ \ \ \ \ \ \ assert\_ae(result.pvalue,\ 7.45259691e-\/008)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01947}01947\ \ \ \ \ \ \ \ \ assert\_ae(result.stderr,\ 0.063564172616372733)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01948}01948\ \ \ \ \ \ \ \ \ assert\_ae(result.intercept\_stderr,\ 0.37605071654517686)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01949}01949\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01950}01950\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_simple\_negative\_cor(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01951}01951\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ slope\ of\ the\ regression\ is\ negative\ the\ factor\ R\ tend}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01952}01952\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ -\/1\ not\ 1.\ \ Sometimes\ rounding\ errors\ makes\ it\ <\ -\/1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01953}01953\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ leading\ to\ stderr\ being\ NaN.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01954}01954\ \ \ \ \ \ \ \ \ a,\ n\ =\ 1e-\/71,\ 100000}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01955}01955\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(a,\ 2\ *\ a,\ n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01956}01956\ \ \ \ \ \ \ \ \ y\ =\ np.linspace(2\ *\ a,\ a,\ n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01957}01957\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01958}01958\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01959}01959\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ propagated\ numerical\ errors}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01960}01960\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ did\ not\ bring\ rvalue\ below\ -\/1\ (or\ were\ coersced)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01961}01961\ \ \ \ \ \ \ \ \ assert\_(result.rvalue\ >=\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01962}01962\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.rvalue,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01963}01963\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01964}01964\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ slope\ and\ intercept\ stderror\ should\ stay\ numeric}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01965}01965\ \ \ \ \ \ \ \ \ assert\_(\textcolor{keywordflow}{not}\ np.isnan(result.stderr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01966}01966\ \ \ \ \ \ \ \ \ assert\_(\textcolor{keywordflow}{not}\ np.isnan(result.intercept\_stderr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01967}01967\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01968}01968\ \ \ \ \ \textcolor{keyword}{def\ }test\_linregress\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01969}01969\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01970}01970\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01971}01971\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01972}01972\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01973}01973\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01974}01974\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Result\ is\ of\ a\ correct\ class}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01975}01975\ \ \ \ \ \ \ \ \ lr\ =\ stats.\_stats\_mstats\_common.LinregressResult}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01976}01976\ \ \ \ \ \ \ \ \ assert\_(isinstance(result,\ lr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01977}01977\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01978}01978\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ LinregressResult\ elements\ have\ correct\ names}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01979}01979\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'slope'},\ \textcolor{stringliteral}{'intercept'},\ \textcolor{stringliteral}{'rvalue'},\ \textcolor{stringliteral}{'pvalue'},\ \textcolor{stringliteral}{'stderr'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01980}01980\ \ \ \ \ \ \ \ \ check\_named\_results(result,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01981}01981\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Also\ check\ that\ the\ extra\ attribute\ (intercept\_stderr)\ is\ present}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01982}01982\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{stringliteral}{'intercept\_stderr'}\ \textcolor{keywordflow}{in}\ dir(result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01983}01983\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01984}01984\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_two\_inputs(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01985}01985\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regress\ a\ simple\ line\ formed\ by\ two\ points.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01986}01986\ \ \ \ \ \ \ \ \ x\ =\ np.arange(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01987}01987\ \ \ \ \ \ \ \ \ y\ =\ np.arange(3,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01988}01988\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01989}01989\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01990}01990\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Non-\/horizontal\ line}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01991}01991\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.pvalue,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01992}01992\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01993}01993\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Zero\ error\ through\ two\ points}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01994}01994\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01995}01995\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01996}01996\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01997}01997\ \ \ \ \ \textcolor{keyword}{def\ }test\_regress\_two\_inputs\_horizontal\_line(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01998}01998\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regress\ a\ horizontal\ line\ formed\ by\ two\ points.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l01999}01999\ \ \ \ \ \ \ \ \ x\ =\ np.arange(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02000}02000\ \ \ \ \ \ \ \ \ y\ =\ np.ones(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02001}02001\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02002}02002\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02003}02003\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Horizontal\ line}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02004}02004\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.pvalue,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02005}02005\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02006}02006\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Zero\ error\ through\ two\ points}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02007}02007\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02008}02008\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02009}02009\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02010}02010\ \ \ \ \ \textcolor{keyword}{def\ }test\_nist\_norris(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02011}02011\ \ \ \ \ \ \ \ \ x\ =\ [0.2,\ 337.4,\ 118.2,\ 884.6,\ 10.1,\ 226.5,\ 666.3,\ 996.3,\ 448.6,\ 777.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02012}02012\ \ \ \ \ \ \ \ \ \ \ \ \ \ 558.2,\ 0.4,\ 0.6,\ 775.5,\ 666.9,\ 338.0,\ 447.5,\ 11.6,\ 556.0,\ 228.1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02013}02013\ \ \ \ \ \ \ \ \ \ \ \ \ \ 995.8,\ 887.6,\ 120.2,\ 0.3,\ 0.3,\ 556.8,\ 339.1,\ 887.2,\ 999.0,\ 779.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02014}02014\ \ \ \ \ \ \ \ \ \ \ \ \ \ 11.1,\ 118.3,\ 229.2,\ 669.1,\ 448.9,\ 0.5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02015}02015\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02016}02016\ \ \ \ \ \ \ \ \ y\ =\ [0.1,\ 338.8,\ 118.1,\ 888.0,\ 9.2,\ 228.1,\ 668.5,\ 998.5,\ 449.1,\ 778.9,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02017}02017\ \ \ \ \ \ \ \ \ \ \ \ \ \ 559.2,\ 0.3,\ 0.1,\ 778.1,\ 668.8,\ 339.3,\ 448.9,\ 10.8,\ 557.7,\ 228.3,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02018}02018\ \ \ \ \ \ \ \ \ \ \ \ \ \ 998.0,\ 888.8,\ 119.6,\ 0.3,\ 0.6,\ 557.6,\ 339.3,\ 888.0,\ 998.5,\ 778.9,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02019}02019\ \ \ \ \ \ \ \ \ \ \ \ \ \ 10.2,\ 117.6,\ 228.9,\ 668.4,\ 449.2,\ 0.2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02020}02020\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02021}02021\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02022}02022\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02023}02023\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.slope,\ 1.00211681802045)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02024}02024\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept,\ -\/0.262323073774029)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02025}02025\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.rvalue**2,\ 0.999993745883712)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02026}02026\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.pvalue,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02027}02027\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.stderr,\ 0.00042979684820)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02028}02028\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept\_stderr,\ 0.23281823430153)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02029}02029\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02030}02030\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_to\_polyfit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02031}02031\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02032}02032\ \ \ \ \ \ \ \ \ y\ =\ 0.2\ *\ np.linspace(0,\ 100,\ 100)\ +\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02033}02033\ \ \ \ \ \ \ \ \ y\ +=\ np.sin(np.linspace(0,\ 20,\ 100))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02034}02034\ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02035}02035\ \ \ \ \ \ \ \ \ poly\ =\ np.polyfit(x,\ y,\ 1)\ \ \textcolor{comment}{\#\ Fit\ 1st\ degree\ polynomial}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02036}02036\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02037}02037\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ linear\ regression\ slope\ and\ intercept}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02038}02038\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ match\ with\ results\ from\ numpy\ polyfit}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02039}02039\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.slope,\ poly[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02040}02040\ \ \ \ \ \ \ \ \ assert\_almost\_equal(result.intercept,\ poly[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02041}02041\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02042}02042\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02043}02043\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.linregress,\ [],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02044}02044\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02045}02045\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02046}02046\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02047}02047\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02048}02048\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02049}02049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02050}02050\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ stats.linregress(x,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02051}02051\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02052}02052\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ the\ resut\ still\ comes\ back\ as\ \`{}LinregressResult`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02053}02053\ \ \ \ \ \ \ \ \ lr\ =\ stats.\_stats\_mstats\_common.LinregressResult}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02054}02054\ \ \ \ \ \ \ \ \ assert\_(isinstance(result,\ lr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02055}02055\ \ \ \ \ \ \ \ \ assert\_array\_equal(result,\ (np.nan,)*5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02056}02056\ \ \ \ \ \ \ \ \ assert\_equal(result.intercept\_stderr,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02057}02057\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02058}02058\ \ \ \ \ \textcolor{keyword}{def\ }test\_identical\_x(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02059}02059\ \ \ \ \ \ \ \ \ x\ =\ np.zeros(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02060}02060\ \ \ \ \ \ \ \ \ y\ =\ np.random.random(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02061}02061\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Cannot\ calculate\ a\ linear\ regression"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02062}02062\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02063}02063\ \ \ \ \ \ \ \ \ \ \ \ \ stats.linregress(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02064}02064\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02065}02065\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02066}02066\ \textcolor{keyword}{def\ }test\_theilslopes():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02067}02067\ \ \ \ \ \textcolor{comment}{\#\ Basic\ slope\ test.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02068}02068\ \ \ \ \ slope,\ intercept,\ lower,\ upper\ =\ stats.theilslopes([0,1,1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02069}02069\ \ \ \ \ assert\_almost\_equal(slope,\ 0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02070}02070\ \ \ \ \ assert\_almost\_equal(intercept,\ 0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02071}02071\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02072}02072\ \ \ \ \ msg\ =\ (\textcolor{stringliteral}{"{}method\ must\ be\ either\ 'joint'\ or\ 'separate'."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02073}02073\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}'joint\_separate'\ is\ invalid."{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02074}02074\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02075}02075\ \ \ \ \ \ \ \ \ stats.theilslopes([0,\ 1,\ 1],\ method=\textcolor{stringliteral}{'joint\_separate'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02076}02076\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02077}02077\ \ \ \ \ slope,\ intercept,\ lower,\ upper\ =\ stats.theilslopes([0,\ 1,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02078}02078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{'joint'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02079}02079\ \ \ \ \ assert\_almost\_equal(slope,\ 0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02080}02080\ \ \ \ \ assert\_almost\_equal(intercept,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02081}02081\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02082}02082\ \ \ \ \ \textcolor{comment}{\#\ Test\ of\ confidence\ intervals.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02083}02083\ \ \ \ \ x\ =\ [1,\ 2,\ 3,\ 4,\ 10,\ 12,\ 18]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02084}02084\ \ \ \ \ y\ =\ [9,\ 15,\ 19,\ 20,\ 45,\ 55,\ 78]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02085}02085\ \ \ \ \ slope,\ intercept,\ lower,\ upper\ =\ stats.theilslopes(y,\ x,\ 0.07,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02086}02086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{'separate'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02087}02087\ \ \ \ \ assert\_almost\_equal(slope,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02088}02088\ \ \ \ \ assert\_almost\_equal(intercept,\ 4.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02089}02089\ \ \ \ \ assert\_almost\_equal(upper,\ 4.38,\ decimal=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02090}02090\ \ \ \ \ assert\_almost\_equal(lower,\ 3.71,\ decimal=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02091}02091\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02092}02092\ \ \ \ \ slope,\ intercept,\ lower,\ upper\ =\ stats.theilslopes(y,\ x,\ 0.07,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02093}02093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{'joint'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02094}02094\ \ \ \ \ assert\_almost\_equal(slope,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02095}02095\ \ \ \ \ assert\_almost\_equal(intercept,\ 6.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02096}02096\ \ \ \ \ assert\_almost\_equal(upper,\ 4.38,\ decimal=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02097}02097\ \ \ \ \ assert\_almost\_equal(lower,\ 3.71,\ decimal=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02098}02098\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02099}02099\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02100}02100\ \textcolor{keyword}{def\ }test\_cumfreq():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02101}02101\ \ \ \ \ x\ =\ [1,\ 4,\ 2,\ 1,\ 3,\ 1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02102}02102\ \ \ \ \ cumfreqs,\ lowlim,\ binsize,\ extrapoints\ =\ stats.cumfreq(x,\ numbins=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02103}02103\ \ \ \ \ assert\_array\_almost\_equal(cumfreqs,\ np.array([3.,\ 4.,\ 5.,\ 6.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02104}02104\ \ \ \ \ cumfreqs,\ lowlim,\ binsize,\ extrapoints\ =\ stats.cumfreq(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02105}02105\ \ \ \ \ \ \ \ \ x,\ numbins=4,\ defaultreallimits=(1.5,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02106}02106\ \ \ \ \ assert\_(extrapoints\ ==\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02107}02107\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02108}02108\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02109}02109\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'cumcount'},\ \textcolor{stringliteral}{'lowerlimit'},\ \textcolor{stringliteral}{'binsize'},\ \textcolor{stringliteral}{'extrapoints'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02110}02110\ \ \ \ \ res\ =\ stats.cumfreq(x,\ numbins=4,\ defaultreallimits=(1.5,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02111}02111\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02112}02112\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02113}02113\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02114}02114\ \textcolor{keyword}{def\ }test\_relfreq():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02115}02115\ \ \ \ \ a\ =\ np.array([1,\ 4,\ 2,\ 1,\ 3,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02116}02116\ \ \ \ \ relfreqs,\ lowlim,\ binsize,\ extrapoints\ =\ stats.relfreq(a,\ numbins=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02117}02117\ \ \ \ \ assert\_array\_almost\_equal(relfreqs,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02118}02118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ array([0.5,\ 0.16666667,\ 0.16666667,\ 0.16666667]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02119}02119\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02120}02120\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02121}02121\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'frequency'},\ \textcolor{stringliteral}{'lowerlimit'},\ \textcolor{stringliteral}{'binsize'},\ \textcolor{stringliteral}{'extrapoints'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02122}02122\ \ \ \ \ res\ =\ stats.relfreq(a,\ numbins=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02123}02123\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02124}02124\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02125}02125\ \ \ \ \ \textcolor{comment}{\#\ check\ array\_like\ input\ is\ accepted}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02126}02126\ \ \ \ \ relfreqs2,\ lowlim,\ binsize,\ extrapoints\ =\ stats.relfreq([1,\ 4,\ 2,\ 1,\ 3,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02127}02127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ numbins=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02128}02128\ \ \ \ \ assert\_array\_almost\_equal(relfreqs,\ relfreqs2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02129}02129\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02130}02130\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02131}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestScoreatpercentile}{02131}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestScoreatpercentile}{TestScoreatpercentile}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02132}02132\ \ \ \ \ \textcolor{keyword}{def\ }setup\_method(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02133}02133\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestScoreatpercentile_af624f8d61142afc8b748f47f503f9217}{a1}}\ =\ [3,\ 4,\ 5,\ 10,\ -\/3,\ -\/5,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02134}02134\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestScoreatpercentile_a1e25bb696d1cfc791f76ad0b02e0ca41}{a2}}\ =\ [3,\ -\/6,\ -\/2,\ 8,\ 7,\ 4,\ 2,\ 1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02135}02135\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestScoreatpercentile_af51c1060f95e33ceb52d120e57e8bd5f}{a3}}\ =\ [3.,\ 4,\ 5,\ 10,\ -\/3,\ -\/5,\ -\/6,\ 7.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02136}02136\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02137}02137\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02138}02138\ \ \ \ \ \ \ \ \ x\ =\ arange(8)\ *\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02139}02139\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile(x,\ 0),\ 0.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02140}02140\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile(x,\ 100),\ 3.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02141}02141\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile(x,\ 50),\ 1.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02142}02142\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02143}02143\ \ \ \ \ \textcolor{keyword}{def\ }test\_fraction(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02144}02144\ \ \ \ \ \ \ \ \ scoreatperc\ =\ stats.scoreatpercentile}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02145}02145\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02146}02146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ defaults}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02147}02147\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50),\ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02148}02148\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,\ (2,7)),\ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02149}02149\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(100)),\ 50,\ limit=(1,\ 8)),\ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02150}02150\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,100]),\ 50,\ (10,100)),\ 55)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02151}02151\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,100]),\ 50,\ (1,10)),\ 5.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02152}02152\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02153}02153\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ explicitly\ specify\ interpolation\_method\ 'fraction'\ (the\ default)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02154}02154\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,\ interpolation\_method=\textcolor{stringliteral}{'fraction'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02155}02155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02156}02156\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,\ limit=(2,\ 7),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02157}02157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'fraction'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02158}02158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02159}02159\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(100)),\ 50,\ limit=(1,\ 8),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02160}02160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'fraction'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02161}02161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02162}02162\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,100]),\ 50,\ (10,\ 100),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02163}02163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'fraction'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02164}02164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 55)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02165}02165\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,100]),\ 50,\ (1,10),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02166}02166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'fraction'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02167}02167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 5.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02168}02168\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02169}02169\ \ \ \ \ \textcolor{keyword}{def\ }test\_lower\_higher(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02170}02170\ \ \ \ \ \ \ \ \ scoreatperc\ =\ stats.scoreatpercentile}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02171}02171\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02172}02172\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ interpolation\_method\ 'lower'/'higher'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02173}02173\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02174}02174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'lower'}),\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02175}02175\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02176}02176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'higher'}),\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02177}02177\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,\ (2,7),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02178}02178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'lower'}),\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02179}02179\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(10)),\ 50,\ limit=(2,7),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02180}02180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'higher'}),\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02181}02181\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(100)),\ 50,\ (1,8),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02182}02182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'lower'}),\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02183}02183\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(list(range(100)),\ 50,\ (1,8),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02184}02184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'higher'}),\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02185}02185\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,\ 100]),\ 50,\ (10,\ 100),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02186}02186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'lower'}),\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02187}02187\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,\ 100]),\ 50,\ limit=(10,\ 100),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02188}02188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'higher'}),\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02189}02189\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,\ 100]),\ 50,\ (1,\ 10),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02190}02190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'lower'}),\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02191}02191\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(np.array([1,\ 10,\ 100]),\ 50,\ limit=(1,\ 10),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02192}02192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'higher'}),\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02193}02193\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02194}02194\ \ \ \ \ \textcolor{keyword}{def\ }test\_sequence\_per(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02195}02195\ \ \ \ \ \ \ \ \ x\ =\ arange(8)\ *\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02196}02196\ \ \ \ \ \ \ \ \ expected\ =\ np.array([0,\ 3.5,\ 1.75])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02197}02197\ \ \ \ \ \ \ \ \ res\ =\ stats.scoreatpercentile(x,\ [0,\ 100,\ 50])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02198}02198\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02199}02199\ \ \ \ \ \ \ \ \ assert\_(isinstance(res,\ np.ndarray))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02200}02200\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ with\ ndarray.\ \ Regression\ test\ for\ gh-\/2861}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02201}02201\ \ \ \ \ \ \ \ \ assert\_allclose(stats.scoreatpercentile(x,\ np.array([0,\ 100,\ 50])),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02202}02202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02203}02203\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Also\ test\ combination\ of\ 2-\/D\ array,\ axis\ not\ None\ and\ array-\/like\ per}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02204}02204\ \ \ \ \ \ \ \ \ res2\ =\ stats.scoreatpercentile(np.arange(12).reshape((3,4)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02205}02205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([0,\ 1,\ 100,\ 100]),\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02206}02206\ \ \ \ \ \ \ \ \ expected2\ =\ array([[0,\ 4,\ 8],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02207}02207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.03,\ 4.03,\ 8.03],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02208}02208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 7,\ 11],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02209}02209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 7,\ 11]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02210}02210\ \ \ \ \ \ \ \ \ assert\_allclose(res2,\ expected2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02211}02211\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02212}02212\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02213}02213\ \ \ \ \ \ \ \ \ scoreatperc\ =\ stats.scoreatpercentile}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02214}02214\ \ \ \ \ \ \ \ \ x\ =\ arange(12).reshape(3,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02215}02215\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02216}02216\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(x,\ (25,\ 50,\ 100)),\ [2.75,\ 5.5,\ 11.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02217}02217\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02218}02218\ \ \ \ \ \ \ \ \ r0\ =\ [[2,\ 3,\ 4,\ 5],\ [4,\ 5,\ 6,\ 7],\ [8,\ 9,\ 10,\ 11]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02219}02219\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(x,\ (25,\ 50,\ 100),\ axis=0),\ r0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02220}02220\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02221}02221\ \ \ \ \ \ \ \ \ r1\ =\ [[0.75,\ 4.75,\ 8.75],\ [1.5,\ 5.5,\ 9.5],\ [3,\ 7,\ 11]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02222}02222\ \ \ \ \ \ \ \ \ assert\_equal(scoreatperc(x,\ (25,\ 50,\ 100),\ axis=1),\ r1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02223}02223\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02224}02224\ \ \ \ \ \ \ \ \ x\ =\ array([[1,\ 1,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02225}02225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02226}02226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 4,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02227}02227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02228}02228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02229}02229\ \ \ \ \ \ \ \ \ score\ =\ stats.scoreatpercentile(x,\ 50)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02230}02230\ \ \ \ \ \ \ \ \ assert\_equal(score.shape,\ ())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02231}02231\ \ \ \ \ \ \ \ \ assert\_equal(score,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02232}02232\ \ \ \ \ \ \ \ \ score\ =\ stats.scoreatpercentile(x,\ 50,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02233}02233\ \ \ \ \ \ \ \ \ assert\_equal(score.shape,\ (3,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02234}02234\ \ \ \ \ \ \ \ \ assert\_equal(score,\ [1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02235}02235\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02236}02236\ \ \ \ \ \textcolor{keyword}{def\ }test\_exception(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02237}02237\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.scoreatpercentile,\ [1,\ 2],\ 56,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02238}02238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolation\_method=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02239}02239\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.scoreatpercentile,\ [1],\ 101)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02240}02240\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.scoreatpercentile,\ [1],\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02241}02241\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02242}02242\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02243}02243\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile([],\ 50),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02244}02244\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile(np.array([[],\ []]),\ 50),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02245}02245\ \ \ \ \ \ \ \ \ assert\_equal(stats.scoreatpercentile([],\ [50,\ 99]),\ [np.nan,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02246}02246\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02247}02247\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02248}02248\ \textcolor{preprocessor}{@pytest.mark.filterwarnings('ignore::FutureWarning')}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02249}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMode}{02249}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMode}{TestMode}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02250}02250\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02251}02251\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02252}02252\ \ \ \ \ \ \ \ \ vals,\ counts\ =\ stats.mode([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02253}02253\ \ \ \ \ \ \ \ \ assert\_equal(vals,\ np.array([]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02254}02254\ \ \ \ \ \ \ \ \ assert\_equal(counts,\ np.array([]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02255}02255\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02256}02256\ \ \ \ \ \textcolor{keyword}{def\ }test\_scalar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02257}02257\ \ \ \ \ \ \ \ \ vals,\ counts\ =\ stats.mode(4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02258}02258\ \ \ \ \ \ \ \ \ assert\_equal(vals,\ np.array([4.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02259}02259\ \ \ \ \ \ \ \ \ assert\_equal(counts,\ np.array([1]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02260}02260\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02261}02261\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02262}02262\ \ \ \ \ \ \ \ \ data1\ =\ [3,\ 5,\ 1,\ 10,\ 23,\ 3,\ 2,\ 6,\ 8,\ 6,\ 10,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02263}02263\ \ \ \ \ \ \ \ \ vals\ =\ stats.mode(data1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02264}02264\ \ \ \ \ \ \ \ \ assert\_equal(vals[0],\ 6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02265}02265\ \ \ \ \ \ \ \ \ assert\_equal(vals[1],\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02266}02266\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02267}02267\ \ \ \ \ \textcolor{keyword}{def\ }test\_axes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02268}02268\ \ \ \ \ \ \ \ \ data1\ =\ [10,\ 10,\ 30,\ 40]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02269}02269\ \ \ \ \ \ \ \ \ data2\ =\ [10,\ 10,\ 10,\ 10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02270}02270\ \ \ \ \ \ \ \ \ data3\ =\ [20,\ 10,\ 20,\ 20]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02271}02271\ \ \ \ \ \ \ \ \ data4\ =\ [30,\ 30,\ 30,\ 30]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02272}02272\ \ \ \ \ \ \ \ \ data5\ =\ [40,\ 30,\ 30,\ 30]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02273}02273\ \ \ \ \ \ \ \ \ arr\ =\ np.array([data1,\ data2,\ data3,\ data4,\ data5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02274}02274\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02275}02275\ \ \ \ \ \ \ \ \ vals\ =\ stats.mode(arr,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02276}02276\ \ \ \ \ \ \ \ \ assert\_equal(vals[0],\ np.array([[30]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02277}02277\ \ \ \ \ \ \ \ \ assert\_equal(vals[1],\ np.array([[8]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02278}02278\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02279}02279\ \ \ \ \ \ \ \ \ vals\ =\ stats.mode(arr,\ axis=0,\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02280}02280\ \ \ \ \ \ \ \ \ assert\_equal(vals[0],\ np.array([[10,\ 10,\ 30,\ 30]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02281}02281\ \ \ \ \ \ \ \ \ assert\_equal(vals[1],\ np.array([[2,\ 3,\ 3,\ 2]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02282}02282\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02283}02283\ \ \ \ \ \ \ \ \ vals\ =\ stats.mode(arr,\ axis=1,\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02284}02284\ \ \ \ \ \ \ \ \ assert\_equal(vals[0],\ np.array([[10],\ [10],\ [20],\ [30],\ [30]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02285}02285\ \ \ \ \ \ \ \ \ assert\_equal(vals[1],\ np.array([[2],\ [4],\ [3],\ [4],\ [3]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02286}02286\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02287}02287\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('axis',\ np.arange(-\/4,\ 0)})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02288}02288\ \ \ \ \ \textcolor{keyword}{def\ }test\_negative\_axes\_gh\_15375(self,\ axis):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02289}02289\ \ \ \ \ \ \ \ \ np.random.seed(984213899)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02290}02290\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(10,\ 11,\ 12,\ 13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02291}02291\ \ \ \ \ \ \ \ \ res0\ =\ stats.mode(a,\ axis=a.ndim+axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02292}02292\ \ \ \ \ \ \ \ \ res1\ =\ stats.mode(a,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02293}02293\ \ \ \ \ \ \ \ \ np.testing.assert\_array\_equal(res0,\ res1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02294}02294\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02295}02295\ \ \ \ \ \textcolor{keyword}{def\ }test\_mode\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02296}02296\ \ \ \ \ \ \ \ \ data1\ =\ [3,\ 5,\ 1,\ 10,\ 23,\ 3,\ 2,\ 6,\ 8,\ 6,\ 10,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02297}02297\ \ \ \ \ \ \ \ \ data2\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02298}02298\ \ \ \ \ \ \ \ \ actual\ =\ stats.mode(data1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02299}02299\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'mode'},\ \textcolor{stringliteral}{'count'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02300}02300\ \ \ \ \ \ \ \ \ check\_named\_results(actual,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02301}02301\ \ \ \ \ \ \ \ \ actual2\ =\ stats.mode(data2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02302}02302\ \ \ \ \ \ \ \ \ check\_named\_results(actual2,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02303}02303\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02304}02304\ \ \ \ \ \textcolor{keyword}{def\ }test\_mode\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02305}02305\ \ \ \ \ \ \ \ \ data1\ =\ [3,\ np.nan,\ 5,\ 1,\ 10,\ 23,\ 3,\ 2,\ 6,\ 8,\ 6,\ 10,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02306}02306\ \ \ \ \ \ \ \ \ actual\ =\ stats.mode(data1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02307}02307\ \ \ \ \ \ \ \ \ assert\_equal(actual,\ (6,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02308}02308\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02309}02309\ \ \ \ \ \ \ \ \ actual\ =\ stats.mode(data1,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02310}02310\ \ \ \ \ \ \ \ \ assert\_equal(actual,\ (6,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02311}02311\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.mode,\ data1,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02312}02312\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.mode,\ data1,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02313}02313\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02314}02314\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}data"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02315}02315\ \ \ \ \ \ \ \ \ [3,\ 5,\ 1,\ 1,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02316}02316\ \ \ \ \ \ \ \ \ [3,\ np.nan,\ 5,\ 1,\ 1,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02317}02317\ \ \ \ \ \ \ \ \ [3,\ 5,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02318}02318\ \ \ \ \ \ \ \ \ [3,\ np.nan,\ 5,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02319}02319\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02320}02320\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('keepdims',\ [False,\ True])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02321}02321\ \ \ \ \ \textcolor{keyword}{def\ }test\_smallest\_equal(self,\ data,\ keepdims):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02322}02322\ \ \ \ \ \ \ \ \ result\ =\ stats.mode(data,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ keepdims=keepdims)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02323}02323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ keepdims:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02324}02324\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(result[0][0],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02325}02325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02326}02326\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(result[0],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02327}02327\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02328}02328\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('axis',\ np.arange(-\/3,\ 3)})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02329}02329\ \ \ \ \ \textcolor{keyword}{def\ }test\_mode\_shape\_gh\_9955(self,\ axis,\ dtype=np.float64):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02330}02330\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(984213899)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02331}02331\ \ \ \ \ \ \ \ \ a\ =\ rng.uniform(size=(3,\ 4,\ 5)).astype(dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02332}02332\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=axis,\ keepdims=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02333}02333\ \ \ \ \ \ \ \ \ reference\_shape\ =\ list(a.shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02334}02334\ \ \ \ \ \ \ \ \ reference\_shape.pop(axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02335}02335\ \ \ \ \ \ \ \ \ np.testing.assert\_array\_equal(res.mode.shape,\ reference\_shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02336}02336\ \ \ \ \ \ \ \ \ np.testing.assert\_array\_equal(res.count.shape,\ reference\_shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02337}02337\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02338}02338\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_propagate\_gh\_9815(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02339}02339\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ mode\ should\ treat\ np.nan\ as\ it\ would\ any\ other\ object\ when}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02340}02340\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ nan\_policy='propagate'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02341}02341\ \ \ \ \ \ \ \ \ a\ =\ [2,\ np.nan,\ 1,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02342}02342\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{classnumpy_1_1lib_1_1__version_1_1NumpyVersion}{NumpyVersion}}(np.\_\_version\_\_)\ >=\ \textcolor{stringliteral}{'1.21.0'}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02343}02343\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02344}02344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(res.mode)\ \textcolor{keywordflow}{and}\ res.count\ ==\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02345}02345\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02346}02346\ \ \ \ \ \textcolor{keyword}{def\ }test\_keepdims(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02347}02347\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ empty\ arrays\ (handled\ by\ \`{}np.mean`)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02348}02348\ \ \ \ \ \ \ \ \ a\ =\ np.zeros((1,\ 2,\ 3,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02349}02349\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02350}02350\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02351}02351\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ res.count.shape\ ==\ (1,\ 3,\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02352}02352\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02353}02353\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02354}02354\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ res.count.shape\ ==\ (1,\ 1,\ 3,\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02355}02355\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02356}02356\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy='propagate'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02357}02357\ \ \ \ \ \ \ \ \ a\ =\ [[1,\ 3,\ 3,\ np.nan],\ [1,\ 1,\ np.nan,\ 1]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02358}02358\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02359}02359\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02360}02360\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.mode,\ [3,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02361}02361\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.count,\ [2,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02362}02362\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02363}02363\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02364}02364\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.mode,\ [[3],\ [1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02365}02365\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.count,\ [[2],\ [3]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02366}02366\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02367}02367\ \ \ \ \ \ \ \ \ a\ =\ np.array(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02368}02368\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02369}02369\ \ \ \ \ \ \ \ \ ref\ =\ stats.mode(a.ravel(),\ keepdims=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02370}02370\ \ \ \ \ \ \ \ \ assert\_array\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02371}02371\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ ref.mode.shape\ ==\ ()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02372}02372\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02373}02373\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02374}02374\ \ \ \ \ \ \ \ \ ref\ =\ stats.mode(a.ravel(),\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02375}02375\ \ \ \ \ \ \ \ \ assert\_equal(res.mode.ravel(),\ ref.mode.ravel())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02376}02376\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ (1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02377}02377\ \ \ \ \ \ \ \ \ assert\_equal(res.count.ravel(),\ ref.count.ravel())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02378}02378\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.count.shape\ ==\ (1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02379}02379\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02380}02380\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ nan\_policy='omit'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02381}02381\ \ \ \ \ \ \ \ \ a\ =\ [[1,\ np.nan,\ np.nan,\ np.nan,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02382}02382\ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ np.nan,\ np.nan,\ np.nan,\ 2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02383}02383\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ np.nan,\ 5,\ 5]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02384}02384\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02385}02385\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{False},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02386}02386\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.mode,\ [1,\ 2,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02387}02387\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.count,\ [2,\ 1,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02388}02388\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02389}02389\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ keepdims=\textcolor{keyword}{True},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02390}02390\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.mode,\ [[1],\ [2],\ [5]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02391}02391\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.count,\ [[2],\ [1],\ [2]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02392}02392\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02393}02393\ \ \ \ \ \ \ \ \ a\ =\ np.array(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02394}02394\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{False},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02395}02395\ \ \ \ \ \ \ \ \ ref\ =\ stats.mode(a.ravel(),\ keepdims=\textcolor{keyword}{False},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02396}02396\ \ \ \ \ \ \ \ \ assert\_array\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02397}02397\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ ref.mode.shape\ ==\ ()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02398}02398\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02399}02399\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02400}02400\ \ \ \ \ \ \ \ \ ref\ =\ stats.mode(a.ravel(),\ keepdims=\textcolor{keyword}{True},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02401}02401\ \ \ \ \ \ \ \ \ assert\_equal(res.mode.ravel(),\ ref.mode.ravel())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02402}02402\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.mode.shape\ ==\ (1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02403}02403\ \ \ \ \ \ \ \ \ assert\_equal(res.count.ravel(),\ ref.count.ravel())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02404}02404\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.count.shape\ ==\ (1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02405}02405\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02406}02406\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}nan\_policy"{},\ ['propagate',\ 'omit'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02407}02407\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh16955(self,\ nan\_policy):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02408}02408\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ bug\ reported\ in\ gh-\/16955\ is\ resolved}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02409}02409\ \ \ \ \ \ \ \ \ shape\ =\ (4,\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02410}02410\ \ \ \ \ \ \ \ \ data\ =\ np.ones(shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02411}02411\ \ \ \ \ \ \ \ \ data[0,\ 0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02412}02412\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a=data,\ axis=1,\ keepdims=\textcolor{keyword}{False},\ nan\_policy=nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02413}02413\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.mode,\ [1,\ 1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02414}02414\ \ \ \ \ \ \ \ \ assert\_array\_equal(res.count,\ [2,\ 3,\ 3,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02415}02415\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02416}02416\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ with\ input\ from\ gh-\/16595.\ Support\ for\ non-\/numeric\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02417}02417\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ was\ deprecated,\ so\ check\ for\ the\ appropriate\ error.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02418}02418\ \ \ \ \ \ \ \ \ my\_dtype\ =\ np.dtype([(\textcolor{stringliteral}{'asdf'},\ np.uint8),\ (\textcolor{stringliteral}{'qwer'},\ np.float64,\ (3,))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02419}02419\ \ \ \ \ \ \ \ \ test\ =\ np.zeros(10,\ dtype=my\_dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02420}02420\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=\textcolor{stringliteral}{"{}Argument\ \`{}a`\ is\ not..."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02421}02421\ \ \ \ \ \ \ \ \ \ \ \ \ stats.mode(test,\ nan\_policy=nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02422}02422\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02423}02423\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh9955(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02424}02424\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ behavior\ of\ mode\ with\ empty\ slices\ (whether\ the\ input\ was\ empty}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02425}02425\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ or\ all\ elements\ were\ omitted)\ was\ inconsistent.\ Test\ that\ this\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02426}02426\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ resolved:\ the\ mode\ of\ an\ empty\ slice\ is\ NaN\ and\ the\ count\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02427}02427\ \ \ \ \ \ \ \ \ res\ =\ stats.mode([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02428}02428\ \ \ \ \ \ \ \ \ ref\ =\ (np.nan,\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02429}02429\ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02430}02430\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02431}02431\ \ \ \ \ \ \ \ \ res\ =\ stats.mode([np.nan],\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02432}02432\ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02433}02433\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02434}02434\ \ \ \ \ \ \ \ \ a\ =\ [[10.,\ 20.,\ 20.],\ [np.nan,\ np.nan,\ np.nan]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02435}02435\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02436}02436\ \ \ \ \ \ \ \ \ ref\ =\ ([20,\ np.nan],\ [2,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02437}02437\ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02438}02438\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02439}02439\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{classnumpy_1_1lib_1_1__version_1_1NumpyVersion}{NumpyVersion}}(np.\_\_version\_\_)\ >=\ \textcolor{stringliteral}{'1.21.0'}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02440}02440\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.mode(a,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{'propagate'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02441}02441\ \ \ \ \ \ \ \ \ \ \ \ \ ref\ =\ ([20,\ np.nan],\ [2,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02442}02442\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02443}02443\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02444}02444\ \ \ \ \ \ \ \ \ z\ =\ np.array([[],\ []])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02445}02445\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(z,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02446}02446\ \ \ \ \ \ \ \ \ ref\ =\ ([np.nan,\ np.nan],\ [0,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02447}02447\ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02448}02448\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02449}02449\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.filterwarnings('ignore::RuntimeWarning')}\ \ \textcolor{comment}{\#\ np.mean\ warns}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02450}02450\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('z',\ [np.empty((0,\ 1,\ 2)}),\ np.empty((1,\ 1,\ 2))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02451}02451\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh17214(self,\ z):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02452}02452\ \ \ \ \ \ \ \ \ res\ =\ stats.mode(z,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02453}02453\ \ \ \ \ \ \ \ \ ref\ =\ np.mean(z,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02454}02454\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res[0].shape\ ==\ res[1].shape\ ==\ ref.shape\ ==\ (1,\ 1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02455}02455\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02456}02456\ \ \ \ \ \textcolor{keyword}{def\ }test\_raise\_non\_numeric\_gh18254(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02457}02457\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}Argument\ \`{}a`\ is\ not\ recognized\ as\ numeric."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02458}02458\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02459}02459\ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }ArrLike():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02460}02460\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02461}02461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMode_a2ef97426529ecd06278fc4f0de76d15e}{\_x}}\ =\ x}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02462}02462\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02463}02463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_array\_\_(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02464}02464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMode_a2ef97426529ecd06278fc4f0de76d15e}{\_x}}.astype(object)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02465}02465\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02466}02466\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02467}02467\ \ \ \ \ \ \ \ \ \ \ \ \ stats.mode(ArrLike(np.arange(3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02468}02468\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02469}02469\ \ \ \ \ \ \ \ \ \ \ \ \ stats.mode(np.arange(3,\ dtype=object))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02470}02470\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02471}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM}{02471}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM}{TestSEM}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02472}02472\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02473}02473\ \ \ \ \ testcase\ =\ [1,\ 2,\ 3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02474}02474\ \ \ \ \ scalar\_testcase\ =\ 4.}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02475}02475\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02476}02476\ \ \ \ \ \textcolor{keyword}{def\ }test\_sem(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02477}02477\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ not\ in\ R,\ so\ used:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02478}02478\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ sqrt(var(testcase)*3/4)/sqrt(3)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02479}02479\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02480}02480\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ y\ =\ stats.sem(self.shoes[0])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02481}02481\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ assert\_approx\_equal(y,0.775177399)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02482}02482\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02483}02483\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02484}02484\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.sem(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM_a3b2621bd81b7f2d3543799297d81e3c8}{scalar\_testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02485}02485\ \ \ \ \ \ \ \ \ assert\_(np.isnan(y))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02486}02486\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02487}02487\ \ \ \ \ \ \ \ \ y\ =\ stats.sem(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM_abb66858c0b6cc75f58589085927c638f}{testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02488}02488\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 0.6454972244)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02489}02489\ \ \ \ \ \ \ \ \ n\ =\ len(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM_abb66858c0b6cc75f58589085927c638f}{testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02490}02490\ \ \ \ \ \ \ \ \ assert\_allclose(stats.sem(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM_abb66858c0b6cc75f58589085927c638f}{testcase}},\ ddof=0)\ *\ np.sqrt(n/(n-\/2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02491}02491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.sem(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestSEM_abb66858c0b6cc75f58589085927c638f}{testcase}},\ ddof=2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02492}02492\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02493}02493\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02494}02494\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02495}02495\ \ \ \ \ \ \ \ \ assert\_equal(stats.sem(x),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02496}02496\ \ \ \ \ \ \ \ \ assert\_equal(stats.sem(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 0.9128709291752769)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02497}02497\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.sem,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02498}02498\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.sem,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02499}02499\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02500}02500\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02501}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestZmapZscore}{02501}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestZmapZscore}{TestZmapZscore}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02502}02502\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02503}02503\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02504}02504\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'x,\ y'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02505}02505\ \ \ \ \ \ \ \ \ [([1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02506}02506\ \ \ \ \ \ \ \ \ \ ([1,\ 2,\ 3],\ [0,\ 1,\ 2,\ 3,\ 4])]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02507}02507\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02508}02508\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap(self,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02509}02509\ \ \ \ \ \ \ \ \ z\ =\ stats.zmap(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02510}02510\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ these\ simple\ cases,\ calculate\ the\ expected\ result\ directly}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02511}02511\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ by\ using\ the\ formula\ for\ the\ z-\/score.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02512}02512\ \ \ \ \ \ \ \ \ expected\ =\ (x\ -\/\ np.mean(y))/np.std(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02513}02513\ \ \ \ \ \ \ \ \ assert\_allclose(z,\ expected,\ rtol=1e-\/12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02514}02514\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02515}02515\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02516}02516\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ use\ of\ 'axis'\ keyword\ in\ zmap.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02517}02517\ \ \ \ \ \ \ \ \ x\ =\ np.array([[0.0,\ 0.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02518}02518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 1.0,\ 1.0,\ 2.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02519}02519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.0,\ 0.0,\ 2.0,\ 0.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02520}02520\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02521}02521\ \ \ \ \ \ \ \ \ t1\ =\ 1.0/np.sqrt(2.0/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02522}02522\ \ \ \ \ \ \ \ \ t2\ =\ np.sqrt(3.)/3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02523}02523\ \ \ \ \ \ \ \ \ t3\ =\ np.sqrt(2.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02524}02524\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02525}02525\ \ \ \ \ \ \ \ \ z0\ =\ stats.zmap(x,\ x,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02526}02526\ \ \ \ \ \ \ \ \ z1\ =\ stats.zmap(x,\ x,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02527}02527\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02528}02528\ \ \ \ \ \ \ \ \ z0\_expected\ =\ [[-\/t1,\ -\/t3/2,\ -\/t3/2,\ 0.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02529}02529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ t3,\ -\/t3/2,\ t1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02530}02530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t1,\ -\/t3/2,\ t3,\ -\/t1]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02531}02531\ \ \ \ \ \ \ \ \ z1\_expected\ =\ [[-\/1.0,\ -\/1.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02532}02532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/t2,\ -\/t2,\ -\/t2,\ np.sqrt(3.)],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02533}02533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ -\/1.0,\ 1.0,\ -\/1.0]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02534}02534\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02535}02535\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z0,\ z0\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02536}02536\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z1,\ z1\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02537}02537\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02538}02538\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap\_ddof(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02539}02539\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ use\ of\ 'ddof'\ keyword\ in\ zmap.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02540}02540\ \ \ \ \ \ \ \ \ x\ =\ np.array([[0.0,\ 0.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02541}02541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ 1.0,\ 2.0,\ 3.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02542}02542\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02543}02543\ \ \ \ \ \ \ \ \ z\ =\ stats.zmap(x,\ x,\ axis=1,\ ddof=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02544}02544\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02545}02545\ \ \ \ \ \ \ \ \ z0\_expected\ =\ np.array([-\/0.5,\ -\/0.5,\ 0.5,\ 0.5])/(1.0/np.sqrt(3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02546}02546\ \ \ \ \ \ \ \ \ z1\_expected\ =\ np.array([-\/1.5,\ -\/0.5,\ 0.5,\ 1.5])/(np.sqrt(5./3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02547}02547\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z[0],\ z0\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02548}02548\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z[1],\ z1\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02549}02549\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02550}02550\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('ddof',\ [0,\ 2])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02551}02551\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap\_nan\_policy\_omit(self,\ ddof):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02552}02552\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ nans\ in\ \`{}scores`\ are\ propagated,\ regardless\ of\ \`{}nan\_policy`.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02553}02553\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}nan\_policy`\ only\ affects\ how\ nans\ in\ \`{}compare`\ are\ handled.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02554}02554\ \ \ \ \ \ \ \ \ scores\ =\ np.array([-\/3,\ -\/1,\ 2,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02555}02555\ \ \ \ \ \ \ \ \ compare\ =\ np.array([-\/8,\ -\/3,\ 2,\ 7,\ 12,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02556}02556\ \ \ \ \ \ \ \ \ z\ =\ stats.zmap(scores,\ compare,\ ddof=ddof,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02557}02557\ \ \ \ \ \ \ \ \ assert\_allclose(z,\ stats.zmap(scores,\ compare[\string~np.isnan(compare)],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02558}02558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ddof=ddof))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02559}02559\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02560}02560\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('ddof',\ [0,\ 2])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02561}02561\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap\_nan\_policy\_omit\_with\_axis(self,\ ddof):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02562}02562\ \ \ \ \ \ \ \ \ scores\ =\ np.arange(-\/5.0,\ 9.0).reshape(2,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02563}02563\ \ \ \ \ \ \ \ \ compare\ =\ np.linspace(-\/8,\ 6,\ 24).reshape(2,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02564}02564\ \ \ \ \ \ \ \ \ compare[0,\ 4]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02565}02565\ \ \ \ \ \ \ \ \ compare[0,\ 6]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02566}02566\ \ \ \ \ \ \ \ \ compare[1,\ 1]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02567}02567\ \ \ \ \ \ \ \ \ z\ =\ stats.zmap(scores,\ compare,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ axis=1,\ ddof=ddof)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02568}02568\ \ \ \ \ \ \ \ \ expected\ =\ np.array([stats.zmap(scores[0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02569}02569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compare[0][\string~np.isnan(compare[0])],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02570}02570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ddof=ddof),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02571}02571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.zmap(scores[1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02572}02572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compare[1][\string~np.isnan(compare[1])],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02573}02573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ddof=ddof)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02574}02574\ \ \ \ \ \ \ \ \ assert\_allclose(z,\ expected,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02575}02575\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02576}02576\ \ \ \ \ \textcolor{keyword}{def\ }test\_zmap\_nan\_policy\_raise(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02577}02577\ \ \ \ \ \ \ \ \ scores\ =\ np.array([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02578}02578\ \ \ \ \ \ \ \ \ compare\ =\ np.array([-\/8,\ -\/3,\ 2,\ 7,\ 12,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02579}02579\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'input\ contains\ nan'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02580}02580\ \ \ \ \ \ \ \ \ \ \ \ \ stats.zmap(scores,\ compare,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02581}02581\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02582}02582\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02583}02583\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ not\ in\ R,\ so\ tested\ by\ using:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02584}02584\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ (testcase[i]\ -\/\ mean(testcase,\ axis=0))\ /\ sqrt(var(testcase)\ *\ 3/4)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02585}02585\ \ \ \ \ \ \ \ \ y\ =\ stats.zscore([1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02586}02586\ \ \ \ \ \ \ \ \ desired\ =\ ([-\/1.3416407864999,\ -\/0.44721359549996,\ 0.44721359549996,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02587}02587\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.3416407864999])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02588}02588\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(desired,\ y,\ decimal=12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02589}02589\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02590}02590\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02591}02591\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ use\ of\ 'axis'\ keyword\ in\ zscore.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02592}02592\ \ \ \ \ \ \ \ \ x\ =\ np.array([[0.0,\ 0.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02593}02593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 1.0,\ 1.0,\ 2.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02594}02594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.0,\ 0.0,\ 2.0,\ 0.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02595}02595\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02596}02596\ \ \ \ \ \ \ \ \ t1\ =\ 1.0/np.sqrt(2.0/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02597}02597\ \ \ \ \ \ \ \ \ t2\ =\ np.sqrt(3.)/3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02598}02598\ \ \ \ \ \ \ \ \ t3\ =\ np.sqrt(2.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02599}02599\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02600}02600\ \ \ \ \ \ \ \ \ z0\ =\ stats.zscore(x,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02601}02601\ \ \ \ \ \ \ \ \ z1\ =\ stats.zscore(x,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02602}02602\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02603}02603\ \ \ \ \ \ \ \ \ z0\_expected\ =\ [[-\/t1,\ -\/t3/2,\ -\/t3/2,\ 0.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02604}02604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ t3,\ -\/t3/2,\ t1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02605}02605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t1,\ -\/t3/2,\ t3,\ -\/t1]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02606}02606\ \ \ \ \ \ \ \ \ z1\_expected\ =\ [[-\/1.0,\ -\/1.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02607}02607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/t2,\ -\/t2,\ -\/t2,\ np.sqrt(3.)],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02608}02608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ -\/1.0,\ 1.0,\ -\/1.0]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02609}02609\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02610}02610\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z0,\ z0\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02611}02611\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z1,\ z1\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02612}02612\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02613}02613\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_ddof(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02614}02614\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ use\ of\ 'ddof'\ keyword\ in\ zscore.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02615}02615\ \ \ \ \ \ \ \ \ x\ =\ np.array([[0.0,\ 0.0,\ 1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02616}02616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ 1.0,\ 2.0,\ 3.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02617}02617\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02618}02618\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ axis=1,\ ddof=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02619}02619\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02620}02620\ \ \ \ \ \ \ \ \ z0\_expected\ =\ np.array([-\/0.5,\ -\/0.5,\ 0.5,\ 0.5])/(1.0/np.sqrt(3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02621}02621\ \ \ \ \ \ \ \ \ z1\_expected\ =\ np.array([-\/1.5,\ -\/0.5,\ 0.5,\ 1.5])/(np.sqrt(5./3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02622}02622\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z[0],\ z0\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02623}02623\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z[1],\ z1\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02624}02624\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02625}02625\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_nan\_propagate(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02626}02626\ \ \ \ \ \ \ \ \ x\ =\ np.array([1,\ 2,\ np.nan,\ 4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02627}02627\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ nan\_policy=\textcolor{stringliteral}{'propagate'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02628}02628\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ all(np.isnan(z))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02629}02629\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02630}02630\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_nan\_omit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02631}02631\ \ \ \ \ \ \ \ \ x\ =\ np.array([1,\ 2,\ np.nan,\ 4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02632}02632\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02633}02633\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02634}02634\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02635}02635\ \ \ \ \ \ \ \ \ expected\ =\ np.array([-\/1.2649110640673518,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02636}02636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.6324555320336759,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02637}02637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.nan,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02638}02638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.6324555320336759,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02639}02639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.2649110640673518}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02640}02640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02641}02641\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(z,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02642}02642\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02643}02643\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_nan\_omit\_with\_ddof(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02644}02644\ \ \ \ \ \ \ \ \ x\ =\ np.array([np.nan,\ 1.0,\ 3.0,\ 5.0,\ 7.0,\ 9.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02645}02645\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ ddof=1,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02646}02646\ \ \ \ \ \ \ \ \ expected\ =\ np.r\_[np.nan,\ stats.zscore(x[1:],\ ddof=1)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02647}02647\ \ \ \ \ \ \ \ \ assert\_allclose(z,\ expected,\ rtol=1e-\/13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02648}02648\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02649}02649\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_nan\_raise(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02650}02650\ \ \ \ \ \ \ \ \ x\ =\ np.array([1,\ 2,\ np.nan,\ 4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02651}02651\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02652}02652\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.zscore,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02653}02653\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02654}02654\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_constant\_input\_1d(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02655}02655\ \ \ \ \ \ \ \ \ x\ =\ [-\/0.087]\ *\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02656}02656\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02657}02657\ \ \ \ \ \ \ \ \ assert\_equal(z,\ np.full(len(x),\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02658}02658\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02659}02659\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_constant\_input\_2d(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02660}02660\ \ \ \ \ \ \ \ \ x\ =\ np.array([[10.0,\ 10.0,\ 10.0,\ 10.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02661}02661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10.0,\ 11.0,\ 12.0,\ 13.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02662}02662\ \ \ \ \ \ \ \ \ z0\ =\ stats.zscore(x,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02663}02663\ \ \ \ \ \ \ \ \ assert\_equal(z0,\ np.array([[np.nan,\ -\/1.0,\ -\/1.0,\ -\/1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02664}02664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ 1.0,\ 1.0,\ 1.0]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02665}02665\ \ \ \ \ \ \ \ \ z1\ =\ stats.zscore(x,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02666}02666\ \ \ \ \ \ \ \ \ assert\_equal(z1,\ np.array([[np.nan,\ np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02667}02667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.zscore(x[1])]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02668}02668\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02669}02669\ \ \ \ \ \ \ \ \ assert\_equal(z,\ stats.zscore(x.ravel()).reshape(x.shape))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02670}02670\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02671}02671\ \ \ \ \ \ \ \ \ y\ =\ np.ones((3,\ 6))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02672}02672\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(y,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02673}02673\ \ \ \ \ \ \ \ \ assert\_equal(z,\ np.full(y.shape,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02674}02674\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02675}02675\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_constant\_input\_2d\_nan\_policy\_omit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02676}02676\ \ \ \ \ \ \ \ \ x\ =\ np.array([[10.0,\ 10.0,\ 10.0,\ 10.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02677}02677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10.0,\ 11.0,\ 12.0,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02678}02678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10.0,\ 12.0,\ np.nan,\ 10.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02679}02679\ \ \ \ \ \ \ \ \ z0\ =\ stats.zscore(x,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02680}02680\ \ \ \ \ \ \ \ \ s\ =\ np.sqrt(3/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02681}02681\ \ \ \ \ \ \ \ \ s2\ =\ np.sqrt(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02682}02682\ \ \ \ \ \ \ \ \ assert\_allclose(z0,\ np.array([[np.nan,\ -\/s,\ -\/1.0,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02683}02683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ 0,\ 1.0,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02684}02684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [np.nan,\ s,\ np.nan,\ np.nan]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02685}02685\ \ \ \ \ \ \ \ \ z1\ =\ stats.zscore(x,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02686}02686\ \ \ \ \ \ \ \ \ assert\_allclose(z1,\ np.array([[np.nan,\ np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02687}02687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/s,\ 0,\ s,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02688}02688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/s2/2,\ s2,\ np.nan,\ -\/s2/2]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02689}02689\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02690}02690\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_2d\_all\_nan\_row(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02691}02691\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ row\ is\ all\ nan,\ and\ we\ use\ axis=1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02692}02692\ \ \ \ \ \ \ \ \ x\ =\ np.array([[np.nan,\ np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02693}02693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10.0,\ 10.0,\ 12.0,\ 12.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02694}02694\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02695}02695\ \ \ \ \ \ \ \ \ assert\_equal(z,\ np.array([[np.nan,\ np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02696}02696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.0,\ -\/1.0,\ 1.0,\ 1.0]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02697}02697\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02698}02698\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_2d\_all\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02699}02699\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ entire\ 2d\ array\ is\ nan,\ and\ we\ use\ axis=None.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02700}02700\ \ \ \ \ \ \ \ \ y\ =\ np.full((2,\ 3),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02701}02701\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(y,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02702}02702\ \ \ \ \ \ \ \ \ assert\_equal(z,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02703}02703\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02704}02704\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('x',\ [np.array([])},\ np.zeros((3,\ 0,\ 5))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02705}02705\ \ \ \ \ \textcolor{keyword}{def\ }test\_zscore\_empty\_input(self,\ x):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02706}02706\ \ \ \ \ \ \ \ \ z\ =\ stats.zscore(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02707}02707\ \ \ \ \ \ \ \ \ assert\_equal(z,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02708}02708\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02709}02709\ \ \ \ \ \textcolor{keyword}{def\ }test\_gzscore\_normal\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02710}02710\ \ \ \ \ \ \ \ \ z\ =\ stats.gzscore([1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02711}02711\ \ \ \ \ \ \ \ \ desired\ =\ ([-\/1.526072095151,\ -\/0.194700599824,\ 0.584101799472,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02712}02712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.136670895503])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02713}02713\ \ \ \ \ \ \ \ \ assert\_allclose(desired,\ z)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02714}02714\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02715}02715\ \ \ \ \ \textcolor{keyword}{def\ }test\_gzscore\_masked\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02716}02716\ \ \ \ \ \ \ \ \ x\ =\ np.array([1,\ 2,\ -\/1,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02717}02717\ \ \ \ \ \ \ \ \ mx\ =\ np.ma.masked\_array(x,\ mask=[0,\ 0,\ 1,\ 0,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02718}02718\ \ \ \ \ \ \ \ \ z\ =\ stats.gzscore(mx)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02719}02719\ \ \ \ \ \ \ \ \ desired\ =\ ([-\/1.526072095151,\ -\/0.194700599824,\ np.inf,\ 0.584101799472,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02720}02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.136670895503])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02721}02721\ \ \ \ \ \ \ \ \ assert\_allclose(desired,\ z)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02722}02722\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02723}02723\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02724}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation}{02724}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation}{TestMedianAbsDeviation}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02725}02725\ \ \ \ \ \textcolor{keyword}{def\ }setup\_class(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02726}02726\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation_ac4a7c5c50587674220bdfcd819bbfc30}{dat\_nan}}\ =\ np.array([2.20,\ 2.20,\ 2.4,\ 2.4,\ 2.5,\ 2.7,\ 2.8,\ 2.9,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02727}02727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.03,\ 3.03,\ 3.10,\ 3.37,\ 3.4,\ 3.4,\ 3.4,\ 3.5,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02728}02728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.6,\ 3.7,\ 3.7,\ 3.7,\ 3.7,\ 3.77,\ 5.28,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02729}02729\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation_a78e52de489f2247caae0c6c5748e28d8}{dat}}\ =\ np.array([2.20,\ 2.20,\ 2.4,\ 2.4,\ 2.5,\ 2.7,\ 2.8,\ 2.9,\ 3.03,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02730}02730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.03,\ 3.10,\ 3.37,\ 3.4,\ 3.4,\ 3.4,\ 3.5,\ 3.6,\ 3.7,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02731}02731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.7,\ 3.7,\ 3.7,\ 3.77,\ 5.28,\ 28.95])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02732}02732\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02733}02733\ \ \ \ \ \textcolor{keyword}{def\ }test\_median\_abs\_deviation(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02734}02734\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.median\_abs\_deviation(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation_a78e52de489f2247caae0c6c5748e28d8}{dat}},\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02735}02735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.355)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02736}02736\ \ \ \ \ \ \ \ \ dat\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation_a78e52de489f2247caae0c6c5748e28d8}{dat}}.reshape(6,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02737}02737\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(dat,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02738}02738\ \ \ \ \ \ \ \ \ mad\_expected\ =\ np.asarray([0.435,\ 0.5,\ 0.45,\ 0.4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02739}02739\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(mad,\ mad\_expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02740}02740\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02741}02741\ \ \ \ \ \textcolor{keyword}{def\ }test\_mad\_nan\_omit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02742}02742\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMedianAbsDeviation_ac4a7c5c50587674220bdfcd819bbfc30}{dat\_nan}},\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02743}02743\ \ \ \ \ \ \ \ \ assert\_almost\_equal(mad,\ 0.34)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02744}02744\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02745}02745\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis\_and\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02746}02746\ \ \ \ \ \ \ \ \ x\ =\ np.array([[1.0,\ 2.0,\ 3.0,\ 4.0,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02747}02747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.0,\ 4.0,\ 5.0,\ 8.0,\ 9.0]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02748}02748\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(x,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02749}02749\ \ \ \ \ \ \ \ \ assert\_equal(mad,\ np.array([np.nan,\ 3.0]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02750}02750\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02751}02751\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_omit\_with\_inf(sef):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02752}02752\ \ \ \ \ \ \ \ \ z\ =\ np.array([1,\ 3,\ 4,\ 6,\ 99,\ np.nan,\ np.inf])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02753}02753\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(z,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02754}02754\ \ \ \ \ \ \ \ \ assert\_equal(mad,\ 3.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02755}02755\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02756}02756\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('axis',\ [0,\ 1,\ 2,\ None])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02757}02757\ \ \ \ \ \textcolor{keyword}{def\ }test\_size\_zero\_with\_axis(self,\ axis):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02758}02758\ \ \ \ \ \ \ \ \ x\ =\ np.zeros((3,\ 0,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02759}02759\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(x,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02760}02760\ \ \ \ \ \ \ \ \ assert\_equal(mad,\ np.full\_like(x.sum(axis=axis),\ fill\_value=np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02761}02761\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02762}02762\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'nan\_policy,\ expected'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02763}02763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(\textcolor{stringliteral}{'omit'},\ np.array([np.nan,\ 1.5,\ 1.5])),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02764}02764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'propagate'},\ np.array([np.nan,\ np.nan,\ 1.5]))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02765}02765\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_with\_axis(self,\ nan\_policy,\ expected):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02766}02766\ \ \ \ \ \ \ \ \ x\ =\ np.array([[np.nan,\ np.nan,\ np.nan,\ np.nan,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02767}02767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 5,\ 3,\ 6,\ np.nan,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02768}02768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 6,\ 7,\ 9,\ 9,\ 10]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02769}02769\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(x,\ nan\_policy=nan\_policy,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02770}02770\ \ \ \ \ \ \ \ \ assert\_equal(mad,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02771}02771\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02772}02772\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'axis,\ expected'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02773}02773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(1,\ [2.5,\ 2.0,\ 12.0]),\ (\textcolor{keywordtype}{None},\ 4.5)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02774}02774\ \ \ \ \ \textcolor{keyword}{def\ }test\_center\_mean\_with\_nan(self,\ axis,\ expected):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02775}02775\ \ \ \ \ \ \ \ \ x\ =\ np.array([[1,\ 2,\ 4,\ 9,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02776}02776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1,\ 1,\ 1,\ 12],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02777}02777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/10,\ -\/10,\ -\/10,\ 20,\ 20]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02778}02778\ \ \ \ \ \ \ \ \ mad\ =\ stats.median\_abs\_deviation(x,\ center=np.mean,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02779}02779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02780}02780\ \ \ \ \ \ \ \ \ assert\_allclose(mad,\ expected,\ rtol=1e-\/15,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02781}02781\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02782}02782\ \ \ \ \ \textcolor{keyword}{def\ }test\_center\_not\_callable(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02783}02783\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=\textcolor{stringliteral}{'callable'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02784}02784\ \ \ \ \ \ \ \ \ \ \ \ \ stats.median\_abs\_deviation([1,\ 2,\ 3,\ 5],\ center=99)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02785}02785\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02786}02786\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02787}\mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__stats_acba029ec622d3342752d6633463b95b2}{02787}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__stats_acba029ec622d3342752d6633463b95b2}{\_check\_warnings}}(warn\_list,\ expected\_type,\ expected\_len):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02788}02788\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02789}02789\ \textcolor{stringliteral}{\ \ \ \ Checks\ that\ all\ of\ the\ warnings\ from\ a\ list\ returned\ by}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02790}02790\ \textcolor{stringliteral}{\ \ \ \ \`{}warnings.catch\_all(record=True)\`{}\ are\ of\ the\ required\ type\ and\ that\ the\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02791}02791\ \textcolor{stringliteral}{\ \ \ \ contains\ expected\ number\ of\ warnings.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02792}02792\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02793}02793\ \ \ \ \ assert\_equal(len(warn\_list),\ expected\_len,\ \textcolor{stringliteral}{"{}number\ of\ warnings"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02794}02794\ \ \ \ \ \textcolor{keywordflow}{for}\ warn\_\ \textcolor{keywordflow}{in}\ warn\_list:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02795}02795\ \ \ \ \ \ \ \ \ assert\_(warn\_.category\ \textcolor{keywordflow}{is}\ expected\_type)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02796}02796\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02797}02797\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02798}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestIQR}{02798}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestIQR}{TestIQR}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02799}02799\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02800}02800\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02801}02801\ \ \ \ \ \ \ \ \ x\ =\ np.arange(8)\ *\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02802}02802\ \ \ \ \ \ \ \ \ np.random.shuffle(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02803}02803\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 1.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02804}02804\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02805}02805\ \ \ \ \ \textcolor{keyword}{def\ }test\_api(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02806}02806\ \ \ \ \ \ \ \ \ d\ =\ np.ones((5,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02807}02807\ \ \ \ \ \ \ \ \ stats.iqr(d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02808}02808\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02809}02809\ \ \ \ \ \ \ \ \ stats.iqr(d,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02810}02810\ \ \ \ \ \ \ \ \ stats.iqr(d,\ (0,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02811}02811\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None},\ (10,\ 90))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02812}02812\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None},\ (30,\ 20),\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02813}02813\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None},\ (25,\ 75),\ 1.5,\ \textcolor{stringliteral}{'propagate'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02814}02814\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None},\ (50,\ 50),\ \textcolor{stringliteral}{'normal'},\ \textcolor{stringliteral}{'raise'},\ \textcolor{stringliteral}{'linear'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02815}02815\ \ \ \ \ \ \ \ \ stats.iqr(d,\ \textcolor{keywordtype}{None},\ (25,\ 75),\ -\/0.4,\ \textcolor{stringliteral}{'omit'},\ \textcolor{stringliteral}{'lower'},\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02816}02816\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02817}02817\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02818}02818\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr([]),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02819}02819\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(np.arange(0)),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02820}02820\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02821}02821\ \ \ \ \ \textcolor{keyword}{def\ }test\_constant(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02822}02822\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Constant\ array\ always\ gives\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02823}02823\ \ \ \ \ \ \ \ \ x\ =\ np.ones((7,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02824}02824\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02825}02825\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=0),\ np.zeros(4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02826}02826\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=1),\ np.zeros(7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02827}02827\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'linear'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02828}02828\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'midpoint'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02829}02829\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'nearest'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02830}02830\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'lower'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02831}02831\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'higher'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02832}02832\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02833}02833\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 0\ only\ along\ constant\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02834}02834\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ also\ tests\ much\ of\ \`{}axis`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02835}02835\ \ \ \ \ \ \ \ \ y\ =\ np.ones((4,\ 5,\ 6))\ *\ np.arange(6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02836}02836\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=0),\ np.zeros((5,\ 6)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02837}02837\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=1),\ np.zeros((4,\ 6)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02838}02838\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=2),\ np.full((4,\ 5),\ 2.5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02839}02839\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=(0,\ 1)),\ np.zeros(6))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02840}02840\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=(0,\ 2)),\ np.full(5,\ 3.))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02841}02841\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(y,\ axis=(1,\ 2)),\ np.full(4,\ 3.))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02842}02842\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02843}02843\ \ \ \ \ \textcolor{keyword}{def\ }test\_scalarlike(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02844}02844\ \ \ \ \ \ \ \ \ x\ =\ np.arange(1)\ +\ 7.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02845}02845\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x[0]),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02846}02846\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02847}02847\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ keepdims=\textcolor{keyword}{True}),\ [0.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02848}02848\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02849}02849\ \ \ \ \ \textcolor{keyword}{def\ }test\_2D(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02850}02850\ \ \ \ \ \ \ \ \ x\ =\ np.arange(15).reshape((3,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02851}02851\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 7.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02852}02852\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=0),\ np.full(5,\ 5.))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02853}02853\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=1),\ np.full(3,\ 2.))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02854}02854\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=(0,\ 1)),\ 7.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02855}02855\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.iqr(x,\ axis=(1,\ 0)),\ 7.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02856}02856\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02857}02857\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02858}02858\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ \`{}axis`\ keyword\ is\ also\ put\ through\ its\ paces\ in\ \`{}test\_keepdims`.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02859}02859\ \ \ \ \ \ \ \ \ o\ =\ np.random.normal(size=(71,\ 23))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02860}02860\ \ \ \ \ \ \ \ \ x\ =\ np.dstack([o]\ *\ 10)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x.shape\ =\ (71,\ 23,\ 10)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02861}02861\ \ \ \ \ \ \ \ \ q\ =\ stats.iqr(o)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02862}02862\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02863}02863\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1)),\ q)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02864}02864\ \ \ \ \ \ \ \ \ x\ =\ np.moveaxis(x,\ -\/1,\ 0)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x.shape\ =\ (10,\ 71,\ 23)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02865}02865\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(2,\ 1)),\ q)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02866}02866\ \ \ \ \ \ \ \ \ x\ =\ x.swapaxes(0,\ 1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x.shape\ =\ (71,\ 10,\ 23)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02867}02867\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 2)),\ q)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02868}02868\ \ \ \ \ \ \ \ \ x\ =\ x.swapaxes(0,\ 1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x.shape\ =\ (10,\ 71,\ 23)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02869}02869\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02870}02870\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1,\ 2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02871}02871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(x,\ axis=\textcolor{keywordtype}{None}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02872}02872\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02873}02873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(x,\ axis=0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02874}02874\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02875}02875\ \ \ \ \ \ \ \ \ d\ =\ np.arange(3\ *\ 5\ *\ 7\ *\ 11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02876}02876\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Older\ versions\ of\ numpy\ only\ shuffle\ along\ axis=0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02877}02877\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Not\ sure\ about\ newer,\ don't\ care.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02878}02878\ \ \ \ \ \ \ \ \ np.random.shuffle(d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02879}02879\ \ \ \ \ \ \ \ \ d\ =\ d.reshape((3,\ 5,\ 7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02880}02880\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(0,\ 1,\ 2))[0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02881}02881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[:,:,:,\ 0].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02882}02882\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(0,\ 1,\ 3))[1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02883}02883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[:,:,\ 1,:].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02884}02884\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(3,\ 1,\ -\/4))[2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02885}02885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[:,:,\ 2,:].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02886}02886\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(3,\ 1,\ 2))[2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02887}02887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[2,:,:,:].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02888}02888\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(3,\ 2))[2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02889}02889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[2,\ 1,:,:].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02890}02890\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(1,\ -\/2))[2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02891}02891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[2,\ :,\ :,\ 1].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02892}02892\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(d,\ axis=(1,\ 3))[2,\ 2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02893}02893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(d[2,\ :,\ 2,:].ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02894}02894\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02895}02895\ \ \ \ \ \ \ \ \ assert\_raises(np.AxisError,\ stats.iqr,\ d,\ axis=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02896}02896\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ d,\ axis=(0,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02897}02897\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02898}02898\ \ \ \ \ \textcolor{keyword}{def\ }test\_rng(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02899}02899\ \ \ \ \ \ \ \ \ x\ =\ np.arange(5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02900}02900\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02901}02901\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ rng=(25,\ 87.5)),\ 2.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02902}02902\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ rng=(12.5,\ 75)),\ 2.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02903}02903\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.iqr(x,\ rng=(10,\ 50)),\ 1.6)\ \ \textcolor{comment}{\#\ 3-\/1.4}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02904}02904\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02905}02905\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ rng=(0,\ 101))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02906}02906\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ rng=(np.nan,\ 25))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02907}02907\ \ \ \ \ \ \ \ \ assert\_raises(TypeError,\ stats.iqr,\ x,\ rng=(0,\ 50,\ 60))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02908}02908\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02909}02909\ \ \ \ \ \textcolor{keyword}{def\ }test\_interpolation(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02910}02910\ \ \ \ \ \ \ \ \ x\ =\ np.arange(5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02911}02911\ \ \ \ \ \ \ \ \ y\ =\ np.arange(4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02912}02912\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Default}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02913}02913\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02914}02914\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y),\ 1.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02915}02915\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Linear}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02916}02916\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'linear'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02917}02917\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y,\ interpolation=\textcolor{stringliteral}{'linear'}),\ 1.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02918}02918\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Higher}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02919}02919\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'higher'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02920}02920\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ rng=(25,\ 80),\ interpolation=\textcolor{stringliteral}{'higher'}),\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02921}02921\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y,\ interpolation=\textcolor{stringliteral}{'higher'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02922}02922\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Lower\ (will\ generally,\ but\ not\ always\ be\ the\ same\ as\ higher)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02923}02923\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'lower'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02924}02924\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ rng=(25,\ 80),\ interpolation=\textcolor{stringliteral}{'lower'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02925}02925\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y,\ interpolation=\textcolor{stringliteral}{'lower'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02926}02926\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Nearest}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02927}02927\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'nearest'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02928}02928\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y,\ interpolation=\textcolor{stringliteral}{'nearest'}),\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02929}02929\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Midpoint}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02930}02930\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ interpolation=\textcolor{stringliteral}{'midpoint'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02931}02931\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ rng=(25,\ 80),\ interpolation=\textcolor{stringliteral}{'midpoint'}),\ 2.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02932}02932\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(y,\ interpolation=\textcolor{stringliteral}{'midpoint'}),\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02933}02933\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02934}02934\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ all\ method=\ values\ new\ in\ numpy\ 1.22.0\ are\ accepted}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02935}02935\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{classnumpy_1_1lib_1_1__version_1_1NumpyVersion}{NumpyVersion}}(np.\_\_version\_\_)\ >=\ \textcolor{stringliteral}{'1.22.0'}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02936}02936\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ method\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'inverted\_cdf'},\ \textcolor{stringliteral}{'averaged\_inverted\_cdf'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02937}02937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'closest\_observation'},\ \textcolor{stringliteral}{'interpolated\_inverted\_cdf'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02938}02938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'hazen'},\ \textcolor{stringliteral}{'weibull'},\ \textcolor{stringliteral}{'median\_unbiased'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02939}02939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'normal\_unbiased'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02940}02940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr(y,\ interpolation=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02941}02941\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02942}02942\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ interpolation=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02943}02943\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02944}02944\ \ \ \ \ \textcolor{keyword}{def\ }test\_keepdims(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02945}02945\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Also\ tests\ most\ of\ \`{}axis`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02946}02946\ \ \ \ \ \ \ \ \ x\ =\ np.ones((3,\ 5,\ 7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02947}02947\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{False}).shape,\ ())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02948}02948\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=2,\ keepdims=\textcolor{keyword}{False}).shape,\ (3,\ 5,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02949}02949\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1),\ keepdims=\textcolor{keyword}{False}).shape,\ (7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02950}02950\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 3),\ keepdims=\textcolor{keyword}{False}).shape,\ (5,\ 7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02951}02951\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(1,),\ keepdims=\textcolor{keyword}{False}).shape,\ (3,\ 7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02952}02952\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ (0,\ 1,\ 2,\ 3),\ keepdims=\textcolor{keyword}{False}).shape,\ ())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02953}02953\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1,\ 3),\ keepdims=\textcolor{keyword}{False}).shape,\ (7,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02954}02954\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02955}02955\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=\textcolor{keywordtype}{None},\ keepdims=\textcolor{keyword}{True}).shape,\ (1,\ 1,\ 1,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02956}02956\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=2,\ keepdims=\textcolor{keyword}{True}).shape,\ (3,\ 5,\ 1,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02957}02957\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1),\ keepdims=\textcolor{keyword}{True}).shape,\ (1,\ 1,\ 7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02958}02958\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 3),\ keepdims=\textcolor{keyword}{True}).shape,\ (1,\ 5,\ 7,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02959}02959\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(1,),\ keepdims=\textcolor{keyword}{True}).shape,\ (3,\ 1,\ 7,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02960}02960\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ (0,\ 1,\ 2,\ 3),\ keepdims=\textcolor{keyword}{True}).shape,\ (1,\ 1,\ 1,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02961}02961\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=(0,\ 1,\ 3),\ keepdims=\textcolor{keyword}{True}).shape,\ (1,\ 1,\ 7,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02962}02962\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02963}02963\ \ \ \ \ \textcolor{keyword}{def\ }test\_nanpolicy(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02964}02964\ \ \ \ \ \ \ \ \ x\ =\ np.arange(15.0).reshape((3,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02965}02965\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02966}02966\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ No\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02967}02967\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02968}02968\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02969}02969\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ nan\_policy=\textcolor{stringliteral}{'raise'}),\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02970}02970\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02971}02971\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Yes\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02972}02972\ \ \ \ \ \ \ \ \ x[1,\ 2]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02973}02973\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02974}02974\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02975}02975\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02976}02976\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=0,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ [5,\ 5,\ np.nan,\ 5,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02977}02977\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ [2,\ np.nan,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02978}02978\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02979}02979\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02980}02980\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02981}02981\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 7.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02982}02982\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=0,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ np.full(5,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02983}02983\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ [2,\ 2.5,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02984}02984\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02985}02985\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02986}02986\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ axis=0,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02987}02987\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02988}02988\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02989}02989\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Bad\ policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02990}02990\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ nan\_policy=\textcolor{stringliteral}{'barfood'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02991}02991\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02992}02992\ \ \ \ \ \textcolor{keyword}{def\ }test\_scale(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02993}02993\ \ \ \ \ \ \ \ \ x\ =\ np.arange(15.0).reshape((3,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02994}02994\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02995}02995\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ No\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02996}02996\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=1.0),\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02997}02997\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.iqr(x,\ scale=\textcolor{stringliteral}{'normal'}),\ 7\ /\ 1.3489795)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02998}02998\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=2.0),\ 3.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l02999}02999\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03000}03000\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Yes\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03001}03001\ \ \ \ \ \ \ \ \ x[1,\ 2]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03002}03002\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03003}03003\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03004}03004\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=1.0,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03005}03005\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=\textcolor{stringliteral}{'normal'},\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03006}03006\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=2.0,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03007}03007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ axis=1\ chosen\ to\ show\ behavior\ with\ both\ nans\ and\ without}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03008}03008\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=1,\ scale=1.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03009}03009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy=\textcolor{stringliteral}{'propagate'}),\ [2,\ np.nan,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03010}03010\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.iqr(x,\ axis=1,\ scale=\textcolor{stringliteral}{'normal'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03011}03011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy=\textcolor{stringliteral}{'propagate'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03012}03012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([2,\ np.nan,\ 2])\ /\ 1.3489795)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03013}03013\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ axis=1,\ scale=2.0,\ nan\_policy=\textcolor{stringliteral}{'propagate'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03014}03014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ np.nan,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03015}03015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Since\ NumPy\ 1.17.0.dev,\ warnings\ are\ no\ longer\ emitted\ by}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03016}03016\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ np.percentile\ with\ nans,\ so\ we\ don't\ check\ the\ number\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03017}03017\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ warnings\ here.\ See\ https://github.com/numpy/numpy/pull/12679.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03018}03018\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03019}03019\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=1.0,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 7.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03020}03020\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.iqr(x,\ scale=\textcolor{stringliteral}{'normal'},\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03021}03021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 7.5\ /\ 1.3489795)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03022}03022\ \ \ \ \ \ \ \ \ assert\_equal(stats.iqr(x,\ scale=2.0,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 3.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03023}03023\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03024}03024\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Bad\ scale}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03025}03025\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.iqr,\ x,\ scale=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03026}03026\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03027}03027\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03028}03028\ \ \ \ \ \ \ \ \ \ \ \ \ DeprecationWarning,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03029}03029\ \ \ \ \ \ \ \ \ \ \ \ \ match=\textcolor{stringliteral}{"{}The\ use\ of\ 'scale=\(\backslash\)"{}raw\(\backslash\)"{}'"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03030}03030\ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03031}03031\ \ \ \ \ \ \ \ \ \ \ \ \ stats.iqr([1],\ scale=\textcolor{stringliteral}{'raw'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03032}03032\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03033}03033\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03034}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments}{03034}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments}{TestMoments}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03035}03035\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03036}03036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Comparison\ numbers\ are\ found\ using\ R\ v.1.5.1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03037}03037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ note\ that\ length(testcase)\ =\ 4}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03038}03038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ testmathworks\ comes\ from\ documentation\ for\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03039}03039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Statistics\ Toolbox\ for\ Matlab\ and\ can\ be\ found\ at\ both}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03040}03040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://www.mathworks.com/help/stats/kurtosis.html}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03041}03041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://www.mathworks.com/help/stats/skewness.html}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03042}03042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Note\ that\ both\ test\ cases\ came\ from\ here.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03043}03043\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03044}03044\ \ \ \ \ testcase\ =\ [1,2,3,4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03045}03045\ \ \ \ \ scalar\_testcase\ =\ 4.}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03046}03046\ \ \ \ \ np.random.seed(1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03047}03047\ \ \ \ \ testcase\_moment\_accuracy\ =\ np.random.rand(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03048}03048\ \ \ \ \ testmathworks\ =\ [1.165,\ 0.6268,\ 0.0751,\ 0.3516,\ -\/0.6965]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03049}03049\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03050}03050\ \ \ \ \ \textcolor{keyword}{def\ }\_assert\_equal(self,\ actual,\ expect,\ *,\ shape=None,\ dtype=None):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03051}03051\ \ \ \ \ \ \ \ \ expect\ =\ np.asarray(expect)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03052}03052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ shape\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03053}03053\ \ \ \ \ \ \ \ \ \ \ \ \ expect\ =\ np.broadcast\_to(expect,\ shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03054}03054\ \ \ \ \ \ \ \ \ assert\_array\_equal(actual,\ expect)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03055}03055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dtype\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03056}03056\ \ \ \ \ \ \ \ \ \ \ \ \ dtype\ =\ expect.dtype}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03057}03057\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ actual.dtype\ ==\ dtype}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03058}03058\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03059}03059\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('size',\ [10,\ (10,\ 2)}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03060}03060\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('m,\ c',\ product((0,\ 1,\ 2,\ 3)},\ (\textcolor{keywordtype}{None},\ 0,\ 1)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03061}03061\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment\_center\_scalar\_moment(self,\ size,\ m,\ c):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03062}03062\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(6581432544381372042)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03063}03063\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03064}03064\ \ \ \ \ \ \ \ \ res\ =\ stats.moment(x,\ m,\ center=c)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03065}03065\ \ \ \ \ \ \ \ \ c\ =\ np.mean(x,\ axis=0)\ \textcolor{keywordflow}{if}\ c\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ c}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03066}03066\ \ \ \ \ \ \ \ \ ref\ =\ np.sum((x\ -\/\ c)**m,\ axis=0)/len(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03067}03067\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ ref,\ atol=1e-\/16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03068}03068\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03069}03069\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('size',\ [10,\ (10,\ 2)}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03070}03070\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('c',\ (None,\ 0,\ 1)})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03071}03071\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment\_center\_array\_moment(self,\ size,\ c):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03072}03072\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(1706828300224046506)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03073}03073\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03074}03074\ \ \ \ \ \ \ \ \ m\ =\ [0,\ 1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03075}03075\ \ \ \ \ \ \ \ \ res\ =\ stats.moment(x,\ m,\ center=c)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03076}03076\ \ \ \ \ \ \ \ \ ref\ =\ [stats.moment(x,\ i,\ center=c)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ m]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03077}03077\ \ \ \ \ \ \ \ \ assert\_equal(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03078}03078\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03079}03079\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03080}03080\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ mean((testcase-\/mean(testcase))**power,axis=0),axis=0))**power))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03081}03081\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a73a069f7fa641cf8c1de8251a76b3ffb}{scalar\_testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03082}03082\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03083}03083\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03084}03084\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03085}03085\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03086}03086\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 0.0,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03087}03087\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03088}03088\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 1.25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03089}03089\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03090}03090\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03091}03091\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03092}03092\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 2.5625)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03093}03093\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03094}03094\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ array\_like\ input\ for\ moment}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03095}03095\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ [1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03096}03096\ \ \ \ \ \ \ \ \ assert\_allclose(y,\ [0,\ 1.25,\ 0,\ 2.5625])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03097}03097\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03098}03098\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ moment\ input\ consists\ only\ of\ integers}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03099}03099\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03100}03100\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03101}03101\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.moment,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 1.2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03102}03102\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ [1.0,\ 2,\ 3,\ 4.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03103}03103\ \ \ \ \ \ \ \ \ assert\_allclose(y,\ [0,\ 1.25,\ 0,\ 2.5625])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03104}03104\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03105}03105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ empty\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03106}03106\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03107}03107\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03108}03108\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.moment([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03109}03109\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ np.nan,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03110}03110\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.moment(np.array([],\ dtype=np.float32))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03111}03111\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ np.nan,\ dtype=np.float32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03112}03112\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.moment(np.zeros((1,\ 0)),\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03113}03113\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ [],\ shape=(0,),\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03114}03114\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.moment([[]],\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03115}03115\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ np.nan,\ shape=(1,),\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03116}03116\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ stats.moment([[]],\ moment=[0,\ 1],\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03117}03117\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ [],\ shape=(2,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03118}03118\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03119}03119\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03120}03120\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03121}03121\ \ \ \ \ \ \ \ \ assert\_equal(stats.moment(x,\ 2),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03122}03122\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.moment(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03123}03123\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.moment,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03124}03124\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.moment,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03125}03125\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03126}03126\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('dtype',\ [np.float32,\ np.float64,\ np.complex128])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03127}03127\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('expect,\ moment',\ [(0,\ 1)},\ (1,\ 0)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03128}03128\ \ \ \ \ \textcolor{keyword}{def\ }test\_constant\_moments(self,\ dtype,\ expect,\ moment):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03129}03129\ \ \ \ \ \ \ \ \ x\ =\ np.random.rand(5).astype(dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03130}03130\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(x,\ moment=moment)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03131}03131\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ expect,\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03132}03132\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03133}03133\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(np.broadcast\_to(x,\ (6,\ 5)),\ axis=0,\ moment=moment)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03134}03134\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ expect,\ shape=(5,),\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03135}03135\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03136}03136\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(np.broadcast\_to(x,\ (1,\ 2,\ 3,\ 4,\ 5)),\ axis=2,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03137}03137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ moment=moment)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03138}03138\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ expect,\ shape=(1,\ 2,\ 4,\ 5),\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03139}03139\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03140}03140\ \ \ \ \ \ \ \ \ y\ =\ stats.moment(np.broadcast\_to(x,\ (1,\ 2,\ 3,\ 4,\ 5)),\ axis=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03141}03141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ moment=moment)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03142}03142\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_afbce8caf2aab92f1b138847cd3284ea6}{\_assert\_equal}}(y,\ expect,\ shape=(),\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03143}03143\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03144}03144\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment\_propagate\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03145}03145\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ the\ shape\ of\ the\ result\ is\ the\ same\ for\ inputs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03146}03146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ and\ without\ nans,\ cf\ gh-\/5817}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03147}03147\ \ \ \ \ \ \ \ \ a\ =\ np.arange(8).reshape(2,\ -\/1).astype(float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03148}03148\ \ \ \ \ \ \ \ \ a[1,\ 0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03149}03149\ \ \ \ \ \ \ \ \ mm\ =\ stats.moment(a,\ 2,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03150}03150\ \ \ \ \ \ \ \ \ np.testing.assert\_allclose(mm,\ [1.25,\ np.nan],\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03151}03151\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03152}03152\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment\_empty\_moment(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03153}03153\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ tests\ moment\ with\ empty\ \`{}moment`\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03154}03154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{r"{}'moment'\ must\ be\ a\ scalar\ or\ a"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03155}03155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{r"{}\ non-\/empty\ 1D\ list/array."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03156}03156\ \ \ \ \ \ \ \ \ \ \ \ \ stats.moment([1,\ 2,\ 3,\ 4],\ moment=[])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03157}03157\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03158}03158\ \ \ \ \ \textcolor{keyword}{def\ }test\_skewness(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03159}03159\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scalar\ test\ case}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03160}03160\ \ \ \ \ \ \ \ \ y\ =\ stats.skew(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a73a069f7fa641cf8c1de8251a76b3ffb}{scalar\_testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03161}03161\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03162}03162\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sum((testmathworks-\/mean(testmathworks,axis=0))**3,axis=0)\ /}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03163}03163\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ ((sqrt(var(testmathworks)*4/5))**3)/5}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03164}03164\ \ \ \ \ \ \ \ \ y\ =\ stats.skew(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a15cf9c110746b0171e8e93f9622f9b32}{testmathworks}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03165}03165\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ -\/0.29322304336607,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03166}03166\ \ \ \ \ \ \ \ \ y\ =\ stats.skew(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a15cf9c110746b0171e8e93f9622f9b32}{testmathworks}},\ bias=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03167}03167\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ -\/0.437111105023940,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03168}03168\ \ \ \ \ \ \ \ \ y\ =\ stats.skew(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03169}03169\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 0.0,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03170}03170\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03171}03171\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03172}03172\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03173}03173\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03174}03174\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(stats.skew(x),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03175}03175\ \ \ \ \ \ \ \ \ assert\_equal(stats.skew(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ 0.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03176}03176\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.skew,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03177}03177\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.skew,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03178}03178\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03179}03179\ \ \ \ \ \textcolor{keyword}{def\ }test\_skewness\_scalar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03180}03180\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}skew`\ must\ return\ a\ scalar\ for\ 1-\/dim\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03181}03181\ \ \ \ \ \ \ \ \ assert\_equal(stats.skew(arange(10)),\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03182}03182\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03183}03183\ \ \ \ \ \textcolor{keyword}{def\ }test\_skew\_propagate\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03184}03184\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ the\ shape\ of\ the\ result\ is\ the\ same\ for\ inputs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03185}03185\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ and\ without\ nans,\ cf\ gh-\/5817}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03186}03186\ \ \ \ \ \ \ \ \ a\ =\ np.arange(8).reshape(2,\ -\/1).astype(float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03187}03187\ \ \ \ \ \ \ \ \ a[1,\ 0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03188}03188\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03189}03189\ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ stats.skew(a,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03190}03190\ \ \ \ \ \ \ \ \ np.testing.assert\_allclose(s,\ [0,\ np.nan],\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03191}03191\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03192}03192\ \ \ \ \ \textcolor{keyword}{def\ }test\_skew\_constant\_value(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03193}03193\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Skewness\ of\ a\ constant\ input\ should\ be\ zero\ even\ when\ the\ mean\ is\ not}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03194}03194\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ exact\ (gh-\/13245)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03195}03195\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03196}03196\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ np.repeat(-\/0.27829495,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03197}03197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew(a))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03198}03198\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew(a\ *\ float(2**50)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03199}03199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew(a\ /\ float(2**50)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03200}03200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew(a,\ bias=\textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03201}03201\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03202}03202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ similarly,\ from\ gh-\/11086:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03203}03203\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew([14.3]*7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03204}03204\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.skew(1\ +\ np.arange(-\/3,\ 4)*1e-\/16))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03205}03205\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03206}03206\ \ \ \ \ \textcolor{keyword}{def\ }test\_kurtosis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03207}03207\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scalar\ test\ case}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03208}03208\ \ \ \ \ \ \ \ \ y\ =\ stats.kurtosis(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a73a069f7fa641cf8c1de8251a76b3ffb}{scalar\_testcase}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03209}03209\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03210}03210\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ sum((testcase-\/mean(testcase,axis=0))**4,axis=0)/((sqrt(var(testcase)*3/4))**4)/4}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03211}03211\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ sum((test2-\/mean(testmathworks,axis=0))**4,axis=0)/((sqrt(var(testmathworks)*4/5))**4)/5}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03212}03212\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ Set\ flags\ for\ axis\ =\ 0\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03213}03213\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ fisher=0\ (Pearson's\ defn\ of\ kurtosis\ for\ compatibility\ with\ Matlab)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03214}03214\ \ \ \ \ \ \ \ \ y\ =\ stats.kurtosis(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a15cf9c110746b0171e8e93f9622f9b32}{testmathworks}},\ 0,\ fisher=0,\ bias=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03215}03215\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 2.1658856802973,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03216}03216\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03217}03217\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ MATLAB\ has\ confusing\ docs\ for\ the\ following\ case}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03218}03218\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ kurtosis(x,0)\ gives\ an\ unbiased\ estimate\ of\ Pearson's\ skewness}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03219}03219\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ kurtosis(x)\ \ gives\ a\ biased\ estimate\ of\ Fisher's\ skewness\ (Pearson-\/3)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03220}03220\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ The\ MATLAB\ docs\ imply\ that\ both\ should\ give\ Fisher's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03221}03221\ \ \ \ \ \ \ \ \ y\ =\ stats.kurtosis(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_a15cf9c110746b0171e8e93f9622f9b32}{testmathworks}},\ fisher=0,\ bias=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03222}03222\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 3.663542721189047,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03223}03223\ \ \ \ \ \ \ \ \ y\ =\ stats.kurtosis(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aef96312dc12e91344018f023710c6e96}{testcase}},\ 0,\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03224}03224\ \ \ \ \ \ \ \ \ assert\_approx\_equal(y,\ 1.64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03225}03225\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03226}03226\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03227}03227\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03228}03228\ \ \ \ \ \ \ \ \ assert\_equal(stats.kurtosis(x),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03229}03229\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.kurtosis(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ -\/1.230000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03230}03230\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosis,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03231}03231\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosis,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03232}03232\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03233}03233\ \ \ \ \ \textcolor{keyword}{def\ }test\_kurtosis\_array\_scalar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03234}03234\ \ \ \ \ \ \ \ \ assert\_equal(type(stats.kurtosis([1,\ 2,\ 3])),\ np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03235}03235\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03236}03236\ \ \ \ \ \textcolor{keyword}{def\ }test\_kurtosis\_propagate\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03237}03237\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ the\ shape\ of\ the\ result\ is\ the\ same\ for\ inputs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03238}03238\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ and\ without\ nans,\ cf\ gh-\/5817}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03239}03239\ \ \ \ \ \ \ \ \ a\ =\ np.arange(8).reshape(2,\ -\/1).astype(float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03240}03240\ \ \ \ \ \ \ \ \ a[1,\ 0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03241}03241\ \ \ \ \ \ \ \ \ k\ =\ stats.kurtosis(a,\ axis=1,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03242}03242\ \ \ \ \ \ \ \ \ np.testing.assert\_allclose(k,\ [-\/1.36,\ np.nan],\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03243}03243\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03244}03244\ \ \ \ \ \textcolor{keyword}{def\ }test\_kurtosis\_constant\_value(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03245}03245\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Kurtosis\ of\ a\ constant\ input\ should\ be\ zero,\ even\ when\ the\ mean\ is\ not}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03246}03246\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ exact\ (gh-\/13245)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03247}03247\ \ \ \ \ \ \ \ \ a\ =\ np.repeat(-\/0.27829495,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03248}03248\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03249}03249\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.kurtosis(a,\ fisher=\textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03250}03250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.kurtosis(a\ *\ float(2**50),\ fisher=\textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03251}03251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.kurtosis(a\ /\ float(2**50),\ fisher=\textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03252}03252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(stats.kurtosis(a,\ fisher=\textcolor{keyword}{False},\ bias=\textcolor{keyword}{False}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03253}03253\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03254}03254\ \ \ \ \ \textcolor{keyword}{def\ }test\_moment\_accuracy(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03255}03255\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 'moment'\ must\ have\ a\ small\ enough\ error\ compared\ to\ the\ slower}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03256}03256\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ but\ very\ accurate\ numpy.power()\ implementation.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03257}03257\ \ \ \ \ \ \ \ \ tc\_no\_mean\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aec456dd4695f5b188f60cd3f11724d35}{testcase\_moment\_accuracy}}\ -\/\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03258}03258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.mean(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aec456dd4695f5b188f60cd3f11724d35}{testcase\_moment\_accuracy}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03259}03259\ \ \ \ \ \ \ \ \ assert\_allclose(np.power(tc\_no\_mean,\ 42).mean(),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03260}03260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.moment(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestMoments_aec456dd4695f5b188f60cd3f11724d35}{testcase\_moment\_accuracy}},\ 42))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03261}03261\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03262}03262\ \ \ \ \ \textcolor{keyword}{def\ }test\_precision\_loss\_gh15554(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03263}03263\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ gh-\/15554\ was\ one\ of\ several\ issues\ that\ have\ reported\ problems\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03264}03264\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ constant\ or\ near-\/constant\ input.\ We\ can't\ always\ fix\ these,\ but}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03265}03265\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ make\ sure\ there's\ a\ warning.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03266}03266\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03267}03267\ \ \ \ \ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(34095309370)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03268}03268\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ rng.random(size=(100,\ 10))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03269}03269\ \ \ \ \ \ \ \ \ \ \ \ \ a[:,\ 0]\ =\ 1.01}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03270}03270\ \ \ \ \ \ \ \ \ \ \ \ \ stats.skew(a)[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03271}03271\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03272}03272\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_1d(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03273}03273\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03274}03274\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03275}03275\ \ \ \ \ \ \ \ \ \ \ \ \ stats.skew([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03276}03276\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03277}03277\ \ \ \ \ \ \ \ \ \ \ \ \ stats.kurtosis([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03278}03278\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03279}03279\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03280}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest}{03280}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest}{TestStudentTest}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03281}03281\ \ \ \ \ X1\ =\ np.array([-\/1,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03282}03282\ \ \ \ \ X2\ =\ np.array([0,\ 1,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03283}03283\ \ \ \ \ T1\_0\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03284}03284\ \ \ \ \ P1\_0\ =\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03285}03285\ \ \ \ \ T1\_1\ =\ -\/1.7320508075}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03286}03286\ \ \ \ \ P1\_1\ =\ 0.22540333075}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03287}03287\ \ \ \ \ T1\_2\ =\ -\/3.464102}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03288}03288\ \ \ \ \ P1\_2\ =\ 0.0741799}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03289}03289\ \ \ \ \ T2\_0\ =\ 1.732051}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03290}03290\ \ \ \ \ P2\_0\ =\ 0.2254033}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03291}03291\ \ \ \ \ P1\_1\_l\ =\ P1\_1\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03292}03292\ \ \ \ \ P1\_1\_g\ =\ 1\ -\/\ (P1\_1\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03293}03293\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03294}03294\ \ \ \ \ \textcolor{keyword}{def\ }test\_onesample(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03295}03295\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03296}03296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}},\ divide=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03297}03297\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03298}03298\ \ \ \ \ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(4.,\ 3.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03299}03299\ \ \ \ \ \ \ \ \ assert\_(np.isnan(t))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03300}03300\ \ \ \ \ \ \ \ \ assert\_(np.isnan(p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03301}03301\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03302}03302\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03303}03303\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03304}03304\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a9789e3d67614b67b0ab39f3bf95abacc}{T1\_0}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03305}03305\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a88d5ba325b9cec73463a9c89f41b75a8}{P1\_0}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03306}03306\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03307}03307\ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03308}03308\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03309}03309\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03310}03310\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03311}03311\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a8a143f35a0e5705770a7aa6789d14913}{X2}},\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03312}03312\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03313}03313\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a7a55aa27b42a2f3b1280aca7274c2f3f}{T2\_0}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03314}03314\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a7f996dc93415fdbfe12e38d4953f3544}{P2\_0}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03315}03315\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03316}03316\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03317}03317\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03318}03318\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a58b49808e33989fc963dc27806ef093a}{T1\_1}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03319}03319\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_abe39316f983a229a25254f540156af59}{P1\_1}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03320}03320\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03321}03321\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03322}03322\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03323}03323\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_af75ae9cc81181b94dc57bf9898d4ae26}{T1\_2}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03324}03324\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a68be6115b08f102d6917531e388bc243}{P1\_2}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03325}03325\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03326}03326\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ nan\ policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03327}03327\ \ \ \ \ \ \ \ \ x\ =\ stats.norm.rvs(loc=5,\ scale=10,\ size=51,\ random\_state=7654567)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03328}03328\ \ \ \ \ \ \ \ \ x[50]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03329}03329\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03330}03330\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.ttest\_1samp(x,\ 5.0),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03331}03331\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03332}03332\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_1samp(x,\ 5.0,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03333}03333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (-\/1.6412624074367159,\ 0.107147027334048005))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03334}03334\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_1samp,\ x,\ 5.0,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03335}03335\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_1samp,\ x,\ 5.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03336}03336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03337}03337\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03338}03338\ \ \ \ \ \textcolor{keyword}{def\ }test\_1samp\_alternative(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03339}03339\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_1samp,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03340}03340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{"{}error"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03341}03341\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03342}03342\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 1,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03343}03343\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a65ae1be703e7f1a714e81ecc465861c8}{P1\_1\_l}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03344}03344\ \ \ \ \ \ \ \ \ assert\_allclose(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a58b49808e33989fc963dc27806ef093a}{T1\_1}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03345}03345\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03346}03346\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4bb3dfccb3ec1016b522d792a7be6806}{X1}},\ 1,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03347}03347\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a4ef792d708675e10eee3c9276c696988}{P1\_1\_g}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03348}03348\ \ \ \ \ \ \ \ \ assert\_allclose(t,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestStudentTest_a58b49808e33989fc963dc27806ef093a}{T1\_1}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03349}03349\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03350}03350\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative"{},\ ['two-\/sided',\ 'less',\ 'greater'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03351}03351\ \ \ \ \ \textcolor{keyword}{def\ }test\_1samp\_ci\_1d(self,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03352}03352\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ confidence\ interval\ method\ against\ reference\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03353}03353\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(8066178009154342972)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03354}03354\ \ \ \ \ \ \ \ \ n\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03355}03355\ \ \ \ \ \ \ \ \ x\ =\ rng.normal(size=n,\ loc=1.5,\ scale=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03356}03356\ \ \ \ \ \ \ \ \ popmean\ =\ rng.normal()\ \ \textcolor{comment}{\#\ this\ shouldn't\ affect\ confidence\ interval}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03357}03357\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reference\ values\ generated\ with\ R\ t.test:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03358}03358\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03359}03359\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x\ =\ c(2.75532884,\ \ 0.93892217,\ \ 0.94835861,\ \ 1.49489446,\ -\/0.62396595,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03360}03360\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ -\/1.88019867,\ -\/1.55684465,\ \ 4.88777104,\ \ 5.15310979,\ \ 4.34656348)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03361}03361\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ t.test(x,\ conf.level=0.85,\ alternative='l')}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03362}03362\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03363}03363\ \ \ \ \ \ \ \ \ ref\ =\ \{\textcolor{stringliteral}{'two-\/sided'}:\ [0.3594423211709136,\ 2.9333455028290860],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03364}03364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'greater'}:\ [0.7470806207371626,\ np.inf],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03365}03365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'less'}:\ [-\/np.inf,\ 2.545707203262837]\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03366}03366\ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_1samp(x,\ popmean=popmean,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03367}03367\ \ \ \ \ \ \ \ \ ci\ =\ res.confidence\_interval(confidence\_level=0.85)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03368}03368\ \ \ \ \ \ \ \ \ assert\_allclose(ci,\ ref[alternative])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03369}03369\ \ \ \ \ \ \ \ \ assert\_equal(res.df,\ n-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03370}03370\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03371}03371\ \ \ \ \ \textcolor{keyword}{def\ }test\_1samp\_ci\_iv(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03372}03372\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ \`{}confidence\_interval`\ method\ input\ validation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03373}03373\ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_1samp(np.arange(10),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03374}03374\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{'\`{}confidence\_level`\ must\ be\ a\ number\ between\ 0\ and\ 1.'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03375}03375\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03376}03376\ \ \ \ \ \ \ \ \ \ \ \ \ res.confidence\_interval(confidence\_level=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03377}03377\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03378}03378\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03379}\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore}{03379}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore}{TestPercentileOfScore}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03380}03380\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03381}03381\ \ \ \ \ \textcolor{keyword}{def\ }f(self,\ *args,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03382}03382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ stats.percentileofscore(*args,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03383}03383\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03384}03384\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 40)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03385}03385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 35),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03386}03386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03387}03387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 40)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03388}03388\ \ \ \ \ \textcolor{keyword}{def\ }test\_unique(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03389}03389\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8,\ 9,\ 10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03390}03390\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 4,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03391}03391\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03392}03392\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 45)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03393}03393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 40),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03394}03394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03395}03395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 50)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03396}03396\ \ \ \ \ \textcolor{keyword}{def\ }test\_multiple2(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03397}03397\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 4,\ 5,\ 6,\ 7,\ 8,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03398}03398\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 4,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03399}03399\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03400}03400\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 50)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03401}03401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 45),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03402}03402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03403}03403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 60)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03404}03404\ \ \ \ \ \textcolor{keyword}{def\ }test\_multiple3(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03405}03405\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 4,\ 4,\ 5,\ 6,\ 7,\ 8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03406}03406\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 4,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03407}03407\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03408}03408\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 30)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03409}03409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03410}03410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03411}03411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 30)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03412}03412\ \ \ \ \ \textcolor{keyword}{def\ }test\_missing(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03413}03413\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 5,\ 6,\ 7,\ 8,\ 9,\ 10,\ 11]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03414}03414\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 4,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03415}03415\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03416}03416\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 40)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03417}03417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 35),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03418}03418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03419}03419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 40)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03420}03420\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_numbers(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03421}03421\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03422}03422\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 40,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03423}03423\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03424}03424\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 50)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03425}03425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 45),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03426}03426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03427}03427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 60)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03428}03428\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_numbers\_multiple3(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03429}03429\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 40,\ 40,\ 50,\ 60,\ 70,\ 80]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03430}03430\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 40,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03431}03431\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03432}03432\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ 30)},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03433}03433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03434}03434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ 30),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03435}03435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ 30)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03436}03436\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_numbers\_missing(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03437}03437\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100,\ 110]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03438}03438\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ 40,\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03439}03439\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03440}03440\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ [0,\ 10,\ 100,\ 100])},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03441}03441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ [0,\ 5,\ 95,\ 100]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03442}03442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ [0,\ 0,\ 90,\ 100]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03443}03443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ [0,\ 10,\ 100,\ 100])])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03444}03444\ \ \ \ \ \textcolor{keyword}{def\ }test\_boundaries(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03445}03445\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100,\ 110]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03446}03446\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ [0,\ 10,\ 110,\ 200],\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03447}03447\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03448}03448\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kind,\ result"{},\ [("{}rank"{},\ [0,\ 10,\ 100])},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03449}03449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}mean"{}},\ [0,\ 5,\ 95]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03450}03450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}strict"{}},\ [0,\ 0,\ 90]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03451}03451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}weak"{}},\ [0,\ 10,\ 100])])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03452}03452\ \ \ \ \ \textcolor{keyword}{def\ }test\_inf(self,\ kind,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03453}03453\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8,\ 9,\ +np.inf]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03454}03454\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ [-\/np.inf,\ 1,\ +np.inf],\ kind=kind),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03455}03455\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03456}03456\ \ \ \ \ cases\ =\ [(\textcolor{stringliteral}{"{}propagate"{}},\ [],\ 1,\ np.nan),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03457}03457\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}propagate"{}},\ [np.nan],\ 1,\ np.nan),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03458}03458\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}propagate"{}},\ [np.nan],\ [0,\ 1,\ 2],\ [np.nan,\ np.nan,\ np.nan]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03459}03459\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}propagate"{}},\ [1,\ 2],\ [1,\ 2,\ np.nan],\ [50,\ 100,\ np.nan]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03460}03460\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}omit"{}},\ [1,\ 2,\ np.nan],\ [0,\ 1,\ 2],\ [0,\ 50,\ 100]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03461}03461\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}omit"{}},\ [1,\ 2],\ [0,\ 1,\ np.nan],\ [0,\ 50,\ np.nan]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03462}03462\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}omit"{}},\ [np.nan,\ np.nan],\ [0,\ 1,\ 2],\ [np.nan,\ np.nan,\ np.nan])]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03463}03463\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03464}03464\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}policy,\ a,\ score,\ result"{},\ cases)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03465}03465\ \ \ \ \ \textcolor{keyword}{def\ }test\_nans\_ok(self,\ policy,\ a,\ score,\ result):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03466}03466\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ score,\ nan\_policy=policy),\ result)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03467}03467\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03468}03468\ \ \ \ \ cases\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03469}03469\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}raise"{}},\ [1,\ 2,\ 3,\ np.nan],\ [1,\ 2,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03470}03470\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ input\ contains\ nan\ values"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03471}03471\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}raise"{}},\ [1,\ 2,\ 3],\ [1,\ 2,\ 3,\ np.nan],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03472}03472\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ input\ contains\ nan\ values"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03473}03473\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03474}03474\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03475}03475\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}policy,\ a,\ score,\ message"{},\ cases)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03476}03476\ \ \ \ \ \textcolor{keyword}{def\ }test\_nans\_fail(self,\ policy,\ a,\ score,\ message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03477}03477\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03478}03478\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ score,\ nan\_policy=policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03479}03479\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03480}03480\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}shape"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03481}03481\ \ \ \ \ \ \ \ \ (6,\ ),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03482}03482\ \ \ \ \ \ \ \ \ (2,\ 3),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03483}03483\ \ \ \ \ \ \ \ \ (2,\ 1,\ 3),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03484}03484\ \ \ \ \ \ \ \ \ (2,\ 1,\ 1,\ 3),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03485}03485\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03486}03486\ \ \ \ \ \textcolor{keyword}{def\ }test\_nd(self,\ shape):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03487}03487\ \ \ \ \ \ \ \ \ a\ =\ np.array([0,\ 1,\ 2,\ 3,\ 4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03488}03488\ \ \ \ \ \ \ \ \ scores\ =\ a.reshape(shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03489}03489\ \ \ \ \ \ \ \ \ results\ =\ scores*10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03490}03490\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8,\ 9,\ 10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03491}03491\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1stats_1_1tests_1_1test__stats_1_1TestPercentileOfScore_aa95125e2354d899d21ebacb907df01d5}{f}}(a,\ scores,\ kind=\textcolor{stringliteral}{"{}rank"{}}),\ results)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03492}03492\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03493}03493\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03494}03494\ PowerDivCase\ =\ \mbox{\hyperlink{classnamedtuple}{namedtuple}}(\textcolor{stringliteral}{'Case'},\ \ \textcolor{comment}{\#\ type:\ ignore[name-\/match]}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03495}03495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{'f\_obs'},\ \textcolor{stringliteral}{'f\_exp'},\ \textcolor{stringliteral}{'ddof'},\ \textcolor{stringliteral}{'axis'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03496}03496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'chi2'},\ \ \ \ \ \textcolor{comment}{\#\ Pearson's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03497}03497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'log'},\ \ \ \ \ \ \textcolor{comment}{\#\ G-\/test\ (log-\/likelihood)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03498}03498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'mod\_log'},\ \ \textcolor{comment}{\#\ Modified\ log-\/likelihood}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03499}03499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'cr'},\ \ \ \ \ \ \ \textcolor{comment}{\#\ Cressie-\/Read\ (lambda=2/3)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03500}03500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03501}03501\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03502}03502\ \textcolor{comment}{\#\ The\ details\ of\ the\ first\ two\ elements\ in\ power\_div\_1d\_cases\ are\ used}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03503}03503\ \textcolor{comment}{\#\ in\ a\ test\ in\ TestPowerDivergence.\ \ Check\ that\ code\ before\ making}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03504}03504\ \textcolor{comment}{\#\ any\ changes\ here.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03505}03505\ power\_div\_1d\_cases\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03506}03506\ \ \ \ \ \textcolor{comment}{\#\ Use\ the\ default\ f\_exp.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03507}03507\ \ \ \ \ PowerDivCase(f\_obs=[4,\ 8,\ 12,\ 8],\ f\_exp=\textcolor{keywordtype}{None},\ ddof=0,\ axis=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03508}03508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=4,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03509}03509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log=2*(4*np.log(4/8)\ +\ 12*np.log(12/8)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03510}03510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mod\_log=2*(8*np.log(8/4)\ +\ 8*np.log(8/12)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03511}03511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cr=(4*((4/8)**(2/3)\ -\/\ 1)\ +\ 12*((12/8)**(2/3)\ -\/\ 1))/(5/9)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03512}03512\ \ \ \ \ \textcolor{comment}{\#\ Give\ a\ non-\/uniform\ f\_exp.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03513}03513\ \ \ \ \ PowerDivCase(f\_obs=[4,\ 8,\ 12,\ 8],\ f\_exp=[2,\ 16,\ 12,\ 2],\ ddof=0,\ axis=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03514}03514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=24,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03515}03515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log=2*(4*np.log(4/2)\ +\ 8*np.log(8/16)\ +\ 8*np.log(8/2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03516}03516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mod\_log=2*(2*np.log(2/4)\ +\ 16*np.log(16/8)\ +\ 2*np.log(2/8)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03517}03517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cr=(4*((4/2)**(2/3)\ -\/\ 1)\ +\ 8*((8/16)**(2/3)\ -\/\ 1)\ +}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03518}03518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8*((8/2)**(2/3)\ -\/\ 1))/(5/9)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03519}03519\ \ \ \ \ \textcolor{comment}{\#\ f\_exp\ is\ a\ scalar.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03520}03520\ \ \ \ \ PowerDivCase(f\_obs=[4,\ 8,\ 12,\ 8],\ f\_exp=8,\ ddof=0,\ axis=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03521}03521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=4,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03522}03522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log=2*(4*np.log(4/8)\ +\ 12*np.log(12/8)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03523}03523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mod\_log=2*(8*np.log(8/4)\ +\ 8*np.log(8/12)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03524}03524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cr=(4*((4/8)**(2/3)\ -\/\ 1)\ +\ 12*((12/8)**(2/3)\ -\/\ 1))/(5/9)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03525}03525\ \ \ \ \ \textcolor{comment}{\#\ f\_exp\ equal\ to\ f\_obs.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03526}03526\ \ \ \ \ PowerDivCase(f\_obs=[3,\ 5,\ 7,\ 9],\ f\_exp=[3,\ 5,\ 7,\ 9],\ ddof=0,\ axis=0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03527}03527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=0,\ log=0,\ mod\_log=0,\ cr=0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03528}03528\ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03529}03529\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03530}03530\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03531}03531\ power\_div\_empty\_cases\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03532}03532\ \ \ \ \ \textcolor{comment}{\#\ Shape\ is\ (0,)-\/-\/a\ data\ set\ with\ length\ 0.\ \ The\ computed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03533}03533\ \ \ \ \ \textcolor{comment}{\#\ test\ statistic\ should\ be\ 0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03534}03534\ \ \ \ \ PowerDivCase(f\_obs=[],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03535}03535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_exp=\textcolor{keywordtype}{None},\ ddof=0,\ axis=0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03536}03536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=0,\ log=0,\ mod\_log=0,\ cr=0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03537}03537\ \ \ \ \ \textcolor{comment}{\#\ Shape\ is\ (0,\ 3).\ \ This\ is\ 3\ data\ sets,\ but\ each\ data\ set\ has}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03538}03538\ \ \ \ \ \textcolor{comment}{\#\ length\ 0,\ so\ the\ computed\ test\ statistic\ should\ be\ [0,\ 0,\ 0].}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03539}03539\ \ \ \ \ PowerDivCase(f\_obs=np.array([[],[],[]]).T,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03540}03540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_exp=\textcolor{keywordtype}{None},\ ddof=0,\ axis=0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03541}03541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=[0,\ 0,\ 0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03542}03542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log=[0,\ 0,\ 0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03543}03543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mod\_log=[0,\ 0,\ 0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03544}03544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cr=[0,\ 0,\ 0]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03545}03545\ \ \ \ \ \textcolor{comment}{\#\ Shape\ is\ (3,\ 0).\ \ This\ represents\ an\ empty\ collection\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03546}03546\ \ \ \ \ \textcolor{comment}{\#\ data\ sets\ in\ which\ each\ data\ set\ has\ length\ 3.\ \ The\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03547}03547\ \ \ \ \ \textcolor{comment}{\#\ statistic\ should\ be\ an\ empty\ array.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03548}03548\ \ \ \ \ PowerDivCase(f\_obs=np.array([[],[],[]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03549}03549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_exp=\textcolor{keywordtype}{None},\ ddof=0,\ axis=0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03550}03550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ chi2=[],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03551}03551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log=[],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03552}03552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mod\_log=[],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03553}03553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cr=[]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03554}03554\ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03555}03555\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03556}03556\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03557}03557\ \textcolor{keyword}{class\ }TestPowerDivergence:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03558}03558\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03559}03559\ \ \ \ \ \textcolor{keyword}{def\ }check\_power\_divergence(self,\ f\_obs,\ f\_exp,\ ddof,\ axis,\ lambda\_,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03560}03560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expected\_stat):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03561}03561\ \ \ \ \ \ \ \ \ f\_obs\ =\ np.asarray(f\_obs)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03562}03562\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03563}03563\ \ \ \ \ \ \ \ \ \ \ \ \ num\_obs\ =\ f\_obs.size}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03564}03564\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03565}03565\ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ np.broadcast(f\_obs,\ f\_exp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03566}03566\ \ \ \ \ \ \ \ \ \ \ \ \ num\_obs\ =\ b.shape[axis]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03567}03567\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03568}03568\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03569}03569\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03570}03570\ \ \ \ \ \ \ \ \ \ \ \ \ stat,\ p\ =\ stats.power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03571}03571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_obs=f\_obs,\ f\_exp=f\_exp,\ ddof=ddof,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03572}03572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=axis,\ lambda\_=lambda\_)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03573}03573\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(stat,\ expected\_stat)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03574}03574\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03575}03575\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ lambda\_\ ==\ 1\ \textcolor{keywordflow}{or}\ lambda\_\ ==\ \textcolor{stringliteral}{"{}pearson"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03576}03576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Also\ test\ stats.chisquare.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03577}03577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stat,\ p\ =\ stats.chisquare(f\_obs=f\_obs,\ f\_exp=f\_exp,\ ddof=ddof,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03578}03578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03579}03579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(stat,\ expected\_stat)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03580}03580\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03581}03581\ \ \ \ \ \ \ \ \ ddof\ =\ np.asarray(ddof)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03582}03582\ \ \ \ \ \ \ \ \ expected\_p\ =\ stats.distributions.chi2.sf(expected\_stat,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03583}03583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_obs\ -\/\ 1\ -\/\ ddof)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03584}03584\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ expected\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03585}03585\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03586}03586\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03587}03587\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ case\ \textcolor{keywordflow}{in}\ power\_div\_1d\_cases:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03588}03588\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03589}03589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03590}03590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03591}03591\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03592}03592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03593}03593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pearson"{}},\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03594}03594\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03595}03595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03596}03596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1,\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03597}03597\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03598}03598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03599}03599\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}log-\/likelihood"{}},\ case.log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03600}03600\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03601}03601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03602}03602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mod-\/log-\/likelihood"{}},\ case.mod\_log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03603}03603\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03604}03604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03605}03605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cressie-\/read"{}},\ case.cr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03606}03606\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03607}03607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03608}03608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2/3,\ case.cr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03609}03609\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03610}03610\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic\_masked(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03611}03611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ case\ \textcolor{keywordflow}{in}\ power\_div\_1d\_cases:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03612}03612\ \ \ \ \ \ \ \ \ \ \ \ \ mobs\ =\ np.ma.array(case.f\_obs)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03613}03613\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03614}03614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03615}03615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03616}03616\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03617}03617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03618}03618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pearson"{}},\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03619}03619\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03620}03620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03621}03621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1,\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03622}03622\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03623}03623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03624}03624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}log-\/likelihood"{}},\ case.log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03625}03625\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03626}03626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03627}03627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mod-\/log-\/likelihood"{}},\ case.mod\_log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03628}03628\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03629}03629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03630}03630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cressie-\/read"{}},\ case.cr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03631}03631\ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03632}03632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03633}03633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2/3,\ case.cr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03634}03634\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03635}03635\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03636}03636\ \ \ \ \ \ \ \ \ case0\ =\ power\_div\_1d\_cases[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03637}03637\ \ \ \ \ \ \ \ \ case1\ =\ power\_div\_1d\_cases[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03638}03638\ \ \ \ \ \ \ \ \ f\_obs\ =\ np.vstack((case0.f\_obs,\ case1.f\_obs))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03639}03639\ \ \ \ \ \ \ \ \ f\_exp\ =\ np.vstack((np.ones\_like(case0.f\_obs)*np.mean(case0.f\_obs),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03640}03640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case1.f\_exp))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03641}03641\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ the\ four\ computational\ code\ paths\ in\ power\_divergence}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03642}03642\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ using\ a\ 2D\ array\ with\ axis=1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03643}03643\ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03644}03644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_obs,\ f\_exp,\ 0,\ 1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03645}03645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pearson"{}},\ [case0.chi2,\ case1.chi2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03646}03646\ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03647}03647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_obs,\ f\_exp,\ 0,\ 1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03648}03648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}log-\/likelihood"{}},\ [case0.log,\ case1.log])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03649}03649\ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03650}03650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_obs,\ f\_exp,\ 0,\ 1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03651}03651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mod-\/log-\/likelihood"{}},\ [case0.mod\_log,\ case1.mod\_log])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03652}03652\ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03653}03653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_obs,\ f\_exp,\ 0,\ 1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03654}03654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cressie-\/read"{}},\ [case0.cr,\ case1.cr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03655}03655\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reshape\ case0.f\_obs\ to\ shape\ (2,2),\ and\ use\ axis=None.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03656}03656\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ result\ should\ be\ the\ same.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03657}03657\ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03658}03658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array(case0.f\_obs).reshape(2,\ 2),\ \textcolor{keywordtype}{None},\ 0,\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03659}03659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pearson"{}},\ case0.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03660}03660\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03661}03661\ \ \ \ \ \textcolor{keyword}{def\ }test\_ddof\_broadcasting(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03662}03662\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ ddof\ broadcasts\ correctly.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03663}03663\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ddof\ does\ not\ affect\ the\ test\ statistic.\ \ It\ is\ broadcast}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03664}03664\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ the\ computed\ test\ statistic\ for\ the\ computation\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03665}03665\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ p\ value.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03666}03666\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03667}03667\ \ \ \ \ \ \ \ \ case0\ =\ power\_div\_1d\_cases[0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03668}03668\ \ \ \ \ \ \ \ \ case1\ =\ power\_div\_1d\_cases[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03669}03669\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ 4x2\ arrays\ of\ observed\ and\ expected\ frequencies.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03670}03670\ \ \ \ \ \ \ \ \ f\_obs\ =\ np.vstack((case0.f\_obs,\ case1.f\_obs)).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03671}03671\ \ \ \ \ \ \ \ \ f\_exp\ =\ np.vstack((np.ones\_like(case0.f\_obs)*np.mean(case0.f\_obs),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03672}03672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case1.f\_exp)).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03673}03673\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03674}03674\ \ \ \ \ \ \ \ \ expected\_chi2\ =\ [case0.chi2,\ case1.chi2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03675}03675\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03676}03676\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ddof\ has\ shape\ (2,\ 1).\ \ This\ is\ broadcast\ with\ the\ computed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03677}03677\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ statistic,\ so\ p\ will\ have\ shape\ (2,2).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03678}03678\ \ \ \ \ \ \ \ \ ddof\ =\ np.array([[0],\ [1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03679}03679\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03680}03680\ \ \ \ \ \ \ \ \ stat,\ p\ =\ stats.power\_divergence(f\_obs,\ f\_exp,\ ddof=ddof)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03681}03681\ \ \ \ \ \ \ \ \ assert\_allclose(stat,\ expected\_chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03682}03682\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03683}03683\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ p\ values\ separately,\ passing\ in\ scalars\ for\ ddof.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03684}03684\ \ \ \ \ \ \ \ \ stat0,\ p0\ =\ stats.power\_divergence(f\_obs,\ f\_exp,\ ddof=ddof[0,0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03685}03685\ \ \ \ \ \ \ \ \ stat1,\ p1\ =\ stats.power\_divergence(f\_obs,\ f\_exp,\ ddof=ddof[1,0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03686}03686\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03687}03687\ \ \ \ \ \ \ \ \ assert\_array\_equal(p,\ np.vstack((p0,\ p1)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03688}03688\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03689}03689\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_cases(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03690}03690\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03691}03691\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ case\ \textcolor{keywordflow}{in}\ power\_div\_empty\_cases:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03692}03692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03693}03693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03694}03694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}pearson"{}},\ case.chi2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03695}03695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03696}03696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03697}03697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}log-\/likelihood"{}},\ case.log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03698}03698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03699}03699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03700}03700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}mod-\/log-\/likelihood"{}},\ case.mod\_log)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03701}03701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.check\_power\_divergence(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03702}03702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ case.f\_obs,\ case.f\_exp,\ case.ddof,\ case.axis,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03703}03703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cressie-\/read"{}},\ case.cr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03704}03704\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03705}03705\ \ \ \ \ \textcolor{keyword}{def\ }test\_power\_divergence\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03706}03706\ \ \ \ \ \ \ \ \ f\_obs\ =\ power\_div\_1d\_cases[0].f\_obs}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03707}03707\ \ \ \ \ \ \ \ \ f\_exp\ =\ power\_div\_1d\_cases[0].f\_exp}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03708}03708\ \ \ \ \ \ \ \ \ ddof\ =\ power\_div\_1d\_cases[0].ddof}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03709}03709\ \ \ \ \ \ \ \ \ axis\ =\ power\_div\_1d\_cases[0].axis}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03710}03710\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03711}03711\ \ \ \ \ \ \ \ \ res\ =\ stats.power\_divergence(f\_obs=f\_obs,\ f\_exp=f\_exp,\ ddof=ddof,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03712}03712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=axis,\ lambda\_=\textcolor{stringliteral}{"{}pearson"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03713}03713\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03714}03714\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03715}03715\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03716}03716\ \ \ \ \ \textcolor{keyword}{def\ }test\_power\_divergence\_gh\_12282(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03717}03717\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ sums\ of\ observed\ and\ expected\ frequencies\ must\ match}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03718}03718\ \ \ \ \ \ \ \ \ f\_obs\ =\ np.array([[10,\ 20],\ [30,\ 20]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03719}03719\ \ \ \ \ \ \ \ \ f\_exp\ =\ np.array([[5,\ 15],\ [35,\ 25]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03720}03720\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{'For\ each\ axis\ slice...'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03721}03721\ \ \ \ \ \ \ \ \ \ \ \ \ stats.power\_divergence(f\_obs=[10,\ 20],\ f\_exp=[30,\ 60])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03722}03722\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{'For\ each\ axis\ slice...'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03723}03723\ \ \ \ \ \ \ \ \ \ \ \ \ stats.power\_divergence(f\_obs=f\_obs,\ f\_exp=f\_exp,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03724}03724\ \ \ \ \ \ \ \ \ stat,\ pval\ =\ stats.power\_divergence(f\_obs=f\_obs,\ f\_exp=f\_exp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03725}03725\ \ \ \ \ \ \ \ \ assert\_allclose(stat,\ [5.71428571,\ 2.66666667])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03726}03726\ \ \ \ \ \ \ \ \ assert\_allclose(pval,\ [0.01682741,\ 0.10247043])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03727}03727\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03728}03728\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03729}03729\ \textcolor{keyword}{def\ }test\_gh\_chisquare\_12282():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03730}03730\ \ \ \ \ \textcolor{comment}{\#\ Currently\ \`{}chisquare`\ is\ implemented\ via\ power\_divergence}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03731}03731\ \ \ \ \ \textcolor{comment}{\#\ in\ case\ that\ ever\ changes,\ perform\ a\ basic\ test\ like}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03732}03732\ \ \ \ \ \textcolor{comment}{\#\ test\_power\_divergence\_gh\_12282}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03733}03733\ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{'For\ each\ axis\ slice...'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03734}03734\ \ \ \ \ \ \ \ \ stats.chisquare(f\_obs=[10,\ 20],\ f\_exp=[30,\ 60])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03735}03735\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03736}03736\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03737}03737\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n,\ dtype"{},\ [(200,\ np.uint8)},\ (1000000,\ np.int32)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03738}03738\ \textcolor{keyword}{def\ }test\_chiquare\_data\_types\_attributes(n,\ dtype):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03739}03739\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/10159\ and\ gh-\/18368}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03740}03740\ \ \ \ \ obs\ =\ np.array([n,\ 0],\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03741}03741\ \ \ \ \ exp\ =\ np.array([n\ //\ 2,\ n\ //\ 2],\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03742}03742\ \ \ \ \ res\ =\ stats.chisquare(obs,\ exp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03743}03743\ \ \ \ \ stat,\ p\ =\ res}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03744}03744\ \ \ \ \ assert\_allclose(stat,\ n,\ rtol=1e-\/13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03745}03745\ \ \ \ \ \textcolor{comment}{\#\ check\ that\ attributes\ are\ identical\ to\ unpacked\ outputs\ -\/\ see\ gh-\/18368}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03746}03746\ \ \ \ \ assert\_equal(res.statistic,\ stat)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03747}03747\ \ \ \ \ assert\_equal(res.pvalue,\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03748}03748\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03749}03749\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03750}03750\ \textcolor{keyword}{def\ }test\_chisquare\_masked\_arrays():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03751}03751\ \ \ \ \ \textcolor{comment}{\#\ Test\ masked\ arrays.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03752}03752\ \ \ \ \ obs\ =\ np.array([[8,\ 8,\ 16,\ 32,\ -\/1],\ [-\/1,\ -\/1,\ 3,\ 4,\ 5]]).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03753}03753\ \ \ \ \ mask\ =\ np.array([[0,\ 0,\ 0,\ 0,\ 1],\ [1,\ 1,\ 0,\ 0,\ 0]]).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03754}03754\ \ \ \ \ mobs\ =\ np.ma.masked\_array(obs,\ mask)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03755}03755\ \ \ \ \ expected\_chisq\ =\ np.array([24.0,\ 0.5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03756}03756\ \ \ \ \ expected\_g\ =\ np.array([2*(2*8*np.log(0.5)\ +\ 32*np.log(2.0)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03757}03757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2*(3*np.log(0.75)\ +\ 5*np.log(1.25))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03758}03758\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03759}03759\ \ \ \ \ chi2\ =\ stats.distributions.chi2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03760}03760\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03761}03761\ \ \ \ \ chisq,\ p\ =\ stats.chisquare(mobs)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03762}03762\ \ \ \ \ mat.assert\_array\_equal(chisq,\ expected\_chisq)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03763}03763\ \ \ \ \ mat.assert\_array\_almost\_equal(p,\ chi2.sf(expected\_chisq,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03764}03764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs.count(axis=0)\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03765}03765\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03766}03766\ \ \ \ \ g,\ p\ =\ stats.power\_divergence(mobs,\ lambda\_=\textcolor{stringliteral}{'log-\/likelihood'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03767}03767\ \ \ \ \ mat.assert\_array\_almost\_equal(g,\ expected\_g,\ decimal=15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03768}03768\ \ \ \ \ mat.assert\_array\_almost\_equal(p,\ chi2.sf(expected\_g,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03769}03769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs.count(axis=0)\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03770}03770\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03771}03771\ \ \ \ \ chisq,\ p\ =\ stats.chisquare(mobs.T,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03772}03772\ \ \ \ \ mat.assert\_array\_equal(chisq,\ expected\_chisq)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03773}03773\ \ \ \ \ mat.assert\_array\_almost\_equal(p,\ chi2.sf(expected\_chisq,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03774}03774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs.T.count(axis=1)\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03775}03775\ \ \ \ \ g,\ p\ =\ stats.power\_divergence(mobs.T,\ axis=1,\ lambda\_=\textcolor{stringliteral}{"{}log-\/likelihood"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03776}03776\ \ \ \ \ mat.assert\_array\_almost\_equal(g,\ expected\_g,\ decimal=15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03777}03777\ \ \ \ \ mat.assert\_array\_almost\_equal(p,\ chi2.sf(expected\_g,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03778}03778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mobs.count(axis=0)\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03779}03779\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03780}03780\ \ \ \ \ obs1\ =\ np.ma.array([3,\ 5,\ 6,\ 99,\ 10],\ mask=[0,\ 0,\ 0,\ 1,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03781}03781\ \ \ \ \ exp1\ =\ np.ma.array([2,\ 4,\ 8,\ 10,\ 99],\ mask=[0,\ 0,\ 0,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03782}03782\ \ \ \ \ chi2,\ p\ =\ stats.chisquare(obs1,\ f\_exp=exp1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03783}03783\ \ \ \ \ \textcolor{comment}{\#\ Because\ of\ the\ mask\ at\ index\ 3\ of\ obs1\ and\ at\ index\ 4\ of\ exp1,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03784}03784\ \ \ \ \ \textcolor{comment}{\#\ only\ the\ first\ three\ elements\ are\ included\ in\ the\ calculation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03785}03785\ \ \ \ \ \textcolor{comment}{\#\ of\ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03786}03786\ \ \ \ \ mat.assert\_array\_equal(chi2,\ 1/2\ +\ 1/4\ +\ 4/8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03787}03787\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03788}03788\ \ \ \ \ \textcolor{comment}{\#\ When\ axis=None,\ the\ two\ values\ should\ have\ type\ np.float64.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03789}03789\ \ \ \ \ chisq,\ p\ =\ stats.chisquare(np.ma.array([1,2,3]),\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03790}03790\ \ \ \ \ assert\_(isinstance(chisq,\ np.float64))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03791}03791\ \ \ \ \ assert\_(isinstance(p,\ np.float64))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03792}03792\ \ \ \ \ assert\_equal(chisq,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03793}03793\ \ \ \ \ assert\_almost\_equal(p,\ stats.distributions.chi2.sf(1.0,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03794}03794\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03795}03795\ \ \ \ \ \textcolor{comment}{\#\ Empty\ arrays:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03796}03796\ \ \ \ \ \textcolor{comment}{\#\ A\ data\ set\ with\ length\ 0\ returns\ a\ masked\ scalar.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03797}03797\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03798}03798\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03799}03799\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03800}03800\ \ \ \ \ \ \ \ \ \ \ \ \ chisq,\ p\ =\ stats.chisquare(np.ma.array([]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03801}03801\ \ \ \ \ assert\_(isinstance(chisq,\ np.ma.MaskedArray))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03802}03802\ \ \ \ \ assert\_equal(chisq.shape,\ ())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03803}03803\ \ \ \ \ assert\_(chisq.mask)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03804}03804\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03805}03805\ \ \ \ \ empty3\ =\ np.ma.array([[],[],[]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03806}03806\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03807}03807\ \ \ \ \ \textcolor{comment}{\#\ empty3\ is\ a\ collection\ of\ 0\ data\ sets\ (whose\ lengths\ would\ be\ 3,\ if}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03808}03808\ \ \ \ \ \textcolor{comment}{\#\ there\ were\ any),\ so\ the\ return\ value\ is\ an\ array\ with\ length\ 0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03809}03809\ \ \ \ \ chisq,\ p\ =\ stats.chisquare(empty3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03810}03810\ \ \ \ \ assert\_(isinstance(chisq,\ np.ma.MaskedArray))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03811}03811\ \ \ \ \ mat.assert\_array\_equal(chisq,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03812}03812\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03813}03813\ \ \ \ \ \textcolor{comment}{\#\ empty3.T\ is\ an\ array\ containing\ 3\ data\ sets,\ each\ with\ length\ 0,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03814}03814\ \ \ \ \ \textcolor{comment}{\#\ so\ an\ array\ of\ size\ (3,)\ is\ returned,\ with\ all\ values\ masked.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03815}03815\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03816}03816\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03817}03817\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Mean\ of\ empty\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03818}03818\ \ \ \ \ \ \ \ \ \ \ \ \ chisq,\ p\ =\ stats.chisquare(empty3.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03819}03819\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03820}03820\ \ \ \ \ assert\_(isinstance(chisq,\ np.ma.MaskedArray))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03821}03821\ \ \ \ \ assert\_equal(chisq.shape,\ (3,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03822}03822\ \ \ \ \ assert\_(np.all(chisq.mask))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03823}03823\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03824}03824\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03825}03825\ \textcolor{keyword}{def\ }test\_power\_divergence\_against\_cressie\_read\_data():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03826}03826\ \ \ \ \ \textcolor{comment}{\#\ Test\ stats.power\_divergence\ against\ tables\ 4\ and\ 5\ from}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03827}03827\ \ \ \ \ \textcolor{comment}{\#\ Cressie\ and\ Read,\ "{}Multimonial\ Goodness-\/of-\/Fit\ Tests"{},}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03828}03828\ \ \ \ \ \textcolor{comment}{\#\ J.\ R.\ Statist.\ Soc.\ B\ (1984),\ Vol\ 46,\ No.\ 3,\ pp.\ 440-\/464.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03829}03829\ \ \ \ \ \textcolor{comment}{\#\ This\ tests\ the\ calculation\ for\ several\ values\ of\ lambda.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03830}03830\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03831}03831\ \ \ \ \ \textcolor{comment}{\#\ Table\ 4\ data\ recalculated\ for\ greater\ precision\ according\ to:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03832}03832\ \ \ \ \ \textcolor{comment}{\#\ Shelby\ J.\ Haberman,\ Analysis\ of\ Qualitative\ Data:\ Volume\ 1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03833}03833\ \ \ \ \ \textcolor{comment}{\#\ Introductory\ Topics,\ Academic\ Press,\ New\ York,\ USA\ (1978).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03834}03834\ \ \ \ \ obs\ =\ np.array([15,\ 11,\ 14,\ 17,\ 5,\ 11,\ 10,\ 4,\ 8,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03835}03835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 10,\ 7,\ 9,\ 11,\ 3,\ 6,\ 1,\ 1,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03836}03836\ \ \ \ \ beta\ =\ -\/0.083769\ \ \textcolor{comment}{\#\ Haberman\ (1978),\ p.\ 15}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03837}03837\ \ \ \ \ i\ =\ np.arange(1,\ len(obs)\ +\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03838}03838\ \ \ \ \ alpha\ =\ np.log(obs.sum()\ /\ np.exp(beta*i).sum())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03839}03839\ \ \ \ \ expected\_counts\ =\ np.exp(alpha\ +\ beta*i)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03840}03840\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03841}03841\ \ \ \ \ \textcolor{comment}{\#\ \`{}table4`\ holds\ just\ the\ second\ and\ third\ columns\ from\ Table\ 4.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03842}03842\ \ \ \ \ table4\ =\ np.vstack((obs,\ expected\_counts)).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03843}03843\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03844}03844\ \ \ \ \ table5\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03845}03845\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ lambda,\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03846}03846\ \ \ \ \ \ \ \ \ -\/10.0,\ 72.2e3,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03847}03847\ \ \ \ \ \ \ \ \ -\/5.0,\ 28.9e1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03848}03848\ \ \ \ \ \ \ \ \ -\/3.0,\ 65.6,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03849}03849\ \ \ \ \ \ \ \ \ -\/2.0,\ 40.6,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03850}03850\ \ \ \ \ \ \ \ \ -\/1.5,\ 34.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03851}03851\ \ \ \ \ \ \ \ \ -\/1.0,\ 29.5,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03852}03852\ \ \ \ \ \ \ \ \ -\/0.5,\ 26.5,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03853}03853\ \ \ \ \ \ \ \ \ 0.0,\ 24.6,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03854}03854\ \ \ \ \ \ \ \ \ 0.5,\ 23.4,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03855}03855\ \ \ \ \ \ \ \ \ 0.67,\ 23.1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03856}03856\ \ \ \ \ \ \ \ \ 1.0,\ 22.7,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03857}03857\ \ \ \ \ \ \ \ \ 1.5,\ 22.6,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03858}03858\ \ \ \ \ \ \ \ \ 2.0,\ 22.9,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03859}03859\ \ \ \ \ \ \ \ \ 3.0,\ 24.8,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03860}03860\ \ \ \ \ \ \ \ \ 5.0,\ 35.5,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03861}03861\ \ \ \ \ \ \ \ \ 10.0,\ 21.4e1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03862}03862\ \ \ \ \ \ \ \ \ ]).reshape(-\/1,\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03863}03863\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03864}03864\ \ \ \ \ \textcolor{keywordflow}{for}\ lambda\_,\ expected\_stat\ \textcolor{keywordflow}{in}\ table5:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03865}03865\ \ \ \ \ \ \ \ \ stat,\ p\ =\ stats.power\_divergence(table4[:,0],\ table4[:,1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03866}03866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lambda\_=lambda\_)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03867}03867\ \ \ \ \ \ \ \ \ assert\_allclose(stat,\ expected\_stat,\ rtol=5e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03868}03868\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03869}03869\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03870}03870\ \textcolor{keyword}{def\ }test\_friedmanchisquare():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03871}03871\ \ \ \ \ \textcolor{comment}{\#\ see\ ticket:113}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03872}03872\ \ \ \ \ \textcolor{comment}{\#\ verified\ with\ matlab\ and\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03873}03873\ \ \ \ \ \textcolor{comment}{\#\ From\ Demsar\ "{}Statistical\ Comparisons\ of\ Classifiers\ over\ Multiple\ Data\ Sets"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03874}03874\ \ \ \ \ \textcolor{comment}{\#\ 2006,\ Xf=9.28\ (no\ tie\ handling,\ tie\ corrected\ Xf\ >=9.28)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03875}03875\ \ \ \ \ x1\ =\ [array([0.763,\ 0.599,\ 0.954,\ 0.628,\ 0.882,\ 0.936,\ 0.661,\ 0.583,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03876}03876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.775,\ 1.0,\ 0.94,\ 0.619,\ 0.972,\ 0.957]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03877}03877\ \ \ \ \ \ \ \ \ \ \ array([0.768,\ 0.591,\ 0.971,\ 0.661,\ 0.888,\ 0.931,\ 0.668,\ 0.583,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03878}03878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.838,\ 1.0,\ 0.962,\ 0.666,\ 0.981,\ 0.978]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03879}03879\ \ \ \ \ \ \ \ \ \ \ array([0.771,\ 0.590,\ 0.968,\ 0.654,\ 0.886,\ 0.916,\ 0.609,\ 0.563,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03880}03880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.866,\ 1.0,\ 0.965,\ 0.614,\ 0.9751,\ 0.946]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03881}03881\ \ \ \ \ \ \ \ \ \ \ array([0.798,\ 0.569,\ 0.967,\ 0.657,\ 0.898,\ 0.931,\ 0.685,\ 0.625,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03882}03882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.875,\ 1.0,\ 0.962,\ 0.669,\ 0.975,\ 0.970])]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03883}03883\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03884}03884\ \ \ \ \ \textcolor{comment}{\#\ From\ "{}Bioestadistica\ para\ las\ ciencias\ de\ la\ salud"{}\ Xf=18.95\ p<0.001:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03885}03885\ \ \ \ \ x2\ =\ [array([4,3,5,3,5,3,2,5,4,4,4,3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03886}03886\ \ \ \ \ \ \ \ \ \ \ array([2,2,1,2,3,1,2,3,2,1,1,3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03887}03887\ \ \ \ \ \ \ \ \ \ \ array([2,4,3,3,4,3,3,4,4,1,2,1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03888}03888\ \ \ \ \ \ \ \ \ \ \ array([3,5,4,3,4,4,3,3,3,4,4,4])]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03889}03889\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03890}03890\ \ \ \ \ \textcolor{comment}{\#\ From\ Jerrorl\ H.\ Zar,\ "{}Biostatistical\ Analysis"{}(example\ 12.6),\ Xf=10.68,\ 0.005\ <\ p\ <\ 0.01:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03891}03891\ \ \ \ \ \textcolor{comment}{\#\ Probability\ from\ this\ example\ is\ inexact\ using\ Chisquare\ approximation\ of\ Friedman\ Chisquare.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03892}03892\ \ \ \ \ x3\ =\ [array([7.0,9.9,8.5,5.1,10.3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03893}03893\ \ \ \ \ \ \ \ \ \ \ array([5.3,5.7,4.7,3.5,7.7]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03894}03894\ \ \ \ \ \ \ \ \ \ \ array([4.9,7.6,5.5,2.8,8.4]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03895}03895\ \ \ \ \ \ \ \ \ \ \ array([8.8,8.9,8.1,3.3,9.1])]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03896}03896\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03897}03897\ \ \ \ \ assert\_array\_almost\_equal(stats.friedmanchisquare(x1[0],x1[1],x1[2],x1[3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03898}03898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (10.2283464566929,\ 0.0167215803284414))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03899}03899\ \ \ \ \ assert\_array\_almost\_equal(stats.friedmanchisquare(x2[0],x2[1],x2[2],x2[3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03900}03900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (18.9428571428571,\ 0.000280938375189499))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03901}03901\ \ \ \ \ assert\_array\_almost\_equal(stats.friedmanchisquare(x3[0],x3[1],x3[2],x3[3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03902}03902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (10.68,\ 0.0135882729582176))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03903}03903\ \ \ \ \ assert\_raises(ValueError,\ stats.friedmanchisquare,x3[0],x3[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03904}03904\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03905}03905\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03906}03906\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03907}03907\ \ \ \ \ res\ =\ stats.friedmanchisquare(*x1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03908}03908\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03909}03909\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03910}03910\ \ \ \ \ \textcolor{comment}{\#\ test\ using\ mstats}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03911}03911\ \ \ \ \ assert\_array\_almost\_equal(mstats.friedmanchisquare(x1[0],\ x1[1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03912}03912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x1[2],\ x1[3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03913}03913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (10.2283464566929,\ 0.0167215803284414))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03914}03914\ \ \ \ \ \textcolor{comment}{\#\ the\ following\ fails}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03915}03915\ \ \ \ \ \textcolor{comment}{\#\ assert\_array\_almost\_equal(mstats.friedmanchisquare(x2[0],x2[1],x2[2],x2[3]),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03916}03916\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (18.9428571428571,\ 0.000280938375189499))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03917}03917\ \ \ \ \ assert\_array\_almost\_equal(mstats.friedmanchisquare(x3[0],\ x3[1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03918}03918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x3[2],\ x3[3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03919}03919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (10.68,\ 0.0135882729582176))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03920}03920\ \ \ \ \ assert\_raises(ValueError,\ mstats.friedmanchisquare,x3[0],x3[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03921}03921\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03922}03922\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03923}03923\ \textcolor{keyword}{class\ }TestKSTest:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03924}03924\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Tests\ kstest\ and\ ks\_1samp\ agree\ with\ K-\/S\ various\ sizes,\ alternatives,\ modes."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03925}03925\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03926}03926\ \ \ \ \ \textcolor{keyword}{def\ }\_testOne(self,\ x,\ alternative,\ expected\_statistic,\ expected\_prob,\ mode='auto',\ decimal=14):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03927}03927\ \ \ \ \ \ \ \ \ result\ =\ stats.kstest(x,\ \textcolor{stringliteral}{'norm'},\ alternative=alternative,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03928}03928\ \ \ \ \ \ \ \ \ expected\ =\ np.array([expected\_statistic,\ expected\_prob])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03929}03929\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.array(result),\ expected,\ decimal=decimal)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03930}03930\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03931}03931\ \ \ \ \ \textcolor{keyword}{def\ }\_test\_kstest\_and\_ks1samp(self,\ x,\ alternative,\ mode='auto',\ decimal=14):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03932}03932\ \ \ \ \ \ \ \ \ result\ =\ stats.kstest(x,\ \textcolor{stringliteral}{'norm'},\ alternative=alternative,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03933}03933\ \ \ \ \ \ \ \ \ result\_1samp\ =\ stats.ks\_1samp(x,\ stats.norm.cdf,\ alternative=alternative,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03934}03934\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.array(result),\ result\_1samp,\ decimal=decimal)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03935}03935\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03936}03936\ \ \ \ \ \textcolor{keyword}{def\ }test\_namedtuple\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03937}03937\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/1,\ 1,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03938}03938\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03939}03939\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03940}03940\ \ \ \ \ \ \ \ \ res\ =\ stats.kstest(x,\ \textcolor{stringliteral}{'norm'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03941}03941\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03942}03942\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03943}03943\ \ \ \ \ \textcolor{keyword}{def\ }test\_agree\_with\_ks\_1samp(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03944}03944\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/1,\ 1,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03945}03945\ \ \ \ \ \ \ \ \ self.\_test\_kstest\_and\_ks1samp(x,\ \textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03946}03946\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03947}03947\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/15,\ 15,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03948}03948\ \ \ \ \ \ \ \ \ self.\_test\_kstest\_and\_ks1samp(x,\ \textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03949}03949\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03950}03950\ \ \ \ \ \ \ \ \ x\ =\ [-\/1.23,\ 0.06,\ -\/0.60,\ 0.17,\ 0.66,\ -\/0.17,\ -\/0.08,\ 0.27,\ -\/0.98,\ -\/0.99]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03951}03951\ \ \ \ \ \ \ \ \ self.\_test\_kstest\_and\_ks1samp(x,\ \textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03952}03952\ \ \ \ \ \ \ \ \ self.\_test\_kstest\_and\_ks1samp(x,\ \textcolor{stringliteral}{'greater'},\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03953}03953\ \ \ \ \ \ \ \ \ self.\_test\_kstest\_and\_ks1samp(x,\ \textcolor{stringliteral}{'less'},\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03954}03954\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03955}03955\ \ \ \ \ \textcolor{comment}{\#\ missing:\ no\ test\ that\ uses\ *args}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03956}03956\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03957}03957\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03958}03958\ \textcolor{keyword}{class\ }TestKSOneSample:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03959}03959\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Tests\ kstest\ and\ ks\_samp\ 1-\/samples\ with\ K-\/S\ various\ sizes,\ alternatives,\ modes."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03960}03960\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03961}03961\ \ \ \ \ \textcolor{keyword}{def\ }\_testOne(self,\ x,\ alternative,\ expected\_statistic,\ expected\_prob,\ mode='auto',\ decimal=14):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03962}03962\ \ \ \ \ \ \ \ \ result\ =\ stats.ks\_1samp(x,\ stats.norm.cdf,\ alternative=alternative,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03963}03963\ \ \ \ \ \ \ \ \ expected\ =\ np.array([expected\_statistic,\ expected\_prob])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03964}03964\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.array(result),\ expected,\ decimal=decimal)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03965}03965\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03966}03966\ \ \ \ \ \textcolor{keyword}{def\ }test\_namedtuple\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03967}03967\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/1,\ 1,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03968}03968\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03969}03969\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03970}03970\ \ \ \ \ \ \ \ \ res\ =\ stats.ks\_1samp(x,\ stats.norm.cdf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03971}03971\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03972}03972\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03973}03973\ \ \ \ \ \textcolor{keyword}{def\ }test\_agree\_with\_r(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03974}03974\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ comparing\ with\ some\ values\ from\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03975}03975\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/1,\ 1,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03976}03976\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.15865525393145705,\ 0.95164069201518386)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03977}03977\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03978}03978\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(-\/15,\ 15,\ 9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03979}03979\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.44435602715924361,\ 0.038850140086788665)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03980}03980\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03981}03981\ \ \ \ \ \ \ \ \ x\ =\ [-\/1.23,\ 0.06,\ -\/0.60,\ 0.17,\ 0.66,\ -\/0.17,\ -\/0.08,\ 0.27,\ -\/0.98,\ -\/0.99]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03982}03982\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.293580126801961,\ 0.293408463684361)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03983}03983\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'greater'},\ 0.293580126801961,\ 0.146988835042376,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03984}03984\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'less'},\ 0.109348552425692,\ 0.732768892470675,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03985}03985\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03986}03986\ \ \ \ \ \textcolor{keyword}{def\ }test\_known\_examples(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03987}03987\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ following\ tests\ rely\ on\ deterministically\ replicated\ rvs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03988}03988\ \ \ \ \ \ \ \ \ x\ =\ stats.norm.rvs(loc=0.2,\ size=100,\ random\_state=987654321)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03989}03989\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.12464329735846891,\ 0.089444888711820769,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03990}03990\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'less'},\ 0.12464329735846891,\ 0.040989164077641749)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03991}03991\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ \textcolor{stringliteral}{'greater'},\ 0.0072115233216310994,\ 0.98531158590396228)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03992}03992\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03993}03993\ \ \ \ \ \textcolor{keyword}{def\ }test\_ks1samp\_allpaths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03994}03994\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ NaN\ input,\ output.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03995}03995\ \ \ \ \ \ \ \ \ assert\_(np.isnan(kolmogn(np.nan,\ 1,\ \textcolor{keyword}{True})))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03996}03996\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{'n\ is\ not\ integral:\ 1.5'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03997}03997\ \ \ \ \ \ \ \ \ \ \ \ \ kolmogn(1.5,\ 1,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03998}03998\ \ \ \ \ \ \ \ \ assert\_(np.isnan(kolmogn(-\/1,\ 1,\ \textcolor{keyword}{True})))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l03999}03999\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04000}04000\ \ \ \ \ \ \ \ \ dataset\ =\ np.asarray([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04001}04001\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ x\ out\ of\ range}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04002}04002\ \ \ \ \ \ \ \ \ \ \ \ \ (101,\ 1,\ \textcolor{keyword}{True},\ 1.0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04003}04003\ \ \ \ \ \ \ \ \ \ \ \ \ (101,\ 1.1,\ \textcolor{keyword}{True},\ 1.0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04004}04004\ \ \ \ \ \ \ \ \ \ \ \ \ (101,\ 0,\ \textcolor{keyword}{True},\ 0.0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04005}04005\ \ \ \ \ \ \ \ \ \ \ \ \ (101,\ -\/0.1,\ \textcolor{keyword}{True},\ 0.0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04006}04006\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04007}04007\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 1.0\ /\ 64,\ \textcolor{keyword}{True},\ 0.0),\ \ \textcolor{comment}{\#\ Ruben-\/Gambino}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04008}04008\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 1.0\ /\ 64,\ \textcolor{keyword}{False},\ 1.0),\ \ \textcolor{comment}{\#\ Ruben-\/Gambino}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04009}04009\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04010}04010\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 0.5,\ \textcolor{keyword}{True},\ 0.9999999363163307),\ \ \textcolor{comment}{\#\ Miller}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04011}04011\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 0.5,\ \textcolor{keyword}{False},\ 6.368366937916623e-\/08),\ \ \textcolor{comment}{\#\ Miller\ 2\ *\ special.smirnov(32,\ 0.5)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04012}04012\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04013}04013\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ some\ other\ paths}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04014}04014\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 1.0\ /\ 8,\ \textcolor{keyword}{True},\ 0.34624229979775223),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04015}04015\ \ \ \ \ \ \ \ \ \ \ \ \ (32,\ 1.0\ /\ 4,\ \textcolor{keyword}{True},\ 0.9699508336558085),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04016}04016\ \ \ \ \ \ \ \ \ \ \ \ \ (1600,\ 0.49,\ \textcolor{keyword}{False},\ 0.0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04017}04017\ \ \ \ \ \ \ \ \ \ \ \ \ (1600,\ 1\ /\ 16.0,\ \textcolor{keyword}{False},\ 7.0837876229702195e-\/06),\ \ \textcolor{comment}{\#\ 2\ *\ special.smirnov(1600,\ 1/16.0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04018}04018\ \ \ \ \ \ \ \ \ \ \ \ \ (1600,\ 14\ /\ 1600,\ \textcolor{keyword}{False},\ 0.99962357317602),\ \ \textcolor{comment}{\#\ \_kolmogn\_DMTW}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04019}04019\ \ \ \ \ \ \ \ \ \ \ \ \ (1600,\ 1\ /\ 32,\ \textcolor{keyword}{False},\ 0.08603386296651416),\ \ \textcolor{comment}{\#\ \_kolmogn\_PelzGood}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04020}04020\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04021}04021\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classscipy_1_1special_1_1__testutils_1_1FuncData}{FuncData}}(kolmogn,\ dataset,\ (0,\ 1,\ 2),\ 3).check(dtypes=[int,\ float,\ bool])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04022}04022\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04023}04023\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}ksfunc"{},\ [stats.kstest,\ stats.ks\_1samp])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04024}04024\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}alternative,\ x6val,\ ref\_location,\ ref\_sign"{}},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04025}04025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(\textcolor{stringliteral}{'greater'},\ 6,\ 6,\ +1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04026}04026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'less'},\ 7,\ 7,\ -\/1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04027}04027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'two-\/sided'},\ 6,\ 6,\ +1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04028}04028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'two-\/sided'},\ 7,\ 7,\ -\/1)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04029}04029\ \ \ \ \ \textcolor{keyword}{def\ }test\_location\_sign(self,\ ksfunc,\ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04030}04030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x6val,\ ref\_location,\ ref\_sign):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04031}04031\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ location\ and\ sign\ corresponding\ with\ statistic\ are\ as}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04032}04032\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expected.\ (Test\ is\ designed\ to\ be\ easy\ to\ predict.)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04033}04033\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10)\ +\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04034}04034\ \ \ \ \ \ \ \ \ x[6]\ =\ x6val}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04035}04035\ \ \ \ \ \ \ \ \ cdf\ =\ stats.uniform(scale=10).cdf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04036}04036\ \ \ \ \ \ \ \ \ res\ =\ ksfunc(x,\ cdf,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04037}04037\ \ \ \ \ \ \ \ \ assert\_allclose(res.statistic,\ 0.1,\ rtol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04038}04038\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic\_location\ ==\ ref\_location}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04039}04039\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic\_sign\ ==\ ref\_sign}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04040}04040\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04041}04041\ \ \ \ \ \textcolor{comment}{\#\ missing:\ no\ test\ that\ uses\ *args}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04042}04042\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04043}04043\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04044}04044\ \textcolor{keyword}{class\ }TestKSTwoSamples:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04045}04045\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Tests\ 2-\/samples\ with\ K-\/S\ various\ sizes,\ alternatives,\ modes."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04046}04046\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04047}04047\ \ \ \ \ \textcolor{keyword}{def\ }\_testOne(self,\ x1,\ x2,\ alternative,\ expected\_statistic,\ expected\_prob,\ mode='auto'):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04048}04048\ \ \ \ \ \ \ \ \ result\ =\ stats.ks\_2samp(x1,\ x2,\ alternative,\ mode=mode)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04049}04049\ \ \ \ \ \ \ \ \ expected\ =\ np.array([expected\_statistic,\ expected\_prob])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04050}04050\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.array(result),\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04051}04051\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04052}04052\ \ \ \ \ \textcolor{keyword}{def\ }testSmall(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04053}04053\ \ \ \ \ \ \ \ \ self.\_testOne([0],\ [1],\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0/1,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04054}04054\ \ \ \ \ \ \ \ \ self.\_testOne([0],\ [1],\ \textcolor{stringliteral}{'greater'},\ 1.0/1,\ 0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04055}04055\ \ \ \ \ \ \ \ \ self.\_testOne([0],\ [1],\ \textcolor{stringliteral}{'less'},\ 0.0/1,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04056}04056\ \ \ \ \ \ \ \ \ self.\_testOne([1],\ [0],\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0/1,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04057}04057\ \ \ \ \ \ \ \ \ self.\_testOne([1],\ [0],\ \textcolor{stringliteral}{'greater'},\ 0.0/1,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04058}04058\ \ \ \ \ \ \ \ \ self.\_testOne([1],\ [0],\ \textcolor{stringliteral}{'less'},\ 1.0/1,\ 0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04059}04059\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04060}04060\ \ \ \ \ \textcolor{keyword}{def\ }testTwoVsThree(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04061}04061\ \ \ \ \ \ \ \ \ data1\ =\ np.array([1.0,\ 2.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04062}04062\ \ \ \ \ \ \ \ \ data1p\ =\ data1\ +\ 0.01}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04063}04063\ \ \ \ \ \ \ \ \ data1m\ =\ data1\ -\/\ 0.01}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04064}04064\ \ \ \ \ \ \ \ \ data2\ =\ np.array([1.0,\ 2.0,\ 3.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04065}04065\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0\ /\ 3,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04066}04066\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'greater'},\ 1.0\ /\ 3,\ 0.7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04067}04067\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'less'},\ 1.0\ /\ 3,\ 0.7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04068}04068\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'two-\/sided'},\ 2.0\ /\ 3,\ 0.6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04069}04069\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'greater'},\ 2.0\ /\ 3,\ 0.3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04070}04070\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'less'},\ 0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04071}04071\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04072}04072\ \ \ \ \ \textcolor{keyword}{def\ }testTwoVsFour(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04073}04073\ \ \ \ \ \ \ \ \ data1\ =\ np.array([1.0,\ 2.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04074}04074\ \ \ \ \ \ \ \ \ data1p\ =\ data1\ +\ 0.01}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04075}04075\ \ \ \ \ \ \ \ \ data1m\ =\ data1\ -\/\ 0.01}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04076}04076\ \ \ \ \ \ \ \ \ data2\ =\ np.array([1.0,\ 2.0,\ 3.0,\ 4.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04077}04077\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'two-\/sided'},\ 2.0\ /\ 4,\ 14.0/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04078}04078\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'greater'},\ 2.0\ /\ 4,\ 8.0/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04079}04079\ \ \ \ \ \ \ \ \ self.\_testOne(data1p,\ data2,\ \textcolor{stringliteral}{'less'},\ 1.0\ /\ 4,\ 12.0/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04080}04080\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04081}04081\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'two-\/sided'},\ 3.0\ /\ 4,\ 6.0/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04082}04082\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'greater'},\ 3.0\ /\ 4,\ 3.0/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04083}04083\ \ \ \ \ \ \ \ \ self.\_testOne(data1m,\ data2,\ \textcolor{stringliteral}{'less'},\ 0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04084}04084\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04085}04085\ \ \ \ \ \textcolor{keyword}{def\ }test100\_100(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04086}04086\ \ \ \ \ \ \ \ \ x100\ =\ np.linspace(1,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04087}04087\ \ \ \ \ \ \ \ \ x100\_2\_p1\ =\ x100\ +\ 2\ +\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04088}04088\ \ \ \ \ \ \ \ \ x100\_2\_m1\ =\ x100\ +\ 2\ -\/\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04089}04089\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_p1,\ \textcolor{stringliteral}{'two-\/sided'},\ 3.0\ /\ 100,\ 0.9999999999962055)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04090}04090\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_p1,\ \textcolor{stringliteral}{'greater'},\ 3.0\ /\ 100,\ 0.9143290114276248)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04091}04091\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_p1,\ \textcolor{stringliteral}{'less'},\ 0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04092}04092\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_m1,\ \textcolor{stringliteral}{'two-\/sided'},\ 2.0\ /\ 100,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04093}04093\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_m1,\ \textcolor{stringliteral}{'greater'},\ 2.0\ /\ 100,\ 0.960978450786184)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04094}04094\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x100\_2\_m1,\ \textcolor{stringliteral}{'less'},\ 0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04095}04095\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04096}04096\ \ \ \ \ \textcolor{keyword}{def\ }test100\_110(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04097}04097\ \ \ \ \ \ \ \ \ x100\ =\ np.linspace(1,\ 100,\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04098}04098\ \ \ \ \ \ \ \ \ x110\ =\ np.linspace(1,\ 100,\ 110)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04099}04099\ \ \ \ \ \ \ \ \ x110\_20\_p1\ =\ x110\ +\ 20\ +\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04100}04100\ \ \ \ \ \ \ \ \ x110\_20\_m1\ =\ x110\ +\ 20\ -\/\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04101}04101\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 100,\ 110}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04102}04102\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_p1,\ \textcolor{stringliteral}{'two-\/sided'},\ 232.0\ /\ 1100,\ 0.015739183865607353)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04103}04103\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_p1,\ \textcolor{stringliteral}{'greater'},\ 232.0\ /\ 1100,\ 0.007869594319053203)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04104}04104\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_p1,\ \textcolor{stringliteral}{'less'},\ 0,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04105}04105\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_m1,\ \textcolor{stringliteral}{'two-\/sided'},\ 229.0\ /\ 1100,\ 0.017803803861026313)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04106}04106\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_m1,\ \textcolor{stringliteral}{'greater'},\ 229.0\ /\ 1100,\ 0.008901905958245056)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04107}04107\ \ \ \ \ \ \ \ \ self.\_testOne(x100,\ x110\_20\_m1,\ \textcolor{stringliteral}{'less'},\ 0.0,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04108}04108\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04109}04109\ \ \ \ \ \textcolor{keyword}{def\ }testRepeatedValues(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04110}04110\ \ \ \ \ \ \ \ \ x2233\ =\ np.array([2]\ *\ 3\ +\ [3]\ *\ 4\ +\ [5]\ *\ 5\ +\ [6]\ *\ 4,\ dtype=int)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04111}04111\ \ \ \ \ \ \ \ \ x3344\ =\ x2233\ +\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04112}04112\ \ \ \ \ \ \ \ \ x2356\ =\ np.array([2]\ *\ 3\ +\ [3]\ *\ 4\ +\ [5]\ *\ 10\ +\ [6]\ *\ 4,\ dtype=int)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04113}04113\ \ \ \ \ \ \ \ \ x3467\ =\ np.array([3]\ *\ 10\ +\ [4]\ *\ 2\ +\ [6]\ *\ 10\ +\ [7]\ *\ 4,\ dtype=int)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04114}04114\ \ \ \ \ \ \ \ \ self.\_testOne(x2233,\ x3344,\ \textcolor{stringliteral}{'two-\/sided'},\ 5.0/16,\ 0.4262934613454952)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04115}04115\ \ \ \ \ \ \ \ \ self.\_testOne(x2233,\ x3344,\ \textcolor{stringliteral}{'greater'},\ 5.0/16,\ 0.21465428276573786)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04116}04116\ \ \ \ \ \ \ \ \ self.\_testOne(x2233,\ x3344,\ \textcolor{stringliteral}{'less'},\ 0.0/16,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04117}04117\ \ \ \ \ \ \ \ \ self.\_testOne(x2356,\ x3467,\ \textcolor{stringliteral}{'two-\/sided'},\ 190.0/21/26,\ 0.0919245790168125)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04118}04118\ \ \ \ \ \ \ \ \ self.\_testOne(x2356,\ x3467,\ \textcolor{stringliteral}{'greater'},\ 190.0/21/26,\ 0.0459633806858544)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04119}04119\ \ \ \ \ \ \ \ \ self.\_testOne(x2356,\ x3467,\ \textcolor{stringliteral}{'less'},\ 70.0/21/26,\ 0.6121593130022775)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04120}04120\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04121}04121\ \ \ \ \ \textcolor{keyword}{def\ }testEqualSizes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04122}04122\ \ \ \ \ \ \ \ \ data2\ =\ np.array([1.0,\ 2.0,\ 3.0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04123}04123\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+1,\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0/3,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04124}04124\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+1,\ \textcolor{stringliteral}{'greater'},\ 1.0/3,\ 0.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04125}04125\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+1,\ \textcolor{stringliteral}{'less'},\ 0.0/3,\ 1.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04126}04126\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+0.5,\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0/3,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04127}04127\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+0.5,\ \textcolor{stringliteral}{'greater'},\ 1.0/3,\ 0.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04128}04128\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2+0.5,\ \textcolor{stringliteral}{'less'},\ 0.0/3,\ 1.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04129}04129\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2-\/0.5,\ \textcolor{stringliteral}{'two-\/sided'},\ 1.0/3,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04130}04130\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2-\/0.5,\ \textcolor{stringliteral}{'greater'},\ 0.0/3,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04131}04131\ \ \ \ \ \ \ \ \ self.\_testOne(data2,\ data2-\/0.5,\ \textcolor{stringliteral}{'less'},\ 1.0/3,\ 0.75)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04132}04132\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04133}04133\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04134}04134\ \ \ \ \ \textcolor{keyword}{def\ }testMiddlingBoth(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04135}04135\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 500,\ 600}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04136}04136\ \ \ \ \ \ \ \ \ n1,\ n2\ =\ 500,\ 600}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04137}04137\ \ \ \ \ \ \ \ \ delta\ =\ 1.0/n1/n2/2/2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04138}04138\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(1,\ 200,\ n1)\ -\/\ delta}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04139}04139\ \ \ \ \ \ \ \ \ y\ =\ np.linspace(2,\ 200,\ n2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04140}04140\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 2000.0\ /\ n1\ /\ n2,\ 1.0,\ mode=\textcolor{stringliteral}{'auto'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04141}04141\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 2000.0\ /\ n1\ /\ n2,\ 1.0,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04142}04142\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 2000.0\ /\ n1\ /\ n2,\ 0.9697596024683929,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04143}04143\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 500.0\ /\ n1\ /\ n2,\ 0.9968735843165021,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04144}04144\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04145}04145\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}ks\_2samp:\ Exact\ calculation\ unsuccessful."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04146}04146\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ message)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04147}04147\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 2000.0\ /\ n1\ /\ n2,\ 0.9697596024683929,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04148}04148\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 500.0\ /\ n1\ /\ n2,\ 0.9968735843165021,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04149}04149\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ w:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04150}04150\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04151}04151\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 500.0\ /\ n1\ /\ n2,\ 0.9968735843165021,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04152}04152\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__stats_acba029ec622d3342752d6633463b95b2}{\_check\_warnings}}(w,\ RuntimeWarning,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04153}04153\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04154}04154\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04155}04155\ \ \ \ \ \textcolor{keyword}{def\ }testMediumBoth(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04156}04156\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 1000,\ 1100}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04157}04157\ \ \ \ \ \ \ \ \ n1,\ n2\ =\ 1000,\ 1100}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04158}04158\ \ \ \ \ \ \ \ \ delta\ =\ 1.0/n1/n2/2/2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04159}04159\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(1,\ 200,\ n1)\ -\/\ delta}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04160}04160\ \ \ \ \ \ \ \ \ y\ =\ np.linspace(2,\ 200,\ n2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04161}04161\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 6600.0\ /\ n1\ /\ n2,\ 1.0,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04162}04162\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 6600.0\ /\ n1\ /\ n2,\ 1.0,\ mode=\textcolor{stringliteral}{'auto'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04163}04163\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 6600.0\ /\ n1\ /\ n2,\ 0.9573185808092622,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04164}04164\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 1000.0\ /\ n1\ /\ n2,\ 0.9982410869433984,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04165}04165\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04166}04166\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04167}04167\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}ks\_2samp:\ Exact\ calculation\ unsuccessful."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04168}04168\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ message)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04169}04169\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 6600.0\ /\ n1\ /\ n2,\ 0.9573185808092622,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04170}04170\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 1000.0\ /\ n1\ /\ n2,\ 0.9982410869433984,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04171}04171\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ w:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04172}04172\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04173}04173\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 1000.0\ /\ n1\ /\ n2,\ 0.9982410869433984,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04174}04174\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacescipy_1_1stats_1_1tests_1_1test__stats_acba029ec622d3342752d6633463b95b2}{\_check\_warnings}}(w,\ RuntimeWarning,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04175}04175\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04176}04176\ \ \ \ \ \textcolor{keyword}{def\ }testLarge(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04177}04177\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 10000,\ 110}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04178}04178\ \ \ \ \ \ \ \ \ n1,\ n2\ =\ 10000,\ 110}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04179}04179\ \ \ \ \ \ \ \ \ lcm\ =\ n1*11.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04180}04180\ \ \ \ \ \ \ \ \ delta\ =\ 1.0/n1/n2/2/2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04181}04181\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(1,\ 200,\ n1)\ -\/\ delta}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04182}04182\ \ \ \ \ \ \ \ \ y\ =\ np.linspace(2,\ 100,\ n2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04183}04183\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 55275.0\ /\ lcm,\ 4.2188474935755949e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04184}04184\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 561.0\ /\ lcm,\ 0.99115454582047591)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04185}04185\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 55275.0\ /\ lcm,\ 3.1317328311518713e-\/26)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04186}04186\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04187}04187\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh11184(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04188}04188\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 3000,\ 3001,\ exact\ two-\/sided}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04189}04189\ \ \ \ \ \ \ \ \ np.random.seed(123456)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04190}04190\ \ \ \ \ \ \ \ \ x\ =\ np.random.normal(size=3000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04191}04191\ \ \ \ \ \ \ \ \ y\ =\ np.random.normal(size=3001)\ *\ 1.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04192}04192\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.11292880151060758,\ 2.7755575615628914e-\/15,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04193}04193\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.11292880151060758,\ 2.7755575615628914e-\/15,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04194}04194\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04195}04195\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.xslow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04196}04196\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh11184\_bigger(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04197}04197\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 10000,\ 10001,\ exact\ two-\/sided}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04198}04198\ \ \ \ \ \ \ \ \ np.random.seed(123456)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04199}04199\ \ \ \ \ \ \ \ \ x\ =\ np.random.normal(size=10000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04200}04200\ \ \ \ \ \ \ \ \ y\ =\ np.random.normal(size=10001)\ *\ 1.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04201}04201\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.10597913208679133,\ 3.3149311398483503e-\/49,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04202}04202\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 0.10597913208679133,\ 2.7755575615628914e-\/15,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04203}04203\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 0.10597913208679133,\ 2.7947433906389253e-\/41,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04204}04204\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 0.09658002199780022,\ 2.7947433906389253e-\/41,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04205}04205\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04206}04206\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.xslow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04207}04207\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh12999(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04208}04208\ \ \ \ \ \ \ \ \ np.random.seed(123456)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04209}04209\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ range(1000,\ 12000,\ 1000):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04210}04210\ \ \ \ \ \ \ \ \ \ \ \ \ vals1\ =\ np.random.normal(size=(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04211}04211\ \ \ \ \ \ \ \ \ \ \ \ \ vals2\ =\ np.random.normal(size=(x\ +\ 10),\ loc=0.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04212}04212\ \ \ \ \ \ \ \ \ \ \ \ \ exact\ =\ stats.ks\_2samp(vals1,\ vals2,\ mode=\textcolor{stringliteral}{'exact'}).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04213}04213\ \ \ \ \ \ \ \ \ \ \ \ \ asymp\ =\ stats.ks\_2samp(vals1,\ vals2,\ mode=\textcolor{stringliteral}{'asymp'}).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04214}04214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ these\ two\ p-\/values\ should\ be\ in\ line\ with\ each\ other}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04215}04215\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_less(exact,\ 3\ *\ asymp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04216}04216\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_less(asymp,\ 3\ *\ exact)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04217}04217\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04218}04218\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04219}04219\ \ \ \ \ \textcolor{keyword}{def\ }testLargeBoth(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04220}04220\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 10000,\ 11000}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04221}04221\ \ \ \ \ \ \ \ \ n1,\ n2\ =\ 10000,\ 11000}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04222}04222\ \ \ \ \ \ \ \ \ lcm\ =\ n1*11.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04223}04223\ \ \ \ \ \ \ \ \ delta\ =\ 1.0/n1/n2/2/2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04224}04224\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(1,\ 200,\ n1)\ -\/\ delta}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04225}04225\ \ \ \ \ \ \ \ \ y\ =\ np.linspace(2,\ 200,\ n2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04226}04226\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 563.0\ /\ lcm,\ 0.9990660108966576,\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04227}04227\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 563.0\ /\ lcm,\ 0.9990456491488628,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04228}04228\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'two-\/sided'},\ 563.0\ /\ lcm,\ 0.9990660108966576,\ mode=\textcolor{stringliteral}{'auto'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04229}04229\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 563.0\ /\ lcm,\ 0.7561851877420673)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04230}04230\ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 10.0\ /\ lcm,\ 0.9998239693191724)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04231}04231\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04232}04232\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}ks\_2samp:\ Exact\ calculation\ unsuccessful."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04233}04233\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ message)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04234}04234\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'greater'},\ 563.0\ /\ lcm,\ 0.7561851877420673,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04235}04235\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_testOne(x,\ y,\ \textcolor{stringliteral}{'less'},\ 10.0\ /\ lcm,\ 0.9998239693191724,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04236}04236\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04237}04237\ \ \ \ \ \textcolor{keyword}{def\ }testNamedAttributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04238}04238\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04239}04239\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04240}04240\ \ \ \ \ \ \ \ \ res\ =\ stats.ks\_2samp([1,\ 2],\ [3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04241}04241\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04242}04242\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04243}04243\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04244}04244\ \ \ \ \ \textcolor{keyword}{def\ }test\_some\_code\_paths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04245}04245\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ some\ code\ paths\ are\ executed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04246}04246\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py}{scipy.stats.\_stats\_py}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04247}04247\ \ \ \ \ \ \ \ \ \ \ \ \ \_count\_paths\_outside\_method,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04248}04248\ \ \ \ \ \ \ \ \ \ \ \ \ \_compute\_outer\_prob\_inside\_method}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04249}04249\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04250}04250\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04251}04251\ \ \ \ \ \ \ \ \ \_compute\_outer\_prob\_inside\_method(1,\ 1,\ 1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04252}04252\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_a7203aa48462f055fd04fbfc629597002}{\_count\_paths\_outside\_method}}(1000,\ 1,\ 1,\ 1001)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04253}04253\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04254}04254\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'raise'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04255}04255\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(FloatingPointError,\ \_count\_paths\_outside\_method,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04256}04256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1100,\ 1099,\ 1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04257}04257\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(FloatingPointError,\ \_count\_paths\_outside\_method,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04258}04258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2000,\ 1000,\ 1,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04259}04259\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04260}04260\ \ \ \ \ \textcolor{keyword}{def\ }test\_argument\_checking(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04261}04261\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ an\ empty\ array\ causes\ a\ ValueError}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04262}04262\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ks\_2samp,\ [],\ [1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04263}04263\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ks\_2samp,\ [1],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04264}04264\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.ks\_2samp,\ [],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04265}04265\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04266}04266\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04267}04267\ \ \ \ \ \textcolor{keyword}{def\ }test\_gh12218(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04268}04268\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Ensure\ gh-\/12218\ is\ fixed."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04269}04269\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ gh-\/1228\ triggered\ a\ TypeError\ calculating\ sqrt(n1*n2*(n1+n2)).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04270}04270\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ n1,\ n2\ both\ large\ integers,\ the\ product\ exceeded\ 2\string^64}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04271}04271\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04272}04272\ \ \ \ \ \ \ \ \ n1\ =\ 2097152\ \ \textcolor{comment}{\#\ 2*\string^21}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04273}04273\ \ \ \ \ \ \ \ \ rvs1\ =\ stats.uniform.rvs(size=n1,\ loc=0.,\ scale=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04274}04274\ \ \ \ \ \ \ \ \ rvs2\ =\ rvs1\ +\ 1\ \ \textcolor{comment}{\#\ Exact\ value\ of\ rvs2\ doesn't\ matter.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04275}04275\ \ \ \ \ \ \ \ \ stats.ks\_2samp(rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{'greater'},\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04276}04276\ \ \ \ \ \ \ \ \ stats.ks\_2samp(rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{'less'},\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04277}04277\ \ \ \ \ \ \ \ \ stats.ks\_2samp(rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{'two-\/sided'},\ mode=\textcolor{stringliteral}{'asymp'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04278}04278\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04279}04279\ \ \ \ \ \textcolor{keyword}{def\ }test\_warnings\_gh\_14019(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04280}04280\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ RuntimeWarning\ is\ raised\ when\ method='auto'\ and\ exact}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04281}04281\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ p-\/value\ calculation\ fails.\ See\ gh-\/14019.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04282}04282\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(abs(hash(\textcolor{stringliteral}{'test\_warnings\_gh\_14019'})))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04283}04283\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ random\ samples\ of\ the\ same\ size\ as\ in\ the\ issue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04284}04284\ \ \ \ \ \ \ \ \ data1\ =\ rng.random(size=881)\ +\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04285}04285\ \ \ \ \ \ \ \ \ data2\ =\ rng.random(size=369)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04286}04286\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}ks\_2samp:\ Exact\ calculation\ unsuccessful"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04287}04287\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04288}04288\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.ks\_2samp(data1,\ data2,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04289}04289\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue,\ 0,\ atol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04290}04290\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04291}04291\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}ksfunc"{},\ [stats.kstest,\ stats.ks\_2samp])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04292}04292\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}alternative,\ x6val,\ ref\_location,\ ref\_sign"{}},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04293}04293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(\textcolor{stringliteral}{'greater'},\ 5.9,\ 5.9,\ +1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04294}04294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'less'},\ 6.1,\ 6.0,\ -\/1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04295}04295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'two-\/sided'},\ 5.9,\ 5.9,\ +1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04296}04296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'two-\/sided'},\ 6.1,\ 6.0,\ -\/1)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04297}04297\ \ \ \ \ \textcolor{keyword}{def\ }test\_location\_sign(self,\ ksfunc,\ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04298}04298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x6val,\ ref\_location,\ ref\_sign):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04299}04299\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ location\ and\ sign\ corresponding\ with\ statistic\ are\ as}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04300}04300\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expected.\ (Test\ is\ designed\ to\ be\ easy\ to\ predict.)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04301}04301\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04302}04302\ \ \ \ \ \ \ \ \ y\ =\ x.copy()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04303}04303\ \ \ \ \ \ \ \ \ x[6]\ =\ x6val}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04304}04304\ \ \ \ \ \ \ \ \ res\ =\ stats.ks\_2samp(x,\ y,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04305}04305\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic\ ==\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04306}04306\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic\_location\ ==\ ref\_location}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04307}04307\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic\_sign\ ==\ ref\_sign}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04308}04308\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04309}04309\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04310}04310\ \textcolor{keyword}{def\ }test\_ttest\_rel():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04311}04311\ \ \ \ \ \textcolor{comment}{\#\ regression\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04312}04312\ \ \ \ \ tr,pr\ =\ 0.81248591389165692,\ 0.41846234511362157}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04313}04313\ \ \ \ \ tpr\ =\ ([tr,-\/tr],[pr,pr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04314}04314\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04315}04315\ \ \ \ \ rvs1\ =\ np.linspace(1,100,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04316}04316\ \ \ \ \ rvs2\ =\ np.linspace(1.01,99.989,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04317}04317\ \ \ \ \ rvs1\_2D\ =\ np.array([np.linspace(1,100,100),\ np.linspace(1.01,99.989,100)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04318}04318\ \ \ \ \ rvs2\_2D\ =\ np.array([np.linspace(1.01,99.989,100),\ np.linspace(1,100,100)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04319}04319\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04320}04320\ \ \ \ \ t,p\ =\ stats.ttest\_rel(rvs1,\ rvs2,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04321}04321\ \ \ \ \ assert\_array\_almost\_equal([t,p],(tr,pr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04322}04322\ \ \ \ \ t,p\ =\ stats.ttest\_rel(rvs1\_2D.T,\ rvs2\_2D.T,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04323}04323\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04324}04324\ \ \ \ \ t,p\ =\ stats.ttest\_rel(rvs1\_2D,\ rvs2\_2D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04325}04325\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04326}04326\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04327}04327\ \ \ \ \ \textcolor{comment}{\#\ test\ scalars}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04328}04328\ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04329}04329\ \ \ \ \ \ \ \ \ \ \ \ \ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}},\ divide=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04330}04330\ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04331}04331\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(4.,\ 3.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04332}04332\ \ \ \ \ assert\_(np.isnan(t))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04333}04333\ \ \ \ \ assert\_(np.isnan(p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04334}04334\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04335}04335\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04336}04336\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04337}04337\ \ \ \ \ res\ =\ stats.ttest\_rel(rvs1,\ rvs2,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04338}04338\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04339}04339\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04340}04340\ \ \ \ \ \textcolor{comment}{\#\ test\ on\ 3\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04341}04341\ \ \ \ \ rvs1\_3D\ =\ np.dstack([rvs1\_2D,rvs1\_2D,rvs1\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04342}04342\ \ \ \ \ rvs2\_3D\ =\ np.dstack([rvs2\_2D,rvs2\_2D,rvs2\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04343}04343\ \ \ \ \ t,p\ =\ stats.ttest\_rel(rvs1\_3D,\ rvs2\_3D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04344}04344\ \ \ \ \ assert\_array\_almost\_equal(np.abs(t),\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04345}04345\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04346}04346\ \ \ \ \ assert\_equal(t.shape,\ (2,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04347}04347\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04348}04348\ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(np.moveaxis(rvs1\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04349}04349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.moveaxis(rvs2\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04350}04350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04351}04351\ \ \ \ \ assert\_array\_almost\_equal(np.abs(t),\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04352}04352\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04353}04353\ \ \ \ \ assert\_equal(t.shape,\ (3,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04354}04354\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04355}04355\ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04356}04356\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_rel,\ rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{"{}error"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04357}04357\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04358}04358\ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(rvs1,\ rvs2,\ axis=0,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04359}04359\ \ \ \ \ assert\_allclose(p,\ 1\ -\/\ pr/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04360}04360\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04361}04361\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04362}04362\ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(rvs1,\ rvs2,\ axis=0,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04363}04363\ \ \ \ \ assert\_allclose(p,\ pr/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04364}04364\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04365}04365\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04366}04366\ \ \ \ \ \textcolor{comment}{\#\ check\ nan\ policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04367}04367\ \ \ \ \ rng\ =\ np.random.RandomState(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04368}04368\ \ \ \ \ x\ =\ stats.norm.rvs(loc=5,\ scale=10,\ size=501,\ random\_state=rng)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04369}04369\ \ \ \ \ x[500]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04370}04370\ \ \ \ \ y\ =\ (stats.norm.rvs(loc=5,\ scale=10,\ size=501,\ random\_state=rng)\ +}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04371}04371\ \ \ \ \ \ \ \ \ \ stats.norm.rvs(scale=0.2,\ size=501,\ random\_state=rng))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04372}04372\ \ \ \ \ y[500]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04373}04373\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04374}04374\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04375}04375\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.ttest\_rel(x,\ x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04376}04376\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04377}04377\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_rel(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04378}04378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (0.25299925303978066,\ 0.8003729814201519))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04379}04379\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_rel,\ x,\ y,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04380}04380\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_rel,\ x,\ y,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04381}04381\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04382}04382\ \ \ \ \ \textcolor{comment}{\#\ test\ zero\ division\ problem}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04383}04383\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04384}04384\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_rel([0,\ 0,\ 0],\ [1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04385}04385\ \ \ \ \ assert\_equal((np.abs(t),\ p),\ (np.inf,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04386}04386\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04387}04387\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_rel([0,\ 0,\ 0],\ [0,\ 0,\ 0]),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04388}04388\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04389}04389\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ nan\ in\ input\ array\ result\ in\ nan\ output}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04390}04390\ \ \ \ \ \ \ \ \ anan\ =\ np.array([[1,\ np.nan],\ [-\/1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04391}04391\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_rel(anan,\ np.zeros((2,\ 2))),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04392}04392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ([0,\ np.nan],\ [1,\ np.nan]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04393}04393\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04394}04394\ \ \ \ \ \textcolor{comment}{\#\ test\ incorrect\ input\ shape\ raise\ an\ error}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04395}04395\ \ \ \ \ x\ =\ np.arange(24)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04396}04396\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_rel,\ x.reshape((8,\ 3)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04397}04397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x.reshape((2,\ 3,\ 4)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04398}04398\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04399}04399\ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ two-\/sided\ p-\/values\ to\ one\ sided\ using\ T\ result\ data.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04400}04400\ \ \ \ \ \textcolor{keyword}{def\ }convert(t,\ p,\ alt):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04401}04401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ <\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}less"{}})\ \textcolor{keywordflow}{or}\ (t\ >\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}greater"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04402}04402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ p\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04403}04403\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1\ -\/\ (p\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04404}04404\ \ \ \ \ converter\ =\ np.vectorize(convert)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04405}04405\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04406}04406\ \ \ \ \ rvs1\_2D[:,\ 20:30]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04407}04407\ \ \ \ \ rvs2\_2D[:,\ 15:25]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04408}04408\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04409}04409\ \ \ \ \ tr,\ pr\ =\ stats.ttest\_rel(rvs1\_2D,\ rvs2\_2D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04410}04410\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04411}04411\ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(rvs1\_2D,\ rvs2\_2D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04412}04412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04413}04413\ \ \ \ \ assert\_allclose(t,\ tr,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04414}04414\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04415}04415\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ converter(tr,\ pr,\ \textcolor{stringliteral}{'less'}),\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04416}04416\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04417}04417\ \ \ \ \ t,\ p\ =\ stats.ttest\_rel(rvs1\_2D,\ rvs2\_2D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04418}04418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04419}04419\ \ \ \ \ assert\_allclose(t,\ tr,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04420}04420\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04421}04421\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ converter(tr,\ pr,\ \textcolor{stringliteral}{'greater'}),\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04422}04422\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04423}04423\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04424}04424\ \textcolor{keyword}{def\ }test\_ttest\_rel\_nan\_2nd\_arg():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04425}04425\ \ \ \ \ \textcolor{comment}{\#\ regression\ test\ for\ gh-\/6134:\ nans\ in\ the\ second\ arg\ were\ not\ handled}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04426}04426\ \ \ \ \ x\ =\ [np.nan,\ 2.0,\ 3.0,\ 4.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04427}04427\ \ \ \ \ y\ =\ [1.0,\ 2.0,\ 1.0,\ 2.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04428}04428\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04429}04429\ \ \ \ \ r1\ =\ stats.ttest\_rel(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04430}04430\ \ \ \ \ r2\ =\ stats.ttest\_rel(y,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04431}04431\ \ \ \ \ assert\_allclose(r2.statistic,\ -\/r1.statistic,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04432}04432\ \ \ \ \ assert\_allclose(r2.pvalue,\ r1.pvalue,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04433}04433\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04434}04434\ \ \ \ \ \textcolor{comment}{\#\ NB:\ arguments\ are\ paired\ when\ NaNs\ are\ dropped}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04435}04435\ \ \ \ \ r3\ =\ stats.ttest\_rel(y[1:],\ x[1:])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04436}04436\ \ \ \ \ assert\_allclose(r2,\ r3,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04437}04437\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04438}04438\ \ \ \ \ \textcolor{comment}{\#\ ..\ and\ this\ is\ consistent\ with\ R.\ R\ code:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04439}04439\ \ \ \ \ \textcolor{comment}{\#\ x\ =\ c(NA,\ 2.0,\ 3.0,\ 4.0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04440}04440\ \ \ \ \ \textcolor{comment}{\#\ y\ =\ c(1.0,\ 2.0,\ 1.0,\ 2.0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04441}04441\ \ \ \ \ \textcolor{comment}{\#\ t.test(x,\ y,\ paired=TRUE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04442}04442\ \ \ \ \ assert\_allclose(r2,\ (-\/2,\ 0.1835),\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04443}04443\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04444}04444\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04445}04445\ \textcolor{keyword}{def\ }test\_ttest\_rel\_empty\_1d\_returns\_nan():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04446}04446\ \ \ \ \ \textcolor{comment}{\#\ Two\ empty\ inputs\ should\ return\ a\ TtestResult\ containing\ nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04447}04447\ \ \ \ \ \textcolor{comment}{\#\ for\ both\ values.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04448}04448\ \ \ \ \ result\ =\ stats.ttest\_rel([],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04449}04449\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04450}04450\ \ \ \ \ assert\_equal(result,\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04451}04451\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04452}04452\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04453}04453\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'b,\ expected\_shape'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04454}04454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(np.empty((1,\ 5,\ 0)),\ (3,\ 5)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04455}04455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.empty((1,\ 0,\ 0)),\ (3,\ 0))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04456}04456\ \textcolor{keyword}{def\ }test\_ttest\_rel\_axis\_size\_zero(b,\ expected\_shape):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04457}04457\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ test,\ the\ length\ of\ the\ axis\ dimension\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04458}04458\ \ \ \ \ \textcolor{comment}{\#\ The\ results\ should\ be\ arrays\ containing\ nan\ with\ shape}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04459}04459\ \ \ \ \ \textcolor{comment}{\#\ given\ by\ the\ broadcast\ nonaxis\ dimensions.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04460}04460\ \ \ \ \ a\ =\ np.empty((3,\ 1,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04461}04461\ \ \ \ \ result\ =\ stats.ttest\_rel(a,\ b,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04462}04462\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04463}04463\ \ \ \ \ expected\_value\ =\ np.full(expected\_shape,\ fill\_value=np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04464}04464\ \ \ \ \ assert\_equal(result.statistic,\ expected\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04465}04465\ \ \ \ \ assert\_equal(result.pvalue,\ expected\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04466}04466\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04467}04467\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04468}04468\ \textcolor{keyword}{def\ }test\_ttest\_rel\_nonaxis\_size\_zero():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04469}04469\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ test,\ the\ length\ of\ the\ axis\ dimension\ is\ nonzero,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04470}04470\ \ \ \ \ \textcolor{comment}{\#\ but\ one\ of\ the\ nonaxis\ dimensions\ has\ length\ 0.\ \ Check\ that}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04471}04471\ \ \ \ \ \textcolor{comment}{\#\ we\ still\ get\ the\ correctly\ broadcast\ shape,\ which\ is\ (5,\ 0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04472}04472\ \ \ \ \ \textcolor{comment}{\#\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04473}04473\ \ \ \ \ a\ =\ np.empty((1,\ 8,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04474}04474\ \ \ \ \ b\ =\ np.empty((5,\ 8,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04475}04475\ \ \ \ \ result\ =\ stats.ttest\_rel(a,\ b,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04476}04476\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04477}04477\ \ \ \ \ assert\_equal(result.statistic.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04478}04478\ \ \ \ \ assert\_equal(result.pvalue.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04479}04479\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04480}04480\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04481}04481\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}alternative"{},\ ['two-\/sided',\ 'less',\ 'greater'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04482}04482\ \textcolor{keyword}{def\ }test\_ttest\_rel\_ci\_1d(alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04483}04483\ \ \ \ \ \textcolor{comment}{\#\ test\ confidence\ interval\ method\ against\ reference\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04484}04484\ \ \ \ \ rng\ =\ np.random.default\_rng(3749065329432213059)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04485}04485\ \ \ \ \ n\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04486}04486\ \ \ \ \ x\ =\ rng.normal(size=n,\ loc=1.5,\ scale=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04487}04487\ \ \ \ \ y\ =\ rng.normal(size=n,\ loc=2,\ scale=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04488}04488\ \ \ \ \ \textcolor{comment}{\#\ Reference\ values\ generated\ with\ R\ t.test:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04489}04489\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04490}04490\ \ \ \ \ \textcolor{comment}{\#\ x\ =\ c(1.22825792,\ \ 1.63950485,\ \ 4.39025641,\ \ 0.68609437,\ \ 2.03813481,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04491}04491\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ -\/1.20040109,\ \ 1.81997937,\ \ 1.86854636,\ \ 2.94694282,\ \ 3.94291373)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04492}04492\ \ \ \ \ \textcolor{comment}{\#\ y\ =\ c(3.49961496,\ 1.53192536,\ 5.53620083,\ 2.91687718,\ 0.04858043,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04493}04493\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ 3.78505943,\ 3.3077496\ ,\ 2.30468892,\ 3.42168074,\ 0.56797592)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04494}04494\ \ \ \ \ \textcolor{comment}{\#\ t.test(x,\ y,\ paired=TRUE,\ conf.level=0.85,\ alternative='l')}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04495}04495\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04496}04496\ \ \ \ \ ref\ =\ \{\textcolor{stringliteral}{'two-\/sided'}:\ [-\/1.912194489914035,\ 0.400169725914035],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04497}04497\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'greater'}:\ [-\/1.563944820311475,\ np.inf],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04498}04498\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'less'}:\ [-\/np.inf,\ 0.05192005631147523]\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04499}04499\ \ \ \ \ res\ =\ stats.ttest\_rel(x,\ y,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04500}04500\ \ \ \ \ ci\ =\ res.confidence\_interval(confidence\_level=0.85)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04501}04501\ \ \ \ \ assert\_allclose(ci,\ ref[alternative])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04502}04502\ \ \ \ \ assert\_equal(res.df,\ n-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04503}04503\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04504}04504\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04505}04505\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}test\_fun,\ args"{}},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04506}04506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(stats.ttest\_1samp,\ (np.arange(10),\ 0)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04507}04507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (stats.ttest\_rel,\ (np.arange(10),\ np.arange(10)))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04508}04508\ \textcolor{keyword}{def\ }test\_ttest\_ci\_iv(test\_fun,\ args):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04509}04509\ \ \ \ \ \textcolor{comment}{\#\ test\ \`{}confidence\_interval`\ method\ input\ validation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04510}04510\ \ \ \ \ res\ =\ test\_fun(*args)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04511}04511\ \ \ \ \ message\ =\ \textcolor{stringliteral}{'\`{}confidence\_level`\ must\ be\ a\ number\ between\ 0\ and\ 1.'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04512}04512\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04513}04513\ \ \ \ \ \ \ \ \ res.confidence\_interval(confidence\_level=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04514}04514\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04515}04515\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04516}04516\ \textcolor{keyword}{def\ }\_desc\_stats(x1,\ x2,\ axis=0):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04517}04517\ \ \ \ \ \textcolor{keyword}{def\ }\_stats(x,\ axis=0):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04518}04518\ \ \ \ \ \ \ \ \ x\ =\ np.asarray(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04519}04519\ \ \ \ \ \ \ \ \ mu\ =\ np.mean(x,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04520}04520\ \ \ \ \ \ \ \ \ std\ =\ np.std(x,\ axis=axis,\ ddof=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04521}04521\ \ \ \ \ \ \ \ \ nobs\ =\ x.shape[axis]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04522}04522\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mu,\ std,\ nobs}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04523}04523\ \ \ \ \ \textcolor{keywordflow}{return}\ \_stats(x1,\ axis)\ +\ \_stats(x2,\ axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04524}04524\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04525}04525\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04526}04526\ \textcolor{keyword}{def\ }test\_ttest\_ind():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04527}04527\ \ \ \ \ \textcolor{comment}{\#\ regression\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04528}04528\ \ \ \ \ tr\ =\ 1.0912746897927283}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04529}04529\ \ \ \ \ pr\ =\ 0.27647818616351882}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04530}04530\ \ \ \ \ tpr\ =\ ([tr,-\/tr],[pr,pr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04531}04531\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04532}04532\ \ \ \ \ rvs2\ =\ np.linspace(1,100,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04533}04533\ \ \ \ \ rvs1\ =\ np.linspace(5,105,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04534}04534\ \ \ \ \ rvs1\_2D\ =\ np.array([rvs1,\ rvs2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04535}04535\ \ \ \ \ rvs2\_2D\ =\ np.array([rvs2,\ rvs1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04536}04536\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04537}04537\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1,\ rvs2,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04538}04538\ \ \ \ \ assert\_array\_almost\_equal([t,p],(tr,pr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04539}04539\ \ \ \ \ \textcolor{comment}{\#\ test\ from\_stats\ API}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04540}04540\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*\_desc\_stats(rvs1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04541}04541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rvs2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04542}04542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04543}04543\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_2D.T,\ rvs2\_2D.T,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04544}04544\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04545}04545\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D.T,\ rvs2\_2D.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04546}04546\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*args),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04547}04547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04548}04548\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_2D,\ rvs2\_2D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04549}04549\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04550}04550\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D,\ rvs2\_2D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04551}04551\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*args),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04552}04552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04553}04553\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04554}04554\ \ \ \ \ \textcolor{comment}{\#\ test\ scalars}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04555}04555\ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04556}04556\ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04557}04557\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(4.,\ 3.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04558}04558\ \ \ \ \ assert\_(np.isnan(t))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04559}04559\ \ \ \ \ assert\_(np.isnan(p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04560}04560\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04561}04561\ \ \ \ \ \textcolor{comment}{\#\ test\ on\ 3\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04562}04562\ \ \ \ \ rvs1\_3D\ =\ np.dstack([rvs1\_2D,rvs1\_2D,rvs1\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04563}04563\ \ \ \ \ rvs2\_3D\ =\ np.dstack([rvs2\_2D,rvs2\_2D,rvs2\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04564}04564\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_3D,\ rvs2\_3D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04565}04565\ \ \ \ \ assert\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04566}04566\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04567}04567\ \ \ \ \ assert\_equal(t.shape,\ (2,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04568}04568\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04569}04569\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(np.moveaxis(rvs1\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04570}04570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.moveaxis(rvs2\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04571}04571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04572}04572\ \ \ \ \ assert\_array\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04573}04573\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04574}04574\ \ \ \ \ assert\_equal(t.shape,\ (3,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04575}04575\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04576}04576\ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04577}04577\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_ind,\ rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{"{}error"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04578}04578\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_ind\_from\_stats,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04579}04579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *\_desc\_stats(rvs1\_2D.T,\ rvs2\_2D.T),\ alternative=\textcolor{stringliteral}{"{}error"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04580}04580\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04581}04581\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04582}04582\ \ \ \ \ assert\_allclose(p,\ 1\ -\/\ (pr/2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04583}04583\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04584}04584\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04585}04585\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1,\ rvs2,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04586}04586\ \ \ \ \ assert\_allclose(p,\ pr/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04587}04587\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04588}04588\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04589}04589\ \ \ \ \ \textcolor{comment}{\#\ Below\ makes\ sure\ ttest\_ind\_from\_stats\ p-\/val\ functions\ identically\ to}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04590}04590\ \ \ \ \ \textcolor{comment}{\#\ ttest\_ind}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04591}04591\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1\_2D.T,\ rvs2\_2D.T,\ axis=0,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04592}04592\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D.T,\ rvs2\_2D.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04593}04593\ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04594}04594\ \ \ \ \ \ \ \ \ stats.ttest\_ind\_from\_stats(*args,\ alternative=\textcolor{stringliteral}{"{}less"{}}),\ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04595}04595\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04596}04596\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1\_2D.T,\ rvs2\_2D.T,\ axis=0,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04597}04597\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D.T,\ rvs2\_2D.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04598}04598\ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04599}04599\ \ \ \ \ \ \ \ \ stats.ttest\_ind\_from\_stats(*args,\ alternative=\textcolor{stringliteral}{"{}greater"{}}),\ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04600}04600\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04601}04601\ \ \ \ \ \textcolor{comment}{\#\ check\ nan\ policy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04602}04602\ \ \ \ \ rng\ =\ np.random.RandomState(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04603}04603\ \ \ \ \ x\ =\ stats.norm.rvs(loc=5,\ scale=10,\ size=501,\ random\_state=rng)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04604}04604\ \ \ \ \ x[500]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04605}04605\ \ \ \ \ y\ =\ stats.norm.rvs(loc=5,\ scale=10,\ size=500,\ random\_state=rng)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04606}04606\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04607}04607\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04608}04608\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.ttest\_ind(x,\ y),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04609}04609\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04610}04610\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04611}04611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (0.24779670949091914,\ 0.80434267337517906))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04612}04612\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_ind,\ x,\ y,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04613}04613\ \ \ \ \ assert\_raises(ValueError,\ stats.ttest\_ind,\ x,\ y,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04614}04614\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04615}04615\ \ \ \ \ \textcolor{comment}{\#\ test\ zero\ division\ problem}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04616}04616\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04617}04617\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_ind([0,\ 0,\ 0],\ [1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04618}04618\ \ \ \ \ assert\_equal((np.abs(t),\ p),\ (np.inf,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04619}04619\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04620}04620\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04621}04621\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_ind([0,\ 0,\ 0],\ [0,\ 0,\ 0]),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04622}04622\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04623}04623\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ nan\ in\ input\ array\ result\ in\ nan\ output}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04624}04624\ \ \ \ \ \ \ \ \ anan\ =\ np.array([[1,\ np.nan],\ [-\/1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04625}04625\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_ind(anan,\ np.zeros((2,\ 2))),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04626}04626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ([0,\ np.nan],\ [1,\ np.nan]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04627}04627\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04628}04628\ \ \ \ \ rvs1\_3D[:,\ :,\ 10:15]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04629}04629\ \ \ \ \ rvs2\_3D[:,\ :,\ 6:12]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04630}04630\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04631}04631\ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ two-\/sided\ p-\/values\ to\ one\ sided\ using\ T\ result\ data.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04632}04632\ \ \ \ \ \textcolor{keyword}{def\ }convert(t,\ p,\ alt):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04633}04633\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ <\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}less"{}})\ \textcolor{keywordflow}{or}\ (t\ >\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}greater"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04634}04634\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ p\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04635}04635\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1\ -\/\ (p\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04636}04636\ \ \ \ \ converter\ =\ np.vectorize(convert)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04637}04637\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04638}04638\ \ \ \ \ tr,\ pr\ =\ stats.ttest\_ind(rvs1\_3D,\ rvs2\_3D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04639}04639\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04640}04640\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1\_3D,\ rvs2\_3D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04641}04641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04642}04642\ \ \ \ \ assert\_allclose(t,\ tr,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04643}04643\ \ \ \ \ assert\_allclose(p,\ converter(tr,\ pr,\ \textcolor{stringliteral}{'less'}),\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04644}04644\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04645}04645\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(rvs1\_3D,\ rvs2\_3D,\ 0,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04646}04646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04647}04647\ \ \ \ \ assert\_allclose(t,\ tr,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04648}04648\ \ \ \ \ assert\_allclose(p,\ converter(tr,\ pr,\ \textcolor{stringliteral}{'greater'}),\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04649}04649\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04650}04650\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04651}04651\ \textcolor{keyword}{class\ }Test\_ttest\_ind\_permutations():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04652}04652\ \ \ \ \ N\ =\ 20}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04653}04653\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04654}04654\ \ \ \ \ \textcolor{comment}{\#\ data\ for\ most\ tests}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04655}04655\ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04656}04656\ \ \ \ \ a\ =\ np.vstack((np.arange(3*N//4),\ np.random.random(3*N//4)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04657}04657\ \ \ \ \ b\ =\ np.vstack((np.arange(N//4)\ +\ 100,\ np.random.random(N//4)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04658}04658\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04659}04659\ \ \ \ \ \textcolor{comment}{\#\ data\ for\ equal\ variance\ tests}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04660}04660\ \ \ \ \ a2\ =\ np.arange(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04661}04661\ \ \ \ \ b2\ =\ np.arange(10)\ +\ 100}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04662}04662\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04663}04663\ \ \ \ \ \textcolor{comment}{\#\ data\ for\ exact\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04664}04664\ \ \ \ \ a3\ =\ [1,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04665}04665\ \ \ \ \ b3\ =\ [3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04666}04666\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04667}04667\ \ \ \ \ \textcolor{comment}{\#\ data\ for\ bigger\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04668}04668\ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04669}04669\ \ \ \ \ rvs1\ =\ stats.norm.rvs(loc=5,\ scale=10,\ \ \textcolor{comment}{\#\ type:\ ignore}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04670}04670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size=500).reshape(100,\ 5).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04671}04671\ \ \ \ \ rvs2\ =\ stats.norm.rvs(loc=8,\ scale=20,\ size=100)\ \ \textcolor{comment}{\#\ type:\ ignore}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04672}04672\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04673}04673\ \ \ \ \ p\_d\ =\ [1/1001,\ (676+1)/1001]\ \ \textcolor{comment}{\#\ desired\ pvalues}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04674}04674\ \ \ \ \ p\_d\_gen\ =\ [1/1001,\ (672\ +\ 1)/1001]\ \ \textcolor{comment}{\#\ desired\ pvalues\ for\ Generator\ seed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04675}04675\ \ \ \ \ p\_d\_big\ =\ [(993+1)/1001,\ (685+1)/1001,\ (840+1)/1001,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04676}04676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (955+1)/1001,\ (255+1)/1001]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04677}04677\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04678}04678\ \ \ \ \ params\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04679}04679\ \ \ \ \ \ \ \ \ (a,\ b,\ \{\textcolor{stringliteral}{"{}axis"{}}:\ 1\},\ p\_d),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ basic\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04680}04680\ \ \ \ \ \ \ \ \ (a.T,\ b.T,\ \{\textcolor{stringliteral}{'axis'}:\ 0\},\ p\_d),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ along\ axis\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04681}04681\ \ \ \ \ \ \ \ \ (a[0,\ :],\ b[0,\ :],\ \{\textcolor{stringliteral}{'axis'}:\ \textcolor{keywordtype}{None}\},\ p\_d[0]),\ \ \ \textcolor{comment}{\#\ 1d\ data}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04682}04682\ \ \ \ \ \ \ \ \ (a[0,\ :].tolist(),\ b[0,\ :].tolist(),\ \{\textcolor{stringliteral}{'axis'}:\ \textcolor{keywordtype}{None}\},\ p\_d[0]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04683}04683\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ different\ seeds}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04684}04684\ \ \ \ \ \ \ \ \ (a,\ b,\ \{\textcolor{stringliteral}{'random\_state'}:\ 0,\ \textcolor{stringliteral}{"{}axis"{}}:\ 1\},\ p\_d),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04685}04685\ \ \ \ \ \ \ \ \ (a,\ b,\ \{\textcolor{stringliteral}{'random\_state'}:\ np.random.RandomState(0),\ \textcolor{stringliteral}{"{}axis"{}}:\ 1\},\ p\_d),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04686}04686\ \ \ \ \ \ \ \ \ (a2,\ b2,\ \{\textcolor{stringliteral}{'equal\_var'}:\ \textcolor{keyword}{True}\},\ 1/1001),\ \ \textcolor{comment}{\#\ equal\ variances}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04687}04687\ \ \ \ \ \ \ \ \ (rvs1,\ rvs2,\ \{\textcolor{stringliteral}{'axis'}:\ -\/1,\ \textcolor{stringliteral}{'random\_state'}:\ 0\},\ p\_d\_big),\ \ \textcolor{comment}{\#\ bigger\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04688}04688\ \ \ \ \ \ \ \ \ (a3,\ b3,\ \{\},\ 1/3),\ \ \textcolor{comment}{\#\ exact\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04689}04689\ \ \ \ \ \ \ \ \ (a,\ b,\ \{\textcolor{stringliteral}{'random\_state'}:\ np.random.default\_rng(0),\ \textcolor{stringliteral}{"{}axis"{}}:\ 1\},\ p\_d\_gen),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04690}04690\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04691}04691\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04692}04692\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}a,b,update,p\_d"{},\ params)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04693}04693\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_permutations(self,\ a,\ b,\ update,\ p\_d):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04694}04694\ \ \ \ \ \ \ \ \ options\_a\ =\ \{\textcolor{stringliteral}{'axis'}:\ \textcolor{keywordtype}{None},\ \textcolor{stringliteral}{'equal\_var'}:\ \textcolor{keyword}{False}\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04695}04695\ \ \ \ \ \ \ \ \ options\_p\ =\ \{\textcolor{stringliteral}{'axis'}:\ \textcolor{keywordtype}{None},\ \textcolor{stringliteral}{'equal\_var'}:\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04696}04696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'permutations'}:\ 1000,\ \textcolor{stringliteral}{'random\_state'}:\ 0\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04697}04697\ \ \ \ \ \ \ \ \ options\_a.update(update)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04698}04698\ \ \ \ \ \ \ \ \ options\_p.update(update)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04699}04699\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04700}04700\ \ \ \ \ \ \ \ \ stat\_a,\ \_\ =\ stats.ttest\_ind(a,\ b,\ **options\_a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04701}04701\ \ \ \ \ \ \ \ \ stat\_p,\ pvalue\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04702}04702\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(stat\_a,\ stat\_p,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04703}04703\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(pvalue,\ p\_d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04704}04704\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04705}04705\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_exact\_alternative(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04706}04706\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04707}04707\ \ \ \ \ \ \ \ \ N\ =\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04708}04708\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(2,\ N,\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04709}04709\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(2,\ N,\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04710}04710\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04711}04711\ \ \ \ \ \ \ \ \ options\_p\ =\ \{\textcolor{stringliteral}{'axis'}:\ 1,\ \textcolor{stringliteral}{'permutations'}:\ 1000\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04712}04712\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04713}04713\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04714}04714\ \ \ \ \ \ \ \ \ res\_g\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04715}04715\ \ \ \ \ \ \ \ \ res\_g\_ba\ =\ stats.ttest\_ind(b,\ a,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04716}04716\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04717}04717\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04718}04718\ \ \ \ \ \ \ \ \ res\_l\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04719}04719\ \ \ \ \ \ \ \ \ res\_l\_ba\ =\ stats.ttest\_ind(b,\ a,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04720}04720\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04721}04721\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04722}04722\ \ \ \ \ \ \ \ \ res\_2\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04723}04723\ \ \ \ \ \ \ \ \ res\_2\_ba\ =\ stats.ttest\_ind(b,\ a,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04724}04724\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04725}04725\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Alternative\ doesn't\ affect\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04726}04726\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.statistic,\ res\_l\_ab.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04727}04727\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.statistic,\ res\_2\_ab.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04728}04728\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04729}04729\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reversing\ order\ of\ inputs\ negates\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04730}04730\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.statistic,\ -\/res\_g\_ba.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04731}04731\ \ \ \ \ \ \ \ \ assert\_equal(res\_l\_ab.statistic,\ -\/res\_l\_ba.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04732}04732\ \ \ \ \ \ \ \ \ assert\_equal(res\_2\_ab.statistic,\ -\/res\_2\_ba.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04733}04733\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04734}04734\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reversing\ order\ of\ inputs\ does\ not\ affect\ p-\/value\ of\ 2-\/sided\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04735}04735\ \ \ \ \ \ \ \ \ assert\_equal(res\_2\_ab.pvalue,\ res\_2\_ba.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04736}04736\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04737}04737\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ exact\ test,\ distribution\ is\ perfectly\ symmetric,\ so\ these}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04738}04738\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ identities\ are\ exactly\ satisfied.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04739}04739\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.pvalue,\ res\_l\_ba.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04740}04740\ \ \ \ \ \ \ \ \ assert\_equal(res\_l\_ab.pvalue,\ res\_g\_ba.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04741}04741\ \ \ \ \ \ \ \ \ mask\ =\ res\_g\_ab.pvalue\ <=\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04742}04742\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.pvalue[mask]\ +\ res\_l\_ba.pvalue[mask],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04743}04743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[mask])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04744}04744\ \ \ \ \ \ \ \ \ assert\_equal(res\_l\_ab.pvalue[\string~mask]\ +\ res\_g\_ba.pvalue[\string~mask],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04745}04745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[\string~mask])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04746}04746\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04747}04747\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_exact\_selection(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04748}04748\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ the\ various\ ways\ of\ activating\ the\ exact\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04749}04749\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04750}04750\ \ \ \ \ \ \ \ \ N\ =\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04751}04751\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(N)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04752}04752\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(N)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04753}04753\ \ \ \ \ \ \ \ \ res0\ =\ stats.ttest\_ind(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04754}04754\ \ \ \ \ \ \ \ \ res1\ =\ stats.ttest\_ind(a,\ b,\ permutations=1000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04755}04755\ \ \ \ \ \ \ \ \ res2\ =\ stats.ttest\_ind(a,\ b,\ permutations=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04756}04756\ \ \ \ \ \ \ \ \ res3\ =\ stats.ttest\_ind(a,\ b,\ permutations=np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04757}04757\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res1.pvalue\ !=\ res0.pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04758}04758\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res2.pvalue\ ==\ res0.pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04759}04759\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res3.pvalue\ ==\ res1.pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04760}04760\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04761}04761\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_exact\_distribution(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04762}04762\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ exact\ distribution\ of\ the\ test\ statistic\ should\ have}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04763}04763\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ binom(na\ +\ nb,\ na)\ elements,\ all\ unique.\ This\ was\ not\ always\ true}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04764}04764\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ gh-\/4824;\ fixed\ by\ gh-\/13661.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04765}04765\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04766}04766\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04767}04767\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04768}04768\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04769}04769\ \ \ \ \ \ \ \ \ data\ =\ np.concatenate((a,\ b))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04770}04770\ \ \ \ \ \ \ \ \ na,\ nb\ =\ len(a),\ len(b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04771}04771\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04772}04772\ \ \ \ \ \ \ \ \ permutations\ =\ 100000}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04773}04773\ \ \ \ \ \ \ \ \ t\_stat,\ \_,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__stats__py_ab3be4c10d446d0f0d68e56a854ba225c}{\_permutation\_distribution\_t}}(data,\ permutations,\ na,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04774}04774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04775}04775\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04776}04776\ \ \ \ \ \ \ \ \ n\_unique\ =\ len(set(t\_stat))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04777}04777\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ n\_unique\ ==\ binom(na\ +\ nb,\ na)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04778}04778\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ len(t\_stat)\ ==\ n\_unique}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04779}04779\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04780}04780\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_randperm\_alternative(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04781}04781\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04782}04782\ \ \ \ \ \ \ \ \ N\ =\ 50}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04783}04783\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(2,\ 3,\ N)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04784}04784\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(3,\ N)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04785}04785\ \ \ \ \ \ \ \ \ options\_p\ =\ \{\textcolor{stringliteral}{'axis'}:\ -\/1,\ \textcolor{stringliteral}{'permutations'}:\ 1000,\ \textcolor{stringliteral}{"{}random\_state"{}}:\ 0\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04786}04786\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04787}04787\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04788}04788\ \ \ \ \ \ \ \ \ res\_g\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04789}04789\ \ \ \ \ \ \ \ \ res\_g\_ba\ =\ stats.ttest\_ind(b,\ a,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04790}04790\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04791}04791\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04792}04792\ \ \ \ \ \ \ \ \ res\_l\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04793}04793\ \ \ \ \ \ \ \ \ res\_l\_ba\ =\ stats.ttest\_ind(b,\ a,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04794}04794\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04795}04795\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Alternative\ doesn't\ affect\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04796}04796\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.statistic,\ res\_l\_ab.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04797}04797\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04798}04798\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reversing\ order\ of\ inputs\ negates\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04799}04799\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.statistic,\ -\/res\_g\_ba.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04800}04800\ \ \ \ \ \ \ \ \ assert\_equal(res\_l\_ab.statistic,\ -\/res\_l\_ba.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04801}04801\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04802}04802\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ random\ permutations,\ the\ chance\ of\ ties\ between\ the\ observed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04803}04803\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ statistic\ and\ the\ population\ is\ small,\ so:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04804}04804\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.pvalue\ +\ res\_l\_ab.pvalue,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04805}04805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1\ +\ 1/(options\_p[\textcolor{stringliteral}{'permutations'}]\ +\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04806}04806\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ba.pvalue\ +\ res\_l\_ba.pvalue,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04807}04807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1\ +\ 1/(options\_p[\textcolor{stringliteral}{'permutations'}]\ +\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04808}04808\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04809}04809\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow()}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04810}04810\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_randperm\_alternative2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04811}04811\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04812}04812\ \ \ \ \ \ \ \ \ N\ =\ 50}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04813}04813\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(N,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04814}04814\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(N,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04815}04815\ \ \ \ \ \ \ \ \ options\_p\ =\ \{\textcolor{stringliteral}{'permutations'}:\ 20000,\ \textcolor{stringliteral}{"{}random\_state"{}}:\ 0\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04816}04816\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04817}04817\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04818}04818\ \ \ \ \ \ \ \ \ res\_g\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04819}04819\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04820}04820\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04821}04821\ \ \ \ \ \ \ \ \ res\_l\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04822}04822\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04823}04823\ \ \ \ \ \ \ \ \ options\_p.update(alternative=\textcolor{stringliteral}{"{}two-\/sided"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04824}04824\ \ \ \ \ \ \ \ \ res\_2\_ab\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04825}04825\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04826}04826\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ random\ permutations,\ the\ chance\ of\ ties\ between\ the\ observed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04827}04827\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ statistic\ and\ the\ population\ is\ small,\ so:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04828}04828\ \ \ \ \ \ \ \ \ assert\_equal(res\_g\_ab.pvalue\ +\ res\_l\_ab.pvalue,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04829}04829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1\ +\ 1/(options\_p[\textcolor{stringliteral}{'permutations'}]\ +\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04830}04830\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04831}04831\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ for\ large\ sample\ sizes,\ the\ distribution\ should\ be\ approximately}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04832}04832\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ symmetric,\ so\ these\ identities\ should\ be\ approximately\ satisfied}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04833}04833\ \ \ \ \ \ \ \ \ mask\ =\ res\_g\_ab.pvalue\ <=\ 0.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04834}04834\ \ \ \ \ \ \ \ \ assert\_allclose(2\ *\ res\_g\_ab.pvalue[mask],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04835}04835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[mask],\ atol=2e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04836}04836\ \ \ \ \ \ \ \ \ assert\_allclose(2\ *\ (1-\/res\_g\_ab.pvalue[\string~mask]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04837}04837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[\string~mask],\ atol=2e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04838}04838\ \ \ \ \ \ \ \ \ assert\_allclose(2\ *\ res\_l\_ab.pvalue[\string~mask],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04839}04839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[\string~mask],\ atol=2e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04840}04840\ \ \ \ \ \ \ \ \ assert\_allclose(2\ *\ (1-\/res\_l\_ab.pvalue[mask]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04841}04841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_2\_ab.pvalue[mask],\ atol=2e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04842}04842\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04843}04843\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_permutation\_nanpolicy(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04844}04844\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04845}04845\ \ \ \ \ \ \ \ \ N\ =\ 50}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04846}04846\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(N,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04847}04847\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(N,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04848}04848\ \ \ \ \ \ \ \ \ a[5,\ 1]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04849}04849\ \ \ \ \ \ \ \ \ b[8,\ 2]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04850}04850\ \ \ \ \ \ \ \ \ a[9,\ 3]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04851}04851\ \ \ \ \ \ \ \ \ b[9,\ 3]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04852}04852\ \ \ \ \ \ \ \ \ options\_p\ =\ \{\textcolor{stringliteral}{'permutations'}:\ 1000,\ \textcolor{stringliteral}{"{}random\_state"{}}:\ 0\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04853}04853\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04854}04854\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Raise}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04855}04855\ \ \ \ \ \ \ \ \ options\_p.update(nan\_policy=\textcolor{stringliteral}{"{}raise"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04856}04856\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}The\ input\ contains\ nan\ values"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04857}04857\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04858}04858\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04859}04859\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Propagate}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04860}04860\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04861}04861\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}invalid\ value*"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04862}04862\ \ \ \ \ \ \ \ \ \ \ \ \ options\_p.update(nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04863}04863\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(a,\ b,\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04864}04864\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04865}04865\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ =\ np.isnan(a).any(axis=0)\ |\ np.isnan(b).any(axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04866}04866\ \ \ \ \ \ \ \ \ \ \ \ \ res2\ =\ stats.ttest\_ind(a[:,\ \string~mask],\ b[:,\ \string~mask],\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04867}04867\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04868}04868\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res.pvalue[mask],\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04869}04869\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res.statistic[mask],\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04870}04870\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04871}04871\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue[\string~mask],\ res2.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04872}04872\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res.statistic[\string~mask],\ res2.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04873}04873\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04874}04874\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Propagate\ 1d}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04875}04875\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(a.ravel(),\ b.ravel(),\ **options\_p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04876}04876\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(res.pvalue)\ \ \textcolor{comment}{\#\ assert\ makes\ sure\ it's\ a\ scalar}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04877}04877\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04878}04878\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04879}04879\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_permutation\_check\_inputs(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04880}04880\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Permutations\ must\ be"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04881}04881\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ttest\_ind(self.a2,\ self.b2,\ permutations=-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04882}04882\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Permutations\ must\ be"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04883}04883\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ttest\_ind(self.a2,\ self.b2,\ permutations=1.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04884}04884\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}'hello'\ cannot\ be\ used"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04885}04885\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ttest\_ind(self.a,\ self.b,\ permutations=1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04886}04886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=\textcolor{stringliteral}{'hello'},\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04887}04887\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04888}04888\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_ind\_permutation\_check\_p\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04889}04889\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ p-\/values\ should\ never\ be\ exactly\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04890}04890\ \ \ \ \ \ \ \ \ N\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04891}04891\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(N,\ 20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04892}04892\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(N,\ 20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04893}04893\ \ \ \ \ \ \ \ \ p\_values\ =\ stats.ttest\_ind(a,\ b,\ permutations=1).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04894}04894\ \ \ \ \ \ \ \ \ print(0.0\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ p\_values)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04895}04895\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ 0.0\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ p\_values}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04896}04896\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04897}04897\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04898}04898\ \textcolor{keyword}{class\ }Test\_ttest\_ind\_common:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04899}04899\ \ \ \ \ \textcolor{comment}{\#\ for\ tests\ that\ are\ performed\ on\ variations\ of\ the\ t-\/test\ such\ as}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04900}04900\ \ \ \ \ \textcolor{comment}{\#\ permutations\ and\ trimming}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04901}04901\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow()}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04902}04902\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}kwds"{}},\ [\{\textcolor{stringliteral}{'permutations'}:\ 200,\ \textcolor{stringliteral}{'random\_state'}:\ 0\},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04903}04903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'trim'}:\ .2\},\ \{\}],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04904}04904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ids=[\textcolor{stringliteral}{"{}permutations"{}},\ \textcolor{stringliteral}{"{}trim"{}},\ \textcolor{stringliteral}{"{}basic"{}}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04905}04905\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'equal\_var'},\ [\textcolor{keyword}{True},\ \textcolor{keyword}{False}],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04906}04906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ids=[\textcolor{stringliteral}{'equal\_var'},\ \textcolor{stringliteral}{'unequal\_var'}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04907}04907\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_many\_dims(self,\ kwds,\ equal\_var):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04908}04908\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ test\ works\ on\ many-\/dimensional\ arrays}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04909}04909\ \ \ \ \ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04910}04910\ \ \ \ \ \ \ \ \ a\ =\ np.random.rand(5,\ 4,\ 4,\ 7,\ 1,\ 6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04911}04911\ \ \ \ \ \ \ \ \ b\ =\ np.random.rand(4,\ 1,\ 8,\ 2,\ 6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04912}04912\ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(a,\ b,\ axis=-\/3,\ **kwds)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04913}04913\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04914}04914\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ compare\ fully-\/vectorized\ t-\/test\ against\ t-\/test\ on\ smaller\ slice}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04915}04915\ \ \ \ \ \ \ \ \ i,\ j,\ k\ =\ 2,\ 3,\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04916}04916\ \ \ \ \ \ \ \ \ a2\ =\ a[i,\ :,\ j,\ :,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04917}04917\ \ \ \ \ \ \ \ \ b2\ =\ b[:,\ 0,\ :,\ k,\ :]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04918}04918\ \ \ \ \ \ \ \ \ res2\ =\ stats.ttest\_ind(a2,\ b2,\ axis=-\/2,\ **kwds)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04919}04919\ \ \ \ \ \ \ \ \ assert\_equal(res.statistic[i,\ :,\ j,\ k,\ :],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04920}04920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res2.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04921}04921\ \ \ \ \ \ \ \ \ assert\_equal(res.pvalue[i,\ :,\ j,\ k,\ :],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04922}04922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res2.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04923}04923\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04924}04924\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ compare\ against\ t-\/test\ on\ one\ axis-\/slice\ at\ a\ time}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04925}04925\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04926}04926\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ manually\ broadcast\ with\ tile;\ move\ axis\ to\ end\ to\ simplify}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04927}04927\ \ \ \ \ \ \ \ \ x\ =\ np.moveaxis(np.tile(a,\ (1,\ 1,\ 1,\ 1,\ 2,\ 1)),\ -\/3,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04928}04928\ \ \ \ \ \ \ \ \ y\ =\ np.moveaxis(np.tile(b,\ (5,\ 1,\ 4,\ 1,\ 1,\ 1)),\ -\/3,\ -\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04929}04929\ \ \ \ \ \ \ \ \ shape\ =\ x.shape[:-\/1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04930}04930\ \ \ \ \ \ \ \ \ statistics\ =\ np.zeros(shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04931}04931\ \ \ \ \ \ \ \ \ pvalues\ =\ np.zeros(shape)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04932}04932\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ indices\ \textcolor{keywordflow}{in}\ product(*(range(i)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ shape)):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04933}04933\ \ \ \ \ \ \ \ \ \ \ \ \ xi\ =\ x[indices]\ \ \textcolor{comment}{\#\ use\ tuple\ to\ index\ single\ axis\ slice}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04934}04934\ \ \ \ \ \ \ \ \ \ \ \ \ yi\ =\ y[indices]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04935}04935\ \ \ \ \ \ \ \ \ \ \ \ \ res3\ =\ stats.ttest\_ind(xi,\ yi,\ axis=-\/1,\ **kwds)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04936}04936\ \ \ \ \ \ \ \ \ \ \ \ \ statistics[indices]\ =\ res3.statistic}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04937}04937\ \ \ \ \ \ \ \ \ \ \ \ \ pvalues[indices]\ =\ res3.pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04938}04938\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04939}04939\ \ \ \ \ \ \ \ \ assert\_allclose(statistics,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04940}04940\ \ \ \ \ \ \ \ \ assert\_allclose(pvalues,\ res.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04941}04941\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04942}04942\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}kwds"{}},\ [\{\textcolor{stringliteral}{'permutations'}:\ 200,\ \textcolor{stringliteral}{'random\_state'}:\ 0\},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04943}04943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'trim'}:\ .2\},\ \{\}],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04944}04944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ids=[\textcolor{stringliteral}{"{}trim"{}},\ \textcolor{stringliteral}{"{}permutations"{}},\ \textcolor{stringliteral}{"{}basic"{}}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04945}04945\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}axis"{},\ [-\/1,\ 0])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04946}04946\ \ \ \ \ \textcolor{keyword}{def\ }test\_nans\_on\_axis(self,\ kwds,\ axis):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04947}04947\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ confirm\ that\ with\ \`{}nan\_policy='propagate'`,\ NaN\ results\ are\ returned}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04948}04948\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ on\ the\ correct\ location}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04949}04949\ \ \ \ \ \ \ \ \ a\ =\ np.random.randint(10,\ size=(5,\ 3,\ 10)).astype(\textcolor{stringliteral}{'float'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04950}04950\ \ \ \ \ \ \ \ \ b\ =\ np.random.randint(10,\ size=(5,\ 3,\ 10)).astype(\textcolor{stringliteral}{'float'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04951}04951\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ set\ some\ indices\ in\ \`{}a`\ and\ \`{}b`\ to\ be\ \`{}np.nan`.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04952}04952\ \ \ \ \ \ \ \ \ a[0][2][3]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04953}04953\ \ \ \ \ \ \ \ \ b[2][0][6]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04954}04954\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04955}04955\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ arbitrarily\ use\ \`{}np.sum`\ as\ a\ baseline\ for\ which\ indices\ should\ be}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04956}04956\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04957}04957\ \ \ \ \ \ \ \ \ expected\ =\ np.isnan(np.sum(a\ +\ b,\ axis=axis))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04958}04958\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ multidimensional\ inputs\ to\ \`{}t.sf(np.abs(t),\ df)`\ with\ NaNs\ on\ some}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04959}04959\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ indices\ throws\ an\ warning.\ See\ issue\ gh-\/13844}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04960}04960\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04961}04961\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04962}04962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ value\ encountered\ in\ less\_equal"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04963}04963\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04964}04964\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(a,\ b,\ axis=axis,\ **kwds)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04965}04965\ \ \ \ \ \ \ \ \ p\_nans\ =\ np.isnan(res.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04966}04966\ \ \ \ \ \ \ \ \ assert\_array\_equal(p\_nans,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04967}04967\ \ \ \ \ \ \ \ \ statistic\_nans\ =\ np.isnan(res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04968}04968\ \ \ \ \ \ \ \ \ assert\_array\_equal(statistic\_nans,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04969}04969\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04970}04970\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04971}04971\ \textcolor{keyword}{class\ }Test\_ttest\_trim:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04972}04972\ \ \ \ \ params\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04973}04973\ \ \ \ \ \ \ \ \ [[1,\ 2,\ 3],\ [1.1,\ 2.9,\ 4.2],\ 0.53619490753126731,\ -\/0.6864951273557258,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04974}04974\ \ \ \ \ \ \ \ \ \ .2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04975}04975\ \ \ \ \ \ \ \ \ [[56,\ 128.6,\ 12,\ 123.8,\ 64.34,\ 78,\ 763.3],\ [1.1,\ 2.9,\ 4.2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04976}04976\ \ \ \ \ \ \ \ \ \ 0.00998909252078421,\ 4.591598691181999,\ .2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04977}04977\ \ \ \ \ \ \ \ \ [[56,\ 128.6,\ 12,\ 123.8,\ 64.34,\ 78,\ 763.3],\ [1.1,\ 2.9,\ 4.2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04978}04978\ \ \ \ \ \ \ \ \ \ 0.10512380092302633,\ 2.832256715395378,\ .32],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04979}04979\ \ \ \ \ \ \ \ \ [[2.7,\ 2.7,\ 1.1,\ 3.0,\ 1.9,\ 3.0,\ 3.8,\ 3.8,\ 0.3,\ 1.9,\ 1.9],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04980}04980\ \ \ \ \ \ \ \ \ \ [6.5,\ 5.4,\ 8.1,\ 3.5,\ 0.5,\ 3.8,\ 6.8,\ 4.9,\ 9.5,\ 6.2,\ 4.1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04981}04981\ \ \ \ \ \ \ \ \ \ 0.002878909511344,\ -\/4.2461168970325,\ .2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04982}04982\ \ \ \ \ \ \ \ \ [[-\/0.84504783,\ 0.13366078,\ 3.53601757,\ -\/0.62908581,\ 0.54119466,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04983}04983\ \ \ \ \ \ \ \ \ \ \ -\/1.16511574,\ -\/0.08836614,\ 1.18495416,\ 2.48028757,\ -\/1.58925028,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04984}04984\ \ \ \ \ \ \ \ \ \ \ -\/1.6706357,\ 0.3090472,\ -\/2.12258305,\ 0.3697304,\ -\/1.0415207,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04985}04985\ \ \ \ \ \ \ \ \ \ \ -\/0.57783497,\ -\/0.90997008,\ 1.09850192,\ 0.41270579,\ -\/1.4927376],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04986}04986\ \ \ \ \ \ \ \ \ \ [1.2725522,\ 1.1657899,\ 2.7509041,\ 1.2389013,\ -\/0.9490494,\ -\/1.0752459,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04987}04987\ \ \ \ \ \ \ \ \ \ \ 1.1038576,\ 2.9912821,\ 3.5349111,\ 0.4171922,\ 1.0168959,\ -\/0.7625041,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04988}04988\ \ \ \ \ \ \ \ \ \ \ -\/0.4300008,\ 3.0431921,\ 1.6035947,\ 0.5285634,\ -\/0.7649405,\ 1.5575896,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04989}04989\ \ \ \ \ \ \ \ \ \ \ 1.3670797,\ 1.1726023],\ 0.005293305834235,\ -\/3.0983317739483,\ .2]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04990}04990\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04991}04991\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}a,b,pr,tr,trim"{},\ params)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04992}04992\ \ \ \ \ \textcolor{keyword}{def\ }test\_ttest\_compare\_r(self,\ a,\ b,\ pr,\ tr,\ trim):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04993}04993\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04994}04994\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Using\ PairedData's\ yuen.t.test\ method.\ Something\ to\ note\ is\ that\ there}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04995}04995\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ are\ at\ least\ 3\ R\ packages\ that\ come\ with\ a\ trimmed\ t-\/test\ method,\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04996}04996\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ comparisons\ were\ made\ between\ them.\ It\ was\ found\ that\ PairedData's}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04997}04997\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ method's\ results\ match\ this\ method,\ SAS,\ and\ one\ of\ the\ other\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04998}04998\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ methods.\ A\ notable\ discrepancy\ was\ the\ DescTools\ implementation\ of\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l04999}04999\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ function,\ which\ only\ sometimes\ agreed\ with\ SAS,\ WRS2,\ PairedData\ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05000}05000\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ this\ implementation.\ For\ this\ reason,\ most\ comparisons\ in\ R\ are\ made}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05001}05001\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ against\ PairedData's\ method.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05002}05002\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05003}05003\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Rather\ than\ providing\ the\ input\ and\ output\ for\ all\ evaluations,\ here\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05004}05004\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ representative\ example:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05005}05005\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library(PairedData)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05006}05006\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ a\ <-\/\ c(1,\ 2,\ 3)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05007}05007\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ b\ <-\/\ c(1.1,\ 2.9,\ 4.2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05008}05008\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05009}05009\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ yuen.t.test(a,\ b,\ tr=.2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05010}05010\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05011}05011\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Two-\/sample\ Yuen\ test,\ trim=0.2}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05012}05012\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05013}05013\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data:\ \ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05014}05014\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ t\ =\ -\/0.68649512735573,\ df\ =\ 3.4104431643464,\ p-\/value\ =\ 0.5361949075313}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05015}05015\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ alternative\ hypothesis:\ true\ difference\ in\ trimmed\ means\ is\ not\ equal}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05016}05016\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05017}05017\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 95\ percent\ confidence\ interval:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05018}05018\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ -\/3.912777195645217\ \ 2.446110528978550}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05019}05019\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\ estimates:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05020}05020\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ trimmed\ mean\ of\ x\ trimmed\ mean\ of\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05021}05021\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 2.000000000000000\ 2.73333333333333}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05022}05022\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05023}05023\ \ \ \ \ \ \ \ \ statistic,\ pvalue\ =\ stats.ttest\_ind(a,\ b,\ trim=trim,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05024}05024\ \ \ \ \ \ \ \ \ assert\_allclose(statistic,\ tr,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05025}05025\ \ \ \ \ \ \ \ \ assert\_allclose(pvalue,\ pr,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05026}05026\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05027}05027\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_SAS(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05028}05028\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Source\ of\ the\ data\ used\ in\ this\ test:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05029}05029\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://support.sas.com/resources/papers/proceedings14/1660-\/2014.pdf}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05030}05030\ \ \ \ \ \ \ \ \ a\ =\ [12,\ 14,\ 18,\ 25,\ 32,\ 44,\ 12,\ 14,\ 18,\ 25,\ 32,\ 44]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05031}05031\ \ \ \ \ \ \ \ \ b\ =\ [17,\ 22,\ 14,\ 12,\ 30,\ 29,\ 19,\ 17,\ 22,\ 14,\ 12,\ 30,\ 29,\ 19]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05032}05032\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ this\ paper,\ a\ trimming\ percentage\ of\ 5\%\ is\ used.\ However,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05033}05033\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ their\ implementation,\ the\ number\ of\ values\ trimmed\ is\ rounded\ to}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05034}05034\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ nearest\ whole\ number.\ However,\ consistent\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05035}05035\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}scipy.stats.trimmed\_mean`,\ this\ test\ truncates\ to\ the\ lower}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05036}05036\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ whole\ number.\ In\ this\ example,\ the\ paper\ notes\ that\ 1\ value\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05037}05037\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ trimmed\ off\ of\ each\ side.\ 9\%\ replicates\ this\ amount\ of\ trimming.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05038}05038\ \ \ \ \ \ \ \ \ statistic,\ pvalue\ =\ stats.ttest\_ind(a,\ b,\ trim=.09,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05039}05039\ \ \ \ \ \ \ \ \ assert\_allclose(pvalue,\ 0.514522,\ atol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05040}05040\ \ \ \ \ \ \ \ \ assert\_allclose(statistic,\ 0.669169,\ atol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05041}05041\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05042}05042\ \ \ \ \ \textcolor{keyword}{def\ }test\_equal\_var(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05043}05043\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05044}05044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ PairedData\ library\ only\ supports\ unequal\ variances.\ To\ compare}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05045}05045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ samples\ with\ equal\ variances,\ the\ multicon\ library\ is\ used.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05046}05046\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library(multicon)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05047}05047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ a\ <-\/\ c(2.7,\ 2.7,\ 1.1,\ 3.0,\ 1.9,\ 3.0,\ 3.8,\ 3.8,\ 0.3,\ 1.9,\ 1.9)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05048}05048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ b\ <-\/\ c(6.5,\ 5.4,\ 8.1,\ 3.5,\ 0.5,\ 3.8,\ 6.8,\ 4.9,\ 9.5,\ 6.2,\ 4.1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05049}05049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ dv\ =\ c(a,b)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05050}05050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ iv\ =\ c(rep('a',\ length(a)),\ rep('b',\ length(b)))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05051}05051\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ yuenContrast(dv\string~\ iv,\ EQVAR\ =\ TRUE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05052}05052\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \$Ms}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05053}05053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ N\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M\ wgt}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05054}05054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ 11\ 2.442857142857143\ \ \ 1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05055}05055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ b\ 11\ 5.385714285714286\ \ -\/1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05056}05056\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05057}05057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \$test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05058}05058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stat\ df\ \ \ \ \ \ \ \ \ \ \ \ \ \ crit\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05059}05059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ results\ -\/4.246116897032513\ 12\ 2.178812829667228\ 0.00113508833897713}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05060}05060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05061}05061\ \ \ \ \ \ \ \ \ a\ =\ [2.7,\ 2.7,\ 1.1,\ 3.0,\ 1.9,\ 3.0,\ 3.8,\ 3.8,\ 0.3,\ 1.9,\ 1.9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05062}05062\ \ \ \ \ \ \ \ \ b\ =\ [6.5,\ 5.4,\ 8.1,\ 3.5,\ 0.5,\ 3.8,\ 6.8,\ 4.9,\ 9.5,\ 6.2,\ 4.1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05063}05063\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}equal\_var=True`\ is\ default}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05064}05064\ \ \ \ \ \ \ \ \ statistic,\ pvalue\ =\ stats.ttest\_ind(a,\ b,\ trim=.2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05065}05065\ \ \ \ \ \ \ \ \ assert\_allclose(pvalue,\ 0.00113508833897713,\ atol=1e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05066}05066\ \ \ \ \ \ \ \ \ assert\_allclose(statistic,\ -\/4.246116897032513,\ atol=1e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05067}05067\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05068}05068\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'alt,pr,tr'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05069}05069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((\textcolor{stringliteral}{'greater'},\ 0.9985605452443,\ -\/4.2461168970325),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05070}05070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'less'},\ 0.001439454755672,\ -\/4.2461168970325),),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05071}05071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05072}05072\ \ \ \ \ \textcolor{keyword}{def\ }test\_alternatives(self,\ alt,\ pr,\ tr):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05073}05073\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05074}05074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library(PairedData)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05075}05075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ a\ <-\/\ c(2.7,2.7,1.1,3.0,1.9,3.0,3.8,3.8,0.3,1.9,1.9)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05076}05076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ b\ <-\/\ c(6.5,5.4,8.1,3.5,0.5,3.8,6.8,4.9,9.5,6.2,4.1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05077}05077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05078}05078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ yuen.t.test(a,\ b,\ alternative\ =\ 'greater')}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05079}05079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05080}05080\ \ \ \ \ \ \ \ \ a\ =\ [2.7,\ 2.7,\ 1.1,\ 3.0,\ 1.9,\ 3.0,\ 3.8,\ 3.8,\ 0.3,\ 1.9,\ 1.9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05081}05081\ \ \ \ \ \ \ \ \ b\ =\ [6.5,\ 5.4,\ 8.1,\ 3.5,\ 0.5,\ 3.8,\ 6.8,\ 4.9,\ 9.5,\ 6.2,\ 4.1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05082}05082\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05083}05083\ \ \ \ \ \ \ \ \ statistic,\ pvalue\ =\ stats.ttest\_ind(a,\ b,\ trim=.2,\ equal\_var=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05084}05084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alt)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05085}05085\ \ \ \ \ \ \ \ \ assert\_allclose(pvalue,\ pr,\ atol=1e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05086}05086\ \ \ \ \ \ \ \ \ assert\_allclose(statistic,\ tr,\ atol=1e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05087}05087\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05088}05088\ \ \ \ \ \textcolor{keyword}{def\ }test\_errors\_unsupported(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05089}05089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ confirm\ that\ attempting\ to\ trim\ with\ NaNs\ or\ permutations\ raises\ an}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05090}05090\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ error}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05091}05091\ \ \ \ \ \ \ \ \ match\ =\ \textcolor{stringliteral}{"{}Permutations\ are\ currently\ not\ supported\ with\ trimming."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05092}05092\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=match):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05093}05093\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ttest\_ind([1,\ 2],\ [2,\ 3],\ trim=.2,\ permutations=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05094}05094\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05095}05095\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}trim"{},\ [-\/.2,\ .5,\ 1])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05096}05096\ \ \ \ \ \textcolor{keyword}{def\ }test\_trim\_bounds\_error(self,\ trim):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05097}05097\ \ \ \ \ \ \ \ \ match\ =\ \textcolor{stringliteral}{"{}Trimming\ percentage\ should\ be\ 0\ <=\ \`{}trim`\ <\ .5."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05098}05098\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=match):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05099}05099\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ttest\_ind([1,\ 2],\ [2,\ 1],\ trim=trim)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05100}05100\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05101}05101\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05102}05102\ \textcolor{keyword}{class\ }Test\_ttest\_CI:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05103}05103\ \ \ \ \ \textcolor{comment}{\#\ indices\ in\ order\ [alternative=\{two-\/sided,\ less,\ greater\},}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05104}05104\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\{False,\ True\},\ trim=\{0,\ 0.2\}]}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05105}05105\ \ \ \ \ \textcolor{comment}{\#\ reference\ values\ in\ order\ \`{}statistic,\ df,\ pvalue,\ low,\ high`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05106}05106\ \ \ \ \ \textcolor{comment}{\#\ equal\_var=False\ reference\ values\ computed\ with\ R\ PairedData\ yuen.t.test:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05107}05107\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05108}05108\ \ \ \ \ \textcolor{comment}{\#\ library(PairedData)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05109}05109\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05110}05110\ \ \ \ \ \textcolor{comment}{\#\ a\ <\ -\/\ c(0.88236329,\ 0.97318744,\ 0.4549262,\ 0.97893335,\ 0.0606677,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05111}05111\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.44013366,\ 0.55806018,\ 0.40151434,\ 0.14453315,\ 0.25860601,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05112}05112\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.20202162)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05113}05113\ \ \ \ \ \textcolor{comment}{\#\ b\ <\ -\/\ c(0.93455277,\ 0.42680603,\ 0.49751939,\ 0.14152846,\ 0.711435,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05114}05114\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.77669667,\ 0.20507578,\ 0.78702772,\ 0.94691855,\ 0.32464958,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05115}05115\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.3873582,\ 0.35187468,\ 0.21731811)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05116}05116\ \ \ \ \ \textcolor{comment}{\#\ yuen.t.test(a,\ b,\ tr=0,\ conf.level\ =\ 0.9,\ alternative\ =\ 'l')}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05117}05117\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05118}05118\ \ \ \ \ \textcolor{comment}{\#\ equal\_var=True\ reference\ values\ computed\ with\ R\ multicon\ yuenContrast:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05119}05119\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05120}05120\ \ \ \ \ \textcolor{comment}{\#\ library(multicon)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05121}05121\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05122}05122\ \ \ \ \ \textcolor{comment}{\#\ a\ <\ -\/\ c(0.88236329,\ 0.97318744,\ 0.4549262,\ 0.97893335,\ 0.0606677,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05123}05123\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.44013366,\ 0.55806018,\ 0.40151434,\ 0.14453315,\ 0.25860601,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05124}05124\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.20202162)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05125}05125\ \ \ \ \ \textcolor{comment}{\#\ b\ <\ -\/\ c(0.93455277,\ 0.42680603,\ 0.49751939,\ 0.14152846,\ 0.711435,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05126}05126\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.77669667,\ 0.20507578,\ 0.78702772,\ 0.94691855,\ 0.32464958,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05127}05127\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ 0.3873582,\ 0.35187468,\ 0.21731811)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05128}05128\ \ \ \ \ \textcolor{comment}{\#\ dv\ =\ c(a,\ b)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05129}05129\ \ \ \ \ \textcolor{comment}{\#\ iv\ =\ c(rep('a',\ length(a)),\ rep('b',\ length(b)))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05130}05130\ \ \ \ \ \textcolor{comment}{\#\ yuenContrast(dv\string~iv,\ EQVAR\ =\ FALSE,\ alternative\ =\ 'unequal',\ tr\ =\ 0.2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05131}05131\ \ \ \ \ r\ =\ np.empty(shape=(3,\ 2,\ 2,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05132}05132\ \ \ \ \ r[0,\ 0,\ 0]\ =\ [-\/0.2314607,\ 19.894435,\ 0.8193209,\ -\/0.247220294,\ 0.188729943]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05133}05133\ \ \ \ \ r[1,\ 0,\ 0]\ =\ [-\/0.2314607,\ 19.894435,\ 0.40966045,\ -\/np.inf,\ 0.1382426469]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05134}05134\ \ \ \ \ r[2,\ 0,\ 0]\ =\ [-\/0.2314607,\ 19.894435,\ 0.5903395,\ -\/0.1967329982,\ np.inf]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05135}05135\ \ \ \ \ r[0,\ 0,\ 1]\ =\ [-\/0.2452886,\ 11.427896,\ 0.8105823,\ -\/0.34057446,\ 0.25847383]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05136}05136\ \ \ \ \ r[1,\ 0,\ 1]\ =\ [-\/0.2452886,\ 11.427896,\ 0.40529115,\ -\/np.inf,\ 0.1865829074]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05137}05137\ \ \ \ \ r[2,\ 0,\ 1]\ =\ [-\/0.2452886,\ 11.427896,\ 0.5947089,\ -\/0.268683541,\ np.inf]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05138}05138\ \ \ \ \ \textcolor{comment}{\#\ confidence\ interval\ not\ available\ for\ equal\_var=True}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05139}05139\ \ \ \ \ r[0,\ 1,\ 0]\ =\ [-\/0.2345625322555006,\ 22,\ 0.8167175905643815,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05140}05140\ \ \ \ \ r[1,\ 1,\ 0]\ =\ [-\/0.2345625322555006,\ 22,\ 0.4083587952821908,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05141}05141\ \ \ \ \ r[2,\ 1,\ 0]\ =\ [-\/0.2345625322555006,\ 22,\ 0.5916412047178092,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05142}05142\ \ \ \ \ r[0,\ 1,\ 1]\ =\ [-\/0.2505369406507428,\ 14,\ 0.8058115135702835,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05143}05143\ \ \ \ \ r[1,\ 1,\ 1]\ =\ [-\/0.2505369406507428,\ 14,\ 0.4029057567851417,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05144}05144\ \ \ \ \ r[2,\ 1,\ 1]\ =\ [-\/0.2505369406507428,\ 14,\ 0.5970942432148583,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05145}05145\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('alternative',\ ['two-\/sided',\ 'less',\ 'greater'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05146}05146\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('equal\_var',\ [False,\ True])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05147}05147\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('trim',\ [0,\ 0.2])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05148}05148\ \ \ \ \ \textcolor{keyword}{def\ }test\_confidence\_interval(self,\ alternative,\ equal\_var,\ trim):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05149}05149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ equal\_var\ \textcolor{keywordflow}{and}\ trim:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05150}05150\ \ \ \ \ \ \ \ \ \ \ \ \ pytest.xfail(\textcolor{stringliteral}{'Discrepancy\ in\ \`{}main`;\ needs\ further\ investigation.'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05151}05151\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05152}05152\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(3810954496107292580)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05153}05153\ \ \ \ \ \ \ \ \ x\ =\ rng.random(11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05154}05154\ \ \ \ \ \ \ \ \ y\ =\ rng.random(13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05155}05155\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05156}05156\ \ \ \ \ \ \ \ \ res\ =\ stats.ttest\_ind(x,\ y,\ alternative=alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05157}05157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=equal\_var,\ trim=trim)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05158}05158\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05159}05159\ \ \ \ \ \ \ \ \ alternatives\ =\ \{\textcolor{stringliteral}{'two-\/sided'}:\ 0,\ \textcolor{stringliteral}{'less'}:\ 1,\ \textcolor{stringliteral}{'greater'}:\ 2\}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05160}05160\ \ \ \ \ \ \ \ \ ref\ =\ self.r[alternatives[alternative],\ int(equal\_var),\ int(np.ceil(trim))]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05161}05161\ \ \ \ \ \ \ \ \ statistic,\ df,\ pvalue,\ low,\ high\ =\ ref}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05162}05162\ \ \ \ \ \ \ \ \ assert\_allclose(res.statistic,\ statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05163}05163\ \ \ \ \ \ \ \ \ assert\_allclose(res.df,\ df)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05164}05164\ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue,\ pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05165}05165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ equal\_var:\ \ \textcolor{comment}{\#\ CI\ not\ available\ when\ \`{}equal\_var\ is\ True`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05166}05166\ \ \ \ \ \ \ \ \ \ \ \ \ ci\ =\ res.confidence\_interval(0.9)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05167}05167\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(ci.low,\ low)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05168}05168\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(ci.high,\ high)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05169}05169\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05170}05170\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05171}05171\ \textcolor{keyword}{def\ }test\_\_broadcast\_concatenate():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05172}05172\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ \_broadcast\_concatenate\ properly\ broadcasts\ arrays\ along\ all}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05173}05173\ \ \ \ \ \textcolor{comment}{\#\ axes\ except\ \`{}axis`,\ then\ concatenates\ along\ axis}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05174}05174\ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05175}05175\ \ \ \ \ a\ =\ np.random.rand(5,\ 4,\ 4,\ 3,\ 1,\ 6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05176}05176\ \ \ \ \ b\ =\ np.random.rand(4,\ 1,\ 8,\ 2,\ 6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05177}05177\ \ \ \ \ c\ =\ \_broadcast\_concatenate((a,\ b),\ axis=-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05178}05178\ \ \ \ \ \textcolor{comment}{\#\ broadcast\ manually\ as\ an\ independent\ check}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05179}05179\ \ \ \ \ a\ =\ np.tile(a,\ (1,\ 1,\ 1,\ 1,\ 2,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05180}05180\ \ \ \ \ b\ =\ np.tile(b[\textcolor{keywordtype}{None},\ ...],\ (5,\ 1,\ 4,\ 1,\ 1,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05181}05181\ \ \ \ \ \textcolor{keywordflow}{for}\ index\ \textcolor{keywordflow}{in}\ product(*(range(i)\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ c.shape)):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05182}05182\ \ \ \ \ \ \ \ \ i,\ j,\ k,\ l,\ m,\ n\ =\ index}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05183}05183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ l\ <\ a.shape[-\/3]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05184}05184\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ a[i,\ j,\ k,\ l,\ m,\ n]\ ==\ c[i,\ j,\ k,\ l,\ m,\ n]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05185}05185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05186}05186\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ b[i,\ j,\ k,\ l\ -\/\ a.shape[-\/3],\ m,\ n]\ ==\ c[i,\ j,\ k,\ l,\ m,\ n]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05187}05187\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05188}05188\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05189}05189\ \textcolor{keyword}{def\ }test\_ttest\_ind\_with\_uneq\_var():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05190}05190\ \ \ \ \ \textcolor{comment}{\#\ check\ vs.\ R}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05191}05191\ \ \ \ \ a\ =\ (1,\ 2,\ 3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05192}05192\ \ \ \ \ b\ =\ (1.1,\ 2.9,\ 4.2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05193}05193\ \ \ \ \ pr\ =\ 0.53619490753126731}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05194}05194\ \ \ \ \ tr\ =\ -\/0.68649512735572582}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05195}05195\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(a,\ b,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05196}05196\ \ \ \ \ assert\_array\_almost\_equal([t,p],\ [tr,\ pr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05197}05197\ \ \ \ \ \textcolor{comment}{\#\ test\ from\ desc\ stats\ API}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05198}05198\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*\_desc\_stats(a,\ b),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05199}05199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05200}05200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05201}05201\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05202}05202\ \ \ \ \ a\ =\ (1,\ 2,\ 3,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05203}05203\ \ \ \ \ pr\ =\ 0.84354139131608286}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05204}05204\ \ \ \ \ tr\ =\ -\/0.2108663315950719}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05205}05205\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(a,\ b,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05206}05206\ \ \ \ \ assert\_array\_almost\_equal([t,p],\ [tr,\ pr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05207}05207\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*\_desc\_stats(a,\ b),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05208}05208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05209}05209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [t,\ p])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05210}05210\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05211}05211\ \ \ \ \ \textcolor{comment}{\#\ regression\ test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05212}05212\ \ \ \ \ tr\ =\ 1.0912746897927283}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05213}05213\ \ \ \ \ tr\_uneq\_n\ =\ 0.66745638708050492}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05214}05214\ \ \ \ \ pr\ =\ 0.27647831993021388}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05215}05215\ \ \ \ \ pr\_uneq\_n\ =\ 0.50873585065616544}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05216}05216\ \ \ \ \ tpr\ =\ ([tr,-\/tr],[pr,pr])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05217}05217\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05218}05218\ \ \ \ \ rvs3\ =\ np.linspace(1,100,\ 25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05219}05219\ \ \ \ \ rvs2\ =\ np.linspace(1,100,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05220}05220\ \ \ \ \ rvs1\ =\ np.linspace(5,105,100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05221}05221\ \ \ \ \ rvs1\_2D\ =\ np.array([rvs1,\ rvs2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05222}05222\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05223}05223\ \ \ \ \ rvs2\_2D\ =\ np.array([rvs2,\ rvs1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05224}05224\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05225}05225\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1,\ rvs2,\ axis=0,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05226}05226\ \ \ \ \ assert\_array\_almost\_equal([t,p],(tr,pr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05227}05227\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*\_desc\_stats(rvs1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05228}05228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rvs2),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05229}05229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05230}05230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (t,\ p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05231}05231\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05232}05232\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1,\ rvs3,\ axis=0,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05233}05233\ \ \ \ \ assert\_array\_almost\_equal([t,p],\ (tr\_uneq\_n,\ pr\_uneq\_n))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05234}05234\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*\_desc\_stats(rvs1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05235}05235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rvs3),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05236}05236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05237}05237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (t,\ p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05238}05238\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05239}05239\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_2D.T,\ rvs2\_2D.T,\ axis=0,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05240}05240\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05241}05241\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D.T,\ rvs2\_2D.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05242}05242\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*args,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05243}05243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05244}05244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (t,\ p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05245}05245\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05246}05246\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_2D,\ rvs2\_2D,\ axis=1,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05247}05247\ \ \ \ \ assert\_array\_almost\_equal([t,p],tpr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05248}05248\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_2D,\ rvs2\_2D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05249}05249\ \ \ \ \ assert\_array\_almost\_equal(stats.ttest\_ind\_from\_stats(*args,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05250}05250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05251}05251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (t,\ p))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05252}05252\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05253}05253\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05254}05254\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05255}05255\ \ \ \ \ res\ =\ stats.ttest\_ind(rvs1,\ rvs2,\ axis=0,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05256}05256\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05257}05257\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05258}05258\ \ \ \ \ \textcolor{comment}{\#\ test\ on\ 3\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05259}05259\ \ \ \ \ rvs1\_3D\ =\ np.dstack([rvs1\_2D,rvs1\_2D,rvs1\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05260}05260\ \ \ \ \ rvs2\_3D\ =\ np.dstack([rvs2\_2D,rvs2\_2D,rvs2\_2D])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05261}05261\ \ \ \ \ t,p\ =\ stats.ttest\_ind(rvs1\_3D,\ rvs2\_3D,\ axis=1,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05262}05262\ \ \ \ \ assert\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05263}05263\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05264}05264\ \ \ \ \ assert\_equal(t.shape,\ (2,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05265}05265\ \ \ \ \ args\ =\ \_desc\_stats(rvs1\_3D,\ rvs2\_3D,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05266}05266\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind\_from\_stats(*args,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05267}05267\ \ \ \ \ assert\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05268}05268\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05269}05269\ \ \ \ \ assert\_equal(t.shape,\ (2,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05270}05270\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05271}05271\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind(np.moveaxis(rvs1\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05272}05272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.moveaxis(rvs2\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05273}05273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=2,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05274}05274\ \ \ \ \ assert\_array\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05275}05275\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05276}05276\ \ \ \ \ assert\_equal(t.shape,\ (3,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05277}05277\ \ \ \ \ args\ =\ \_desc\_stats(np.moveaxis(rvs1\_3D,\ 2,\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05278}05278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.moveaxis(rvs2\_3D,\ 2,\ 0),\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05279}05279\ \ \ \ \ t,\ p\ =\ stats.ttest\_ind\_from\_stats(*args,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05280}05280\ \ \ \ \ assert\_array\_almost\_equal(np.abs(t),\ np.abs(tr))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05281}05281\ \ \ \ \ assert\_array\_almost\_equal(np.abs(p),\ pr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05282}05282\ \ \ \ \ assert\_equal(t.shape,\ (3,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05283}05283\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05284}05284\ \ \ \ \ \textcolor{comment}{\#\ test\ zero\ division\ problem}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05285}05285\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{"{}Precision\ loss\ occurred"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05286}05286\ \ \ \ \ \ \ \ \ t,\ p\ =\ stats.ttest\_ind([0,\ 0,\ 0],\ [1,\ 1,\ 1],\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05287}05287\ \ \ \ \ assert\_equal((np.abs(t),\ p),\ (np.inf,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05288}05288\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05289}05289\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_ind([0,\ 0,\ 0],\ [0,\ 0,\ 0],\ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05290}05290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05291}05291\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05292}05292\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ nan\ in\ input\ array\ result\ in\ nan\ output}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05293}05293\ \ \ \ \ \ \ \ \ anan\ =\ np.array([[1,\ np.nan],\ [-\/1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05294}05294\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_ind(anan,\ np.zeros((2,\ 2)),\ equal\_var=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05295}05295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ([0,\ np.nan],\ [1,\ np.nan]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05296}05296\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05297}05297\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05298}05298\ \textcolor{keyword}{def\ }test\_ttest\_ind\_nan\_2nd\_arg():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05299}05299\ \ \ \ \ \textcolor{comment}{\#\ regression\ test\ for\ gh-\/6134:\ nans\ in\ the\ second\ arg\ were\ not\ handled}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05300}05300\ \ \ \ \ x\ =\ [np.nan,\ 2.0,\ 3.0,\ 4.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05301}05301\ \ \ \ \ y\ =\ [1.0,\ 2.0,\ 1.0,\ 2.0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05302}05302\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05303}05303\ \ \ \ \ r1\ =\ stats.ttest\_ind(x,\ y,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05304}05304\ \ \ \ \ r2\ =\ stats.ttest\_ind(y,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05305}05305\ \ \ \ \ assert\_allclose(r2.statistic,\ -\/r1.statistic,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05306}05306\ \ \ \ \ assert\_allclose(r2.pvalue,\ r1.pvalue,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05307}05307\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05308}05308\ \ \ \ \ \textcolor{comment}{\#\ NB:\ arguments\ are\ not\ paired\ when\ NaNs\ are\ dropped}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05309}05309\ \ \ \ \ r3\ =\ stats.ttest\_ind(y,\ x[1:])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05310}05310\ \ \ \ \ assert\_allclose(r2,\ r3,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05311}05311\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05312}05312\ \ \ \ \ \textcolor{comment}{\#\ ..\ and\ this\ is\ consistent\ with\ R.\ R\ code:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05313}05313\ \ \ \ \ \textcolor{comment}{\#\ x\ =\ c(NA,\ 2.0,\ 3.0,\ 4.0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05314}05314\ \ \ \ \ \textcolor{comment}{\#\ y\ =\ c(1.0,\ 2.0,\ 1.0,\ 2.0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05315}05315\ \ \ \ \ \textcolor{comment}{\#\ t.test(x,\ y,\ var.equal=TRUE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05316}05316\ \ \ \ \ assert\_allclose(r2,\ (-\/2.5354627641855498,\ 0.052181400457057901),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05317}05317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05318}05318\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05319}05319\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05320}05320\ \textcolor{keyword}{def\ }test\_ttest\_ind\_empty\_1d\_returns\_nan():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05321}05321\ \ \ \ \ \textcolor{comment}{\#\ Two\ empty\ inputs\ should\ return\ a\ TtestResult\ containing\ nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05322}05322\ \ \ \ \ \textcolor{comment}{\#\ for\ both\ values.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05323}05323\ \ \ \ \ result\ =\ stats.ttest\_ind([],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05324}05324\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05325}05325\ \ \ \ \ assert\_equal(result,\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05326}05326\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05327}05327\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05328}05328\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'b,\ expected\_shape'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05329}05329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(np.empty((1,\ 5,\ 0)),\ (3,\ 5)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05330}05330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.empty((1,\ 0,\ 0)),\ (3,\ 0))])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05331}05331\ \textcolor{keyword}{def\ }test\_ttest\_ind\_axis\_size\_zero(b,\ expected\_shape):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05332}05332\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ test,\ the\ length\ of\ the\ axis\ dimension\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05333}05333\ \ \ \ \ \textcolor{comment}{\#\ The\ results\ should\ be\ arrays\ containing\ nan\ with\ shape}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05334}05334\ \ \ \ \ \textcolor{comment}{\#\ given\ by\ the\ broadcast\ nonaxis\ dimensions.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05335}05335\ \ \ \ \ a\ =\ np.empty((3,\ 1,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05336}05336\ \ \ \ \ result\ =\ stats.ttest\_ind(a,\ b,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05337}05337\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05338}05338\ \ \ \ \ expected\_value\ =\ np.full(expected\_shape,\ fill\_value=np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05339}05339\ \ \ \ \ assert\_equal(result.statistic,\ expected\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05340}05340\ \ \ \ \ assert\_equal(result.pvalue,\ expected\_value)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05341}05341\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05342}05342\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05343}05343\ \textcolor{keyword}{def\ }test\_ttest\_ind\_nonaxis\_size\_zero():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05344}05344\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ test,\ the\ length\ of\ the\ axis\ dimension\ is\ nonzero,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05345}05345\ \ \ \ \ \textcolor{comment}{\#\ but\ one\ of\ the\ nonaxis\ dimensions\ has\ length\ 0.\ \ Check\ that}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05346}05346\ \ \ \ \ \textcolor{comment}{\#\ we\ still\ get\ the\ correctly\ broadcast\ shape,\ which\ is\ (5,\ 0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05347}05347\ \ \ \ \ \textcolor{comment}{\#\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05348}05348\ \ \ \ \ a\ =\ np.empty((1,\ 8,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05349}05349\ \ \ \ \ b\ =\ np.empty((5,\ 8,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05350}05350\ \ \ \ \ result\ =\ stats.ttest\_ind(a,\ b,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05351}05351\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05352}05352\ \ \ \ \ assert\_equal(result.statistic.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05353}05353\ \ \ \ \ assert\_equal(result.pvalue.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05354}05354\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05355}05355\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05356}05356\ \textcolor{keyword}{def\ }test\_ttest\_ind\_nonaxis\_size\_zero\_different\_lengths():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05357}05357\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ test,\ the\ length\ of\ the\ axis\ dimension\ is\ nonzero,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05358}05358\ \ \ \ \ \textcolor{comment}{\#\ and\ that\ size\ is\ different\ in\ the\ two\ inputs,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05359}05359\ \ \ \ \ \textcolor{comment}{\#\ and\ one\ of\ the\ nonaxis\ dimensions\ has\ length\ 0.\ \ Check\ that}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05360}05360\ \ \ \ \ \textcolor{comment}{\#\ we\ still\ get\ the\ correctly\ broadcast\ shape,\ which\ is\ (5,\ 0)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05361}05361\ \ \ \ \ \textcolor{comment}{\#\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05362}05362\ \ \ \ \ a\ =\ np.empty((1,\ 7,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05363}05363\ \ \ \ \ b\ =\ np.empty((5,\ 8,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05364}05364\ \ \ \ \ result\ =\ stats.ttest\_ind(a,\ b,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05365}05365\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(result,\ \mbox{\hyperlink{classscipy_1_1stats_1_1__stats__py_1_1TtestResult}{stats.\_stats\_py.TtestResult}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05366}05366\ \ \ \ \ assert\_equal(result.statistic.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05367}05367\ \ \ \ \ assert\_equal(result.pvalue.shape,\ (5,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05368}05368\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05369}05369\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05370}05370\ \textcolor{keyword}{def\ }test\_gh5686():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05371}05371\ \ \ \ \ mean1,\ mean2\ =\ np.array([1,\ 2]),\ np.array([3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05372}05372\ \ \ \ \ std1,\ std2\ =\ np.array([5,\ 3]),\ np.array([4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05373}05373\ \ \ \ \ nobs1,\ nobs2\ =\ np.array([130,\ 140]),\ np.array([100,\ 150])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05374}05374\ \ \ \ \ \textcolor{comment}{\#\ This\ will\ raise\ a\ TypeError\ unless\ gh-\/5686\ is\ fixed.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05375}05375\ \ \ \ \ stats.ttest\_ind\_from\_stats(mean1,\ std1,\ nobs1,\ mean2,\ std2,\ nobs2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05376}05376\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05377}05377\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05378}05378\ \textcolor{keyword}{def\ }test\_ttest\_ind\_from\_stats\_inputs\_zero():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05379}05379\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/6409.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05380}05380\ \ \ \ \ result\ =\ stats.ttest\_ind\_from\_stats(0,\ 0,\ 6,\ 0,\ 0,\ 6,\ equal\_var=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05381}05381\ \ \ \ \ assert\_equal(result,\ [np.nan,\ np.nan])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05382}05382\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05383}05383\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05384}05384\ \textcolor{keyword}{def\ }test\_ttest\_single\_observation():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05385}05385\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ p-\/values\ are\ uniformly\ distributed\ under\ the\ null\ hypothesis}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05386}05386\ \ \ \ \ rng\ =\ np.random.default\_rng(246834602926842)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05387}05387\ \ \ \ \ x\ =\ rng.normal(size=(10000,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05388}05388\ \ \ \ \ y\ =\ rng.normal(size=(10000,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05389}05389\ \ \ \ \ q\ =\ rng.uniform(size=100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05390}05390\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05391}05391\ \ \ \ \ res\ =\ stats.ttest\_ind(x,\ y,\ equal\_var=\textcolor{keyword}{True},\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05392}05392\ \ \ \ \ \textcolor{keyword}{assert}\ stats.ks\_1samp(res.pvalue,\ stats.uniform().cdf).pvalue\ >\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05393}05393\ \ \ \ \ assert\_allclose(np.percentile(res.pvalue,\ q*100),\ q,\ atol=1e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05394}05394\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05395}05395\ \ \ \ \ res\ =\ stats.ttest\_ind(y,\ x,\ equal\_var=\textcolor{keyword}{True},\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05396}05396\ \ \ \ \ \textcolor{keyword}{assert}\ stats.ks\_1samp(res.pvalue,\ stats.uniform().cdf).pvalue\ >\ 0.1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05397}05397\ \ \ \ \ assert\_allclose(np.percentile(res.pvalue,\ q*100),\ q,\ atol=1e-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05398}05398\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05399}05399\ \ \ \ \ \textcolor{comment}{\#\ reference\ values\ from\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05400}05400\ \ \ \ \ \textcolor{comment}{\#\ options(digits=16)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05401}05401\ \ \ \ \ \textcolor{comment}{\#\ t.test(c(2,\ 3,\ 5),\ c(1.5),\ var.equal=TRUE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05402}05402\ \ \ \ \ res\ =\ stats.ttest\_ind([2,\ 3,\ 5],\ [1.5],\ equal\_var=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05403}05403\ \ \ \ \ assert\_allclose(res,\ (1.0394023007754,\ 0.407779907736),\ rtol=1e-\/10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05404}05404\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05405}05405\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05406}05406\ \textcolor{keyword}{def\ }test\_ttest\_1samp\_new():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05407}05407\ \ \ \ \ n1,\ n2,\ n3\ =\ (10,15,20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05408}05408\ \ \ \ \ rvn1\ =\ stats.norm.rvs(loc=5,scale=10,size=(n1,n2,n3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05409}05409\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05410}05410\ \ \ \ \ \textcolor{comment}{\#\ check\ multidimensional\ array\ and\ correct\ axis\ handling}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05411}05411\ \ \ \ \ \textcolor{comment}{\#\ deterministic\ rvn1\ and\ rvn2\ would\ be\ better\ as\ in\ test\_ttest\_rel}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05412}05412\ \ \ \ \ t1,p1\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ np.ones((n2,n3)),axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05413}05413\ \ \ \ \ t2,p2\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ 1,axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05414}05414\ \ \ \ \ t3,p3\ =\ stats.ttest\_1samp(rvn1[:,0,0],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05415}05415\ \ \ \ \ assert\_array\_almost\_equal(t1,t2,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05416}05416\ \ \ \ \ assert\_almost\_equal(t1[0,0],t3,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05417}05417\ \ \ \ \ assert\_equal(t1.shape,\ (n2,n3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05418}05418\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05419}05419\ \ \ \ \ t1,p1\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ np.ones((n1,\ 1,\ n3)),axis=1)\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05420}05420\ \ \ \ \ t2,p2\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ 1,axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05421}05421\ \ \ \ \ t3,p3\ =\ stats.ttest\_1samp(rvn1[0,:,0],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05422}05422\ \ \ \ \ assert\_array\_almost\_equal(t1,t2,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05423}05423\ \ \ \ \ assert\_almost\_equal(t1[0,0],t3,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05424}05424\ \ \ \ \ assert\_equal(t1.shape,\ (n1,n3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05425}05425\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05426}05426\ \ \ \ \ t1,p1\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ np.ones((n1,n2,1)),axis=2)\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05427}05427\ \ \ \ \ t2,p2\ =\ stats.ttest\_1samp(rvn1[:,:,:],\ 1,axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05428}05428\ \ \ \ \ t3,p3\ =\ stats.ttest\_1samp(rvn1[0,0,:],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05429}05429\ \ \ \ \ assert\_array\_almost\_equal(t1,t2,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05430}05430\ \ \ \ \ assert\_almost\_equal(t1[0,0],t3,\ decimal=14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05431}05431\ \ \ \ \ assert\_equal(t1.shape,\ (n1,n2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05432}05432\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05433}05433\ \ \ \ \ \textcolor{comment}{\#\ test\ zero\ division\ problem}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05434}05434\ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp([0,\ 0,\ 0],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05435}05435\ \ \ \ \ assert\_equal((np.abs(t),\ p),\ (np.inf,\ 0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05436}05436\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05437}05437\ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05438}05438\ \ \ \ \ \textcolor{comment}{\#\ Convert\ from\ two-\/sided\ p-\/values\ to\ one\ sided\ using\ T\ result\ data.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05439}05439\ \ \ \ \ \textcolor{keyword}{def\ }convert(t,\ p,\ alt):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05440}05440\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (t\ <\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}less"{}})\ \textcolor{keywordflow}{or}\ (t\ >\ 0\ \textcolor{keywordflow}{and}\ alt\ ==\ \textcolor{stringliteral}{"{}greater"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05441}05441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ p\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05442}05442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1\ -\/\ (p\ /\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05443}05443\ \ \ \ \ converter\ =\ np.vectorize(convert)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05444}05444\ \ \ \ \ tr,\ pr\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05445}05445\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05446}05446\ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1,\ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05447}05447\ \ \ \ \ pc\ =\ converter(tr,\ pr,\ \textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05448}05448\ \ \ \ \ assert\_allclose(p,\ pc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05449}05449\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05450}05450\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05451}05451\ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05452}05452\ \ \ \ \ pc\ =\ converter(tr,\ pr,\ \textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05453}05453\ \ \ \ \ assert\_allclose(p,\ pc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05454}05454\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05455}05455\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05456}05456\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05457}05457\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_1samp([0,\ 0,\ 0],\ 0),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05458}05458\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05459}05459\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ nan\ in\ input\ array\ result\ in\ nan\ output}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05460}05460\ \ \ \ \ \ \ \ \ anan\ =\ np.array([[1,\ np.nan],[-\/1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05461}05461\ \ \ \ \ \ \ \ \ assert\_equal(stats.ttest\_1samp(anan,\ 0),\ ([0,\ np.nan],\ [1,\ np.nan]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05462}05462\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05463}05463\ \ \ \ \ rvn1[0:2,\ 1:3,\ 4:8]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05464}05464\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05465}05465\ \ \ \ \ tr,\ pr\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05466}05466\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05467}05467\ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05468}05468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05469}05469\ \ \ \ \ pc\ =\ converter(tr,\ pr,\ \textcolor{stringliteral}{"{}greater"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05470}05470\ \ \ \ \ assert\_allclose(p,\ pc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05471}05471\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05472}05472\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05473}05473\ \ \ \ \ t,\ p\ =\ stats.ttest\_1samp(rvn1[:,\ :,\ :],\ 1,\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05474}05474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05475}05475\ \ \ \ \ pc\ =\ converter(tr,\ pr,\ \textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05476}05476\ \ \ \ \ assert\_allclose(p,\ pc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05477}05477\ \ \ \ \ assert\_allclose(t,\ tr)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05478}05478\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05479}05479\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05480}05480\ \textcolor{keyword}{def\ }test\_ttest\_1samp\_popmean\_array():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05481}05481\ \ \ \ \ \textcolor{comment}{\#\ when\ popmean.shape[axis]\ !=\ 1,\ raise\ an\ error}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05482}05482\ \ \ \ \ \textcolor{comment}{\#\ if\ the\ user\ wants\ to\ test\ multiple\ null\ hypotheses\ simultaneously,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05483}05483\ \ \ \ \ \textcolor{comment}{\#\ use\ standard\ broadcasting\ rules}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05484}05484\ \ \ \ \ rng\ =\ np.random.default\_rng(2913300596553337193)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05485}05485\ \ \ \ \ x\ =\ rng.random(size=(1,\ 15,\ 20))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05486}05486\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05487}05487\ \ \ \ \ message\ =\ \textcolor{stringliteral}{r"{}\`{}popmean.shape\(\backslash\)[axis\(\backslash\)]\`{}\ must\ equal\ 1."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05488}05488\ \ \ \ \ popmean\ =\ rng.random(size=(5,\ 2,\ 20))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05489}05489\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05490}05490\ \ \ \ \ \ \ \ \ stats.ttest\_1samp(x,\ popmean=popmean,\ axis=-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05491}05491\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05492}05492\ \ \ \ \ popmean\ =\ rng.random(size=(5,\ 1,\ 20))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05493}05493\ \ \ \ \ res\ =\ stats.ttest\_1samp(x,\ popmean=popmean,\ axis=-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05494}05494\ \ \ \ \ \textcolor{keyword}{assert}\ res.statistic.shape\ ==\ (5,\ 20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05495}05495\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05496}05496\ \ \ \ \ ci\ =\ np.expand\_dims(res.confidence\_interval(),\ axis=-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05497}05497\ \ \ \ \ res\ =\ stats.ttest\_1samp(x,\ popmean=ci,\ axis=-\/2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05498}05498\ \ \ \ \ assert\_allclose(res.pvalue,\ 0.05)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05499}05499\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05500}05500\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05501}05501\ \textcolor{keyword}{class\ }TestDescribe:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05502}05502\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_scalar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05503}05503\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup,\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05504}05504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}},\ divide=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05505}05505\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning,\ \textcolor{stringliteral}{"{}Degrees\ of\ freedom\ <=\ 0\ for\ slice"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05506}05506\ \ \ \ \ \ \ \ \ \ \ \ \ n,\ mm,\ m,\ v,\ sk,\ kurt\ =\ stats.describe(4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05507}05507\ \ \ \ \ \ \ \ \ assert\_equal(n,\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05508}05508\ \ \ \ \ \ \ \ \ assert\_equal(mm,\ (4.0,\ 4.0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05509}05509\ \ \ \ \ \ \ \ \ assert\_equal(m,\ 4.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05510}05510\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(v)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05511}05511\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(sk)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05512}05512\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(kurt)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05513}05513\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05514}05514\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_numbers(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05515}05515\ \ \ \ \ \ \ \ \ x\ =\ np.vstack((np.ones((3,4)),\ np.full((2,\ 4),\ 2)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05516}05516\ \ \ \ \ \ \ \ \ nc,\ mmc\ =\ (5,\ ([1.,\ 1.,\ 1.,\ 1.],\ [2.,\ 2.,\ 2.,\ 2.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05517}05517\ \ \ \ \ \ \ \ \ mc\ =\ np.array([1.4,\ 1.4,\ 1.4,\ 1.4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05518}05518\ \ \ \ \ \ \ \ \ vc\ =\ np.array([0.3,\ 0.3,\ 0.3,\ 0.3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05519}05519\ \ \ \ \ \ \ \ \ skc\ =\ [0.40824829046386357]\ *\ 4}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05520}05520\ \ \ \ \ \ \ \ \ kurtc\ =\ [-\/1.833333333333333]\ *\ 4}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05521}05521\ \ \ \ \ \ \ \ \ n,\ mm,\ m,\ v,\ sk,\ kurt\ =\ stats.describe(x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05522}05522\ \ \ \ \ \ \ \ \ assert\_equal(n,\ nc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05523}05523\ \ \ \ \ \ \ \ \ assert\_equal(mm,\ mmc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05524}05524\ \ \ \ \ \ \ \ \ assert\_equal(m,\ mc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05525}05525\ \ \ \ \ \ \ \ \ assert\_equal(v,\ vc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05526}05526\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(sk,\ skc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05527}05527\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(kurt,\ kurtc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05528}05528\ \ \ \ \ \ \ \ \ n,\ mm,\ m,\ v,\ sk,\ kurt\ =\ stats.describe(x.T,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05529}05529\ \ \ \ \ \ \ \ \ assert\_equal(n,\ nc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05530}05530\ \ \ \ \ \ \ \ \ assert\_equal(mm,\ mmc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05531}05531\ \ \ \ \ \ \ \ \ assert\_equal(m,\ mc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05532}05532\ \ \ \ \ \ \ \ \ assert\_equal(v,\ vc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05533}05533\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(sk,\ skc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05534}05534\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(kurt,\ kurtc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05535}05535\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05536}05536\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05537}05537\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05538}05538\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05539}05539\ \ \ \ \ \ \ \ \ nc,\ mmc\ =\ (9,\ (0.0,\ 8.0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05540}05540\ \ \ \ \ \ \ \ \ mc\ =\ 4.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05541}05541\ \ \ \ \ \ \ \ \ vc\ =\ 7.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05542}05542\ \ \ \ \ \ \ \ \ skc\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05543}05543\ \ \ \ \ \ \ \ \ kurtc\ =\ -\/1.2300000000000002}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05544}05544\ \ \ \ \ \ \ \ \ n,\ mm,\ m,\ v,\ sk,\ kurt\ =\ stats.describe(x,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05545}05545\ \ \ \ \ \ \ \ \ assert\_equal(n,\ nc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05546}05546\ \ \ \ \ \ \ \ \ assert\_equal(mm,\ mmc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05547}05547\ \ \ \ \ \ \ \ \ assert\_equal(m,\ mc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05548}05548\ \ \ \ \ \ \ \ \ assert\_equal(v,\ vc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05549}05549\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(sk,\ skc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05550}05550\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(kurt,\ kurtc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05551}05551\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05552}05552\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.describe,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05553}05553\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.describe,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05554}05554\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05555}05555\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05556}05556\ \ \ \ \ \ \ \ \ actual\ =\ stats.describe(np.arange(5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05557}05557\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'nobs'},\ \textcolor{stringliteral}{'minmax'},\ \textcolor{stringliteral}{'mean'},\ \textcolor{stringliteral}{'variance'},\ \textcolor{stringliteral}{'skewness'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05558}05558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'kurtosis'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05559}05559\ \ \ \ \ \ \ \ \ check\_named\_results(actual,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05560}05560\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05561}05561\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_ddof(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05562}05562\ \ \ \ \ \ \ \ \ x\ =\ np.vstack((np.ones((3,\ 4)),\ np.full((2,\ 4),\ 2)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05563}05563\ \ \ \ \ \ \ \ \ nc,\ mmc\ =\ (5,\ ([1.,\ 1.,\ 1.,\ 1.],\ [2.,\ 2.,\ 2.,\ 2.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05564}05564\ \ \ \ \ \ \ \ \ mc\ =\ np.array([1.4,\ 1.4,\ 1.4,\ 1.4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05565}05565\ \ \ \ \ \ \ \ \ vc\ =\ np.array([0.24,\ 0.24,\ 0.24,\ 0.24])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05566}05566\ \ \ \ \ \ \ \ \ skc\ =\ [0.40824829046386357]\ *\ 4}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05567}05567\ \ \ \ \ \ \ \ \ kurtc\ =\ [-\/1.833333333333333]\ *\ 4}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05568}05568\ \ \ \ \ \ \ \ \ n,\ mm,\ m,\ v,\ sk,\ kurt\ =\ stats.describe(x,\ ddof=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05569}05569\ \ \ \ \ \ \ \ \ assert\_equal(n,\ nc)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05570}05570\ \ \ \ \ \ \ \ \ assert\_allclose(mm,\ mmc,\ rtol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05571}05571\ \ \ \ \ \ \ \ \ assert\_allclose(m,\ mc,\ rtol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05572}05572\ \ \ \ \ \ \ \ \ assert\_allclose(v,\ vc,\ rtol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05573}05573\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(sk,\ skc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05574}05574\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(kurt,\ kurtc,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05575}05575\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05576}05576\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_axis\_none(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05577}05577\ \ \ \ \ \ \ \ \ x\ =\ np.vstack((np.ones((3,\ 4)),\ np.full((2,\ 4),\ 2)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05578}05578\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05579}05579\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expected\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05580}05580\ \ \ \ \ \ \ \ \ e\_nobs,\ e\_minmax\ =\ (20,\ (1.0,\ 2.0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05581}05581\ \ \ \ \ \ \ \ \ e\_mean\ =\ 1.3999999999999999}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05582}05582\ \ \ \ \ \ \ \ \ e\_var\ =\ 0.25263157894736848}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05583}05583\ \ \ \ \ \ \ \ \ e\_skew\ =\ 0.4082482904638634}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05584}05584\ \ \ \ \ \ \ \ \ e\_kurt\ =\ -\/1.8333333333333333}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05585}05585\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05586}05586\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ actual\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05587}05587\ \ \ \ \ \ \ \ \ a\ =\ stats.describe(x,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05588}05588\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05589}05589\ \ \ \ \ \ \ \ \ assert\_equal(a.nobs,\ e\_nobs)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05590}05590\ \ \ \ \ \ \ \ \ assert\_almost\_equal(a.minmax,\ e\_minmax)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05591}05591\ \ \ \ \ \ \ \ \ assert\_almost\_equal(a.mean,\ e\_mean)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05592}05592\ \ \ \ \ \ \ \ \ assert\_almost\_equal(a.variance,\ e\_var)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05593}05593\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(a.skewness,\ e\_skew,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05594}05594\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(a.kurtosis,\ e\_kurt,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05595}05595\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05596}05596\ \ \ \ \ \textcolor{keyword}{def\ }test\_describe\_empty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05597}05597\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.describe,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05598}05598\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05599}05599\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05600}05600\ \textcolor{keyword}{def\ }test\_normalitytests():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05601}05601\ \ \ \ \ assert\_raises(ValueError,\ stats.skewtest,\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05602}05602\ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosistest,\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05603}05603\ \ \ \ \ assert\_raises(ValueError,\ stats.normaltest,\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05604}05604\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05605}05605\ \ \ \ \ \textcolor{comment}{\#\ numbers\ verified\ with\ R:\ dagoTest\ in\ package\ fBasics}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05606}05606\ \ \ \ \ st\_normal,\ st\_skew,\ st\_kurt\ =\ (3.92371918,\ 1.98078826,\ -\/0.01403734)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05607}05607\ \ \ \ \ pv\_normal,\ pv\_skew,\ pv\_kurt\ =\ (0.14059673,\ 0.04761502,\ 0.98880019)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05608}05608\ \ \ \ \ pv\_skew\_less,\ pv\_kurt\_less\ =\ 1\ -\/\ pv\_skew\ /\ 2,\ pv\_kurt\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05609}05609\ \ \ \ \ pv\_skew\_greater,\ pv\_kurt\_greater\ =\ pv\_skew\ /\ 2,\ 1\ -\/\ pv\_kurt\ /\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05610}05610\ \ \ \ \ x\ =\ np.array((-\/2,\ -\/1,\ 0,\ 1,\ 2,\ 3)*4)**2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05611}05611\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05612}05612\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05613}05613\ \ \ \ \ assert\_array\_almost\_equal(stats.normaltest(x),\ (st\_normal,\ pv\_normal))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05614}05614\ \ \ \ \ check\_named\_results(stats.normaltest(x),\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05615}05615\ \ \ \ \ assert\_array\_almost\_equal(stats.skewtest(x),\ (st\_skew,\ pv\_skew))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05616}05616\ \ \ \ \ assert\_array\_almost\_equal(stats.skewtest(x,\ alternative=\textcolor{stringliteral}{'less'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05617}05617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_skew,\ pv\_skew\_less))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05618}05618\ \ \ \ \ assert\_array\_almost\_equal(stats.skewtest(x,\ alternative=\textcolor{stringliteral}{'greater'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05619}05619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_skew,\ pv\_skew\_greater))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05620}05620\ \ \ \ \ check\_named\_results(stats.skewtest(x),\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05621}05621\ \ \ \ \ assert\_array\_almost\_equal(stats.kurtosistest(x),\ (st\_kurt,\ pv\_kurt))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05622}05622\ \ \ \ \ assert\_array\_almost\_equal(stats.kurtosistest(x,\ alternative=\textcolor{stringliteral}{'less'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05623}05623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_kurt,\ pv\_kurt\_less))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05624}05624\ \ \ \ \ assert\_array\_almost\_equal(stats.kurtosistest(x,\ alternative=\textcolor{stringliteral}{'greater'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05625}05625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_kurt,\ pv\_kurt\_greater))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05626}05626\ \ \ \ \ check\_named\_results(stats.kurtosistest(x),\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05627}05627\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05628}05628\ \ \ \ \ \textcolor{comment}{\#\ some\ more\ intuitive\ tests\ for\ kurtosistest\ and\ skewtest.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05629}05629\ \ \ \ \ \textcolor{comment}{\#\ see\ gh-\/13549.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05630}05630\ \ \ \ \ \textcolor{comment}{\#\ skew\ parameter\ is\ 1\ >\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05631}05631\ \ \ \ \ a1\ =\ stats.skewnorm.rvs(a=1,\ size=10000,\ random\_state=123)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05632}05632\ \ \ \ \ pval\ =\ stats.skewtest(a1,\ alternative=\textcolor{stringliteral}{'greater'}).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05633}05633\ \ \ \ \ assert\_almost\_equal(pval,\ 0.0,\ decimal=5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05634}05634\ \ \ \ \ \textcolor{comment}{\#\ excess\ kurtosis\ of\ laplace\ is\ 3\ >\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05635}05635\ \ \ \ \ a2\ =\ stats.laplace.rvs(size=10000,\ random\_state=123)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05636}05636\ \ \ \ \ pval\ =\ stats.kurtosistest(a2,\ alternative=\textcolor{stringliteral}{'greater'}).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05637}05637\ \ \ \ \ assert\_almost\_equal(pval,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05638}05638\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05639}05639\ \ \ \ \ \textcolor{comment}{\#\ Test\ axis=None\ (equal\ to\ axis=0\ for\ 1-\/D\ input)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05640}05640\ \ \ \ \ assert\_array\_almost\_equal(stats.normaltest(x,\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05641}05641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_normal,\ pv\_normal))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05642}05642\ \ \ \ \ assert\_array\_almost\_equal(stats.skewtest(x,\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05643}05643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_skew,\ pv\_skew))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05644}05644\ \ \ \ \ assert\_array\_almost\_equal(stats.kurtosistest(x,\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05645}05645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (st\_kurt,\ pv\_kurt))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05646}05646\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05647}05647\ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05648}05648\ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05649}05649\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{"{}ignore"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05650}05650\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.skewtest(x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05651}05651\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05652}05652\ \ \ \ \ expected\ =\ (1.0184643553962129,\ 0.30845733195153502)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05653}05653\ \ \ \ \ assert\_array\_almost\_equal(stats.skewtest(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05654}05654\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05655}05655\ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ with\ nan\_policy='omit'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05656}05656\ \ \ \ \ a1[10:100]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05657}05657\ \ \ \ \ z,\ p\ =\ stats.skewtest(a1,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05658}05658\ \ \ \ \ zl,\ pl\ =\ stats.skewtest(a1,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05659}05659\ \ \ \ \ zg,\ pg\ =\ stats.skewtest(a1,\ nan\_policy=\textcolor{stringliteral}{'omit'},\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05660}05660\ \ \ \ \ assert\_allclose(zl,\ z,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05661}05661\ \ \ \ \ assert\_allclose(zg,\ z,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05662}05662\ \ \ \ \ assert\_allclose(pl,\ 1\ -\/\ p/2,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05663}05663\ \ \ \ \ assert\_allclose(pg,\ p/2,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05664}05664\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05665}05665\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05666}05666\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.skewtest,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05667}05667\ \ \ \ \ assert\_raises(ValueError,\ stats.skewtest,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05668}05668\ \ \ \ \ assert\_raises(ValueError,\ stats.skewtest,\ list(range(8)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05669}05669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05670}05670\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05671}05671\ \ \ \ \ x\ =\ np.arange(30.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05672}05672\ \ \ \ \ x[29]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05673}05673\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05674}05674\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.kurtosistest(x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05675}05675\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05676}05676\ \ \ \ \ expected\ =\ (-\/2.2683547379505273,\ 0.023307594135872967)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05677}05677\ \ \ \ \ assert\_array\_almost\_equal(stats.kurtosistest(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05678}05678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05679}05679\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05680}05680\ \ \ \ \ \textcolor{comment}{\#\ test\ alternative\ with\ nan\_policy='omit'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05681}05681\ \ \ \ \ a2[10:20]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05682}05682\ \ \ \ \ z,\ p\ =\ stats.kurtosistest(a2[:100],\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05683}05683\ \ \ \ \ zl,\ pl\ =\ stats.kurtosistest(a2[:100],\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05684}05684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05685}05685\ \ \ \ \ zg,\ pg\ =\ stats.kurtosistest(a2[:100],\ nan\_policy=\textcolor{stringliteral}{'omit'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05686}05686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05687}05687\ \ \ \ \ assert\_allclose(zl,\ z,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05688}05688\ \ \ \ \ assert\_allclose(zg,\ z,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05689}05689\ \ \ \ \ assert\_allclose(pl,\ 1\ -\/\ p/2,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05690}05690\ \ \ \ \ assert\_allclose(pg,\ p/2,\ atol=1e-\/15)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05691}05691\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05692}05692\ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosistest,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05693}05693\ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosistest,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05694}05694\ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosistest,\ list(range(20)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05695}05695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05696}05696\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05697}05697\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05698}05698\ \ \ \ \ \ \ \ \ assert\_array\_equal(stats.normaltest(x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05699}05699\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05700}05700\ \ \ \ \ expected\ =\ (6.2260409514287449,\ 0.04446644248650191)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05701}05701\ \ \ \ \ assert\_array\_almost\_equal(stats.normaltest(x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05702}05702\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05703}05703\ \ \ \ \ assert\_raises(ValueError,\ stats.normaltest,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05704}05704\ \ \ \ \ assert\_raises(ValueError,\ stats.normaltest,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05705}05705\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05706}05706\ \ \ \ \ \textcolor{comment}{\#\ regression\ test\ for\ issue\ gh-\/9033:\ x\ cleary\ non-\/normal\ but\ power\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05707}05707\ \ \ \ \ \textcolor{comment}{\#\ negtative\ denom\ needs\ to\ be\ handled\ correctly\ to\ reject\ normality}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05708}05708\ \ \ \ \ counts\ =\ [128,\ 0,\ 58,\ 7,\ 0,\ 41,\ 16,\ 0,\ 0,\ 167]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05709}05709\ \ \ \ \ x\ =\ np.hstack([np.full(c,\ i)\ \textcolor{keywordflow}{for}\ i,\ c\ \textcolor{keywordflow}{in}\ enumerate(counts)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05710}05710\ \ \ \ \ assert\_equal(stats.kurtosistest(x)[1]\ <\ 0.01,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05711}05711\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05712}05712\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05713}05713\ \textcolor{keyword}{class\ }TestRankSums:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05714}05714\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05715}05715\ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05716}05716\ \ \ \ \ x,\ y\ =\ np.random.rand(2,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05717}05717\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05718}05718\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('alternative',\ ['less',\ 'greater',\ 'two-\/sided'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05719}05719\ \ \ \ \ \textcolor{keyword}{def\ }test\_ranksums\_result\_attributes(self,\ alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05720}05720\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ranksums\ pval\ =\ mannwhitneyu\ pval\ w/out\ continuity\ or\ tie\ correction}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05721}05721\ \ \ \ \ \ \ \ \ res1\ =\ stats.ranksums(self.x,\ self.y,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05722}05722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05723}05723\ \ \ \ \ \ \ \ \ res2\ =\ stats.mannwhitneyu(self.x,\ self.y,\ use\_continuity=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05724}05724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=alternative).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05725}05725\ \ \ \ \ \ \ \ \ assert\_allclose(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05726}05726\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05727}05727\ \ \ \ \ \textcolor{keyword}{def\ }test\_ranksums\_named\_results(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05728}05728\ \ \ \ \ \ \ \ \ res\ =\ stats.ranksums(self.x,\ self.y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05729}05729\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'}))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05730}05730\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05731}05731\ \ \ \ \ \textcolor{keyword}{def\ }test\_input\_validation(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05732}05732\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}alternative\ must\ be\ 'less'"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05733}05733\ \ \ \ \ \ \ \ \ \ \ \ \ stats.ranksums(self.x,\ self.y,\ alternative=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05734}05734\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05735}05735\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05736}05736\ \textcolor{keyword}{class\ }TestJarqueBera:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05737}05737\ \ \ \ \ \textcolor{keyword}{def\ }test\_jarque\_bera\_stats(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05738}05738\ \ \ \ \ \ \ \ \ np.random.seed(987654321)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05739}05739\ \ \ \ \ \ \ \ \ x\ =\ np.random.normal(0,\ 1,\ 100000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05740}05740\ \ \ \ \ \ \ \ \ y\ =\ np.random.chisquare(10000,\ 100000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05741}05741\ \ \ \ \ \ \ \ \ z\ =\ np.random.rayleigh(1,\ 100000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05742}05742\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05743}05743\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(x)[0],\ stats.jarque\_bera(x).statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05744}05744\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(x)[1],\ stats.jarque\_bera(x).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05745}05745\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05746}05746\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(y)[0],\ stats.jarque\_bera(y).statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05747}05747\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(y)[1],\ stats.jarque\_bera(y).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05748}05748\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05749}05749\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(z)[0],\ stats.jarque\_bera(z).statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05750}05750\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(z)[1],\ stats.jarque\_bera(z).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05751}05751\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05752}05752\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(x)[1]\ >\ stats.jarque\_bera(y)[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05753}05753\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(x).pvalue\ >\ stats.jarque\_bera(y).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05754}05754\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05755}05755\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(x)[1]\ >\ stats.jarque\_bera(z)[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05756}05756\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(x).pvalue\ >\ stats.jarque\_bera(z).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05757}05757\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05758}05758\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(y)[1]\ >\ stats.jarque\_bera(z)[1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05759}05759\ \ \ \ \ \ \ \ \ assert\_(stats.jarque\_bera(y).pvalue\ >\ stats.jarque\_bera(z).pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05760}05760\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05761}05761\ \ \ \ \ \textcolor{keyword}{def\ }test\_jarque\_bera\_array\_like(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05762}05762\ \ \ \ \ \ \ \ \ np.random.seed(987654321)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05763}05763\ \ \ \ \ \ \ \ \ x\ =\ np.random.normal(0,\ 1,\ 100000)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05764}05764\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05765}05765\ \ \ \ \ \ \ \ \ jb\_test1\ =\ JB1,\ p1\ =\ stats.jarque\_bera(list(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05766}05766\ \ \ \ \ \ \ \ \ jb\_test2\ =\ JB2,\ p2\ =\ stats.jarque\_bera(tuple(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05767}05767\ \ \ \ \ \ \ \ \ jb\_test3\ =\ JB3,\ p3\ =\ stats.jarque\_bera(x.reshape(2,\ 50000))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05768}05768\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05769}05769\ \ \ \ \ \ \ \ \ assert\_(JB1\ ==\ JB2\ ==\ JB3\ ==\ jb\_test1.statistic\ ==\ jb\_test2.statistic\ ==\ jb\_test3.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05770}05770\ \ \ \ \ \ \ \ \ assert\_(p1\ ==\ p2\ ==\ p3\ ==\ jb\_test1.pvalue\ ==\ jb\_test2.pvalue\ ==\ jb\_test3.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05771}05771\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05772}05772\ \ \ \ \ \textcolor{keyword}{def\ }test\_jarque\_bera\_size(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05773}05773\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.jarque\_bera,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05774}05774\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05775}05775\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05776}05776\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(abs(hash(\textcolor{stringliteral}{'JarqueBera'})))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05777}05777\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=(2,\ 45))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05778}05778\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05779}05779\ \ \ \ \ \ \ \ \ assert\_equal(stats.jarque\_bera(x,\ axis=\textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05780}05780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.jarque\_bera(x.ravel()))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05781}05781\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05782}05782\ \ \ \ \ \ \ \ \ res\ =\ stats.jarque\_bera(x,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05783}05783\ \ \ \ \ \ \ \ \ s0,\ p0\ =\ stats.jarque\_bera(x[0,\ :])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05784}05784\ \ \ \ \ \ \ \ \ s1,\ p1\ =\ stats.jarque\_bera(x[1,\ :])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05785}05785\ \ \ \ \ \ \ \ \ assert\_allclose(res.statistic,\ [s0,\ s1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05786}05786\ \ \ \ \ \ \ \ \ assert\_allclose(res.pvalue,\ [p0,\ p1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05787}05787\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05788}05788\ \ \ \ \ \ \ \ \ resT\ =\ stats.jarque\_bera(x.T,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05789}05789\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ resT)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05790}05790\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05791}05791\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05792}05792\ \textcolor{keyword}{def\ }test\_skewtest\_too\_few\_samples():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05793}05793\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ ticket\ \#1492.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05794}05794\ \ \ \ \ \textcolor{comment}{\#\ skewtest\ requires\ at\ least\ 8\ samples;\ 7\ should\ raise\ a\ ValueError.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05795}05795\ \ \ \ \ x\ =\ np.arange(7.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05796}05796\ \ \ \ \ assert\_raises(ValueError,\ stats.skewtest,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05797}05797\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05798}05798\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05799}05799\ \textcolor{keyword}{def\ }test\_kurtosistest\_too\_few\_samples():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05800}05800\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ ticket\ \#1425.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05801}05801\ \ \ \ \ \textcolor{comment}{\#\ kurtosistest\ requires\ at\ least\ 5\ samples;\ 4\ should\ raise\ a\ ValueError.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05802}05802\ \ \ \ \ x\ =\ np.arange(4.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05803}05803\ \ \ \ \ assert\_raises(ValueError,\ stats.kurtosistest,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05804}05804\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05805}05805\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05806}05806\ \textcolor{keyword}{class\ }TestMannWhitneyU:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05807}05807\ \ \ \ \ X\ =\ [19.8958398126694,\ 19.5452691647182,\ 19.0577309166425,\ 21.716543054589,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05808}05808\ \ \ \ \ \ \ \ \ \ 20.3269502208702,\ 20.0009273294025,\ 19.3440043632957,\ 20.4216806548105,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05809}05809\ \ \ \ \ \ \ \ \ \ 19.0649894736528,\ 18.7808043120398,\ 19.3680942943298,\ 19.4848044069953,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05810}05810\ \ \ \ \ \ \ \ \ \ 20.7514611265663,\ 19.0894948874598,\ 19.4975522356628,\ 18.9971170734274,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05811}05811\ \ \ \ \ \ \ \ \ \ 20.3239606288208,\ 20.6921298083835,\ 19.0724259532507,\ 18.9825187935021,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05812}05812\ \ \ \ \ \ \ \ \ \ 19.5144462609601,\ 19.8256857844223,\ 20.5174677102032,\ 21.1122407995892,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05813}05813\ \ \ \ \ \ \ \ \ \ 17.9490854922535,\ 18.2847521114727,\ 20.1072217648826,\ 18.6439891962179,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05814}05814\ \ \ \ \ \ \ \ \ \ 20.4970638083542,\ 19.5567594734914]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05815}05815\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05816}05816\ \ \ \ \ Y\ =\ [19.2790668029091,\ 16.993808441865,\ 18.5416338448258,\ 17.2634018833575,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05817}05817\ \ \ \ \ \ \ \ \ \ 19.1577183624616,\ 18.5119655377495,\ 18.6068455037221,\ 18.8358343362655,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05818}05818\ \ \ \ \ \ \ \ \ \ 19.0366413269742,\ 18.1135025515417,\ 19.2201873866958,\ 17.8344909022841,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05819}05819\ \ \ \ \ \ \ \ \ \ 18.2894380745856,\ 18.6661374133922,\ 19.9688601693252,\ 16.0672254617636,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05820}05820\ \ \ \ \ \ \ \ \ \ 19.00596360572,\ 19.201561539032,\ 19.0487501090183,\ 19.0847908674356]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05821}05821\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05822}05822\ \ \ \ \ significant\ =\ 14}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05823}05823\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05824}05824\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_one\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05825}05825\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05826}05826\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05827}05827\ \ \ \ \ \ \ \ \ u3,\ p3\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05828}05828\ \ \ \ \ \ \ \ \ u4,\ p4\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05829}05829\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05830}05830\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ p2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05831}05831\ \ \ \ \ \ \ \ \ assert\_equal(p3,\ p4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05832}05832\ \ \ \ \ \ \ \ \ assert\_(p1\ !=\ p3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05833}05833\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05834}05834\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05835}05835\ \ \ \ \ \ \ \ \ assert\_equal(u3,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05836}05836\ \ \ \ \ \ \ \ \ assert\_equal(u4,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05837}05837\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.999957683256589,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05838}05838\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p3,\ 4.5941632666275e-\/05,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05839}05839\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05840}05840\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_two\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05841}05841\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05842}05842\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05843}05843\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05844}05844\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ p2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05845}05845\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05846}05846\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05847}05847\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 9.188326533255e-\/05,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05848}05848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05849}05849\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05850}05850\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_no\_correct\_one\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05851}05851\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05852}05852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05853}05853\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05854}05854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05855}05855\ \ \ \ \ \ \ \ \ u3,\ p3\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05856}05856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05857}05857\ \ \ \ \ \ \ \ \ u4,\ p4\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05858}05858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05859}05859\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05860}05860\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ p2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05861}05861\ \ \ \ \ \ \ \ \ assert\_equal(p3,\ p4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05862}05862\ \ \ \ \ \ \ \ \ assert\_(p1\ !=\ p3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05863}05863\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05864}05864\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05865}05865\ \ \ \ \ \ \ \ \ assert\_equal(u3,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05866}05866\ \ \ \ \ \ \ \ \ assert\_equal(u4,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05867}05867\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.999955905990004,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05868}05868\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p3,\ 4.40940099958089e-\/05,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05869}05869\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05870}05870\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_no\_correct\_two\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05871}05871\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05872}05872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05873}05873\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.mannwhitneyu(self.Y,\ self.X,\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05874}05874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05875}05875\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05876}05876\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ p2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05877}05877\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ 498)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05878}05878\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ 102)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05879}05879\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 8.81880199916178e-\/05,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05880}05880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05881}05881\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05882}05882\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_ones(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05883}05883\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ gh-\/1428}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05884}05884\ \ \ \ \ \ \ \ \ x\ =\ np.array([1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05885}05885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05886}05886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05887}05887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05888}05888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05889}05889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05890}05890\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05891}05891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05892}05892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 2.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05893}05893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05894}05894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05895}05895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05896}05896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05897}05897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05898}05898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05899}05899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 3.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05900}05900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05901}05901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05902}05902\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05903}05903\ \ \ \ \ \ \ \ \ y\ =\ np.array([1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05904}05904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 3.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05905}05905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 2.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05906}05906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05907}05907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05908}05908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 2.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05909}05909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05910}05910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 2.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05911}05911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05912}05912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05913}05913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,\ 1.,\ 2.,\ 1.,\ 1.,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05914}05914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.,\ 1.,\ 1.,\ 1.])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05915}05915\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05916}05916\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ checked\ against\ R\ wilcox.test}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05917}05917\ \ \ \ \ \ \ \ \ assert\_allclose(stats.mannwhitneyu(x,\ y,\ alternative=\textcolor{stringliteral}{'less'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05918}05918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (16980.5,\ 2.8214327656317373e-\/005))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05919}05919\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ p-\/value\ from\ R,\ e.g.\ wilcox.test(x,\ y,\ alternative="{}g"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05920}05920\ \ \ \ \ \ \ \ \ assert\_allclose(stats.mannwhitneyu(x,\ y,\ alternative=\textcolor{stringliteral}{'greater'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05921}05921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (16980.5,\ 0.9999719954296))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05922}05922\ \ \ \ \ \ \ \ \ assert\_allclose(stats.mannwhitneyu(x,\ y,\ alternative=\textcolor{stringliteral}{'two-\/sided'}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05923}05923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (16980.5,\ 5.642865531266e-\/05))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05924}05924\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05925}05925\ \ \ \ \ \textcolor{keyword}{def\ }test\_mannwhitneyu\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05926}05926\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05927}05927\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05928}05928\ \ \ \ \ \ \ \ \ res\ =\ stats.mannwhitneyu(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{"{}less"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05929}05929\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05930}05930\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05931}05931\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05932}05932\ \textcolor{keyword}{def\ }test\_pointbiserial():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05933}05933\ \ \ \ \ \textcolor{comment}{\#\ same\ as\ mstats\ test\ except\ for\ the\ nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05934}05934\ \ \ \ \ \textcolor{comment}{\#\ Test\ data:\ https://web.archive.org/web/20060504220742/https://support.sas.com/ctx/samples/index.jsp?sid=490\&tab=output}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05935}05935\ \ \ \ \ x\ =\ [1,0,1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05936}05936\ \ \ \ \ \ \ \ \ \ 0,0,0,0,1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05937}05937\ \ \ \ \ y\ =\ [14.8,13.8,12.4,10.1,7.1,6.1,5.8,4.6,4.3,3.5,3.3,3.2,3.0,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05938}05938\ \ \ \ \ \ \ \ \ \ 2.8,2.8,2.5,2.4,2.3,2.1,1.7,1.7,1.5,1.3,1.3,1.2,1.2,1.1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05939}05939\ \ \ \ \ \ \ \ \ \ 0.8,0.7,0.6,0.5,0.2,0.2,0.1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05940}05940\ \ \ \ \ assert\_almost\_equal(stats.pointbiserialr(x,\ y)[0],\ 0.36149,\ 5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05941}05941\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05942}05942\ \ \ \ \ \textcolor{comment}{\#\ test\ for\ namedtuple\ attribute\ results}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05943}05943\ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'correlation'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05944}05944\ \ \ \ \ res\ =\ stats.pointbiserialr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05945}05945\ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05946}05946\ \ \ \ \ assert\_equal(res.correlation,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05947}05947\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05948}05948\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05949}05949\ \textcolor{keyword}{def\ }test\_obrientransform():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05950}05950\ \ \ \ \ \textcolor{comment}{\#\ A\ couple\ tests\ calculated\ by\ hand.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05951}05951\ \ \ \ \ x1\ =\ np.array([0,\ 2,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05952}05952\ \ \ \ \ t1\ =\ stats.obrientransform(x1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05953}05953\ \ \ \ \ expected\ =\ [7,\ -\/2,\ 7]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05954}05954\ \ \ \ \ assert\_allclose(t1[0],\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05955}05955\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05956}05956\ \ \ \ \ x2\ =\ np.array([0,\ 3,\ 6,\ 9])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05957}05957\ \ \ \ \ t2\ =\ stats.obrientransform(x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05958}05958\ \ \ \ \ expected\ =\ np.array([30,\ 0,\ 0,\ 30])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05959}05959\ \ \ \ \ assert\_allclose(t2[0],\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05960}05960\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05961}05961\ \ \ \ \ \textcolor{comment}{\#\ Test\ two\ arguments.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05962}05962\ \ \ \ \ a,\ b\ =\ stats.obrientransform(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05963}05963\ \ \ \ \ assert\_equal(a,\ t1[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05964}05964\ \ \ \ \ assert\_equal(b,\ t2[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05965}05965\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05966}05966\ \ \ \ \ \textcolor{comment}{\#\ Test\ three\ arguments.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05967}05967\ \ \ \ \ a,\ b,\ c\ =\ stats.obrientransform(x1,\ x2,\ x1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05968}05968\ \ \ \ \ assert\_equal(a,\ t1[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05969}05969\ \ \ \ \ assert\_equal(b,\ t2[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05970}05970\ \ \ \ \ assert\_equal(c,\ t1[0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05971}05971\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05972}05972\ \ \ \ \ \textcolor{comment}{\#\ This\ is\ a\ regression\ test\ to\ check\ np.var\ replacement.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05973}05973\ \ \ \ \ \textcolor{comment}{\#\ The\ author\ of\ this\ test\ didn't\ separately\ verify\ the\ numbers.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05974}05974\ \ \ \ \ x1\ =\ np.arange(5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05975}05975\ \ \ \ \ result\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05976}05976\ \ \ \ \ \ \ [[5.41666667,\ 1.04166667,\ -\/0.41666667,\ 1.04166667,\ 5.41666667],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05977}05977\ \ \ \ \ \ \ \ [21.66666667,\ 4.16666667,\ -\/1.66666667,\ 4.16666667,\ 21.66666667]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05978}05978\ \ \ \ \ assert\_array\_almost\_equal(stats.obrientransform(x1,\ 2*x1),\ result,\ decimal=8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05979}05979\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05980}05980\ \ \ \ \ \textcolor{comment}{\#\ Example\ from\ "{}O'Brien\ Test\ for\ Homogeneity\ of\ Variance"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05981}05981\ \ \ \ \ \textcolor{comment}{\#\ by\ Herve\ Abdi.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05982}05982\ \ \ \ \ values\ =\ range(5,\ 11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05983}05983\ \ \ \ \ reps\ =\ np.array([5,\ 11,\ 9,\ 3,\ 2,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05984}05984\ \ \ \ \ data\ =\ np.repeat(values,\ reps)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05985}05985\ \ \ \ \ transformed\_values\ =\ np.array([3.1828,\ 0.5591,\ 0.0344,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05986}05986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.6086,\ 5.2817,\ 11.0538])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05987}05987\ \ \ \ \ expected\ =\ np.repeat(transformed\_values,\ reps)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05988}05988\ \ \ \ \ result\ =\ stats.obrientransform(data)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05989}05989\ \ \ \ \ assert\_array\_almost\_equal(result[0],\ expected,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05990}05990\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05991}05991\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05992}05992\ \textcolor{keyword}{def\ }check\_equal\_gmean(array\_like,\ desired,\ axis=None,\ dtype=None,\ rtol=1e-\/7,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05993}05993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=None):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05994}05994\ \ \ \ \ \textcolor{comment}{\#\ Note\ this\ doesn't\ test\ when\ axis\ is\ not\ specified}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05995}05995\ \ \ \ \ x\ =\ stats.gmean(array\_like,\ axis=axis,\ dtype=dtype,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05996}05996\ \ \ \ \ assert\_allclose(x,\ desired,\ rtol=rtol)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05997}05997\ \ \ \ \ assert\_equal(x.dtype,\ dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05998}05998\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l05999}05999\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06000}06000\ \textcolor{keyword}{def\ }check\_equal\_hmean(array\_like,\ desired,\ axis=None,\ dtype=None,\ rtol=1e-\/7,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06001}06001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=None):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06002}06002\ \ \ \ \ x\ =\ stats.hmean(array\_like,\ axis=axis,\ dtype=dtype,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06003}06003\ \ \ \ \ assert\_allclose(x,\ desired,\ rtol=rtol)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06004}06004\ \ \ \ \ assert\_equal(x.dtype,\ dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06005}06005\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06006}06006\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06007}06007\ \textcolor{keyword}{def\ }check\_equal\_pmean(array\_like,\ exp,\ desired,\ axis=None,\ dtype=None,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06008}06008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rtol=1e-\/7,\ weights=None):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06009}06009\ \ \ \ \ x\ =\ stats.pmean(array\_like,\ exp,\ axis=axis,\ dtype=dtype,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06010}06010\ \ \ \ \ assert\_allclose(x,\ desired,\ rtol=rtol)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06011}06011\ \ \ \ \ assert\_equal(x.dtype,\ dtype)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06012}06012\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06013}06013\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06014}06014\ \textcolor{keyword}{class\ }TestHarMean:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06015}06015\ \ \ \ \ \textcolor{keyword}{def\ }test\_0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06016}06016\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 0,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06017}06017\ \ \ \ \ \ \ \ \ desired\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06018}06018\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06019}06019\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06020}06020\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06021}06021\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06022}06022\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06023}06023\ \ \ \ \ \ \ \ \ desired\ =\ 34.1417152147}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06024}06024\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06025}06025\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06026}06026\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06027}06027\ \ \ \ \ \ \ \ \ desired\ =\ 4.\ /\ (1.\ /\ 1\ +\ 1.\ /\ 2\ +\ 1.\ /\ 3\ +\ 1.\ /\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06028}06028\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06029}06029\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06030}06030\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06031}06031\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ array}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06032}06032\ \ \ \ \ \ \ \ \ a\ =\ np.array([10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06033}06033\ \ \ \ \ \ \ \ \ desired\ =\ 34.1417152147}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06034}06034\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06035}06035\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06036}06036\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array\_with\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06037}06037\ \ \ \ \ \ \ \ \ a\ =\ np.array([1,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06038}06038\ \ \ \ \ \ \ \ \ desired\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06039}06039\ \ \ \ \ \ \ \ \ assert\_equal(stats.hmean(a),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06040}06040\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06041}06041\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array\_with\_negative\_value(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06042}06042\ \ \ \ \ \ \ \ \ a\ =\ np.array([1,\ 0,\ -\/1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06043}06043\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.hmean,\ a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06044}06044\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06045}06045\ \ \ \ \ \textcolor{comment}{\#\ Note\ the\ next\ tests\ use\ axis=None\ as\ default,\ not\ axis=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06046}06046\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06047}06047\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06048}06048\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06049}06049\ \ \ \ \ \ \ \ \ desired\ =\ 38.6696271841}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06050}06050\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06051}06051\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06052}06052\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06053}06053\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ array}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06054}06054\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06055}06055\ \ \ \ \ \ \ \ \ desired\ =\ 38.6696271841}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06056}06056\ \ \ \ \ \ \ \ \ check\_equal\_hmean(np.array(a),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06057}06057\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06058}06058\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06059}06059\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list\ with\ axis=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06060}06060\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06061}06061\ \ \ \ \ \ \ \ \ desired\ =\ np.array([22.88135593,\ 39.13043478,\ 52.90076336,\ 65.45454545])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06062}06062\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06063}06063\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06064}06064\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis0\_with\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06065}06065\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 0,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06066}06066\ \ \ \ \ \ \ \ \ desired\ =\ np.array([22.88135593,\ 0.0,\ 52.90076336,\ 65.45454545])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06067}06067\ \ \ \ \ \ \ \ \ assert\_allclose(stats.hmean(a,\ axis=0),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06068}06068\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06069}06069\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06070}06070\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list\ with\ axis=1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06071}06071\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06072}06072\ \ \ \ \ \ \ \ \ desired\ =\ np.array([19.2,\ 63.03939962,\ 103.80078637])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06073}06073\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06074}06074\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06075}06075\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis1\_with\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06076}06076\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 0,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06077}06077\ \ \ \ \ \ \ \ \ desired\ =\ np.array([0.0,\ 63.03939962,\ 103.80078637])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06078}06078\ \ \ \ \ \ \ \ \ assert\_allclose(stats.hmean(a,\ axis=1),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06079}06079\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06080}06080\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06081}06081\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06082}06082\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.hackmath.net/en/math-\/problem/35871}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06083}06083\ \ \ \ \ \ \ \ \ a\ =\ [2,\ 10,\ 6]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06084}06084\ \ \ \ \ \ \ \ \ weights\ =\ [10,\ 5,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06085}06085\ \ \ \ \ \ \ \ \ desired\ =\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06086}06086\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06087}06087\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06088}06088\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_2d\_array\_axis0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06089}06089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06090}06090\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.hackmath.net/en/math-\/problem/35871}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06091}06091\ \ \ \ \ \ \ \ \ a\ =\ np.array([[2,\ 5],\ [10,\ 5],\ [6,\ 5]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06092}06092\ \ \ \ \ \ \ \ \ weights\ =\ np.array([[10,\ 1],\ [5,\ 1],\ [3,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06093}06093\ \ \ \ \ \ \ \ \ desired\ =\ np.array([3,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06094}06094\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ axis=0,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06095}06095\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06096}06096\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_2d\_array\_axis1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06097}06097\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06098}06098\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.hackmath.net/en/math-\/problem/35871}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06099}06099\ \ \ \ \ \ \ \ \ a\ =\ np.array([[2,\ 10,\ 6],\ [7,\ 7,\ 7]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06100}06100\ \ \ \ \ \ \ \ \ weights\ =\ np.array([[10,\ 5,\ 3],\ [1,\ 1,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06101}06101\ \ \ \ \ \ \ \ \ desired\ =\ np.array([3,\ 7])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06102}06102\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ axis=1,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06103}06103\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06104}06104\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_masked\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06105}06105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06106}06106\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.hackmath.net/en/math-\/problem/35871}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06107}06107\ \ \ \ \ \ \ \ \ a\ =\ np.array([2,\ 10,\ 6,\ 42])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06108}06108\ \ \ \ \ \ \ \ \ weights\ =\ np.ma.array([10,\ 5,\ 3,\ 42],\ mask=[0,\ 0,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06109}06109\ \ \ \ \ \ \ \ \ desired\ =\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06110}06110\ \ \ \ \ \ \ \ \ check\_equal\_hmean(a,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06111}06111\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06112}06112\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06113}06113\ \textcolor{keyword}{class\ }TestGeoMean:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06114}06114\ \ \ \ \ \textcolor{keyword}{def\ }test\_0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06115}06115\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 0,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06116}06116\ \ \ \ \ \ \ \ \ desired\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06117}06117\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06118}06118\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06119}06119\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06120}06120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06121}06121\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06122}06122\ \ \ \ \ \ \ \ \ desired\ =\ 45.2872868812}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06123}06123\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06124}06124\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06125}06125\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06126}06126\ \ \ \ \ \ \ \ \ desired\ =\ power(1\ *\ 2\ *\ 3\ *\ 4,\ 1.\ /\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06127}06127\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06128}06128\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06129}06129\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06130}06130\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ array}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06131}06131\ \ \ \ \ \ \ \ \ a\ =\ np.array([10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06132}06132\ \ \ \ \ \ \ \ \ desired\ =\ 45.2872868812}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06133}06133\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06134}06134\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06135}06135\ \ \ \ \ \ \ \ \ a\ =\ array([1,\ 2,\ 3,\ 4],\ float32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06136}06136\ \ \ \ \ \ \ \ \ desired\ =\ power(1\ *\ 2\ *\ 3\ *\ 4,\ 1.\ /\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06137}06137\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ dtype=float32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06138}06138\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06139}06139\ \ \ \ \ \textcolor{comment}{\#\ Note\ the\ next\ tests\ use\ axis=None\ as\ default,\ not\ axis=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06140}06140\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06141}06141\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06142}06142\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06143}06143\ \ \ \ \ \ \ \ \ desired\ =\ 52.8885199}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06144}06144\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06145}06145\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06146}06146\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06147}06147\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ array}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06148}06148\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06149}06149\ \ \ \ \ \ \ \ \ desired\ =\ 52.8885199}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06150}06150\ \ \ \ \ \ \ \ \ check\_equal\_gmean(array(a),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06151}06151\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06152}06152\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06153}06153\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list\ with\ axis=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06154}06154\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06155}06155\ \ \ \ \ \ \ \ \ desired\ =\ np.array([35.56893304,\ 49.32424149,\ 61.3579244,\ 72.68482371])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06156}06156\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06157}06157\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06158}06158\ \ \ \ \ \ \ \ \ a\ =\ array([[1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06159}06159\ \ \ \ \ \ \ \ \ desired\ =\ array([1,\ 2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06160}06160\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ axis=0,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06161}06161\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06162}06162\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axis1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06163}06163\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 2d\ list\ with\ axis=1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06164}06164\ \ \ \ \ \ \ \ \ a\ =\ [[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06165}06165\ \ \ \ \ \ \ \ \ desired\ =\ np.array([22.13363839,\ 64.02171746,\ 104.40086817])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06166}06166\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06167}06167\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06168}06168\ \ \ \ \ \ \ \ \ a\ =\ array([[1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06169}06169\ \ \ \ \ \ \ \ \ v\ =\ power(1\ *\ 2\ *\ 3\ *\ 4,\ 1.\ /\ 4.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06170}06170\ \ \ \ \ \ \ \ \ desired\ =\ array([v,\ v,\ v])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06171}06171\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ axis=1,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06172}06172\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06173}06173\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06174}06174\ \ \ \ \ \ \ \ \ a\ =\ array([1e100,\ 1e200,\ 1e300])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06175}06175\ \ \ \ \ \ \ \ \ desired\ =\ 1e200}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06176}06176\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ rtol=1e-\/13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06177}06177\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06178}06178\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_list0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06179}06179\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ list\ with\ zero\ element}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06180}06180\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 0]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06181}06181\ \ \ \ \ \ \ \ \ desired\ =\ 0.0\ \ \textcolor{comment}{\#\ due\ to\ exp(-\/inf)=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06182}06182\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06183}06183\ \ \ \ \ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06184}06184\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06185}06185\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06186}06186\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ array\ with\ zero\ element}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06187}06187\ \ \ \ \ \ \ \ \ a\ =\ np.array([10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06188}06188\ \ \ \ \ \ \ \ \ desired\ =\ 0.0\ \ \textcolor{comment}{\#\ due\ to\ exp(-\/inf)=0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06189}06189\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(divide=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06190}06190\ \ \ \ \ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06191}06191\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06192}06192\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_list\_neg(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06193}06193\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ Test\ a\ 1d\ list\ with\ negative\ element}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06194}06194\ \ \ \ \ \ \ \ \ a\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ -\/1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06195}06195\ \ \ \ \ \ \ \ \ desired\ =\ np.nan\ \ \textcolor{comment}{\#\ due\ to\ log(-\/1)\ =\ nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06196}06196\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06197}06197\ \ \ \ \ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06198}06198\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06199}06199\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06200}06200\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06201}06201\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.dummies.com/education/math/business-\/statistics/how-\/to-\/find-\/the-\/weighted-\/geometric-\/mean-\/of-\/a-\/data-\/set/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06202}06202\ \ \ \ \ \ \ \ \ a\ =\ [1,\ 2,\ 3,\ 4,\ 5]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06203}06203\ \ \ \ \ \ \ \ \ weights\ =\ [2,\ 5,\ 6,\ 4,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06204}06204\ \ \ \ \ \ \ \ \ desired\ =\ 2.77748}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06205}06205\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06206}06206\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06207}06207\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06208}06208\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06209}06209\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.dummies.com/education/math/business-\/statistics/how-\/to-\/find-\/the-\/weighted-\/geometric-\/mean-\/of-\/a-\/data-\/set/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06210}06210\ \ \ \ \ \ \ \ \ a\ =\ np.array([1,\ 2,\ 3,\ 4,\ 5])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06211}06211\ \ \ \ \ \ \ \ \ weights\ =\ np.array([2,\ 5,\ 6,\ 4,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06212}06212\ \ \ \ \ \ \ \ \ desired\ =\ 2.77748}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06213}06213\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06214}06214\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06215}06215\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_masked\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06216}06216\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Desired\ result\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06217}06217\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.dummies.com/education/math/business-\/statistics/how-\/to-\/find-\/the-\/weighted-\/geometric-\/mean-\/of-\/a-\/data-\/set/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06218}06218\ \ \ \ \ \ \ \ \ a\ =\ np.array([1,\ 2,\ 3,\ 4,\ 5,\ 6])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06219}06219\ \ \ \ \ \ \ \ \ weights\ =\ np.ma.array([2,\ 5,\ 6,\ 4,\ 3,\ 5],\ mask=[0,\ 0,\ 0,\ 0,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06220}06220\ \ \ \ \ \ \ \ \ desired\ =\ 2.77748}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06221}06221\ \ \ \ \ \ \ \ \ check\_equal\_gmean(a,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06222}06222\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06223}06223\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06224}06224\ \textcolor{keyword}{class\ }TestPowMean:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06225}06225\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06226}06226\ \ \ \ \ \textcolor{keyword}{def\ }pmean\_reference(a,\ p):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06227}06227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (np.sum(a**p)\ /\ a.size)**(1/p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06228}06228\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06229}06229\ \ \ \ \ \textcolor{keyword}{def\ }wpmean\_reference(a,\ p,\ weights):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06230}06230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (np.sum(weights\ *\ a**p)\ /\ np.sum(weights))**(1/p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06231}06231\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06232}06232\ \ \ \ \ \textcolor{keyword}{def\ }test\_bad\_exponent(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06233}06233\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Power\ mean\ only\ defined\ for'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06234}06234\ \ \ \ \ \ \ \ \ \ \ \ \ stats.pmean([1,\ 2,\ 3],\ [0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06235}06235\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Power\ mean\ only\ defined\ for'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06236}06236\ \ \ \ \ \ \ \ \ \ \ \ \ stats.pmean([1,\ 2,\ 3],\ np.array([0]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06237}06237\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06238}06238\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06239}06239\ \ \ \ \ \ \ \ \ a,\ p\ =\ [10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100],\ 3.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06240}06240\ \ \ \ \ \ \ \ \ desired\ =\ TestPowMean.pmean\_reference(np.array(a),\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06241}06241\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06242}06242\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06243}06243\ \ \ \ \ \ \ \ \ a,\ p\ =\ [1,\ 2,\ 3,\ 4],\ 2}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06244}06244\ \ \ \ \ \ \ \ \ desired\ =\ np.sqrt((1**2\ +\ 2**2\ +\ 3**2\ +\ 4**2)\ /\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06245}06245\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06246}06246\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06247}06247\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06248}06248\ \ \ \ \ \ \ \ \ a,\ p\ =\ np.array([10,\ 20,\ 30,\ 40,\ 50,\ 60,\ 70,\ 80,\ 90,\ 100]),\ -\/2.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06249}06249\ \ \ \ \ \ \ \ \ desired\ =\ TestPowMean.pmean\_reference(a,\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06250}06250\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06251}06251\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06252}06252\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array\_with\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06253}06253\ \ \ \ \ \ \ \ \ a,\ p\ =\ np.array([1,\ 0]),\ -\/1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06254}06254\ \ \ \ \ \ \ \ \ desired\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06255}06255\ \ \ \ \ \ \ \ \ assert\_equal(stats.pmean(a,\ p),\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06256}06256\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06257}06257\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array\_with\_negative\_value(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06258}06258\ \ \ \ \ \ \ \ \ a,\ p\ =\ np.array([1,\ 0,\ -\/1]),\ 1.23}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06259}06259\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Power\ mean\ only\ defined\ if\ all'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06260}06260\ \ \ \ \ \ \ \ \ \ \ \ \ stats.pmean(a,\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06261}06261\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06262}06262\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06263}06263\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}a"{}},\ \textcolor{stringliteral}{"{}p"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06264}06264\ \ \ \ \ \ \ \ \ [([[10,\ 20],\ [50,\ 60],\ [90,\ 100]],\ -\/0.5),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06265}06265\ \ \ \ \ \ \ \ \ \ (np.array([[10,\ 20],\ [50,\ 60],\ [90,\ 100]]),\ 0.5)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06266}06266\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06267}06267\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_axisnone(self,\ a,\ p):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06268}06268\ \ \ \ \ \ \ \ \ desired\ =\ TestPowMean.pmean\_reference(np.array(a),\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06269}06269\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06270}06270\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06271}06271\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06272}06272\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}a"{}},\ \textcolor{stringliteral}{"{}p"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06273}06273\ \ \ \ \ \ \ \ \ [([[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]],\ -\/0.5),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06274}06274\ \ \ \ \ \ \ \ \ \ ([[10,\ 0,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]],\ 0.5)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06275}06275\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06276}06276\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_list\_axis0(self,\ a,\ p):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06277}06277\ \ \ \ \ \ \ \ \ desired\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06278}06278\ \ \ \ \ \ \ \ \ \ \ \ \ TestPowMean.pmean\_reference(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06279}06279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([a[i][j]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(a))]),\ p}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06280}06280\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06281}06281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(len(a[0]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06282}06282\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06283}06283\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06284}06284\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06285}06285\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06286}06286\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}a"{}},\ \textcolor{stringliteral}{"{}p"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06287}06287\ \ \ \ \ \ \ \ \ [([[10,\ 20,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]],\ -\/0.5),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06288}06288\ \ \ \ \ \ \ \ \ \ ([[10,\ 0,\ 30,\ 40],\ [50,\ 60,\ 70,\ 80],\ [90,\ 100,\ 110,\ 120]],\ 0.5)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06289}06289\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06290}06290\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_list\_axis1(self,\ a,\ p):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06291}06291\ \ \ \ \ \ \ \ \ desired\ =\ [TestPowMean.pmean\_reference(np.array(a\_),\ p)\ \textcolor{keywordflow}{for}\ a\_\ \textcolor{keywordflow}{in}\ a]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06292}06292\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06293}06293\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06294}06294\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_1d\_list(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06295}06295\ \ \ \ \ \ \ \ \ a,\ p\ =\ [2,\ 10,\ 6],\ -\/1.23456789}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06296}06296\ \ \ \ \ \ \ \ \ weights\ =\ [10,\ 5,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06297}06297\ \ \ \ \ \ \ \ \ desired\ =\ TestPowMean.wpmean\_reference(np.array(a),\ p,\ weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06298}06298\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06299}06299\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06300}06300\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_masked\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06301}06301\ \ \ \ \ \ \ \ \ a,\ p\ =\ np.array([2,\ 10,\ 6,\ 42]),\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06302}06302\ \ \ \ \ \ \ \ \ weights\ =\ np.ma.array([10,\ 5,\ 3,\ 42],\ mask=[0,\ 0,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06303}06303\ \ \ \ \ \ \ \ \ desired\ =\ np.average(a,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06304}06304\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06305}06305\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06306}06306\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06307}06307\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}axis"{}},\ \textcolor{stringliteral}{"{}fun\_name"{}},\ \textcolor{stringliteral}{"{}p"{}}),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06308}06308\ \ \ \ \ \ \ \ \ [(\textcolor{keywordtype}{None},\ \textcolor{stringliteral}{"{}wpmean\_reference"{}},\ 9.87654321),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06309}06309\ \ \ \ \ \ \ \ \ \ (0,\ \textcolor{stringliteral}{"{}gmean"{}},\ 0),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06310}06310\ \ \ \ \ \ \ \ \ \ (1,\ \textcolor{stringliteral}{"{}hmean"{}},\ -\/1)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06311}06311\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06312}06312\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights\_2d\_array(self,\ axis,\ fun\_name,\ p):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06313}06313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ fun\_name\ ==\ \textcolor{stringliteral}{'wpmean\_reference'}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06314}06314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }fun(a,\ axis,\ weights):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06315}06315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TestPowMean.wpmean\_reference(a,\ p,\ weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06316}06316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06317}06317\ \ \ \ \ \ \ \ \ \ \ \ \ fun\ =\ getattr(stats,\ fun\_name)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06318}06318\ \ \ \ \ \ \ \ \ a\ =\ np.array([[2,\ 5],\ [10,\ 5],\ [6,\ 5]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06319}06319\ \ \ \ \ \ \ \ \ weights\ =\ np.array([[10,\ 1],\ [5,\ 1],\ [3,\ 1]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06320}06320\ \ \ \ \ \ \ \ \ desired\ =\ fun(a,\ axis=axis,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06321}06321\ \ \ \ \ \ \ \ \ check\_equal\_pmean(a,\ p,\ desired,\ axis=axis,\ weights=weights,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06322}06322\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06323}06323\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06324}06324\ \textcolor{keyword}{class\ }TestGeometricStandardDeviation:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06325}06325\ \ \ \ \ \textcolor{comment}{\#\ must\ add\ 1\ as\ \`{}gstd`\ is\ only\ defined\ for\ positive\ values}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06326}06326\ \ \ \ \ array\_1d\ =\ np.arange(2\ *\ 3\ *\ 4)\ +\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06327}06327\ \ \ \ \ gstd\_array\_1d\ =\ 2.294407613602}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06328}06328\ \ \ \ \ array\_3d\ =\ array\_1d.reshape(2,\ 3,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06329}06329\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06330}06330\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06331}06331\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_1d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06332}06332\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ self.gstd\_array\_1d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06333}06333\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06334}06334\ \ \ \ \ \textcolor{keyword}{def\ }test\_1d\_numeric\_array\_like\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06335}06335\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(tuple(self.array\_1d))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06336}06336\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ self.gstd\_array\_1d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06337}06337\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06338}06338\ \ \ \ \ \textcolor{keyword}{def\ }test\_raises\_value\_error\_non\_array\_like\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06339}06339\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Invalid\ array\ input'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06340}06340\ \ \ \ \ \ \ \ \ \ \ \ \ stats.gstd(\textcolor{stringliteral}{'This\ should\ fail\ as\ it\ can\ not\ be\ cast\ to\ an\ array.'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06341}06341\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06342}06342\ \ \ \ \ \textcolor{keyword}{def\ }test\_raises\_value\_error\_zero\_entry(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06343}06343\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Non\ positive\ value'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06344}06344\ \ \ \ \ \ \ \ \ \ \ \ \ stats.gstd(np.append(self.array\_1d,\ [0]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06345}06345\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06346}06346\ \ \ \ \ \textcolor{keyword}{def\ }test\_raises\_value\_error\_negative\_entry(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06347}06347\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Non\ positive\ value'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06348}06348\ \ \ \ \ \ \ \ \ \ \ \ \ stats.gstd(np.append(self.array\_1d,\ [-\/1]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06349}06349\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06350}06350\ \ \ \ \ \textcolor{keyword}{def\ }test\_raises\_value\_error\_inf\_entry(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06351}06351\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Infinite\ value'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06352}06352\ \ \ \ \ \ \ \ \ \ \ \ \ stats.gstd(np.append(self.array\_1d,\ [np.inf]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06353}06353\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06354}06354\ \ \ \ \ \textcolor{keyword}{def\ }test\_propagates\_nan\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06355}06355\ \ \ \ \ \ \ \ \ a\ =\ array([[1,\ 1,\ 1,\ 16],\ [np.nan,\ 1,\ 2,\ 3]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06356}06356\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(a,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06357}06357\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ np.array([4,\ np.nan]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06358}06358\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06359}06359\ \ \ \ \ \textcolor{keyword}{def\ }test\_ddof\_equal\_to\_number\_of\_observations(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06360}06360\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{'Degrees\ of\ freedom\ <=\ 0'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06361}06361\ \ \ \ \ \ \ \ \ \ \ \ \ stats.gstd(self.array\_1d,\ ddof=self.array\_1d.size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06362}06362\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06363}06363\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06364}06364\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_3d,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06365}06365\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ self.gstd\_array\_1d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06366}06366\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06367}06367\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_array\_axis\_type\_tuple(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06368}06368\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_3d,\ axis=(1,2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06369}06369\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ [2.12939215,\ 1.22120169])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06370}06370\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06371}06371\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_array\_axis\_0(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06372}06372\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_3d,\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06373}06373\ \ \ \ \ \ \ \ \ gstd\_desired\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06374}06374\ \ \ \ \ \ \ \ \ \ \ \ \ [6.1330555493918,\ 3.958900210120,\ 3.1206598248344,\ 2.6651441426902],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06375}06375\ \ \ \ \ \ \ \ \ \ \ \ \ [2.3758135028411,\ 2.174581428192,\ 2.0260062829505,\ 1.9115518327308],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06376}06376\ \ \ \ \ \ \ \ \ \ \ \ \ [1.8205343606803,\ 1.746342404566,\ 1.6846557065742,\ 1.6325269194382]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06377}06377\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06378}06378\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ gstd\_desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06379}06379\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06380}06380\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_array\_axis\_1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06381}06381\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_3d,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06382}06382\ \ \ \ \ \ \ \ \ gstd\_desired\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06383}06383\ \ \ \ \ \ \ \ \ \ \ \ \ [3.118993630946,\ 2.275985934063,\ 1.933995977619,\ 1.742896469724],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06384}06384\ \ \ \ \ \ \ \ \ \ \ \ \ [1.271693593916,\ 1.254158641801,\ 1.238774141609,\ 1.225164057869]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06385}06385\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06386}06386\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ gstd\_desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06387}06387\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06388}06388\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_array\_axis\_2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06389}06389\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(self.array\_3d,\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06390}06390\ \ \ \ \ \ \ \ \ gstd\_desired\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06391}06391\ \ \ \ \ \ \ \ \ \ \ \ \ [1.8242475707664,\ 1.2243686572447,\ 1.1318311657788],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06392}06392\ \ \ \ \ \ \ \ \ \ \ \ \ [1.0934830582351,\ 1.0724479791887,\ 1.0591498540749]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06393}06393\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06394}06394\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ gstd\_desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06395}06395\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06396}06396\ \ \ \ \ \textcolor{keyword}{def\ }test\_masked\_3d\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06397}06397\ \ \ \ \ \ \ \ \ ma\ =\ np.ma.masked\_where(self.array\_3d\ >\ 16,\ self.array\_3d)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06398}06398\ \ \ \ \ \ \ \ \ gstd\_actual\ =\ stats.gstd(ma,\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06399}06399\ \ \ \ \ \ \ \ \ gstd\_desired\ =\ stats.gstd(self.array\_3d,\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06400}06400\ \ \ \ \ \ \ \ \ mask\ =\ [[0,\ 0,\ 0],\ [0,\ 1,\ 1]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06401}06401\ \ \ \ \ \ \ \ \ assert\_allclose(gstd\_actual,\ gstd\_desired)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06402}06402\ \ \ \ \ \ \ \ \ assert\_equal(gstd\_actual.mask,\ mask)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06403}06403\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06404}06404\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06405}06405\ \textcolor{preprocessor}{@pytest.mark.parametrize('alternative',\ ['two-\/sided',\ 'greater',\ 'less'])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06406}06406\ \textcolor{keyword}{def\ }test\_binom\_test\_deprecation(alternative):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06407}06407\ \ \ \ \ deprecation\_msg\ =\ (\textcolor{stringliteral}{"{}'binom\_test'\ is\ deprecated\ in\ favour\ of"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06408}06408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ 'binomtest'\ from\ version\ 1.7.0\ and\ will"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06409}06409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ be\ removed\ in\ Scipy\ 1.12.0."{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06410}06410\ \ \ \ \ num\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06411}06411\ \ \ \ \ rng\ =\ np.random.default\_rng(156114182869662948677852568516310985853)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06412}06412\ \ \ \ \ X\ =\ rng.integers(10,\ 100,\ (num,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06413}06413\ \ \ \ \ N\ =\ X\ +\ rng.integers(0,\ 100,\ (num,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06414}06414\ \ \ \ \ P\ =\ rng.uniform(0,\ 1,\ (num,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06415}06415\ \ \ \ \ \textcolor{keywordflow}{for}\ x,\ n,\ p\ \textcolor{keywordflow}{in}\ zip(X,\ N,\ P):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06416}06416\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(DeprecationWarning,\ match=deprecation\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06417}06417\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.binom\_test(x,\ n,\ p,\ alternative=alternative)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06418}06418\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res\ ==\ stats.binomtest(x,\ n,\ p,\ alternative=alternative).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06419}06419\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06420}06420\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06421}06421\ \textcolor{keyword}{def\ }test\_binomtest():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06422}06422\ \ \ \ \ \textcolor{comment}{\#\ precision\ tests\ compared\ to\ R\ for\ ticket:986}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06423}06423\ \ \ \ \ pp\ =\ np.concatenate((np.linspace(0.1,\ 0.2,\ 5),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06424}06424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.linspace(0.45,\ 0.65,\ 5),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06425}06425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.linspace(0.85,\ 0.95,\ 5)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06426}06426\ \ \ \ \ n\ =\ 501}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06427}06427\ \ \ \ \ x\ =\ 450}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06428}06428\ \ \ \ \ results\ =\ [0.0,\ 0.0,\ 1.0159969301994141e-\/304,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06429}06429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.9752418572150531e-\/275,\ 7.7668382922535275e-\/250,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06430}06430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.3381250925167094e-\/099,\ 7.8284591587323951e-\/081,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06431}06431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 9.9155947819961383e-\/065,\ 2.8729390725176308e-\/050,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06432}06432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.7175066298388421e-\/037,\ 0.0021070691951093692,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06433}06433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.12044570587262322,\ 0.88154763174802508,\ 0.027120993063129286,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06434}06434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.6102587134694721e-\/006]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06435}06435\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06436}06436\ \ \ \ \ \textcolor{keywordflow}{for}\ p,\ res\ \textcolor{keywordflow}{in}\ zip(pp,\ results):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06437}06437\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stats.binomtest(x,\ n,\ p).pvalue,\ res,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06438}06438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=12,\ err\_msg=\textcolor{stringliteral}{'fail\ forp=\%f'}\ \%\ p)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06439}06439\ \ \ \ \ assert\_approx\_equal(stats.binomtest(50,\ 100,\ 0.1).pvalue,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06440}06440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 5.8320387857343647e-\/024,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06441}06441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06442}06442\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06443}06443\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06444}06444\ \textcolor{keyword}{def\ }test\_binomtest2():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06445}06445\ \ \ \ \ \textcolor{comment}{\#\ test\ added\ for\ issue\ \#2384}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06446}06446\ \ \ \ \ res2\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06447}06447\ \ \ \ \ \ \ \ \ [1.0,\ 1.0],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06448}06448\ \ \ \ \ \ \ \ \ [0.5,\ 1.0,\ 0.5],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06449}06449\ \ \ \ \ \ \ \ \ [0.25,\ 1.00,\ 1.00,\ 0.25],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06450}06450\ \ \ \ \ \ \ \ \ [0.125,\ 0.625,\ 1.000,\ 0.625,\ 0.125],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06451}06451\ \ \ \ \ \ \ \ \ [0.0625,\ 0.3750,\ 1.0000,\ 1.0000,\ 0.3750,\ 0.0625],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06452}06452\ \ \ \ \ \ \ \ \ [0.03125,\ 0.21875,\ 0.68750,\ 1.00000,\ 0.68750,\ 0.21875,\ 0.03125],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06453}06453\ \ \ \ \ \ \ \ \ [0.015625,\ 0.125000,\ 0.453125,\ 1.000000,\ 1.000000,\ 0.453125,\ 0.125000,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06454}06454\ \ \ \ \ \ \ \ \ \ 0.015625],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06455}06455\ \ \ \ \ \ \ \ \ [0.0078125,\ 0.0703125,\ 0.2890625,\ 0.7265625,\ 1.0000000,\ 0.7265625,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06456}06456\ \ \ \ \ \ \ \ \ \ 0.2890625,\ 0.0703125,\ 0.0078125],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06457}06457\ \ \ \ \ \ \ \ \ [0.00390625,\ 0.03906250,\ 0.17968750,\ 0.50781250,\ 1.00000000,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06458}06458\ \ \ \ \ \ \ \ \ \ 1.00000000,\ 0.50781250,\ 0.17968750,\ 0.03906250,\ 0.00390625],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06459}06459\ \ \ \ \ \ \ \ \ [0.001953125,\ 0.021484375,\ 0.109375000,\ 0.343750000,\ 0.753906250,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06460}06460\ \ \ \ \ \ \ \ \ \ 1.000000000,\ 0.753906250,\ 0.343750000,\ 0.109375000,\ 0.021484375,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06461}06461\ \ \ \ \ \ \ \ \ \ 0.001953125]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06462}06462\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06463}06463\ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(1,\ 11):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06464}06464\ \ \ \ \ \ \ \ \ res1\ =\ [stats.binomtest(v,\ k,\ 0.5).pvalue\ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ range(k\ +\ 1)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06465}06465\ \ \ \ \ \ \ \ \ assert\_almost\_equal(res1,\ res2[k-\/1],\ decimal=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06466}06466\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06467}06467\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06468}06468\ \textcolor{keyword}{def\ }test\_binomtest3():}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06469}06469\ \ \ \ \ \textcolor{comment}{\#\ test\ added\ for\ issue\ \#2384}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06470}06470\ \ \ \ \ \textcolor{comment}{\#\ test\ when\ x\ ==\ n*p\ and\ neighbors}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06471}06471\ \ \ \ \ res3\ =\ [stats.binomtest(v,\ v*k,\ 1./k).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06472}06472\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ range(1,\ 11)\ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(2,\ 11)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06473}06473\ \ \ \ \ assert\_equal(res3,\ np.ones(len(res3),\ int))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06474}06474\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06475}06475\ \ \ \ \ \textcolor{comment}{\#\ >\ bt=c()}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06476}06476\ \ \ \ \ \textcolor{comment}{\#\ >\ for(i\ in\ as.single(1:10))\ \{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06477}06477\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ for(k\ in\ as.single(2:10))\ \{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06478}06478\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \ \ \ \ bt\ =\ c(bt,\ binom.test(i-\/1,\ k*i,(1/k))\$p.value);}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06479}06479\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \ \ \ \ print(c(i+1,\ k*i,(1/k)))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06480}06480\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06481}06481\ \ \ \ \ \textcolor{comment}{\#\ +\ \}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06482}06482\ \ \ \ \ binom\_testm1\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06483}06483\ \ \ \ \ \ \ \ \ \ 0.5,\ 0.5555555555555556,\ 0.578125,\ 0.5904000000000003,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06484}06484\ \ \ \ \ \ \ \ \ \ 0.5981224279835393,\ 0.603430543396034,\ 0.607304096221924,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06485}06485\ \ \ \ \ \ \ \ \ \ 0.610255656871054,\ 0.612579511000001,\ 0.625,\ 0.670781893004115,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06486}06486\ \ \ \ \ \ \ \ \ \ 0.68853759765625,\ 0.6980101120000006,\ 0.703906431368616,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06487}06487\ \ \ \ \ \ \ \ \ \ 0.70793209416498,\ 0.7108561134173507,\ 0.713076544331419,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06488}06488\ \ \ \ \ \ \ \ \ \ 0.714820192935702,\ 0.6875,\ 0.7268709038256367,\ 0.7418963909149174,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06489}06489\ \ \ \ \ \ \ \ \ \ 0.74986110468096,\ 0.7548015520398076,\ 0.7581671424768577,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06490}06490\ \ \ \ \ \ \ \ \ \ 0.760607984787832,\ 0.762459425024199,\ 0.7639120677676575,\ 0.7265625,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06491}06491\ \ \ \ \ \ \ \ \ \ 0.761553963657302,\ 0.774800934828818,\ 0.7818005980538996,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06492}06492\ \ \ \ \ \ \ \ \ \ 0.78613491480358,\ 0.789084353140195,\ 0.7912217659828884,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06493}06493\ \ \ \ \ \ \ \ \ \ 0.79284214559524,\ 0.794112956558801,\ 0.75390625,\ 0.7856929451142176,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06494}06494\ \ \ \ \ \ \ \ \ \ 0.7976688481430754,\ 0.8039848974727624,\ 0.807891868948366,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06495}06495\ \ \ \ \ \ \ \ \ \ 0.8105487660137676,\ 0.812473307174702,\ 0.8139318233591120,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06496}06496\ \ \ \ \ \ \ \ \ \ 0.815075399104785,\ 0.7744140625,\ 0.8037322594985427,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06497}06497\ \ \ \ \ \ \ \ \ \ 0.814742863657656,\ 0.8205425178645808,\ 0.8241275984172285,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06498}06498\ \ \ \ \ \ \ \ \ \ 0.8265645374416,\ 0.8283292196088257,\ 0.829666291102775,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06499}06499\ \ \ \ \ \ \ \ \ \ 0.8307144686362666,\ 0.7905273437499996,\ 0.8178712053954738,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06500}06500\ \ \ \ \ \ \ \ \ \ 0.828116983756619,\ 0.833508948940494,\ 0.8368403871552892,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06501}06501\ \ \ \ \ \ \ \ \ \ 0.839104213210105,\ 0.840743186196171,\ 0.84198481438049,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06502}06502\ \ \ \ \ \ \ \ \ \ 0.8429580531563676,\ 0.803619384765625,\ 0.829338573944648,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06503}06503\ \ \ \ \ \ \ \ \ \ 0.8389591907548646,\ 0.84401876783902,\ 0.84714369697889,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06504}06504\ \ \ \ \ \ \ \ \ \ 0.8492667010581667,\ 0.850803474598719,\ 0.851967542858308,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06505}06505\ \ \ \ \ \ \ \ \ \ 0.8528799045949524,\ 0.8145294189453126,\ 0.838881732845347,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06506}06506\ \ \ \ \ \ \ \ \ \ 0.847979024541911,\ 0.852760894015685,\ 0.8557134656773457,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06507}06507\ \ \ \ \ \ \ \ \ \ 0.8577190131799202,\ 0.85917058278431,\ 0.860270010472127,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06508}06508\ \ \ \ \ \ \ \ \ \ 0.861131648404582,\ 0.823802947998047,\ 0.846984756807511,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06509}06509\ \ \ \ \ \ \ \ \ \ 0.855635653643743,\ 0.860180994825685,\ 0.86298688573253,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06510}06510\ \ \ \ \ \ \ \ \ \ 0.864892525675245,\ 0.866271647085603,\ 0.867316125625004,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06511}06511\ \ \ \ \ \ \ \ \ \ 0.8681346531755114}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06512}06512\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06513}06513\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06514}06514\ \ \ \ \ \textcolor{comment}{\#\ >\ bt=c()}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06515}06515\ \ \ \ \ \textcolor{comment}{\#\ >\ for(i\ in\ as.single(1:10))\ \{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06516}06516\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ for(k\ in\ as.single(2:10))\ \{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06517}06517\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \ \ \ \ bt\ =\ c(bt,\ binom.test(i+1,\ k*i,(1/k))\$p.value);}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06518}06518\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \ \ \ \ print(c(i+1,\ k*i,(1/k)))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06519}06519\ \ \ \ \ \textcolor{comment}{\#\ +\ \ \ \ \ \}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06520}06520\ \ \ \ \ \textcolor{comment}{\#\ +\ \}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06521}06521\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06522}06522\ \ \ \ \ binom\_testp1\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06523}06523\ \ \ \ \ \ \ \ \ \ 0.5,\ 0.259259259259259,\ 0.26171875,\ 0.26272,\ 0.2632244513031551,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06524}06524\ \ \ \ \ \ \ \ \ \ 0.2635138663069203,\ 0.2636951804161073,\ 0.2638162407564354,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06525}06525\ \ \ \ \ \ \ \ \ \ 0.2639010709000002,\ 0.625,\ 0.4074074074074074,\ 0.42156982421875,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06526}06526\ \ \ \ \ \ \ \ \ \ 0.4295746560000003,\ 0.43473045988554,\ 0.4383309503172684,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06527}06527\ \ \ \ \ \ \ \ \ \ 0.4409884859402103,\ 0.4430309389962837,\ 0.444649849401104,\ 0.6875,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06528}06528\ \ \ \ \ \ \ \ \ \ 0.4927602499618962,\ 0.5096031427383425,\ 0.5189636628480,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06529}06529\ \ \ \ \ \ \ \ \ \ 0.5249280070771274,\ 0.5290623300865124,\ 0.5320974248125793,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06530}06530\ \ \ \ \ \ \ \ \ \ 0.5344204730474308,\ 0.536255847400756,\ 0.7265625,\ 0.5496019313526808,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06531}06531\ \ \ \ \ \ \ \ \ \ 0.5669248746708034,\ 0.576436455045805,\ 0.5824538812831795,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06532}06532\ \ \ \ \ \ \ \ \ \ 0.5866053321547824,\ 0.589642781414643,\ 0.5919618019300193,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06533}06533\ \ \ \ \ \ \ \ \ \ 0.593790427805202,\ 0.75390625,\ 0.590868349763505,\ 0.607983393277209,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06534}06534\ \ \ \ \ \ \ \ \ \ 0.617303847446822,\ 0.623172512167948,\ 0.627208862156123,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06535}06535\ \ \ \ \ \ \ \ \ \ 0.6301556891501057,\ 0.632401894928977,\ 0.6341708982290303,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06536}06536\ \ \ \ \ \ \ \ \ \ 0.7744140625,\ 0.622562037497196,\ 0.639236102912278,\ 0.648263335014579,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06537}06537\ \ \ \ \ \ \ \ \ \ 0.65392850011132,\ 0.657816519817211,\ 0.660650782947676,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06538}06538\ \ \ \ \ \ \ \ \ \ 0.662808780346311,\ 0.6645068560246006,\ 0.7905273437499996,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06539}06539\ \ \ \ \ \ \ \ \ \ 0.6478843304312477,\ 0.6640468318879372,\ 0.6727589686071775,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06540}06540\ \ \ \ \ \ \ \ \ \ 0.6782129857784873,\ 0.681950188903695,\ 0.684671508668418,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06541}06541\ \ \ \ \ \ \ \ \ \ 0.686741824999918,\ 0.688369886732168,\ 0.803619384765625,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06542}06542\ \ \ \ \ \ \ \ \ \ 0.668716055304315,\ 0.684360013879534,\ 0.6927642396829181,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06543}06543\ \ \ \ \ \ \ \ \ \ 0.6980155964704895,\ 0.701609591890657,\ 0.7042244320992127,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06544}06544\ \ \ \ \ \ \ \ \ \ 0.7062125081341817,\ 0.707775152962577,\ 0.8145294189453126,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06545}06545\ \ \ \ \ \ \ \ \ \ 0.686243374488305,\ 0.7013873696358975,\ 0.709501223328243,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06546}06546\ \ \ \ \ \ \ \ \ \ 0.714563595144314,\ 0.718024953392931,\ 0.7205416252126137,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06547}06547\ \ \ \ \ \ \ \ \ \ 0.722454130389843,\ 0.723956813292035,\ 0.823802947998047,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06548}06548\ \ \ \ \ \ \ \ \ \ 0.701255953767043,\ 0.715928221686075,\ 0.723772209289768,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06549}06549\ \ \ \ \ \ \ \ \ \ 0.7286603031173616,\ 0.7319999279787631,\ 0.7344267920995765,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06550}06550\ \ \ \ \ \ \ \ \ \ 0.736270323773157,\ 0.737718376096348}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06551}06551\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06552}06552\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06553}06553\ \ \ \ \ res4\_p1\ =\ [stats.binomtest(v+1,\ v*k,\ 1./k).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06554}06554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ range(1,\ 11)\ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(2,\ 11)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06555}06555\ \ \ \ \ res4\_m1\ =\ [stats.binomtest(v-\/1,\ v*k,\ 1./k).pvalue}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06556}06556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ v\ \textcolor{keywordflow}{in}\ range(1,\ 11)\ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(2,\ 11)]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06557}06557\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06558}06558\ \ \ \ \ assert\_almost\_equal(res4\_p1,\ binom\_testp1,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06559}06559\ \ \ \ \ assert\_almost\_equal(res4\_m1,\ binom\_testm1,\ decimal=13)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06560}06560\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06561}06561\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06562}06562\ \textcolor{keyword}{class\ }TestTrim:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06563}06563\ \ \ \ \ \textcolor{comment}{\#\ test\ trim\ functions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06564}06564\ \ \ \ \ \textcolor{keyword}{def\ }test\_trim1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06565}06565\ \ \ \ \ \ \ \ \ a\ =\ np.arange(11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06566}06566\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trim1(a,\ 0.1)),\ np.arange(10))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06567}06567\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trim1(a,\ 0.2)),\ np.arange(9))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06568}06568\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trim1(a,\ 0.2,\ tail=\textcolor{stringliteral}{'left'})),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06569}06569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(2,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06570}06570\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trim1(a,\ 3/11.,\ tail=\textcolor{stringliteral}{'left'})),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06571}06571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(3,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06572}06572\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim1(a,\ 1.0),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06573}06573\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim1(a,\ 1.0,\ tail=\textcolor{stringliteral}{'left'}),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06574}06574\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06575}06575\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ empty\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06576}06576\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim1([],\ 0.1),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06577}06577\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim1([],\ 3/11.,\ tail=\textcolor{stringliteral}{'left'}),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06578}06578\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim1([],\ 4/6.),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06579}06579\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06580}06580\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ axis}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06581}06581\ \ \ \ \ \ \ \ \ a\ =\ np.arange(24).reshape(6,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06582}06582\ \ \ \ \ \ \ \ \ ref\ =\ np.arange(4,\ 24).reshape(5,\ 4)\ \ \textcolor{comment}{\#\ first\ row\ trimmed}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06583}06583\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06584}06584\ \ \ \ \ \ \ \ \ axis\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06585}06585\ \ \ \ \ \ \ \ \ trimmed\ =\ stats.trim1(a,\ 0.2,\ tail=\textcolor{stringliteral}{'left'},\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06586}06586\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(trimmed,\ axis=axis),\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06587}06587\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06588}06588\ \ \ \ \ \ \ \ \ axis\ =\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06589}06589\ \ \ \ \ \ \ \ \ trimmed\ =\ stats.trim1(a.T,\ 0.2,\ tail=\textcolor{stringliteral}{'left'},\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06590}06590\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(trimmed,\ axis=axis),\ ref.T)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06591}06591\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06592}06592\ \ \ \ \ \textcolor{keyword}{def\ }test\_trimboth(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06593}06593\ \ \ \ \ \ \ \ \ a\ =\ np.arange(11)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06594}06594\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trimboth(a,\ 3/11.)),\ np.arange(3,\ 8))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06595}06595\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trimboth(a,\ 0.2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06596}06596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06597}06597\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trimboth(np.arange(24).reshape(6,\ 4),\ 0.2)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06598}06598\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(4,\ 20).reshape(4,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06599}06599\ \ \ \ \ \ \ \ \ assert\_equal(np.sort(stats.trimboth(np.arange(24).reshape(4,\ 6).T,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06600}06600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2/6.)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06601}06601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([[2,\ 8,\ 14,\ 20],\ [3,\ 9,\ 15,\ 21]]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06602}06602\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.trimboth,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06603}06603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(24).reshape(4,\ 6).T,\ 4/6.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06604}06604\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06605}06605\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ empty\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06606}06606\ \ \ \ \ \ \ \ \ assert\_equal(stats.trimboth([],\ 0.1),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06607}06607\ \ \ \ \ \ \ \ \ assert\_equal(stats.trimboth([],\ 3/11.),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06608}06608\ \ \ \ \ \ \ \ \ assert\_equal(stats.trimboth([],\ 4/6.),\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06609}06609\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06610}06610\ \ \ \ \ \textcolor{keyword}{def\ }test\_trim\_mean(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06611}06611\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ don't\ use\ pre-\/sorted\ arrays}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06612}06612\ \ \ \ \ \ \ \ \ a\ =\ np.array([4,\ 8,\ 2,\ 0,\ 9,\ 5,\ 10,\ 1,\ 7,\ 3,\ 6])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06613}06613\ \ \ \ \ \ \ \ \ idx\ =\ np.array([3,\ 5,\ 0,\ 1,\ 2,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06614}06614\ \ \ \ \ \ \ \ \ a2\ =\ np.arange(24).reshape(6,\ 4)[idx,\ :]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06615}06615\ \ \ \ \ \ \ \ \ a3\ =\ np.arange(24).reshape(6,\ 4,\ order=\textcolor{stringliteral}{'F'})[idx,\ :]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06616}06616\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean(a3,\ 2/6.),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06617}06617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([2.5,\ 8.5,\ 14.5,\ 20.5]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06618}06618\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean(a2,\ 2/6.),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06619}06619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([10.,\ 11.,\ 12.,\ 13.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06620}06620\ \ \ \ \ \ \ \ \ idx4\ =\ np.array([1,\ 0,\ 3,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06621}06621\ \ \ \ \ \ \ \ \ a4\ =\ np.arange(24).reshape(4,\ 6)[idx4,\ :]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06622}06622\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean(a4,\ 2/6.),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06623}06623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.array([9.,\ 10.,\ 11.,\ 12.,\ 13.,\ 14.]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06624}06624\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ shuffled\ arange(24)\ as\ array\_like}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06625}06625\ \ \ \ \ \ \ \ \ a\ =\ [7,\ 11,\ 12,\ 21,\ 16,\ 6,\ 22,\ 1,\ 5,\ 0,\ 18,\ 10,\ 17,\ 9,\ 19,\ 15,\ 23,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06626}06626\ \ \ \ \ \ \ \ \ \ \ \ \ \ 20,\ 2,\ 14,\ 4,\ 13,\ 8,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06627}06627\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean(a,\ 2/6.),\ 11.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06628}06628\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean([5,4,3,1,2,0],\ 2/6.),\ 2.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06629}06629\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06630}06630\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ axis\ argument}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06631}06631\ \ \ \ \ \ \ \ \ np.random.seed(1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06632}06632\ \ \ \ \ \ \ \ \ a\ =\ np.random.randint(20,\ size=(5,\ 6,\ 4,\ 7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06633}06633\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ axis\ \textcolor{keywordflow}{in}\ [0,\ 1,\ 2,\ 3,\ -\/1]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06634}06634\ \ \ \ \ \ \ \ \ \ \ \ \ res1\ =\ stats.trim\_mean(a,\ 2/6.,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06635}06635\ \ \ \ \ \ \ \ \ \ \ \ \ res2\ =\ stats.trim\_mean(np.moveaxis(a,\ axis,\ 0),\ 2/6.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06636}06636\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06637}06637\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06638}06638\ \ \ \ \ \ \ \ \ res1\ =\ stats.trim\_mean(a,\ 2/6.,\ axis=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06639}06639\ \ \ \ \ \ \ \ \ res2\ =\ stats.trim\_mean(a.ravel(),\ 2/6.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06640}06640\ \ \ \ \ \ \ \ \ assert\_equal(res1,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06641}06641\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06642}06642\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.trim\_mean,\ a,\ 0.6)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06643}06643\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06644}06644\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ empty\ input}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06645}06645\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean([],\ 0.0),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06646}06646\ \ \ \ \ \ \ \ \ assert\_equal(stats.trim\_mean([],\ 0.6),\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06647}06647\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06648}06648\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06649}06649\ \textcolor{keyword}{class\ }TestSigmaClip:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06650}06650\ \ \ \ \ \textcolor{keyword}{def\ }test\_sigmaclip1(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06651}06651\ \ \ \ \ \ \ \ \ a\ =\ np.concatenate((np.linspace(9.5,\ 10.5,\ 31),\ np.linspace(0,\ 20,\ 5)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06652}06652\ \ \ \ \ \ \ \ \ fact\ =\ 4\ \ \textcolor{comment}{\#\ default}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06653}06653\ \ \ \ \ \ \ \ \ c,\ low,\ upp\ =\ stats.sigmaclip(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06654}06654\ \ \ \ \ \ \ \ \ assert\_(c.min()\ >\ low)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06655}06655\ \ \ \ \ \ \ \ \ assert\_(c.max()\ <\ upp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06656}06656\ \ \ \ \ \ \ \ \ assert\_equal(low,\ c.mean()\ -\/\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06657}06657\ \ \ \ \ \ \ \ \ assert\_equal(upp,\ c.mean()\ +\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06658}06658\ \ \ \ \ \ \ \ \ assert\_equal(c.size,\ a.size)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06659}06659\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06660}06660\ \ \ \ \ \textcolor{keyword}{def\ }test\_sigmaclip2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06661}06661\ \ \ \ \ \ \ \ \ a\ =\ np.concatenate((np.linspace(9.5,\ 10.5,\ 31),\ np.linspace(0,\ 20,\ 5)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06662}06662\ \ \ \ \ \ \ \ \ fact\ =\ 1.5}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06663}06663\ \ \ \ \ \ \ \ \ c,\ low,\ upp\ =\ stats.sigmaclip(a,\ fact,\ fact)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06664}06664\ \ \ \ \ \ \ \ \ assert\_(c.min()\ >\ low)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06665}06665\ \ \ \ \ \ \ \ \ assert\_(c.max()\ <\ upp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06666}06666\ \ \ \ \ \ \ \ \ assert\_equal(low,\ c.mean()\ -\/\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06667}06667\ \ \ \ \ \ \ \ \ assert\_equal(upp,\ c.mean()\ +\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06668}06668\ \ \ \ \ \ \ \ \ assert\_equal(c.size,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06669}06669\ \ \ \ \ \ \ \ \ assert\_equal(a.size,\ 36)\ \ \textcolor{comment}{\#\ check\ original\ array\ unchanged}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06670}06670\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06671}06671\ \ \ \ \ \textcolor{keyword}{def\ }test\_sigmaclip3(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06672}06672\ \ \ \ \ \ \ \ \ a\ =\ np.concatenate((np.linspace(9.5,\ 10.5,\ 11),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06673}06673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.linspace(-\/100,\ -\/50,\ 3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06674}06674\ \ \ \ \ \ \ \ \ fact\ =\ 1.8}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06675}06675\ \ \ \ \ \ \ \ \ c,\ low,\ upp\ =\ stats.sigmaclip(a,\ fact,\ fact)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06676}06676\ \ \ \ \ \ \ \ \ assert\_(c.min()\ >\ low)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06677}06677\ \ \ \ \ \ \ \ \ assert\_(c.max()\ <\ upp)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06678}06678\ \ \ \ \ \ \ \ \ assert\_equal(low,\ c.mean()\ -\/\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06679}06679\ \ \ \ \ \ \ \ \ assert\_equal(upp,\ c.mean()\ +\ fact*c.std())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06680}06680\ \ \ \ \ \ \ \ \ assert\_equal(c,\ np.linspace(9.5,\ 10.5,\ 11))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06681}06681\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06682}06682\ \ \ \ \ \textcolor{keyword}{def\ }test\_sigmaclip\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06683}06683\ \ \ \ \ \ \ \ \ a\ =\ np.concatenate((np.linspace(9.5,\ 10.5,\ 11),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06684}06684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.linspace(-\/100,\ -\/50,\ 3)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06685}06685\ \ \ \ \ \ \ \ \ fact\ =\ 1.8}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06686}06686\ \ \ \ \ \ \ \ \ res\ =\ stats.sigmaclip(a,\ fact,\ fact)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06687}06687\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'clipped'},\ \textcolor{stringliteral}{'lower'},\ \textcolor{stringliteral}{'upper'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06688}06688\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06689}06689\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06690}06690\ \ \ \ \ \textcolor{keyword}{def\ }test\_std\_zero(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06691}06691\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ regression\ test\ \#8632}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06692}06692\ \ \ \ \ \ \ \ \ x\ =\ np.ones(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06693}06693\ \ \ \ \ \ \ \ \ assert\_equal(stats.sigmaclip(x)[0],\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06694}06694\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06695}06695\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06696}06696\ \textcolor{keyword}{class\ }TestAlexanderGovern:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06697}06697\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_dtypes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06698}06698\ \ \ \ \ \ \ \ \ args\ =\ [[13,\ 13,\ 13,\ 13,\ 13,\ 13,\ 13,\ 12,\ 12],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06699}06699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [14,\ 13,\ 12,\ 12,\ 12,\ 12,\ 12,\ 11,\ 11],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06700}06700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [14,\ 14,\ 13,\ 13,\ 13,\ 13,\ 13,\ 12,\ 12],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06701}06701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [15,\ 14,\ 13,\ 13,\ 13,\ 12,\ 12,\ 12,\ 11]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06702}06702\ \ \ \ \ \ \ \ \ args\_int16\ =\ np.array(args,\ dtype=np.int16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06703}06703\ \ \ \ \ \ \ \ \ args\_int32\ =\ np.array(args,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06704}06704\ \ \ \ \ \ \ \ \ args\_uint8\ =\ np.array(args,\ dtype=np.uint8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06705}06705\ \ \ \ \ \ \ \ \ args\_float64\ =\ np.array(args,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06706}06706\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06707}06707\ \ \ \ \ \ \ \ \ res\_int16\ =\ stats.alexandergovern(*args\_int16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06708}06708\ \ \ \ \ \ \ \ \ res\_int32\ =\ stats.alexandergovern(*args\_int32)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06709}06709\ \ \ \ \ \ \ \ \ res\_unit8\ =\ stats.alexandergovern(*args\_uint8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06710}06710\ \ \ \ \ \ \ \ \ res\_float64\ =\ stats.alexandergovern(*args\_float64)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06711}06711\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06712}06712\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (res\_int16.pvalue\ ==\ res\_int32.pvalue\ ==}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06713}06713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_unit8.pvalue\ ==\ res\_float64.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06714}06714\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (res\_int16.statistic\ ==\ res\_int32.statistic\ ==}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06715}06715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res\_unit8.statistic\ ==\ res\_float64.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06716}06716\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06717}06717\ \ \ \ \ \textcolor{keyword}{def\ }test\_bad\_inputs(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06718}06718\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ input\ array\ is\ of\ size\ zero}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06719}06719\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Input\ sample\ size\ must\ be"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06720}06720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ greater\ than\ one."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06721}06721\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern([1,\ 2],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06722}06722\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ input\ is\ a\ singular\ non\ list\ element}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06723}06723\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Input\ sample\ size\ must\ be"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06724}06724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ greater\ than\ one."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06725}06725\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern([1,\ 2],\ 2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06726}06726\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ input\ list\ is\ of\ size\ 1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06727}06727\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Input\ sample\ size\ must\ be"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06728}06728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ greater\ than\ one."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06729}06729\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern([1,\ 2],\ [2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06730}06730\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ inputs\ are\ not\ finite\ (infinity)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06731}06731\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Input\ samples\ must\ be\ finite."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06732}06732\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern([1,\ 2],\ [np.inf,\ np.inf])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06733}06733\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ inputs\ are\ multidimensional}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06734}06734\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Input\ samples\ must\ be\ one"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06735}06735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/dimensional"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06736}06736\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern([1,\ 2],\ [[1,\ 2],\ [3,\ 4]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06737}06737\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06738}06738\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_r(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06739}06739\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06740}06740\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Data\ generated\ in\ R\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06741}06741\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ set.seed(1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06742}06742\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}onewaytests"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06743}06743\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}tibble"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06744}06744\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ y\ <-\/\ c(rnorm(40,\ sd=10),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06745}06745\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ rnorm(30,\ sd=15),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06746}06746\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ rnorm(20,\ sd=20))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06747}06747\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x\ <-\/\ c(rep("{}one"{},\ times=40),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06748}06748\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ rep("{}two"{},\ times=30),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06749}06749\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ rep("{}eight"{},\ times=20))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06750}06750\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x\ <-\/\ factor(x)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06751}06751\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ ag.test(y\ \string~\ x,\ tibble(y,x))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06752}06752\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06753}06753\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alexander-\/Govern\ Test\ (alpha\ =\ 0.05)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06754}06754\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06755}06755\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ :\ y\ and\ x}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06756}06756\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06757}06757\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ \ :\ 1.359941}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06758}06758\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parameter\ \ :\ 2}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06759}06759\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p.value\ \ \ \ :\ 0.5066321}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06760}06760\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06761}06761\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Result\ \ \ \ \ :\ Difference\ is\ not\ statistically\ significant.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06762}06762\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06763}06763\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Example\ adapted\ from:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06764}06764\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://eval-\/serv2.metpsy.uni-\/jena.de/wiki-\/metheval-\/hp/index.php/R\_FUN\_Alexander-\/Govern}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06765}06765\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06766}06766\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06767}06767\ \ \ \ \ \ \ \ \ one\ =\ [-\/6.264538107423324,\ 1.8364332422208225,\ -\/8.356286124100471,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06768}06768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 15.952808021377916,\ 3.295077718153605,\ -\/8.204683841180152,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06769}06769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4.874290524284853,\ 7.383247051292173,\ 5.757813516534923,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06770}06770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/3.0538838715635603,\ 15.11781168450848,\ 3.898432364114311,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06771}06771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/6.2124058054180376,\ -\/22.146998871774997,\ 11.249309181431082,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06772}06772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.4493360901523085,\ -\/0.16190263098946087,\ 9.438362106852992,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06773}06773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8.212211950980885,\ 5.939013212175088,\ 9.189773716082183,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06774}06774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 7.821363007310671,\ 0.745649833651906,\ -\/19.89351695863373,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06775}06775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 6.198257478947102,\ -\/0.5612873952900078,\ -\/1.557955067053293,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06776}06776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/14.707523838992744,\ -\/4.781500551086204,\ 4.179415601997024,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06777}06777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 13.58679551529044,\ -\/1.0278772734299553,\ 3.876716115593691,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06778}06778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.5380504058290512,\ -\/13.770595568286065,\ -\/4.149945632996798,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06779}06779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/3.942899537103493,\ -\/0.5931339671118566,\ 11.000253719838831,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06780}06780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 7.631757484575442]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06781}06781\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06782}06782\ \ \ \ \ \ \ \ \ two\ =\ [-\/2.4678539438038034,\ -\/3.8004252020476135,\ 10.454450631071062,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06783}06783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8.34994798010486,\ -\/10.331335418242798,\ -\/10.612427354431794,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06784}06784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 5.468729432052455,\ 11.527993867731237,\ -\/1.6851931822534207,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06785}06785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 13.216615896813222,\ 5.971588205506021,\ -\/9.180395898761569,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06786}06786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 5.116795371366372,\ -\/16.94044644121189,\ 21.495355525515556,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06787}06787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 29.7059984775879,\ -\/5.508322146997636,\ -\/15.662019394747961,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06788}06788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8.545794411636193,\ -\/2.0258190582123654,\ 36.024266407571645,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06789}06789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.5886000409975387,\ 10.346090436761651,\ 0.4200323817099909,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06790}06790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/11.14909813323608,\ 2.8318844927151434,\ -\/27.074379433365568,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06791}06791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 21.98332292344329,\ 2.2988000731784655,\ 32.58917505543229]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06792}06792\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06793}06793\ \ \ \ \ \ \ \ \ eight\ =\ [9.510190577993251,\ -\/14.198928618436291,\ 12.214527069781099,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06794}06794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/18.68195263288503,\ -\/25.07266800478204,\ 5.828924710349257,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06795}06795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/8.86583746436866,\ 0.02210703263248262,\ 1.4868264830332811,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06796}06796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/11.79041892376144,\ -\/11.37337465637004,\ -\/2.7035723024766414,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06797}06797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 23.56173993146409,\ -\/30.47133600859524,\ 11.878923752568431,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06798}06798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 6.659007424270365,\ 21.261996745527256,\ -\/6.083678472686013,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06799}06799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 7.400376198325763,\ 5.341975815444621]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06800}06800\ \ \ \ \ \ \ \ \ soln\ =\ stats.alexandergovern(one,\ two,\ eight)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06801}06801\ \ \ \ \ \ \ \ \ assert\_allclose(soln.statistic,\ 1.3599405447999450836)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06802}06802\ \ \ \ \ \ \ \ \ assert\_allclose(soln.pvalue,\ 0.50663205309676440091)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06803}06803\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06804}06804\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_scholar(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06805}06805\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06806}06806\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Data\ taken\ from\ 'The\ Modification\ and\ Evaluation\ of\ the}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06807}06807\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alexander-\/Govern\ Test\ in\ Terms\ of\ Power'\ by\ Kingsley\ Ochuko,\ T.,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06808}06808\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Abdullah,\ S.,\ Binti\ Zain,\ Z.,\ \&\ Soaad\ Syed\ Yahaya,\ S.\ (2015).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06809}06809\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06810}06810\ \ \ \ \ \ \ \ \ young\ =\ [482.43,\ 484.36,\ 488.84,\ 495.15,\ 495.24,\ 502.69,\ 504.62,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06811}06811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 518.29,\ 519.1,\ 524.1,\ 524.12,\ 531.18,\ 548.42,\ 572.1,\ 584.68,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06812}06812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 609.09,\ 609.53,\ 666.63,\ 676.4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06813}06813\ \ \ \ \ \ \ \ \ middle\ =\ [335.59,\ 338.43,\ 353.54,\ 404.27,\ 437.5,\ 469.01,\ 485.85,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06814}06814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 487.3,\ 493.08,\ 494.31,\ 499.1,\ 886.41]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06815}06815\ \ \ \ \ \ \ \ \ old\ =\ [519.01,\ 528.5,\ 530.23,\ 536.03,\ 538.56,\ 538.83,\ 557.24,\ 558.61,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06816}06816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 558.95,\ 565.43,\ 586.39,\ 594.69,\ 629.22,\ 645.69,\ 691.84]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06817}06817\ \ \ \ \ \ \ \ \ soln\ =\ stats.alexandergovern(young,\ middle,\ old)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06818}06818\ \ \ \ \ \ \ \ \ assert\_allclose(soln.statistic,\ 5.3237,\ atol=1e-\/3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06819}06819\ \ \ \ \ \ \ \ \ assert\_allclose(soln.pvalue,\ 0.06982,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06820}06820\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06821}06821\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ verify\ with\ ag.test\ in\ r}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06822}06822\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06823}06823\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}onewaytests"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06824}06824\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}tibble"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06825}06825\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ young\ <-\/\ c(482.43,\ 484.36,\ 488.84,\ 495.15,\ 495.24,\ 502.69,\ 504.62,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06826}06826\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 518.29,\ 519.1,\ 524.1,\ 524.12,\ 531.18,\ 548.42,\ 572.1,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06827}06827\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 584.68,\ 609.09,\ 609.53,\ 666.63,\ 676.4)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06828}06828\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ middle\ <-\/\ c(335.59,\ 338.43,\ 353.54,\ 404.27,\ 437.5,\ 469.01,\ 485.85,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06829}06829\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 487.3,\ 493.08,\ 494.31,\ 499.1,\ 886.41)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06830}06830\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ old\ <-\/\ c(519.01,\ 528.5,\ 530.23,\ 536.03,\ 538.56,\ 538.83,\ 557.24,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06831}06831\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 558.61,\ 558.95,\ 565.43,\ 586.39,\ 594.69,\ 629.22,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06832}06832\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 645.69,\ 691.84)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06833}06833\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ young\_fct\ <-\/\ c(rep("{}young"{},\ times=19))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06834}06834\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ middle\_fct\ <-\/c(rep("{}middle"{},\ times=12))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06835}06835\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ old\_fct\ <-\/\ c(rep("{}old"{},\ times=15))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06836}06836\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ ag.test(a\ \string~\ b,\ tibble(a=c(young,\ middle,\ old),\ b=factor(c(young\_fct,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06837}06837\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ middle\_fct,\ old\_fct))))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06838}06838\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06839}06839\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alexander-\/Govern\ Test\ (alpha\ =\ 0.05)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06840}06840\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06841}06841\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ :\ a\ and\ b}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06842}06842\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06843}06843\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ \ :\ 5.324629}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06844}06844\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parameter\ \ :\ 2}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06845}06845\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p.value\ \ \ \ :\ 0.06978651}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06846}06846\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06847}06847\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Result\ \ \ \ \ :\ Difference\ is\ not\ statistically\ significant.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06848}06848\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06849}06849\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06850}06850\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06851}06851\ \ \ \ \ \ \ \ \ assert\_allclose(soln.statistic,\ 5.324629)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06852}06852\ \ \ \ \ \ \ \ \ assert\_allclose(soln.pvalue,\ 0.06978651)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06853}06853\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06854}06854\ \ \ \ \ \textcolor{keyword}{def\ }test\_compare\_scholar3(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06855}06855\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06856}06856\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Data\ taken\ from\ 'Robustness\ And\ Comparative\ Power\ Of\ WelchAspin,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06857}06857\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alexander-\/Govern\ And\ Yuen\ Tests\ Under\ Non-\/Normality\ And\ Variance}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06858}06858\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Heteroscedasticity',\ by\ Ayed\ A.\ Almoied.\ 2017.\ Page\ 34-\/37.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06859}06859\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=2775\&context=oa\_dissertations}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06860}06860\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06861}06861\ \ \ \ \ \ \ \ \ x1\ =\ [-\/1.77559,\ -\/1.4113,\ -\/0.69457,\ -\/0.54148,\ -\/0.18808,\ -\/0.07152,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06862}06862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.04696,\ 0.051183,\ 0.148695,\ 0.168052,\ 0.422561,\ 0.458555,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06863}06863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.616123,\ 0.709968,\ 0.839956,\ 0.857226,\ 0.929159,\ 0.981442,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06864}06864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.999554,\ 1.642958]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06865}06865\ \ \ \ \ \ \ \ \ x2\ =\ [-\/1.47973,\ -\/1.2722,\ -\/0.91914,\ -\/0.80916,\ -\/0.75977,\ -\/0.72253,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06866}06866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.3601,\ -\/0.33273,\ -\/0.28859,\ -\/0.09637,\ -\/0.08969,\ -\/0.01824,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06867}06867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.260131,\ 0.289278,\ 0.518254,\ 0.683003,\ 0.877618,\ 1.172475,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06868}06868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.33964,\ 1.576766]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06869}06869\ \ \ \ \ \ \ \ \ soln\ =\ stats.alexandergovern(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06870}06870\ \ \ \ \ \ \ \ \ assert\_allclose(soln.statistic,\ 0.713526,\ atol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06871}06871\ \ \ \ \ \ \ \ \ assert\_allclose(soln.pvalue,\ 0.398276,\ atol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06872}06872\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06873}06873\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06874}06874\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tested\ in\ ag.test\ in\ R:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06875}06875\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}onewaytests"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06876}06876\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ library("{}tibble"{})}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06877}06877\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x1\ <-\/\ c(-\/1.77559,\ -\/1.4113,\ -\/0.69457,\ -\/0.54148,\ -\/0.18808,\ -\/0.07152,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06878}06878\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ 0.04696,\ 0.051183,\ 0.148695,\ 0.168052,\ 0.422561,\ 0.458555,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06879}06879\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ 0.616123,\ 0.709968,\ 0.839956,\ 0.857226,\ 0.929159,\ 0.981442,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06880}06880\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ \ 0.999554,\ 1.642958)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06881}06881\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x2\ <-\/\ c(-\/1.47973,\ -\/1.2722,\ -\/0.91914,\ -\/0.80916,\ -\/0.75977,\ -\/0.72253,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06882}06882\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ -\/0.3601,\ -\/0.33273,\ -\/0.28859,\ -\/0.09637,\ -\/0.08969,\ -\/0.01824,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06883}06883\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ 0.260131,\ 0.289278,\ 0.518254,\ 0.683003,\ 0.877618,\ 1.172475,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06884}06884\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ +\ \ \ \ \ \ \ \ \ 1.33964,\ 1.576766)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06885}06885\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x1\_fact\ <-\/\ c(rep("{}x1"{},\ times=20))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06886}06886\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ x2\_fact\ <-\/\ c(rep("{}x2"{},\ times=20))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06887}06887\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ a\ <-\/\ c(x1,\ x2)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06888}06888\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ b\ <-\/\ factor(c(x1\_fact,\ x2\_fact))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06889}06889\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >\ ag.test(a\ \string~\ b,\ tibble(a,\ b))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06890}06890\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alexander-\/Govern\ Test\ (alpha\ =\ 0.05)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06891}06891\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06892}06892\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ :\ a\ and\ b}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06893}06893\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06894}06894\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ \ :\ 0.7135182}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06895}06895\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parameter\ \ :\ 1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06896}06896\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p.value\ \ \ \ :\ 0.3982783}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06897}06897\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06898}06898\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Result\ \ \ \ \ :\ Difference\ is\ not\ statistically\ significant.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06899}06899\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06900}06900\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06901}06901\ \ \ \ \ \ \ \ \ assert\_allclose(soln.statistic,\ 0.7135182)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06902}06902\ \ \ \ \ \ \ \ \ assert\_allclose(soln.pvalue,\ 0.3982783)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06903}06903\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06904}06904\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_propogate(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06905}06905\ \ \ \ \ \ \ \ \ args\ =\ [[1,\ 2,\ 3,\ 4],\ [1,\ np.nan]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06906}06906\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ default\ nan\_policy\ is\ 'propagate'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06907}06907\ \ \ \ \ \ \ \ \ res\ =\ stats.alexandergovern(*args)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06908}06908\ \ \ \ \ \ \ \ \ assert\_equal(res.pvalue,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06909}06909\ \ \ \ \ \ \ \ \ assert\_equal(res.statistic,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06910}06910\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06911}06911\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_raise(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06912}06912\ \ \ \ \ \ \ \ \ args\ =\ [[1,\ 2,\ 3,\ 4],\ [1,\ np.nan]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06913}06913\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}The\ input\ contains\ nan\ values"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06914}06914\ \ \ \ \ \ \ \ \ \ \ \ \ stats.alexandergovern(*args,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06915}06915\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06916}06916\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy\_omit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06917}06917\ \ \ \ \ \ \ \ \ args\_nan\ =\ [[1,\ 2,\ 3,\ \textcolor{keywordtype}{None},\ 4],\ [1,\ np.nan,\ 19,\ 25]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06918}06918\ \ \ \ \ \ \ \ \ args\_no\_nan\ =\ [[1,\ 2,\ 3,\ 4],\ [1,\ 19,\ 25]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06919}06919\ \ \ \ \ \ \ \ \ res\_nan\ =\ stats.alexandergovern(*args\_nan,\ nan\_policy=\textcolor{stringliteral}{'omit'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06920}06920\ \ \ \ \ \ \ \ \ res\_no\_nan\ =\ stats.alexandergovern(*args\_no\_nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06921}06921\ \ \ \ \ \ \ \ \ assert\_equal(res\_nan.pvalue,\ res\_no\_nan.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06922}06922\ \ \ \ \ \ \ \ \ assert\_equal(res\_nan.statistic,\ res\_no\_nan.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06923}06923\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06924}06924\ \ \ \ \ \textcolor{keyword}{def\ }test\_constant\_input(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06925}06925\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Zero\ variance\ input,\ consistent\ with\ \`{}stats.pearsonr`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06926}06926\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}An\ input\ array\ is\ constant;\ the\ statistic\ is\ not\ defined."{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06927}06927\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06928}06928\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.alexandergovern([0.667,\ 0.667,\ 0.667],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06929}06929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.123,\ 0.456,\ 0.789])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06930}06930\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res.statistic,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06931}06931\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(res.pvalue,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06932}06932\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06933}06933\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06934}06934\ \textcolor{keyword}{class\ }TestFOneWay:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06935}06935\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06936}06936\ \ \ \ \ \textcolor{keyword}{def\ }test\_trivial(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06937}06937\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ trivial\ test\ of\ stats.f\_oneway,\ with\ F=0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06938}06938\ \ \ \ \ \ \ \ \ F,\ p\ =\ stats.f\_oneway([0,\ 2],\ [0,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06939}06939\ \ \ \ \ \ \ \ \ assert\_equal(F,\ 0.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06940}06940\ \ \ \ \ \ \ \ \ assert\_equal(p,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06941}06941\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06942}06942\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06943}06943\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Despite\ being\ a\ floating\ point\ calculation,\ this\ data\ should}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06944}06944\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ result\ in\ F\ being\ exactly\ 2.0.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06945}06945\ \ \ \ \ \ \ \ \ F,\ p\ =\ stats.f\_oneway([0,\ 2],\ [2,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06946}06946\ \ \ \ \ \ \ \ \ assert\_equal(F,\ 2.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06947}06947\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ 1\ -\/\ np.sqrt(0.5),\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06948}06948\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06949}06949\ \ \ \ \ \textcolor{keyword}{def\ }test\_known\_exact(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06950}06950\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Another\ trivial\ dataset\ for\ which\ the\ exact\ F\ and\ p\ can\ be}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06951}06951\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ calculated.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06952}06952\ \ \ \ \ \ \ \ \ F,\ p\ =\ stats.f\_oneway([2],\ [2],\ [2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06953}06953\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ use\ of\ assert\_equal\ might\ be\ too\ optimistic,\ but\ the\ calculation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06954}06954\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ this\ case\ is\ trivial\ enough\ that\ it\ is\ likely\ to\ go\ through\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06955}06955\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ no\ loss\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06956}06956\ \ \ \ \ \ \ \ \ assert\_equal(F,\ 3/5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06957}06957\ \ \ \ \ \ \ \ \ assert\_equal(p,\ 5/8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06958}06958\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06959}06959\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_integer\_array(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06960}06960\ \ \ \ \ \ \ \ \ a\ =\ np.array([655,\ 788],\ dtype=np.uint16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06961}06961\ \ \ \ \ \ \ \ \ b\ =\ np.array([789,\ 772],\ dtype=np.uint16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06962}06962\ \ \ \ \ \ \ \ \ F,\ p\ =\ stats.f\_oneway(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06963}06963\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ expected\ value\ was\ verified\ by\ computing\ it\ with\ mpmath\ with}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06964}06964\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 40\ digits\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06965}06965\ \ \ \ \ \ \ \ \ assert\_allclose(F,\ 0.77450216931805540,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06966}06966\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06967}06967\ \ \ \ \ \textcolor{keyword}{def\ }test\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06968}06968\ \ \ \ \ \ \ \ \ a\ =\ np.array([655,\ 788],\ dtype=np.uint16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06969}06969\ \ \ \ \ \ \ \ \ b\ =\ np.array([789,\ 772],\ dtype=np.uint16)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06970}06970\ \ \ \ \ \ \ \ \ res\ =\ stats.f\_oneway(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06971}06971\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06972}06972\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06973}06973\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06974}06974\ \ \ \ \ \textcolor{keyword}{def\ }test\_nist(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06975}06975\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ These\ are\ the\ nist\ ANOVA\ files.\ They\ can\ be\ found\ at:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06976}06976\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.itl.nist.gov/div898/strd/anova/anova.html}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06977}06977\ \ \ \ \ \ \ \ \ filenames\ =\ [\textcolor{stringliteral}{'SiRstv.dat'},\ \textcolor{stringliteral}{'SmLs01.dat'},\ \textcolor{stringliteral}{'SmLs02.dat'},\ \textcolor{stringliteral}{'SmLs03.dat'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06978}06978\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'AtmWtAg.dat'},\ \textcolor{stringliteral}{'SmLs04.dat'},\ \textcolor{stringliteral}{'SmLs05.dat'},\ \textcolor{stringliteral}{'SmLs06.dat'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06979}06979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'SmLs07.dat'},\ \textcolor{stringliteral}{'SmLs08.dat'},\ \textcolor{stringliteral}{'SmLs09.dat'}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06980}06980\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06981}06981\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ test\_case\ \textcolor{keywordflow}{in}\ filenames:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06982}06982\ \ \ \ \ \ \ \ \ \ \ \ \ rtol\ =\ 1e-\/7}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06983}06983\ \ \ \ \ \ \ \ \ \ \ \ \ fname\ =\ os.path.abspath(os.path.join(os.path.dirname(\_\_file\_\_),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06984}06984\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'data/nist\_anova'},\ test\_case))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06985}06985\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(fname)\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06986}06986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ content\ =\ f.read().split(\textcolor{stringliteral}{'\(\backslash\)n'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06987}06987\ \ \ \ \ \ \ \ \ \ \ \ \ certified\ =\ [line.split()\ \textcolor{keywordflow}{for}\ line\ \textcolor{keywordflow}{in}\ content[40:48]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06988}06988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ line.strip()]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06989}06989\ \ \ \ \ \ \ \ \ \ \ \ \ dataf\ =\ np.loadtxt(fname,\ skiprows=60)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06990}06990\ \ \ \ \ \ \ \ \ \ \ \ \ y,\ x\ =\ dataf.T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06991}06991\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ y.astype(int)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06992}06992\ \ \ \ \ \ \ \ \ \ \ \ \ caty\ =\ np.unique(y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06993}06993\ \ \ \ \ \ \ \ \ \ \ \ \ f\ =\ float(certified[0][-\/1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06994}06994\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06995}06995\ \ \ \ \ \ \ \ \ \ \ \ \ xlist\ =\ [x[y\ ==\ i]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ caty]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06996}06996\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ stats.f\_oneway(*xlist)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06997}06997\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06998}06998\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ With\ the\ hard\ test\ cases\ we\ relax\ the\ tolerance\ a\ bit.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l06999}06999\ \ \ \ \ \ \ \ \ \ \ \ \ hard\_tc\ =\ (\textcolor{stringliteral}{'SmLs07.dat'},\ \textcolor{stringliteral}{'SmLs08.dat'},\ \textcolor{stringliteral}{'SmLs09.dat'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07000}07000\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ test\_case\ \textcolor{keywordflow}{in}\ hard\_tc:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07001}07001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rtol\ =\ 1e-\/4}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07002}07002\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07003}07003\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res[0],\ f,\ rtol=rtol,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07004}07004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg=\textcolor{stringliteral}{'Failing\ testcase:\ \%s'}\ \%\ test\_case)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07005}07005\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07006}07006\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}a,\ b,\ expected"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07007}07007\ \ \ \ \ \ \ \ \ (np.array([42,\ 42,\ 42]),\ np.array([7,\ 7,\ 7]),\ (np.inf,\ 0)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07008}07008\ \ \ \ \ \ \ \ \ (np.array([42,\ 42,\ 42]),\ np.array([42,\ 42,\ 42]),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07009}07009\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07010}07010\ \ \ \ \ \textcolor{keyword}{def\ }test\_constant\_input(self,\ a,\ b,\ expected):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07011}07011\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ more\ details,\ look\ on\ https://github.com/scipy/scipy/issues/11669}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07012}07012\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Each\ of\ the\ input\ arrays\ is\ constant;"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07013}07013\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07014}07014\ \ \ \ \ \ \ \ \ \ \ \ \ f,\ p\ =\ stats.f\_oneway(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07015}07015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ f,\ p\ ==\ expected}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07016}07016\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07017}07017\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('axis',\ [-\/2,\ -\/1,\ 0,\ 1])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07018}07018\ \ \ \ \ \textcolor{keyword}{def\ }test\_2d\_inputs(self,\ axis):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07019}07019\ \ \ \ \ \ \ \ \ a\ =\ np.array([[1,\ 4,\ 3,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07020}07020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2,\ 5,\ 3,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07021}07021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 6,\ 3,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07022}07022\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2,\ 3,\ 3,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07023}07023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 4,\ 3,\ 3]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07024}07024\ \ \ \ \ \ \ \ \ b\ =\ np.array([[3,\ 1,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07025}07025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 6,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07026}07026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 3,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07027}07027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 5,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07028}07028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 5,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07029}07029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2,\ 3,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07030}07030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [8,\ 2,\ 5,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07031}07031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2,\ 2,\ 5,\ 3]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07032}07032\ \ \ \ \ \ \ \ \ c\ =\ np.array([[4,\ 3,\ 4,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07033}07033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 2,\ 4,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07034}07034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 4,\ 4,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07035}07035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 4,\ 4,\ 3]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07036}07036\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07037}07037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ \textcolor{keywordflow}{in}\ [-\/1,\ 1]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07038}07038\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ a.T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07039}07039\ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ b.T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07040}07040\ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ c.T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07041}07041\ \ \ \ \ \ \ \ \ \ \ \ \ take\_axis\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07042}07042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07043}07043\ \ \ \ \ \ \ \ \ \ \ \ \ take\_axis\ =\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07044}07044\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07045}07045\ \ \ \ \ \ \ \ \ warn\_msg\ =\ \textcolor{stringliteral}{"{}Each\ of\ the\ input\ arrays\ is\ constant;"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07046}07046\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=warn\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07047}07047\ \ \ \ \ \ \ \ \ \ \ \ \ f,\ p\ =\ stats.f\_oneway(a,\ b,\ c,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07048}07048\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07049}07049\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Verify\ that\ the\ result\ computed\ with\ the\ 2d\ arrays\ matches}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07050}07050\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ result\ of\ calling\ f\_oneway\ individually\ on\ each\ slice.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07051}07051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ [0,\ 1]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07052}07052\ \ \ \ \ \ \ \ \ \ \ \ \ fj,\ pj\ =\ stats.f\_oneway(np.take(a,\ j,\ take\_axis),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07053}07053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.take(b,\ j,\ take\_axis),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07054}07054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.take(c,\ j,\ take\_axis))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07055}07055\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(f[j],\ fj,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07056}07056\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(p[j],\ pj,\ rtol=1e-\/14)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07057}07057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ [2,\ 3]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07058}07058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1ConstantInputWarning}{stats.ConstantInputWarning}},\ match=warn\_msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07059}07059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fj,\ pj\ =\ stats.f\_oneway(np.take(a,\ j,\ take\_axis),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07060}07060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.take(b,\ j,\ take\_axis),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07061}07061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.take(c,\ j,\ take\_axis))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07062}07062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(f[j],\ fj)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07063}07063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p[j],\ pj)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07064}07064\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07065}07065\ \ \ \ \ \textcolor{keyword}{def\ }test\_3d\_inputs(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07066}07066\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Some\ 3-\/d\ arrays.\ (There\ is\ nothing\ special\ about\ the\ values.)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07067}07067\ \ \ \ \ \ \ \ \ a\ =\ 1/np.arange(1.0,\ 4*5*7\ +\ 1).reshape(4,\ 5,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07068}07068\ \ \ \ \ \ \ \ \ b\ =\ 2/np.arange(1.0,\ 4*8*7\ +\ 1).reshape(4,\ 8,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07069}07069\ \ \ \ \ \ \ \ \ c\ =\ np.cos(1/np.arange(1.0,\ 4*4*7\ +\ 1).reshape(4,\ 4,\ 7))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07070}07070\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07071}07071\ \ \ \ \ \ \ \ \ f,\ p\ =\ stats.f\_oneway(a,\ b,\ c,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07072}07072\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07073}07073\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ f.shape\ ==\ (4,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07074}07074\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ p.shape\ ==\ (4,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07075}07075\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07076}07076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(a.shape[0]):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07077}07077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(a.shape[2]):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07078}07078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fij,\ pij\ =\ stats.f\_oneway(a[i,\ :,\ j],\ b[i,\ :,\ j],\ c[i,\ :,\ j])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07079}07079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(fij,\ f[i,\ j])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07080}07080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(pij,\ p[i,\ j])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07081}07081\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07082}07082\ \ \ \ \ \textcolor{keyword}{def\ }test\_length0\_1d\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07083}07083\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Require\ at\ least\ one\ value\ in\ each\ group.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07084}07084\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{'all\ input\ arrays\ have\ length\ 1.'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07085}07085\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1DegenerateDataWarning}{stats.DegenerateDataWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07086}07086\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ stats.f\_oneway([1,\ 2,\ 3],\ [],\ [4,\ 5,\ 6,\ 7])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07087}07087\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(result,\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07088}07088\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07089}07089\ \ \ \ \ \textcolor{keyword}{def\ }test\_length0\_2d\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07090}07090\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{'all\ input\ arrays\ have\ length\ 1.'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07091}07091\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1DegenerateDataWarning}{stats.DegenerateDataWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07092}07092\ \ \ \ \ \ \ \ \ \ \ \ \ ncols\ =\ 3}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07093}07093\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ np.ones((4,\ ncols))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07094}07094\ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ np.ones((0,\ ncols))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07095}07095\ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ np.ones((5,\ ncols))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07096}07096\ \ \ \ \ \ \ \ \ \ \ \ \ f,\ p\ =\ stats.f\_oneway(a,\ b,\ c)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07097}07097\ \ \ \ \ \ \ \ \ \ \ \ \ nans\ =\ np.full((ncols,),\ fill\_value=np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07098}07098\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(f,\ nans)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07099}07099\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(p,\ nans)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07100}07100\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07101}07101\ \ \ \ \ \textcolor{keyword}{def\ }test\_all\_length\_one(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07102}07102\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{'all\ input\ arrays\ have\ length\ 1.'}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07103}07103\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_warns(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1DegenerateDataWarning}{stats.DegenerateDataWarning}},\ match=msg):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07104}07104\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ stats.f\_oneway([10],\ [11],\ [12],\ [13])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07105}07105\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(result,\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07106}07106\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07107}07107\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('args',\ [()},\ ([1,\ 2,\ 3],)])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07108}07108\ \ \ \ \ \textcolor{keyword}{def\ }test\_too\_few\_inputs(self,\ args):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07109}07109\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(TypeError):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07110}07110\ \ \ \ \ \ \ \ \ \ \ \ \ stats.f\_oneway(*args)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07111}07111\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07112}07112\ \ \ \ \ \textcolor{keyword}{def\ }test\_axis\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07113}07113\ \ \ \ \ \ \ \ \ a\ =\ np.ones((3,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07114}07114\ \ \ \ \ \ \ \ \ b\ =\ np.ones((5,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07115}07115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(np.AxisError):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07116}07116\ \ \ \ \ \ \ \ \ \ \ \ \ stats.f\_oneway(a,\ b,\ axis=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07117}07117\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07118}07118\ \ \ \ \ \textcolor{keyword}{def\ }test\_bad\_shapes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07119}07119\ \ \ \ \ \ \ \ \ a\ =\ np.ones((3,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07120}07120\ \ \ \ \ \ \ \ \ b\ =\ np.ones((5,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07121}07121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07122}07122\ \ \ \ \ \ \ \ \ \ \ \ \ stats.f\_oneway(a,\ b,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07123}07123\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07124}07124\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07125}07125\ \textcolor{keyword}{class\ }TestKruskal:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07126}07126\ \ \ \ \ \textcolor{keyword}{def\ }test\_simple(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07127}07127\ \ \ \ \ \ \ \ \ x\ =\ [1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07128}07128\ \ \ \ \ \ \ \ \ y\ =\ [2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07129}07129\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07130}07130\ \ \ \ \ \ \ \ \ assert\_equal(h,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07131}07131\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ stats.distributions.chi2.sf(h,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07132}07132\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(np.array(x),\ np.array(y))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07133}07133\ \ \ \ \ \ \ \ \ assert\_equal(h,\ 1.0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07134}07134\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ stats.distributions.chi2.sf(h,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07135}07135\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07136}07136\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07137}07137\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 3,\ 5,\ 7,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07138}07138\ \ \ \ \ \ \ \ \ y\ =\ [2,\ 4,\ 6,\ 8,\ 10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07139}07139\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07140}07140\ \ \ \ \ \ \ \ \ assert\_approx\_equal(h,\ 3./11,\ significant=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07141}07141\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ stats.distributions.chi2.sf(3./11,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07142}07142\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(np.array(x),\ np.array(y))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07143}07143\ \ \ \ \ \ \ \ \ assert\_approx\_equal(h,\ 3./11,\ significant=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07144}07144\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ stats.distributions.chi2.sf(3./11,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07145}07145\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07146}07146\ \ \ \ \ \textcolor{keyword}{def\ }test\_simple\_tie(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07147}07147\ \ \ \ \ \ \ \ \ x\ =\ [1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07148}07148\ \ \ \ \ \ \ \ \ y\ =\ [1,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07149}07149\ \ \ \ \ \ \ \ \ h\_uncorr\ =\ 1.5**2\ +\ 2*2.25**2\ -\/\ 12}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07150}07150\ \ \ \ \ \ \ \ \ corr\ =\ 0.75}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07151}07151\ \ \ \ \ \ \ \ \ expected\ =\ h\_uncorr\ /\ corr\ \ \ \textcolor{comment}{\#\ 0.5}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07152}07152\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07153}07153\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Since\ the\ expression\ is\ simple\ and\ the\ exact\ answer\ is\ 0.5,\ it}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07154}07154\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ should\ be\ safe\ to\ use\ assert\_equal().}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07155}07155\ \ \ \ \ \ \ \ \ assert\_equal(h,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07156}07156\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07157}07157\ \ \ \ \ \textcolor{keyword}{def\ }test\_another\_tie(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07158}07158\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 1,\ 1,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07159}07159\ \ \ \ \ \ \ \ \ y\ =\ [2,\ 2,\ 2,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07160}07160\ \ \ \ \ \ \ \ \ h\_uncorr\ =\ (12.\ /\ 8.\ /\ 9.)\ *\ 4\ *\ (3**2\ +\ 6**2)\ -\/\ 3\ *\ 9}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07161}07161\ \ \ \ \ \ \ \ \ corr\ =\ 1\ -\/\ float(3**3\ -\/\ 3\ +\ 5**3\ -\/\ 5)\ /\ (8**3\ -\/\ 8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07162}07162\ \ \ \ \ \ \ \ \ expected\ =\ h\_uncorr\ /\ corr}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07163}07163\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07164}07164\ \ \ \ \ \ \ \ \ assert\_approx\_equal(h,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07165}07165\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07166}07166\ \ \ \ \ \textcolor{keyword}{def\ }test\_three\_groups(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07167}07167\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ test\ of\ stats.kruskal\ with\ three\ groups,\ with\ ties.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07168}07168\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07169}07169\ \ \ \ \ \ \ \ \ y\ =\ [2,\ 2,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07170}07170\ \ \ \ \ \ \ \ \ z\ =\ [2,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07171}07171\ \ \ \ \ \ \ \ \ h\_uncorr\ =\ (12.\ /\ 8.\ /\ 9.)\ *\ (3*2**2\ +\ 3*6**2\ +\ 2*6**2)\ -\/\ 3\ *\ 9\ \ \textcolor{comment}{\#\ 5.0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07172}07172\ \ \ \ \ \ \ \ \ corr\ =\ 1\ -\/\ float(3**3\ -\/\ 3\ +\ 5**3\ -\/\ 5)\ /\ (8**3\ -\/\ 8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07173}07173\ \ \ \ \ \ \ \ \ expected\ =\ h\_uncorr\ /\ corr\ \ \textcolor{comment}{\#\ 7.0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07174}07174\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y,\ z)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07175}07175\ \ \ \ \ \ \ \ \ assert\_approx\_equal(h,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07176}07176\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ stats.distributions.chi2.sf(h,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07177}07177\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07178}07178\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07179}07179\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ test\ of\ stats.kruskal\ with\ three\ groups,\ with\ ties.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07180}07180\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07181}07181\ \ \ \ \ \ \ \ \ y\ =\ [2,\ 2,\ 2]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07182}07182\ \ \ \ \ \ \ \ \ z\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07183}07183\ \ \ \ \ \ \ \ \ assert\_equal(stats.kruskal(x,\ y,\ z),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07184}07184\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07185}07185\ \ \ \ \ \textcolor{keyword}{def\ }test\_kruskal\_result\_attributes(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07186}07186\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 3,\ 5,\ 7,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07187}07187\ \ \ \ \ \ \ \ \ y\ =\ [2,\ 4,\ 6,\ 8,\ 10]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07188}07188\ \ \ \ \ \ \ \ \ res\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07189}07189\ \ \ \ \ \ \ \ \ attributes\ =\ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'pvalue'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07190}07190\ \ \ \ \ \ \ \ \ check\_named\_results(res,\ attributes)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07191}07191\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07192}07192\ \ \ \ \ \textcolor{keyword}{def\ }test\_nan\_policy(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07193}07193\ \ \ \ \ \ \ \ \ x\ =\ np.arange(10.)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07194}07194\ \ \ \ \ \ \ \ \ x[9]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07195}07195\ \ \ \ \ \ \ \ \ assert\_equal(stats.kruskal(x,\ x),\ (np.nan,\ np.nan))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07196}07196\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.kruskal(x,\ x,\ nan\_policy=\textcolor{stringliteral}{'omit'}),\ (0.0,\ 1.0))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07197}07197\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.kruskal,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07198}07198\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.kruskal,\ x,\ x,\ nan\_policy=\textcolor{stringliteral}{'foobar'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07199}07199\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07200}07200\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_no\_samples(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07201}07201\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ to\ see\ if\ large\ samples\ are\ handled\ correctly.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07202}07202\ \ \ \ \ \ \ \ \ n\ =\ 50000}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07203}07203\ \ \ \ \ \ \ \ \ x\ =\ np.random.randn(n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07204}07204\ \ \ \ \ \ \ \ \ y\ =\ np.random.randn(n)\ +\ 50}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07205}07205\ \ \ \ \ \ \ \ \ h,\ p\ =\ stats.kruskal(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07206}07206\ \ \ \ \ \ \ \ \ expected\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07207}07207\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ expected)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07208}07208\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07209}07209\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07210}07210\ \textcolor{keyword}{class\ }TestCombinePvalues:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07211}07211\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07212}07212\ \ \ \ \ \textcolor{keyword}{def\ }test\_fisher(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07213}07213\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Example\ taken\ from\ https://en.wikipedia.org/wiki/Fisher\%27s\_exact\_test\#Example}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07214}07214\ \ \ \ \ \ \ \ \ xsq,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'fisher'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07215}07215\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.02156,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07216}07216\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07217}07217\ \ \ \ \ \textcolor{keyword}{def\ }test\_stouffer(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07218}07218\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'stouffer'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07219}07219\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.01651,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07220}07220\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07221}07221\ \ \ \ \ \textcolor{keyword}{def\ }test\_stouffer2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07222}07222\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.5,\ .5,\ .5],\ method=\textcolor{stringliteral}{'stouffer'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07223}07223\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.5,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07224}07224\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07225}07225\ \ \ \ \ \textcolor{keyword}{def\ }test\_weighted\_stouffer(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07226}07226\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'stouffer'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07227}07227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=np.ones(3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07228}07228\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.01651,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07229}07229\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07230}07230\ \ \ \ \ \textcolor{keyword}{def\ }test\_weighted\_stouffer2(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07231}07231\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'stouffer'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07232}07232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=np.array((1,\ 4,\ 9)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07233}07233\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.1464,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07234}07234\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07235}07235\ \ \ \ \ \textcolor{keyword}{def\ }test\_pearson(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07236}07236\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'pearson'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07237}07237\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.02213,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07238}07238\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07239}07239\ \ \ \ \ \textcolor{keyword}{def\ }test\_tippett(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07240}07240\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'tippett'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07241}07241\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.0297,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07242}07242\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07243}07243\ \ \ \ \ \textcolor{keyword}{def\ }test\_mudholkar\_george(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07244}07244\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.1,\ .1,\ .1],\ method=\textcolor{stringliteral}{'mudholkar\_george'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07245}07245\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p,\ 0.019462,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07246}07246\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07247}07247\ \ \ \ \ \textcolor{keyword}{def\ }test\_mudholkar\_george\_equal\_fisher\_pearson\_average(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07248}07248\ \ \ \ \ \ \ \ \ Z,\ p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'mudholkar\_george'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07249}07249\ \ \ \ \ \ \ \ \ Z\_f,\ p\_f\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'fisher'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07250}07250\ \ \ \ \ \ \ \ \ Z\_p,\ p\_p\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=\textcolor{stringliteral}{'pearson'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07251}07251\ \ \ \ \ \ \ \ \ assert\_approx\_equal(0.5\ *\ (Z\_f+Z\_p),\ Z,\ significant=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07252}07252\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07253}07253\ \ \ \ \ methods\ =\ [\textcolor{stringliteral}{"{}fisher"{}},\ \textcolor{stringliteral}{"{}pearson"{}},\ \textcolor{stringliteral}{"{}tippett"{}},\ \textcolor{stringliteral}{"{}stouffer"{}},\ \textcolor{stringliteral}{"{}mudholkar\_george"{}}]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07254}07254\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07255}07255\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}variant"{},\ ["{}single"{},\ "{}all"{},\ "{}random"{}])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07256}07256\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}method"{},\ methods)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07257}07257\ \ \ \ \ \textcolor{keyword}{def\ }test\_monotonicity(self,\ variant,\ method):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07258}07258\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ result\ increases\ monotonically\ with\ respect\ to\ input.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07259}07259\ \ \ \ \ \ \ \ \ m,\ n\ =\ 10,\ 7}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07260}07260\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(278448169958891062669391462690811630763)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07261}07261\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07262}07262\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}pvaluess`\ is\ an\ m\ \ n\ array\ of\ p\ values.\ Each\ row\ corresponds\ to}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07263}07263\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\ set\ of\ p\ values\ to\ be\ combined\ with\ p\ values\ increasing}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07264}07264\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ monotonically\ down\ one\ column\ (single),\ simultaneously\ down\ each}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07265}07265\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ column\ (all),\ or\ independently\ down\ each\ column\ (random).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07266}07266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ variant\ ==\ \textcolor{stringliteral}{"{}single"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07267}07267\ \ \ \ \ \ \ \ \ \ \ \ \ pvaluess\ =\ np.full((m,\ n),\ rng.random(n))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07268}07268\ \ \ \ \ \ \ \ \ \ \ \ \ pvaluess[:,\ 0]\ =\ np.linspace(0.1,\ 0.9,\ m)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07269}07269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ variant\ ==\ \textcolor{stringliteral}{"{}all"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07270}07270\ \ \ \ \ \ \ \ \ \ \ \ \ pvaluess\ =\ np.full((n,\ m),\ np.linspace(0.1,\ 0.9,\ m)).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07271}07271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ variant\ ==\ \textcolor{stringliteral}{"{}random"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07272}07272\ \ \ \ \ \ \ \ \ \ \ \ \ pvaluess\ =\ np.sort(rng.uniform(0,\ 1,\ size=(m,\ n)),\ axis=0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07273}07273\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07274}07274\ \ \ \ \ \ \ \ \ combined\_pvalues\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07275}07275\ \ \ \ \ \ \ \ \ \ \ \ \ stats.combine\_pvalues(pvalues,\ method=method)[1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07276}07276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ pvalues\ \textcolor{keywordflow}{in}\ pvaluess}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07277}07277\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07278}07278\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.all(np.diff(combined\_pvalues)\ >=\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07279}07279\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07280}07280\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}method"{},\ methods)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07281}07281\ \ \ \ \ \textcolor{keyword}{def\ }test\_result(self,\ method):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07282}07282\ \ \ \ \ \ \ \ \ res\ =\ stats.combine\_pvalues([.01,\ .2,\ .3],\ method=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07283}07283\ \ \ \ \ \ \ \ \ assert\_equal((res.statistic,\ res.pvalue),\ res)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07284}07284\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07285}07285\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07286}07286\ \textcolor{keyword}{class\ }TestCdfDistanceValidation:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07287}07287\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07288}07288\ \textcolor{stringliteral}{\ \ \ \ Test\ that\ \_cdf\_distance()\ (via\ wasserstein\_distance())\ raises\ ValueErrors}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07289}07289\ \textcolor{stringliteral}{\ \ \ \ for\ bad\ inputs.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07290}07290\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07291}07291\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07292}07292\ \ \ \ \ \textcolor{keyword}{def\ }test\_distinct\_value\_and\_weight\_lengths(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07293}07293\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ When\ the\ number\ of\ weights\ does\ not\ match\ the\ number\ of\ values,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07294}07294\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\ ValueError\ should\ be\ raised.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07295}07295\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07296}07296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1],\ [2],\ [4],\ [3,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07297}07297\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,\ [1],\ [2],\ [1,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07298}07298\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07299}07299\ \ \ \ \ \textcolor{keyword}{def\ }test\_zero\_weight(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07300}07300\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ When\ a\ distribution\ is\ given\ zero\ weight,\ a\ ValueError\ should\ be}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07301}07301\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raised.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07302}07302\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07303}07303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ [2],\ [0,\ 0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07304}07304\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07305}07305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ [2],\ [3,\ 1],\ [0])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07306}07306\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07307}07307\ \ \ \ \ \textcolor{keyword}{def\ }test\_negative\_weights(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07308}07308\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ ValueError\ should\ be\ raised\ if\ there\ are\ any\ negative\ weights.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07309}07309\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07310}07310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ [2,\ 2],\ [1,\ 1],\ [3,\ -\/1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07311}07311\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07312}07312\ \ \ \ \ \textcolor{keyword}{def\ }test\_empty\_distribution(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07313}07313\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ ValueError\ should\ be\ raised\ when\ trying\ to\ measure\ the\ distance}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07314}07314\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ between\ something\ and\ nothing.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07315}07315\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,\ [],\ [2,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07316}07316\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,\ [1],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07317}07317\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07318}07318\ \ \ \ \ \textcolor{keyword}{def\ }test\_inf\_weight(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07319}07319\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ An\ inf\ weight\ is\ not\ valid.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07320}07320\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.wasserstein\_distance,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07321}07321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 1],\ [1,\ 1],\ [1,\ np.inf,\ 1],\ [1,\ 1])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07322}07322\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07323}07323\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07324}07324\ \textcolor{keyword}{class\ }TestWassersteinDistance:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07325}07325\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Tests\ for\ wasserstein\_distance()\ output\ values.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07326}07326\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07327}07327\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07328}07328\ \ \ \ \ \textcolor{keyword}{def\ }test\_simple(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07329}07329\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ basic\ distributions,\ the\ value\ of\ the\ Wasserstein\ distance\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07330}07330\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ straightforward.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07331}07331\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07332}07332\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([0,\ 1],\ [0],\ [1,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07333}07333\ \ \ \ \ \ \ \ \ \ \ \ \ .5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07334}07334\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.wasserstein\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07335}07335\ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ [0],\ [3,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07336}07336\ \ \ \ \ \ \ \ \ \ \ \ \ .25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07337}07337\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.wasserstein\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07338}07338\ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 2],\ [0],\ [1,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07339}07339\ \ \ \ \ \ \ \ \ \ \ \ \ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07340}07340\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.wasserstein\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07341}07341\ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1,\ 2],\ [1,\ 2,\ 3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07342}07342\ \ \ \ \ \ \ \ \ \ \ \ \ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07343}07343\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07344}07344\ \ \ \ \ \textcolor{keyword}{def\ }test\_same\_distribution(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07345}07345\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Any\ distribution\ moved\ to\ itself\ should\ have\ a\ Wasserstein\ distance\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07346}07346\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ zero.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07347}07347\ \ \ \ \ \ \ \ \ assert\_equal(stats.wasserstein\_distance([1,\ 2,\ 3],\ [2,\ 1,\ 3]),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07348}07348\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07349}07349\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 1,\ 1,\ 4],\ [4,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07350}07350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1,\ 1],\ [1,\ 3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07351}07351\ \ \ \ \ \ \ \ \ \ \ \ \ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07352}07352\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07353}07353\ \ \ \ \ \textcolor{keyword}{def\ }test\_shift(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07354}07354\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ whole\ distribution\ is\ shifted\ by\ x,\ then\ the\ Wasserstein}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07355}07355\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ distance\ should\ be\ x.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07356}07356\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.wasserstein\_distance([0],\ [1]),\ 1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07357}07357\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.wasserstein\_distance([-\/5],\ [5]),\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07358}07358\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07359}07359\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2,\ 3,\ 4,\ 5],\ [11,\ 12,\ 13,\ 14,\ 15]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07360}07360\ \ \ \ \ \ \ \ \ \ \ \ \ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07361}07361\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07362}07362\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([4.5,\ 6.7,\ 2.1],\ [4.6,\ 7,\ 9.2],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07363}07363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 1,\ 1],\ [1,\ 3,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07364}07364\ \ \ \ \ \ \ \ \ \ \ \ \ 2.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07365}07365\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07366}07366\ \ \ \ \ \textcolor{keyword}{def\ }test\_combine\_weights(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07367}07367\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Assigning\ a\ weight\ w\ to\ a\ value\ is\ equivalent\ to\ including\ that\ value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07368}07368\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ w\ times\ in\ the\ value\ array\ with\ weight\ of\ 1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07369}07369\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07370}07370\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07371}07371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 1,\ 1,\ 1,\ 1,\ 5],\ [0,\ 3,\ 3,\ 3,\ 3,\ 4,\ 4],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07372}07372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1],\ [1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07373}07373\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([5,\ 0,\ 1],\ [0,\ 4,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07374}07374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 4],\ [1,\ 2,\ 4]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07375}07375\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07376}07376\ \ \ \ \ \textcolor{keyword}{def\ }test\_collapse(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07377}07377\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Collapsing\ a\ distribution\ to\ a\ point\ distribution\ at\ zero\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07378}07378\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ equivalent\ to\ taking\ the\ average\ of\ the\ absolute\ values\ of\ the\ values.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07379}07379\ \ \ \ \ \ \ \ \ u\ =\ np.arange(-\/10,\ 30,\ 0.3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07380}07380\ \ \ \ \ \ \ \ \ v\ =\ np.zeros\_like(u)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07381}07381\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07382}07382\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance(u,\ v),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07383}07383\ \ \ \ \ \ \ \ \ \ \ \ \ np.mean(np.abs(u)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07384}07384\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07385}07385\ \ \ \ \ \ \ \ \ u\_weights\ =\ np.arange(len(u))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07386}07386\ \ \ \ \ \ \ \ \ v\_weights\ =\ u\_weights[::-\/1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07387}07387\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07388}07388\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance(u,\ v,\ u\_weights,\ v\_weights),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07389}07389\ \ \ \ \ \ \ \ \ \ \ \ \ np.average(np.abs(u),\ weights=u\_weights))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07390}07390\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07391}07391\ \ \ \ \ \textcolor{keyword}{def\ }test\_zero\_weight(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07392}07392\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Values\ with\ zero\ weight\ have\ no\ impact\ on\ the\ Wasserstein\ distance.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07393}07393\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07394}07394\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2,\ 100000],\ [1,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07395}07395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 0],\ [1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07396}07396\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2],\ [1,\ 1],\ [1,\ 1],\ [1,\ 1]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07397}07397\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07398}07398\ \ \ \ \ \textcolor{keyword}{def\ }test\_inf\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07399}07399\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Inf\ values\ can\ lead\ to\ an\ inf\ distance\ or\ trigger\ a\ RuntimeWarning}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07400}07400\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (and\ return\ NaN)\ if\ the\ distance\ is\ undefined.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07401}07401\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07402}07402\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2,\ np.inf],\ [1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07403}07403\ \ \ \ \ \ \ \ \ \ \ \ \ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07404}07404\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07405}07405\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2,\ np.inf],\ [-\/np.inf,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07406}07406\ \ \ \ \ \ \ \ \ \ \ \ \ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07407}07407\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07408}07408\ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ -\/np.inf,\ np.inf],\ [1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07409}07409\ \ \ \ \ \ \ \ \ \ \ \ \ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07410}07410\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07411}07411\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}invalid\ value*"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07412}07412\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07413}07413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.wasserstein\_distance([1,\ 2,\ np.inf],\ [np.inf,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07414}07414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07415}07415\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07416}07416\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07417}07417\ \textcolor{keyword}{class\ }TestEnergyDistance:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07418}07418\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Tests\ for\ energy\_distance()\ output\ values.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07419}07419\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07420}07420\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07421}07421\ \ \ \ \ \textcolor{keyword}{def\ }test\_simple(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07422}07422\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ basic\ distributions,\ the\ value\ of\ the\ energy\ distance\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07423}07423\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ straightforward.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07424}07424\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07425}07425\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([0,\ 1],\ [0],\ [1,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07426}07426\ \ \ \ \ \ \ \ \ \ \ \ \ np.sqrt(2)\ *\ .5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07427}07427\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.energy\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07428}07428\ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ [0],\ [3,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07429}07429\ \ \ \ \ \ \ \ \ \ \ \ \ np.sqrt(2)\ *\ .25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07430}07430\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.energy\_distance(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07431}07431\ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 2],\ [0],\ [1,\ 1],\ [1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07432}07432\ \ \ \ \ \ \ \ \ \ \ \ \ 2\ *\ .5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07433}07433\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07434}07434\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([0,\ 1,\ 2],\ [1,\ 2,\ 3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07435}07435\ \ \ \ \ \ \ \ \ \ \ \ \ np.sqrt(2)\ *\ (3*(1./3**2))**.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07436}07436\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07437}07437\ \ \ \ \ \textcolor{keyword}{def\ }test\_same\_distribution(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07438}07438\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Any\ distribution\ moved\ to\ itself\ should\ have\ a\ energy\ distance\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07439}07439\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ zero.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07440}07440\ \ \ \ \ \ \ \ \ assert\_equal(stats.energy\_distance([1,\ 2,\ 3],\ [2,\ 1,\ 3]),\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07441}07441\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07442}07442\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ 1,\ 1,\ 4],\ [4,\ 1],\ [1,\ 1,\ 1,\ 1],\ [1,\ 3]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07443}07443\ \ \ \ \ \ \ \ \ \ \ \ \ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07444}07444\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07445}07445\ \ \ \ \ \textcolor{keyword}{def\ }test\_shift(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07446}07446\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ a\ single-\/point\ distribution\ is\ shifted\ by\ x,\ then\ the\ energy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07447}07447\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ distance\ should\ be\ sqrt(2)\ *\ sqrt(x).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07448}07448\ \ \ \ \ \ \ \ \ assert\_almost\_equal(stats.energy\_distance([0],\ [1]),\ np.sqrt(2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07449}07449\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07450}07450\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([-\/5],\ [5]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07451}07451\ \ \ \ \ \ \ \ \ \ \ \ \ np.sqrt(2)\ *\ 10**.5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07452}07452\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07453}07453\ \ \ \ \ \textcolor{keyword}{def\ }test\_combine\_weights(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07454}07454\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Assigning\ a\ weight\ w\ to\ a\ value\ is\ equivalent\ to\ including\ that\ value}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07455}07455\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ w\ times\ in\ the\ value\ array\ with\ weight\ of\ 1.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07456}07456\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07457}07457\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([0,\ 0,\ 1,\ 1,\ 1,\ 1,\ 5],\ [0,\ 3,\ 3,\ 3,\ 3,\ 4,\ 4],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07458}07458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1],\ [1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07459}07459\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([5,\ 0,\ 1],\ [0,\ 4,\ 3],\ [1,\ 2,\ 4],\ [1,\ 2,\ 4]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07460}07460\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07461}07461\ \ \ \ \ \textcolor{keyword}{def\ }test\_zero\_weight(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07462}07462\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Values\ with\ zero\ weight\ have\ no\ impact\ on\ the\ energy\ distance.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07463}07463\ \ \ \ \ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07464}07464\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ 2,\ 100000],\ [1,\ 1],\ [1,\ 1,\ 0],\ [1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07465}07465\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ 2],\ [1,\ 1],\ [1,\ 1],\ [1,\ 1]))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07466}07466\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07467}07467\ \ \ \ \ \textcolor{keyword}{def\ }test\_inf\_values(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07468}07468\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Inf\ values\ can\ lead\ to\ an\ inf\ distance\ or\ trigger\ a\ RuntimeWarning}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07469}07469\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (and\ return\ NaN)\ if\ the\ distance\ is\ undefined.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07470}07470\ \ \ \ \ \ \ \ \ assert\_equal(stats.energy\_distance([1,\ 2,\ np.inf],\ [1,\ 1]),\ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07471}07471\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07472}07472\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ 2,\ np.inf],\ [-\/np.inf,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07473}07473\ \ \ \ \ \ \ \ \ \ \ \ \ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07474}07474\ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07475}07475\ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ -\/np.inf,\ np.inf],\ [1,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07476}07476\ \ \ \ \ \ \ \ \ \ \ \ \ np.inf)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07477}07477\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07478}07478\ \ \ \ \ \ \ \ \ \ \ \ \ sup.record(RuntimeWarning,\ \textcolor{stringliteral}{"{}invalid\ value*"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07479}07479\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07480}07480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.energy\_distance([1,\ 2,\ np.inf],\ [np.inf,\ 1]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07481}07481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07482}07482\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07483}07483\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07484}07484\ \textcolor{keyword}{class\ }TestBrunnerMunzel:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07485}07485\ \ \ \ \ \textcolor{comment}{\#\ Data\ from\ (Lumley,\ 1996)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07486}07486\ \ \ \ \ X\ =\ [1,\ 2,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 2,\ 4,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07487}07487\ \ \ \ \ Y\ =\ [3,\ 3,\ 4,\ 3,\ 1,\ 2,\ 3,\ 1,\ 1,\ 5,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07488}07488\ \ \ \ \ significant\ =\ 13}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07489}07489\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07490}07490\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_one\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07491}07491\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Results\ are\ compared\ with\ R's\ lawstat\ package.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07492}07492\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07493}07493\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07494}07494\ \ \ \ \ \ \ \ \ u3,\ p3\ =\ stats.brunnermunzel(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'greater'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07495}07495\ \ \ \ \ \ \ \ \ u4,\ p4\ =\ stats.brunnermunzel(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'less'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07496}07496\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07497}07497\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ p2,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07498}07498\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p3,\ p4,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07499}07499\ \ \ \ \ \ \ \ \ assert\_(p1\ !=\ p3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07500}07500\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u1,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07501}07501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07502}07502\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u2,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07503}07503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07504}07504\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u3,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07505}07505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07506}07506\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u4,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07507}07507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07508}07508\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.0028931043330757342,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07509}07509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07510}07510\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p3,\ 0.99710689566692423,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07511}07511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07512}07512\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07513}07513\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_two\_sided(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07514}07514\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Results\ are\ compared\ with\ R's\ lawstat\ package.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07515}07515\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(self.X,\ self.Y,\ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07516}07516\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(self.Y,\ self.X,\ alternative=\textcolor{stringliteral}{'two-\/sided'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07517}07517\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07518}07518\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ p2,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07519}07519\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u1,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07520}07520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07521}07521\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u2,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07522}07522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07523}07523\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.0057862086661515377,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07524}07524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07525}07525\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07526}07526\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_default(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07527}07527\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ default\ value\ for\ alternative\ is\ two-\/sided}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07528}07528\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(self.X,\ self.Y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07529}07529\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(self.Y,\ self.X)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07530}07530\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07531}07531\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ p2,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07532}07532\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u1,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07533}07533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07534}07534\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u2,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07535}07535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07536}07536\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.0057862086661515377,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07537}07537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07538}07538\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07539}07539\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_alternative\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07540}07540\ \ \ \ \ \ \ \ \ alternative\ =\ \textcolor{stringliteral}{"{}error"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07541}07541\ \ \ \ \ \ \ \ \ distribution\ =\ \textcolor{stringliteral}{"{}t"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07542}07542\ \ \ \ \ \ \ \ \ nan\_policy\ =\ \textcolor{stringliteral}{"{}propagate"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07543}07543\ \ \ \ \ \ \ \ \ assert\_(alternative\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{"{}two-\/sided"{}},\ \textcolor{stringliteral}{"{}greater"{}},\ \textcolor{stringliteral}{"{}less"{}}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07544}07544\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07545}07545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.brunnermunzel,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07546}07546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.X,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07547}07547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.Y,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07548}07548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07549}07549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distribution,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07550}07550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07551}07551\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07552}07552\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_distribution\_norm(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07553}07553\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(self.X,\ self.Y,\ distribution=\textcolor{stringliteral}{"{}normal"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07554}07554\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(self.Y,\ self.X,\ distribution=\textcolor{stringliteral}{"{}normal"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07555}07555\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ p2,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07556}07556\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u1,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07557}07557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07558}07558\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u2,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07559}07559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07560}07560\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.0017041417600383024,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07561}07561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07562}07562\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07563}07563\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_distribution\_error(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07564}07564\ \ \ \ \ \ \ \ \ alternative\ =\ \textcolor{stringliteral}{"{}two-\/sided"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07565}07565\ \ \ \ \ \ \ \ \ distribution\ =\ \textcolor{stringliteral}{"{}error"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07566}07566\ \ \ \ \ \ \ \ \ nan\_policy\ =\ \textcolor{stringliteral}{"{}propagate"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07567}07567\ \ \ \ \ \ \ \ \ assert\_(alternative\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{"{}t"{}},\ \textcolor{stringliteral}{"{}normal"{}}])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07568}07568\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07569}07569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.brunnermunzel,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07570}07570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.X,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07571}07571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.Y,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07572}07572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07573}07573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distribution,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07574}07574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07575}07575\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07576}07576\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_empty\_imput(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07577}07577\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(self.X,\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07578}07578\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel([],\ self.Y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07579}07579\ \ \ \ \ \ \ \ \ u3,\ p3\ =\ stats.brunnermunzel([],\ [])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07580}07580\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07581}07581\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07582}07582\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07583}07583\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07584}07584\ \ \ \ \ \ \ \ \ assert\_equal(p2,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07585}07585\ \ \ \ \ \ \ \ \ assert\_equal(u3,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07586}07586\ \ \ \ \ \ \ \ \ assert\_equal(p3,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07587}07587\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07588}07588\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_nan\_input\_propagate(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07589}07589\ \ \ \ \ \ \ \ \ X\ =\ [1,\ 2,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 2,\ 4,\ 1,\ 1,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07590}07590\ \ \ \ \ \ \ \ \ Y\ =\ [3,\ 3,\ 4,\ 3,\ 1,\ 2,\ 3,\ 1,\ 1,\ 5,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07591}07591\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(X,\ Y,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07592}07592\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(Y,\ X,\ nan\_policy=\textcolor{stringliteral}{"{}propagate"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07593}07593\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07594}07594\ \ \ \ \ \ \ \ \ assert\_equal(u1,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07595}07595\ \ \ \ \ \ \ \ \ assert\_equal(p1,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07596}07596\ \ \ \ \ \ \ \ \ assert\_equal(u2,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07597}07597\ \ \ \ \ \ \ \ \ assert\_equal(p2,\ np.nan)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07598}07598\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07599}07599\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_nan\_input\_raise(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07600}07600\ \ \ \ \ \ \ \ \ X\ =\ [1,\ 2,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 2,\ 4,\ 1,\ 1,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07601}07601\ \ \ \ \ \ \ \ \ Y\ =\ [3,\ 3,\ 4,\ 3,\ 1,\ 2,\ 3,\ 1,\ 1,\ 5,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07602}07602\ \ \ \ \ \ \ \ \ alternative\ =\ \textcolor{stringliteral}{"{}two-\/sided"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07603}07603\ \ \ \ \ \ \ \ \ distribution\ =\ \textcolor{stringliteral}{"{}t"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07604}07604\ \ \ \ \ \ \ \ \ nan\_policy\ =\ \textcolor{stringliteral}{"{}raise"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07605}07605\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07606}07606\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07607}07607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.brunnermunzel,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07608}07608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07609}07609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Y,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07610}07610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07611}07611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distribution,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07612}07612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07613}07613\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07614}07614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.brunnermunzel,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07615}07615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Y,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07616}07616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07617}07617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07618}07618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ distribution,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07619}07619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nan\_policy)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07620}07620\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07621}07621\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_nan\_input\_omit(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07622}07622\ \ \ \ \ \ \ \ \ X\ =\ [1,\ 2,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 1,\ 2,\ 4,\ 1,\ 1,\ np.nan]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07623}07623\ \ \ \ \ \ \ \ \ Y\ =\ [3,\ 3,\ 4,\ 3,\ 1,\ 2,\ 3,\ 1,\ 1,\ 5,\ 4]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07624}07624\ \ \ \ \ \ \ \ \ u1,\ p1\ =\ stats.brunnermunzel(X,\ Y,\ nan\_policy=\textcolor{stringliteral}{"{}omit"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07625}07625\ \ \ \ \ \ \ \ \ u2,\ p2\ =\ stats.brunnermunzel(Y,\ X,\ nan\_policy=\textcolor{stringliteral}{"{}omit"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07626}07626\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07627}07627\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ p2,\ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07628}07628\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u1,\ 3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07629}07629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07630}07630\ \ \ \ \ \ \ \ \ assert\_approx\_equal(u2,\ -\/3.1374674823029505,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07631}07631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07632}07632\ \ \ \ \ \ \ \ \ assert\_approx\_equal(p1,\ 0.0057862086661515377,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07633}07633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ significant=self.significant)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07634}07634\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07635}07635\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_return\_nan(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07636}07636\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ tests\ that\ a\ warning\ is\ emitted\ when\ p\ is\ nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07637}07637\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p-\/value\ with\ t-\/distributions\ can\ be\ nan\ (0/0)\ (see\ gh-\/15843)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07638}07638\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07639}07639\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07640}07640\ \ \ \ \ \ \ \ \ y\ =\ [5,\ 6,\ 7,\ 8,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07641}07641\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07642}07642\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{'p-\/value\ cannot\ be\ estimated'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07643}07643\ \ \ \ \ \ \ \ \ \ \ \ \ stats.brunnermunzel(x,\ y,\ distribution=\textcolor{stringliteral}{"{}t"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07644}07644\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07645}07645\ \ \ \ \ \textcolor{keyword}{def\ }test\_brunnermunzel\_normal\_dist(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07646}07646\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ tests\ that\ a\ p\ is\ 0\ for\ datasets\ that\ cause\ p-\/>nan}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07647}07647\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ when\ t-\/distribution\ is\ used\ (see\ gh-\/15843)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07648}07648\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07649}07649\ \ \ \ \ \ \ \ \ x\ =\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07650}07650\ \ \ \ \ \ \ \ \ y\ =\ [5,\ 6,\ 7,\ 8,\ 9]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07651}07651\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07652}07652\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{'divide\ by\ zero'}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07653}07653\ \ \ \ \ \ \ \ \ \ \ \ \ \_,\ p\ =\ stats.brunnermunzel(x,\ y,\ distribution=\textcolor{stringliteral}{"{}normal"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07654}07654\ \ \ \ \ \ \ \ \ assert\_equal(p,\ 0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07655}07655\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07656}07656\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07657}07657\ \textcolor{keyword}{class\ }TestRatioUniforms:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07658}07658\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Tests\ for\ rvs\_ratio\_uniforms.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07659}07659\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07660}07660\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07661}07661\ \ \ \ \ \textcolor{keyword}{def\ }test\_rv\_generation(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07662}07662\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ use\ KS\ test\ to\ check\ distribution\ of\ rvs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07663}07663\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ normal\ distribution}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07664}07664\ \ \ \ \ \ \ \ \ f\ =\ stats.norm.pdf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07665}07665\ \ \ \ \ \ \ \ \ v\_bound\ =\ np.sqrt(f(np.sqrt(2)))\ *\ np.sqrt(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07666}07666\ \ \ \ \ \ \ \ \ umax,\ vmin,\ vmax\ =\ np.sqrt(f(0)),\ -\/v\_bound,\ v\_bound}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07667}07667\ \ \ \ \ \ \ \ \ rvs\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=2500,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07668}07668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=12345)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07669}07669\ \ \ \ \ \ \ \ \ assert\_equal(stats.kstest(rvs,\ \textcolor{stringliteral}{'norm'})[1]\ >\ 0.25,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07670}07670\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07671}07671\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ exponential\ distribution}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07672}07672\ \ \ \ \ \ \ \ \ rvs\ =\ stats.rvs\_ratio\_uniforms(\textcolor{keyword}{lambda}\ x:\ np.exp(-\/x),\ umax=1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07673}07673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vmin=0,\ vmax=2*np.exp(-\/1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07674}07674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size=1000,\ random\_state=12345)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07675}07675\ \ \ \ \ \ \ \ \ assert\_equal(stats.kstest(rvs,\ \textcolor{stringliteral}{'expon'})[1]\ >\ 0.25,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07676}07676\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07677}07677\ \ \ \ \ \textcolor{keyword}{def\ }test\_shape(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07678}07678\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ shape\ of\ return\ value\ depending\ on\ size\ parameter}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07679}07679\ \ \ \ \ \ \ \ \ f\ =\ stats.norm.pdf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07680}07680\ \ \ \ \ \ \ \ \ v\_bound\ =\ np.sqrt(f(np.sqrt(2)))\ *\ np.sqrt(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07681}07681\ \ \ \ \ \ \ \ \ umax,\ vmin,\ vmax\ =\ np.sqrt(f(0)),\ -\/v\_bound,\ v\_bound}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07682}07682\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07683}07683\ \ \ \ \ \ \ \ \ r1\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=3,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07684}07684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07685}07685\ \ \ \ \ \ \ \ \ r2\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(3,),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07686}07686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07687}07687\ \ \ \ \ \ \ \ \ r3\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(3,\ 1),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07688}07688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07689}07689\ \ \ \ \ \ \ \ \ assert\_equal(r1,\ r2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07690}07690\ \ \ \ \ \ \ \ \ assert\_equal(r2,\ r3.flatten())}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07691}07691\ \ \ \ \ \ \ \ \ assert\_equal(r1.shape,\ (3,))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07692}07692\ \ \ \ \ \ \ \ \ assert\_equal(r3.shape,\ (3,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07693}07693\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07694}07694\ \ \ \ \ \ \ \ \ r4\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(3,\ 3,\ 3),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07695}07695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07696}07696\ \ \ \ \ \ \ \ \ r5\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=27,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07697}07697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=12)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07698}07698\ \ \ \ \ \ \ \ \ assert\_equal(r4.flatten(),\ r5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07699}07699\ \ \ \ \ \ \ \ \ assert\_equal(r4.shape,\ (3,\ 3,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07700}07700\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07701}07701\ \ \ \ \ \ \ \ \ r6\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07702}07702\ \ \ \ \ \ \ \ \ r7\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=1,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07703}07703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07704}07704\ \ \ \ \ \ \ \ \ r8\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(1,\ ),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07705}07705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07706}07706\ \ \ \ \ \ \ \ \ assert\_equal(r6,\ r7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07707}07707\ \ \ \ \ \ \ \ \ assert\_equal(r7,\ r8)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07708}07708\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07709}07709\ \ \ \ \ \textcolor{keyword}{def\ }test\_random\_state(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07710}07710\ \ \ \ \ \ \ \ \ f\ =\ stats.norm.pdf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07711}07711\ \ \ \ \ \ \ \ \ v\_bound\ =\ np.sqrt(f(np.sqrt(2)))\ *\ np.sqrt(2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07712}07712\ \ \ \ \ \ \ \ \ umax,\ vmin,\ vmax\ =\ np.sqrt(f(0)),\ -\/v\_bound,\ v\_bound}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07713}07713\ \ \ \ \ \ \ \ \ np.random.seed(1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07714}07714\ \ \ \ \ \ \ \ \ r1\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(3,\ 4))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07715}07715\ \ \ \ \ \ \ \ \ r2\ =\ stats.rvs\_ratio\_uniforms(f,\ umax,\ vmin,\ vmax,\ size=(3,\ 4),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07716}07716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1234)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07717}07717\ \ \ \ \ \ \ \ \ assert\_equal(r1,\ r2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07718}07718\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07719}07719\ \ \ \ \ \textcolor{keyword}{def\ }test\_exceptions(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07720}07720\ \ \ \ \ \ \ \ \ f\ =\ stats.norm.pdf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07721}07721\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ need\ vmin\ <\ vmax}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07722}07722\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07723}07723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.rvs\_ratio\_uniforms,\ pdf=f,\ umax=1,\ vmin=3,\ vmax=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07724}07724\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07725}07725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.rvs\_ratio\_uniforms,\ pdf=f,\ umax=1,\ vmin=1,\ vmax=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07726}07726\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ need\ umax\ >\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07727}07727\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07728}07728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.rvs\_ratio\_uniforms,\ pdf=f,\ umax=-\/1,\ vmin=1,\ vmax=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07729}07729\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07730}07730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.rvs\_ratio\_uniforms,\ pdf=f,\ umax=0,\ vmin=1,\ vmax=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07731}07731\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07732}07732\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07733}07733\ \textcolor{keyword}{class\ }TestMGCErrorWarnings:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07734}07734\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Tests\ errors\ and\ warnings\ derived\ from\ MGC.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07735}07735\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07736}07736\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_notndarray(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07737}07737\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ x\ or\ y\ is\ not\ a\ ndarray}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07738}07738\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07739}07739\ \ \ \ \ \ \ \ \ y\ =\ [5]\ *\ 20}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07740}07740\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07741}07741\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ y,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07742}07742\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07743}07743\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_shape(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07744}07744\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ number\ of\ samples\ different\ (n)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07745}07745\ \ \ \ \ \ \ \ \ x\ =\ np.arange(100).reshape(25,\ 4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07746}07746\ \ \ \ \ \ \ \ \ y\ =\ x.reshape(10,\ 10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07747}07747\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07748}07748\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07749}07749\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_lowsamples(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07750}07750\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ samples\ are\ low\ (<\ 3)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07751}07751\ \ \ \ \ \ \ \ \ x\ =\ np.arange(3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07752}07752\ \ \ \ \ \ \ \ \ y\ =\ np.arange(3)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07753}07753\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07754}07754\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07755}07755\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_nans(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07756}07756\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ inputs\ contain\ NaNs}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07757}07757\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20,\ dtype=float)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07758}07758\ \ \ \ \ \ \ \ \ x[0]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07759}07759\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ x)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07760}07760\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07761}07761\ \ \ \ \ \ \ \ \ y\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07762}07762\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07763}07763\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07764}07764\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_wrongdisttype(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07765}07765\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ metric\ is\ not\ a\ function}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07766}07766\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07767}07767\ \ \ \ \ \ \ \ \ compute\_distance\ =\ 0}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07768}07768\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ x,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07769}07769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_distance=compute\_distance)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07770}07770\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07771}07771\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}reps"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07772}07772\ \ \ \ \ \ \ \ \ -\/1,\ \ \ \ \textcolor{comment}{\#\ reps\ is\ negative}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07773}07773\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'1'},\ \ \ \textcolor{comment}{\#\ reps\ is\ not\ integer}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07774}07774\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07775}07775\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_reps(self,\ reps):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07776}07776\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ reps\ is\ negative}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07777}07777\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07778}07778\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ x,\ reps=reps)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07779}07779\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07780}07780\ \ \ \ \ \textcolor{keyword}{def\ }test\_warns\_reps(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07781}07781\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ warning\ when\ reps\ is\ less\ than\ 1000}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07782}07782\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07783}07783\ \ \ \ \ \ \ \ \ reps\ =\ 100}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07784}07784\ \ \ \ \ \ \ \ \ assert\_warns(RuntimeWarning,\ stats.multiscale\_graphcorr,\ x,\ x,\ reps=reps)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07785}07785\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07786}07786\ \ \ \ \ \textcolor{keyword}{def\ }test\_error\_infty(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07787}07787\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ input\ contains\ infinities}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07788}07788\ \ \ \ \ \ \ \ \ x\ =\ np.arange(20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07789}07789\ \ \ \ \ \ \ \ \ y\ =\ np.ones(20)\ *\ np.inf}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07790}07790\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ stats.multiscale\_graphcorr,\ x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07791}07791\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07792}07792\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07793}07793\ \textcolor{keyword}{class\ }TestMGCStat:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07794}07794\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Test\ validity\ of\ MGC\ test\ statistic}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07795}07795\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07796}07796\ \ \ \ \ \textcolor{keyword}{def\ }\_simulations(self,\ samps=100,\ dims=1,\ sim\_type="{}"{}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07797}07797\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ linear\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07798}07798\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sim\_type\ ==\ \textcolor{stringliteral}{"{}linear"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07799}07799\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ np.random.uniform(-\/1,\ 1,\ size=(samps,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07800}07800\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ x\ +\ 0.3\ *\ np.random.random\_sample(size=(x.size,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07801}07801\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07802}07802\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ spiral\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07803}07803\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ sim\_type\ ==\ \textcolor{stringliteral}{"{}nonlinear"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07804}07804\ \ \ \ \ \ \ \ \ \ \ \ \ unif\ =\ np.array(np.random.uniform(0,\ 5,\ size=(samps,\ 1)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07805}07805\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ unif\ *\ np.cos(np.pi\ *\ unif)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07806}07806\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ (unif\ *\ np.sin(np.pi\ *\ unif)\ +}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07807}07807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.4*np.random.random\_sample(size=(x.size,\ 1)))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07808}07808\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07809}07809\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ independence\ (tests\ type\ I\ simulation)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07810}07810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ sim\_type\ ==\ \textcolor{stringliteral}{"{}independence"{}}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07811}07811\ \ \ \ \ \ \ \ \ \ \ \ \ u\ =\ np.random.normal(0,\ 1,\ size=(samps,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07812}07812\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ np.random.normal(0,\ 1,\ size=(samps,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07813}07813\ \ \ \ \ \ \ \ \ \ \ \ \ u\_2\ =\ np.random.binomial(1,\ p=0.5,\ size=(samps,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07814}07814\ \ \ \ \ \ \ \ \ \ \ \ \ v\_2\ =\ np.random.binomial(1,\ p=0.5,\ size=(samps,\ 1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07815}07815\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ u/3\ +\ 2*u\_2\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07816}07816\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ v/3\ +\ 2*v\_2\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07817}07817\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07818}07818\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ raises\ error\ if\ not\ approved\ sim\_type}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07819}07819\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07820}07820\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}sim\_type\ must\ be\ linear,\ nonlinear,\ or\ "{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07821}07821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}independence"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07822}07822\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07823}07823\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ add\ dimensions\ of\ noise\ for\ higher\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07824}07824\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dims\ >\ 1:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07825}07825\ \ \ \ \ \ \ \ \ \ \ \ \ dims\_noise\ =\ np.random.normal(0,\ 1,\ size=(samps,\ dims-\/1))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07826}07826\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ np.concatenate((x,\ dims\_noise),\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07827}07827\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07828}07828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ y}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07829}07829\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07830}07830\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07831}07831\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}sim\_type,\ obs\_stat,\ obs\_pvalue"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07832}07832\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}linear"{}},\ 0.97,\ 1/1000),\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ linear\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07833}07833\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}nonlinear"{}},\ 0.163,\ 1/1000),\ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ spiral\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07834}07834\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}independence"{}},\ -\/0.0094,\ 0.78)\ \ \ \ \ \textcolor{comment}{\#\ test\ independence\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07835}07835\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07836}07836\ \ \ \ \ \textcolor{keyword}{def\ }test\_oned(self,\ sim\_type,\ obs\_stat,\ obs\_pvalue):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07837}07837\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07838}07838\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07839}07839\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07840}07840\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=sim\_type)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07841}07841\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07842}07842\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07843}07843\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07844}07844\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ obs\_stat,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07845}07845\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ obs\_pvalue,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07846}07846\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07847}07847\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07848}07848\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}sim\_type,\ obs\_stat,\ obs\_pvalue"{}},\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07849}07849\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}linear"{}},\ 0.184,\ 1/1000),\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ linear\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07850}07850\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}nonlinear"{}},\ 0.0190,\ 0.117),\ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ spiral\ simulation}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07851}07851\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07852}07852\ \ \ \ \ \textcolor{keyword}{def\ }test\_fived(self,\ sim\_type,\ obs\_stat,\ obs\_pvalue):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07853}07853\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07854}07854\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07855}07855\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07856}07856\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=5,\ sim\_type=sim\_type)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07857}07857\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07858}07858\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07859}07859\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07860}07860\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ obs\_stat,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07861}07861\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ obs\_pvalue,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07862}07862\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07863}07863\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.xslow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07864}07864\ \ \ \ \ \textcolor{keyword}{def\ }test\_twosamp(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07865}07865\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07866}07866\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07867}07867\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07868}07868\ \ \ \ \ \ \ \ \ x\ =\ np.random.binomial(100,\ 0.5,\ size=(100,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07869}07869\ \ \ \ \ \ \ \ \ y\ =\ np.random.normal(0,\ 1,\ size=(80,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07870}07870\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07871}07871\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07872}07872\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07873}07873\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ 1.0,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07874}07874\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ 0.001,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07875}07875\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07876}07876\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07877}07877\ \ \ \ \ \ \ \ \ y\ =\ np.random.normal(0,\ 1,\ size=(100,\ 5))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07878}07878\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07879}07879\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07880}07880\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y,\ is\_twosamp=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07881}07881\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ 1.0,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07882}07882\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ 0.001,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07883}07883\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07884}07884\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07885}07885\ \ \ \ \ \textcolor{keyword}{def\ }test\_workers(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07886}07886\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07887}07887\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07888}07888\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07889}07889\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=\textcolor{stringliteral}{"{}linear"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07890}07890\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07891}07891\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07892}07892\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y,\ workers=2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07893}07893\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ 0.97,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07894}07894\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ 0.001,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07895}07895\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07896}07896\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07897}07897\ \ \ \ \ \textcolor{keyword}{def\ }test\_random\_state(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07898}07898\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07899}07899\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=\textcolor{stringliteral}{"{}linear"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07900}07900\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07901}07901\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07902}07902\ \ \ \ \ \ \ \ \ stat,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y,\ random\_state=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07903}07903\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat,\ 0.97,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07904}07904\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue,\ 0.001,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07905}07905\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07906}07906\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07907}07907\ \ \ \ \ \textcolor{keyword}{def\ }test\_dist\_perm(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07908}07908\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07909}07909\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07910}07910\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=\textcolor{stringliteral}{"{}nonlinear"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07911}07911\ \ \ \ \ \ \ \ \ distx\ =\ cdist(x,\ x,\ metric=\textcolor{stringliteral}{"{}euclidean"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07912}07912\ \ \ \ \ \ \ \ \ disty\ =\ cdist(y,\ y,\ metric=\textcolor{stringliteral}{"{}euclidean"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07913}07913\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07914}07914\ \ \ \ \ \ \ \ \ stat\_dist,\ pvalue\_dist,\ \_\ =\ stats.multiscale\_graphcorr(distx,\ disty,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07915}07915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compute\_distance=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07916}07916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07917}07917\ \ \ \ \ \ \ \ \ assert\_approx\_equal(stat\_dist,\ 0.163,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07918}07918\ \ \ \ \ \ \ \ \ assert\_approx\_equal(pvalue\_dist,\ 0.001,\ significant=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07919}07919\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07920}07920\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07921}07921\ \ \ \ \ \textcolor{keyword}{def\ }test\_pvalue\_literature(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07922}07922\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07923}07923\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07924}07924\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07925}07925\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=\textcolor{stringliteral}{"{}linear"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07926}07926\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07927}07927\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ stat\ and\ pvalue}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07928}07928\ \ \ \ \ \ \ \ \ \_,\ pvalue,\ \_\ =\ stats.multiscale\_graphcorr(x,\ y,\ random\_state=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07929}07929\ \ \ \ \ \ \ \ \ assert\_allclose(pvalue,\ 1/1001)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07930}07930\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07931}07931\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07932}07932\ \ \ \ \ \textcolor{keyword}{def\ }test\_alias(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07933}07933\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07934}07934\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07935}07935\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generate\ x\ and\ y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07936}07936\ \ \ \ \ \ \ \ \ x,\ y\ =\ self.\_simulations(samps=100,\ dims=1,\ sim\_type=\textcolor{stringliteral}{"{}linear"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07937}07937\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07938}07938\ \ \ \ \ \ \ \ \ res\ =\ stats.multiscale\_graphcorr(x,\ y,\ random\_state=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07939}07939\ \ \ \ \ \ \ \ \ assert\_equal(res.stat,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07940}07940\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07941}07941\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07942}07942\ \textcolor{keyword}{class\ }TestPageTrendTest:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07943}07943\ \ \ \ \ \textcolor{comment}{\#\ expected\ statistic\ and\ p-\/values\ generated\ using\ R\ at}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07944}07944\ \ \ \ \ \textcolor{comment}{\#\ https://rdrr.io/cran/cultevo/,\ e.g.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07945}07945\ \ \ \ \ \textcolor{comment}{\#\ library(cultevo)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07946}07946\ \ \ \ \ \textcolor{comment}{\#\ data\ =\ rbind(c(72,\ 47,\ 73,\ 35,\ 47,\ 96,\ 30,\ 59,\ 41,\ 36,\ 56,\ 49,\ 81,\ 43,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07947}07947\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 70,\ 47,\ 28,\ 28,\ 62,\ 20,\ 61,\ 20,\ 80,\ 24,\ 50),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07948}07948\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ c(68,\ 52,\ 60,\ 34,\ 44,\ 20,\ 65,\ 88,\ 21,\ 81,\ 48,\ 31,\ 31,\ 67,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07949}07949\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 69,\ 94,\ 30,\ 24,\ 40,\ 87,\ 70,\ 43,\ 50,\ 96,\ 43),}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07950}07950\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ c(81,\ 13,\ 85,\ 35,\ 79,\ 12,\ 92,\ 86,\ 21,\ 64,\ 16,\ 64,\ 68,\ 17,}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07951}07951\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 16,\ 89,\ 71,\ 43,\ 43,\ 36,\ 54,\ 13,\ 66,\ 51,\ 55))}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07952}07952\ \ \ \ \ \textcolor{comment}{\#\ result\ =\ page.test(data,\ verbose=FALSE)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07953}07953\ \ \ \ \ \textcolor{comment}{\#\ Most\ test\ cases\ generated\ to\ achieve\ common\ critical\ p-\/values\ so\ that}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07954}07954\ \ \ \ \ \textcolor{comment}{\#\ results\ could\ be\ checked\ (to\ limited\ precision)\ against\ tables\ in}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07955}07955\ \ \ \ \ \textcolor{comment}{\#\ scipy.stats.page\_trend\_test\ reference\ [1]}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07956}07956\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07957}07957\ \ \ \ \ np.random.seed(0)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07958}07958\ \ \ \ \ data\_3\_25\ =\ np.random.rand(3,\ 25)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07959}07959\ \ \ \ \ data\_10\_26\ =\ np.random.rand(10,\ 26)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07960}07960\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07961}07961\ \ \ \ \ ts\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07962}07962\ \ \ \ \ \ \ \ \ \ \ (12805,\ 0.3886487053947608,\ \textcolor{keyword}{False},\ \textcolor{stringliteral}{'asymptotic'},\ data\_3\_25),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07963}07963\ \ \ \ \ \ \ \ \ \ \ (49140,\ 0.02888978556179862,\ \textcolor{keyword}{False},\ \textcolor{stringliteral}{'asymptotic'},\ data\_10\_26),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07964}07964\ \ \ \ \ \ \ \ \ \ \ (12332,\ 0.7722477197436702,\ \textcolor{keyword}{False},\ \textcolor{stringliteral}{'asymptotic'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07965}07965\ \ \ \ \ \ \ \ \ \ \ \ [[72,\ 47,\ 73,\ 35,\ 47,\ 96,\ 30,\ 59,\ 41,\ 36,\ 56,\ 49,\ 81,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07966}07966\ \ \ \ \ \ \ \ \ \ \ \ \ \ 43,\ 70,\ 47,\ 28,\ 28,\ 62,\ 20,\ 61,\ 20,\ 80,\ 24,\ 50],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07967}07967\ \ \ \ \ \ \ \ \ \ \ \ \ [68,\ 52,\ 60,\ 34,\ 44,\ 20,\ 65,\ 88,\ 21,\ 81,\ 48,\ 31,\ 31,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07968}07968\ \ \ \ \ \ \ \ \ \ \ \ \ \ 67,\ 69,\ 94,\ 30,\ 24,\ 40,\ 87,\ 70,\ 43,\ 50,\ 96,\ 43],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07969}07969\ \ \ \ \ \ \ \ \ \ \ \ \ [81,\ 13,\ 85,\ 35,\ 79,\ 12,\ 92,\ 86,\ 21,\ 64,\ 16,\ 64,\ 68,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07970}07970\ \ \ \ \ \ \ \ \ \ \ \ \ \ 17,\ 16,\ 89,\ 71,\ 43,\ 43,\ 36,\ 54,\ 13,\ 66,\ 51,\ 55]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07971}07971\ \ \ \ \ \ \ \ \ \ \ (266,\ 4.121656378600823e-\/05,\ \textcolor{keyword}{False},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07972}07972\ \ \ \ \ \ \ \ \ \ \ \ [[1.5,\ 4.,\ 8.3,\ 5,\ 19,\ 11],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07973}07973\ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 4,\ 3.5,\ 10,\ 20,\ 21],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07974}07974\ \ \ \ \ \ \ \ \ \ \ \ \ [8.4,\ 3.2,\ 10,\ 12,\ 14,\ 15]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07975}07975\ \ \ \ \ \ \ \ \ \ \ (332,\ 0.9566400920502488,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07976}07976\ \ \ \ \ \ \ \ \ \ \ \ [[4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07977}07977\ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],\ [4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07978}07978\ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 4,\ 1,\ 2],\ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07979}07979\ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4],\ [1,\ 2,\ 3,\ 4]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07980}07980\ \ \ \ \ \ \ \ \ \ \ (241,\ 0.9622210164861476,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07981}07981\ \ \ \ \ \ \ \ \ \ \ \ [[3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07982}07982\ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07983}07983\ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 2,\ 1],\ [2,\ 1,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07984}07984\ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07985}07985\ \ \ \ \ \ \ \ \ \ \ (197,\ 0.9619432897162209,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07986}07986\ \ \ \ \ \ \ \ \ \ \ \ [[6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [1,\ 3,\ 4,\ 5,\ 2,\ 6]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07987}07987\ \ \ \ \ \ \ \ \ \ \ (423,\ 0.9590458306880073,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07988}07988\ \ \ \ \ \ \ \ \ \ \ \ [[5,\ 4,\ 3,\ 2,\ 1],\ [5,\ 4,\ 3,\ 2,\ 1],\ [5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07989}07989\ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 4,\ 3,\ 2,\ 1],\ [5,\ 4,\ 3,\ 2,\ 1],\ [5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07990}07990\ \ \ \ \ \ \ \ \ \ \ \ \ [4,\ 1,\ 3,\ 2,\ 5],\ [1,\ 2,\ 3,\ 4,\ 5],\ [1,\ 2,\ 3,\ 4,\ 5],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07991}07991\ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4,\ 5]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07992}07992\ \ \ \ \ \ \ \ \ \ \ (217,\ 0.9693058575034678,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07993}07993\ \ \ \ \ \ \ \ \ \ \ \ [[3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07994}07994\ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07995}07995\ \ \ \ \ \ \ \ \ \ \ \ \ [2,\ 1,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],\ [1,\ 2,\ 3],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07996}07996\ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07997}07997\ \ \ \ \ \ \ \ \ \ \ (395,\ 0.991530289351305,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07998}07998\ \ \ \ \ \ \ \ \ \ \ \ [[7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l07999}07999\ \ \ \ \ \ \ \ \ \ \ \ \ [6,\ 5,\ 7,\ 4,\ 3,\ 2,\ 1],\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08000}08000\ \ \ \ \ \ \ \ \ \ \ (117,\ 0.9997817843373017,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08001}08001\ \ \ \ \ \ \ \ \ \ \ \ [[3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08002}08002\ \ \ \ \ \ \ \ \ \ \ \ \ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [3,\ 2,\ 1],\ [2,\ 1,\ 3],\ [1,\ 2,\ 3]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08003}08003\ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08004}08004\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08005}08005\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}L,\ p,\ ranked,\ method,\ data"{},\ ts)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08006}08006\ \ \ \ \ \textcolor{keyword}{def\ }test\_accuracy(self,\ L,\ p,\ ranked,\ method,\ data):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08007}08007\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08008}08008\ \ \ \ \ \ \ \ \ res\ =\ stats.page\_trend\_test(data,\ ranked=ranked,\ method=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08009}08009\ \ \ \ \ \ \ \ \ assert\_equal(L,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08010}08010\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ res.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08011}08011\ \ \ \ \ \ \ \ \ assert\_equal(method,\ res.method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08012}08012\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08013}08013\ \ \ \ \ ts2\ =\ [}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08014}08014\ \ \ \ \ \ \ \ \ \ \ \ (542,\ 0.9481266260876332,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08015}08015\ \ \ \ \ \ \ \ \ \ \ \ \ [[10,\ 9,\ 8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08016}08016\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 8,\ 4,\ 7,\ 6,\ 5,\ 9,\ 3,\ 2,\ 10]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08017}08017\ \ \ \ \ \ \ \ \ \ \ \ (1322,\ 0.9993113928199309,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08018}08018\ \ \ \ \ \ \ \ \ \ \ \ \ [[10,\ 9,\ 8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [10,\ 9,\ 8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08019}08019\ \ \ \ \ \ \ \ \ \ \ \ \ \ [10,\ 9,\ 8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [9,\ 2,\ 8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 10,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08020}08020\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8,\ 9,\ 10]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08021}08021\ \ \ \ \ \ \ \ \ \ \ \ (2286,\ 0.9908688345484833,\ \textcolor{keyword}{True},\ \textcolor{stringliteral}{'exact'},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08022}08022\ \ \ \ \ \ \ \ \ \ \ \ \ [[8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08023}08023\ \ \ \ \ \ \ \ \ \ \ \ \ \ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08024}08024\ \ \ \ \ \ \ \ \ \ \ \ \ \ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08025}08025\ \ \ \ \ \ \ \ \ \ \ \ \ \ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08026}08026\ \ \ \ \ \ \ \ \ \ \ \ \ \ [8,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 1],\ [1,\ 3,\ 5,\ 6,\ 4,\ 7,\ 2,\ 8],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08027}08027\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8],\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08028}08028\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8],\ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08029}08029\ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8]]),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08030}08030\ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08031}08031\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08032}08032\ \ \ \ \ \textcolor{comment}{\#\ only\ the\ first\ of\ these\ appears\ slow\ because\ intermediate\ data\ are}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08033}08033\ \ \ \ \ \textcolor{comment}{\#\ cached\ and\ used\ on\ the\ rest}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08034}08034\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}L,\ p,\ ranked,\ method,\ data"{},\ ts)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08035}08035\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.slow()}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08036}08036\ \ \ \ \ \textcolor{keyword}{def\ }test\_accuracy2(self,\ L,\ p,\ ranked,\ method,\ data):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08037}08037\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08038}08038\ \ \ \ \ \ \ \ \ res\ =\ stats.page\_trend\_test(data,\ ranked=ranked,\ method=method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08039}08039\ \ \ \ \ \ \ \ \ assert\_equal(L,\ res.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08040}08040\ \ \ \ \ \ \ \ \ assert\_allclose(p,\ res.pvalue)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08041}08041\ \ \ \ \ \ \ \ \ assert\_equal(method,\ res.method)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08042}08042\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08043}08043\ \ \ \ \ \textcolor{keyword}{def\ }test\_options(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08044}08044\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08045}08045\ \ \ \ \ \ \ \ \ m,\ n\ =\ 10,\ 20}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08046}08046\ \ \ \ \ \ \ \ \ predicted\_ranks\ =\ np.arange(1,\ n+1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08047}08047\ \ \ \ \ \ \ \ \ perm\ =\ np.random.permutation(np.arange(n))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08048}08048\ \ \ \ \ \ \ \ \ data\ =\ np.random.rand(m,\ n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08049}08049\ \ \ \ \ \ \ \ \ ranks\ =\ stats.rankdata(data,\ axis=1)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08050}08050\ \ \ \ \ \ \ \ \ res1\ =\ stats.page\_trend\_test(ranks)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08051}08051\ \ \ \ \ \ \ \ \ res2\ =\ stats.page\_trend\_test(ranks,\ ranked=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08052}08052\ \ \ \ \ \ \ \ \ res3\ =\ stats.page\_trend\_test(data,\ ranked=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08053}08053\ \ \ \ \ \ \ \ \ res4\ =\ stats.page\_trend\_test(ranks,\ predicted\_ranks=predicted\_ranks)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08054}08054\ \ \ \ \ \ \ \ \ res5\ =\ stats.page\_trend\_test(ranks[:,\ perm],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08055}08055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=predicted\_ranks[perm])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08056}08056\ \ \ \ \ \ \ \ \ assert\_equal(res1.statistic,\ res2.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08057}08057\ \ \ \ \ \ \ \ \ assert\_equal(res1.statistic,\ res3.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08058}08058\ \ \ \ \ \ \ \ \ assert\_equal(res1.statistic,\ res4.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08059}08059\ \ \ \ \ \ \ \ \ assert\_equal(res1.statistic,\ res5.statistic)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08060}08060\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08061}08061\ \ \ \ \ \textcolor{keyword}{def\ }test\_Ames\_assay(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08062}08062\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ from\ \_page\_trend\_test.py\ [2]\ page\ 151;\ data\ on\ page\ 144}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08063}08063\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08064}08064\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08065}08065\ \ \ \ \ \ \ \ \ data\ =\ [[101,\ 117,\ 111],\ [91,\ 90,\ 107],\ [103,\ 133,\ 121],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08066}08066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [136,\ 140,\ 144],\ [190,\ 161,\ 201],\ [146,\ 120,\ 116]]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08067}08067\ \ \ \ \ \ \ \ \ data\ =\ np.array(data).T}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08068}08068\ \ \ \ \ \ \ \ \ predicted\_ranks\ =\ np.arange(1,\ 7)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08069}08069\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08070}08070\ \ \ \ \ \ \ \ \ res\ =\ stats.page\_trend\_test(data,\ ranked=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08071}08071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=predicted\_ranks,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08072}08072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{"{}asymptotic"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08073}08073\ \ \ \ \ \ \ \ \ assert\_equal(res.statistic,\ 257)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08074}08074\ \ \ \ \ \ \ \ \ assert\_almost\_equal(res.pvalue,\ 0.0035,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08075}08075\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08076}08076\ \ \ \ \ \ \ \ \ res\ =\ stats.page\_trend\_test(data,\ ranked=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08077}08077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=predicted\_ranks,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08078}08078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{"{}exact"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08079}08079\ \ \ \ \ \ \ \ \ assert\_equal(res.statistic,\ 257)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08080}08080\ \ \ \ \ \ \ \ \ assert\_almost\_equal(res.pvalue,\ 0.0023,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08081}08081\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08082}08082\ \ \ \ \ \textcolor{keyword}{def\ }test\_input\_validation(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08083}08083\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ data\ not\ a\ 2d\ array}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08084}08084\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ 2d\ array."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08085}08085\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08086}08086\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ 2d\ array."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08087}08087\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08088}08088\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ 2d\ array."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08089}08089\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([1,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08090}08090\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ 2d\ array."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08091}08091\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([[[1]]])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08092}08092\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08093}08093\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ invalid\ dimensions}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08094}08094\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Page's\ L\ is\ only\ appropriate"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08095}08095\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(np.random.rand(1,\ 3))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08096}08096\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}Page's\ L\ is\ only\ appropriate"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08097}08097\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(np.random.rand(2,\ 2))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08098}08098\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08099}08099\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ predicted\ ranks\ must\ include\ each\ integer\ [1,\ 2,\ 3]\ exactly\ once}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08100}08100\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}\`{}predicted\_ranks`\ must\ include\ each\ integer"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08101}08101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08102}08102\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08103}08103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=[0,\ 1,\ 2])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08104}08104\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08105}08105\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08106}08106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=[1.1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08107}08107\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08108}08108\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08109}08109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=[1,\ 2,\ 3,\ 3])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08110}08110\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=message):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08111}08111\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08112}08112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ predicted\_ranks=\textcolor{stringliteral}{"{}invalid"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08113}08113\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08114}08114\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ improperly\ ranked\ data}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08115}08115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ is\ not\ properly\ ranked"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08116}08116\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([[0,\ 2,\ 3],\ [1,\ 2,\ 3]],\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08117}08117\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ is\ not\ properly\ ranked"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08118}08118\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([[1,\ 2,\ 3],\ [1,\ 2,\ 4]],\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08119}08119\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08120}08120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ various}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08121}08121\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}data`\ contains\ NaNs"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08122}08122\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test([[1,\ 2,\ 3],\ [1,\ 2,\ np.nan]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08123}08123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ranked=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08124}08124\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(ValueError,\ match=\textcolor{stringliteral}{"{}\`{}method`\ must\ be\ in"{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08125}08125\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08126}08126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method=\textcolor{stringliteral}{"{}ekki"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08127}08127\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ assert\_raises(TypeError,\ match=\textcolor{stringliteral}{"{}\`{}ranked`\ must\ be\ boolean."{}}):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08128}08128\ \ \ \ \ \ \ \ \ \ \ \ \ stats.page\_trend\_test(data=[[1,\ 2,\ 3],\ [1,\ 2,\ 3]],}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08129}08129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ranked=\textcolor{stringliteral}{"{}ekki"{}})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08130}08130\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08131}08131\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08132}08132\ rng\ =\ np.random.default\_rng(902340982)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08133}08133\ x\ =\ rng.random(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08134}08134\ y\ =\ rng.random(10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08135}08135\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08136}08136\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08137}08137\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{"{}fun,\ args"{}},}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08138}08138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(stats.wilcoxon,\ (x,)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08139}08139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (stats.ks\_1samp,\ (x,\ stats.norm.cdf)),\ \ \textcolor{comment}{\#\ type:\ ignore[attr-\/defined]\ \#\ noqa}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08140}08140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (stats.ks\_2samp,\ (x,\ y)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08141}08141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (stats.kstest,\ (x,\ y)),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08142}08142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08143}08143\ \textcolor{keyword}{def\ }test\_rename\_mode\_method(fun,\ args):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08144}08144\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08145}08145\ \ \ \ \ res\ =\ fun(*args,\ method=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08146}08146\ \ \ \ \ res2\ =\ fun(*args,\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08147}08147\ \ \ \ \ assert\_equal(res,\ res2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08148}08148\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08149}08149\ \ \ \ \ err\ =\ rf\textcolor{stringliteral}{"{}\{fun.\_\_name\_\_\}()\ got\ multiple\ values\ for\ argument"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08150}08150\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=re.escape(err)):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08151}08151\ \ \ \ \ \ \ \ \ fun(*args,\ method=\textcolor{stringliteral}{'exact'},\ mode=\textcolor{stringliteral}{'exact'})}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08152}08152\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08153}08153\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08154}08154\ \textcolor{keyword}{class\ }TestExpectile:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08155}08155\ \ \ \ \ \textcolor{keyword}{def\ }test\_same\_as\_mean(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08156}08156\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08157}08157\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08158}08158\ \ \ \ \ \ \ \ \ assert\_allclose(stats.expectile(x,\ alpha=0.5),\ np.mean(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08159}08159\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08160}08160\ \ \ \ \ \textcolor{keyword}{def\ }test\_minimum(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08161}08161\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08162}08162\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08163}08163\ \ \ \ \ \ \ \ \ assert\_allclose(stats.expectile(x,\ alpha=0),\ np.amin(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08164}08164\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08165}08165\ \ \ \ \ \textcolor{keyword}{def\ }test\_maximum(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08166}08166\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08167}08167\ \ \ \ \ \ \ \ \ x\ =\ rng.random(size=20)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08168}08168\ \ \ \ \ \ \ \ \ assert\_allclose(stats.expectile(x,\ alpha=1),\ np.amax(x))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08169}08169\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08170}08170\ \ \ \ \ \textcolor{keyword}{def\ }test\_weights(self):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08171}08171\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expectile\ should\ minimize\ \`{}fun`\ defined\ below;\ see}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08172}08172\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ F.\ Sobotka\ and\ T.\ Kneib,\ "{}Geoadditive\ expectile\ regression"{},}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08173}08173\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computational\ Statistics\ and\ Data\ Analysis\ 56\ (2012)\ 755-\/767}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08174}08174\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ :doi:`10.1016/j.csda.2010.11.015`}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08175}08175\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(1856392524598679138)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08176}08176\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08177}08177\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }fun(u,\ a,\ alpha,\ weights):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08178}08178\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ np.full\_like(a,\ fill\_value=alpha)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08179}08179\ \ \ \ \ \ \ \ \ \ \ \ \ w[a\ <=\ u]\ =\ 1\ -\/\ alpha}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08180}08180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum(w\ *\ weights\ *\ (a\ -\/\ u)**2)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08181}08181\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08182}08182\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }expectile2(a,\ alpha,\ weights):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08183}08183\ \ \ \ \ \ \ \ \ \ \ \ \ bracket\ =\ np.min(a),\ np.max(a)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08184}08184\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ optimize.minimize\_scalar(fun,\ bracket=bracket,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08185}08185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args=(a,\ alpha,\ weights)).x}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08186}08186\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08187}08187\ \ \ \ \ \ \ \ \ n\ =\ 10}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08188}08188\ \ \ \ \ \ \ \ \ a\ =\ rng.random(n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08189}08189\ \ \ \ \ \ \ \ \ alpha\ =\ rng.random()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08190}08190\ \ \ \ \ \ \ \ \ weights\ =\ rng.random(n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08191}08191\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08192}08192\ \ \ \ \ \ \ \ \ res\ =\ stats.expectile(a,\ alpha,\ weights=weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08193}08193\ \ \ \ \ \ \ \ \ ref\ =\ expectile2(a,\ alpha,\ weights)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08194}08194\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ ref)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08195}08195\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08196}08196\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08197}08197\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}alpha"{}},\ [0.2,\ 0.5\ -\/\ 1e-\/12,\ 0.5,\ 0.5\ +\ 1e-\/12,\ 0.8]}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08198}08198\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08199}08199\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n"{},\ [20,\ 2000])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08200}08200\ \ \ \ \ \textcolor{keyword}{def\ }test\_expectile\_properties(self,\ alpha,\ n):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08201}08201\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08202}08202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ Section\ 6\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08203}08203\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ I.\ Steinwart,\ C.\ Pasin,\ R.C.\ Williamson\ \&\ S.\ Zhang\ (2014).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08204}08204\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}Elicitation\ and\ Identification\ of\ Properties"{}.\ COLT.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08205}08205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ http://proceedings.mlr.press/v35/steinwart14.html}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08206}08206\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08207}08207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08208}08208\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08209}08209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Propositions\ 5,\ 6,\ 7\ of}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08210}08210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ F.\ Bellini,\ B.\ Klar,\ and\ A.\ Mller\ and\ E.\ Rosazza\ Gianin\ (2013).}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08211}08211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}Generalized\ Quantiles\ as\ Risk\ Measures"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08212}08212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ http://doi.org/10.2139/ssrn.2225751}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08213}08213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08214}08214\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08215}08215\ \ \ \ \ \ \ \ \ x\ =\ rng.normal(size=n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08216}08216\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08217}08217\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 0.\ definite\ /\ constancy}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08218}08218\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Let\ T(X)\ denote\ the\ expectile\ of\ rv\ X\ \string~\ F.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08219}08219\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(c)\ =\ c\ for\ constant\ c}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08220}08220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ [-\/5,\ 0,\ 0.5]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08221}08221\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08222}08222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(np.full(shape=n,\ fill\_value=c),\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08223}08223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08224}08224\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08225}08225\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08226}08226\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 1.\ translation\ equivariance}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08227}08227\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(X\ +\ c)\ =\ T(X)\ +\ c}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08228}08228\ \ \ \ \ \ \ \ \ c\ =\ rng.exponential()}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08229}08229\ \ \ \ \ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08230}08230\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x\ +\ c,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08231}08231\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x,\ alpha=alpha)\ +\ c,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08232}08232\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08233}08233\ \ \ \ \ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08234}08234\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x\ -\/\ c,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08235}08235\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x,\ alpha=alpha)\ -\/\ c,}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08236}08236\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08237}08237\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08238}08238\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2.\ positively\ homogeneity}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08239}08239\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(cX)\ =\ c\ *\ T(X)\ for\ c\ >\ 0}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08240}08240\ \ \ \ \ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08241}08241\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(c\ *\ x,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08242}08242\ \ \ \ \ \ \ \ \ \ \ \ \ c\ *\ stats.expectile(x,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08243}08243\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08244}08244\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08245}08245\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 3.\ subadditivity}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08246}08246\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ subadditivity\ holds\ for\ alpha\ >=\ 0.5.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08247}08247\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(X\ +\ Y)\ <=\ T(X)\ +\ T(Y)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08248}08248\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ alpha\ =\ 0.5,\ i.e.\ the\ mean,\ strict\ equality\ holds.}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08249}08249\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ alpha\ <\ 0.5,\ one\ can\ use\ property\ 6.\ to\ show}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08250}08250\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(X\ +\ Y)\ >=\ T(X)\ +\ T(Y)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08251}08251\ \ \ \ \ \ \ \ \ y\ =\ rng.logistic(size=n,\ loc=10)\ \ \textcolor{comment}{\#\ different\ distibution\ than\ x}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08252}08252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ alpha\ ==\ 0.5:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08253}08253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }assert\_op(a,\ b):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08254}08254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(a,\ b)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08255}08255\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08256}08256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ alpha\ >\ 0.5:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08257}08257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }assert\_op(a,\ b):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08258}08258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ a\ <\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08259}08259\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08260}08260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08261}08261\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }assert\_op(a,\ b):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08262}08262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ a\ >\ b}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08263}08263\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08264}08264\ \ \ \ \ \ \ \ \ assert\_op(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08265}08265\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(np.r\_[x\ +\ y],\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08266}08266\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x,\ alpha=alpha)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08267}08267\ \ \ \ \ \ \ \ \ \ \ \ \ +\ stats.expectile(y,\ alpha=alpha)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08268}08268\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08269}08269\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08270}08270\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 4.\ monotonicity}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08271}08271\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ holds\ for\ first\ order\ stochastic\ dominance\ X:}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08272}08272\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ X\ >=\ Y\ whenever\ P(X\ <=\ x)\ <\ P(Y\ <=\ x)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08273}08273\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T(X)\ <=\ T(Y)\ whenever\ X\ <=\ Y}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08274}08274\ \ \ \ \ \ \ \ \ y\ =\ rng.normal(size=n,\ loc=5)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08275}08275\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08276}08276\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(x,\ alpha=alpha)\ <=\ stats.expectile(y,\ alpha=alpha)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08277}08277\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08278}08278\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08279}08279\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 5.\ convexity\ for\ alpha\ >\ 0.5,\ concavity\ for\ alpha\ <\ 0.5}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08280}08280\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ convexity\ is}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08281}08281\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T((1\ -\/\ c)\ X\ +\ c\ Y)\ <=\ (1\ -\/\ c)\ T(X)\ +\ c\ T(Y)\ for\ 0\ <=\ c\ <=\ 1}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08282}08282\ \ \ \ \ \ \ \ \ y\ =\ rng.logistic(size=n,\ loc=10)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08283}08283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ [0.1,\ 0.5,\ 0.8]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08284}08284\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_op(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08285}08285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile((1-\/c)*x\ +\ c*y,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08286}08286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1-\/c)\ *\ stats.expectile(x,\ alpha=alpha)\ +}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08287}08287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ *\ stats.expectile(y,\ alpha=alpha)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08288}08288\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08289}08289\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08290}08290\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 6.\ negative\ argument}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08291}08291\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T\_\{alpha\}(-\/X)\ =\ -\/T\_\{1-\/alpha\}(X)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08292}08292\ \ \ \ \ \ \ \ \ assert\_allclose(}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08293}08293\ \ \ \ \ \ \ \ \ \ \ \ \ stats.expectile(-\/x,\ alpha=alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08294}08294\ \ \ \ \ \ \ \ \ \ \ \ \ -\/stats.expectile(x,\ alpha=1-\/alpha),}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08295}08295\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08296}08296\ }
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08297}08297\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n"{},\ [20,\ 2000])}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08298}08298\ \ \ \ \ \textcolor{keyword}{def\ }test\_monotonicity\_in\_alpha(self,\ n):}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08299}08299\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(42)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08300}08300\ \ \ \ \ \ \ \ \ x\ =\ rng.pareto(a=2,\ size=n)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08301}08301\ \ \ \ \ \ \ \ \ e\_list\ =\ []}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08302}08302\ \ \ \ \ \ \ \ \ alpha\_seq\ =\ np.logspace(-\/15,\ np.log10(0.5),\ 100)}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08303}08303\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sorted\ list\ of\ unique\ alpha\ values\ in\ interval\ (0,\ 1)}}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08304}08304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ alpha\ \textcolor{keywordflow}{in}\ np.r\_[0,\ alpha\_seq,\ 1\ -\/\ alpha\_seq[:-\/1:-\/1],\ 1]:}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08305}08305\ \ \ \ \ \ \ \ \ \ \ \ \ e\_list.append(stats.expectile(x,\ alpha=alpha))}
\DoxyCodeLine{\Hypertarget{scipy_2stats_2tests_2test__stats_8py_source_l08306}08306\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ np.all(np.diff(e\_list)\ >\ 0)}

\end{DoxyCode}
