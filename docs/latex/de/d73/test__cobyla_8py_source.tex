\doxysection{test\+\_\+cobyla.\+py}
\hypertarget{test__cobyla_8py_source}{}\label{test__cobyla_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/tests/test\_cobyla.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/tests/test\_cobyla.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1tests_1_1test__cobyla}{00001}}\ \textcolor{keyword}{import}\ math}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00002}00002\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_allclose,\ assert\_,\ assert\_array\_equal}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ fmin\_cobyla,\ minimize,\ Bounds}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00009}\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla}{00009}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla}{TestCobyla}}:}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00010}00010\ \ \ \ \ \textcolor{keyword}{def\ }setup\_method(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00011}00011\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a748d59ee9eee7b4e3e7f7cd2067fbe99}{x0}}\ =\ [4.95,\ 0.66]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a8e58655ba4e7af3478aa887666b8e5f3}{solution}}\ =\ [math.sqrt(25\ -\/\ (2.0/3)**2),\ 2.0/3]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00013}00013\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ad085a0e740e9cbe91dbc3e2445b0ef42}{opts}}\ =\ \{\textcolor{stringliteral}{'disp'}:\ \textcolor{keyword}{False},\ \textcolor{stringliteral}{'rhobeg'}:\ 1,\ \textcolor{stringliteral}{'tol'}:\ 1e-\/5,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00014}00014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'maxiter'}:\ 100\}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00016}00016\ \ \ \ \ \textcolor{keyword}{def\ }fun(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x[0]**2\ +\ abs(x[1])**3}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00019}00019\ \ \ \ \ \textcolor{keyword}{def\ }con1(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x[0]**2\ +\ x[1]**2\ -\/\ 25}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{def\ }con2(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a73d2fc218451946f0d983a88bc3f8aac}{con1}}(x)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{def\ }test\_simple(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ use\ disp=True\ as\ smoke\ test\ for\ gh-\/8118}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ x\ =\ fmin\_cobyla(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ade04cc1aef793c219e1b12f00b9ebb0f}{fun}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a748d59ee9eee7b4e3e7f7cd2067fbe99}{x0}},\ [self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a73d2fc218451946f0d983a88bc3f8aac}{con1}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ab28afb2ef44b0a8ce10c597a592433d9}{con2}}],\ rhobeg=1,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rhoend=1e-\/5,\ maxfun=100,\ disp=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ assert\_allclose(x,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a8e58655ba4e7af3478aa887666b8e5f3}{solution}},\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{def\ }test\_minimize\_simple(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \textcolor{keyword}{class\ }Callback:}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a61ad016d6c8c1d6654332505efd1e1b7}{n\_calls}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a37fe29852514b2af2c5a455f1034a945}{last\_x}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a61ad016d6c8c1d6654332505efd1e1b7}{n\_calls}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a37fe29852514b2af2c5a455f1034a945}{last\_x}}\ =\ x}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ callback\ =\ Callback()}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Minimize\ with\ method='COBYLA'}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ cons\ =\ (\{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a73d2fc218451946f0d983a88bc3f8aac}{con1}}\},}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ab28afb2ef44b0a8ce10c597a592433d9}{con2}}\})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ sol\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ade04cc1aef793c219e1b12f00b9ebb0f}{fun}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a748d59ee9eee7b4e3e7f7cd2067fbe99}{x0}},\ method=\textcolor{stringliteral}{'cobyla'},\ constraints=cons,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ callback=callback,\ options=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ad085a0e740e9cbe91dbc3e2445b0ef42}{opts}})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ assert\_allclose(sol.x,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a8e58655ba4e7af3478aa887666b8e5f3}{solution}},\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ assert\_(sol.success,\ sol.message)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ assert\_(sol.maxcv\ <\ 1e-\/5,\ sol)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ assert\_(sol.nfev\ <\ 70,\ sol)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ assert\_(sol.fun\ <\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_ade04cc1aef793c219e1b12f00b9ebb0f}{fun}}(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestCobyla_a8e58655ba4e7af3478aa887666b8e5f3}{solution}})\ +\ 1e-\/3,\ sol)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ assert\_(sol.nfev\ ==\ callback.n\_calls,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Callback\ is\ not\ called\ exactly\ once\ for\ every\ function\ eval."{}})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ assert\_array\_equal(sol.x,\ callback.last\_x,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Last\ design\ vector\ sent\ to\ the\ callback\ is\ not\ equal\ to\ returned\ value."{}})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00058}00058\ \ \ \ \ \textcolor{keyword}{def\ }test\_minimize\_constraint\_violation(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ np.random.seed(1234)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ pb\ =\ np.random.rand(10,\ 10)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ spread\ =\ np.random.rand(10)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }p(w):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pb.dot(w)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }f(w):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/(w\ *\ spread).sum()}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }c1(w):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 500\ -\/\ abs(p(w)).sum()}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }c2(w):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 5\ -\/\ abs(p(w).sum())}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }c3(w):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 5\ -\/\ abs(p(w)).max()}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ cons\ =\ (\{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ c1\},}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ c2\},}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ c3\})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ w0\ =\ np.zeros((10,))}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ sol\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(f,\ w0,\ method=\textcolor{stringliteral}{'cobyla'},\ constraints=cons,}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options=\{\textcolor{stringliteral}{'catol'}:\ 1e-\/6\})}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ assert\_(sol.maxcv\ >\ 1e-\/6)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ assert\_(\textcolor{keywordflow}{not}\ sol.success)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00088}00088\ \textcolor{keyword}{def\ }test\_vector\_constraints():}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00089}00089\ \ \ \ \ \textcolor{comment}{\#\ test\ that\ fmin\_cobyla\ and\ minimize\ can\ take\ a\ combination}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00090}00090\ \ \ \ \ \textcolor{comment}{\#\ of\ constraints,\ some\ returning\ a\ number\ and\ others\ an\ array}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00091}00091\ \ \ \ \ \textcolor{keyword}{def\ }fun(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (x[0]\ -\/\ 1)**2\ +\ (x[1]\ -\/\ 2.5)**2}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00094}00094\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__optimize_a1c8825f72fbb699b9d86a64dfd7f2d5b}{fmin}}(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ fun(x)\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00097}00097\ \ \ \ \ \textcolor{keyword}{def\ }cons1(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ a\ =\ np.array([[1,\ -\/2,\ 2],\ [-\/1,\ -\/2,\ 6],\ [-\/1,\ 2,\ 2]])}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.array([a[i,\ 0]\ *\ x[0]\ +\ a[i,\ 1]\ *\ x[1]\ +}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[i,\ 2]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(a))])}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00102}00102\ \ \ \ \ \textcolor{keyword}{def\ }cons2(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ \ \ \ \ \textcolor{comment}{\#\ identity,\ acts\ as\ bounds\ x\ >\ 0}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00105}00105\ \ \ \ \ x0\ =\ np.array([2,\ 0])}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00106}00106\ \ \ \ \ cons\_list\ =\ [fun,\ cons1,\ cons2]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00108}00108\ \ \ \ \ xsol\ =\ [1.4,\ 1.7]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00109}00109\ \ \ \ \ fsol\ =\ 0.8}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00111}00111\ \ \ \ \ \textcolor{comment}{\#\ testing\ fmin\_cobyla}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00112}00112\ \ \ \ \ sol\ =\ fmin\_cobyla(fun,\ x0,\ cons\_list,\ rhoend=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00113}00113\ \ \ \ \ assert\_allclose(sol,\ xsol,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00115}00115\ \ \ \ \ sol\ =\ fmin\_cobyla(fun,\ x0,\ fmin,\ rhoend=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00116}00116\ \ \ \ \ assert\_allclose(fun(sol),\ 1,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00118}00118\ \ \ \ \ \textcolor{comment}{\#\ testing\ minimize}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00119}00119\ \ \ \ \ constraints\ =\ [\{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ cons\}\ \textcolor{keywordflow}{for}\ cons\ \textcolor{keywordflow}{in}\ cons\_list]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00120}00120\ \ \ \ \ sol\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(fun,\ x0,\ constraints=constraints,\ tol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00121}00121\ \ \ \ \ assert\_allclose(sol.x,\ xsol,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00122}00122\ \ \ \ \ assert\_(sol.success,\ sol.message)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00123}00123\ \ \ \ \ assert\_allclose(sol.fun,\ fsol,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00125}00125\ \ \ \ \ constraints\ =\ \{\textcolor{stringliteral}{'type'}:\ \textcolor{stringliteral}{'ineq'},\ \textcolor{stringliteral}{'fun'}:\ fmin\}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00126}00126\ \ \ \ \ sol\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(fun,\ x0,\ constraints=constraints,\ tol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00127}00127\ \ \ \ \ assert\_allclose(sol.fun,\ 1,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00130}\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestBounds}{00130}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test__cobyla_1_1TestBounds}{TestBounds}}:}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00131}00131\ \ \ \ \ \textcolor{comment}{\#\ Test\ cobyla\ support\ for\ bounds\ (only\ when\ used\ via\ \`{}minimize`)}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00132}00132\ \ \ \ \ \textcolor{comment}{\#\ Invalid\ bounds\ is\ tested\ in}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00133}00133\ \ \ \ \ \textcolor{comment}{\#\ test\_optimize.TestOptimizeSimple.test\_minimize\_invalid\_bounds}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00135}00135\ \ \ \ \ \textcolor{keyword}{def\ }test\_basic(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }f(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum(x**2)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ lb\ =\ [-\/1,\ \textcolor{keywordtype}{None},\ 1,\ \textcolor{keywordtype}{None},\ -\/0.5]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ ub\ =\ [-\/0.5,\ -\/0.5,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ -\/0.5]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ bounds\ =\ [(a,\ b)\ \textcolor{keywordflow}{for}\ a,\ b\ \textcolor{keywordflow}{in}\ zip(lb,\ ub)]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ these\ are\ converted\ to\ Bounds\ internally}}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(f,\ x0=[1,\ 2,\ 3,\ 4,\ 5],\ method=\textcolor{stringliteral}{'cobyla'},\ bounds=bounds)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ ref\ =\ [-\/0.5,\ -\/0.5,\ 1,\ 0,\ -\/0.5]}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.success}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ assert\_allclose(res.x,\ ref,\ atol=1e-\/3)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00149}00149\ \ \ \ \ \textcolor{keyword}{def\ }test\_unbounded(self):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }f(x):}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum(x**2)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ bounds\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__constraints_1_1Bounds}{Bounds}}([-\/np.inf,\ -\/np.inf],\ [np.inf,\ np.inf])}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(f,\ x0=[1,\ 2],\ method=\textcolor{stringliteral}{'cobyla'},\ bounds=bounds)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.success}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ assert\_allclose(res.x,\ 0,\ atol=1e-\/3)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ bounds\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__constraints_1_1Bounds}{Bounds}}([1,\ -\/np.inf],\ [np.inf,\ np.inf])}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__minimize_a06b55f429535e64a7a09e3106bce5381}{minimize}}(f,\ x0=[1,\ 2],\ method=\textcolor{stringliteral}{'cobyla'},\ bounds=bounds)}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ res.success}
\DoxyCodeLine{\Hypertarget{test__cobyla_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ assert\_allclose(res.x,\ [1,\ 0],\ atol=1e-\/3)}

\end{DoxyCode}
