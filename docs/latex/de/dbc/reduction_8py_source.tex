\doxysection{reduction.\+py}
\hypertarget{reduction_8py_source}{}\label{reduction_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/backend/reduction.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/backend/reduction.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction}{00001}}\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00011}00011\ \textcolor{keyword}{import}\ copyreg}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00012}00012\ \textcolor{keyword}{import}\ io}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00013}00013\ \textcolor{keyword}{import}\ functools}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00014}00014\ \textcolor{keyword}{import}\ types}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00015}00015\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00016}00016\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00018}00018\ \textcolor{keyword}{from}\ multiprocessing\ \textcolor{keyword}{import}\ util}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00019}00019\ \textcolor{keyword}{from}\ pickle\ \textcolor{keyword}{import}\ loads,\ HIGHEST\_PROTOCOL}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00024}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_a792a883e5a3df5474d2f9af18753c69c}{00024}}\ \_dispatch\_table\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00027}00027\ \textcolor{keyword}{def\ }register(type\_,\ reduce\_function):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00028}00028\ \ \ \ \ \_dispatch\_table[type\_]\ =\ reduce\_function}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00035}00035\ \textcolor{comment}{\#\ make\ methods\ picklable}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00036}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_ad8c30eccc1db645f7ecbee120fe7d197}{00036}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_ad8c30eccc1db645f7ecbee120fe7d197}{\_reduce\_method}}(m):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00037}00037\ \ \ \ \ \textcolor{keywordflow}{if}\ m.\_\_self\_\_\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ getattr,\ (m.\_\_class\_\_,\ m.\_\_func\_\_.\_\_name\_\_)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ getattr,\ (m.\_\_self\_\_,\ m.\_\_func\_\_.\_\_name\_\_)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00043}\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1reduction_1_1__C}{00043}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1reduction_1_1__C}{\_C}}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{def\ }f(self):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00047}00047\ \ \ \ \ \textcolor{preprocessor}{@classmethod}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00048}00048\ \ \ \ \ \textcolor{keyword}{def\ }h(cls):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00052}00052\ register(type(\_C().f),\ \_reduce\_method)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00053}00053\ register(type(\_C.h),\ \_reduce\_method)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00056}00056\ \textcolor{keyword}{def\ }\_reduce\_method\_descriptor(m):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00057}00057\ \ \ \ \ \textcolor{keywordflow}{return}\ getattr,\ (m.\_\_objclass\_\_,\ m.\_\_name\_\_)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00060}00060\ register(type(list.append),\ \_reduce\_method\_descriptor)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00061}00061\ register(type(int.\_\_add\_\_),\ \_reduce\_method\_descriptor)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00064}00064\ \textcolor{comment}{\#\ Make\ partial\ func\ pickable}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00065}00065\ \textcolor{keyword}{def\ }\_reduce\_partial(p):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00066}00066\ \ \ \ \ \textcolor{keywordflow}{return}\ \_rebuild\_partial,\ (p.func,\ p.args,\ p.keywords\ \textcolor{keywordflow}{or}\ \{\})}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00069}00069\ \textcolor{keyword}{def\ }\_rebuild\_partial(func,\ args,\ keywords):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{return}\ functools.partial(func,\ *args,\ **keywords)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00073}00073\ register(functools.partial,\ \_reduce\_partial)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00075}00075\ \textcolor{keywordflow}{if}\ sys.platform\ !=\ \textcolor{stringliteral}{"{}win32"{}}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00076}00076\ \ \ \ \ \textcolor{keyword}{from}\ .\_posix\_reduction\ \textcolor{keyword}{import}\ \_mk\_inheritable\ \ \textcolor{comment}{\#\ noqa:\ F401}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00077}00077\ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00078}00078\ \ \ \ \ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ \_win\_reduction\ \ \textcolor{comment}{\#\ noqa:\ F401}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00080}00080\ \textcolor{comment}{\#\ global\ variable\ to\ change\ the\ pickler\ behavior}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00081}00081\ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00082}00082\ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1externals}{joblib.externals}}\ \textcolor{keyword}{import}\ cloudpickle\ \ \textcolor{comment}{\#\ noqa:\ F401}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00084}00084\ \ \ \ \ DEFAULT\_ENV\ =\ \textcolor{stringliteral}{"{}cloudpickle"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00085}00085\ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00086}00086\ \ \ \ \ \textcolor{comment}{\#\ If\ cloudpickle\ is\ not\ present,\ fallback\ to\ pickle}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00087}00087\ \ \ \ \ DEFAULT\_ENV\ =\ \textcolor{stringliteral}{"{}pickle"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00089}00089\ ENV\_LOKY\_PICKLER\ =\ os.environ.get(\textcolor{stringliteral}{"{}LOKY\_PICKLER"{}},\ DEFAULT\_ENV)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00090}00090\ \_LokyPickler\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00091}00091\ \_loky\_pickler\_name\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00094}00094\ \textcolor{keyword}{def\ }set\_loky\_pickler(loky\_pickler=None):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00095}00095\ \ \ \ \ \textcolor{keyword}{global}\ \_LokyPickler,\ \_loky\_pickler\_name}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00097}00097\ \ \ \ \ \textcolor{keywordflow}{if}\ loky\_pickler\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ loky\_pickler\ =\ ENV\_LOKY\_PICKLER}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00100}00100\ \ \ \ \ loky\_pickler\_cls\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00102}00102\ \ \ \ \ \textcolor{comment}{\#\ The\ default\ loky\_pickler\ is\ cloudpickle}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00103}00103\ \ \ \ \ \textcolor{keywordflow}{if}\ loky\_pickler\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{"{}"{}},\ \textcolor{keywordtype}{None}]:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ loky\_pickler\ =\ \textcolor{stringliteral}{"{}cloudpickle"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00106}00106\ \ \ \ \ \textcolor{keywordflow}{if}\ loky\_pickler\ ==\ \_loky\_pickler\_name:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00109}00109\ \ \ \ \ \textcolor{keywordflow}{if}\ loky\_pickler\ ==\ \textcolor{stringliteral}{"{}cloudpickle"{}}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacejoblib_1_1externals_1_1cloudpickle}{joblib.externals.cloudpickle}}\ \textcolor{keyword}{import}\ CloudPickler\ \textcolor{keyword}{as}\ loky\_pickler\_cls}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ importlib\ \textcolor{keyword}{import}\ import\_module}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ module\_pickle\ =\ import\_module(loky\_pickler)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ loky\_pickler\_cls\ =\ module\_pickle.Pickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ (ImportError,\ AttributeError)\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ extra\_info\ =\ (}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)nThis\ error\ occurred\ while\ setting\ loky\_pickler\ to"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ '\{loky\_pickler\}',\ as\ required\ by\ the\ env\ variable\ "{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}LOKY\_PICKLER\ or\ the\ function\ set\_loky\_pickler."{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ e.args\ =\ (e.args[0]\ +\ extra\_info,)\ +\ e.args[1:]}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ e.msg\ =\ e.args[0]}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ e}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00127}00127\ \ \ \ \ util.debug(}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Using\ '\{loky\_pickler\ if\ loky\_pickler\ else\ 'cloudpickle'\}'\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}serialization."{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00130}00130\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00132}00132\ \ \ \ \ \textcolor{keyword}{class\ }CustomizablePickler(loky\_pickler\_cls):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \_loky\_pickler\_cls\ =\ loky\_pickler\_cls}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_set\_dispatch\_table(self,\ dispatch\_table):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ancestor\_class\ \textcolor{keywordflow}{in}\ self.\_loky\_pickler\_cls.mro():}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dt\_attribute\ =\ getattr(ancestor\_class,\ \textcolor{stringliteral}{"{}dispatch\_table"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(dt\_attribute,\ types.MemberDescriptorType):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ancestor\ class\ (typically\ \_pickle.Pickler)\ has\ a}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ member\_descriptor\ for\ its\ "{}dispatch\_table"{}\ attribute.\ Use}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ it\ to\ set\ the\ dispatch\_table\ as\ a\ member\ instead\ of\ a}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ dynamic\ attribute\ in\ the\ \_\_dict\_\_\ of\ the\ instance,}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ otherwise\ it\ will\ not\ be\ taken\ into\ account\ by\ the\ C}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ implementation\ of\ the\ dump\ method\ if\ a\ subclass\ defines\ a}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ class-\/level\ dispatch\_table\ attribute\ as\ was\ done\ in}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cloudpickle\ 1.6.0:}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://github.com/joblib/loky/pull/260}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dt\_attribute.\_\_set\_\_(self,\ dispatch\_table)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ On\ top\ of\ member\ descriptor\ set,\ also\ use\ setattr\ such\ that\ code}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ that\ directly\ access\ self.dispatch\_table\ gets\ a\ consistent\ view}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ the\ same\ table.}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ self.dispatch\_table\ =\ dispatch\_table}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ writer,\ reducers=None,\ protocol=HIGHEST\_PROTOCOL):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ loky\_pickler\_cls.\_\_init\_\_(self,\ writer,\ protocol=protocol)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ reducers\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reducers\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(self,\ \textcolor{stringliteral}{"{}dispatch\_table"{}}):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Force\ a\ copy\ that\ we\ will\ update\ without\ mutating\ the}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ any\ class\ level\ defined\ dispatch\_table.}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ loky\_dt\ =\ dict(self.dispatch\_table)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Use\ standard\ reducers\ as\ bases}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ loky\_dt\ =\ copyreg.dispatch\_table.copy()}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Register\ loky\ specific\ reducers}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ loky\_dt.update(\_dispatch\_table)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ the\ new\ dispatch\ table,\ taking\ care\ of\ the\ fact\ that\ we}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ need\ to\ use\ the\ member\_descriptor\ when\ we\ inherit\ from\ a}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ subclass\ of\ the\ C\ implementation\ of\ the\ Pickler\ base\ class}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ an\ class\ level\ dispatch\_table\ attribute.}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_set\_dispatch\_table(loky\_dt)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Register\ the\ reducers}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ type,\ reduce\_func\ \textcolor{keywordflow}{in}\ reducers.items():}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.register(type,\ reduce\_func)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }register(self,\ type,\ reduce\_func):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Attach\ a\ reducer\ function\ to\ a\ given\ type\ in\ the\ dispatch\ table."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ self.dispatch\_table[type]\ =\ reduce\_func}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00186}00186\ \ \ \ \ \_LokyPickler\ =\ CustomizablePickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00187}00187\ \ \ \ \ \_loky\_pickler\_name\ =\ loky\_pickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00190}00190\ \textcolor{keyword}{def\ }get\_loky\_pickler\_name():}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00191}00191\ \ \ \ \ \textcolor{keyword}{global}\ \_loky\_pickler\_name}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00192}00192\ \ \ \ \ \textcolor{keywordflow}{return}\ \_loky\_pickler\_name}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00195}00195\ \textcolor{keyword}{def\ }get\_loky\_pickler():}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00196}00196\ \ \ \ \ \textcolor{keyword}{global}\ \_LokyPickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00197}00197\ \ \ \ \ \textcolor{keywordflow}{return}\ \_LokyPickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00200}00200\ \textcolor{comment}{\#\ Set\ it\ to\ its\ default\ value}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00201}00201\ set\_loky\_pickler()}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00204}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_a9ea17da14a0a0d378eba9cf9d69e6f79}{00204}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_a9ea17da14a0a0d378eba9cf9d69e6f79}{dump}}(obj,\ file,\ reducers=None,\ protocol=None):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00205}00205\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Replacement\ for\ pickle.dump()\ using\ \_LokyPickler."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00206}00206\ \ \ \ \ \textcolor{keyword}{global}\ \_LokyPickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00207}00207\ \ \ \ \ \_LokyPickler(file,\ reducers=reducers,\ protocol=protocol).\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_a9ea17da14a0a0d378eba9cf9d69e6f79}{dump}}(obj)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00210}00210\ \textcolor{keyword}{def\ }dumps(obj,\ reducers=None,\ protocol=None):}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00211}00211\ \ \ \ \ \textcolor{keyword}{global}\ \_LokyPickler}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00212}00212\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00213}00213\ \ \ \ \ buf\ =\ io.BytesIO()}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00214}00214\ \ \ \ \ \mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1reduction_a9ea17da14a0a0d378eba9cf9d69e6f79}{dump}}(obj,\ buf,\ reducers=reducers,\ protocol=protocol)}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00215}00215\ \ \ \ \ \textcolor{keywordflow}{return}\ buf.getbuffer()}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00218}00218\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{"{}dump"{}},\ \textcolor{stringliteral}{"{}dumps"{}},\ \textcolor{stringliteral}{"{}loads"{}},\ \textcolor{stringliteral}{"{}register"{}},\ \textcolor{stringliteral}{"{}set\_loky\_pickler"{}}]}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00219}00219\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00220}00220\ \textcolor{keywordflow}{if}\ sys.platform\ ==\ \textcolor{stringliteral}{"{}win32"{}}:}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00221}00221\ \ \ \ \ \textcolor{keyword}{from}\ multiprocessing.reduction\ \textcolor{keyword}{import}\ duplicate}
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{reduction_8py_source_l00223}00223\ \ \ \ \ \_\_all\_\_\ +=\ [\textcolor{stringliteral}{"{}duplicate"{}}]}

\end{DoxyCode}
