\doxysection{test\+\_\+animation.\+py}
\hypertarget{test__animation_8py_source}{}\label{test__animation_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/matplotlib/tests/test\_animation.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/matplotlib/tests/test\_animation.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00001}\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00002}00002\ \textcolor{keyword}{from}\ pathlib\ \textcolor{keyword}{import}\ Path}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00003}00003\ \textcolor{keyword}{import}\ platform}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00004}00004\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00005}00005\ \textcolor{keyword}{import}\ shutil}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00006}00006\ \textcolor{keyword}{import}\ subprocess}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00007}00007\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00008}00008\ \textcolor{keyword}{import}\ weakref}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00010}00010\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00011}00011\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00013}00013\ \textcolor{keyword}{import}\ matplotlib\ \textcolor{keyword}{as}\ mpl}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00014}00014\ \textcolor{keyword}{from}\ matplotlib\ \textcolor{keyword}{import}\ pyplot\ \textcolor{keyword}{as}\ plt}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00015}00015\ \textcolor{keyword}{from}\ matplotlib\ \textcolor{keyword}{import}\ animation}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00016}00016\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1animation}{matplotlib.animation}}\ \textcolor{keyword}{import}\ PillowWriter}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00017}00017\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1testing_1_1decorators}{matplotlib.testing.decorators}}\ \textcolor{keyword}{import}\ check\_figures\_equal}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00020}00020\ \textcolor{preprocessor}{@pytest.fixture()}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00021}\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_a7b13a3b6a5dedbf61193c34853fde449}{00021}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_a7b13a3b6a5dedbf61193c34853fde449}{anim}}(request):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00022}00022\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Create\ a\ simple\ animation\ (with\ options)."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00023}00023\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00024}00024\ \ \ \ \ line,\ =\ ax.plot([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00026}00026\ \ \ \ \ ax.set\_xlim(0,\ 10)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00027}00027\ \ \ \ \ ax.set\_ylim(-\/1,\ 1)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00029}00029\ \ \ \ \ \textcolor{keyword}{def\ }init():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ line.set\_data([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{def\ }animate(i):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 10,\ 100)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ y\ =\ np.sin(x\ +\ i)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ line.set\_data(x,\ y)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00039}00039\ \ \ \ \ \textcolor{comment}{\#\ "{}klass"{}\ can\ be\ passed\ to\ determine\ the\ class\ returned\ by\ the\ fixture}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00040}00040\ \ \ \ \ kwargs\ =\ dict(getattr(request,\ \textcolor{stringliteral}{'param'},\ \{\}))\ \ \textcolor{comment}{\#\ make\ a\ copy}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00041}00041\ \ \ \ \ klass\ =\ kwargs.pop(\textcolor{stringliteral}{'klass'},\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00042}00042\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{'frames'}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ kwargs:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ kwargs[\textcolor{stringliteral}{'frames'}]\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00044}00044\ \ \ \ \ \textcolor{keywordflow}{return}\ klass(fig=fig,\ func=animate,\ init\_func=init,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00047}\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter}{00047}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter}{NullMovieWriter}}(\mbox{\hyperlink{classmatplotlib_1_1animation_1_1AbstractMovieWriter}{animation.AbstractMovieWriter}}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00048}00048\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ A\ minimal\ MovieWriter.\ \ It\ doesn't\ actually\ write\ anything.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ It\ just\ saves\ the\ arguments\ that\ were\ given\ to\ the\ setup()\ and}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ grab\_frame()\ methods\ as\ attributes,\ and\ counts\ how\ many\ times}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ grab\_frame()\ is\ called.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00053}00053\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ This\ class\ doesn't\ have\ an\ \_\_init\_\_\ method\ with\ the\ appropriate}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ signature,\ and\ it\ doesn't\ define\ an\ isAvailable()\ method,\ so}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ it\ cannot\ be\ added\ to\ the\ 'writers'\ registry.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00059}\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_a9a77c6060959c21e7f017f8c19c8bd9b}{00059}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesetup}{setup}}(self,\ fig,\ outfile,\ dpi,\ *args):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1animation_1_1AbstractMovieWriter_a835eff7e0ac625992e7f708448e88fa6}{fig}}\ =\ fig}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1animation_1_1AbstractMovieWriter_ae2006c1ca69618ec02514264a9f318e1}{outfile}}\ =\ outfile}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1animation_1_1AbstractMovieWriter_aaca5ed6ef95c99e03830b346425ee9bc}{dpi}}\ =\ dpi}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_afda41d5cd597bbc853a3a67a8f7b5840}{args}}\ =\ args}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_ae58572cecb50a468bbd39321ef5b032c}{\_count}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00066}\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_ac6131d5ed5d45f6d39e6501914eb927d}{00066}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_ac6131d5ed5d45f6d39e6501914eb927d}{grab\_frame}}(self,\ **savefig\_kwargs):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1animation}{matplotlib.animation}}\ \textcolor{keyword}{import}\ \_validate\_grabframe\_kwargs}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \_validate\_grabframe\_kwargs(savefig\_kwargs)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_aac8e7518460aaa00edeac663ad79ab21}{savefig\_kwargs}}\ =\ savefig\_kwargs}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_ae58572cecb50a468bbd39321ef5b032c}{\_count}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00072}\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_a3b06ef8919b6d72787e26850ce8ec2a0}{00072}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter_a3b06ef8919b6d72787e26850ce8ec2a0}{finish}}(self):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00076}00076\ \textcolor{keyword}{def\ }test\_null\_movie\_writer(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00077}00077\ \ \ \ \ \textcolor{comment}{\#\ Test\ running\ an\ animation\ with\ NullMovieWriter.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00078}00078\ \ \ \ \ plt.rcParams[\textcolor{stringliteral}{"{}savefig.facecolor"{}}]\ =\ \textcolor{stringliteral}{"{}auto"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00079}00079\ \ \ \ \ filename\ =\ \textcolor{stringliteral}{"{}unused.null"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00080}00080\ \ \ \ \ dpi\ =\ 50}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00081}00081\ \ \ \ \ savefig\_kwargs\ =\ dict(foo=0)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00082}00082\ \ \ \ \ writer\ =\ NullMovieWriter()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00084}00084\ \ \ \ \ anim.save(filename,\ dpi=dpi,\ writer=writer,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ savefig\_kwargs=savefig\_kwargs)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00087}00087\ \ \ \ \ \textcolor{keyword}{assert}\ writer.fig\ ==\ plt.figure(1)\ \ \textcolor{comment}{\#\ The\ figure\ used\ by\ anim\ fixture}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00088}00088\ \ \ \ \ \textcolor{keyword}{assert}\ writer.outfile\ ==\ filename}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00089}00089\ \ \ \ \ \textcolor{keyword}{assert}\ writer.dpi\ ==\ dpi}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00090}00090\ \ \ \ \ \textcolor{keyword}{assert}\ writer.args\ ==\ ()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00091}00091\ \ \ \ \ \textcolor{comment}{\#\ we\ enrich\ the\ savefig\ kwargs\ to\ ensure\ we\ composite\ transparent}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00092}00092\ \ \ \ \ \textcolor{comment}{\#\ output\ to\ an\ opaque\ background}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00093}00093\ \ \ \ \ \textcolor{keywordflow}{for}\ k,\ v\ \textcolor{keywordflow}{in}\ savefig\_kwargs.items():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ writer.savefig\_kwargs[k]\ ==\ v}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00095}00095\ \ \ \ \ \textcolor{keyword}{assert}\ writer.\_count\ ==\ anim.\_save\_count}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00098}00098\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00099}00099\ \textcolor{keyword}{def\ }test\_animation\_delete(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00100}00100\ \ \ \ \ \textcolor{keywordflow}{if}\ platform.python\_implementation()\ ==\ \textcolor{stringliteral}{'PyPy'}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Something\ in\ the\ test\ setup\ fixture\ lingers\ around\ into\ the\ test\ and}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ breaks\ pytest.warns\ on\ PyPy.\ This\ garbage\ collection\ fixes\ it.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://foss.heptapod.net/pypy/pypy/-\//issues/3536}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ np.testing.break\_cycles()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00105}00105\ \ \ \ \ anim\ =\ animation.FuncAnimation(**anim)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00106}00106\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(Warning,\ match=\textcolor{stringliteral}{'Animation\ was\ deleted'}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ del\ anim}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ np.testing.break\_cycles()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00111}00111\ \textcolor{keyword}{def\ }test\_movie\_writer\_dpi\_default():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00112}00112\ \ \ \ \ \textcolor{keyword}{class\ }DummyMovieWriter(animation.MovieWriter):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }\_run(self):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00116}00116\ \ \ \ \ \textcolor{comment}{\#\ Test\ setting\ up\ movie\ writer\ with\ figure.dpi\ default.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00117}00117\ \ \ \ \ fig\ =\ plt.figure()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00119}00119\ \ \ \ \ filename\ =\ \textcolor{stringliteral}{"{}unused.null"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00120}00120\ \ \ \ \ fps\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00121}00121\ \ \ \ \ codec\ =\ \textcolor{stringliteral}{"{}unused"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00122}00122\ \ \ \ \ bitrate\ =\ 1}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00123}00123\ \ \ \ \ extra\_args\ =\ [\textcolor{stringliteral}{"{}unused"{}}]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00125}00125\ \ \ \ \ writer\ =\ DummyMovieWriter(fps,\ codec,\ bitrate,\ extra\_args)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00126}00126\ \ \ \ \ writer.setup(fig,\ filename)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00127}00127\ \ \ \ \ \textcolor{keyword}{assert}\ writer.dpi\ ==\ fig.dpi}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00130}00130\ \textcolor{preprocessor}{@animation.writers.register('null')}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00131}\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1RegisteredNullMovieWriter}{00131}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1RegisteredNullMovieWriter}{RegisteredNullMovieWriter}}(\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter}{NullMovieWriter}}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00133}00133\ \ \ \ \ \textcolor{comment}{\#\ To\ be\ able\ to\ add\ NullMovieWriter\ to\ the\ 'writers'\ registry,}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00134}00134\ \ \ \ \ \textcolor{comment}{\#\ we\ must\ define\ an\ \_\_init\_\_\ method\ with\ a\ specific\ signature,}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00135}00135\ \ \ \ \ \textcolor{comment}{\#\ and\ we\ must\ define\ the\ class\ method\ isAvailable().}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00136}00136\ \ \ \ \ \textcolor{comment}{\#\ (These\ methods\ are\ not\ actually\ required\ to\ use\ an\ instance}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00137}00137\ \ \ \ \ \textcolor{comment}{\#\ of\ this\ class\ as\ the\ 'writer'\ argument\ of\ Animation.save().)}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00139}00139\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ fps=None,\ codec=None,\ bitrate=None,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extra\_args=None,\ metadata=None):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00143}00143\ \ \ \ \ \textcolor{preprocessor}{@classmethod}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00144}00144\ \ \ \ \ \textcolor{keyword}{def\ }isAvailable(cls):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00148}00148\ WRITER\_OUTPUT\ =\ [}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00149}00149\ \ \ \ \ (\textcolor{stringliteral}{'ffmpeg'},\ \textcolor{stringliteral}{'movie.mp4'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00150}00150\ \ \ \ \ (\textcolor{stringliteral}{'ffmpeg\_file'},\ \textcolor{stringliteral}{'movie.mp4'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00151}00151\ \ \ \ \ (\textcolor{stringliteral}{'imagemagick'},\ \textcolor{stringliteral}{'movie.gif'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00152}00152\ \ \ \ \ (\textcolor{stringliteral}{'imagemagick\_file'},\ \textcolor{stringliteral}{'movie.gif'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00153}00153\ \ \ \ \ (\textcolor{stringliteral}{'pillow'},\ \textcolor{stringliteral}{'movie.gif'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00154}00154\ \ \ \ \ (\textcolor{stringliteral}{'html'},\ \textcolor{stringliteral}{'movie.html'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00155}00155\ \ \ \ \ (\textcolor{stringliteral}{'null'},\ \textcolor{stringliteral}{'movie.null'})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00156}00156\ ]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00159}00159\ \textcolor{keyword}{def\ }gen\_writers():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00160}00160\ \ \ \ \ \textcolor{keywordflow}{for}\ writer,\ output\ \textcolor{keywordflow}{in}\ WRITER\_OUTPUT:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ animation.writers.is\_available(writer):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ mark\ =\ pytest.mark.skip(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}writer\ '\{writer\}'\ not\ available\ on\ this\ system"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ pytest.param(writer,\ \textcolor{keywordtype}{None},\ output,\ marks=[mark])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ pytest.param(writer,\ \textcolor{keywordtype}{None},\ Path(output),\ marks=[mark])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ writer\_class\ =\ animation.writers[writer]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ frame\_format\ \textcolor{keywordflow}{in}\ getattr(writer\_class,\ \textcolor{stringliteral}{'supported\_formats'},\ [\textcolor{keywordtype}{None}]):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ writer,\ frame\_format,\ output}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ writer,\ frame\_format,\ Path(output)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00174}00174\ \textcolor{comment}{\#\ Smoke\ test\ for\ saving\ animations.\ \ In\ the\ future,\ we\ should\ probably}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00175}00175\ \textcolor{comment}{\#\ design\ more\ sophisticated\ tests\ which\ compare\ resulting\ frames\ a-\/la}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00176}00176\ \textcolor{comment}{\#\ matplotlib.testing.image\_comparison}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00177}00177\ \textcolor{preprocessor}{@pytest.mark.parametrize('writer,\ frame\_format,\ output',\ gen\_writers()})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00178}00178\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00179}00179\ \textcolor{keyword}{def\ }test\_save\_animation\_smoketest(tmpdir,\ writer,\ frame\_format,\ output,\ anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00180}00180\ \ \ \ \ \textcolor{keywordflow}{if}\ frame\_format\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ plt.rcParams[\textcolor{stringliteral}{"{}animation.frame\_format"{}}]\ =\ frame\_format}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00182}00182\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(**anim)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00183}00183\ \ \ \ \ dpi\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00184}00184\ \ \ \ \ codec\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00185}00185\ \ \ \ \ \textcolor{keywordflow}{if}\ writer\ ==\ \textcolor{stringliteral}{'ffmpeg'}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Issue\ \#8253}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ anim.\_fig.set\_size\_inches((10.85,\ 9.21))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ dpi\ =\ 100.}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ codec\ =\ \textcolor{stringliteral}{'h264'}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00191}00191\ \ \ \ \ \textcolor{comment}{\#\ Use\ temporary\ directory\ for\ the\ file-\/based\ writers,\ which\ produce\ a\ file}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00192}00192\ \ \ \ \ \textcolor{comment}{\#\ per\ frame\ with\ known\ names.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00193}00193\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ anim.save(output,\ fps=30,\ writer=writer,\ bitrate=500,\ dpi=dpi,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ codec=codec)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00197}00197\ \ \ \ \ del\ anim}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00200}00200\ \textcolor{preprocessor}{@pytest.mark.parametrize('writer,\ frame\_format,\ output',\ gen\_writers()})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00201}00201\ \textcolor{keyword}{def\ }test\_grabframe(tmpdir,\ writer,\ frame\_format,\ output):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00202}00202\ \ \ \ \ WriterClass\ =\ animation.writers[writer]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00204}00204\ \ \ \ \ \textcolor{keywordflow}{if}\ frame\_format\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ plt.rcParams[\textcolor{stringliteral}{"{}animation.frame\_format"{}}]\ =\ frame\_format}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00207}00207\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00209}00209\ \ \ \ \ dpi\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00210}00210\ \ \ \ \ codec\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00211}00211\ \ \ \ \ \textcolor{keywordflow}{if}\ writer\ ==\ \textcolor{stringliteral}{'ffmpeg'}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Issue\ \#8253}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ fig.set\_size\_inches((10.85,\ 9.21))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ dpi\ =\ 100.}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ codec\ =\ \textcolor{stringliteral}{'h264'}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00217}00217\ \ \ \ \ test\_writer\ =\ WriterClass()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00218}00218\ \ \ \ \ \textcolor{comment}{\#\ Use\ temporary\ directory\ for\ the\ file-\/based\ writers,\ which\ produce\ a\ file}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00219}00219\ \ \ \ \ \textcolor{comment}{\#\ per\ frame\ with\ known\ names.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00220}00220\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ test\_writer.saving(fig,\ output,\ dpi):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ smoke\ test\ it\ works}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ test\_writer.grab\_frame()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'dpi'},\ \textcolor{stringliteral}{'bbox\_inches'},\ \textcolor{stringliteral}{'format'}\}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TypeError,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ match=f\textcolor{stringliteral}{"{}grab\_frame\ got\ an\ unexpected\ keyword\ argument\ \{k!r\}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_writer.grab\_frame(**\{k:\ object()\})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00232}00232\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'writer'},\ [}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00233}00233\ \ \ \ \ pytest.param(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ffmpeg'},\ marks=pytest.mark.skipif(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ animation.FFMpegWriter.isAvailable(),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ reason=\textcolor{stringliteral}{'Requires\ FFMpeg'})),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00237}00237\ \ \ \ \ pytest.param(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'imagemagick'},\ marks=pytest.mark.skipif(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ animation.ImageMagickWriter.isAvailable(),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ reason=\textcolor{stringliteral}{'Requires\ ImageMagick'})),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00241}00241\ ])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00242}00242\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'html,\ want'},\ [}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00243}00243\ \ \ \ \ (\textcolor{stringliteral}{'none'},\ \textcolor{keywordtype}{None}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00244}00244\ \ \ \ \ (\textcolor{stringliteral}{'html5'},\ \textcolor{stringliteral}{'<video\ width'}),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00245}00245\ \ \ \ \ (\textcolor{stringliteral}{'jshtml'},\ \textcolor{stringliteral}{'<script\ '})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00246}00246\ ])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00247}00247\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00248}00248\ \textcolor{keyword}{def\ }test\_animation\_repr\_html(writer,\ html,\ want,\ anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00249}00249\ \ \ \ \ \textcolor{keywordflow}{if}\ platform.python\_implementation()\ ==\ \textcolor{stringliteral}{'PyPy'}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Something\ in\ the\ test\ setup\ fixture\ lingers\ around\ into\ the\ test\ and}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ breaks\ pytest.warns\ on\ PyPy.\ This\ garbage\ collection\ fixes\ it.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://foss.heptapod.net/pypy/pypy/-\//issues/3536}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ np.testing.break\_cycles()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00254}00254\ \ \ \ \ \textcolor{keywordflow}{if}\ (writer\ ==\ \textcolor{stringliteral}{'imagemagick'}\ \textcolor{keywordflow}{and}\ html\ ==\ \textcolor{stringliteral}{'html5'}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ImageMagick\ delegates\ to\ ffmpeg\ for\ this\ format.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ animation.FFMpegWriter.isAvailable()):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ pytest.skip(\textcolor{stringliteral}{'Requires\ FFMpeg'})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00258}00258\ \ \ \ \ \textcolor{comment}{\#\ create\ here\ rather\ than\ in\ the\ fixture\ otherwise\ we\ get\ \_\_del\_\_\ warnings}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00259}00259\ \ \ \ \ \textcolor{comment}{\#\ about\ producing\ no\ output}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00260}00260\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(**anim)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00261}00261\ \ \ \ \ \textcolor{keyword}{with}\ plt.rc\_context(\{\textcolor{stringliteral}{'animation.writer'}:\ writer,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'animation.html'}:\ html\}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ html\ =\ anim.\_repr\_html\_()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00264}00264\ \ \ \ \ \textcolor{keywordflow}{if}\ want\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ html\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ del\ anim\ \ \textcolor{comment}{\#\ Animation\ was\ never\ run,\ so\ will\ warn\ on\ cleanup.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ np.testing.break\_cycles()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00269}00269\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ want\ \textcolor{keywordflow}{in}\ html}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00271}00271\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00273}00273\ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00274}00274\ \ \ \ \ \textcolor{stringliteral}{'anim'},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00275}00275\ \ \ \ \ [\{\textcolor{stringliteral}{'save\_count'}:\ 10,\ \textcolor{stringliteral}{'frames'}:\ iter(range(5))\}],}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00276}00276\ \ \ \ \ indirect=[\textcolor{stringliteral}{'anim'}]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00277}00277\ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00278}00278\ \textcolor{keyword}{def\ }test\_no\_length\_frames(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00279}00279\ \ \ \ \ anim.save(\textcolor{stringliteral}{'unused.null'},\ writer=\mbox{\hyperlink{classmatplotlib_1_1tests_1_1test__animation_1_1NullMovieWriter}{NullMovieWriter}}())}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00280}00280\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00282}00282\ \textcolor{keyword}{def\ }test\_movie\_writer\_registry():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00283}00283\ \ \ \ \ \textcolor{keyword}{assert}\ len(animation.writers.\_registered)\ >\ 0}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00284}00284\ \ \ \ \ mpl.rcParams[\textcolor{stringliteral}{'animation.ffmpeg\_path'}]\ =\ \textcolor{stringliteral}{"{}not\_available\_ever\_xxxx"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00285}00285\ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ animation.writers.is\_available(\textcolor{stringliteral}{"{}ffmpeg"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00286}00286\ \ \ \ \ \textcolor{comment}{\#\ something\ guaranteed\ to\ be\ available\ in\ path\ and\ exits\ immediately}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00287}00287\ \ \ \ \ bin\ =\ \textcolor{stringliteral}{"{}true"{}}\ \textcolor{keywordflow}{if}\ sys.platform\ !=\ \textcolor{stringliteral}{'win32'}\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}where"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00288}00288\ \ \ \ \ mpl.rcParams[\textcolor{stringliteral}{'animation.ffmpeg\_path'}]\ =\ bin}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00289}00289\ \ \ \ \ \textcolor{keyword}{assert}\ animation.writers.is\_available(\textcolor{stringliteral}{"{}ffmpeg"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00291}00291\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00292}00292\ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00293}00293\ \ \ \ \ \textcolor{stringliteral}{"{}method\_name"{}},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00294}00294\ \ \ \ \ [pytest.param(\textcolor{stringliteral}{"{}to\_html5\_video"{}},\ marks=pytest.mark.skipif(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ animation.writers.is\_available(mpl.rcParams[\textcolor{stringliteral}{"{}animation.writer"{}}]),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ reason=\textcolor{stringliteral}{"{}animation\ writer\ not\ installed"{}})),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00297}00297\ \ \ \ \ \ \textcolor{stringliteral}{"{}to\_jshtml"{}}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00298}00298\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(frames=1)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00299}00299\ \textcolor{keyword}{def\ }test\_embed\_limit(method\_name,\ caplog,\ tmpdir,\ anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00300}00300\ \ \ \ \ caplog.set\_level(\textcolor{stringliteral}{"{}WARNING"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00301}00301\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ mpl.rc\_context(\{\textcolor{stringliteral}{"{}animation.embed\_limit"{}}:\ 1e-\/6\}):\ \ \textcolor{comment}{\#\ \string~1\ byte.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ getattr(anim,\ method\_name)()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00304}00304\ \ \ \ \ \textcolor{keyword}{assert}\ len(caplog.records)\ ==\ 1}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00305}00305\ \ \ \ \ record,\ =\ caplog.records}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00306}00306\ \ \ \ \ \textcolor{keyword}{assert}\ (record.name\ ==\ \textcolor{stringliteral}{"{}matplotlib.animation"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ record.levelname\ ==\ \textcolor{stringliteral}{"{}WARNING"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00310}00310\ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00311}00311\ \ \ \ \ \textcolor{stringliteral}{"{}method\_name"{}},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00312}00312\ \ \ \ \ [pytest.param(\textcolor{stringliteral}{"{}to\_html5\_video"{}},\ marks=pytest.mark.skipif(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ animation.writers.is\_available(mpl.rcParams[\textcolor{stringliteral}{"{}animation.writer"{}}]),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ reason=\textcolor{stringliteral}{"{}animation\ writer\ not\ installed"{}})),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00315}00315\ \ \ \ \ \ \textcolor{stringliteral}{"{}to\_jshtml"{}}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00316}00316\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(frames=1)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00317}00317\ \textcolor{keyword}{def\ }test\_cleanup\_temporaries(method\_name,\ tmpdir,\ anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00318}00318\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ getattr(anim,\ method\_name)()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ list(Path(str(tmpdir)).iterdir())\ ==\ []}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00323}00323\ \textcolor{preprocessor}{@pytest.mark.skipif(shutil.which("{}/bin/sh"{})}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None},\ reason=\textcolor{stringliteral}{"{}requires\ a\ POSIX\ OS"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00324}\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_aebacba0a82cbaa3ca10f66d0dc14d608}{00324}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_aebacba0a82cbaa3ca10f66d0dc14d608}{test\_failing\_ffmpeg}}(tmpdir,\ monkeypatch,\ anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00325}00325\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ Test\ that\ we\ correctly\ raise\ a\ CalledProcessError\ when\ ffmpeg\ fails.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00327}00327\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ To\ do\ so,\ mock\ ffmpeg\ using\ a\ simple\ executable\ shell\ script\ that}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ succeeds\ when\ called\ with\ no\ arguments\ (so\ that\ it\ gets\ registered\ by}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ \`{}isAvailable\`{}),\ but\ fails\ otherwise,\ and\ add\ it\ to\ the\ \$PATH.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00332}00332\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ monkeypatch.setenv(\textcolor{stringliteral}{"{}PATH"{}},\ \textcolor{stringliteral}{"{}.:"{}}\ +\ os.environ[\textcolor{stringliteral}{"{}PATH"{}}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ exe\_path\ =\ Path(str(tmpdir),\ \textcolor{stringliteral}{"{}ffmpeg"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ exe\_path.write\_bytes(b\textcolor{stringliteral}{"{}\#!/bin/sh\(\backslash\)n[[\ \$@\ -\/eq\ 0\ ]]\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ os.chmod(exe\_path,\ 0o755)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(subprocess.CalledProcessError):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ anim.save(\textcolor{stringliteral}{"{}test.mpeg"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00341}00341\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}cache\_frame\_data"{},\ [False,\ True])}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00342}00342\ \textcolor{keyword}{def\ }test\_funcanimation\_cache\_frame\_data(cache\_frame\_data):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00343}00343\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00344}00344\ \ \ \ \ line,\ =\ ax.plot([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00345}00345\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00346}00346\ \ \ \ \ \textcolor{keyword}{class\ }Frame(dict):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ this\ subclassing\ enables\ to\ use\ weakref.ref()}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00350}00350\ \ \ \ \ \textcolor{keyword}{def\ }init():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ line.set\_data([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00353}00353\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00354}00354\ \ \ \ \ \textcolor{keyword}{def\ }animate(frame):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ line.set\_data(frame[\textcolor{stringliteral}{'x'}],\ frame[\textcolor{stringliteral}{'y'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00358}00358\ \ \ \ \ frames\_generated\ =\ []}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00360}00360\ \ \ \ \ \textcolor{keyword}{def\ }frames\_generator():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(5):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 10,\ 100)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ np.random.rand(100)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00364}00364\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \ \ frame\ =\ Frame(x=x,\ y=y)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ collect\ weak\ references\ to\ frames}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ validate\ their\ references\ later}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ \ \ \ \ frames\_generated.append(weakref.ref(frame))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ frame}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00372}00372\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00373}00373\ \ \ \ \ MAX\_FRAMES\ =\ 100}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00374}00374\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(fig,\ animate,\ init\_func=init,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ frames=frames\_generator,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00376}00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache\_frame\_data=cache\_frame\_data,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ save\_count=MAX\_FRAMES)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00378}00378\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00379}00379\ \ \ \ \ writer\ =\ NullMovieWriter()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00380}00380\ \ \ \ \ anim.save(\textcolor{stringliteral}{'unused.null'},\ writer=writer)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00381}00381\ \ \ \ \ \textcolor{keyword}{assert}\ len(frames\_generated)\ ==\ 5}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00382}00382\ \ \ \ \ np.testing.break\_cycles()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00383}00383\ \ \ \ \ \textcolor{keywordflow}{for}\ f\ \textcolor{keywordflow}{in}\ frames\_generated:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00384}00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ cache\_frame\_data\ is\ True,\ then\ the\ weakref\ should\ be\ alive;}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ cache\_frame\_data\ is\ False,\ then\ the\ weakref\ should\ be\ dead\ (None).}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00386}00386\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (f()\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None})\ !=\ cache\_frame\_data}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00389}00389\ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'return\_value'},\ [}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00390}00390\ \ \ \ \ \textcolor{comment}{\#\ User\ forgot\ to\ return\ (returns\ None).}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00391}00391\ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00392}00392\ \ \ \ \ \textcolor{comment}{\#\ User\ returned\ a\ string.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00393}00393\ \ \ \ \ \textcolor{stringliteral}{'string'},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00394}00394\ \ \ \ \ \textcolor{comment}{\#\ User\ returned\ an\ int.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00395}00395\ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00396}00396\ \ \ \ \ \textcolor{comment}{\#\ User\ returns\ a\ sequence\ of\ other\ objects,\ e.g.,\ string\ instead\ of\ Artist.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00397}00397\ \ \ \ \ (\textcolor{stringliteral}{'string'},\ ),}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00398}00398\ \ \ \ \ \textcolor{comment}{\#\ User\ forgot\ to\ return\ a\ sequence\ (handled\ in\ \`{}animate`\ below.)}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00399}00399\ \ \ \ \ \textcolor{stringliteral}{'artist'},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00400}00400\ ])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00401}00401\ \textcolor{keyword}{def\ }test\_draw\_frame(return\_value):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00402}00402\ \ \ \ \ \textcolor{comment}{\#\ test\ \_draw\_frame\ method}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00403}00403\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00404}00404\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00405}00405\ \ \ \ \ line,\ =\ ax.plot([])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00407}00407\ \ \ \ \ \textcolor{keyword}{def\ }animate(i):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ general\ update\ func}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ line.set\_data([0,\ 1],\ [0,\ i])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_value\ ==\ \textcolor{stringliteral}{'artist'}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *not*\ a\ sequence}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ return\_value}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00415}00415\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00416}00416\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(RuntimeError):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ fig,\ animate,\ blit=\textcolor{keyword}{True},\ cache\_frame\_data=\textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00420}00420\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00421}00421\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00422}00422\ \textcolor{keyword}{def\ }test\_exhausted\_animation(tmpdir):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00423}00423\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00424}00424\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00425}00425\ \ \ \ \ \textcolor{keyword}{def\ }update(frame):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ []}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00427}00427\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00428}00428\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ fig,\ update,\ frames=iter(range(10)),\ repeat=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ cache\_frame\_data=\textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00431}00431\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00432}00432\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00433}00433\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ anim.save(\textcolor{stringliteral}{"{}test.gif"{}},\ writer=\textcolor{stringliteral}{'pillow'})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00435}00435\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00436}00436\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning,\ match=\textcolor{stringliteral}{"{}exhausted"{}}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ anim.\_start()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00439}00439\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00440}00440\ \textcolor{keyword}{def\ }test\_no\_frame\_warning(tmpdir):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00441}00441\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00442}00442\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00443}00443\ \ \ \ \ \textcolor{keyword}{def\ }update(frame):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ []}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00445}00445\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00446}00446\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ fig,\ update,\ frames=[],\ repeat=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ cache\_frame\_data=\textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00449}00449\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00450}00450\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00451}00451\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning,\ match=\textcolor{stringliteral}{"{}exhausted"{}}):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00452}00452\ \ \ \ \ \ \ \ \ anim.\_start()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00453}00453\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00454}00454\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00455}00455\ \textcolor{preprocessor}{@check\_figures\_equal(extensions=["{}png"{}])}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00456}00456\ \textcolor{keyword}{def\ }test\_animation\_frame(tmpdir,\ fig\_test,\ fig\_ref):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00457}00457\ \ \ \ \ \textcolor{comment}{\#\ Test\ the\ expected\ image\ after\ iterating\ through\ a\ few\ frames}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00458}00458\ \ \ \ \ \textcolor{comment}{\#\ we\ save\ the\ animation\ to\ get\ the\ iteration\ because\ we\ are\ not}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00459}00459\ \ \ \ \ \textcolor{comment}{\#\ in\ an\ interactive\ framework.}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00460}00460\ \ \ \ \ ax\ =\ fig\_test.add\_subplot()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00461}00461\ \ \ \ \ ax.set\_xlim(0,\ 2\ *\ np.pi)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00462}00462\ \ \ \ \ ax.set\_ylim(-\/1,\ 1)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00463}00463\ \ \ \ \ x\ =\ np.linspace(0,\ 2\ *\ np.pi,\ 100)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00464}00464\ \ \ \ \ line,\ =\ ax.plot([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00465}00465\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00466}00466\ \ \ \ \ \textcolor{keyword}{def\ }init():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ line.set\_data([],\ [])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00469}00469\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00470}00470\ \ \ \ \ \textcolor{keyword}{def\ }animate(i):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ line.set\_data(x,\ np.sin(x\ +\ i\ /\ 100))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ line,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00473}00473\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00474}00474\ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ fig\_test,\ animate,\ init\_func=init,\ frames=5,}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ blit=\textcolor{keyword}{True},\ repeat=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00477}00477\ \ \ \ \ \textcolor{keyword}{with}\ tmpdir.as\_cwd():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ anim.save(\textcolor{stringliteral}{"{}test.gif"{}})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00479}00479\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00480}00480\ \ \ \ \ \textcolor{comment}{\#\ Reference\ figure\ without\ animation}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00481}00481\ \ \ \ \ ax\ =\ fig\_ref.add\_subplot()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00482}00482\ \ \ \ \ ax.set\_xlim(0,\ 2\ *\ np.pi)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00483}00483\ \ \ \ \ ax.set\_ylim(-\/1,\ 1)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00484}00484\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00485}00485\ \ \ \ \ \textcolor{comment}{\#\ 5th\ frame's\ data}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00486}00486\ \ \ \ \ ax.plot(x,\ np.sin(x\ +\ 4\ /\ 100))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00488}00488\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00489}00489\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00490}00490\ \textcolor{keyword}{def\ }test\_save\_count\_override\_warnings\_has\_length(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00491}00491\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00492}00492\ \ \ \ \ save\_count\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00493}00493\ \ \ \ \ frames\ =\ list(range(2))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00494}00494\ \ \ \ \ match\_target\ =\ (}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00495}00495\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{'You\ passed\ in\ an\ explicit\ \{save\_count=\}\ '}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00496}00496\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}which\ is\ being\ ignored\ in\ favor\ of\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00497}00497\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{len(frames)=\}."{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00498}00498\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00499}00499\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00500}00500\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning,\ match=re.escape(match\_target)):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \ \ **\{**anim,\ \textcolor{stringliteral}{'frames'}:\ frames,\ \textcolor{stringliteral}{'save\_count'}:\ save\_count\}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00503}00503\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00504}00504\ \ \ \ \ \textcolor{keyword}{assert}\ anim.\_save\_count\ ==\ len(frames)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00505}00505\ \ \ \ \ anim.\_init\_draw()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00506}00506\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00507}00507\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00508}00508\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00509}00509\ \textcolor{keyword}{def\ }test\_save\_count\_override\_warnings\_scaler(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00510}00510\ \ \ \ \ save\_count\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00511}00511\ \ \ \ \ frames\ =\ 7}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00512}00512\ \ \ \ \ match\_target\ =\ (}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00513}00513\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{'You\ passed\ in\ an\ explicit\ \{save\_count=\}\ '}\ +}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00514}00514\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}which\ is\ being\ ignored\ in\ favor\ of\ "{}}\ +}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00515}00515\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{frames=\}."{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00516}00516\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00517}00517\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00518}00518\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning,\ match=re.escape(match\_target)):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ **\{**anim,\ \textcolor{stringliteral}{'frames'}:\ frames,\ \textcolor{stringliteral}{'save\_count'}:\ save\_count\}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00523}00523\ \ \ \ \ \textcolor{keyword}{assert}\ anim.\_save\_count\ ==\ frames}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00524}00524\ \ \ \ \ anim.\_init\_draw()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00525}00525\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00526}00526\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00527}00527\ \textcolor{preprocessor}{@pytest.mark.parametrize('anim',\ [dict(klass=dict)}],\ indirect=[\textcolor{stringliteral}{'anim'}])}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00528}00528\ \textcolor{keyword}{def\ }test\_disable\_cache\_warning(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00529}00529\ \ \ \ \ cache\_frame\_data\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00530}00530\ \ \ \ \ frames\ =\ iter(range(5))}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00531}00531\ \ \ \ \ match\_target\ =\ (}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00532}00532\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{frames=!r\}\ which\ we\ can\ infer\ the\ length\ of,\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00533}00533\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}did\ not\ pass\ an\ explicit\ *save\_count*\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00534}00534\ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}and\ passed\ \{cache\_frame\_data=\}.\ \ To\ avoid\ a\ possibly\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00535}00535\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}unbounded\ cache,\ frame\ data\ caching\ has\ been\ disabled.\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00536}00536\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}To\ suppress\ this\ warning\ either\ pass\ "{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00537}00537\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\`{}cache\_frame\_data=False`\ or\ \`{}save\_count=MAX\_FRAMES`."{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00538}00538\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00539}00539\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(UserWarning,\ match=re.escape(match\_target)):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ anim\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1FuncAnimation}{animation.FuncAnimation}}(}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \ \ \ **\{**anim,\ \textcolor{stringliteral}{'cache\_frame\_data'}:\ cache\_frame\_data,\ \textcolor{stringliteral}{'frames'}:\ frames\}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00543}00543\ \ \ \ \ \textcolor{keyword}{assert}\ anim.\_cache\_frame\_data\ \textcolor{keywordflow}{is}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00544}00544\ \ \ \ \ anim.\_init\_draw()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00545}00545\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00546}00546\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00547}00547\ \textcolor{keyword}{def\ }test\_movie\_writer\_invalid\_path(anim):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00548}00548\ \ \ \ \ \textcolor{keywordflow}{if}\ sys.platform\ ==\ \textcolor{stringliteral}{"{}win32"{}}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00549}00549\ \ \ \ \ \ \ \ \ match\_str\ =\ \textcolor{stringliteral}{r"{}\(\backslash\)[WinError\ 3]\ .*'\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)foo\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)bar\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)aardvark'"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00550}00550\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00551}00551\ \ \ \ \ \ \ \ \ match\_str\ =\ \textcolor{stringliteral}{r"{}\(\backslash\)[Errno\ 2]\ .*'/foo"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00552}00552\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(FileNotFoundError,\ match=match\_str):}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ anim.save(\textcolor{stringliteral}{"{}/foo/bar/aardvark/thiscannotreallyexist.mp4"{}},}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00554}00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ writer=\mbox{\hyperlink{classmatplotlib_1_1animation_1_1FFMpegFileWriter}{animation.FFMpegFileWriter}}())}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00555}00555\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00556}00556\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00557}\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_ab284377a0284d626a9d5653c492397c4}{00557}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tests_1_1test__animation_ab284377a0284d626a9d5653c492397c4}{test\_animation\_with\_transparency}}():}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00558}00558\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Test\ animation\ exhaustion\ with\ transparency\ using\ PillowWriter\ directly"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00559}00559\ \ \ \ \ fig,\ ax\ =\ plt.subplots()}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00560}00560\ \ \ \ \ rect\ =\ plt.Rectangle((0,\ 0),\ 1,\ 1,\ color=\textcolor{stringliteral}{'red'},\ alpha=0.5)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00561}00561\ \ \ \ \ ax.add\_patch(rect)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00562}00562\ \ \ \ \ ax.set\_xlim(0,\ 1)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00563}00563\ \ \ \ \ ax.set\_ylim(0,\ 1)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00564}00564\ }
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00565}00565\ \ \ \ \ writer\ =\ \mbox{\hyperlink{classmatplotlib_1_1animation_1_1PillowWriter}{PillowWriter}}(fps=30)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00566}00566\ \ \ \ \ writer.setup(fig,\ \textcolor{stringliteral}{'unused.gif'},\ dpi=100)}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00567}00567\ \ \ \ \ writer.grab\_frame(transparent=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00568}00568\ \ \ \ \ frame\ =\ writer.\_frames[-\/1]}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00569}00569\ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ the\ alpha\ channel\ is\ not\ 255,\ so\ frame\ has\ transparency}}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00570}00570\ \ \ \ \ \textcolor{keyword}{assert}\ frame.getextrema()[3][0]\ <\ 255}
\DoxyCodeLine{\Hypertarget{test__animation_8py_source_l00571}00571\ \ \ \ \ plt.close(fig)}

\end{DoxyCode}
