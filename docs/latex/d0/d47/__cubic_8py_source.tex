\doxysection{\+\_\+cubic.\+py}
\hypertarget{__cubic_8py_source}{}\label{__cubic_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/interpolate/\_cubic.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/interpolate/\_cubic.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Interpolation\ algorithms\ using\ piecewise\ cubic\ polynomials."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00005}00005\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ PPoly}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00006}00006\ \textcolor{keyword}{from}\ .\_polyint\ \textcolor{keyword}{import}\ \_isscalar}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1linalg}{scipy.linalg}}\ \textcolor{keyword}{import}\ solve\_banded,\ solve}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00010}00010\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{"{}CubicHermiteSpline"{}},\ \textcolor{stringliteral}{"{}PchipInterpolator"{}},\ \textcolor{stringliteral}{"{}pchip\_interpolate"{}},}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00011}00011\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Akima1DInterpolator"{}},\ \textcolor{stringliteral}{"{}CubicSpline"{}}]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00014}\mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{00014}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{prepare\_input}}(x,\ y,\ axis,\ dydx=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00015}00015\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Prepare\ input\ for\ cubic\ spline\ interpolators.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00016}00016\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ All\ data\ are\ converted\ to\ numpy\ arrays\ and\ checked\ for\ correctness.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ Axes\ equal\ to\ \`{}axis\`{}\ of\ arrays\ \`{}y\`{}\ and\ \`{}dydx\`{}\ are\ moved\ to\ be\ the\ 0th}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ axis.\ The\ value\ of\ \`{}axis\`{}\ is\ converted\ to\ lie\ in}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ [0,\ number\ of\ dimensions\ of\ \`{}y\`{}).}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00023}00023\ \ \ \ \ x,\ y\ =\ map(np.asarray,\ (x,\ y))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{if}\ np.issubdtype(x.dtype,\ np.complexfloating):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}x`\ must\ contain\ real\ values."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00026}00026\ \ \ \ \ x\ =\ x.astype(float)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00028}00028\ \ \ \ \ \textcolor{keywordflow}{if}\ np.issubdtype(y.dtype,\ np.complexfloating):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ dtype\ =\ complex}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ dtype\ =\ float}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{if}\ dydx\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ dydx\ =\ np.asarray(dydx)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y.shape\ !=\ dydx.shape:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ shapes\ of\ \`{}y`\ and\ \`{}dydx`\ must\ be\ identical."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.issubdtype(dydx.dtype,\ np.complexfloating):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ dtype\ =\ complex}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ dydx\ =\ dydx.astype(dtype,\ copy=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00041}00041\ \ \ \ \ y\ =\ y.astype(dtype,\ copy=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00042}00042\ \ \ \ \ axis\ =\ axis\ \%\ y.ndim}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00043}00043\ \ \ \ \ \textcolor{keywordflow}{if}\ x.ndim\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}x`\ must\ be\ 1-\/dimensional."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00045}00045\ \ \ \ \ \textcolor{keywordflow}{if}\ x.shape[0]\ <\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}x`\ must\ contain\ at\ least\ 2\ elements."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{if}\ x.shape[0]\ !=\ y.shape[axis]:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ length\ of\ \`{}y`\ along\ \`{}axis`=\{\}\ doesn't\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}match\ the\ length\ of\ \`{}x`"{}}.format(axis))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00051}00051\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.all(np.isfinite(x)):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}x`\ must\ contain\ only\ finite\ values."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.all(np.isfinite(y)):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}y`\ must\ contain\ only\ finite\ values."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00056}00056\ \ \ \ \ \textcolor{keywordflow}{if}\ dydx\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ np.all(np.isfinite(dydx)):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}dydx`\ must\ contain\ only\ finite\ values."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00059}00059\ \ \ \ \ dx\ =\ np.diff(x)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00060}00060\ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(dx\ <=\ 0):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}x`\ must\ be\ strictly\ increasing\ sequence."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00063}00063\ \ \ \ \ y\ =\ np.moveaxis(y,\ axis,\ 0)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{if}\ dydx\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ dydx\ =\ np.moveaxis(dydx,\ axis,\ 0)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00067}00067\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ dx,\ y,\ axis,\ dydx}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00070}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{00070}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{CubicHermiteSpline}}(\mbox{\hyperlink{classscipy_1_1interpolate_1_1__interpolate_1_1PPoly}{PPoly}}):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00071}00071\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Piecewise-\/cubic\ interpolator\ matching\ values\ and\ first\ derivatives.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00072}00072\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ The\ result\ is\ represented\ as\ a\ \`{}PPoly\`{}\ instance.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00074}00074\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/D\ array\ containing\ values\ of\ the\ independent\ variable.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ must\ be\ real,\ finite\ and\ in\ strictly\ increasing\ order.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ y\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ containing\ values\ of\ the\ dependent\ variable.\ It\ can\ have}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ arbitrary\ number\ of\ dimensions,\ but\ the\ length\ along\ \`{}\`{}axis\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (see\ below)\ must\ match\ the\ length\ of\ \`{}\`{}x\`{}\`{}.\ Values\ must\ be\ finite.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ dydx\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ containing\ derivatives\ of\ the\ dependent\ variable.\ It\ can\ have}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ arbitrary\ number\ of\ dimensions,\ but\ the\ length\ along\ \`{}\`{}axis\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (see\ below)\ must\ match\ the\ length\ of\ \`{}\`{}x\`{}\`{}.\ Values\ must\ be\ finite.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ along\ which\ \`{}y\`{}\ is\ assumed\ to\ be\ varying.\ Meaning\ that\ for}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x[i]\`{}\`{}\ the\ corresponding\ values\ are\ \`{}\`{}np.take(y,\ i,\ axis=axis)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ extrapolate\ :\ \{bool,\ 'periodic',\ None\},\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ bool,\ determines\ whether\ to\ extrapolate\ to\ out-\/of-\/bounds\ points}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ based\ on\ first\ and\ last\ intervals,\ or\ to\ return\ NaNs.\ If\ 'periodic',}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ periodic\ extrapolation\ is\ used.\ If\ None\ (default),\ it\ is\ set\ to\ True.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00096}00096\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Breakpoints.\ The\ same\ \`{}\`{}x\`{}\`{}\ which\ was\ passed\ to\ the\ constructor.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ c\ :\ ndarray,\ shape\ (4,\ n-\/1,\ ...)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Coefficients\ of\ the\ polynomials\ on\ each\ segment.\ The\ trailing}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimensions\ match\ the\ dimensions\ of\ \`{}y\`{},\ excluding\ \`{}\`{}axis\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ example,\ if\ \`{}y\`{}\ is\ 1-\/D,\ then\ \`{}\`{}c[k,\ i]\`{}\`{}\ is\ a\ coefficient\ for}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(x-\/x[i])**(3-\/k)\`{}\`{}\ on\ the\ segment\ between\ \`{}\`{}x[i]\`{}\`{}\ and\ \`{}\`{}x[i+1]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interpolation\ axis.\ The\ same\ axis\ which\ was\ passed\ to\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ constructor.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00109}00109\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ \_\_call\_\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ antiderivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ integrate}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ roots}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00117}00117\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00119}00119\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ Akima1DInterpolator\ :\ Akima\ 1D\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ PchipInterpolator\ :\ PCHIP\ 1-\/D\ monotonic\ cubic\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ CubicSpline\ :\ Cubic\ spline\ data\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ PPoly\ :\ Piecewise\ polynomial\ in\ terms\ of\ coefficients\ and\ breakpoints}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00124}00124\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ If\ you\ want\ to\ create\ a\ higher-\/order\ spline\ matching\ higher-\/order}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00128}00128\ \textcolor{stringliteral}{\ \ \ \ derivatives,\ use\ \`{}BPoly.from\_derivatives\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00129}00129\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00130}00130\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ \`{}Cubic\ Hermite\ spline}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <https://en.wikipedia.org/wiki/Cubic\_Hermite\_spline>\`{}\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ on\ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00137}00137\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x,\ y,\ dydx,\ axis=0,\ extrapolate=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ extrapolate\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ extrapolate\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ x,\ dx,\ y,\ axis,\ dydx\ =\ \mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{prepare\_input}}(x,\ y,\ axis,\ dydx)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ dxr\ =\ dx.reshape([dx.shape[0]]\ +\ [1]\ *\ (y.ndim\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ slope\ =\ np.diff(y,\ axis=0)\ /\ dxr}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ t\ =\ (dydx[:-\/1]\ +\ dydx[1:]\ -\/\ 2\ *\ slope)\ /\ dxr}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ c\ =\ np.empty((4,\ len(x)\ -\/\ 1)\ +\ y.shape[1:],\ dtype=t.dtype)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ c[0]\ =\ t\ /\ dxr}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ c[1]\ =\ (slope\ -\/\ dydx[:-\/1])\ /\ dxr\ -\/\ t}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ c[2]\ =\ dydx[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ c[3]\ =\ y[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(c,\ x,\ extrapolate=extrapolate)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{axis}}\ =\ axis}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00157}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1PchipInterpolator}{00157}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1PchipInterpolator}{PchipInterpolator}}(\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{CubicHermiteSpline}}):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00158}00158\ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}PCHIP\ 1-\/D\ monotonic\ cubic\ interpolation.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00159}00159\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}x\`{}\`{}\ and\ \`{}\`{}y\`{}\`{}\ are\ arrays\ of\ values\ used\ to\ approximate\ some\ function\ f,}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ with\ \`{}\`{}y\ =\ f(x)\`{}\`{}.\ The\ interpolant\ uses\ monotonic\ cubic\ splines}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ to\ find\ the\ value\ of\ new\ points.\ (PCHIP\ stands\ for\ Piecewise\ Cubic}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ Hermite\ Interpolating\ Polynomial).}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00164}00164\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray,\ shape\ (npoints,\ )}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ 1-\/D\ array\ of\ monotonically\ increasing\ real\ values.\ \`{}\`{}x\`{}\`{}\ cannot}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ include\ duplicate\ values\ (otherwise\ f\ is\ overspecified)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ y\ :\ ndarray,\ shape\ (...,\ npoints,\ ...)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ N-\/D\ array\ of\ real\ values.\ \`{}\`{}y\`{}\`{}'s\ length\ along\ the\ interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ axis\ must\ be\ equal\ to\ the\ length\ of\ \`{}\`{}x\`{}\`{}.\ Use\ the\ \`{}\`{}axis\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parameter\ to\ select\ the\ interpolation\ axis.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ in\ the\ \`{}\`{}y\`{}\`{}\ array\ corresponding\ to\ the\ x-\/coordinate\ values.\ Defaults}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ \`{}\`{}axis=0\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ extrapolate\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ extrapolate\ to\ out-\/of-\/bounds\ points\ based\ on\ first}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ last\ intervals,\ or\ to\ return\ NaNs.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00180}00180\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \_\_call\_\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ antiderivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ roots}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00187}00187\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00190}00190\ \textcolor{stringliteral}{\ \ \ \ CubicHermiteSpline\ :\ Piecewise-\/cubic\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00191}00191\ \textcolor{stringliteral}{\ \ \ \ Akima1DInterpolator\ :\ Akima\ 1D\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ CubicSpline\ :\ Cubic\ spline\ data\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ PPoly\ :\ Piecewise\ polynomial\ in\ terms\ of\ coefficients\ and\ breakpoints.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00194}00194\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00195}00195\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ The\ interpolator\ preserves\ monotonicity\ in\ the\ interpolation\ data\ and\ does}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ not\ overshoot\ if\ the\ data\ is\ not\ smooth.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00199}00199\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ The\ first\ derivatives\ are\ guaranteed\ to\ be\ continuous,\ but\ the\ second}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ derivatives\ may\ jump\ at\ :math:\`{}x\_k\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00202}00202\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ Determines\ the\ derivatives\ at\ the\ points\ :math:\`{}x\_k\`{},\ :math:\`{}f'\_k\`{},}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ by\ using\ PCHIP\ algorithm\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00205}00205\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ Let\ :math:\`{}h\_k\ =\ x\_\{k+1\}\ -\/\ x\_k\`{},\ and\ \ :math:\`{}d\_k\ =\ (y\_\{k+1\}\ -\/\ y\_k)\ /\ h\_k\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ are\ the\ slopes\ at\ internal\ points\ :math:\`{}x\_k\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ If\ the\ signs\ of\ :math:\`{}d\_k\`{}\ and\ :math:\`{}d\_\{k-\/1\}\`{}\ are\ different\ or\ either\ of}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ them\ equals\ zero,\ then\ :math:\`{}f'\_k\ =\ 0\`{}.\ Otherwise,\ it\ is\ given\ by\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ weighted\ harmonic\ mean}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00211}00211\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ ..\ math::}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00213}00213\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \(\backslash\)frac\{w\_1\ +\ w\_2\}\{f'\_k\}\ =\ \(\backslash\)frac\{w\_1\}\{d\_\{k-\/1\}\}\ +\ \(\backslash\)frac\{w\_2\}\{d\_k\}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00215}00215\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ where\ :math:\`{}w\_1\ =\ 2\ h\_k\ +\ h\_\{k-\/1\}\`{}\ and\ :math:\`{}w\_2\ =\ h\_k\ +\ 2\ h\_\{k-\/1\}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00217}00217\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ The\ end\ slopes\ are\ set\ using\ a\ one-\/sided\ scheme\ [2]\_.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00219}00219\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00220}00220\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ F.\ N.\ Fritsch\ and\ J.\ Butland,}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ A\ method\ for\ constructing\ local}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ monotone\ piecewise\ cubic\ interpolants,}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ SIAM\ J.\ Sci.\ Comput.,\ 5(2),\ 300-\/304\ (1984).}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ :doi:\`{}10.1137/0905021\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ see,\ e.g.,\ C.\ Moler,\ Numerical\ Computing\ with\ Matlab,\ 2004.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ :doi:\`{}10.1137/1.9780898717952\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00230}00230\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00231}00231\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00233}00233\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x,\ y,\ axis=0,\ extrapolate=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ x,\ \_,\ y,\ axis,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{prepare\_input}}(x,\ y,\ axis)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ xp\ =\ x.reshape((x.shape[0],)\ +\ (1,)*(y.ndim-\/1))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ dk\ =\ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1PchipInterpolator_af2df099a1e06fdb8715ad960ca48cc2b}{\_find\_derivatives}}(xp,\ y)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(x,\ y,\ dk,\ axis=0,\ extrapolate=extrapolate)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{axis}}\ =\ axis}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00239}00239\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00240}00240\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00241}00241\ \ \ \ \ \textcolor{keyword}{def\ }\_edge\_case(h0,\ h1,\ m0,\ m1):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ one-\/sided\ three-\/point\ estimate\ for\ the\ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ d\ =\ ((2*h0\ +\ h1)*m0\ -\/\ h0*m1)\ /\ (h0\ +\ h1)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ try\ to\ preserve\ shape}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ mask\ =\ np.sign(d)\ !=\ np.sign(m0)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ mask2\ =\ (np.sign(m0)\ !=\ np.sign(m1))\ \&\ (np.abs(d)\ >\ 3.*np.abs(m0))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ mmm\ =\ (\string~mask)\ \&\ mask2}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ d[mask]\ =\ 0.}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ d[mmm]\ =\ 3.*m0[mmm]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00252}00252\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ d}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00254}00254\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00255}00255\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00256}00256\ \ \ \ \ \textcolor{keyword}{def\ }\_find\_derivatives(x,\ y):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Determine\ the\ derivatives\ at\ the\ points\ y\_k,\ d\_k,\ by\ using}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ PCHIP\ algorithm\ is:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ choose\ the\ derivatives\ at\ the\ point\ x\_k\ by}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Let\ m\_k\ be\ the\ slope\ of\ the\ kth\ segment\ (between\ k\ and\ k+1)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ m\_k=0\ or\ m\_\{k-\/1\}=0\ or\ sgn(m\_k)\ !=\ sgn(m\_\{k-\/1\})\ then\ d\_k\ ==\ 0}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ else\ use\ weighted\ harmonic\ mean:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ w\_1\ =\ 2h\_k\ +\ h\_\{k-\/1\},\ w\_2\ =\ h\_k\ +\ 2h\_\{k-\/1\}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ 1/d\_k\ =\ 1/(w\_1\ +\ w\_2)*(w\_1\ /\ m\_k\ +\ w\_2\ /\ m\_\{k-\/1\})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ where\ h\_k\ is\ the\ spacing\ between\ x\_k\ and\ x\_\{k+1\}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ y\_shape\ =\ y.shape}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y.ndim\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ So\ that\ \_edge\_case\ doesn't\ end\ up\ assigning\ to\ scalars}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ x[:,\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ y[:,\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00271}00271\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ hk\ =\ x[1:]\ -\/\ x[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ mk\ =\ (y[1:]\ -\/\ y[:-\/1])\ /\ hk}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00274}00274\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y.shape[0]\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ edge\ case:\ only\ have\ two\ points,\ use\ linear\ interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ dk\ =\ np.zeros\_like(y)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ dk[0]\ =\ mk}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ dk[1]\ =\ mk}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dk.reshape(y\_shape)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ smk\ =\ np.sign(mk)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ condition\ =\ (smk[1:]\ !=\ smk[:-\/1])\ |\ (mk[1:]\ ==\ 0)\ |\ (mk[:-\/1]\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00284}00284\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ w1\ =\ 2*hk[1:]\ +\ hk[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ w2\ =\ hk[1:]\ +\ 2*hk[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ values\ where\ division\ by\ zero\ occurs\ will\ be\ excluded}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ by\ 'condition'\ afterwards}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(divide=\textcolor{stringliteral}{'ignore'},\ invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ whmean\ =\ (w1/mk[:-\/1]\ +\ w2/mk[1:])\ /\ (w1\ +\ w2)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00292}00292\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ dk\ =\ np.zeros\_like(y)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ dk[1:-\/1][condition]\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ dk[1:-\/1][\string~condition]\ =\ 1.0\ /\ whmean[\string~condition]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ special\ case\ endpoints,\ as\ suggested\ in}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Cleve\ Moler,\ Numerical\ Computing\ with\ MATLAB,\ Chap\ 3.6\ (pchiptx.m)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ dk[0]\ =\ PchipInterpolator.\_edge\_case(hk[0],\ hk[1],\ mk[0],\ mk[1])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ dk[-\/1]\ =\ PchipInterpolator.\_edge\_case(hk[-\/1],\ hk[-\/2],\ mk[-\/1],\ mk[-\/2])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dk.reshape(y\_shape)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00303}00303\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00304}00304\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00305}\mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_a4108384c123c5e25a0b2acdb48b89dc5}{00305}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_a4108384c123c5e25a0b2acdb48b89dc5}{pchip\_interpolate}}(xi,\ yi,\ x,\ der=0,\ axis=0):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00306}00306\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ Convenience\ function\ for\ pchip\ interpolation.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00308}00308\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ xi\ and\ yi\ are\ arrays\ of\ values\ used\ to\ approximate\ some\ function\ f,}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ with\ \`{}\`{}yi\ =\ f(xi)\`{}\`{}.\ The\ interpolant\ uses\ monotonic\ cubic\ splines}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ to\ find\ the\ value\ of\ new\ points\ x\ and\ the\ derivatives\ there.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00312}00312\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ See\ \`{}scipy.interpolate.PchipInterpolator\`{}\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00314}00314\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ xi\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sorted\ list\ of\ x-\/coordinates,\ of\ length\ N.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ yi\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ 1-\/D\ array\ of\ real\ values.\ \`{}yi\`{}'s\ length\ along\ the\ interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ axis\ must\ be\ equal\ to\ the\ length\ of\ \`{}xi\`{}.\ If\ N-\/D\ array,\ use\ axis}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ parameter\ to\ select\ correct\ axis.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ x\ :\ scalar\ or\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Of\ length\ M.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ der\ :\ int\ or\ list,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Derivatives\ to\ extract.\ The\ 0th\ derivative\ can\ be\ included\ to}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\ the\ function\ value.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ in\ the\ yi\ array\ corresponding\ to\ the\ x-\/coordinate\ values.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00330}00330\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ y\ :\ scalar\ or\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ result,\ of\ length\ R\ or\ length\ M\ or\ M\ by\ R.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00335}00335\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ PchipInterpolator\ :\ PCHIP\ 1-\/D\ monotonic\ cubic\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00339}00339\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ We\ can\ interpolate\ 2D\ observed\ data\ using\ pchip\ interpolation:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00343}00343\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.interpolate\ import\ pchip\_interpolate}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\_observed\ =\ np.linspace(0.0,\ 10.0,\ 11)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\_observed\ =\ np.sin(x\_observed)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(min(x\_observed),\ max(x\_observed),\ num=100)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ pchip\_interpolate(x\_observed,\ y\_observed,\ x)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(x\_observed,\ y\_observed,\ "{}o"{},\ label="{}observation"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(x,\ y,\ label="{}pchip\ interpolation"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.legend()}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00355}00355\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00357}00357\ \ \ \ \ P\ =\ \mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1PchipInterpolator}{PchipInterpolator}}(xi,\ yi,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00359}00359\ \ \ \ \ \textcolor{keywordflow}{if}\ der\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ P(x)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00361}00361\ \ \ \ \ \textcolor{keywordflow}{elif}\ \mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__polyint_ac949282a006e08fa2a5c17f22c86fdbf}{\_isscalar}}(der):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ P.derivative(der)(x)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00363}00363\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [P.derivative(nu)(x)\ \textcolor{keywordflow}{for}\ nu\ \textcolor{keywordflow}{in}\ der]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00365}00365\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00367}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator}{00367}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator}{Akima1DInterpolator}}(\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{CubicHermiteSpline}}):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00368}00368\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ Akima\ interpolator}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00370}00370\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ Fit\ piecewise\ cubic\ polynomials,\ given\ vectors\ x\ and\ y.\ The\ interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ method\ by\ Akima\ uses\ a\ continuously\ differentiable\ sub-\/spline\ built\ from}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ piecewise\ cubic\ polynomials.\ The\ resultant\ curve\ passes\ through\ the\ given}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ data\ points\ and\ will\ appear\ smooth\ and\ natural.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00375}00375\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray,\ shape\ (npoints,\ )}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/D\ array\ of\ monotonically\ increasing\ real\ values.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ y\ :\ ndarray,\ shape\ (...,\ npoints,\ ...)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ N-\/D\ array\ of\ real\ values.\ The\ length\ of\ \`{}\`{}y\`{}\`{}\ along\ the\ interpolation\ axis}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ must\ be\ equal\ to\ the\ length\ of\ \`{}\`{}x\`{}\`{}.\ Use\ the\ \`{}\`{}axis\`{}\`{}\ parameter\ to}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ select\ the\ interpolation\ axis.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ in\ the\ \`{}\`{}y\`{}\`{}\ array\ corresponding\ to\ the\ x-\/coordinate\ values.\ Defaults}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ \`{}\`{}axis=0\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00387}00387\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \_\_call\_\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ antiderivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ roots}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00394}00394\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ PchipInterpolator\ :\ PCHIP\ 1-\/D\ monotonic\ cubic\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ CubicSpline\ :\ Cubic\ spline\ data\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ PPoly\ :\ Piecewise\ polynomial\ in\ terms\ of\ coefficients\ and\ breakpoints}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00400}00400\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.14}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00404}00404\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ Use\ only\ for\ precise\ data,\ as\ the\ fitted\ curve\ passes\ through\ the\ given}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ points\ exactly.\ This\ routine\ is\ useful\ for\ plotting\ a\ pleasingly\ smooth}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ curve\ through\ a\ few\ given\ points\ for\ purposes\ of\ plotting.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00408}00408\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ [1]\ A\ new\ method\ of\ interpolation\ and\ smooth\ curve\ fitting\ based}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ on\ local\ procedures.\ Hiroshi\ Akima,\ J.\ ACM,\ October\ 1970,\ 17(4),}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 589-\/602.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00414}00414\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00417}00417\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x,\ y,\ axis=0):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Original\ implementation\ in\ MATLAB\ by\ N.\ Shamsundar\ (BSD\ licensed),\ see}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://www.mathworks.com/matlabcentral/fileexchange/1814-\/akima-\/interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ x,\ dx,\ y,\ axis,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{prepare\_input}}(x,\ y,\ axis)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00421}00421\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ determine\ slopes\ between\ breakpoints}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ m\ =\ np.empty((x.size\ +\ 3,\ )\ +\ y.shape[1:])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ dx\ =\ dx[(slice(\textcolor{keywordtype}{None}),\ )\ +\ (\textcolor{keywordtype}{None},\ )\ *\ (y.ndim\ -\/\ 1)]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ m[2:-\/2]\ =\ np.diff(y,\ axis=0)\ /\ dx}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00426}00426\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ add\ two\ additional\ points\ on\ the\ left\ ...}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00428}00428\ \ \ \ \ \ \ \ \ m[1]\ =\ 2.\ *\ m[2]\ -\/\ m[3]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ m[0]\ =\ 2.\ *\ m[1]\ -\/\ m[2]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ...\ and\ on\ the\ right}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ m[-\/2]\ =\ 2.\ *\ m[-\/3]\ -\/\ m[-\/4]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ m[-\/1]\ =\ 2.\ *\ m[-\/2]\ -\/\ m[-\/3]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00433}00433\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ m1\ ==\ m2\ !=\ m3\ ==\ m4,\ the\ slope\ at\ the\ breakpoint\ is\ not}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ defined.\ This\ is\ the\ fill\ value:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ t\ =\ .5\ *\ (m[3:]\ +\ m[:-\/3])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ the\ denominator\ of\ the\ slope\ t}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ dm\ =\ np.abs(np.diff(m,\ axis=0))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00439}00439\ \ \ \ \ \ \ \ \ f1\ =\ dm[2:]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ f2\ =\ dm[:-\/2]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00441}00441\ \ \ \ \ \ \ \ \ f12\ =\ f1\ +\ f2}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00442}00442\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ These\ are\ the\ mask\ of\ where\ the\ slope\ at\ breakpoint\ is\ defined:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ ind\ =\ np.nonzero(f12\ >\ 1e-\/9\ *\ np.max(f12,\ initial=-\/np.inf))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ x\_ind,\ y\_ind\ =\ ind[0],\ ind[1:]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ the\ slope\ at\ breakpoint}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00446}00446\ \ \ \ \ \ \ \ \ t[ind]\ =\ (f1[ind]\ *\ m[(x\_ind\ +\ 1,)\ +\ y\_ind]\ +}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f2[ind]\ *\ m[(x\_ind\ +\ 2,)\ +\ y\_ind])\ /\ f12[ind]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00448}00448\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(x,\ y,\ t,\ axis=0,\ extrapolate=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{axis}}\ =\ axis}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00451}00451\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00452}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_ac4cf8c258da92f4d70b8f5ad70f336d9}{00452}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_ac4cf8c258da92f4d70b8f5ad70f336d9}{extend}}(self,\ c,\ x,\ right=True):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00453}00453\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}Extending\ a\ 1-\/D\ Akima\ interpolator\ is\ not\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}yet\ implemented"{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00455}00455\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00456}00456\ \ \ \ \ \textcolor{comment}{\#\ These\ are\ inherited\ from\ PPoly,\ but\ they\ do\ not\ produce\ an\ Akima}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00457}00457\ \ \ \ \ \textcolor{comment}{\#\ interpolator.\ Hence\ stub\ them\ out.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00458}00458\ \ \ \ \ \textcolor{preprocessor}{@classmethod}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00459}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_ac571103441ad111a7dd17a833eafc468}{00459}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_ac571103441ad111a7dd17a833eafc468}{from\_spline}}(cls,\ tck,\ extrapolate=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}This\ method\ does\ not\ make\ sense\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00461}00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}an\ Akima\ interpolator."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00462}00462\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00463}00463\ \ \ \ \ \textcolor{preprocessor}{@classmethod}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00464}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_acdfe6a5928c27d54d94b111850056dde}{00464}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1Akima1DInterpolator_acdfe6a5928c27d54d94b111850056dde}{from\_bernstein\_basis}}(cls,\ bp,\ extrapolate=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00465}00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}This\ method\ does\ not\ make\ sense\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00466}00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}an\ Akima\ interpolator."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00468}00468\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00469}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicSpline}{00469}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicSpline}{CubicSpline}}(\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{CubicHermiteSpline}}):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00470}00470\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Cubic\ spline\ data\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00471}00471\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ Interpolate\ data\ with\ a\ piecewise\ cubic\ polynomial\ which\ is\ twice}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ continuously\ differentiable\ [1]\_.\ The\ result\ is\ represented\ as\ a\ \`{}PPoly\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00474}00474\ \textcolor{stringliteral}{\ \ \ \ instance\ with\ breakpoints\ matching\ the\ given\ data.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00475}00475\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00477}00477\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00478}00478\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00479}00479\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/D\ array\ containing\ values\ of\ the\ independent\ variable.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00480}00480\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ must\ be\ real,\ finite\ and\ in\ strictly\ increasing\ order.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ y\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ containing\ values\ of\ the\ dependent\ variable.\ It\ can\ have}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ arbitrary\ number\ of\ dimensions,\ but\ the\ length\ along\ \`{}\`{}axis\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (see\ below)\ must\ match\ the\ length\ of\ \`{}\`{}x\`{}\`{}.\ Values\ must\ be\ finite.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ along\ which\ \`{}y\`{}\ is\ assumed\ to\ be\ varying.\ Meaning\ that\ for}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x[i]\`{}\`{}\ the\ corresponding\ values\ are\ \`{}\`{}np.take(y,\ i,\ axis=axis)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ bc\_type\ :\ string\ or\ 2-\/tuple,\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00490}00490\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Boundary\ condition\ type.\ Two\ additional\ equations,\ given\ by\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ boundary\ conditions,\ are\ required\ to\ determine\ all\ coefficients\ of}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00492}00492\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ polynomials\ on\ each\ segment\ [2]\_.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00493}00493\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}bc\_type\`{}\ is\ a\ string,\ then\ the\ specified\ condition\ will\ be\ applied}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ at\ both\ ends\ of\ a\ spline.\ Available\ conditions\ are:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00496}00496\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00497}00497\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'not-\/a-\/knot'\ (default):\ The\ first\ and\ second\ segment\ at\ a\ curve\ end}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ are\ the\ same\ polynomial.\ It\ is\ a\ good\ default\ when\ there\ is\ no}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ information\ on\ boundary\ conditions.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00500}00500\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'periodic':\ The\ interpolated\ functions\ is\ assumed\ to\ be\ periodic}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ of\ period\ \`{}\`{}x[-\/1]\ -\/\ x[0]\`{}\`{}.\ The\ first\ and\ last\ value\ of\ \`{}y\`{}\ must\ be}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ identical:\ \`{}\`{}y[0]\ ==\ y[-\/1]\`{}\`{}.\ This\ boundary\ condition\ will\ result\ in}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \`{}\`{}y'[0]\ ==\ y'[-\/1]\`{}\`{}\ and\ \`{}\`{}y''[0]\ ==\ y''[-\/1]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'clamped':\ The\ first\ derivative\ at\ curves\ ends\ are\ zero.\ Assuming}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ a\ 1D\ \`{}y\`{},\ \`{}\`{}bc\_type=((1,\ 0.0),\ (1,\ 0.0))\`{}\`{}\ is\ the\ same\ condition.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'natural':\ The\ second\ derivative\ at\ curve\ ends\ are\ zero.\ Assuming}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ a\ 1D\ \`{}y\`{},\ \`{}\`{}bc\_type=((2,\ 0.0),\ (2,\ 0.0))\`{}\`{}\ is\ the\ same\ condition.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00508}00508\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}bc\_type\`{}\ is\ a\ 2-\/tuple,\ the\ first\ and\ the\ second\ value\ will\ be}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ applied\ at\ the\ curve\ start\ and\ end\ respectively.\ The\ tuple\ values\ can}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00511}00511\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ one\ of\ the\ previously\ mentioned\ strings\ (except\ 'periodic')\ or\ a}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tuple\ \`{}(order,\ deriv\_values)\`{}\ allowing\ to\ specify\ arbitrary}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00513}00513\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ derivatives\ at\ curve\ ends:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00514}00514\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00515}00515\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ \`{}order\`{}:\ the\ derivative\ order,\ 1\ or\ 2.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00516}00516\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ \`{}deriv\_value\`{}:\ array\_like\ containing\ derivative\ values,\ shape\ must}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00517}00517\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ be\ the\ same\ as\ \`{}y\`{},\ excluding\ \`{}\`{}axis\`{}\`{}\ dimension.\ For\ example,\ if}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \`{}y\`{}\ is\ 1-\/D,\ then\ \`{}deriv\_value\`{}\ must\ be\ a\ scalar.\ If\ \`{}y\`{}\ is\ 3-\/D\ with}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00519}00519\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ the\ shape\ (n0,\ n1,\ n2)\ and\ axis=2,\ then\ \`{}deriv\_value\`{}\ must\ be\ 2-\/D}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00520}00520\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ and\ have\ the\ shape\ (n0,\ n1).}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00521}00521\ \textcolor{stringliteral}{\ \ \ \ extrapolate\ :\ \{bool,\ 'periodic',\ None\},\ optional}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00522}00522\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ bool,\ determines\ whether\ to\ extrapolate\ to\ out-\/of-\/bounds\ points}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ based\ on\ first\ and\ last\ intervals,\ or\ to\ return\ NaNs.\ If\ 'periodic',}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00524}00524\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ periodic\ extrapolation\ is\ used.\ If\ None\ (default),\ \`{}\`{}extrapolate\`{}\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ set\ to\ 'periodic'\ for\ \`{}\`{}bc\_type='periodic'\`{}\`{}\ and\ to\ True\ otherwise.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00526}00526\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00529}00529\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Breakpoints.\ The\ same\ \`{}\`{}x\`{}\`{}\ which\ was\ passed\ to\ the\ constructor.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00531}00531\ \textcolor{stringliteral}{\ \ \ \ c\ :\ ndarray,\ shape\ (4,\ n-\/1,\ ...)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Coefficients\ of\ the\ polynomials\ on\ each\ segment.\ The\ trailing}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimensions\ match\ the\ dimensions\ of\ \`{}y\`{},\ excluding\ \`{}\`{}axis\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ example,\ if\ \`{}y\`{}\ is\ 1-\/d,\ then\ \`{}\`{}c[k,\ i]\`{}\`{}\ is\ a\ coefficient\ for}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(x-\/x[i])**(3-\/k)\`{}\`{}\ on\ the\ segment\ between\ \`{}\`{}x[i]\`{}\`{}\ and\ \`{}\`{}x[i+1]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00536}00536\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00537}00537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interpolation\ axis.\ The\ same\ axis\ which\ was\ passed\ to\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ constructor.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00539}00539\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00540}00540\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00541}00541\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00542}00542\ \textcolor{stringliteral}{\ \ \ \ \_\_call\_\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00543}00543\ \textcolor{stringliteral}{\ \ \ \ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00544}00544\ \textcolor{stringliteral}{\ \ \ \ antiderivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00545}00545\ \textcolor{stringliteral}{\ \ \ \ integrate}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00546}00546\ \textcolor{stringliteral}{\ \ \ \ roots}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00547}00547\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00548}00548\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00549}00549\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00550}00550\ \textcolor{stringliteral}{\ \ \ \ Akima1DInterpolator\ :\ Akima\ 1D\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00551}00551\ \textcolor{stringliteral}{\ \ \ \ PchipInterpolator\ :\ PCHIP\ 1-\/D\ monotonic\ cubic\ interpolator.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00552}00552\ \textcolor{stringliteral}{\ \ \ \ PPoly\ :\ Piecewise\ polynomial\ in\ terms\ of\ coefficients\ and\ breakpoints.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00553}00553\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00554}00554\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00555}00555\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00556}00556\ \textcolor{stringliteral}{\ \ \ \ Parameters\ \`{}bc\_type\`{}\ and\ \`{}\`{}extrapolate\`{}\`{}\ work\ independently,\ i.e.\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00557}00557\ \textcolor{stringliteral}{\ \ \ \ former\ controls\ only\ construction\ of\ a\ spline,\ and\ the\ latter\ only}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00558}00558\ \textcolor{stringliteral}{\ \ \ \ evaluation.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00559}00559\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ When\ a\ boundary\ condition\ is\ 'not-\/a-\/knot'\ and\ n\ =\ 2,\ it\ is\ replaced\ by}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00561}00561\ \textcolor{stringliteral}{\ \ \ \ a\ condition\ that\ the\ first\ derivative\ is\ equal\ to\ the\ linear\ interpolant}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00562}00562\ \textcolor{stringliteral}{\ \ \ \ slope.\ When\ both\ boundary\ conditions\ are\ 'not-\/a-\/knot'\ and\ n\ =\ 3,\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00563}00563\ \textcolor{stringliteral}{\ \ \ \ solution\ is\ sought\ as\ a\ parabola\ passing\ through\ given\ points.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00564}00564\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00565}00565\ \textcolor{stringliteral}{\ \ \ \ When\ 'not-\/a-\/knot'\ boundary\ conditions\ is\ applied\ to\ both\ ends,\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00566}00566\ \textcolor{stringliteral}{\ \ \ \ resulting\ spline\ will\ be\ the\ same\ as\ returned\ by\ \`{}splrep\`{}\ (with\ \`{}\`{}s=0\`{}\`{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00567}00567\ \textcolor{stringliteral}{\ \ \ \ and\ \`{}InterpolatedUnivariateSpline\`{},\ but\ these\ two\ methods\ use\ a}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00568}00568\ \textcolor{stringliteral}{\ \ \ \ representation\ in\ B-\/spline\ basis.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00569}00569\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00570}00570\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.18.0}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00571}00571\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00572}00572\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00573}00573\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00574}00574\ \textcolor{stringliteral}{\ \ \ \ In\ this\ example\ the\ cubic\ spline\ is\ used\ to\ interpolate\ a\ sampled\ sinusoid.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00575}00575\ \textcolor{stringliteral}{\ \ \ \ You\ can\ see\ that\ the\ spline\ continuity\ property\ holds\ for\ the\ first\ and}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00576}00576\ \textcolor{stringliteral}{\ \ \ \ second\ derivatives\ and\ violates\ only\ for\ the\ third\ derivative.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00577}00577\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00578}00578\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00579}00579\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.interpolate\ import\ CubicSpline}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00580}00580\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00581}00581\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.arange(10)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00582}00582\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ np.sin(x)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00583}00583\ \textcolor{stringliteral}{\ \ \ \ >>>\ cs\ =\ CubicSpline(x,\ y)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00584}00584\ \textcolor{stringliteral}{\ \ \ \ >>>\ xs\ =\ np.arange(-\/0.5,\ 9.6,\ 0.1)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00585}00585\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ ax\ =\ plt.subplots(figsize=(6.5,\ 4))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00586}00586\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(x,\ y,\ 'o',\ label='data')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00587}00587\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(xs,\ np.sin(xs),\ label='true')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00588}00588\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(xs,\ cs(xs),\ label="{}S"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00589}00589\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(xs,\ cs(xs,\ 1),\ label="{}S'"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00590}00590\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(xs,\ cs(xs,\ 2),\ label="{}S''"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00591}00591\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(xs,\ cs(xs,\ 3),\ label="{}S'''"{})}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00592}00592\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_xlim(-\/0.5,\ 9.5)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00593}00593\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.legend(loc='lower\ left',\ ncol=2)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00594}00594\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00595}00595\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00596}00596\ \textcolor{stringliteral}{\ \ \ \ In\ the\ second\ example,\ the\ unit\ circle\ is\ interpolated\ with\ a\ spline.\ A}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00597}00597\ \textcolor{stringliteral}{\ \ \ \ periodic\ boundary\ condition\ is\ used.\ You\ can\ see\ that\ the\ first\ derivative}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00598}00598\ \textcolor{stringliteral}{\ \ \ \ values,\ ds/dx=0,\ ds/dy=1\ at\ the\ periodic\ point\ (1,\ 0)\ are\ correctly}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00599}00599\ \textcolor{stringliteral}{\ \ \ \ computed.\ Note\ that\ a\ circle\ cannot\ be\ exactly\ represented\ by\ a\ cubic}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00600}00600\ \textcolor{stringliteral}{\ \ \ \ spline.\ To\ increase\ precision,\ more\ breakpoints\ would\ be\ required.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00601}00601\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00602}00602\ \textcolor{stringliteral}{\ \ \ \ >>>\ theta\ =\ 2\ *\ np.pi\ *\ np.linspace(0,\ 1,\ 5)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00603}00603\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ np.c\_[np.cos(theta),\ np.sin(theta)]}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00604}00604\ \textcolor{stringliteral}{\ \ \ \ >>>\ cs\ =\ CubicSpline(theta,\ y,\ bc\_type='periodic')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00605}00605\ \textcolor{stringliteral}{\ \ \ \ >>>\ print("{}ds/dx=\{:.1f\}\ ds/dy=\{:.1f\}"{}.format(cs(0,\ 1)[0],\ cs(0,\ 1)[1]))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00606}00606\ \textcolor{stringliteral}{\ \ \ \ ds/dx=0.0\ ds/dy=1.0}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00607}00607\ \textcolor{stringliteral}{\ \ \ \ >>>\ xs\ =\ 2\ *\ np.pi\ *\ np.linspace(0,\ 1,\ 100)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00608}00608\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ ax\ =\ plt.subplots(figsize=(6.5,\ 4))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00609}00609\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(y[:,\ 0],\ y[:,\ 1],\ 'o',\ label='data')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00610}00610\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(np.cos(xs),\ np.sin(xs),\ label='true')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00611}00611\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(cs(xs)[:,\ 0],\ cs(xs)[:,\ 1],\ label='spline')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00612}00612\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.axes.set\_aspect('equal')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00613}00613\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.legend(loc='center')}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00614}00614\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00615}00615\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00616}00616\ \textcolor{stringliteral}{\ \ \ \ The\ third\ example\ is\ the\ interpolation\ of\ a\ polynomial\ y\ =\ x**3\ on\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00617}00617\ \textcolor{stringliteral}{\ \ \ \ interval\ 0\ <=\ x<=\ 1.\ A\ cubic\ spline\ can\ represent\ this\ function\ exactly.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00618}00618\ \textcolor{stringliteral}{\ \ \ \ To\ achieve\ that\ we\ need\ to\ specify\ values\ and\ first\ derivatives\ at}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00619}00619\ \textcolor{stringliteral}{\ \ \ \ endpoints\ of\ the\ interval.\ Note\ that\ y'\ =\ 3\ *\ x**2\ and\ thus\ y'(0)\ =\ 0\ and}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00620}00620\ \textcolor{stringliteral}{\ \ \ \ y'(1)\ =\ 3.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00621}00621\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00622}00622\ \textcolor{stringliteral}{\ \ \ \ >>>\ cs\ =\ CubicSpline([0,\ 1],\ [0,\ 1],\ bc\_type=((1,\ 0),\ (1,\ 3)))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00623}00623\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(0,\ 1)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00624}00624\ \textcolor{stringliteral}{\ \ \ \ >>>\ np.allclose(x**3,\ cs(x))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00625}00625\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00626}00626\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00627}00627\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00628}00628\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00629}00629\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ \`{}Cubic\ Spline\ Interpolation}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00630}00630\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <https://en.wikiversity.org/wiki/Cubic\_Spline\_Interpolation>\`{}\_}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00631}00631\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ on\ Wikiversity.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00632}00632\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ Carl\ de\ Boor,\ "{}A\ Practical\ Guide\ to\ Splines"{},\ Springer-\/Verlag,\ 1978.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00633}00633\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00634}00634\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00635}00635\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x,\ y,\ axis=0,\ bc\_type='not-\/a-\/knot',\ extrapolate=None):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ x,\ dx,\ y,\ axis,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1interpolate_1_1__cubic_ac3110d69863bb4a3b4b02397a4597e11}{prepare\_input}}(x,\ y,\ axis)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ n\ =\ len(x)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00638}00638\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ bc,\ y\ =\ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicSpline_aee4b9ed4805aa805a7b2af267311801c}{\_validate\_bc}}(bc\_type,\ y,\ y.shape[1:],\ axis)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00640}00640\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ extrapolate\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc[0]\ ==\ \textcolor{stringliteral}{'periodic'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00643}00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extrapolate\ =\ \textcolor{stringliteral}{'periodic'}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00645}00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extrapolate\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00646}00646\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ y.size\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bail\ out\ early\ for\ zero-\/sized\ arrays}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ np.zeros\_like(y)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ dxr\ =\ dx.reshape([dx.shape[0]]\ +\ [1]\ *\ (y.ndim\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ slope\ =\ np.diff(y,\ axis=0)\ /\ dxr}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00653}00653\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ bc\ is\ 'not-\/a-\/knot'\ this\ change\ is\ just\ a\ convention.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ bc\ is\ 'periodic'\ then\ we\ already\ checked\ that\ y[0]\ ==\ y[-\/1],}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ the\ spline\ is\ just\ a\ constant,\ we\ handle\ this\ case\ in\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ same\ way\ by\ setting\ the\ first\ derivatives\ to\ slope,\ which\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc[0]\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'not-\/a-\/knot'},\ \textcolor{stringliteral}{'periodic'}]:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bc[0]\ =\ (1,\ slope[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc[1]\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'not-\/a-\/knot'},\ \textcolor{stringliteral}{'periodic'}]:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00662}00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bc[1]\ =\ (1,\ slope[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00663}00663\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ a\ special\ case,\ when\ both\ conditions\ are\ 'not-\/a-\/knot'}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ n\ ==\ 3.\ In\ this\ case\ 'not-\/a-\/knot'\ can't\ be\ handled\ regularly}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00666}00666\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ as\ the\ both\ conditions\ are\ identical.\ We\ handle\ this\ case\ by}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00667}00667\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ constructing\ a\ parabola\ passing\ through\ given\ points.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00668}00668\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\ ==\ 3\ \textcolor{keywordflow}{and}\ bc[0]\ ==\ \textcolor{stringliteral}{'not-\/a-\/knot'}\ \textcolor{keywordflow}{and}\ bc[1]\ ==\ \textcolor{stringliteral}{'not-\/a-\/knot'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00669}00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ np.zeros((3,\ 3))\ \ \textcolor{comment}{\#\ This\ is\ a\ standard\ matrix.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00670}00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ np.empty((3,)\ +\ y.shape[1:],\ dtype=y.dtype)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00671}00671\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00672}00672\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 0]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00673}00673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 1]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 0]\ =\ dx[1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00675}00675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 1]\ =\ 2\ *\ (dx[0]\ +\ dx[1])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00676}00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 2]\ =\ dx[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00677}00677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[2,\ 1]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00678}00678\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[2,\ 2]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00679}00679\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]\ =\ 2\ *\ slope[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[1]\ =\ 3\ *\ (dxr[0]\ *\ slope[1]\ +\ dxr[1]\ *\ slope[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[2]\ =\ 2\ *\ slope[1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00683}00683\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00684}00684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ \mbox{\hyperlink{classscipy_1_1interpolate_1_1__interpolate_1_1PPoly_ae451619e65b098febdfc488ed0779b95}{solve}}(A,\ b,\ overwrite\_a=\textcolor{keyword}{True},\ overwrite\_b=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00685}00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_finite=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00686}00686\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ n\ ==\ 3\ \textcolor{keywordflow}{and}\ bc[0]\ ==\ \textcolor{stringliteral}{'periodic'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00687}00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ case\ when\ number\ of\ points\ is\ 3\ we\ compute\ the\ derivatives}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00688}00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ manually}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ np.empty((n,)\ +\ y.shape[1:],\ dtype=y.dtype)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00690}00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t\ =\ (slope\ /\ dxr).sum()\ /\ (1.\ /\ dxr).sum()}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00691}00691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s.fill(t)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00693}00693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ derivative\ values\ at\ each\ x[i]\ by\ solving\ a\ tridiagonal}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ system.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00695}00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ np.zeros((3,\ n))\ \ \textcolor{comment}{\#\ This\ is\ a\ banded\ matrix\ representation.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ np.empty((n,)\ +\ y.shape[1:],\ dtype=y.dtype)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00697}00697\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00698}00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Filling\ the\ system\ for\ i=1..n-\/2}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00699}00699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (x[i-\/1]\ -\/\ x[i])\ *\ s[i-\/1]\ +\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00700}00700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2\ *\ ((x[i]\ -\/\ x[i-\/1])\ +\ (x[i+1]\ -\/\ x[i]))\ *\ s[i]\ \ \ +\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00701}00701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (x[i]\ -\/\ x[i-\/1])\ *\ s[i+1]\ =\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00702}00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ 3\ *\ ((x[i+1]\ -\/\ x[i])*(y[i]\ -\/\ y[i-\/1])/(x[i]\ -\/\ x[i-\/1])\ +\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00703}00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ (x[i]\ -\/\ x[i-\/1])*(y[i+1]\ -\/\ y[i])/(x[i+1]\ -\/\ x[i]))}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00704}00704\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00705}00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 1:-\/1]\ =\ 2\ *\ (dx[:-\/1]\ +\ dx[1:])\ \ \textcolor{comment}{\#\ The\ diagonal}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00706}00706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 2:]\ =\ dx[:-\/1]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ upper\ diagonal}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00707}00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[-\/1,\ :-\/2]\ =\ dx[1:]\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ lower\ diagonal}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00708}00708\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00709}00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[1:-\/1]\ =\ 3\ *\ (dxr[1:]\ *\ slope[:-\/1]\ +\ dxr[:-\/1]\ *\ slope[1:])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00710}00710\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00711}00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bc\_start,\ bc\_end\ =\ bc}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00712}00712\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00713}00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc\_start\ ==\ \textcolor{stringliteral}{'periodic'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00714}00714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Due\ to\ the\ periodicity,\ and\ because\ y[-\/1]\ =\ y[0],\ the}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00715}00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ linear\ system\ has\ (n-\/1)\ unknowns/equations\ instead\ of\ n:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00716}00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A\ =\ A[:,\ 0:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00717}00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 0]\ =\ 2\ *\ (dx[-\/1]\ +\ dx[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00718}00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 1]\ =\ dx[-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00719}00719\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00720}00720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ b[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00721}00721\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00722}00722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Also,\ due\ to\ the\ periodicity,\ the\ system\ is\ not\ tri-\/diagonal.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00723}00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ need\ to\ compute\ a\ "{}condensed"{}\ matrix\ of\ shape\ (n-\/2,\ n-\/2).}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00724}00724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ https://web.archive.org/web/20151220180652/http://www.cfm.brown.edu/people/gk/chap6/node14.html}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00725}00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ more\ explanations.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00726}00726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ condensed\ matrix\ is\ obtained\ by\ removing\ the\ last\ column}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00727}00727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ last\ row\ of\ the\ (n-\/1,\ n-\/1)\ system\ matrix.\ The\ removed}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00728}00728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ values\ are\ saved\ in\ scalar\ variables\ with\ the\ (n-\/1,\ n-\/1)}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00729}00729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ system\ matrix\ indices\ forming\ their\ names:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_m1\_0\ =\ dx[-\/2]\ \ \textcolor{comment}{\#\ lower\ left\ corner\ value:\ A[-\/1,\ 0]}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00731}00731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_m1\_m2\ =\ dx[-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_m1\_m1\ =\ 2\ *\ (dx[-\/1]\ +\ dx[-\/2])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_m2\_m1\ =\ dx[-\/3]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\_0\_m1\ =\ dx[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00735}00735\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00736}00736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]\ =\ 3\ *\ (dxr[0]\ *\ slope[-\/1]\ +\ dxr[-\/1]\ *\ slope[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00737}00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[-\/1]\ =\ 3\ *\ (dxr[-\/1]\ *\ slope[-\/2]\ +\ dxr[-\/2]\ *\ slope[-\/1])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00738}00738\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00739}00739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ac\ =\ A[:,\ :-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00740}00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b1\ =\ b[:-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00741}00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b2\ =\ np.zeros\_like(b1)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b2[0]\ =\ -\/a\_0\_m1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b2[-\/1]\ =\ -\/a\_m2\_m1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00744}00744\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00745}00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ s1\ and\ s2\ are\ the\ solutions\ of\ (n-\/2,\ n-\/2)\ system}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00746}00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s1\ =\ solve\_banded((1,\ 1),\ Ac,\ b1,\ overwrite\_ab=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00747}00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ overwrite\_b=\textcolor{keyword}{False},\ check\_finite=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00748}00748\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00749}00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s2\ =\ solve\_banded((1,\ 1),\ Ac,\ b2,\ overwrite\_ab=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00750}00750\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ overwrite\_b=\textcolor{keyword}{False},\ check\_finite=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00751}00751\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ computing\ the\ s[n-\/2]\ solution:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00753}00753\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\_m1\ =\ ((b[-\/1]\ -\/\ a\_m1\_0\ *\ s1[0]\ -\/\ a\_m1\_m2\ *\ s1[-\/1])\ /}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00754}00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (a\_m1\_m1\ +\ a\_m1\_0\ *\ s2[0]\ +\ a\_m1\_m2\ *\ s2[-\/1]))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00755}00755\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00756}00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ s\ is\ the\ solution\ of\ the\ (n,\ n)\ system:}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00757}00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ np.empty((n,)\ +\ y.shape[1:],\ dtype=y.dtype)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00758}00758\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s[:-\/2]\ =\ s1\ +\ s\_m1\ *\ s2}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00759}00759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s[-\/2]\ =\ s\_m1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00760}00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s[-\/1]\ =\ s[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00761}00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00762}00762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc\_start\ ==\ \textcolor{stringliteral}{'not-\/a-\/knot'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00763}00763\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 0]\ =\ dx[1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00764}00764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 1]\ =\ x[2]\ -\/\ x[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00765}00765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ x[2]\ -\/\ x[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00766}00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]\ =\ ((dxr[0]\ +\ 2*d)\ *\ dxr[1]\ *\ slope[0]\ +}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00767}00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dxr[0]**2\ *\ slope[1])\ /\ d}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00768}00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\_start[0]\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00769}00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 0]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00770}00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 1]\ =\ 0}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00771}00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]\ =\ bc\_start[1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00772}00772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\_start[0]\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00773}00773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ 0]\ =\ 2\ *\ dx[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00774}00774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[0,\ 1]\ =\ dx[0]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00775}00775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[0]\ =\ -\/0.5\ *\ bc\_start[1]\ *\ dx[0]**2\ +\ 3\ *\ (y[1]\ -\/\ y[0])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00776}00776\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00777}00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc\_end\ ==\ \textcolor{stringliteral}{'not-\/a-\/knot'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00778}00778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ -\/1]\ =\ dx[-\/2]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00779}00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[-\/1,\ -\/2]\ =\ x[-\/1]\ -\/\ x[-\/3]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00780}00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ x[-\/1]\ -\/\ x[-\/3]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00781}00781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[-\/1]\ =\ ((dxr[-\/1]**2*slope[-\/2]\ +}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00782}00782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2*d\ +\ dxr[-\/1])*dxr[-\/2]*slope[-\/1])\ /\ d)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00783}00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\_end[0]\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00784}00784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ -\/1]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00785}00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[-\/1,\ -\/2]\ =\ 0}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00786}00786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[-\/1]\ =\ bc\_end[1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00787}00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\_end[0]\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00788}00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[1,\ -\/1]\ =\ 2\ *\ dx[-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00789}00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ A[-\/1,\ -\/2]\ =\ dx[-\/1]}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00790}00790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b[-\/1]\ =\ 0.5\ *\ bc\_end[1]\ *\ dx[-\/1]**2\ +\ 3\ *\ (y[-\/1]\ -\/\ y[-\/2])}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00791}00791\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00792}00792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ =\ solve\_banded((1,\ 1),\ A,\ b,\ overwrite\_ab=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00793}00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ overwrite\_b=\textcolor{keyword}{True},\ check\_finite=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00794}00794\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00795}00795\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(x,\ y,\ s,\ axis=0,\ extrapolate=extrapolate)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00796}00796\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicHermiteSpline}{axis}}\ =\ axis}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00797}00797\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00798}00798\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00799}\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicSpline_aee4b9ed4805aa805a7b2af267311801c}{00799}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1interpolate_1_1__cubic_1_1CubicSpline_aee4b9ed4805aa805a7b2af267311801c}{\_validate\_bc}}(bc\_type,\ y,\ expected\_deriv\_shape,\ axis):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00800}00800\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Validate\ and\ prepare\ boundary\ conditions.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00801}00801\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00802}00802\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00803}00803\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00804}00804\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ validated\_bc\ :\ 2-\/tuple}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00805}00805\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Boundary\ conditions\ for\ a\ curve\ start\ and\ end.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00806}00806\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00807}00807\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ y\ casted\ to\ complex\ dtype\ if\ one\ of\ the\ boundary\ conditions\ has}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00808}00808\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ complex\ dtype.}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00809}00809\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00810}00810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(bc\_type,\ str):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00811}00811\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc\_type\ ==\ \textcolor{stringliteral}{'periodic'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00812}00812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.allclose(y[0],\ y[-\/1],\ rtol=1e-\/15,\ atol=1e-\/15):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00813}00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00814}00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ first\ and\ last\ \`{}y`\ point\ along\ axis\ \{\}\ must\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00815}00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}be\ identical\ (within\ machine\ precision)\ when\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00816}00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}bc\_type='periodic'."{}}.format(axis))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00817}00817\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00818}00818\ \ \ \ \ \ \ \ \ \ \ \ \ bc\_type\ =\ (bc\_type,\ bc\_type)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00819}00819\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00820}00820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00821}00821\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(bc\_type)\ !=\ 2:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00822}00822\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}bc\_type`\ must\ contain\ 2\ elements\ to\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00823}00823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specify\ start\ and\ end\ conditions."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00824}00824\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00825}00825\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{'periodic'}\ \textcolor{keywordflow}{in}\ bc\_type:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00826}00826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}'periodic'\ \`{}bc\_type`\ is\ defined\ for\ both\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00827}00827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}curve\ ends\ and\ cannot\ be\ used\ with\ other\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00828}00828\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}boundary\ conditions."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00829}00829\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00830}00830\ \ \ \ \ \ \ \ \ validated\_bc\ =\ []}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00831}00831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ bc\ \textcolor{keywordflow}{in}\ bc\_type:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00832}00832\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(bc,\ str):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00833}00833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ bc\ ==\ \textcolor{stringliteral}{'clamped'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00834}00834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_bc.append((1,\ np.zeros(expected\_deriv\_shape)))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00835}00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\ ==\ \textcolor{stringliteral}{'natural'}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00836}00836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_bc.append((2,\ np.zeros(expected\_deriv\_shape)))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00837}00837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ bc\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'not-\/a-\/knot'},\ \textcolor{stringliteral}{'periodic'}]:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00838}00838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_bc.append(bc)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00839}00839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00840}00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}bc\_type=\{bc\}\ is\ not\ allowed."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00841}00841\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00842}00842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00843}00843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ deriv\_order,\ deriv\_value\ =\ bc}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00844}00844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00845}00845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00846}00846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}A\ specified\ derivative\ value\ must\ be\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00847}00847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}given\ in\ the\ form\ (order,\ value)."{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00848}00848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\ \textcolor{keyword}{from}\ e}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00849}00849\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00850}00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ deriv\_order\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ [1,\ 2]:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00851}00851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ specified\ derivative\ order\ must\ "{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00852}00852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}be\ 1\ or\ 2."{}})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00853}00853\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00854}00854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ deriv\_value\ =\ np.asarray(deriv\_value)}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00855}00855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ deriv\_value.shape\ !=\ expected\_deriv\_shape:}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00856}00856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00857}00857\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\`{}deriv\_value`\ shape\ \{\}\ is\ not\ the\ expected\ one\ \{\}."{}}}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00858}00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(deriv\_value.shape,\ expected\_deriv\_shape))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00859}00859\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00860}00860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.issubdtype(deriv\_value.dtype,\ np.complexfloating):}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00861}00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ y.astype(complex,\ copy=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00862}00862\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00863}00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ validated\_bc.append((deriv\_order,\ deriv\_value))}
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00864}00864\ }
\DoxyCodeLine{\Hypertarget{__cubic_8py_source_l00865}00865\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ validated\_bc,\ y}

\end{DoxyCode}
