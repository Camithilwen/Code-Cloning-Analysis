\doxysection{\+\_\+covariance.\+py}
\hypertarget{__covariance_8py_source}{}\label{__covariance_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_covariance.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_covariance.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__covariance}{00001}}\ \textcolor{keyword}{from}\ functools\ \textcolor{keyword}{import}\ cached\_property}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00004}00004\ \textcolor{keyword}{from}\ scipy\ \textcolor{keyword}{import}\ linalg}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1stats}{scipy.stats}}\ \textcolor{keyword}{import}\ \_multivariate}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00008}00008\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{"{}Covariance"{}}]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00011}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{00011}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}:}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00012}00012\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ Representation\ of\ a\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00014}00014\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ Calculations\ involving\ covariance\ matrices\ (e.g.\ data\ whitening,}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ multivariate\ normal\ function\ evaluation)\ are\ often\ performed\ more}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ efficiently\ using\ a\ decomposition\ of\ the\ covariance\ matrix\ instead\ of\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ covariance\ metrix\ itself.\ This\ class\ allows\ the\ user\ to\ construct\ an}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ object\ representing\ a\ covariance\ matrix\ using\ any\ of\ several}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ decompositions\ and\ perform\ calculations\ using\ a\ common\ interface.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00021}00021\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ ..\ note::}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00023}00023\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ \`{}Covariance\`{}\ class\ cannot\ be\ instantiated\ directly.\ Instead,\ use}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ one\ of\ the\ factory\ methods\ (e.g.\ \`{}Covariance.from\_diagonal\`{}).}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00026}00026\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ The\ \`{}Covariance\`{}\ class\ is\ is\ used\ by\ calling\ one\ of\ its}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ factory\ methods\ to\ create\ a\ \`{}Covariance\`{}\ object,\ then\ pass\ that}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ representation\ of\ the\ \`{}Covariance\`{}\ matrix\ as\ a\ shape\ parameter\ of\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ multivariate\ distribution.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00033}00033\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ For\ instance,\ the\ multivariate\ normal\ distribution\ can\ accept\ an\ array}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ representing\ a\ covariance\ matrix:}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00036}00036\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ >>>\ d\ =\ [1,\ 2,\ 3]}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ >>>\ A\ =\ np.diag(d)\ \ \#\ a\ diagonal\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ [4,\ -\/2,\ 5]\ \ \#\ a\ point\ of\ interest}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ >>>\ dist\ =\ stats.multivariate\_normal(mean=[0,\ 0,\ 0],\ cov=A)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ >>>\ dist.pdf(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ 4.9595685102808205e-\/08}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00045}00045\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ but\ the\ calculations\ are\ performed\ in\ a\ very\ generic\ way\ that\ does\ not}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ take\ advantage\ of\ any\ special\ properties\ of\ the\ covariance\ matrix.\ Because}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ our\ covariance\ matrix\ is\ diagonal,\ we\ can\ use\ \`{}\`{}Covariance.from\_diagonal\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ to\ create\ an\ object\ representing\ the\ covariance\ matrix,\ and}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \`{}multivariate\_normal\`{}\ can\ use\ this\ to\ compute\ the\ probability\ density}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ function\ more\ efficiently.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00052}00052\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ >>>\ cov\ =\ stats.Covariance.from\_diagonal(d)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ >>>\ dist\ =\ stats.multivariate\_normal(mean=[0,\ 0,\ 0],\ cov=cov)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ >>>\ dist.pdf(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ 4.9595685102808205e-\/08}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00057}00057\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00059}00059\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ message\ =\ (\textcolor{stringliteral}{"{}The\ \`{}Covariance`\ class\ cannot\ be\ instantiated\ directly.\ "{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Please\ use\ one\ of\ the\ factory\ methods\ "{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(e.g.\ \`{}Covariance.from\_diagonal`)."{}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(message)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00065}00065\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00066}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a25e9d521792b203209fe482176c90a49}{00066}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a25e9d521792b203209fe482176c90a49}{from\_diagonal}}(diagonal):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return\ a\ representation\ of\ a\ covariance\ matrix\ from\ its\ diagonal.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00069}00069\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ diagonal\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ diagonal\ elements\ of\ a\ diagonal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00074}00074\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Let\ the\ diagonal\ elements\ of\ a\ diagonal\ covariance\ matrix\ :math:\`{}D\`{}\ be}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ stored\ in\ the\ vector\ :math:\`{}d\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00079}00079\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ all\ elements\ of\ :math:\`{}d\`{}\ are\ strictly\ positive,\ whitening\ of\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ :math:\`{}x\`{}\ is\ performed\ by\ computing}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}x\ \(\backslash\)cdot\ d\string^\{-\/1/2\}\`{},\ where\ the\ inverse\ square\ root\ can\ be\ taken}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}\(\backslash\)log\(\backslash\)det\{D\}\`{}\ is\ calculated\ as\ :math:\`{}-\/2\ \(\backslash\)sum(\(\backslash\)log\{d\})\`{},}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ the\ :math:\`{}\(\backslash\)log\`{}\ operation\ is\ performed\ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00086}00086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ \`{}Covariance\`{}\ class\ supports\ singular\ covariance\ matrices.\ When}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ computing\ \`{}\`{}\_log\_pdet\`{}\`{},\ non-\/positive\ elements\ of\ :math:\`{}d\`{}\ are}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ignored.\ Whitening\ is\ not\ well\ defined\ when\ the\ point\ to\ be\ whitened}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ does\ not\ lie\ in\ the\ span\ of\ the\ columns\ of\ the\ covariance\ matrix.\ The}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ convention\ taken\ here\ is\ to\ treat\ the\ inverse\ square\ root\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ non-\/positive\ elements\ of\ :math:\`{}d\`{}\ as\ zeros.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00093}00093\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Prepare\ a\ symmetric\ positive\ definite\ covariance\ matrix\ \`{}\`{}A\`{}\`{}\ and\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00098}00098\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 5}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ np.diag(rng.random(n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.random(size=n)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00105}00105\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Extract\ the\ diagonal\ from\ \`{}\`{}A\`{}\`{}\ and\ create\ the\ \`{}Covariance\`{}\ object.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00107}00107\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ d\ =\ np.diag(A)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\ =\ stats.Covariance.from\_diagonal(d)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00110}00110\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compare\ the\ functionality\ of\ the\ \`{}Covariance\`{}\ object\ against\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reference\ implementations.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00113}00113\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.whiten(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ np.diag(d**-\/0.5)\ @\ x}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.log\_pdet}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00119}00119\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ np.linalg.slogdet(A)[-\/1]}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00122}00122\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal}{CovViaDiagonal}}(diagonal)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00126}00126\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00127}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a13416c992669a466cab29908c9b3cf02}{00127}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a13416c992669a466cab29908c9b3cf02}{from\_precision}}(precision,\ covariance=None):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return\ a\ representation\ of\ a\ covariance\ from\ its\ precision\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00130}00130\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ precision\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ precision\ matrix;\ that\ is,\ the\ inverse\ of\ a\ square,\ symmetric,}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ positive\ definite\ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ covariance\ :\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ square,\ symmetric,\ positive\ definite\ covariance\ matrix.\ If\ not}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ provided,\ this\ may\ need\ to\ be\ calculated\ (e.g.\ to\ evaluate\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ cumulative\ distribution\ function\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}scipy.stats.multivariate\_normal\`{})\ by\ inverting\ \`{}precision\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00141}00141\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Let\ the\ covariance\ matrix\ be\ :math:\`{}A\`{},\ its\ precision\ matrix\ be}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}P\ =\ A\string^\{-\/1\}\`{},\ and\ :math:\`{}L\`{}\ be\ the\ lower\ Cholesky\ factor\ such}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ :math:\`{}L\ L\string^T\ =\ P\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whitening\ of\ a\ data\ point\ :math:\`{}x\`{}\ is\ performed\ by\ computing}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}x\string^T\ L\`{}.\ :math:\`{}\(\backslash\)log\(\backslash\)det\{A\}\`{}\ is\ calculated\ as}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}-\/2tr(\(\backslash\)log\{L\})\`{},\ where\ the\ :math:\`{}\(\backslash\)log\`{}\ operation\ is\ performed}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00151}00151\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ \`{}Covariance\`{}\ class\ does\ not\ support\ singular\ covariance\ matrices}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ because\ the\ precision\ matrix\ does\ not\ exist\ for\ a\ singular\ covariance}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00155}00155\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00156}00156\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Prepare\ a\ symmetric\ positive\ definite\ precision\ matrix\ \`{}\`{}P\`{}\`{}\ and\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ \`{}\`{}x\`{}\`{}.\ (If\ the\ precision\ matrix\ is\ not\ already\ available,}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ consider\ the\ other\ factory\ methods\ of\ the\ \`{}Covariance\`{}\ class.)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00161}00161\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 5}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ P\ =\ rng.random(size=(n,\ n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ P\ =\ P\ @\ P.T\ \ \#\ a\ precision\ matrix\ must\ be\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.random(size=n)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00169}00169\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Create\ the\ \`{}Covariance\`{}\ object.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00171}00171\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\ =\ stats.Covariance.from\_precision(P)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00173}00173\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compare\ the\ functionality\ of\ the\ \`{}Covariance\`{}\ object\ against}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reference\ implementations.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00176}00176\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.whiten(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ x\ @\ np.linalg.cholesky(P)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.log\_pdet}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ -\/np.linalg.slogdet(P)[-\/1]}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00185}00185\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision}{CovViaPrecision}}(precision,\ covariance)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00189}00189\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00190}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_acf9e6981771c072301775367c1f48a3f}{00190}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_acf9e6981771c072301775367c1f48a3f}{from\_cholesky}}(cholesky):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Representation\ of\ a\ covariance\ provided\ via\ the\ (lower)\ Cholesky\ factor}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00193}00193\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00194}00194\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00195}00195\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ cholesky\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ lower\ triangular\ Cholesky\ factor\ of\ the\ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00198}00198\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Let\ the\ covariance\ matrix\ be\ :math:\`{}A\`{}and\ :math:\`{}L\`{}\ be\ the\ lower}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Cholesky\ factor\ such\ that\ :math:\`{}L\ L\string^T\ =\ A\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whitening\ of\ a\ data\ point\ :math:\`{}x\`{}\ is\ performed\ by\ computing}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}L\string^\{-\/1\}\ x\`{}.\ :math:\`{}\(\backslash\)log\(\backslash\)det\{A\}\`{}\ is\ calculated\ as}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}2tr(\(\backslash\)log\{L\})\`{},\ where\ the\ :math:\`{}\(\backslash\)log\`{}\ operation\ is\ performed}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00207}00207\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ \`{}Covariance\`{}\ class\ does\ not\ support\ singular\ covariance\ matrices}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ because\ the\ Cholesky\ decomposition\ does\ not\ exist\ for\ a\ singular}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00211}00211\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Prepare\ a\ symmetric\ positive\ definite\ covariance\ matrix\ \`{}\`{}A\`{}\`{}\ and\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00216}00216\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 5}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ rng.random(size=(n,\ n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ A\ @\ A.T\ \ \#\ make\ the\ covariance\ symmetric\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.random(size=n)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00224}00224\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Perform\ the\ Cholesky\ decomposition\ of\ \`{}\`{}A\`{}\`{}\ and\ create\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}Covariance\`{}\ object.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00227}00227\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ L\ =\ np.linalg.cholesky(A)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\ =\ stats.Covariance.from\_cholesky(L)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00230}00230\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00231}00231\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compare\ the\ functionality\ of\ the\ \`{}Covariance\`{}\ object\ against}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00232}00232\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reference\ implementation.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00233}00233\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy.linalg\ import\ solve\_triangular}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00235}00235\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.whiten(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ solve\_triangular(L,\ x,\ lower=True)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00239}00239\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.log\_pdet}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00240}00240\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ np.linalg.slogdet(A)[-\/1]}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00243}00243\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky}{CovViaCholesky}}(cholesky)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00246}00246\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00247}00247\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00248}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a4bdd5c441ffe7711ff2df79ddf85d1fe}{00248}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a4bdd5c441ffe7711ff2df79ddf85d1fe}{from\_eigendecomposition}}(eigendecomposition):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Representation\ of\ a\ covariance\ provided\ via\ eigendecomposition}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00251}00251\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eigendecomposition\ :\ sequence}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ A\ sequence\ (nominally\ a\ tuple)\ containing\ the\ eigenvalue\ and}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ eigenvector\ arrays\ as\ computed\ by\ \`{}scipy.linalg.eigh\`{}\ or}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.linalg.eigh\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00258}00258\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Let\ the\ covariance\ matrix\ be\ :math:\`{}A\`{},\ let\ :math:\`{}V\`{}\ be\ matrix\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eigenvectors,\ and\ let\ :math:\`{}W\`{}\ be\ the\ diagonal\ matrix\ of\ eigenvalues}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ such\ that\ \`{}V\ W\ V\string^T\ =\ A\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00264}00264\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ all\ of\ the\ eigenvalues\ are\ strictly\ positive,\ whitening\ of\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ :math:\`{}x\`{}\ is\ performed\ by\ computing}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}x\string^T\ (V\ W\string^\{-\/1/2\})\`{},\ where\ the\ inverse\ square\ root\ can\ be\ taken}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :math:\`{}\(\backslash\)log\(\backslash\)det\{A\}\`{}\ is\ calculated\ as\ \ :math:\`{}tr(\(\backslash\)log\{W\})\`{},}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ the\ :math:\`{}\(\backslash\)log\`{}\ operation\ is\ performed\ element-\/wise.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00271}00271\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ \`{}Covariance\`{}\ class\ supports\ singular\ covariance\ matrices.\ When}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ computing\ \`{}\`{}\_log\_pdet\`{}\`{},\ non-\/positive\ eigenvalues\ are\ ignored.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whitening\ is\ not\ well\ defined\ when\ the\ point\ to\ be\ whitened}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ does\ not\ lie\ in\ the\ span\ of\ the\ columns\ of\ the\ covariance\ matrix.\ The}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ convention\ taken\ here\ is\ to\ treat\ the\ inverse\ square\ root\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ non-\/positive\ eigenvalues\ as\ zeros.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00278}00278\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00279}00279\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Prepare\ a\ symmetric\ positive\ definite\ covariance\ matrix\ \`{}\`{}A\`{}\`{}\ and\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ point\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00283}00283\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00285}00285\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 5}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ rng.random(size=(n,\ n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00289}00289\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ A\ @\ A.T\ \ \#\ make\ the\ covariance\ symmetric\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.random(size=n)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00291}00291\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Perform\ the\ eigendecomposition\ of\ \`{}\`{}A\`{}\`{}\ and\ create\ the\ \`{}Covariance\`{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ object.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00294}00294\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ w,\ v\ =\ np.linalg.eigh(A)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\ =\ stats.Covariance.from\_eigendecomposition((w,\ v))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00297}00297\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compare\ the\ functionality\ of\ the\ \`{}Covariance\`{}\ object\ against}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reference\ implementations.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00300}00300\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.whiten(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ x\ @\ (v\ @\ np.diag(w**-\/0.5))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ res\ =\ cov.log\_pdet}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ ref\ =\ np.linalg.slogdet(A)[-\/1]}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(res,\ ref)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00309}00309\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition}{CovViaEigendecomposition}}(eigendecomposition)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00313}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a9c789021037f566eded3c825d735e94a}{00313}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a9c789021037f566eded3c825d735e94a}{whiten}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Perform\ a\ whitening\ transformation\ on\ data.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00316}00316\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}Whitening"{}\ ("{}white"{}\ as\ in\ "{}white\ noise"{},\ in\ which\ each\ frequency\ has}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ equal\ magnitude)\ transforms\ a\ set\ of\ random\ variables\ into\ a\ new\ set\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ random\ variables\ with\ unit-\/diagonal\ covariance.\ When\ a\ whitening}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ transform\ is\ applied\ to\ a\ sample\ of\ points\ distributed\ according\ to}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ multivariate\ normal\ distribution\ with\ zero\ mean,\ the\ covariance\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ transformed\ sample\ is\ approximately\ the\ identity\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00323}00323\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ An\ array\ of\ points.\ The\ last\ dimension\ must\ correspond\ with\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ dimensionality\ of\ the\ space,\ i.e.,\ the\ number\ of\ columns\ in\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00330}00330\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\_\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ transformed\ array\ of\ points.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00335}00335\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [1]\ "{}Whitening\ Transformation"{}.\ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ https://en.wikipedia.org/wiki/Whitening\_transformation}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [2]\ Novak,\ Lukas,\ and\ Miroslav\ Vorechovsky.\ "{}Generalization\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coloring\ linear\ transformation"{}.\ Transactions\ of\ VSB\ 18.2}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2018):\ 31-\/35.\ :doi:\`{}10.31490/tces-\/2018-\/0013\`{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00343}00343\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 3}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ rng.random(size=(n,\ n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\_array\ =\ A\ @\ A.T\ \ \#\ make\ matrix\ symmetric\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ precision\ =\ np.linalg.inv(cov\_array)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\_object\ =\ stats.Covariance.from\_precision(precision)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.multivariate\_normal(np.zeros(n),\ cov\_array,\ size=(10000))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00355}00355\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\_\ =\ cov\_object.whiten(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.cov(x\_,\ rowvar=False)\ \ \#\ near-\/identity\ covariance}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ array([[0.97862122,\ 0.00893147,\ 0.02430451],}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.00893147,\ 0.96719062,\ 0.02201312],}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.02430451,\ 0.02201312,\ 0.99206881]])}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00360}00360\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\_whiten(np.asarray(x))}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00364}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a10ee3669e666112b311e4f6c4f639218}{00364}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a10ee3669e666112b311e4f6c4f639218}{colorize}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Perform\ a\ colorizing\ transformation\ on\ data.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00367}00367\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}Colorizing"{}\ ("{}color"{}\ as\ in\ "{}colored\ noise"{},\ in\ which\ different}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ frequencies\ may\ have\ different\ magnitudes)\ transforms\ a\ set\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ uncorrelated\ random\ variables\ into\ a\ new\ set\ of\ random\ variables\ with}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ desired\ covariance.\ When\ a\ coloring\ transform\ is\ applied\ to\ a}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\ of\ points\ distributed\ according\ to\ a\ multivariate\ normal}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distribution\ with\ identity\ covariance\ and\ zero\ mean,\ the\ covariance\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ transformed\ sample\ is\ approximately\ the\ covariance\ matrix\ used}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ the\ coloring\ transform.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00376}00376\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ An\ array\ of\ points.\ The\ last\ dimension\ must\ correspond\ with\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ dimensionality\ of\ the\ space,\ i.e.,\ the\ number\ of\ columns\ in\ the}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00383}00383\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\_\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ transformed\ array\ of\ points.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00388}00388\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [1]\ "{}Whitening\ Transformation"{}.\ Wikipedia.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ https://en.wikipedia.org/wiki/Whitening\_transformation}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [2]\ Novak,\ Lukas,\ and\ Miroslav\ Vorechovsky.\ "{}Generalization\ of}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coloring\ linear\ transformation"{}.\ Transactions\ of\ VSB\ 18.2}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2018):\ 31-\/35.\ :doi:\`{}10.31490/tces-\/2018-\/0013\`{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00396}00396\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ rng\ =\ np.random.default\_rng(1638083107694713882823079058616272161)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ n\ =\ 3}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ A\ =\ rng.random(size=(n,\ n))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00404}00404\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\_array\ =\ A\ @\ A.T\ \ \#\ make\ matrix\ symmetric\ positive\ definite}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cholesky\ =\ np.linalg.cholesky(cov\_array)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\_object\ =\ stats.Covariance.from\_cholesky(cholesky)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\ =\ rng.multivariate\_normal(np.zeros(n),\ np.eye(n),\ size=(10000))}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ x\_\ =\ cov\_object.colorize(x)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ cov\_data\ =\ np.cov(x\_,\ rowvar=False)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ >>>\ np.allclose(cov\_data,\ cov\_array,\ rtol=3e-\/2)}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\_colorize(np.asarray(x))}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00414}00414\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00415}00415\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00416}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a21f3f19b56e07ff6a0ebf20f0765e1af}{00416}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a21f3f19b56e07ff6a0ebf20f0765e1af}{log\_pdet}}(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Log\ of\ the\ pseudo-\/determinant\ of\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.array(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}},\ dtype=float)[()]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00421}00421\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00422}00422\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00423}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a94b558d8c735b3026ed21a329dc5640d}{00423}}\ \ \ \ \ \textcolor{keyword}{def\ }rank(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Rank\ of\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.array(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}},\ dtype=int)[()]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00428}00428\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00429}00429\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00430}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_afc223d447f96a9b6aed40c273b8b468a}{00430}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_afc223d447f96a9b6aed40c273b8b468a}{covariance}}(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Explicit\ representation\ of\ the\ covariance\ matrix}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\_covariance}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00435}00435\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00436}00436\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00437}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a3a6122ec3293f377b4b916cdb7c1aade}{00437}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a3a6122ec3293f377b4b916cdb7c1aade}{shape}}(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Shape\ of\ the\ covariance\ array}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00441}00441\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\_shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00442}00442\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00443}00443\ \ \ \ \ \textcolor{keyword}{def\ }\_validate\_matrix(self,\ A,\ name):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ A\ =\ np.atleast\_2d(A)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ m,\ n\ =\ A.shape[-\/2:]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00446}00446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ m\ !=\ n\ \textcolor{keywordflow}{or}\ A.ndim\ !=\ 2\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ (np.issubdtype(A.dtype,\ np.integer)\ \textcolor{keywordflow}{or}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.issubdtype(A.dtype,\ np.floating)):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ (f\textcolor{stringliteral}{"{}The\ input\ \`{}\{name\}`\ must\ be\ a\ square,\ "{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}two-\/dimensional\ array\ of\ real\ numbers."{}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00451}00451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ A}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00452}00452\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00453}00453\ \ \ \ \ \textcolor{keyword}{def\ }\_validate\_vector(self,\ A,\ name):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ A\ =\ np.atleast\_1d(A)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00455}00455\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ A.ndim\ !=\ 1\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ (np.issubdtype(A.dtype,\ np.integer)\ \textcolor{keywordflow}{or}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00456}00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.issubdtype(A.dtype,\ np.floating)):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00457}00457\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ (f\textcolor{stringliteral}{"{}The\ input\ \`{}\{name\}`\ must\ be\ a\ one-\/dimensional\ array\ "{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00458}00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}of\ real\ numbers."{}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00459}00459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ A}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00461}00461\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00462}00462\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00463}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision}{00463}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision}{CovViaPrecision}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00464}00464\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00465}00465\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ precision,\ covariance=None):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00466}00466\ \ \ \ \ \ \ \ \ precision\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a1d8a3db978d7908482337514b1d35bdc}{\_validate\_matrix}}(precision,\ \textcolor{stringliteral}{'precision'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ covariance\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ \ \ \ \ covariance\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a1d8a3db978d7908482337514b1d35bdc}{\_validate\_matrix}}(covariance,\ \textcolor{stringliteral}{'covariance'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}\`{}precision.shape`\ must\ equal\ \`{}covariance.shape`."{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00470}00470\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ precision.shape\ !=\ covariance.shape:}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00472}00472\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00473}00473\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_abcef9ba7142463a10104ec60688aea05}{\_chol\_P}}\ =\ np.linalg.cholesky(precision)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}}\ =\ -\/2*np.log(np.diag(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_abcef9ba7142463a10104ec60688aea05}{\_chol\_P}})).sum(axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}}\ =\ precision.shape[-\/1]\ \ \textcolor{comment}{\#\ must\ be\ full\ rank\ if\ invertible}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a08a29da0133a06a53be936ebb64b8fde}{\_precision}}\ =\ precision}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a99a0a87499236603ce61622c00705a0f}{\_cov\_matrix}}\ =\ covariance}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a1505a5fc6c4ceebb2b94c2f7ffdbe0e5}{\_shape}}\ =\ precision.shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_aab21f8b776d7c22b4a9465be96c858d9}{\_allow\_singular}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00481}00481\ \ \ \ \ \textcolor{keyword}{def\ }\_whiten(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_abcef9ba7142463a10104ec60688aea05}{\_chol\_P}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00483}00483\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00484}00484\ \ \ \ \ \textcolor{preprocessor}{@cached\_property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00485}00485\ \ \ \ \ \textcolor{keyword}{def\ }\_covariance(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ n\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a1505a5fc6c4ceebb2b94c2f7ffdbe0e5}{\_shape}}[-\/1]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00487}00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (linalg.cho\_solve((self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_abcef9ba7142463a10104ec60688aea05}{\_chol\_P}},\ \textcolor{keyword}{True}),\ np.eye(n))}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00488}00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a99a0a87499236603ce61622c00705a0f}{\_cov\_matrix}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_a99a0a87499236603ce61622c00705a0f}{\_cov\_matrix}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00489}00489\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00490}00490\ \ \ \ \ \textcolor{keyword}{def\ }\_colorize(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00491}00491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ linalg.solve\_triangular(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPrecision_abcef9ba7142463a10104ec60688aea05}{\_chol\_P}}.T,\ x.T,\ lower=\textcolor{keyword}{False}).T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00492}00492\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00493}00493\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00494}00494\ \textcolor{keyword}{def\ }\_dot\_diag(x,\ d):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00495}00495\ \ \ \ \ \textcolor{comment}{\#\ If\ d\ were\ a\ full\ diagonal\ matrix,\ x\ @\ d\ would\ always\ do\ what\ we\ want.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00496}00496\ \ \ \ \ \textcolor{comment}{\#\ Special\ treatment\ is\ needed\ for\ n-\/dimensional\ \`{}d`\ in\ which\ each\ row}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00497}00497\ \ \ \ \ \textcolor{comment}{\#\ includes\ only\ the\ diagonal\ elements\ of\ a\ covariance\ matrix.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00498}00498\ \ \ \ \ \textcolor{keywordflow}{return}\ x\ *\ d\ \textcolor{keywordflow}{if}\ x.ndim\ <\ 2\ \textcolor{keywordflow}{else}\ x\ *\ np.expand\_dims(d,\ -\/2)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00499}00499\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00500}00500\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00501}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal}{00501}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal}{CovViaDiagonal}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00502}00502\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00503}00503\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ diagonal):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00504}00504\ \ \ \ \ \ \ \ \ diagonal\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a5d58c4d574d1bb1e39bf9d3903fa8baa}{\_validate\_vector}}(diagonal,\ \textcolor{stringliteral}{'diagonal'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00505}00505\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00506}00506\ \ \ \ \ \ \ \ \ i\_zero\ =\ diagonal\ <=\ 0}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00507}00507\ \ \ \ \ \ \ \ \ positive\_diagonal\ =\ np.array(diagonal,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00508}00508\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ positive\_diagonal[i\_zero]\ =\ 1\ \ \textcolor{comment}{\#\ ones\ don't\ affect\ determinant}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}}\ =\ np.sum(np.log(positive\_diagonal),\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00511}00511\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ psuedo\_reciprocals\ =\ 1\ /\ np.sqrt(positive\_diagonal)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00513}00513\ \ \ \ \ \ \ \ \ psuedo\_reciprocals[i\_zero]\ =\ 0}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00514}00514\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00515}00515\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_ad89db67d03c6c9dada40764ef5e845b8}{\_sqrt\_diagonal}}\ =\ np.sqrt(diagonal)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00516}00516\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a51c01be67001cd71d864169624719f55}{\_LP}}\ =\ psuedo\_reciprocals}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00517}00517\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}}\ =\ positive\_diagonal.shape[-\/1]\ -\/\ i\_zero.sum(axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00518}00518\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a97822442e572553e4a71af33dd1ebdbe}{\_covariance}}\ =\ np.apply\_along\_axis(np.diag,\ -\/1,\ diagonal)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_ae8f71323605e09608eaee3e514cbd438}{\_i\_zero}}\ =\ i\_zero}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_acbf27687794cfd8c7aa05d0f74959764}{\_shape}}\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a97822442e572553e4a71af33dd1ebdbe}{\_covariance}}.shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_ac75b0d590c3990f636ff26c89b8c7cb4}{\_allow\_singular}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00523}00523\ \ \ \ \ \textcolor{keyword}{def\ }\_whiten(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00524}00524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_dot\_diag(x,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a51c01be67001cd71d864169624719f55}{\_LP}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00525}00525\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00526}00526\ \ \ \ \ \textcolor{keyword}{def\ }\_colorize(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_dot\_diag(x,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_ad89db67d03c6c9dada40764ef5e845b8}{\_sqrt\_diagonal}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00528}00528\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00529}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a1716f52e18eb8000801cbf8eee018773}{00529}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_a1716f52e18eb8000801cbf8eee018773}{\_support\_mask}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00531}00531\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Check\ whether\ x\ lies\ in\ the\ support\ of\ the\ distribution.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00533}00533\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \string~np.any(\_dot\_diag(x,\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaDiagonal_ae8f71323605e09608eaee3e514cbd438}{\_i\_zero}}),\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00534}00534\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00535}00535\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00536}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky}{00536}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky}{CovViaCholesky}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00537}00537\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00538}00538\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ cholesky):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ L\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a1d8a3db978d7908482337514b1d35bdc}{\_validate\_matrix}}(cholesky,\ \textcolor{stringliteral}{'cholesky'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00540}00540\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_acdf8414c5524c314a64a591c70094c68}{\_factor}}\ =\ L}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}}\ =\ 2*np.log(np.diag(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_acdf8414c5524c314a64a591c70094c68}{\_factor}})).sum(axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00543}00543\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}}\ =\ L.shape[-\/1]\ \ \textcolor{comment}{\#\ must\ be\ full\ rank\ for\ cholesky}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00544}00544\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_a2310a7fc0740f295e2a8339f370c53ba}{\_covariance}}\ =\ L\ @\ L.T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00545}00545\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_a1109ecb8bbf0f0b409b26a22aa197fcb}{\_shape}}\ =\ L.shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00546}00546\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_af8fba0ec7d74c9df47a28dbac1dc6134}{\_allow\_singular}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00547}00547\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00548}00548\ \ \ \ \ \textcolor{keyword}{def\ }\_whiten(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00549}00549\ \ \ \ \ \ \ \ \ res\ =\ linalg.solve\_triangular(self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_acdf8414c5524c314a64a591c70094c68}{\_factor}},\ x.T,\ lower=\textcolor{keyword}{True}).T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00550}00550\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00551}00551\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00552}00552\ \ \ \ \ \textcolor{keyword}{def\ }\_colorize(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaCholesky_acdf8414c5524c314a64a591c70094c68}{\_factor}}.T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00554}00554\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00555}00555\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00556}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition}{00556}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition}{CovViaEigendecomposition}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00557}00557\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00558}00558\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ eigendecomposition):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ eigenvalues,\ eigenvectors\ =\ eigendecomposition}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ eigenvalues\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a5d58c4d574d1bb1e39bf9d3903fa8baa}{\_validate\_vector}}(eigenvalues,\ \textcolor{stringliteral}{'eigenvalues'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ eigenvectors\ =\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_a1d8a3db978d7908482337514b1d35bdc}{\_validate\_matrix}}(eigenvectors,\ \textcolor{stringliteral}{'eigenvectors'})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ message\ =\ (\textcolor{stringliteral}{"{}The\ shapes\ of\ \`{}eigenvalues`\ and\ \`{}eigenvectors`\ "{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00563}00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}must\ be\ compatible."{}})}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00564}00564\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00565}00565\ \ \ \ \ \ \ \ \ \ \ \ \ eigenvalues\ =\ np.expand\_dims(eigenvalues,\ -\/2)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ \ \ \ \ eigenvectors,\ eigenvalues\ =\ np.broadcast\_arrays(eigenvectors,}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00567}00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eigenvalues)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00568}00568\ \ \ \ \ \ \ \ \ \ \ \ \ eigenvalues\ =\ eigenvalues[...,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00569}00569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ ValueError:}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00570}00570\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00571}00571\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ i\_zero\ =\ eigenvalues\ <=\ 0}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00573}00573\ \ \ \ \ \ \ \ \ positive\_eigenvalues\ =\ np.array(eigenvalues,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00574}00574\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00575}00575\ \ \ \ \ \ \ \ \ positive\_eigenvalues[i\_zero]\ =\ 1\ \ \textcolor{comment}{\#\ ones\ don't\ affect\ determinant}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00576}00576\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}}\ =\ np.sum(np.log(positive\_eigenvalues),\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00577}00577\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ psuedo\_reciprocals\ =\ 1\ /\ np.sqrt(positive\_eigenvalues)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00579}00579\ \ \ \ \ \ \ \ \ psuedo\_reciprocals[i\_zero]\ =\ 0}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00580}00580\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00581}00581\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a66d4767da5c2bd3434918d1157dffb05}{\_LP}}\ =\ eigenvectors\ *\ psuedo\_reciprocals}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00582}00582\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a7535688719ec40df96faa18af4d17fe6}{\_LA}}\ =\ eigenvectors\ *\ np.sqrt(eigenvalues)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}}\ =\ positive\_eigenvalues.shape[-\/1]\ -\/\ i\_zero.sum(axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00584}00584\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a6051853d96790f36147b4b6be1f2d555}{\_w}}\ =\ eigenvalues}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00585}00585\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a32f4b5ad180380fc115a3d628b9244e5}{\_v}}\ =\ eigenvectors}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a4efecab333b5df6fb2fc10327966ce73}{\_shape}}\ =\ eigenvectors.shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_adb03b9d45385cacf179ae9d4f46240eb}{\_null\_basis}}\ =\ eigenvectors\ *\ i\_zero}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ only\ used\ for\ \`{}\_support\_mask`,\ not\ to\ decide\ whether}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ covariance\ is\ singular\ or\ not.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00590}00590\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_aa9b10947f3f548e8cac07113c6496804}{\_eps}}\ =\ \_multivariate.\_eigvalsh\_to\_eps(eigenvalues)\ *\ 10**3}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00591}00591\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a8f9f94202affbffa8db4c5afedd8c5e7}{\_allow\_singular}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00592}00592\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00593}00593\ \ \ \ \ \textcolor{keyword}{def\ }\_whiten(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00594}00594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a66d4767da5c2bd3434918d1157dffb05}{\_LP}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00595}00595\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00596}00596\ \ \ \ \ \textcolor{keyword}{def\ }\_colorize(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00597}00597\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a7535688719ec40df96faa18af4d17fe6}{\_LA}}.T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00598}00598\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00599}00599\ \ \ \ \ \textcolor{preprocessor}{@cached\_property}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00600}00600\ \ \ \ \ \textcolor{keyword}{def\ }\_covariance(self):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a32f4b5ad180380fc115a3d628b9244e5}{\_v}}\ *\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a6051853d96790f36147b4b6be1f2d555}{\_w}})\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a32f4b5ad180380fc115a3d628b9244e5}{\_v}}.T}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00602}00602\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00603}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a36b7b4513c79d4e3eb7b8d58888f8d96}{00603}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_a36b7b4513c79d4e3eb7b8d58888f8d96}{\_support\_mask}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00605}00605\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Check\ whether\ x\ lies\ in\ the\ support\ of\ the\ distribution.}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00606}00606\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ residual\ =\ np.linalg.norm(x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_adb03b9d45385cacf179ae9d4f46240eb}{\_null\_basis}},\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ in\_support\ =\ residual\ <\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaEigendecomposition_aa9b10947f3f548e8cac07113c6496804}{\_eps}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ in\_support}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00610}00610\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00611}00611\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00612}\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD}{00612}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD}{CovViaPSD}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance}{Covariance}}):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00613}00613\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00614}00614\ \textcolor{stringliteral}{\ \ \ \ Representation\ of\ a\ covariance\ provided\ via\ an\ instance\ of\ \_PSD}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00615}00615\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00616}00616\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00617}00617\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ psd):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_ae7ab030025ead548cd877f6f2a936240}{\_LP}}\ =\ psd.U}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ac7c832af982ef3bb843e0684a1ea44e6}{\_log\_pdet}}\ =\ psd.log\_pdet}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1Covariance_ae2aae6b62376641a750fa80dcd14d007}{\_rank}}\ =\ psd.rank}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_aac92ae4e17adbaa95da8eb4ccf76e9c5}{\_covariance}}\ =\ psd.\_M}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_a62895de1180c03b70e18bc47f7faf509}{\_shape}}\ =\ psd.\_M.shape}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_a5799b85dddfc6583fd1c98ca41ddf6f8}{\_psd}}\ =\ psd}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_af8f7bbf71c4b892425cacfd021e74e55}{\_allow\_singular}}\ =\ \textcolor{keyword}{False}\ \ \textcolor{comment}{\#\ by\ default}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00625}00625\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00626}00626\ \ \ \ \ \textcolor{keyword}{def\ }\_whiten(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\ @\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_ae7ab030025ead548cd877f6f2a936240}{\_LP}}}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00628}00628\ }
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00629}00629\ \ \ \ \ \textcolor{keyword}{def\ }\_support\_mask(self,\ x):}
\DoxyCodeLine{\Hypertarget{__covariance_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1stats_1_1__covariance_1_1CovViaPSD_a5799b85dddfc6583fd1c98ca41ddf6f8}{\_psd}}.\_support\_mask(x)}

\end{DoxyCode}
