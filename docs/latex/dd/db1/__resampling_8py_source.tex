\doxysection{\+\_\+resampling.\+py}
\hypertarget{__resampling_8py_source}{}\label{__resampling_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_resampling.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_resampling.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00003}00003\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00004}00004\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00005}00005\ \textcolor{keyword}{from}\ itertools\ \textcolor{keyword}{import}\ combinations,\ permutations,\ product}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Sequence}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00007}00007\ \textcolor{keyword}{import}\ inspect}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1__lib_1_1__util}{scipy.\_lib.\_util}}\ \textcolor{keyword}{import}\ check\_random\_state,\ \_rename\_parameter}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special}{scipy.special}}\ \textcolor{keyword}{import}\ ndtr,\ ndtri,\ comb,\ factorial}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1__lib_1_1__util}{scipy.\_lib.\_util}}\ \textcolor{keyword}{import}\ rng\_integers}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00012}00012\ \textcolor{keyword}{from}\ dataclasses\ \textcolor{keyword}{import}\ dataclass}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00013}00013\ \textcolor{keyword}{from}\ .\_common\ \textcolor{keyword}{import}\ ConfidenceInterval}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00014}00014\ \textcolor{keyword}{from}\ .\_axis\_nan\_policy\ \textcolor{keyword}{import}\ \_broadcast\_concatenate,\ \_broadcast\_arrays}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00015}00015\ \textcolor{keyword}{from}\ .\_warnings\_errors\ \textcolor{keyword}{import}\ DegenerateDataWarning}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00017}00017\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'bootstrap'},\ \textcolor{stringliteral}{'monte\_carlo\_test'},\ \textcolor{stringliteral}{'permutation\_test'}]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00020}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a1cbf31c18034ecab33c5c808b268dd86}{00020}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a1cbf31c18034ecab33c5c808b268dd86}{\_vectorize\_statistic}}(statistic):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00021}00021\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Vectorize\ an\ n-\/sample\ statistic"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00022}00022\ \ \ \ \ \textcolor{comment}{\#\ This\ is\ a\ little\ cleaner\ than\ np.nditer\ at\ the\ expense\ of\ some\ data}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00023}00023\ \ \ \ \ \textcolor{comment}{\#\ copying:\ concatenate\ samples\ together,\ then\ use\ np.apply\_along\_axis}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{def\ }stat\_nd(*data,\ axis=0):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ lengths\ =\ [sample.shape[axis]\ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ split\_indices\ =\ np.cumsum(lengths)[:-\/1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ z\ =\ \_broadcast\_concatenate(data,\ axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ move\ working\ axis\ to\ position\ 0\ so\ that\ new\ dimensions\ in\ the\ output}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ \`{}statistic`\ are\ \_prepended\_.\ ("{}This\ axis\ is\ removed,\ and\ replaced}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ new\ dimensions..."{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ z\ =\ np.moveaxis(z,\ axis,\ 0)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }stat\_1d(z):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ np.split(z,\ split\_indices)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ statistic(*data)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.apply\_along\_axis(stat\_1d,\ 0,\ z)[()]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{return}\ stat\_nd}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00042}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a769ff272403e86cb56c70da1815f7578}{00042}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a769ff272403e86cb56c70da1815f7578}{\_jackknife\_resample}}(sample,\ batch=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00043}00043\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Jackknife\ resample\ the\ sample.\ Only\ one-\/sample\ stats\ for\ now."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00044}00044\ \ \ \ \ n\ =\ sample.shape[-\/1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00045}00045\ \ \ \ \ batch\_nominal\ =\ batch\ \textcolor{keywordflow}{or}\ n}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(0,\ n,\ batch\_nominal):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ col\_start:col\_end\ are\ the\ observations\ to\ remove}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ batch\_actual\ =\ min(batch\_nominal,\ n-\/k)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ jackknife\ -\/\ each\ row\ leaves\ out\ one\ observation}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ j\ =\ np.ones((batch\_actual,\ n),\ dtype=bool)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ np.fill\_diagonal(j[:,\ k:k+batch\_actual],\ \textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ i\ =\ np.arange(n)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ i\ =\ np.broadcast\_to(i,\ (batch\_actual,\ n))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ i\ =\ i[j].reshape((batch\_actual,\ n-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ resamples\ =\ sample[...,\ i]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ resamples}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00062}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a92d4dbf131de119c12f6c988ff2f220c}{00062}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a92d4dbf131de119c12f6c988ff2f220c}{\_bootstrap\_resample}}(sample,\ n\_resamples=None,\ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00063}00063\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Bootstrap\ resample\ the\ sample."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00064}00064\ \ \ \ \ n\ =\ sample.shape[-\/1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00066}00066\ \ \ \ \ \textcolor{comment}{\#\ bootstrap\ -\/\ each\ row\ is\ a\ random\ resample\ of\ original\ observations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00067}00067\ \ \ \ \ i\ =\ rng\_integers(random\_state,\ 0,\ n,\ (n\_resamples,\ n))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00069}00069\ \ \ \ \ resamples\ =\ sample[...,\ i]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00070}00070\ \ \ \ \ \textcolor{keywordflow}{return}\ resamples}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00073}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a4d690dafccfb69022dcf50b4c19becdd}{00073}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a4d690dafccfb69022dcf50b4c19becdd}{\_percentile\_of\_score}}(a,\ score,\ axis):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00074}00074\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Vectorized,\ simplified\ \`{}scipy.stats.percentileofscore\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ Uses\ logic\ of\ the\ 'mean'\ value\ of\ percentileofscore's\ kind\ parameter.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00076}00076\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ Unlike\ \`{}stats.percentileofscore\`{},\ the\ percentile\ returned\ is\ a\ fraction}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ in\ [0,\ 1].}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00080}00080\ \ \ \ \ B\ =\ a.shape[axis]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00081}00081\ \ \ \ \ \textcolor{keywordflow}{return}\ ((a\ <\ score).sum(axis=axis)\ +\ (a\ <=\ score).sum(axis=axis))\ /\ (2\ *\ B)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00084}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_acbe7a1919ac1faf534dd1e5e3f091543}{00084}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_acbe7a1919ac1faf534dd1e5e3f091543}{\_percentile\_along\_axis}}(theta\_hat\_b,\ alpha):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00085}00085\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\`{}np.percentile\`{}\ with\ different\ percentile\ for\ each\ slice."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00086}00086\ \ \ \ \ \textcolor{comment}{\#\ the\ difference\ between\ \_percentile\_along\_axis\ and\ np.percentile\ is\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00087}00087\ \ \ \ \ \textcolor{comment}{\#\ np.percentile\ gets\ \_all\_\ the\ qs\ for\ each\ axis\ slice,\ whereas}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00088}00088\ \ \ \ \ \textcolor{comment}{\#\ \_percentile\_along\_axis\ gets\ the\ q\ corresponding\ with\ each\ axis\ slice}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00089}00089\ \ \ \ \ shape\ =\ theta\_hat\_b.shape[:-\/1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00090}00090\ \ \ \ \ alpha\ =\ np.broadcast\_to(alpha,\ shape)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00091}00091\ \ \ \ \ percentiles\ =\ np.zeros\_like(alpha,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00092}00092\ \ \ \ \ \textcolor{keywordflow}{for}\ indices,\ alpha\_i\ \textcolor{keywordflow}{in}\ np.ndenumerate(alpha):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.isnan(alpha\_i):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ e.g.\ when\ bootstrap\ distribution\ has\ only\ one\ unique\ element}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ (}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ BCa\ confidence\ interval\ cannot\ be\ calculated."{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ This\ problem\ is\ known\ to\ occur\ when\ the\ distribution"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ degenerate\ or\ the\ statistic\ is\ np.min."{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.warn(\mbox{\hyperlink{classscipy_1_1stats_1_1__warnings__errors_1_1DegenerateDataWarning}{DegenerateDataWarning}}(msg))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ percentiles[indices]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ theta\_hat\_b\_i\ =\ theta\_hat\_b[indices]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ percentiles[indices]\ =\ np.percentile(theta\_hat\_b\_i,\ alpha\_i)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00105}00105\ \ \ \ \ \textcolor{keywordflow}{return}\ percentiles[()]\ \ \textcolor{comment}{\#\ return\ scalar\ instead\ of\ 0d\ array}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00108}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a2f04e1d5f070ff31f1343441e0d49b13}{00108}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a2f04e1d5f070ff31f1343441e0d49b13}{\_bca\_interval}}(data,\ statistic,\ axis,\ alpha,\ theta\_hat\_b,\ batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00109}00109\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Bias-\/corrected\ and\ accelerated\ interval."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00110}00110\ \ \ \ \ \textcolor{comment}{\#\ closely\ follows\ [1]\ 14.3\ and\ 15.4\ (Eq.\ 15.36)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00112}00112\ \ \ \ \ \textcolor{comment}{\#\ calculate\ z0\_hat}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00113}00113\ \ \ \ \ theta\_hat\ =\ np.asarray(statistic(*data,\ axis=axis))[...,\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00114}00114\ \ \ \ \ percentile\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a4d690dafccfb69022dcf50b4c19becdd}{\_percentile\_of\_score}}(theta\_hat\_b,\ theta\_hat,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00115}00115\ \ \ \ \ z0\_hat\ =\ ndtri(percentile)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00117}00117\ \ \ \ \ \textcolor{comment}{\#\ calculate\ a\_hat}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00118}00118\ \ \ \ \ theta\_hat\_ji\ =\ []\ \ \textcolor{comment}{\#\ j\ is\ for\ sample\ of\ data,\ i\ is\ for\ jackknife\ resample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00119}00119\ \ \ \ \ \textcolor{keywordflow}{for}\ j,\ sample\ \textcolor{keywordflow}{in}\ enumerate(data):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \_jackknife\_resample\ will\ add\ an\ axis\ prior\ to\ the\ last\ axis\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ corresponds\ with\ the\ different\ jackknife\ resamples.\ Do\ the\ same\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ each\ sample\ of\ the\ data\ to\ ensure\ broadcastability.\ We\ need\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ create\ a\ copy\ of\ the\ list\ containing\ the\ samples\ anyway,\ so\ do\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ the\ loop\ to\ simplify\ the\ code.\ This\ is\ not\ the\ bottleneck...}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ samples\ =\ [np.expand\_dims(sample,\ -\/2)\ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ theta\_hat\_i\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ jackknife\_sample\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a769ff272403e86cb56c70da1815f7578}{\_jackknife\_resample}}(sample,\ batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ samples[j]\ =\ jackknife\_sample}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ broadcasted\ =\ \_broadcast\_arrays(samples,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ theta\_hat\_i.append(statistic(*broadcasted,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ theta\_hat\_ji.append(theta\_hat\_i)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00133}00133\ \ \ \ \ theta\_hat\_ji\ =\ [np.concatenate(theta\_hat\_i,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ theta\_hat\_i\ \textcolor{keywordflow}{in}\ theta\_hat\_ji]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00136}00136\ \ \ \ \ n\_j\ =\ [theta\_hat\_i.shape[-\/1]\ \textcolor{keywordflow}{for}\ theta\_hat\_i\ \textcolor{keywordflow}{in}\ theta\_hat\_ji]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00138}00138\ \ \ \ \ theta\_hat\_j\_dot\ =\ [theta\_hat\_i.mean(axis=-\/1,\ keepdims=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ theta\_hat\_i\ \textcolor{keywordflow}{in}\ theta\_hat\_ji]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00141}00141\ \ \ \ \ U\_ji\ =\ [(n\ -\/\ 1)\ *\ (theta\_hat\_dot\ -\/\ theta\_hat\_i)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ theta\_hat\_dot,\ theta\_hat\_i,\ n}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{in}\ zip(theta\_hat\_j\_dot,\ theta\_hat\_ji,\ n\_j)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00145}00145\ \ \ \ \ nums\ =\ [(U\_i**3).sum(axis=-\/1)/n**3\ \textcolor{keywordflow}{for}\ U\_i,\ n\ \textcolor{keywordflow}{in}\ zip(U\_ji,\ n\_j)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00146}00146\ \ \ \ \ dens\ =\ [(U\_i**2).sum(axis=-\/1)/n**2\ \textcolor{keywordflow}{for}\ U\_i,\ n\ \textcolor{keywordflow}{in}\ zip(U\_ji,\ n\_j)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00147}00147\ \ \ \ \ a\_hat\ =\ 1/6\ *\ sum(nums)\ /\ sum(dens)**(3/2)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00149}00149\ \ \ \ \ \textcolor{comment}{\#\ calculate\ alpha\_1,\ alpha\_2}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00150}00150\ \ \ \ \ z\_alpha\ =\ ndtri(alpha)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00151}00151\ \ \ \ \ z\_1alpha\ =\ -\/z\_alpha}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00152}00152\ \ \ \ \ num1\ =\ z0\_hat\ +\ z\_alpha}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00153}00153\ \ \ \ \ alpha\_1\ =\ ndtr(z0\_hat\ +\ num1/(1\ -\/\ a\_hat*num1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00154}00154\ \ \ \ \ num2\ =\ z0\_hat\ +\ z\_1alpha}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00155}00155\ \ \ \ \ alpha\_2\ =\ ndtr(z0\_hat\ +\ num2/(1\ -\/\ a\_hat*num2))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00156}00156\ \ \ \ \ \textcolor{keywordflow}{return}\ alpha\_1,\ alpha\_2,\ a\_hat\ \ \textcolor{comment}{\#\ return\ a\_hat\ for\ testing}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00159}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ac8abcdc18ed960610af3403ad6fdf8ac}{00159}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ac8abcdc18ed960610af3403ad6fdf8ac}{\_bootstrap\_iv}}(data,\ statistic,\ vectorized,\ paired,\ axis,\ confidence\_level,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative,\ n\_resamples,\ batch,\ method,\ bootstrap\_result,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00162}00162\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Input\ validation\ and\ standardization\ for\ \`{}bootstrap\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00163}00163\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00164}00164\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \{\textcolor{keyword}{True},\ \textcolor{keyword}{False},\ \textcolor{keywordtype}{None}\}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}vectorized`\ must\ be\ \`{}True`,\ \`{}False`,\ or\ \`{}None`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00167}00167\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ vectorized\ =\ \textcolor{stringliteral}{'axis'}\ \textcolor{keywordflow}{in}\ inspect.signature(statistic).parameters}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00170}00170\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ vectorized:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ statistic\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a1cbf31c18034ecab33c5c808b268dd86}{\_vectorize\_statistic}}(statistic)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00173}00173\ \ \ \ \ axis\_int\ =\ int(axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00174}00174\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ !=\ axis\_int:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}axis`\ must\ be\ an\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00177}00177\ \ \ \ \ n\_samples\ =\ 0}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00178}00178\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ n\_samples\ =\ len(data)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00180}00180\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ sequence\ of\ samples."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00183}00183\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_samples\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}data`\ must\ contain\ at\ least\ one\ sample."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00186}00186\ \ \ \ \ data\_iv\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00187}00187\ \ \ \ \ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ sample\ =\ np.atleast\_1d(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sample.shape[axis\_int]\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}each\ sample\ in\ \`{}data`\ must\ contain\ two\ or\ more\ "{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}observations\ along\ \`{}axis`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ sample\ =\ np.moveaxis(sample,\ axis\_int,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ data\_iv.append(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00195}00195\ \ \ \ \ \textcolor{keywordflow}{if}\ paired\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \{\textcolor{keyword}{True},\ \textcolor{keyword}{False}\}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}paired`\ must\ be\ \`{}True`\ or\ \`{}False`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00198}00198\ \ \ \ \ \textcolor{keywordflow}{if}\ paired:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ n\ =\ data\_iv[0].shape[-\/1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data\_iv[1:]:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sample.shape[-\/1]\ !=\ n:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ (\textcolor{stringliteral}{"{}When\ \`{}paired\ is\ True`,\ all\ samples\ must\ have\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}same\ length\ along\ \`{}axis`"{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00206}00206\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ generate\ the\ bootstrap\ distribution\ for\ paired-\/sample\ statistics,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ resample\ the\ indices\ of\ the\ observations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }statistic(i,\ axis=-\/1,\ data=data\_iv,\ unpaired\_statistic=statistic):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ [sample[...,\ i]\ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ unpaired\_statistic(*data,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ data\_iv\ =\ [np.arange(n)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00214}00214\ \ \ \ \ confidence\_level\_float\ =\ float(confidence\_level)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00216}00216\ \ \ \ \ alternative\ =\ alternative.lower()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00217}00217\ \ \ \ \ alternatives\ =\ \{\textcolor{stringliteral}{'two-\/sided'},\ \textcolor{stringliteral}{'less'},\ \textcolor{stringliteral}{'greater'}\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00218}00218\ \ \ \ \ \textcolor{keywordflow}{if}\ alternative\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ alternatives:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\`{}alternative`\ must\ be\ one\ of\ \{alternatives\}"{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00221}00221\ \ \ \ \ n\_resamples\_int\ =\ int(n\_resamples)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00222}00222\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_resamples\ !=\ n\_resamples\_int\ \textcolor{keywordflow}{or}\ n\_resamples\_int\ <\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}n\_resamples`\ must\ be\ a\ non-\/negative\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00225}00225\ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ batch\_iv\ =\ batch}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00227}00227\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ batch\_iv\ =\ int(batch)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ !=\ batch\_iv\ \textcolor{keywordflow}{or}\ batch\_iv\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}batch`\ must\ be\ a\ positive\ integer\ or\ None."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00232}00232\ \ \ \ \ methods\ =\ \{\textcolor{stringliteral}{'percentile'},\ \textcolor{stringliteral}{'basic'},\ \textcolor{stringliteral}{'bca'}\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00233}00233\ \ \ \ \ method\ =\ method.lower()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00234}00234\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ methods:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\`{}method`\ must\ be\ in\ \{methods\}"{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00237}00237\ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}\`{}bootstrap\_result`\ must\ have\ attribute\ \`{}bootstrap\_distribution'"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00238}00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (bootstrap\_result\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ hasattr(bootstrap\_result,\ \textcolor{stringliteral}{"{}bootstrap\_distribution"{}})):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00242}00242\ \ \ \ \ message\ =\ (\textcolor{stringliteral}{"{}Either\ \`{}bootstrap\_result.bootstrap\_distribution.size`\ or\ "{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\`{}n\_resamples`\ must\ be\ positive."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00244}00244\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordflow}{not}\ bootstrap\_result\ \textcolor{keywordflow}{or}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{not}\ bootstrap\_result.bootstrap\_distribution.size)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ n\_resamples\_int\ ==\ 0):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00249}00249\ \ \ \ \ random\_state\ =\ check\_random\_state(random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00251}00251\ \ \ \ \ \textcolor{keywordflow}{return}\ (data\_iv,\ statistic,\ vectorized,\ paired,\ axis\_int,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ confidence\_level\_float,\ alternative,\ n\_resamples\_int,\ batch\_iv,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ method,\ bootstrap\_result,\ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00254}00254\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00255}00255\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00256}00256\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00257}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapResult}{00257}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapResult}{BootstrapResult}}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00258}00258\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Result\ object\ returned\ by\ \`{}scipy.stats.bootstrap\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00259}00259\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ confidence\_interval\ :\ ConfidenceInterval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bootstrap\ confidence\ interval\ as\ an\ instance\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}collections.namedtuple\`{}\ with\ attributes\ \`{}low\`{}\ and\ \`{}high\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ bootstrap\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bootstrap\ distribution,\ that\ is,\ the\ value\ of\ \`{}statistic\`{}\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ each\ resample.\ The\ last\ dimension\ corresponds\ with\ the\ resamples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (e.g.\ \`{}\`{}res.bootstrap\_distribution.shape[-\/1]\ ==\ n\_resamples\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ standard\_error\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bootstrap\ standard\ error,\ that\ is,\ the\ sample\ standard}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ deviation\ of\ the\ bootstrap\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00272}00272\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00274}00274\ \ \ \ \ confidence\_interval:\ ConfidenceInterval}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00275}00275\ \ \ \ \ bootstrap\_distribution:\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00276}00276\ \ \ \ \ standard\_error:\ float\ |\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00279}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a6c3d395af56f8cabdf385cf951cbc52d}{00279}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a6c3d395af56f8cabdf385cf951cbc52d}{bootstrap}}(data,\ statistic,\ *,\ n\_resamples=9999,\ batch=None,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vectorized=None,\ paired=False,\ axis=0,\ confidence\_level=0.95,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative='two-\/sided',\ method='BCa',\ bootstrap\_result=None,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00283}00283\ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ Compute\ a\ two-\/sided\ bootstrap\ confidence\ interval\ of\ a\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00285}00285\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}method\`{}\ is\ \`{}\`{}'percentile'\`{}\`{}\ and\ \`{}alternative\`{}\ is\ \`{}\`{}'two-\/sided'\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ a\ bootstrap\ confidence\ interval\ is\ computed\ according\ to\ the\ following}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ procedure.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00289}00289\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ 1.\ Resample\ the\ data:\ for\ each\ sample\ in\ \`{}data\`{}\ and\ for\ each\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \`{}n\_resamples\`{},\ take\ a\ random\ sample\ of\ the\ original\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ (with\ replacement)\ of\ the\ same\ size\ as\ the\ original\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00293}00293\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ 2.\ Compute\ the\ bootstrap\ distribution\ of\ the\ statistic:\ for\ each\ set\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ \ \ \ resamples,\ compute\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00296}00296\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ 3.\ Determine\ the\ confidence\ interval:\ find\ the\ interval\ of\ the\ bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ \ \ \ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00299}00299\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ symmetric\ about\ the\ median\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ contains\ \`{}confidence\_level\`{}\ of\ the\ resampled\ statistic\ values.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00302}00302\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ While\ the\ \`{}\`{}'percentile'\`{}\`{}\ method\ is\ the\ most\ intuitive,\ it\ is\ rarely}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ used\ in\ practice.\ Two\ more\ common\ methods\ are\ available,\ \`{}\`{}'basic'\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ ('reverse\ percentile')\ and\ \`{}\`{}'BCa'\`{}\`{}\ ('bias-\/corrected\ and\ accelerated');}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ they\ differ\ in\ how\ step\ 3\ is\ performed.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00307}00307\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ If\ the\ samples\ in\ \`{}data\`{}\ are\ \ taken\ at\ random\ from\ their\ respective}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ distributions\ :math:\`{}n\`{}\ times,\ the\ confidence\ interval\ returned\ by}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \`{}bootstrap\`{}\ will\ contain\ the\ true\ value\ of\ the\ statistic\ for\ those}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ distributions\ approximately\ \`{}confidence\_level\`{}:math:\`{}\(\backslash\),\ \(\backslash\)times\ \(\backslash\),\ n\`{}\ times.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00312}00312\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ data\ :\ sequence\ of\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ Each\ element\ of\ data\ is\ a\ sample\ from\ an\ underlying\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Statistic\ for\ which\ the\ confidence\ interval\ is\ to\ be\ calculated.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}statistic\`{}\ must\ be\ a\ callable\ that\ accepts\ \`{}\`{}len(data)\`{}\`{}\ samples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ separate\ arguments\ and\ returns\ the\ resulting\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}True\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}statistic\`{}\ must\ also\ accept\ a\ keyword\ argument\ \`{}axis\`{}\ and\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ vectorized\ to\ compute\ the\ statistic\ along\ the\ provided\ \`{}axis\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int,\ default:\ \`{}\`{}9999\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ performed\ to\ form\ the\ bootstrap\ distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ process\ in\ each\ vectorized\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}statistic\`{}.\ Memory\ usage\ is\ O(\`{}batch\`{}*\`{}\`{}n\`{}\`{}),\ where\ \`{}\`{}n\`{}\`{}\ is\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\ size.\ Default\ is\ \`{}\`{}None\`{}\`{},\ in\ which\ case\ \`{}\`{}batch\ =\ n\_resamples\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (or\ \`{}\`{}batch\ =\ max(n\_resamples,\ n)\`{}\`{}\ for\ \`{}\`{}method='BCa'\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ vectorized\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}False\`{}\`{},\ \`{}statistic\`{}\ will\ not\ be\ passed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ keyword\ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ only\ for\ 1D\ samples.\ If\ \`{}\`{}True\`{}\`{},\ \`{}statistic\`{}\ will\ be\ passed\ keyword}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic\ along\ \`{}axis\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ when\ passed\ an\ ND\ sample\ array.\ If\ \`{}\`{}None\`{}\`{}\ (default),\ \`{}vectorized\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ be\ set\ \`{}\`{}True\`{}\`{}\ if\ \`{}\`{}axis\`{}\`{}\ is\ a\ parameter\ of\ \`{}statistic\`{}.\ Use\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ vectorized\ statistic\ typically\ reduces\ computation\ time.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ paired\ :\ bool,\ default:\ \`{}\`{}False\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ the\ statistic\ treats\ corresponding\ elements\ of\ the\ samples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ \`{}data\`{}\ as\ paired.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ default:\ \`{}\`{}0\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ axis\ of\ the\ samples\ in\ \`{}data\`{}\ along\ which\ the\ \`{}statistic\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculated.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ confidence\_level\ :\ float,\ default:\ \`{}\`{}0.95\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ confidence\ level\ of\ the\ confidence\ interval.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ alternative\ :\ \{'two-\/sided',\ 'less',\ 'greater'\},\ default:\ \`{}\`{}'two-\/sided'\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Choose\ \`{}\`{}'two-\/sided'\`{}\`{}\ (default)\ for\ a\ two-\/sided\ confidence\ interval,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}'less'\`{}\`{}\ for\ a\ one-\/sided\ confidence\ interval\ with\ the\ lower\ bound}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ at\ \`{}\`{}-\/np.inf\`{}\`{},\ and\ \`{}\`{}'greater'\`{}\`{}\ for\ a\ one-\/sided\ confidence\ interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ with\ the\ upper\ bound\ at\ \`{}\`{}np.inf\`{}\`{}.\ The\ other\ bound\ of\ the\ one-\/sided}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ confidence\ intervals\ is\ the\ same\ as\ that\ of\ a\ two-\/sided\ confidence}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ interval\ with\ \`{}confidence\_level\`{}\ twice\ as\ far\ from\ 1.0;\ e.g.\ the\ upper}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00355}00355\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bound\ of\ a\ 95\%\ \`{}\`{}'less'\`{}\`{}\ \ confidence\ interval\ is\ the\ same\ as\ the\ upper}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bound\ of\ a\ 90\%\ \`{}\`{}'two-\/sided'\`{}\`{}\ confidence\ interval.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ method\ :\ \{'percentile',\ 'basic',\ 'bca'\},\ default:\ \`{}\`{}'BCa'\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ return\ the\ 'percentile'\ bootstrap\ confidence\ interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (\`{}\`{}'percentile'\`{}\`{}),\ the\ 'basic'\ (AKA\ 'reverse')\ bootstrap\ confidence}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ interval\ (\`{}\`{}'basic'\`{}\`{}),\ or\ the\ bias-\/corrected\ and\ accelerated\ bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ confidence\ interval\ (\`{}\`{}'BCa'\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00362}00362\ \textcolor{stringliteral}{\ \ \ \ bootstrap\_result\ :\ BootstrapResult,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00363}00363\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Provide\ the\ result\ object\ returned\ by\ a\ previous\ call\ to\ \`{}bootstrap\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ include\ the\ previous\ bootstrap\ distribution\ in\ the\ new\ bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00365}00365\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distribution.\ This\ can\ be\ used,\ for\ example,\ to\ change}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}confidence\_level\`{},\ change\ \`{}method\`{},\ or\ see\ the\ effect\ of\ performing}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ additional\ resampling\ without\ repeating\ computations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ random\_state\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00370}00370\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Pseudorandom\ number\ generator\ state\ used\ to\ generate\ resamples.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00372}00372\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ \`{}\`{}None\`{}\`{}\ (or\ \`{}np.random\`{}),\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}random\_state\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ instance\ then\ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00379}00379\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ res\ :\ BootstrapResult}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ object\ with\ attributes:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00384}00384\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ confidence\_interval\ :\ ConfidenceInterval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ bootstrap\ confidence\ interval\ as\ an\ instance\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}collections.namedtuple\`{}\ with\ attributes\ \`{}low\`{}\ and\ \`{}high\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bootstrap\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ bootstrap\ distribution,\ that\ is,\ the\ value\ of\ \`{}statistic\`{}\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ each\ resample.\ The\ last\ dimension\ corresponds\ with\ the\ resamples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ (e.g.\ \`{}\`{}res.bootstrap\_distribution.shape[-\/1]\ ==\ n\_resamples\`{}\`{}).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ standard\_error\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ bootstrap\ standard\ error,\ that\ is,\ the\ sample\ standard}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ deviation\ of\ the\ bootstrap\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00395}00395\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ Warns}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ \`{}\string~scipy.stats.DegenerateDataWarning\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Generated\ when\ \`{}\`{}method='BCa'\`{}\`{}\ and\ the\ bootstrap\ distribution\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ degenerate\ (e.g.\ all\ elements\ are\ identical).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00401}00401\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00404}00404\ \textcolor{stringliteral}{\ \ \ \ Elements\ of\ the\ confidence\ interval\ may\ be\ NaN\ for\ \`{}\`{}method='BCa'\`{}\`{}\ if}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ the\ bootstrap\ distribution\ is\ degenerate\ (e.g.\ all\ elements\ are\ identical).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ In\ this\ case,\ consider\ using\ another\ \`{}method\`{}\ or\ inspecting\ \`{}data\`{}\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ indications\ that\ other\ analysis\ may\ be\ more\ appropriate\ (e.g.\ all}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ observations\ are\ identical).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00409}00409\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ B.\ Efron\ and\ R.\ J.\ Tibshirani,\ An\ Introduction\ to\ the\ Bootstrap,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Chapman\ \&\ Hall/CRC,\ Boca\ Raton,\ FL,\ USA\ (1993)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ Nathaniel\ E.\ Helwig,\ "{}Bootstrap\ Confidence\ Intervals"{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ \ \ \ http://users.stat.umn.edu/\string~helwig/notes/bootci-\/Notes.pdf}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00416}00416\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ Bootstrapping\ (statistics),\ Wikipedia,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ \ \ \ https://en.wikipedia.org/wiki/Bootstrapping\_\%28statistics\%29}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00418}00418\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ Suppose\ we\ have\ sampled\ data\ from\ an\ unknown\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00422}00422\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ norm}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ >>>\ dist\ =\ norm(loc=2,\ scale=4)\ \ \#\ our\ "{}unknown"{}\ distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ >>>\ data\ =\ dist.rvs(size=100,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00428}00428\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00429}00429\ \textcolor{stringliteral}{\ \ \ \ We\ are\ interested\ in\ the\ standard\ deviation\ of\ the\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00430}00430\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ >>>\ std\_true\ =\ dist.std()\ \ \ \ \ \ \#\ the\ true\ value\ of\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(std\_true)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ 4.0}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ >>>\ std\_sample\ =\ np.std(data)\ \ \#\ the\ sample\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(std\_sample)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00436}00436\ \textcolor{stringliteral}{\ \ \ \ 3.9460644295563863}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00437}00437\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ The\ bootstrap\ is\ used\ to\ approximate\ the\ variability\ we\ would\ expect\ if\ we}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ were\ to\ repeatedly\ sample\ from\ the\ unknown\ distribution\ and\ calculate\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ statistic\ of\ the\ sample\ each\ time.\ It\ does\ this\ by\ repeatedly\ resampling}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ values\ *from\ the\ original\ sample*\ with\ replacement\ and\ calculating\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ statistic\ of\ each\ resample.\ This\ results\ in\ a\ "{}bootstrap\ distribution"{}\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00444}00444\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00446}00446\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ >>>\ data\ =\ (data,)\ \ \#\ samples\ must\ be\ in\ a\ sequence}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00448}00448\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ bootstrap(data,\ np.std,\ confidence\_level=0.9,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ ax\ =\ plt.subplots()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.hist(res.bootstrap\_distribution,\ bins=25)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_title('Bootstrap\ Distribution')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_xlabel('statistic\ value')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_ylabel('frequency')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00456}00456\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ The\ standard\ error\ quantifies\ this\ variability.\ It\ is\ calculated\ as\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ standard\ deviation\ of\ the\ bootstrap\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00459}00459\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ >>>\ res.standard\_error}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00461}00461\ \textcolor{stringliteral}{\ \ \ \ 0.24427002125829136}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ >>>\ res.standard\_error\ ==\ np.std(res.bootstrap\_distribution,\ ddof=1)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00464}00464\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00465}00465\ \textcolor{stringliteral}{\ \ \ \ The\ bootstrap\ distribution\ of\ the\ statistic\ is\ often\ approximately\ normal}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ with\ scale\ equal\ to\ the\ standard\ error.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00467}00467\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(3,\ 5)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ >>>\ pdf\ =\ norm.pdf(x,\ loc=std\_sample,\ scale=res.standard\_error)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00470}00470\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ ax\ =\ plt.subplots()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.hist(res.bootstrap\_distribution,\ bins=25,\ density=True)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.plot(x,\ pdf)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_title('Normal\ Approximation\ of\ the\ Bootstrap\ Distribution')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00474}00474\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_xlabel('statistic\ value')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_ylabel('pdf')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00477}00477\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00478}00478\ \textcolor{stringliteral}{\ \ \ \ This\ suggests\ that\ we\ could\ construct\ a\ 90\%\ confidence\ interval\ on\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00479}00479\ \textcolor{stringliteral}{\ \ \ \ statistic\ based\ on\ quantiles\ of\ this\ normal\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00480}00480\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ >>>\ norm.interval(0.9,\ loc=std\_sample,\ scale=res.standard\_error)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ (3.5442759991341726,\ 4.3478528599786)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00483}00483\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ Due\ to\ central\ limit\ theorem,\ this\ normal\ approximation\ is\ accurate\ for\ a}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ variety\ of\ statistics\ and\ distributions\ underlying\ the\ samples;\ however,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ the\ approximation\ is\ not\ reliable\ in\ all\ cases.\ Because\ \`{}bootstrap\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ designed\ to\ work\ with\ arbitrary\ underlying\ distributions\ and\ statistics,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ it\ uses\ more\ advanced\ techniques\ to\ generate\ an\ accurate\ confidence}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ interval.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00490}00490\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.confidence\_interval)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00492}00492\ \textcolor{stringliteral}{\ \ \ \ ConfidenceInterval(low=3.57655333533867,\ high=4.382043696342881)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00493}00493\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ If\ we\ sample\ from\ the\ original\ distribution\ 1000\ times\ and\ form\ a\ bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ confidence\ interval\ for\ each\ sample,\ the\ confidence\ interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ contains\ the\ true\ value\ of\ the\ statistic\ approximately\ 90\%\ of\ the\ time.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00497}00497\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ >>>\ n\_trials\ =\ 1000}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ >>>\ ci\_contains\_true\_std\ =\ 0}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00500}00500\ \textcolor{stringliteral}{\ \ \ \ >>>\ for\ i\ in\ range(n\_trials):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ data\ =\ (dist.rvs(size=100,\ random\_state=rng),)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ ci\ =\ bootstrap(data,\ np.std,\ confidence\_level=0.9,\ n\_resamples=1000,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=rng).confidence\_interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ if\ ci[0]\ <\ std\_true\ <\ ci[1]:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ ci\_contains\_true\_std\ +=\ 1}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(ci\_contains\_true\_std)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ 875}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00508}00508\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ Rather\ than\ writing\ a\ loop,\ we\ can\ also\ determine\ the\ confidence\ intervals}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ for\ all\ 1000\ samples\ at\ once.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00511}00511\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ >>>\ data\ =\ (dist.rvs(size=(n\_trials,\ 100),\ random\_state=rng),)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00513}00513\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ bootstrap(data,\ np.std,\ axis=-\/1,\ confidence\_level=0.9,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00514}00514\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples=1000,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00515}00515\ \textcolor{stringliteral}{\ \ \ \ >>>\ ci\_l,\ ci\_u\ =\ res.confidence\_interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00516}00516\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00517}00517\ \textcolor{stringliteral}{\ \ \ \ Here,\ \`{}ci\_l\`{}\ and\ \`{}ci\_u\`{}\ contain\ the\ confidence\ interval\ for\ each\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}n\_trials\ =\ 1000\`{}\`{}\ samples.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00519}00519\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00520}00520\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(ci\_l[995:])}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00521}00521\ \textcolor{stringliteral}{\ \ \ \ [3.77729695\ 3.75090233\ 3.45829131\ 3.34078217\ 3.48072829]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00522}00522\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(ci\_u[995:])}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ [4.88316666\ 4.86924034\ 4.32032996\ 4.2822427\ \ 4.59360598]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00524}00524\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ And\ again,\ approximately\ 90\%\ contain\ the\ true\ value,\ \`{}\`{}std\_true\ =\ 4\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00526}00526\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(np.sum((ci\_l\ <\ std\_true)\ \&\ (std\_true\ <\ ci\_u)))}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ 900}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00529}00529\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ \`{}bootstrap\`{}\ can\ also\ be\ used\ to\ estimate\ confidence\ intervals\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00531}00531\ \textcolor{stringliteral}{\ \ \ \ multi-\/sample\ statistics,\ including\ those\ calculated\ by\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ tests.\ \`{}scipy.stats.mood\`{}\ perform's\ Mood's\ test\ for\ equal\ scale\ parameters,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ and\ it\ returns\ two\ outputs:\ a\ statistic,\ and\ a\ p-\/value.\ To\ get\ a}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ confidence\ interval\ for\ the\ test\ statistic,\ we\ first\ wrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ \`{}scipy.stats.mood\`{}\ in\ a\ function\ that\ accepts\ two\ sample\ arguments,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00536}00536\ \textcolor{stringliteral}{\ \ \ \ accepts\ an\ \`{}axis\`{}\ keyword\ argument,\ and\ returns\ only\ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00537}00537\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ mood}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00539}00539\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ my\_statistic(sample1,\ sample2,\ axis):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00540}00540\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ statistic,\ \_\ =\ mood(sample1,\ sample2,\ axis=-\/1)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00541}00541\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00542}00542\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00543}00543\ \textcolor{stringliteral}{\ \ \ \ Here,\ we\ use\ the\ 'percentile'\ method\ with\ the\ default\ 95\%\ confidence\ level.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00544}00544\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00545}00545\ \textcolor{stringliteral}{\ \ \ \ >>>\ sample1\ =\ norm.rvs(scale=1,\ size=100,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00546}00546\ \textcolor{stringliteral}{\ \ \ \ >>>\ sample2\ =\ norm.rvs(scale=2,\ size=100,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00547}00547\ \textcolor{stringliteral}{\ \ \ \ >>>\ data\ =\ (sample1,\ sample2)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00548}00548\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ bootstrap(data,\ my\_statistic,\ method='basic',\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00549}00549\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(mood(sample1,\ sample2)[0])\ \ \#\ element\ 0\ is\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00550}00550\ \textcolor{stringliteral}{\ \ \ \ -\/5.521109549096542}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00551}00551\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.confidence\_interval)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00552}00552\ \textcolor{stringliteral}{\ \ \ \ ConfidenceInterval(low=-\/7.255994487314675,\ high=-\/4.016202624747605)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00553}00553\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00554}00554\ \textcolor{stringliteral}{\ \ \ \ The\ bootstrap\ estimate\ of\ the\ standard\ error\ is\ also\ available.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00555}00555\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00556}00556\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.standard\_error)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00557}00557\ \textcolor{stringliteral}{\ \ \ \ 0.8344963846318795}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00558}00558\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00559}00559\ \textcolor{stringliteral}{\ \ \ \ Paired-\/sample\ statistics\ work,\ too.\ For\ example,\ consider\ the\ Pearson}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ correlation\ coefficient.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00561}00561\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00562}00562\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ pearsonr}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00563}00563\ \textcolor{stringliteral}{\ \ \ \ >>>\ n\ =\ 100}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00564}00564\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(0,\ 10,\ n)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00565}00565\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ x\ +\ rng.uniform(size=n)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00566}00566\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(pearsonr(x,\ y)[0])\ \ \#\ element\ 0\ is\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00567}00567\ \textcolor{stringliteral}{\ \ \ \ 0.9962357936065914}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00568}00568\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00569}00569\ \textcolor{stringliteral}{\ \ \ \ We\ wrap\ \`{}pearsonr\`{}\ so\ that\ it\ returns\ only\ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00570}00570\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00571}00571\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ my\_statistic(x,\ y):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00572}00572\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ pearsonr(x,\ y)[0]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00573}00573\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00574}00574\ \textcolor{stringliteral}{\ \ \ \ We\ call\ \`{}bootstrap\`{}\ using\ \`{}\`{}paired=True\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00575}00575\ \textcolor{stringliteral}{\ \ \ \ Also,\ since\ \`{}\`{}my\_statistic\`{}\`{}\ isn't\ vectorized\ to\ calculate\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00576}00576\ \textcolor{stringliteral}{\ \ \ \ along\ a\ given\ axis,\ we\ pass\ in\ \`{}\`{}vectorized=False\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00577}00577\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00578}00578\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ bootstrap((x,\ y),\ my\_statistic,\ vectorized=False,\ paired=True,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00579}00579\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00580}00580\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.confidence\_interval)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00581}00581\ \textcolor{stringliteral}{\ \ \ \ ConfidenceInterval(low=0.9950085825848624,\ high=0.9971212407917498)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00582}00582\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00583}00583\ \textcolor{stringliteral}{\ \ \ \ The\ result\ object\ can\ be\ passed\ back\ into\ \`{}bootstrap\`{}\ to\ perform\ additional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00584}00584\ \textcolor{stringliteral}{\ \ \ \ resampling:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00585}00585\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00586}00586\ \textcolor{stringliteral}{\ \ \ \ >>>\ len(res.bootstrap\_distribution)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00587}00587\ \textcolor{stringliteral}{\ \ \ \ 9999}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00588}00588\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ bootstrap((x,\ y),\ my\_statistic,\ vectorized=False,\ paired=True,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00589}00589\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples=1001,\ random\_state=rng,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00590}00590\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bootstrap\_result=res)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00591}00591\ \textcolor{stringliteral}{\ \ \ \ >>>\ len(res.bootstrap\_distribution)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00592}00592\ \textcolor{stringliteral}{\ \ \ \ 11000}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00593}00593\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00594}00594\ \textcolor{stringliteral}{\ \ \ \ or\ to\ change\ the\ confidence\ interval\ options:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00595}00595\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00596}00596\ \textcolor{stringliteral}{\ \ \ \ >>>\ res2\ =\ bootstrap((x,\ y),\ my\_statistic,\ vectorized=False,\ paired=True,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00597}00597\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples=0,\ random\_state=rng,\ bootstrap\_result=res,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00598}00598\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method='percentile',\ confidence\_level=0.9)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00599}00599\ \textcolor{stringliteral}{\ \ \ \ >>>\ np.testing.assert\_equal(res2.bootstrap\_distribution,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00600}00600\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res.bootstrap\_distribution)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00601}00601\ \textcolor{stringliteral}{\ \ \ \ >>>\ res.confidence\_interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00602}00602\ \textcolor{stringliteral}{\ \ \ \ ConfidenceInterval(low=0.9950035351407804,\ high=0.9971170323404578)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00603}00603\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00604}00604\ \textcolor{stringliteral}{\ \ \ \ without\ repeating\ computation\ of\ the\ original\ bootstrap\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00605}00605\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00606}00606\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00607}00607\ \ \ \ \ \textcolor{comment}{\#\ Input\ validation}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00608}00608\ \ \ \ \ args\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ac8abcdc18ed960610af3403ad6fdf8ac}{\_bootstrap\_iv}}(data,\ statistic,\ vectorized,\ paired,\ axis,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ confidence\_level,\ alternative,\ n\_resamples,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method,\ bootstrap\_result,\ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00611}00611\ \ \ \ \ (data,\ statistic,\ vectorized,\ paired,\ axis,\ confidence\_level,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00612}00612\ \ \ \ \ \ alternative,\ n\_resamples,\ batch,\ method,\ bootstrap\_result,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00613}00613\ \ \ \ \ \ random\_state)\ =\ args}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00614}00614\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00615}00615\ \ \ \ \ theta\_hat\_b\ =\ ([]\ \textcolor{keywordflow}{if}\ bootstrap\_result\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ [bootstrap\_result.bootstrap\_distribution])}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00617}00617\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00618}00618\ \ \ \ \ batch\_nominal\ =\ batch\ \textcolor{keywordflow}{or}\ n\_resamples\ \textcolor{keywordflow}{or}\ 1}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00619}00619\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00620}00620\ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(0,\ n\_resamples,\ batch\_nominal):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ batch\_actual\ =\ min(batch\_nominal,\ n\_resamples-\/k)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ resamples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ resampled\_data\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ resample\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a92d4dbf131de119c12f6c988ff2f220c}{\_bootstrap\_resample}}(sample,\ n\_resamples=batch\_actual,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ \ \ \ \ resampled\_data.append(resample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00628}00628\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00629}00629\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ bootstrap\ distribution\ of\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ theta\_hat\_b.append(statistic(*resampled\_data,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00631}00631\ \ \ \ \ theta\_hat\_b\ =\ np.concatenate(theta\_hat\_b,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00632}00632\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00633}00633\ \ \ \ \ \textcolor{comment}{\#\ Calculate\ percentile\ interval}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00634}00634\ \ \ \ \ alpha\ =\ ((1\ -\/\ confidence\_level)/2\ \textcolor{keywordflow}{if}\ alternative\ ==\ \textcolor{stringliteral}{'two-\/sided'}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ (1\ -\/\ confidence\_level))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00636}00636\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ ==\ \textcolor{stringliteral}{'bca'}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ interval\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a2f04e1d5f070ff31f1343441e0d49b13}{\_bca\_interval}}(data,\ statistic,\ axis=-\/1,\ alpha=alpha,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00638}00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ theta\_hat\_b=theta\_hat\_b,\ batch=batch)[:2]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ percentile\_fun\ =\ \_percentile\_along\_axis}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00640}00640\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ interval\ =\ alpha,\ 1-\/alpha}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00642}00642\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00643}00643\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }percentile\_fun(a,\ q):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.percentile(a=a,\ q=q,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00645}00645\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00646}00646\ \ \ \ \ \textcolor{comment}{\#\ Calculate\ confidence\ interval\ of\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00647}00647\ \ \ \ \ ci\_l\ =\ percentile\_fun(theta\_hat\_b,\ interval[0]*100)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00648}00648\ \ \ \ \ ci\_u\ =\ percentile\_fun(theta\_hat\_b,\ interval[1]*100)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00649}00649\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ ==\ \textcolor{stringliteral}{'basic'}:\ \ \textcolor{comment}{\#\ see\ [3]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ theta\_hat\ =\ statistic(*data,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ ci\_l,\ ci\_u\ =\ 2*theta\_hat\ -\/\ ci\_u,\ 2*theta\_hat\ -\/\ ci\_l}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00652}00652\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00653}00653\ \ \ \ \ \textcolor{keywordflow}{if}\ alternative\ ==\ \textcolor{stringliteral}{'less'}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ ci\_l\ =\ np.full\_like(ci\_l,\ -\/np.inf)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00655}00655\ \ \ \ \ \textcolor{keywordflow}{elif}\ alternative\ ==\ \textcolor{stringliteral}{'greater'}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ ci\_u\ =\ np.full\_like(ci\_u,\ np.inf)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00657}00657\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00658}00658\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapResult}{BootstrapResult}}(confidence\_interval=ConfidenceInterval(ci\_l,\ ci\_u),}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bootstrap\_distribution=theta\_hat\_b,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ standard\_error=np.std(theta\_hat\_b,\ ddof=1,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00661}00661\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00662}00662\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00663}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0d199f6fb5c86b7de1da4cb6443c743e}{00663}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0d199f6fb5c86b7de1da4cb6443c743e}{\_monte\_carlo\_test\_iv}}(data,\ rvs,\ statistic,\ vectorized,\ n\_resamples,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch,\ alternative,\ axis):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00665}00665\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Input\ validation\ for\ \`{}monte\_carlo\_test\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00666}00666\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00667}00667\ \ \ \ \ axis\_int\ =\ int(axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00668}00668\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ !=\ axis\_int:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00669}00669\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}axis`\ must\ be\ an\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00670}00670\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00671}00671\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \{\textcolor{keyword}{True},\ \textcolor{keyword}{False},\ \textcolor{keywordtype}{None}\}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00672}00672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}vectorized`\ must\ be\ \`{}True`,\ \`{}False`,\ or\ \`{}None`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00673}00673\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00674}00674\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(rvs,\ Sequence):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00675}00675\ \ \ \ \ \ \ \ \ rvs\ =\ (rvs,)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00676}00676\ \ \ \ \ \ \ \ \ data\ =\ (data,)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00677}00677\ \ \ \ \ \textcolor{keywordflow}{for}\ rvs\_i\ \textcolor{keywordflow}{in}\ rvs:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00678}00678\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ callable(rvs\_i):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00679}00679\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}\`{}rvs`\ must\ be\ callable\ or\ sequence\ of\ callables."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00680}00680\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00681}00681\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ len(rvs)\ ==\ len(data):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}If\ \`{}rvs`\ is\ a\ sequence,\ \`{}len(rvs)`\ must\ equal\ \`{}len(data)`."{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00684}00684\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00685}00685\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ callable(statistic):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00686}00686\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}\`{}statistic`\ must\ be\ callable."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00687}00687\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00688}00688\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ vectorized\ =\ \textcolor{stringliteral}{'axis'}\ \textcolor{keywordflow}{in}\ inspect.signature(statistic).parameters}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00690}00690\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00691}00691\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ vectorized:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ statistic\_vectorized\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a1cbf31c18034ecab33c5c808b268dd86}{\_vectorize\_statistic}}(statistic)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00693}00693\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ statistic\_vectorized\ =\ statistic}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00695}00695\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00696}00696\ \ \ \ \ data\ =\ \_broadcast\_arrays(data,\ axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00697}00697\ \ \ \ \ data\_iv\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00698}00698\ \ \ \ \ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00699}00699\ \ \ \ \ \ \ \ \ sample\ =\ np.atleast\_1d(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00700}00700\ \ \ \ \ \ \ \ \ sample\ =\ np.moveaxis(sample,\ axis\_int,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00701}00701\ \ \ \ \ \ \ \ \ data\_iv.append(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00702}00702\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00703}00703\ \ \ \ \ n\_resamples\_int\ =\ int(n\_resamples)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00704}00704\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_resamples\ !=\ n\_resamples\_int\ \textcolor{keywordflow}{or}\ n\_resamples\_int\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00705}00705\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}n\_resamples`\ must\ be\ a\ positive\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00706}00706\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00707}00707\ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00708}00708\ \ \ \ \ \ \ \ \ batch\_iv\ =\ batch}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00709}00709\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00710}00710\ \ \ \ \ \ \ \ \ batch\_iv\ =\ int(batch)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00711}00711\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ !=\ batch\_iv\ \textcolor{keywordflow}{or}\ batch\_iv\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00712}00712\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}batch`\ must\ be\ a\ positive\ integer\ or\ None."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00713}00713\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00714}00714\ \ \ \ \ alternatives\ =\ \{\textcolor{stringliteral}{'two-\/sided'},\ \textcolor{stringliteral}{'greater'},\ \textcolor{stringliteral}{'less'}\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00715}00715\ \ \ \ \ alternative\ =\ alternative.lower()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00716}00716\ \ \ \ \ \textcolor{keywordflow}{if}\ alternative\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ alternatives:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00717}00717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\`{}alternative`\ must\ be\ in\ \{alternatives\}"{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00718}00718\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00719}00719\ \ \ \ \ \textcolor{keywordflow}{return}\ (data\_iv,\ rvs,\ statistic\_vectorized,\ vectorized,\ n\_resamples\_int,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00720}00720\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_iv,\ alternative,\ axis\_int)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00721}00721\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00722}00722\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00723}00723\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00724}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloTestResult}{00724}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloTestResult}{MonteCarloTestResult}}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00725}00725\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Result\ object\ returned\ by\ \`{}scipy.stats.monte\_carlo\_test\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00726}00726\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00727}00727\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00728}00728\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00729}00729\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00730}00730\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ observed\ test\ statistic\ of\ the\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00731}00731\ \textcolor{stringliteral}{\ \ \ \ pvalue\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00732}00732\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ p-\/value\ for\ the\ given\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00733}00733\ \textcolor{stringliteral}{\ \ \ \ null\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00734}00734\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ of\ the\ test\ statistic\ generated\ under\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00735}00735\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00736}00736\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00737}00737\ \ \ \ \ statistic:\ float\ |\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00738}00738\ \ \ \ \ pvalue:\ float\ |\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00739}00739\ \ \ \ \ null\_distribution:\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00740}00740\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00741}00741\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00742}00742\ \textcolor{preprocessor}{@\_rename\_parameter('sample',\ 'data')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00743}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a5486c49c316587dae5db7b43deef6ce9}{00743}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a5486c49c316587dae5db7b43deef6ce9}{monte\_carlo\_test}}(data,\ rvs,\ statistic,\ *,\ vectorized=None,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples=9999,\ batch=None,\ alternative="{}two-\/sided"{},}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00745}00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=0):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00746}00746\ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}Perform\ a\ Monte\ Carlo\ hypothesis\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00747}00747\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00748}00748\ \textcolor{stringliteral}{\ \ \ \ \`{}data\`{}\ contains\ a\ sample\ or\ a\ sequence\ of\ one\ or\ more\ samples.\ \`{}rvs\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00749}00749\ \textcolor{stringliteral}{\ \ \ \ specifies\ the\ distribution(s)\ of\ the\ sample(s)\ in\ \`{}data\`{}\ under\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00750}00750\ \textcolor{stringliteral}{\ \ \ \ hypothesis.\ The\ value\ of\ \`{}statistic\`{}\ for\ the\ given\ \`{}data\`{}\ is\ compared}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00751}00751\ \textcolor{stringliteral}{\ \ \ \ against\ a\ Monte\ Carlo\ null\ distribution:\ the\ value\ of\ the\ statistic\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00752}00752\ \textcolor{stringliteral}{\ \ \ \ each\ of\ \`{}n\_resamples\`{}\ sets\ of\ samples\ generated\ using\ \`{}rvs\`{}.\ This\ gives}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00753}00753\ \textcolor{stringliteral}{\ \ \ \ the\ p-\/value,\ the\ probability\ of\ observing\ such\ an\ extreme\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00754}00754\ \textcolor{stringliteral}{\ \ \ \ test\ statistic\ under\ the\ null\ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00755}00755\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00756}00756\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00757}00757\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00758}00758\ \textcolor{stringliteral}{\ \ \ \ data\ :\ array-\/like\ or\ sequence\ of\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00759}00759\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ array\ or\ sequence\ of\ arrays\ of\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00760}00760\ \textcolor{stringliteral}{\ \ \ \ rvs\ :\ callable\ or\ tuple\ of\ callables}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00761}00761\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ callable\ or\ sequence\ of\ callables\ that\ generates\ random\ variates}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00762}00762\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ under\ the\ null\ hypothesis.\ Each\ element\ of\ \`{}rvs\`{}\ must\ be\ a\ callable}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00763}00763\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ accepts\ keyword\ argument\ \`{}\`{}size\`{}\`{}\ (e.g.\ \`{}\`{}rvs(size=(m,\ n))\`{}\`{})\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00764}00764\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ returns\ an\ N-\/d\ array\ sample\ of\ that\ shape.\ If\ \`{}rvs\`{}\ is\ a\ sequence,\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00765}00765\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ of\ callables\ in\ \`{}rvs\`{}\ must\ match\ the\ number\ of\ samples\ in}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00766}00766\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}data\`{},\ i.e.\ \`{}\`{}len(rvs)\ ==\ len(data)\`{}\`{}.\ If\ \`{}rvs\`{}\ is\ a\ single\ callable,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00767}00767\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}data\`{}\ is\ treated\ as\ a\ single\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00768}00768\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00769}00769\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Statistic\ for\ which\ the\ p-\/value\ of\ the\ hypothesis\ test\ is\ to\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00770}00770\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculated.\ \`{}statistic\`{}\ must\ be\ a\ callable\ that\ accepts\ a\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00771}00771\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (e.g.\ \`{}\`{}statistic(sample)\`{}\`{})\ or\ \`{}\`{}len(rvs)\`{}\`{}\ separate\ samples\ (e.g.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00772}00772\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}statistic(samples1,\ sample2)\`{}\`{}\ if\ \`{}rvs\`{}\ contains\ two\ callables\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00773}00773\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}data\`{}\ contains\ two\ samples)\ and\ returns\ the\ resulting\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00774}00774\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}True\`{}\`{},\ \`{}statistic\`{}\ must\ also\ accept\ a\ keyword}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00775}00775\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ \`{}axis\`{}\ and\ be\ vectorized\ to\ compute\ the\ statistic\ along\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00776}00776\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ provided\ \`{}axis\`{}\ of\ the\ samples\ in\ \`{}data\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00777}00777\ \textcolor{stringliteral}{\ \ \ \ vectorized\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00778}00778\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}False\`{}\`{},\ \`{}statistic\`{}\ will\ not\ be\ passed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00779}00779\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ keyword\ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00780}00780\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ only\ for\ 1D\ samples.\ If\ \`{}\`{}True\`{}\`{},\ \`{}statistic\`{}\ will\ be\ passed\ keyword}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00781}00781\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic\ along\ \`{}axis\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00782}00782\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ when\ passed\ ND\ sample\ arrays.\ If\ \`{}\`{}None\`{}\`{}\ (default),\ \`{}vectorized\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00783}00783\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ be\ set\ \`{}\`{}True\`{}\`{}\ if\ \`{}\`{}axis\`{}\`{}\ is\ a\ parameter\ of\ \`{}statistic\`{}.\ Use\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00784}00784\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ vectorized\ statistic\ typically\ reduces\ computation\ time.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00785}00785\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int,\ default:\ 9999}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00786}00786\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ samples\ drawn\ from\ each\ of\ the\ callables\ of\ \`{}rvs\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00787}00787\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Equivalently,\ the\ number\ statistic\ values\ under\ the\ null\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00788}00788\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ used\ as\ the\ Monte\ Carlo\ null\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00789}00789\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00790}00790\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ Monte\ Carlo\ samples\ to\ process\ in\ each\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00791}00791\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}statistic\`{}.\ Memory\ usage\ is\ O(\`{}batch\`{}*\`{}\`{}sample.size[axis]\`{}\`{}).\ Default}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00792}00792\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ \`{}\`{}None\`{}\`{},\ in\ which\ case\ \`{}batch\`{}\ equals\ \`{}n\_resamples\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00793}00793\ \textcolor{stringliteral}{\ \ \ \ alternative\ :\ \{'two-\/sided',\ 'less',\ 'greater'\}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00794}00794\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ alternative\ hypothesis\ for\ which\ the\ p-\/value\ is\ calculated.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00795}00795\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ each\ alternative,\ the\ p-\/value\ is\ defined\ as\ follows.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00796}00796\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00797}00797\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'greater'\`{}\`{}\ :\ the\ percentage\ of\ the\ null\ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00798}00798\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ greater\ than\ or\ equal\ to\ the\ observed\ value\ of\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00799}00799\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'less'\`{}\`{}\ :\ the\ percentage\ of\ the\ null\ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00800}00800\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ less\ than\ or\ equal\ to\ the\ observed\ value\ of\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00801}00801\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'two-\/sided'\`{}\`{}\ :\ twice\ the\ smaller\ of\ the\ p-\/values\ above.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00802}00802\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00803}00803\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ default:\ 0}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00804}00804\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ axis\ of\ \`{}data\`{}\ (or\ each\ sample\ within\ \`{}data\`{})\ over\ which\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00805}00805\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculate\ the\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00806}00806\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00807}00807\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00808}00808\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00809}00809\ \textcolor{stringliteral}{\ \ \ \ res\ :\ MonteCarloTestResult}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00810}00810\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ object\ with\ attributes:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00811}00811\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00812}00812\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00813}00813\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ test\ statistic\ of\ the\ observed\ \`{}data\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00814}00814\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ pvalue\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00815}00815\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ p-\/value\ for\ the\ given\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00816}00816\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ null\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00817}00817\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ values\ of\ the\ test\ statistic\ generated\ under\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00818}00818\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00819}00819\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00820}00820\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00821}00821\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00822}00822\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00823}00823\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ B.\ Phipson\ and\ G.\ K.\ Smyth.\ "{}Permutation\ P-\/values\ Should\ Never\ Be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00824}00824\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Zero:\ Calculating\ Exact\ P-\/values\ When\ Permutations\ Are\ Randomly\ Drawn."{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00825}00825\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Statistical\ Applications\ in\ Genetics\ and\ Molecular\ Biology\ 9.1\ (2010).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00826}00826\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00827}00827\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00828}00828\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00829}00829\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00830}00830\ \textcolor{stringliteral}{\ \ \ \ Suppose\ we\ wish\ to\ test\ whether\ a\ small\ sample\ has\ been\ drawn\ from\ a\ normal}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00831}00831\ \textcolor{stringliteral}{\ \ \ \ distribution.\ We\ decide\ that\ we\ will\ use\ the\ skew\ of\ the\ sample\ as\ a}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00832}00832\ \textcolor{stringliteral}{\ \ \ \ test\ statistic,\ and\ we\ will\ consider\ a\ p-\/value\ of\ 0.05\ to\ be\ statistically}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00833}00833\ \textcolor{stringliteral}{\ \ \ \ significant.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00834}00834\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00835}00835\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00836}00836\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00837}00837\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ statistic(x,\ axis):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00838}00838\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ stats.skew(x,\ axis)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00839}00839\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00840}00840\ \textcolor{stringliteral}{\ \ \ \ After\ collecting\ our\ data,\ we\ calculate\ the\ observed\ value\ of\ the\ test}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00841}00841\ \textcolor{stringliteral}{\ \ \ \ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00842}00842\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00843}00843\ \textcolor{stringliteral}{\ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00844}00844\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ stats.skewnorm.rvs(a=1,\ size=50,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00845}00845\ \textcolor{stringliteral}{\ \ \ \ >>>\ statistic(x,\ axis=0)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00846}00846\ \textcolor{stringliteral}{\ \ \ \ 0.12457412450240658}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00847}00847\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00848}00848\ \textcolor{stringliteral}{\ \ \ \ To\ determine\ the\ probability\ of\ observing\ such\ an\ extreme\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00849}00849\ \textcolor{stringliteral}{\ \ \ \ skewness\ by\ chance\ if\ the\ sample\ were\ drawn\ from\ the\ normal\ distribution,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00850}00850\ \textcolor{stringliteral}{\ \ \ \ we\ can\ perform\ a\ Monte\ Carlo\ hypothesis\ test.\ The\ test\ will\ draw\ many}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00851}00851\ \textcolor{stringliteral}{\ \ \ \ samples\ at\ random\ from\ their\ normal\ distribution,\ calculate\ the\ skewness}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00852}00852\ \textcolor{stringliteral}{\ \ \ \ of\ each\ sample,\ and\ compare\ our\ original\ skewness\ against\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00853}00853\ \textcolor{stringliteral}{\ \ \ \ distribution\ to\ determine\ an\ approximate\ p-\/value.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00854}00854\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00855}00855\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ monte\_carlo\_test}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00856}00856\ \textcolor{stringliteral}{\ \ \ \ >>>\ \#\ because\ our\ statistic\ is\ vectorized,\ we\ pass\ \`{}vectorized=True\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00857}00857\ \textcolor{stringliteral}{\ \ \ \ >>>\ rvs\ =\ lambda\ size:\ stats.norm.rvs(size=size,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00858}00858\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ monte\_carlo\_test(x,\ rvs,\ statistic,\ vectorized=True)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00859}00859\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.statistic)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00860}00860\ \textcolor{stringliteral}{\ \ \ \ 0.12457412450240658}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00861}00861\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.pvalue)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00862}00862\ \textcolor{stringliteral}{\ \ \ \ 0.7012}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00863}00863\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00864}00864\ \textcolor{stringliteral}{\ \ \ \ The\ probability\ of\ obtaining\ a\ test\ statistic\ less\ than\ or\ equal\ to\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00865}00865\ \textcolor{stringliteral}{\ \ \ \ observed\ value\ under\ the\ null\ hypothesis\ is\ \string~70\%.\ This\ is\ greater\ than}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00866}00866\ \textcolor{stringliteral}{\ \ \ \ our\ chosen\ threshold\ of\ 5\%,\ so\ we\ cannot\ consider\ this\ to\ be\ significant}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00867}00867\ \textcolor{stringliteral}{\ \ \ \ evidence\ against\ the\ null\ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00868}00868\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00869}00869\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ this\ p-\/value\ essentially\ matches\ that\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00870}00870\ \textcolor{stringliteral}{\ \ \ \ \`{}scipy.stats.skewtest\`{},\ which\ relies\ on\ an\ asymptotic\ distribution\ of\ a}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00871}00871\ \textcolor{stringliteral}{\ \ \ \ test\ statistic\ based\ on\ the\ sample\ skewness.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00872}00872\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00873}00873\ \textcolor{stringliteral}{\ \ \ \ >>>\ stats.skewtest(x).pvalue}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00874}00874\ \textcolor{stringliteral}{\ \ \ \ 0.6892046027110614}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00875}00875\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00876}00876\ \textcolor{stringliteral}{\ \ \ \ This\ asymptotic\ approximation\ is\ not\ valid\ for\ small\ sample\ sizes,\ but}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00877}00877\ \textcolor{stringliteral}{\ \ \ \ \`{}monte\_carlo\_test\`{}\ can\ be\ used\ with\ samples\ of\ any\ size.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00878}00878\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00879}00879\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ stats.skewnorm.rvs(a=1,\ size=7,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00880}00880\ \textcolor{stringliteral}{\ \ \ \ >>>\ \#\ stats.skewtest(x)\ would\ produce\ an\ error\ due\ to\ small\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00881}00881\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ monte\_carlo\_test(x,\ rvs,\ statistic,\ vectorized=True)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00882}00882\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00883}00883\ \textcolor{stringliteral}{\ \ \ \ The\ Monte\ Carlo\ distribution\ of\ the\ test\ statistic\ is\ provided\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00884}00884\ \textcolor{stringliteral}{\ \ \ \ further\ investigation.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00885}00885\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00886}00886\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00887}00887\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ ax\ =\ plt.subplots()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00888}00888\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.hist(res.null\_distribution,\ bins=50)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00889}00889\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_title("{}Monte\ Carlo\ distribution\ of\ test\ statistic"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00890}00890\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_xlabel("{}Value\ of\ Statistic"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00891}00891\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax.set\_ylabel("{}Frequency"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00892}00892\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00893}00893\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00894}00894\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00895}00895\ \ \ \ \ args\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0d199f6fb5c86b7de1da4cb6443c743e}{\_monte\_carlo\_test\_iv}}(data,\ rvs,\ statistic,\ vectorized,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00896}00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples,\ batch,\ alternative,\ axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00897}00897\ \ \ \ \ (data,\ rvs,\ statistic,\ vectorized,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00898}00898\ \ \ \ \ \ n\_resamples,\ batch,\ alternative,\ axis)\ =\ args}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00899}00899\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00900}00900\ \ \ \ \ \textcolor{comment}{\#\ Some\ statistics\ return\ plain\ floats;\ ensure\ they're\ at\ least\ np.float64}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00901}00901\ \ \ \ \ observed\ =\ np.asarray(statistic(*data,\ axis=-\/1))[()]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00902}00902\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00903}00903\ \ \ \ \ n\_observations\ =\ [sample.shape[-\/1]\ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00904}00904\ \ \ \ \ batch\_nominal\ =\ batch\ \textcolor{keywordflow}{or}\ n\_resamples}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00905}00905\ \ \ \ \ null\_distribution\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00906}00906\ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(0,\ n\_resamples,\ batch\_nominal):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00907}00907\ \ \ \ \ \ \ \ \ batch\_actual\ =\ min(batch\_nominal,\ n\_resamples\ -\/\ k)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00908}00908\ \ \ \ \ \ \ \ \ resamples\ =\ [rvs\_i(size=(batch\_actual,\ n\_observations\_i))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00909}00909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ rvs\_i,\ n\_observations\_i\ \textcolor{keywordflow}{in}\ zip(rvs,\ n\_observations)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00910}00910\ \ \ \ \ \ \ \ \ null\_distribution.append(statistic(*resamples,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00911}00911\ \ \ \ \ null\_distribution\ =\ np.concatenate(null\_distribution)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00912}00912\ \ \ \ \ null\_distribution\ =\ null\_distribution.reshape([-\/1]\ +\ [1]*observed.ndim)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00913}00913\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00914}00914\ \ \ \ \ \textcolor{keyword}{def\ }less(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00915}00915\ \ \ \ \ \ \ \ \ cmps\ =\ null\_distribution\ <=\ observed}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00916}00916\ \ \ \ \ \ \ \ \ pvalues\ =\ (cmps.sum(axis=0)\ +\ 1)\ /\ (n\_resamples\ +\ 1)\ \ \textcolor{comment}{\#\ see\ [1]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00917}00917\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00918}00918\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00919}00919\ \ \ \ \ \textcolor{keyword}{def\ }greater(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00920}00920\ \ \ \ \ \ \ \ \ cmps\ =\ null\_distribution\ >=\ observed}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00921}00921\ \ \ \ \ \ \ \ \ pvalues\ =\ (cmps.sum(axis=0)\ +\ 1)\ /\ (n\_resamples\ +\ 1)\ \ \textcolor{comment}{\#\ see\ [1]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00922}00922\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00923}00923\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00924}00924\ \ \ \ \ \textcolor{keyword}{def\ }two\_sided(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00925}00925\ \ \ \ \ \ \ \ \ pvalues\_less\ =\ less(null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00926}00926\ \ \ \ \ \ \ \ \ pvalues\_greater\ =\ greater(null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00927}00927\ \ \ \ \ \ \ \ \ pvalues\ =\ np.minimum(pvalues\_less,\ pvalues\_greater)\ *\ 2}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00928}00928\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00929}00929\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00930}00930\ \ \ \ \ compare\ =\ \{\textcolor{stringliteral}{"{}less"{}}:\ less,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00931}00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}greater"{}}:\ greater,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00932}00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}two-\/sided"{}}:\ two\_sided\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00933}00933\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00934}00934\ \ \ \ \ pvalues\ =\ compare[alternative](null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00935}00935\ \ \ \ \ pvalues\ =\ np.clip(pvalues,\ 0,\ 1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00936}00936\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00937}00937\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloTestResult}{MonteCarloTestResult}}(observed,\ pvalues,\ null\_distribution)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00938}00938\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00939}00939\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00940}00940\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00941}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationTestResult}{00941}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationTestResult}{PermutationTestResult}}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00942}00942\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Result\ object\ returned\ by\ \`{}scipy.stats.permutation\_test\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00943}00943\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00944}00944\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00945}00945\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00946}00946\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00947}00947\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ observed\ test\ statistic\ of\ the\ data.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00948}00948\ \textcolor{stringliteral}{\ \ \ \ pvalue\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00949}00949\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ p-\/value\ for\ the\ given\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00950}00950\ \textcolor{stringliteral}{\ \ \ \ null\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00951}00951\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ of\ the\ test\ statistic\ generated\ under\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00952}00952\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00953}00953\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00954}00954\ \ \ \ \ statistic:\ float\ |\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00955}00955\ \ \ \ \ pvalue:\ float\ |\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00956}00956\ \ \ \ \ null\_distribution:\ np.ndarray}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00957}00957\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00958}00958\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00959}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0e31d9de95afc8cc40db53ed7f4cfddd}{00959}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0e31d9de95afc8cc40db53ed7f4cfddd}{\_all\_partitions\_concatenated}}(ns):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00960}00960\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00961}00961\ \textcolor{stringliteral}{\ \ \ \ Generate\ all\ partitions\ of\ indices\ of\ groups\ of\ given\ sizes,\ concatenated}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00962}00962\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00963}00963\ \textcolor{stringliteral}{\ \ \ \ \`{}ns\`{}\ is\ an\ iterable\ of\ ints.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00964}00964\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00965}00965\ \ \ \ \ \textcolor{keyword}{def\ }all\_partitions(z,\ n):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00966}00966\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ combinations(z,\ n):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00967}00967\ \ \ \ \ \ \ \ \ \ \ \ \ x0\ =\ set(c)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00968}00968\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ z\ -\/\ x0}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00969}00969\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ [x0,\ x1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00970}00970\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00971}00971\ \ \ \ \ \textcolor{keyword}{def\ }all\_partitions\_n(z,\ ns):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00972}00972\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(ns)\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00973}00973\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ [z]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00974}00974\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00975}00975\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ c\ \textcolor{keywordflow}{in}\ all\_partitions(z,\ ns[0]):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00976}00976\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ d\ \textcolor{keywordflow}{in}\ all\_partitions\_n(c[1],\ ns[1:]):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00977}00977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ c[0:1]\ +\ d}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00978}00978\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00979}00979\ \ \ \ \ z\ =\ set(range(np.sum(ns)))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00980}00980\ \ \ \ \ \textcolor{keywordflow}{for}\ partitioning\ \textcolor{keywordflow}{in}\ all\_partitions\_n(z,\ ns[:]):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00981}00981\ \ \ \ \ \ \ \ \ x\ =\ np.concatenate([list(partition)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00982}00982\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ partition\ \textcolor{keywordflow}{in}\ partitioning]).astype(int)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00983}00983\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ x}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00984}00984\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00985}00985\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00986}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ab2c3fbfa8434bb273175aafd84fd9eb3}{00986}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ab2c3fbfa8434bb273175aafd84fd9eb3}{\_batch\_generator}}(iterable,\ batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00987}00987\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}A\ generator\ that\ yields\ batches\ of\ elements\ from\ an\ iterable"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00988}00988\ \ \ \ \ iterator\ =\ iter(iterable)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00989}00989\ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00990}00990\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}batch`\ must\ be\ positive."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00991}00991\ \ \ \ \ z\ =\ [item\ \textcolor{keywordflow}{for}\ i,\ item\ \textcolor{keywordflow}{in}\ zip(range(batch),\ iterator)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00992}00992\ \ \ \ \ \textcolor{keywordflow}{while}\ z:\ \ \textcolor{comment}{\#\ we\ don't\ want\ StopIteration\ without\ yielding\ an\ empty\ list}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00993}00993\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ z}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00994}00994\ \ \ \ \ \ \ \ \ z\ =\ [item\ \textcolor{keywordflow}{for}\ i,\ item\ \textcolor{keywordflow}{in}\ zip(range(batch),\ iterator)]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00995}00995\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00996}00996\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00997}00997\ \textcolor{keyword}{def\ }\_pairings\_permutations\_gen(n\_permutations,\ n\_samples,\ n\_obs\_sample,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00998}00998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l00999}00999\ \ \ \ \ \textcolor{comment}{\#\ Returns\ a\ generator\ that\ yields\ arrays\ of\ size}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01000}01000\ \ \ \ \ \textcolor{comment}{\#\ \`{}(batch,\ n\_samples,\ n\_obs\_sample)`.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01001}01001\ \ \ \ \ \textcolor{comment}{\#\ Each\ row\ is\ an\ independent\ permutation\ of\ indices\ 0\ to\ \`{}n\_obs\_sample`.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01002}01002\ \ \ \ \ batch\ =\ min(batch,\ n\_permutations)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01003}01003\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01004}01004\ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(random\_state,\ \textcolor{stringliteral}{'permuted'}):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01005}01005\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }batched\_perm\_generator():}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01006}01006\ \ \ \ \ \ \ \ \ \ \ \ \ indices\ =\ np.arange(n\_obs\_sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01007}01007\ \ \ \ \ \ \ \ \ \ \ \ \ indices\ =\ np.tile(indices,\ (batch,\ n\_samples,\ 1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01008}01008\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(0,\ n\_permutations,\ batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01009}01009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch\_actual\ =\ min(batch,\ n\_permutations-\/k)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01010}01010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ permute\ in\ place,\ otherwise\ results\ depend\ on\ \`{}batch`}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01011}01011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ permuted\_indices\ =\ random\_state.permuted(indices,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01012}01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ permuted\_indices[:batch\_actual]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01013}01013\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ RandomState\ and\ early\ Generators\ don't\ have\ \`{}permuted`}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01014}01014\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }batched\_perm\_generator():}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01015}01015\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(0,\ n\_permutations,\ batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01016}01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch\_actual\ =\ min(batch,\ n\_permutations-\/k)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01017}01017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\ =\ (batch\_actual,\ n\_samples,\ n\_obs\_sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01018}01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ random\_state.random(size=size)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01019}01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ np.argsort(x,\ axis=-\/1)[:batch\_actual]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01020}01020\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01021}01021\ \ \ \ \ \textcolor{keywordflow}{return}\ batched\_perm\_generator()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01022}01022\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01023}01023\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01024}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_abce466a2e498006d6c0c57bfde7b7ce7}{01024}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_abce466a2e498006d6c0c57bfde7b7ce7}{\_calculate\_null\_both}}(data,\ statistic,\ n\_permutations,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01025}01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01026}01026\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01027}01027\ \textcolor{stringliteral}{\ \ \ \ Calculate\ null\ distribution\ for\ independent\ sample\ tests.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01028}01028\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01029}01029\ \ \ \ \ n\_samples\ =\ len(data)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01030}01030\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01031}01031\ \ \ \ \ \textcolor{comment}{\#\ compute\ number\ of\ permutations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01032}01032\ \ \ \ \ \textcolor{comment}{\#\ (distinct\ partitions\ of\ data\ into\ samples\ of\ these\ sizes)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01033}01033\ \ \ \ \ n\_obs\_i\ =\ [sample.shape[-\/1]\ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data]\ \ \textcolor{comment}{\#\ observations\ per\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01034}01034\ \ \ \ \ n\_obs\_ic\ =\ np.cumsum(n\_obs\_i)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01035}01035\ \ \ \ \ n\_obs\ =\ n\_obs\_ic[-\/1]\ \ \textcolor{comment}{\#\ total\ number\ of\ observations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01036}01036\ \ \ \ \ n\_max\ =\ np.prod([comb(n\_obs\_ic[i],\ n\_obs\_ic[i-\/1])}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01037}01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_samples-\/1,\ 0,\ -\/1)])}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01038}01038\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01039}01039\ \ \ \ \ \textcolor{comment}{\#\ perm\_generator\ is\ an\ iterator\ that\ produces\ permutations\ of\ indices}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01040}01040\ \ \ \ \ \textcolor{comment}{\#\ from\ 0\ to\ n\_obs.\ We'll\ concatenate\ the\ samples,\ use\ these\ indices\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01041}01041\ \ \ \ \ \textcolor{comment}{\#\ permute\ the\ data,\ then\ split\ the\ samples\ apart\ again.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01042}01042\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_permutations\ >=\ n\_max:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01043}01043\ \ \ \ \ \ \ \ \ exact\_test\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01044}01044\ \ \ \ \ \ \ \ \ n\_permutations\ =\ n\_max}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01045}01045\ \ \ \ \ \ \ \ \ perm\_generator\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a0e31d9de95afc8cc40db53ed7f4cfddd}{\_all\_partitions\_concatenated}}(n\_obs\_i)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01046}01046\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01047}01047\ \ \ \ \ \ \ \ \ exact\_test\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01048}01048\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Neither\ RandomState.permutation\ nor\ Generator.permutation}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01049}01049\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ can\ permute\ axis-\/slices\ independently.\ If\ this\ feature\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01050}01050\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ added\ in\ the\ future,\ batches\ of\ the\ desired\ size\ should\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01051}01051\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ generated\ in\ a\ single\ call.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01052}01052\ \ \ \ \ \ \ \ \ perm\_generator\ =\ (random\_state.permutation(n\_obs)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01053}01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_permutations))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01054}01054\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01055}01055\ \ \ \ \ batch\ =\ batch\ \textcolor{keywordflow}{or}\ int(n\_permutations)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01056}01056\ \ \ \ \ null\_distribution\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01057}01057\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01058}01058\ \ \ \ \ \textcolor{comment}{\#\ First,\ concatenate\ all\ the\ samples.\ In\ batches,\ permute\ samples\ with}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01059}01059\ \ \ \ \ \textcolor{comment}{\#\ indices\ produced\ by\ the\ \`{}perm\_generator`,\ split\ them\ into\ new\ samples\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01060}01060\ \ \ \ \ \textcolor{comment}{\#\ the\ original\ sizes,\ compute\ the\ statistic\ for\ each\ batch,\ and\ add\ these}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01061}01061\ \ \ \ \ \textcolor{comment}{\#\ statistic\ values\ to\ the\ null\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01062}01062\ \ \ \ \ data\ =\ np.concatenate(data,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01063}01063\ \ \ \ \ \textcolor{keywordflow}{for}\ indices\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ab2c3fbfa8434bb273175aafd84fd9eb3}{\_batch\_generator}}(perm\_generator,\ batch=batch):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01064}01064\ \ \ \ \ \ \ \ \ indices\ =\ np.array(indices)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01065}01065\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01066}01066\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}indices`\ is\ 2D:\ each\ row\ is\ a\ permutation\ of\ the\ indices.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01067}01067\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ use\ it\ to\ index\ \`{}data`\ along\ its\ last\ axis,\ which\ corresponds}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01068}01068\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01069}01069\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ After\ indexing,\ the\ second\ to\ last\ axis\ of\ \`{}data\_batch`\ corresponds}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01070}01070\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ permutations,\ and\ the\ last\ axis\ corresponds\ with\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01071}01071\ \ \ \ \ \ \ \ \ data\_batch\ =\ data[...,\ indices]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01072}01072\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01073}01073\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Move\ the\ permutation\ axis\ to\ the\ front:\ we'll\ concatenate\ a\ list}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01074}01074\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ batched\ statistic\ values\ along\ this\ zeroth\ axis\ to\ form\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01075}01075\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ null\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01076}01076\ \ \ \ \ \ \ \ \ data\_batch\ =\ np.moveaxis(data\_batch,\ -\/2,\ 0)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01077}01077\ \ \ \ \ \ \ \ \ data\_batch\ =\ np.split(data\_batch,\ n\_obs\_ic[:-\/1],\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01078}01078\ \ \ \ \ \ \ \ \ null\_distribution.append(statistic(*data\_batch,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01079}01079\ \ \ \ \ null\_distribution\ =\ np.concatenate(null\_distribution,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01080}01080\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01081}01081\ \ \ \ \ \textcolor{keywordflow}{return}\ null\_distribution,\ n\_permutations,\ exact\_test}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01082}01082\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01083}01083\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01084}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a164b747bb35a0a8fc563729ec8e72e5d}{01084}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a164b747bb35a0a8fc563729ec8e72e5d}{\_calculate\_null\_pairings}}(data,\ statistic,\ n\_permutations,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01085}01085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01086}01086\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01087}01087\ \textcolor{stringliteral}{\ \ \ \ Calculate\ null\ distribution\ for\ association\ tests.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01088}01088\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01089}01089\ \ \ \ \ n\_samples\ =\ len(data)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01090}01090\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01091}01091\ \ \ \ \ \textcolor{comment}{\#\ compute\ number\ of\ permutations\ (factorial(n)\ permutations\ of\ each\ sample)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01092}01092\ \ \ \ \ n\_obs\_sample\ =\ data[0].shape[-\/1]\ \ \textcolor{comment}{\#\ observations\ per\ sample;\ same\ for\ each}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01093}01093\ \ \ \ \ n\_max\ =\ factorial(n\_obs\_sample)**n\_samples}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01094}01094\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01095}01095\ \ \ \ \ \textcolor{comment}{\#\ \`{}perm\_generator`\ is\ an\ iterator\ that\ produces\ a\ list\ of\ permutations\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01096}01096\ \ \ \ \ \textcolor{comment}{\#\ indices\ from\ 0\ to\ n\_obs\_sample,\ one\ for\ each\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01097}01097\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_permutations\ >=\ n\_max:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01098}01098\ \ \ \ \ \ \ \ \ exact\_test\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01099}01099\ \ \ \ \ \ \ \ \ n\_permutations\ =\ n\_max}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01100}01100\ \ \ \ \ \ \ \ \ batch\ =\ batch\ \textcolor{keywordflow}{or}\ int(n\_permutations)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01101}01101\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cartesian\ product\ of\ the\ sets\ of\ all\ permutations\ of\ indices}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01102}01102\ \ \ \ \ \ \ \ \ perm\_generator\ =\ product(*(permutations(range(n\_obs\_sample))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01103}01103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_samples)))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01104}01104\ \ \ \ \ \ \ \ \ batched\_perm\_generator\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_ab2c3fbfa8434bb273175aafd84fd9eb3}{\_batch\_generator}}(perm\_generator,\ batch=batch)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01105}01105\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01106}01106\ \ \ \ \ \ \ \ \ exact\_test\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01107}01107\ \ \ \ \ \ \ \ \ batch\ =\ batch\ \textcolor{keywordflow}{or}\ int(n\_permutations)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01108}01108\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Separate\ random\ permutations\ of\ indices\ for\ each\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01109}01109\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Again,\ it\ would\ be\ nice\ if\ RandomState/Generator.permutation}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01110}01110\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ could\ permute\ each\ axis-\/slice\ separately.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01111}01111\ \ \ \ \ \ \ \ \ args\ =\ n\_permutations,\ n\_samples,\ n\_obs\_sample,\ batch,\ random\_state}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01112}01112\ \ \ \ \ \ \ \ \ batched\_perm\_generator\ =\ \_pairings\_permutations\_gen(*args)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01113}01113\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01114}01114\ \ \ \ \ null\_distribution\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01115}01115\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01116}01116\ \ \ \ \ \textcolor{keywordflow}{for}\ indices\ \textcolor{keywordflow}{in}\ batched\_perm\_generator:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01117}01117\ \ \ \ \ \ \ \ \ indices\ =\ np.array(indices)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01118}01118\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01119}01119\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}indices`\ is\ 3D:\ the\ zeroth\ axis\ is\ for\ permutations,\ the\ next\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01120}01120\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ samples,\ and\ the\ last\ is\ for\ observations.\ Swap\ the\ first\ two}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01121}01121\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ make\ the\ zeroth\ axis\ correspond\ with\ samples,\ as\ it\ does\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01122}01122\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}data`.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01123}01123\ \ \ \ \ \ \ \ \ indices\ =\ np.swapaxes(indices,\ 0,\ 1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01124}01124\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01125}01125\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ When\ we're\ done,\ \`{}data\_batch`\ will\ be\ a\ list\ of\ length\ \`{}n\_samples`.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01126}01126\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Each\ element\ will\ be\ a\ batch\ of\ random\ permutations\ of\ one\ sample.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01127}01127\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ zeroth\ axis\ of\ each\ batch\ will\ correspond\ with\ permutations,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01128}01128\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ the\ last\ will\ correspond\ with\ observations.\ (This\ makes\ it}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01129}01129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ easy\ to\ pass\ into\ \`{}statistic`.)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01130}01130\ \ \ \ \ \ \ \ \ data\_batch\ =\ [\textcolor{keywordtype}{None}]*n\_samples}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01131}01131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_samples):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01132}01132\ \ \ \ \ \ \ \ \ \ \ \ \ data\_batch[i]\ =\ data[i][...,\ indices[i]]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01133}01133\ \ \ \ \ \ \ \ \ \ \ \ \ data\_batch[i]\ =\ np.moveaxis(data\_batch[i],\ -\/2,\ 0)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01134}01134\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01135}01135\ \ \ \ \ \ \ \ \ null\_distribution.append(statistic(*data\_batch,\ axis=-\/1))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01136}01136\ \ \ \ \ null\_distribution\ =\ np.concatenate(null\_distribution,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01137}01137\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01138}01138\ \ \ \ \ \textcolor{keywordflow}{return}\ null\_distribution,\ n\_permutations,\ exact\_test}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01139}01139\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01140}01140\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01141}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a281bd931b030ac46a8df78e1ae2ce06c}{01141}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a281bd931b030ac46a8df78e1ae2ce06c}{\_calculate\_null\_samples}}(data,\ statistic,\ n\_permutations,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01142}01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01143}01143\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01144}01144\ \textcolor{stringliteral}{\ \ \ \ Calculate\ null\ distribution\ for\ paired-\/sample\ tests.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01145}01145\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01146}01146\ \ \ \ \ n\_samples\ =\ len(data)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01147}01147\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01148}01148\ \ \ \ \ \textcolor{comment}{\#\ By\ convention,\ the\ meaning\ of\ the\ "{}samples"{}\ permutations\ type\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01149}01149\ \ \ \ \ \textcolor{comment}{\#\ data\ with\ only\ one\ sample\ is\ to\ flip\ the\ sign\ of\ the\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01150}01150\ \ \ \ \ \textcolor{comment}{\#\ Achieve\ this\ by\ adding\ a\ second\ sample\ -\/\ the\ negative\ of\ the\ original.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01151}01151\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_samples\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01152}01152\ \ \ \ \ \ \ \ \ data\ =\ [data[0],\ -\/data[0]]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01153}01153\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01154}01154\ \ \ \ \ \textcolor{comment}{\#\ The\ "{}samples"{}\ permutation\ strategy\ is\ the\ same\ as\ the\ "{}pairings"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01155}01155\ \ \ \ \ \textcolor{comment}{\#\ strategy\ except\ the\ roles\ of\ samples\ and\ observations\ are\ flipped.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01156}01156\ \ \ \ \ \textcolor{comment}{\#\ So\ swap\ these\ axes,\ then\ we'll\ use\ the\ function\ for\ the\ "{}pairings"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01157}01157\ \ \ \ \ \textcolor{comment}{\#\ strategy\ to\ do\ all\ the\ work!}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01158}01158\ \ \ \ \ data\ =\ np.swapaxes(data,\ 0,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01159}01159\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01160}01160\ \ \ \ \ \textcolor{comment}{\#\ (Of\ course,\ the\ user's\ statistic\ doesn't\ know\ what\ we've\ done\ here,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01161}01161\ \ \ \ \ \textcolor{comment}{\#\ so\ we\ need\ to\ pass\ it\ what\ it's\ expecting.)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01162}01162\ \ \ \ \ \textcolor{keyword}{def\ }statistic\_wrapped(*data,\ axis):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01163}01163\ \ \ \ \ \ \ \ \ data\ =\ np.swapaxes(data,\ 0,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01164}01164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\_samples\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01165}01165\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ data[0:1]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01166}01166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ statistic(*data,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01167}01167\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01168}01168\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a164b747bb35a0a8fc563729ec8e72e5d}{\_calculate\_null\_pairings}}(data,\ statistic\_wrapped,\ n\_permutations,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01169}01169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch,\ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01170}01170\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01171}01171\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01172}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_aaa7528e2c981d6bb79547bdb33da599a}{01172}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_aaa7528e2c981d6bb79547bdb33da599a}{\_permutation\_test\_iv}}(data,\ statistic,\ permutation\_type,\ vectorized,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01173}01173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples,\ batch,\ alternative,\ axis,\ random\_state):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01174}01174\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Input\ validation\ for\ \`{}permutation\_test\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01175}01175\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01176}01176\ \ \ \ \ axis\_int\ =\ int(axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01177}01177\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ !=\ axis\_int:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01178}01178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}axis`\ must\ be\ an\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01179}01179\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01180}01180\ \ \ \ \ permutation\_types\ =\ \{\textcolor{stringliteral}{'samples'},\ \textcolor{stringliteral}{'pairings'},\ \textcolor{stringliteral}{'independent'}\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01181}01181\ \ \ \ \ permutation\_type\ =\ permutation\_type.lower()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01182}01182\ \ \ \ \ \textcolor{keywordflow}{if}\ permutation\_type\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ permutation\_types:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01183}01183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\`{}permutation\_type`\ must\ be\ in\ \{permutation\_types\}."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01184}01184\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01185}01185\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \{\textcolor{keyword}{True},\ \textcolor{keyword}{False},\ \textcolor{keywordtype}{None}\}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01186}01186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}vectorized`\ must\ be\ \`{}True`,\ \`{}False`,\ or\ \`{}None`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01187}01187\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01188}01188\ \ \ \ \ \textcolor{keywordflow}{if}\ vectorized\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01189}01189\ \ \ \ \ \ \ \ \ vectorized\ =\ \textcolor{stringliteral}{'axis'}\ \textcolor{keywordflow}{in}\ inspect.signature(statistic).parameters}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01190}01190\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01191}01191\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ vectorized:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01192}01192\ \ \ \ \ \ \ \ \ statistic\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a1cbf31c18034ecab33c5c808b268dd86}{\_vectorize\_statistic}}(statistic)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01193}01193\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01194}01194\ \ \ \ \ message\ =\ \textcolor{stringliteral}{"{}\`{}data`\ must\ be\ a\ tuple\ containing\ at\ least\ two\ samples"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01195}01195\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01196}01196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(data)\ <\ 2\ \textcolor{keywordflow}{and}\ permutation\_type\ ==\ \textcolor{stringliteral}{'independent'}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01197}01197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01198}01198\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01199}01199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(message)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01200}01200\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01201}01201\ \ \ \ \ data\ =\ \_broadcast\_arrays(data,\ axis)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01202}01202\ \ \ \ \ data\_iv\ =\ []}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01203}01203\ \ \ \ \ \textcolor{keywordflow}{for}\ sample\ \textcolor{keywordflow}{in}\ data:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01204}01204\ \ \ \ \ \ \ \ \ sample\ =\ np.atleast\_1d(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01205}01205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sample.shape[axis]\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01206}01206\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}each\ sample\ in\ \`{}data`\ must\ contain\ two\ or\ more\ "{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01207}01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}observations\ along\ \`{}axis`."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01208}01208\ \ \ \ \ \ \ \ \ sample\ =\ np.moveaxis(sample,\ axis\_int,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01209}01209\ \ \ \ \ \ \ \ \ data\_iv.append(sample)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01210}01210\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01211}01211\ \ \ \ \ n\_resamples\_int\ =\ (int(n\_resamples)\ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.isinf(n\_resamples)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01212}01212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ np.inf)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01213}01213\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_resamples\ !=\ n\_resamples\_int\ \textcolor{keywordflow}{or}\ n\_resamples\_int\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01214}01214\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}n\_resamples`\ must\ be\ a\ positive\ integer."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01215}01215\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01216}01216\ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01217}01217\ \ \ \ \ \ \ \ \ batch\_iv\ =\ batch}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01218}01218\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01219}01219\ \ \ \ \ \ \ \ \ batch\_iv\ =\ int(batch)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01220}01220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ batch\ !=\ batch\_iv\ \textcolor{keywordflow}{or}\ batch\_iv\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01221}01221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}batch`\ must\ be\ a\ positive\ integer\ or\ None."{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01222}01222\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01223}01223\ \ \ \ \ alternatives\ =\ \{\textcolor{stringliteral}{'two-\/sided'},\ \textcolor{stringliteral}{'greater'},\ \textcolor{stringliteral}{'less'}\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01224}01224\ \ \ \ \ alternative\ =\ alternative.lower()}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01225}01225\ \ \ \ \ \textcolor{keywordflow}{if}\ alternative\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ alternatives:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01226}01226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}\`{}alternative`\ must\ be\ in\ \{alternatives\}"{}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01227}01227\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01228}01228\ \ \ \ \ random\_state\ =\ check\_random\_state(random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01229}01229\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01230}01230\ \ \ \ \ \textcolor{keywordflow}{return}\ (data\_iv,\ statistic,\ permutation\_type,\ vectorized,\ n\_resamples\_int,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01231}01231\ \ \ \ \ \ \ \ \ \ \ \ \ batch\_iv,\ alternative,\ axis\_int,\ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01232}01232\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01233}01233\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01234}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a2121e61e3b44b91dd340f938469b5b38}{01234}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_a2121e61e3b44b91dd340f938469b5b38}{permutation\_test}}(data,\ statistic,\ *,\ permutation\_type='independent',}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01235}01235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vectorized=None,\ n\_resamples=9999,\ batch=None,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01236}01236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative="{}two-\/sided"{},\ axis=0,\ random\_state=None):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01237}01237\ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01238}01238\ \textcolor{stringliteral}{\ \ \ \ Performs\ a\ permutation\ test\ of\ a\ given\ statistic\ on\ provided\ data.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01239}01239\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01240}01240\ \textcolor{stringliteral}{\ \ \ \ For\ independent\ sample\ statistics,\ the\ null\ hypothesis\ is\ that\ the\ data\ are}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01241}01241\ \textcolor{stringliteral}{\ \ \ \ randomly\ sampled\ from\ the\ same\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01242}01242\ \textcolor{stringliteral}{\ \ \ \ For\ paired\ sample\ statistics,\ two\ null\ hypothesis\ can\ be\ tested:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01243}01243\ \textcolor{stringliteral}{\ \ \ \ that\ the\ data\ are\ paired\ at\ random\ or\ that\ the\ data\ are\ assigned\ to\ samples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01244}01244\ \textcolor{stringliteral}{\ \ \ \ at\ random.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01245}01245\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01246}01246\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01247}01247\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01248}01248\ \textcolor{stringliteral}{\ \ \ \ data\ :\ iterable\ of\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01249}01249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Contains\ the\ samples,\ each\ of\ which\ is\ an\ array\ of\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01250}01250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Dimensions\ of\ sample\ arrays\ must\ be\ compatible\ for\ broadcasting\ except}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01251}01251\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ along\ \`{}axis\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01252}01252\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01253}01253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Statistic\ for\ which\ the\ p-\/value\ of\ the\ hypothesis\ test\ is\ to\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01254}01254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculated.\ \`{}statistic\`{}\ must\ be\ a\ callable\ that\ accepts\ samples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01255}01255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ separate\ arguments\ (e.g.\ \`{}\`{}statistic(*data)\`{}\`{})\ and\ returns\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01256}01256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ resulting\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01257}01257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}True\`{}\`{},\ \`{}statistic\`{}\ must\ also\ accept\ a\ keyword}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01258}01258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ \`{}axis\`{}\ and\ be\ vectorized\ to\ compute\ the\ statistic\ along\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01259}01259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ provided\ \`{}axis\`{}\ of\ the\ sample\ arrays.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01260}01260\ \textcolor{stringliteral}{\ \ \ \ permutation\_type\ :\ \{'independent',\ 'samples',\ 'pairings'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01261}01261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ type\ of\ permutations\ to\ be\ performed,\ in\ accordance\ with\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01262}01262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ null\ hypothesis.\ The\ first\ two\ permutation\ types\ are\ for\ paired\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01263}01263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistics,\ in\ which\ all\ samples\ contain\ the\ same\ number\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01264}01264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ observations\ and\ observations\ with\ corresponding\ indices\ along\ \`{}axis\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01265}01265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ are\ considered\ to\ be\ paired;\ the\ third\ is\ for\ independent\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01266}01266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistics.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01267}01267\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01268}01268\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'samples'\`{}\`{}\ :\ observations\ are\ assigned\ to\ different\ samples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01269}01269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ but\ remain\ paired\ with\ the\ same\ observations\ from\ other\ samples.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01270}01270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ This\ permutation\ type\ is\ appropriate\ for\ paired\ sample\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01271}01271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ tests\ such\ as\ the\ Wilcoxon\ signed-\/rank\ test\ and\ the\ paired\ t-\/test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01272}01272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'pairings'\`{}\`{}\ :\ observations\ are\ paired\ with\ different\ observations,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01273}01273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ but\ they\ remain\ within\ the\ same\ sample.\ This\ permutation\ type\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01274}01274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ appropriate\ for\ association/correlation\ tests\ with\ statistics\ such}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01275}01275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ as\ Spearman's\ :math:\`{}\(\backslash\)rho\`{},\ Kendall's\ :math:\`{}\(\backslash\)tau\`{},\ and\ Pearson's}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01276}01276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ :math:\`{}r\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01277}01277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'independent'\`{}\`{}\ (default)\ :\ observations\ are\ assigned\ to\ different}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01278}01278\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ samples.\ Samples\ may\ contain\ different\ numbers\ of\ observations.\ This}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01279}01279\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ permutation\ type\ is\ appropriate\ for\ independent\ sample\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01280}01280\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ tests\ such\ as\ the\ Mann-\/Whitney\ :math:\`{}U\`{}\ test\ and\ the\ independent}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01281}01281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ sample\ t-\/test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01282}01282\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01283}01283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ Please\ see\ the\ Notes\ section\ below\ for\ more\ detailed\ descriptions}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01284}01284\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ of\ the\ permutation\ types.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01285}01285\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01286}01286\ \textcolor{stringliteral}{\ \ \ \ vectorized\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01287}01287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}vectorized\`{}\ is\ set\ \`{}\`{}False\`{}\`{},\ \`{}statistic\`{}\ will\ not\ be\ passed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01288}01288\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ keyword\ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01289}01289\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ only\ for\ 1D\ samples.\ If\ \`{}\`{}True\`{}\`{},\ \`{}statistic\`{}\ will\ be\ passed\ keyword}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01290}01290\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ \`{}axis\`{}\ and\ is\ expected\ to\ calculate\ the\ statistic\ along\ \`{}axis\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01291}01291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ when\ passed\ an\ ND\ sample\ array.\ If\ \`{}\`{}None\`{}\`{}\ (default),\ \`{}vectorized\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01292}01292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ be\ set\ \`{}\`{}True\`{}\`{}\ if\ \`{}\`{}axis\`{}\`{}\ is\ a\ parameter\ of\ \`{}statistic\`{}.\ Use}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01293}01293\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ a\ vectorized\ statistic\ typically\ reduces\ computation\ time.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01294}01294\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int\ or\ np.inf,\ default:\ 9999}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01295}01295\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ random\ permutations\ (resamples)\ used\ to\ approximate\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01296}01296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distribution.\ If\ greater\ than\ or\ equal\ to\ the\ number\ of\ distinct}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01297}01297\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ permutations,\ the\ exact\ null\ distribution\ will\ be\ computed.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01298}01298\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Note\ that\ the\ number\ of\ distinct\ permutations\ grows\ very\ rapidly\ with}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01299}01299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ sizes\ of\ samples,\ so\ exact\ tests\ are\ feasible\ only\ for\ very\ small}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01300}01300\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ sets.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01301}01301\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01302}01302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ permutations\ to\ process\ in\ each\ call\ to\ \`{}statistic\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01303}01303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Memory\ usage\ is\ O(\`{}batch\`{}*\`{}\`{}n\`{}\`{}),\ where\ \`{}\`{}n\`{}\`{}\ is\ the\ total\ size}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01304}01304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ all\ samples,\ regardless\ of\ the\ value\ of\ \`{}vectorized\`{}.\ Default\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01305}01305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}None\`{}\`{},\ in\ which\ case\ \`{}\`{}batch\`{}\`{}\ is\ the\ number\ of\ permutations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01306}01306\ \textcolor{stringliteral}{\ \ \ \ alternative\ :\ \{'two-\/sided',\ 'less',\ 'greater'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01307}01307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ alternative\ hypothesis\ for\ which\ the\ p-\/value\ is\ calculated.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01308}01308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ each\ alternative,\ the\ p-\/value\ is\ defined\ for\ exact\ tests\ as}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01309}01309\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ follows.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01310}01310\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01311}01311\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'greater'\`{}\`{}\ :\ the\ percentage\ of\ the\ null\ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01312}01312\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ greater\ than\ or\ equal\ to\ the\ observed\ value\ of\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01313}01313\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'less'\`{}\`{}\ :\ the\ percentage\ of\ the\ null\ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01314}01314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ less\ than\ or\ equal\ to\ the\ observed\ value\ of\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01315}01315\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}\`{}'two-\/sided'\`{}\`{}\ (default)\ :\ twice\ the\ smaller\ of\ the\ p-\/values\ above.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01316}01316\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01317}01317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Note\ that\ p-\/values\ for\ randomized\ tests\ are\ calculated\ according\ to\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01318}01318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ conservative\ (over-\/estimated)\ approximation\ suggested\ in\ [2]\_\ and\ [3]\_}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01319}01319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ rather\ than\ the\ unbiased\ estimator\ suggested\ in\ [4]\_.\ That\ is,\ when}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01320}01320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculating\ the\ proportion\ of\ the\ randomized\ null\ distribution\ that\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01321}01321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ extreme\ as\ the\ observed\ value\ of\ the\ test\ statistic,\ the\ values\ in}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01322}01322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ numerator\ and\ denominator\ are\ both\ increased\ by\ one.\ An}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01323}01323\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ interpretation\ of\ this\ adjustment\ is\ that\ the\ observed\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01324}01324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ test\ statistic\ is\ always\ included\ as\ an\ element\ of\ the\ randomized}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01325}01325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ null\ distribution.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01326}01326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ convention\ used\ for\ two-\/sided\ p-\/values\ is\ not\ universal;}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01327}01327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ observed\ test\ statistic\ and\ null\ distribution\ are\ returned\ in}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01328}01328\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ case\ a\ different\ definition\ is\ preferred.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01329}01329\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01330}01330\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ default:\ 0}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01331}01331\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ axis\ of\ the\ (broadcasted)\ samples\ over\ which\ to\ calculate\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01332}01332\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic.\ If\ samples\ have\ a\ different\ number\ of\ dimensions,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01333}01333\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ singleton\ dimensions\ are\ prepended\ to\ samples\ with\ fewer\ dimensions}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01334}01334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ before\ \`{}axis\`{}\ is\ considered.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01335}01335\ \textcolor{stringliteral}{\ \ \ \ random\_state\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01336}01336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01337}01337\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01338}01338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Pseudorandom\ number\ generator\ state\ used\ to\ generate\ permutations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01339}01339\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01340}01340\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ \`{}\`{}None\`{}\`{}\ (default),\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01341}01341\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01342}01342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01343}01343\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}random\_state\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01344}01344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01345}01345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ instance\ then\ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01346}01346\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01347}01347\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01348}01348\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01349}01349\ \textcolor{stringliteral}{\ \ \ \ res\ :\ PermutationTestResult}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01350}01350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ object\ with\ attributes:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01351}01351\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01352}01352\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01353}01353\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ observed\ test\ statistic\ of\ the\ data.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01354}01354\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ pvalue\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01355}01355\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ p-\/value\ for\ the\ given\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01356}01356\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ null\_distribution\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01357}01357\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ values\ of\ the\ test\ statistic\ generated\ under\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01358}01358\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01359}01359\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01360}01360\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01361}01361\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01362}01362\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01363}01363\ \textcolor{stringliteral}{\ \ \ \ The\ three\ types\ of\ permutation\ tests\ supported\ by\ this\ function\ are}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01364}01364\ \textcolor{stringliteral}{\ \ \ \ described\ below.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01365}01365\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01366}01366\ \textcolor{stringliteral}{\ \ \ \ **Unpaired\ statistics**\ (\`{}\`{}permutation\_type='independent'\`{}\`{}):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01367}01367\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01368}01368\ \textcolor{stringliteral}{\ \ \ \ The\ null\ hypothesis\ associated\ with\ this\ permutation\ type\ is\ that\ all}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01369}01369\ \textcolor{stringliteral}{\ \ \ \ observations\ are\ sampled\ from\ the\ same\ underlying\ distribution\ and\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01370}01370\ \textcolor{stringliteral}{\ \ \ \ they\ have\ been\ assigned\ to\ one\ of\ the\ samples\ at\ random.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01371}01371\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01372}01372\ \textcolor{stringliteral}{\ \ \ \ Suppose\ \`{}\`{}data\`{}\`{}\ contains\ two\ samples;\ e.g.\ \`{}\`{}a,\ b\ =\ data\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01373}01373\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}1\ <\ n\_resamples\ <\ binom(n,\ k)\`{}\`{},\ where}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01374}01374\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01375}01375\ \textcolor{stringliteral}{\ \ \ \ *\ \`{}\`{}k\`{}\`{}\ is\ the\ number\ of\ observations\ in\ \`{}\`{}a\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01376}01376\ \textcolor{stringliteral}{\ \ \ \ *\ \`{}\`{}n\`{}\`{}\ is\ the\ total\ number\ of\ observations\ in\ \`{}\`{}a\`{}\`{}\ and\ \`{}\`{}b\`{}\`{},\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01377}01377\ \textcolor{stringliteral}{\ \ \ \ *\ \`{}\`{}binom(n,\ k)\`{}\`{}\ is\ the\ binomial\ coefficient\ (\`{}\`{}n\`{}\`{}\ choose\ \`{}\`{}k\`{}\`{}),}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01378}01378\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01379}01379\ \textcolor{stringliteral}{\ \ \ \ the\ data\ are\ pooled\ (concatenated),\ randomly\ assigned\ to\ either\ the\ first}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01380}01380\ \textcolor{stringliteral}{\ \ \ \ or\ second\ sample,\ and\ the\ statistic\ is\ calculated.\ This\ process\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01381}01381\ \textcolor{stringliteral}{\ \ \ \ performed\ repeatedly,\ \`{}permutation\`{}\ times,\ generating\ a\ distribution\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01382}01382\ \textcolor{stringliteral}{\ \ \ \ statistic\ under\ the\ null\ hypothesis.\ The\ statistic\ of\ the\ original}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01383}01383\ \textcolor{stringliteral}{\ \ \ \ data\ is\ compared\ to\ this\ distribution\ to\ determine\ the\ p-\/value.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01384}01384\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01385}01385\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}n\_resamples\ >=\ binom(n,\ k)\`{}\`{},\ an\ exact\ test\ is\ performed:\ the\ data}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01386}01386\ \textcolor{stringliteral}{\ \ \ \ are\ *partitioned*\ between\ the\ samples\ in\ each\ distinct\ way\ exactly\ once,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01387}01387\ \textcolor{stringliteral}{\ \ \ \ and\ the\ exact\ null\ distribution\ is\ formed.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01388}01388\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ for\ a\ given\ partitioning\ of\ the\ data\ between\ the\ samples,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01389}01389\ \textcolor{stringliteral}{\ \ \ \ only\ one\ ordering/permutation\ of\ the\ data\ *within*\ each\ sample\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01390}01390\ \textcolor{stringliteral}{\ \ \ \ considered.\ For\ statistics\ that\ do\ not\ depend\ on\ the\ order\ of\ the\ data}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01391}01391\ \textcolor{stringliteral}{\ \ \ \ within\ samples,\ this\ dramatically\ reduces\ computational\ cost\ without}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01392}01392\ \textcolor{stringliteral}{\ \ \ \ affecting\ the\ shape\ of\ the\ null\ distribution\ (because\ the\ frequency/count}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01393}01393\ \textcolor{stringliteral}{\ \ \ \ of\ each\ value\ is\ affected\ by\ the\ same\ factor).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01394}01394\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01395}01395\ \textcolor{stringliteral}{\ \ \ \ For\ \`{}\`{}a\ =\ [a1,\ a2,\ a3,\ a4]\`{}\`{}\ and\ \`{}\`{}b\ =\ [b1,\ b2,\ b3]\`{}\`{},\ an\ example\ of\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01396}01396\ \textcolor{stringliteral}{\ \ \ \ permutation\ type\ is\ \`{}\`{}x\ =\ [b3,\ a1,\ a2,\ b2]\`{}\`{}\ and\ \`{}\`{}y\ =\ [a4,\ b1,\ a3]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01397}01397\ \textcolor{stringliteral}{\ \ \ \ Because\ only\ one\ ordering/permutation\ of\ the\ data\ *within*\ each\ sample}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01398}01398\ \textcolor{stringliteral}{\ \ \ \ is\ considered\ in\ an\ exact\ test,\ a\ resampling\ like\ \`{}\`{}x\ =\ [b3,\ a1,\ b2,\ a2]\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01399}01399\ \textcolor{stringliteral}{\ \ \ \ and\ \`{}\`{}y\ =\ [a4,\ a3,\ b1]\`{}\`{}\ would\ *not*\ be\ considered\ distinct\ from\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01400}01400\ \textcolor{stringliteral}{\ \ \ \ example\ above.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01401}01401\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01402}01402\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}permutation\_type='independent'\`{}\`{}\ does\ not\ support\ one-\/sample\ statistics,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01403}01403\ \textcolor{stringliteral}{\ \ \ \ but\ it\ can\ be\ applied\ to\ statistics\ with\ more\ than\ two\ samples.\ In\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01404}01404\ \textcolor{stringliteral}{\ \ \ \ case,\ if\ \`{}\`{}n\`{}\`{}\ is\ an\ array\ of\ the\ number\ of\ observations\ within\ each}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01405}01405\ \textcolor{stringliteral}{\ \ \ \ sample,\ the\ number\ of\ distinct\ partitions\ is::}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01406}01406\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01407}01407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ np.prod([binom(sum(n[i:]),\ sum(n[i+1:]))\ for\ i\ in\ range(len(n)-\/1)])}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01408}01408\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01409}01409\ \textcolor{stringliteral}{\ \ \ \ **Paired\ statistics,\ permute\ pairings**\ (\`{}\`{}permutation\_type='pairings'\`{}\`{}):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01410}01410\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01411}01411\ \textcolor{stringliteral}{\ \ \ \ The\ null\ hypothesis\ associated\ with\ this\ permutation\ type\ is\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01412}01412\ \textcolor{stringliteral}{\ \ \ \ observations\ within\ each\ sample\ are\ drawn\ from\ the\ same\ underlying}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01413}01413\ \textcolor{stringliteral}{\ \ \ \ distribution\ and\ that\ pairings\ with\ elements\ of\ other\ samples\ are}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01414}01414\ \textcolor{stringliteral}{\ \ \ \ assigned\ at\ random.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01415}01415\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01416}01416\ \textcolor{stringliteral}{\ \ \ \ Suppose\ \`{}\`{}data\`{}\`{}\ contains\ only\ one\ sample;\ e.g.\ \`{}\`{}a,\ =\ data\`{}\`{},\ and\ we}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01417}01417\ \textcolor{stringliteral}{\ \ \ \ wish\ to\ consider\ all\ possible\ pairings\ of\ elements\ of\ \`{}\`{}a\`{}\`{}\ with\ elements}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01418}01418\ \textcolor{stringliteral}{\ \ \ \ of\ a\ second\ sample,\ \`{}\`{}b\`{}\`{}.\ Let\ \`{}\`{}n\`{}\`{}\ be\ the\ number\ of\ observations\ in}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01419}01419\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}a\`{}\`{},\ which\ must\ also\ equal\ the\ number\ of\ observations\ in\ \`{}\`{}b\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01420}01420\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01421}01421\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}1\ <\ n\_resamples\ <\ factorial(n)\`{}\`{},\ the\ elements\ of\ \`{}\`{}a\`{}\`{}\ are}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01422}01422\ \textcolor{stringliteral}{\ \ \ \ randomly\ permuted.\ The\ user-\/supplied\ statistic\ accepts\ one\ data\ argument,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01423}01423\ \textcolor{stringliteral}{\ \ \ \ say\ \`{}\`{}a\_perm\`{}\`{},\ and\ calculates\ the\ statistic\ considering\ \`{}\`{}a\_perm\`{}\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01424}01424\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}b\`{}\`{}.\ This\ process\ is\ performed\ repeatedly,\ \`{}permutation\`{}\ times,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01425}01425\ \textcolor{stringliteral}{\ \ \ \ generating\ a\ distribution\ of\ the\ statistic\ under\ the\ null\ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01426}01426\ \textcolor{stringliteral}{\ \ \ \ The\ statistic\ of\ the\ original\ data\ is\ compared\ to\ this\ distribution\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01427}01427\ \textcolor{stringliteral}{\ \ \ \ determine\ the\ p-\/value.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01428}01428\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01429}01429\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}n\_resamples\ >=\ factorial(n)\`{}\`{},\ an\ exact\ test\ is\ performed:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01430}01430\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}a\`{}\`{}\ is\ permuted\ in\ each\ distinct\ way\ exactly\ once.\ Therefore,\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01431}01431\ \textcolor{stringliteral}{\ \ \ \ \`{}statistic\`{}\ is\ computed\ for\ each\ unique\ pairing\ of\ samples\ between\ \`{}\`{}a\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01432}01432\ \textcolor{stringliteral}{\ \ \ \ and\ \`{}\`{}b\`{}\`{}\ exactly\ once.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01433}01433\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01434}01434\ \textcolor{stringliteral}{\ \ \ \ For\ \`{}\`{}a\ =\ [a1,\ a2,\ a3]\`{}\`{}\ and\ \`{}\`{}b\ =\ [b1,\ b2,\ b3]\`{}\`{},\ an\ example\ of\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01435}01435\ \textcolor{stringliteral}{\ \ \ \ permutation\ type\ is\ \`{}\`{}a\_perm\ =\ [a3,\ a1,\ a2]\`{}\`{}\ while\ \`{}\`{}b\`{}\`{}\ is\ left}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01436}01436\ \textcolor{stringliteral}{\ \ \ \ in\ its\ original\ order.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01437}01437\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01438}01438\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}permutation\_type='pairings'\`{}\`{}\ supports\ \`{}\`{}data\`{}\`{}\ containing\ any\ number}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01439}01439\ \textcolor{stringliteral}{\ \ \ \ of\ samples,\ each\ of\ which\ must\ contain\ the\ same\ number\ of\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01440}01440\ \textcolor{stringliteral}{\ \ \ \ All\ samples\ provided\ in\ \`{}\`{}data\`{}\`{}\ are\ permuted\ *independently*.\ Therefore,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01441}01441\ \textcolor{stringliteral}{\ \ \ \ if\ \`{}\`{}m\`{}\`{}\ is\ the\ number\ of\ samples\ and\ \`{}\`{}n\`{}\`{}\ is\ the\ number\ of\ observations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01442}01442\ \textcolor{stringliteral}{\ \ \ \ within\ each\ sample,\ then\ the\ number\ of\ permutations\ in\ an\ exact\ test\ is::}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01443}01443\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01444}01444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ factorial(n)**m}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01445}01445\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01446}01446\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ if\ a\ two-\/sample\ statistic,\ for\ example,\ does\ not\ inherently}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01447}01447\ \textcolor{stringliteral}{\ \ \ \ depend\ on\ the\ order\ in\ which\ observations\ are\ provided\ -\/\ only\ on\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01448}01448\ \textcolor{stringliteral}{\ \ \ \ *pairings*\ of\ observations\ -\/\ then\ only\ one\ of\ the\ two\ samples\ should\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01449}01449\ \textcolor{stringliteral}{\ \ \ \ provided\ in\ \`{}\`{}data\`{}\`{}.\ This\ dramatically\ reduces\ computational\ cost\ without}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01450}01450\ \textcolor{stringliteral}{\ \ \ \ affecting\ the\ shape\ of\ the\ null\ distribution\ (because\ the\ frequency/count}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01451}01451\ \textcolor{stringliteral}{\ \ \ \ of\ each\ value\ is\ affected\ by\ the\ same\ factor).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01452}01452\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01453}01453\ \textcolor{stringliteral}{\ \ \ \ **Paired\ statistics,\ permute\ samples**\ (\`{}\`{}permutation\_type='samples'\`{}\`{}):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01454}01454\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01455}01455\ \textcolor{stringliteral}{\ \ \ \ The\ null\ hypothesis\ associated\ with\ this\ permutation\ type\ is\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01456}01456\ \textcolor{stringliteral}{\ \ \ \ observations\ within\ each\ pair\ are\ drawn\ from\ the\ same\ underlying}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01457}01457\ \textcolor{stringliteral}{\ \ \ \ distribution\ and\ that\ the\ sample\ to\ which\ they\ are\ assigned\ is\ random.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01458}01458\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01459}01459\ \textcolor{stringliteral}{\ \ \ \ Suppose\ \`{}\`{}data\`{}\`{}\ contains\ two\ samples;\ e.g.\ \`{}\`{}a,\ b\ =\ data\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01460}01460\ \textcolor{stringliteral}{\ \ \ \ Let\ \`{}\`{}n\`{}\`{}\ be\ the\ number\ of\ observations\ in\ \`{}\`{}a\`{}\`{},\ which\ must\ also\ equal}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01461}01461\ \textcolor{stringliteral}{\ \ \ \ the\ number\ of\ observations\ in\ \`{}\`{}b\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01462}01462\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01463}01463\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}1\ <\ n\_resamples\ <\ 2**n\`{}\`{},\ the\ elements\ of\ \`{}\`{}a\`{}\`{}\ are\ \`{}\`{}b\`{}\`{}\ are}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01464}01464\ \textcolor{stringliteral}{\ \ \ \ randomly\ swapped\ between\ samples\ (maintaining\ their\ pairings)\ and\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01465}01465\ \textcolor{stringliteral}{\ \ \ \ statistic\ is\ calculated.\ This\ process\ is\ performed\ repeatedly,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01466}01466\ \textcolor{stringliteral}{\ \ \ \ \`{}permutation\`{}\ times,\ \ generating\ a\ distribution\ of\ the\ statistic\ under\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01467}01467\ \textcolor{stringliteral}{\ \ \ \ null\ hypothesis.\ The\ statistic\ of\ the\ original\ data\ is\ compared\ to\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01468}01468\ \textcolor{stringliteral}{\ \ \ \ distribution\ to\ determine\ the\ p-\/value.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01469}01469\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01470}01470\ \textcolor{stringliteral}{\ \ \ \ When\ \`{}\`{}n\_resamples\ >=\ 2**n\`{}\`{},\ an\ exact\ test\ is\ performed:\ the\ observations}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01471}01471\ \textcolor{stringliteral}{\ \ \ \ are\ assigned\ to\ the\ two\ samples\ in\ each\ distinct\ way\ (while\ maintaining}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01472}01472\ \textcolor{stringliteral}{\ \ \ \ pairings)\ exactly\ once.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01473}01473\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01474}01474\ \textcolor{stringliteral}{\ \ \ \ For\ \`{}\`{}a\ =\ [a1,\ a2,\ a3]\`{}\`{}\ and\ \`{}\`{}b\ =\ [b1,\ b2,\ b3]\`{}\`{},\ an\ example\ of\ this}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01475}01475\ \textcolor{stringliteral}{\ \ \ \ permutation\ type\ is\ \`{}\`{}x\ =\ [b1,\ a2,\ b3]\`{}\`{}\ and\ \`{}\`{}y\ =\ [a1,\ b2,\ a3]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01476}01476\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01477}01477\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}permutation\_type='samples'\`{}\`{}\ supports\ \`{}\`{}data\`{}\`{}\ containing\ any\ number}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01478}01478\ \textcolor{stringliteral}{\ \ \ \ of\ samples,\ each\ of\ which\ must\ contain\ the\ same\ number\ of\ observations.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01479}01479\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}\`{}data\`{}\`{}\ contains\ more\ than\ one\ sample,\ paired\ observations\ within}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01480}01480\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}data\`{}\`{}\ are\ exchanged\ between\ samples\ *independently*.\ Therefore,\ if\ \`{}\`{}m\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01481}01481\ \textcolor{stringliteral}{\ \ \ \ is\ the\ number\ of\ samples\ and\ \`{}\`{}n\`{}\`{}\ is\ the\ number\ of\ observations\ within}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01482}01482\ \textcolor{stringliteral}{\ \ \ \ each\ sample,\ then\ the\ number\ of\ permutations\ in\ an\ exact\ test\ is::}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01483}01483\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01484}01484\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ factorial(m)**n}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01485}01485\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01486}01486\ \textcolor{stringliteral}{\ \ \ \ Several\ paired-\/sample\ statistical\ tests,\ such\ as\ the\ Wilcoxon\ signed\ rank}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01487}01487\ \textcolor{stringliteral}{\ \ \ \ test\ and\ paired-\/sample\ t-\/test,\ can\ be\ performed\ considering\ only\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01488}01488\ \textcolor{stringliteral}{\ \ \ \ *difference*\ between\ two\ paired\ elements.\ Accordingly,\ if\ \`{}\`{}data\`{}\`{}\ contains}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01489}01489\ \textcolor{stringliteral}{\ \ \ \ only\ one\ sample,\ then\ the\ null\ distribution\ is\ formed\ by\ independently}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01490}01490\ \textcolor{stringliteral}{\ \ \ \ changing\ the\ *sign*\ of\ each\ observation.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01491}01491\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01492}01492\ \textcolor{stringliteral}{\ \ \ \ ..\ warning::}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01493}01493\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ p-\/value\ is\ calculated\ by\ counting\ the\ elements\ of\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01494}01494\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distribution\ that\ are\ as\ extreme\ or\ more\ extreme\ than\ the\ observed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01495}01495\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ value\ of\ the\ statistic.\ Due\ to\ the\ use\ of\ finite\ precision\ arithmetic,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01496}01496\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ some\ statistic\ functions\ return\ numerically\ distinct\ values\ when\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01497}01497\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ theoretical\ values\ would\ be\ exactly\ equal.\ In\ some\ cases,\ this\ could}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01498}01498\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ lead\ to\ a\ large\ error\ in\ the\ calculated\ p-\/value.\ \`{}permutation\_test\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01499}01499\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ guards\ against\ this\ by\ considering\ elements\ in\ the\ null\ distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01500}01500\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ are\ "{}close"{}\ (within\ a\ factor\ of\ \`{}\`{}1+1e-\/14\`{}\`{})\ to\ the\ observed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01501}01501\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ value\ of\ the\ test\ statistic\ as\ equal\ to\ the\ observed\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01502}01502\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ test\ statistic.\ However,\ the\ user\ is\ advised\ to\ inspect\ the\ null}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01503}01503\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distribution\ to\ assess\ whether\ this\ method\ of\ comparison\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01504}01504\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ appropriate,\ and\ if\ not,\ calculate\ the\ p-\/value\ manually.\ See\ example}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01505}01505\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ below.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01506}01506\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01507}01507\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01508}01508\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01509}01509\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01510}01510\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ R.\ A.\ Fisher.\ The\ Design\ of\ Experiments,\ 6th\ Ed\ (1951).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01511}01511\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ B.\ Phipson\ and\ G.\ K.\ Smyth.\ "{}Permutation\ P-\/values\ Should\ Never\ Be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01512}01512\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Zero:\ Calculating\ Exact\ P-\/values\ When\ Permutations\ Are\ Randomly\ Drawn."{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01513}01513\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Statistical\ Applications\ in\ Genetics\ and\ Molecular\ Biology\ 9.1\ (2010).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01514}01514\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ M.\ D.\ Ernst.\ "{}Permutation\ Methods:\ A\ Basis\ for\ Exact\ Inference"{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01515}01515\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Statistical\ Science\ (2004).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01516}01516\ \textcolor{stringliteral}{\ \ \ \ ..\ [4]\ B.\ Efron\ and\ R.\ J.\ Tibshirani.\ An\ Introduction\ to\ the\ Bootstrap}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01517}01517\ \textcolor{stringliteral}{\ \ \ \ \ \ \ (1993).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01518}01518\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01519}01519\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01520}01520\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01521}01521\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01522}01522\ \textcolor{stringliteral}{\ \ \ \ Suppose\ we\ wish\ to\ test\ whether\ two\ samples\ are\ drawn\ from\ the\ same}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01523}01523\ \textcolor{stringliteral}{\ \ \ \ distribution.\ Assume\ that\ the\ underlying\ distributions\ are\ unknown\ to\ us,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01524}01524\ \textcolor{stringliteral}{\ \ \ \ and\ that\ before\ observing\ the\ data,\ we\ hypothesized\ that\ the\ mean\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01525}01525\ \textcolor{stringliteral}{\ \ \ \ first\ sample\ would\ be\ less\ than\ that\ of\ the\ second\ sample.\ We\ decide\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01526}01526\ \textcolor{stringliteral}{\ \ \ \ we\ will\ use\ the\ difference\ between\ the\ sample\ means\ as\ a\ test\ statistic,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01527}01527\ \textcolor{stringliteral}{\ \ \ \ and\ we\ will\ consider\ a\ p-\/value\ of\ 0.05\ to\ be\ statistically\ significant.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01528}01528\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01529}01529\ \textcolor{stringliteral}{\ \ \ \ For\ efficiency,\ we\ write\ the\ function\ defining\ the\ test\ statistic\ in\ a}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01530}01530\ \textcolor{stringliteral}{\ \ \ \ vectorized\ fashion:\ the\ samples\ \`{}\`{}x\`{}\`{}\ and\ \`{}\`{}y\`{}\`{}\ can\ be\ ND\ arrays,\ and\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01531}01531\ \textcolor{stringliteral}{\ \ \ \ statistic\ will\ be\ calculated\ for\ each\ axis-\/slice\ along\ \`{}axis\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01532}01532\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01533}01533\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01534}01534\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ statistic(x,\ y,\ axis):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01535}01535\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ np.mean(x,\ axis=axis)\ -\/\ np.mean(y,\ axis=axis)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01536}01536\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01537}01537\ \textcolor{stringliteral}{\ \ \ \ After\ collecting\ our\ data,\ we\ calculate\ the\ observed\ value\ of\ the\ test}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01538}01538\ \textcolor{stringliteral}{\ \ \ \ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01539}01539\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01540}01540\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ norm}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01541}01541\ \textcolor{stringliteral}{\ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01542}01542\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ norm.rvs(size=5,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01543}01543\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ norm.rvs(size=6,\ loc\ =\ 3,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01544}01544\ \textcolor{stringliteral}{\ \ \ \ >>>\ statistic(x,\ y,\ 0)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01545}01545\ \textcolor{stringliteral}{\ \ \ \ -\/3.5411688580987266}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01546}01546\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01547}01547\ \textcolor{stringliteral}{\ \ \ \ Indeed,\ the\ test\ statistic\ is\ negative,\ suggesting\ that\ the\ true\ mean\ of}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01548}01548\ \textcolor{stringliteral}{\ \ \ \ the\ distribution\ underlying\ \`{}\`{}x\`{}\`{}\ is\ less\ than\ that\ of\ the\ distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01549}01549\ \textcolor{stringliteral}{\ \ \ \ underlying\ \`{}\`{}y\`{}\`{}.\ To\ determine\ the\ probability\ of\ this\ occuring\ by\ chance}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01550}01550\ \textcolor{stringliteral}{\ \ \ \ if\ the\ two\ samples\ were\ drawn\ from\ the\ same\ distribution,\ we\ perform}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01551}01551\ \textcolor{stringliteral}{\ \ \ \ a\ permutation\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01552}01552\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01553}01553\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ permutation\_test}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01554}01554\ \textcolor{stringliteral}{\ \ \ \ >>>\ \#\ because\ our\ statistic\ is\ vectorized,\ we\ pass\ \`{}vectorized=True\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01555}01555\ \textcolor{stringliteral}{\ \ \ \ >>>\ \#\ \`{}n\_resamples=np.inf\`{}\ indicates\ that\ an\ exact\ test\ is\ to\ be\ performed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01556}01556\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ permutation\_test((x,\ y),\ statistic,\ vectorized=True,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01557}01557\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples=np.inf,\ alternative='less')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01558}01558\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.statistic)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01559}01559\ \textcolor{stringliteral}{\ \ \ \ -\/3.5411688580987266}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01560}01560\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.pvalue)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01561}01561\ \textcolor{stringliteral}{\ \ \ \ 0.004329004329004329}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01562}01562\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01563}01563\ \textcolor{stringliteral}{\ \ \ \ The\ probability\ of\ obtaining\ a\ test\ statistic\ less\ than\ or\ equal\ to\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01564}01564\ \textcolor{stringliteral}{\ \ \ \ observed\ value\ under\ the\ null\ hypothesis\ is\ 0.4329\%.\ This\ is\ less\ than\ our}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01565}01565\ \textcolor{stringliteral}{\ \ \ \ chosen\ threshold\ of\ 5\%,\ so\ we\ consider\ this\ to\ be\ significant\ evidence}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01566}01566\ \textcolor{stringliteral}{\ \ \ \ against\ the\ null\ hypothesis\ in\ favor\ of\ the\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01567}01567\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01568}01568\ \textcolor{stringliteral}{\ \ \ \ Because\ the\ size\ of\ the\ samples\ above\ was\ small,\ \`{}permutation\_test\`{}\ could}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01569}01569\ \textcolor{stringliteral}{\ \ \ \ perform\ an\ exact\ test.\ For\ larger\ samples,\ we\ resort\ to\ a\ randomized}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01570}01570\ \textcolor{stringliteral}{\ \ \ \ permutation\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01571}01571\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01572}01572\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ norm.rvs(size=100,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01573}01573\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ norm.rvs(size=120,\ loc=0.3,\ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01574}01574\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ permutation\_test((x,\ y),\ statistic,\ n\_resamples=100000,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01575}01575\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vectorized=True,\ alternative='less',}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01576}01576\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=rng)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01577}01577\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.statistic)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01578}01578\ \textcolor{stringliteral}{\ \ \ \ -\/0.5230459671240913}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01579}01579\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res.pvalue)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01580}01580\ \textcolor{stringliteral}{\ \ \ \ 0.00016999830001699983}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01581}01581\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01582}01582\ \textcolor{stringliteral}{\ \ \ \ The\ approximate\ probability\ of\ obtaining\ a\ test\ statistic\ less\ than\ or}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01583}01583\ \textcolor{stringliteral}{\ \ \ \ equal\ to\ the\ observed\ value\ under\ the\ null\ hypothesis\ is\ 0.0225\%.\ This\ is}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01584}01584\ \textcolor{stringliteral}{\ \ \ \ again\ less\ than\ our\ chosen\ threshold\ of\ 5\%,\ so\ again\ we\ have\ significant}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01585}01585\ \textcolor{stringliteral}{\ \ \ \ evidence\ to\ reject\ the\ null\ hypothesis\ in\ favor\ of\ the\ alternative.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01586}01586\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01587}01587\ \textcolor{stringliteral}{\ \ \ \ For\ large\ samples\ and\ number\ of\ permutations,\ the\ result\ is\ comparable\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01588}01588\ \textcolor{stringliteral}{\ \ \ \ that\ of\ the\ corresponding\ asymptotic\ test,\ the\ independent\ sample\ t-\/test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01589}01589\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01590}01590\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ ttest\_ind}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01591}01591\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\_asymptotic\ =\ ttest\_ind(x,\ y,\ alternative='less')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01592}01592\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res\_asymptotic.pvalue)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01593}01593\ \textcolor{stringliteral}{\ \ \ \ 0.00012688101537979522}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01594}01594\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01595}01595\ \textcolor{stringliteral}{\ \ \ \ The\ permutation\ distribution\ of\ the\ test\ statistic\ is\ provided\ for}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01596}01596\ \textcolor{stringliteral}{\ \ \ \ further\ investigation.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01597}01597\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01598}01598\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01599}01599\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.hist(res.null\_distribution,\ bins=50)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01600}01600\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.title("{}Permutation\ distribution\ of\ test\ statistic"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01601}01601\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.xlabel("{}Value\ of\ Statistic"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01602}01602\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.ylabel("{}Frequency"{})}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01603}01603\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01604}01604\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01605}01605\ \textcolor{stringliteral}{\ \ \ \ Inspection\ of\ the\ null\ distribution\ is\ essential\ if\ the\ statistic\ suffers}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01606}01606\ \textcolor{stringliteral}{\ \ \ \ from\ inaccuracy\ due\ to\ limited\ machine\ precision.\ Consider\ the\ following}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01607}01607\ \textcolor{stringliteral}{\ \ \ \ case:}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01608}01608\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01609}01609\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ pearsonr}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01610}01610\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ [1,\ 2,\ 4,\ 3]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01611}01611\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ [2,\ 4,\ 6,\ 8]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01612}01612\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ statistic(x,\ y):}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01613}01613\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ pearsonr(x,\ y).statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01614}01614\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ permutation\_test((x,\ y),\ statistic,\ vectorized=False,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01615}01615\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ permutation\_type='pairings',}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01616}01616\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alternative='greater')}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01617}01617\ \textcolor{stringliteral}{\ \ \ \ >>>\ r,\ pvalue,\ null\ =\ res.statistic,\ res.pvalue,\ res.null\_distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01618}01618\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01619}01619\ \textcolor{stringliteral}{\ \ \ \ In\ this\ case,\ some\ elements\ of\ the\ null\ distribution\ differ\ from\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01620}01620\ \textcolor{stringliteral}{\ \ \ \ observed\ value\ of\ the\ correlation\ coefficient\ \`{}\`{}r\`{}\`{}\ due\ to\ numerical\ noise.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01621}01621\ \textcolor{stringliteral}{\ \ \ \ We\ manually\ inspect\ the\ elements\ of\ the\ null\ distribution\ that\ are\ nearly}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01622}01622\ \textcolor{stringliteral}{\ \ \ \ the\ same\ as\ the\ observed\ value\ of\ the\ test\ statistic.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01623}01623\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01624}01624\ \textcolor{stringliteral}{\ \ \ \ >>>\ r}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01625}01625\ \textcolor{stringliteral}{\ \ \ \ 0.8}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01626}01626\ \textcolor{stringliteral}{\ \ \ \ >>>\ unique\ =\ np.unique(null)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01627}01627\ \textcolor{stringliteral}{\ \ \ \ >>>\ unique}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01628}01628\ \textcolor{stringliteral}{\ \ \ \ array([-\/1.\ ,\ -\/0.8,\ -\/0.8,\ -\/0.6,\ -\/0.4,\ -\/0.2,\ -\/0.2,\ \ 0.\ ,\ \ 0.2,\ \ 0.2,\ \ 0.4,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01629}01629\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 0.6,\ \ 0.8,\ \ 0.8,\ \ 1.\ ])\ \#\ may\ vary}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01630}01630\ \textcolor{stringliteral}{\ \ \ \ >>>\ unique[np.isclose(r,\ unique)].tolist()}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01631}01631\ \textcolor{stringliteral}{\ \ \ \ [0.7999999999999999,\ 0.8]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01632}01632\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01633}01633\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}permutation\_test\`{}\ were\ to\ perform\ the\ comparison\ naively,\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01634}01634\ \textcolor{stringliteral}{\ \ \ \ elements\ of\ the\ null\ distribution\ with\ value\ \`{}\`{}0.7999999999999999\`{}\`{}\ would}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01635}01635\ \textcolor{stringliteral}{\ \ \ \ not\ be\ considered\ as\ extreme\ or\ more\ extreme\ as\ the\ observed\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01636}01636\ \textcolor{stringliteral}{\ \ \ \ statistic,\ so\ the\ calculated\ p-\/value\ would\ be\ too\ small.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01637}01637\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01638}01638\ \textcolor{stringliteral}{\ \ \ \ >>>\ incorrect\_pvalue\ =\ np.count\_nonzero(null\ >=\ r)\ /\ len(null)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01639}01639\ \textcolor{stringliteral}{\ \ \ \ >>>\ incorrect\_pvalue}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01640}01640\ \textcolor{stringliteral}{\ \ \ \ 0.1111111111111111\ \ \#\ may\ vary}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01641}01641\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01642}01642\ \textcolor{stringliteral}{\ \ \ \ Instead,\ \`{}permutation\_test\`{}\ treats\ elements\ of\ the\ null\ distribution\ that}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01643}01643\ \textcolor{stringliteral}{\ \ \ \ are\ within\ \`{}\`{}max(1e-\/14,\ abs(r)*1e-\/14)\`{}\`{}\ of\ the\ observed\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01644}01644\ \textcolor{stringliteral}{\ \ \ \ statistic\ \`{}\`{}r\`{}\`{}\ to\ be\ equal\ to\ \`{}\`{}r\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01645}01645\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01646}01646\ \textcolor{stringliteral}{\ \ \ \ >>>\ correct\_pvalue\ =\ np.count\_nonzero(null\ >=\ r\ -\/\ 1e-\/14)\ /\ len(null)}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01647}01647\ \textcolor{stringliteral}{\ \ \ \ >>>\ correct\_pvalue}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01648}01648\ \textcolor{stringliteral}{\ \ \ \ 0.16666666666666666}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01649}01649\ \textcolor{stringliteral}{\ \ \ \ >>>\ res.pvalue\ ==\ correct\_pvalue}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01650}01650\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01651}01651\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01652}01652\ \textcolor{stringliteral}{\ \ \ \ This\ method\ of\ comparison\ is\ expected\ to\ be\ accurate\ in\ most\ practical}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01653}01653\ \textcolor{stringliteral}{\ \ \ \ situations,\ but\ the\ user\ is\ advised\ to\ assess\ this\ by\ inspecting\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01654}01654\ \textcolor{stringliteral}{\ \ \ \ elements\ of\ the\ null\ distribution\ that\ are\ close\ to\ the\ observed\ value}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01655}01655\ \textcolor{stringliteral}{\ \ \ \ of\ the\ statistic.\ Also,\ consider\ the\ use\ of\ statistics\ that\ can\ be}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01656}01656\ \textcolor{stringliteral}{\ \ \ \ calculated\ using\ exact\ arithmetic\ (e.g.\ integer\ statistics).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01657}01657\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01658}01658\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01659}01659\ \ \ \ \ args\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__resampling_aaa7528e2c981d6bb79547bdb33da599a}{\_permutation\_test\_iv}}(data,\ statistic,\ permutation\_type,\ vectorized,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01660}01660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_resamples,\ batch,\ alternative,\ axis,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01661}01661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01662}01662\ \ \ \ \ (data,\ statistic,\ permutation\_type,\ vectorized,\ n\_resamples,\ batch,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01663}01663\ \ \ \ \ \ alternative,\ axis,\ random\_state)\ =\ args}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01664}01664\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01665}01665\ \ \ \ \ observed\ =\ statistic(*data,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01666}01666\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01667}01667\ \ \ \ \ null\_calculators\ =\ \{\textcolor{stringliteral}{"{}pairings"{}}:\ \_calculate\_null\_pairings,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01668}01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}samples"{}}:\ \_calculate\_null\_samples,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01669}01669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}independent"{}}:\ \_calculate\_null\_both\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01670}01670\ \ \ \ \ null\_calculator\_args\ =\ (data,\ statistic,\ n\_resamples,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01671}01671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch,\ random\_state)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01672}01672\ \ \ \ \ calculate\_null\ =\ null\_calculators[permutation\_type]}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01673}01673\ \ \ \ \ null\_distribution,\ n\_resamples,\ exact\_test\ =\ (}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01674}01674\ \ \ \ \ \ \ \ \ calculate\_null(*null\_calculator\_args))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01675}01675\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01676}01676\ \ \ \ \ \textcolor{comment}{\#\ See\ References\ [2]\ and\ [3]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01677}01677\ \ \ \ \ adjustment\ =\ 0\ \textcolor{keywordflow}{if}\ exact\_test\ \textcolor{keywordflow}{else}\ 1}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01678}01678\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01679}01679\ \ \ \ \ \textcolor{comment}{\#\ relative\ tolerance\ for\ detecting\ numerically\ distinct\ but}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01680}01680\ \ \ \ \ \textcolor{comment}{\#\ theoretically\ equal\ values\ in\ the\ null\ distribution}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01681}01681\ \ \ \ \ eps\ =\ 1e-\/14}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01682}01682\ \ \ \ \ gamma\ =\ np.maximum(eps,\ np.abs(eps\ *\ observed))}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01683}01683\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01684}01684\ \ \ \ \ \textcolor{keyword}{def\ }less(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01685}01685\ \ \ \ \ \ \ \ \ cmps\ =\ null\_distribution\ <=\ observed\ +\ gamma}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01686}01686\ \ \ \ \ \ \ \ \ pvalues\ =\ (cmps.sum(axis=0)\ +\ adjustment)\ /\ (n\_resamples\ +\ adjustment)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01687}01687\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01688}01688\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01689}01689\ \ \ \ \ \textcolor{keyword}{def\ }greater(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01690}01690\ \ \ \ \ \ \ \ \ cmps\ =\ null\_distribution\ >=\ observed\ -\/\ gamma}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01691}01691\ \ \ \ \ \ \ \ \ pvalues\ =\ (cmps.sum(axis=0)\ +\ adjustment)\ /\ (n\_resamples\ +\ adjustment)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01692}01692\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01693}01693\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01694}01694\ \ \ \ \ \textcolor{keyword}{def\ }two\_sided(null\_distribution,\ observed):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01695}01695\ \ \ \ \ \ \ \ \ pvalues\_less\ =\ less(null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01696}01696\ \ \ \ \ \ \ \ \ pvalues\_greater\ =\ greater(null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01697}01697\ \ \ \ \ \ \ \ \ pvalues\ =\ np.minimum(pvalues\_less,\ pvalues\_greater)\ *\ 2}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01698}01698\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ pvalues}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01699}01699\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01700}01700\ \ \ \ \ compare\ =\ \{\textcolor{stringliteral}{"{}less"{}}:\ less,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01701}01701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}greater"{}}:\ greater,}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01702}01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}two-\/sided"{}}:\ two\_sided\}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01703}01703\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01704}01704\ \ \ \ \ pvalues\ =\ compare[alternative](null\_distribution,\ observed)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01705}01705\ \ \ \ \ pvalues\ =\ np.clip(pvalues,\ 0,\ 1)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01706}01706\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01707}01707\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationTestResult}{PermutationTestResult}}(observed,\ pvalues,\ null\_distribution)}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01708}01708\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01709}01709\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01710}01710\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01711}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod}{01711}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod}{ResamplingMethod}}:}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01712}01712\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Configuration\ information\ for\ a\ statistical\ resampling\ method.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01713}01713\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01714}01714\ \textcolor{stringliteral}{\ \ \ \ Instances\ of\ this\ class\ can\ be\ passed\ into\ the\ \`{}method\`{}\ parameter\ of\ some}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01715}01715\ \textcolor{stringliteral}{\ \ \ \ hypothesis\ test\ functions\ to\ perform\ a\ resampling\ or\ Monte\ Carlo\ version}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01716}01716\ \textcolor{stringliteral}{\ \ \ \ of\ the\ hypothesis\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01717}01717\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01718}01718\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01719}01719\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01720}01720\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01721}01721\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ perform\ or\ Monte\ Carlo\ samples\ to\ draw.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01722}01722\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01723}01723\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ process\ in\ each\ vectorized\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01724}01724\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ statistic.\ Batch\ sizes\ >>1\ tend\ to\ be\ faster\ when\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01725}01725\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ vectorized,\ but\ memory\ usage\ scales\ linearly\ with\ the\ batch\ size.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01726}01726\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ \`{}\`{}None\`{}\`{},\ which\ processes\ all\ resamples\ in\ a\ single\ batch.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01727}01727\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01728}01728\ \ \ \ \ n\_resamples:\ int\ =\ 9999}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01729}01729\ \ \ \ \ batch:\ int\ =\ \textcolor{keywordtype}{None}\ \ \textcolor{comment}{\#\ type:\ ignore[assignment]}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01730}01730\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01731}01731\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01732}01732\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01733}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloMethod}{01733}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloMethod}{MonteCarloMethod}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod}{ResamplingMethod}}):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01734}01734\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Configuration\ information\ for\ a\ Monte\ Carlo\ hypothesis\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01735}01735\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01736}01736\ \textcolor{stringliteral}{\ \ \ \ Instances\ of\ this\ class\ can\ be\ passed\ into\ the\ \`{}method\`{}\ parameter\ of\ some}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01737}01737\ \textcolor{stringliteral}{\ \ \ \ hypothesis\ test\ functions\ to\ perform\ a\ Monte\ Carlo\ version\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01738}01738\ \textcolor{stringliteral}{\ \ \ \ hypothesis\ tests.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01739}01739\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01740}01740\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01741}01741\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01742}01742\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01743}01743\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ Monte\ Carlo\ samples\ to\ draw.\ Default\ is\ 9999.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01744}01744\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01745}01745\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ Monte\ Carlo\ samples\ to\ process\ in\ each\ vectorized\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01746}01746\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ statistic.\ Batch\ sizes\ >>1\ tend\ to\ be\ faster\ when\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01747}01747\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ vectorized,\ but\ memory\ usage\ scales\ linearly\ with\ the\ batch\ size.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01748}01748\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ \`{}\`{}None\`{}\`{},\ which\ processes\ all\ samples\ in\ a\ single\ batch.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01749}01749\ \textcolor{stringliteral}{\ \ \ \ rvs\ :\ callable\ or\ tuple\ of\ callables,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01750}01750\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ callable\ or\ sequence\ of\ callables\ that\ generates\ random\ variates}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01751}01751\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ under\ the\ null\ hypothesis.\ Each\ element\ of\ \`{}rvs\`{}\ must\ be\ a\ callable}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01752}01752\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ accepts\ keyword\ argument\ \`{}\`{}size\`{}\`{}\ (e.g.\ \`{}\`{}rvs(size=(m,\ n))\`{}\`{})\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01753}01753\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ returns\ an\ N-\/d\ array\ sample\ of\ that\ shape.\ If\ \`{}rvs\`{}\ is\ a\ sequence,\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01754}01754\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ of\ callables\ in\ \`{}rvs\`{}\ must\ match\ the\ number\ of\ samples\ passed}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01755}01755\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ the\ hypothesis\ test\ in\ which\ the\ \`{}MonteCarloMethod\`{}\ is\ used.\ Default}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01756}01756\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ \`{}\`{}None\`{}\`{},\ in\ which\ case\ the\ hypothesis\ test\ function\ chooses\ values}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01757}01757\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ match\ the\ standard\ version\ of\ the\ hypothesis\ test.\ For\ example,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01758}01758\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ null\ hypothesis\ of\ \`{}scipy.stats.pearsonr\`{}\ is\ typically\ that\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01759}01759\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ samples\ are\ drawn\ from\ the\ standard\ normal\ distribution,\ so}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01760}01760\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}rvs\ =\ (rng.normal,\ rng.normal)\`{}\`{}\ where}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01761}01761\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}rng\ =\ np.random.default\_rng()\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01762}01762\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01763}01763\ \ \ \ \ rvs:\ object\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01764}01764\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01765}01765\ \ \ \ \ \textcolor{keyword}{def\ }\_asdict(self):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01766}01766\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}dataclasses.asdict`\ deepcopies;\ we\ don't\ want\ that.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01767}01767\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dict(n\_resamples=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_af7a84c896035ea106559ffcbae1f7ae6}{n\_resamples}},\ batch=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_aaa2f4fe097a91f40d8beca2b071ddaac}{batch}},}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01768}01768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rvs=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1MonteCarloMethod_af166fed99c8e1e2db2847112eea99fac}{rvs}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01769}01769\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01770}01770\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01771}01771\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01772}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationMethod}{01772}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationMethod}{PermutationMethod}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod}{ResamplingMethod}}):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01773}01773\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Configuration\ information\ for\ a\ permutation\ hypothesis\ test.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01774}01774\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01775}01775\ \textcolor{stringliteral}{\ \ \ \ Instances\ of\ this\ class\ can\ be\ passed\ into\ the\ \`{}method\`{}\ parameter\ of\ some}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01776}01776\ \textcolor{stringliteral}{\ \ \ \ hypothesis\ test\ functions\ to\ perform\ a\ permutation\ version\ of\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01777}01777\ \textcolor{stringliteral}{\ \ \ \ hypothesis\ tests.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01778}01778\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01779}01779\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01780}01780\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01781}01781\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01782}01782\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ perform.\ Default\ is\ 9999.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01783}01783\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01784}01784\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ process\ in\ each\ vectorized\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01785}01785\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ statistic.\ Batch\ sizes\ >>1\ tend\ to\ be\ faster\ when\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01786}01786\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ vectorized,\ but\ memory\ usage\ scales\ linearly\ with\ the\ batch\ size.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01787}01787\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ \`{}\`{}None\`{}\`{},\ which\ processes\ all\ resamples\ in\ a\ single\ batch.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01788}01788\ \textcolor{stringliteral}{\ \ \ \ random\_state\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01789}01789\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01790}01790\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01791}01791\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Pseudorandom\ number\ generator\ state\ used\ to\ generate\ resamples.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01792}01792\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01793}01793\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01794}01794\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ instance,\ then\ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01795}01795\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01796}01796\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}random\_state\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01797}01797\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ \`{}\`{}None\`{}\`{}\ (default),\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01798}01798\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01799}01799\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01800}01800\ \ \ \ \ random\_state:\ object\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01801}01801\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01802}01802\ \ \ \ \ \textcolor{keyword}{def\ }\_asdict(self):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01803}01803\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}dataclasses.asdict`\ deepcopies;\ we\ don't\ want\ that.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01804}01804\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dict(n\_resamples=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_af7a84c896035ea106559ffcbae1f7ae6}{n\_resamples}},\ batch=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_aaa2f4fe097a91f40d8beca2b071ddaac}{batch}},}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01805}01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1PermutationMethod_a290570e1d107b230c3054808922d42ec}{random\_state}})}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01806}01806\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01807}01807\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01808}01808\ \textcolor{preprocessor}{@dataclass}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01809}\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapMethod}{01809}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapMethod}{BootstrapMethod}}(\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod}{ResamplingMethod}}):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01810}01810\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Configuration\ information\ for\ a\ bootstrap\ confidence\ interval.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01811}01811\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01812}01812\ \textcolor{stringliteral}{\ \ \ \ Instances\ of\ this\ class\ can\ be\ passed\ into\ the\ \`{}method\`{}\ parameter\ of\ some}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01813}01813\ \textcolor{stringliteral}{\ \ \ \ confidence\ interval\ methods\ to\ generate\ a\ bootstrap\ confidence\ interval.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01814}01814\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01815}01815\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01816}01816\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01817}01817\ \textcolor{stringliteral}{\ \ \ \ n\_resamples\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01818}01818\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ perform.\ Default\ is\ 9999.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01819}01819\ \textcolor{stringliteral}{\ \ \ \ batch\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01820}01820\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ resamples\ to\ process\ in\ each\ vectorized\ call\ to}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01821}01821\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ statistic.\ Batch\ sizes\ >>1\ tend\ to\ be\ faster\ when\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01822}01822\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ vectorized,\ but\ memory\ usage\ scales\ linearly\ with\ the\ batch\ size.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01823}01823\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ \`{}\`{}None\`{}\`{},\ which\ processes\ all\ resamples\ in\ a\ single\ batch.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01824}01824\ \textcolor{stringliteral}{\ \ \ \ random\_state\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01825}01825\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01826}01826\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01827}01827\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Pseudorandom\ number\ generator\ state\ used\ to\ generate\ resamples.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01828}01828\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01829}01829\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01830}01830\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ instance,\ then\ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01831}01831\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01832}01832\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}random\_state\`{}.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01833}01833\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}random\_state\`{}\ is\ \`{}\`{}None\`{}\`{}\ (default),\ the}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01834}01834\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01835}01835\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01836}01836\ \textcolor{stringliteral}{\ \ \ \ method\ :\ \{'bca',\ 'percentile',\ 'basic'\}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01837}01837\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ use\ the\ 'percentile'\ bootstrap\ ('percentile'),\ the\ 'basic'}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01838}01838\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (AKA\ 'reverse')\ bootstrap\ ('basic'),\ or\ the\ bias-\/corrected\ and}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01839}01839\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ accelerated\ bootstrap\ ('BCa',\ default).}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01840}01840\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01841}01841\ \ \ \ \ random\_state:\ object\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01842}01842\ \ \ \ \ method:\ str\ =\ \textcolor{stringliteral}{'BCa'}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01843}01843\ }
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01844}01844\ \ \ \ \ \textcolor{keyword}{def\ }\_asdict(self):}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01845}01845\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}dataclasses.asdict`\ deepcopies;\ we\ don't\ want\ that.}}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01846}01846\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dict(n\_resamples=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_af7a84c896035ea106559ffcbae1f7ae6}{n\_resamples}},\ batch=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1ResamplingMethod_aaa2f4fe097a91f40d8beca2b071ddaac}{batch}},}
\DoxyCodeLine{\Hypertarget{__resampling_8py_source_l01847}01847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapMethod_a866f3bda98fe2c393aa966369a108ecf}{random\_state}},\ method=self.\mbox{\hyperlink{classscipy_1_1stats_1_1__resampling_1_1BootstrapMethod_aef668ab303d017aabf0be79f33594aac}{method}})}

\end{DoxyCode}
