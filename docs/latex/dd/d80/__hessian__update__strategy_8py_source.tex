\doxysection{\+\_\+hessian\+\_\+update\+\_\+strategy.\+py}
\hypertarget{__hessian__update__strategy_8py_source}{}\label{__hessian__update__strategy_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_hessian\_update\_strategy.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_hessian\_update\_strategy.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__hessian__update__strategy}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Hessian\ update\ strategies\ for\ quasi-\/Newton\ optimization\ methods."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00002}00002\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1linalg}{numpy.linalg}}\ \textcolor{keyword}{import}\ norm}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1linalg}{scipy.linalg}}\ \textcolor{keyword}{import}\ get\_blas\_funcs}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00005}00005\ \textcolor{keyword}{from}\ warnings\ \textcolor{keyword}{import}\ warn}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00008}00008\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'HessianUpdateStrategy'},\ \textcolor{stringliteral}{'BFGS'},\ \textcolor{stringliteral}{'SR1'}]}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00011}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy}{00011}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy}{HessianUpdateStrategy}}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00012}00012\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Interface\ for\ implementing\ Hessian\ update\ strategies.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00013}00013\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ Many\ optimization\ methods\ make\ use\ of\ Hessian\ (or\ inverse\ Hessian)}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ approximations,\ such\ as\ the\ quasi-\/Newton\ methods\ BFGS,\ SR1,\ L-\/BFGS.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ Some\ of\ these\ \ approximations,\ however,\ do\ not\ actually\ need\ to\ store}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ the\ entire\ matrix\ or\ can\ compute\ the\ internal\ matrix\ product\ with\ a}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ given\ vector\ in\ a\ very\ efficiently\ manner.\ This\ class\ serves\ as\ an}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ abstract\ interface\ between\ the\ optimization\ algorithm\ and\ the}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ quasi-\/Newton\ update\ strategies,\ giving\ freedom\ of\ implementation}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ to\ store\ and\ update\ the\ internal\ matrix\ as\ efficiently\ as\ possible.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ Different\ choices\ of\ initialization\ and\ update\ procedure\ will\ result}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ in\ different\ quasi-\/Newton\ strategies.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00024}00024\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ Four\ methods\ should\ be\ implemented\ in\ derived\ classes:\ \`{}\`{}initialize\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}update\`{}\`{},\ \`{}\`{}dot\`{}\`{}\ and\ \`{}\`{}get\_matrix\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00027}00027\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ Any\ instance\ of\ a\ class\ that\ implements\ this\ interface,}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ can\ be\ accepted\ by\ the\ method\ \`{}\`{}minimize\`{}\`{}\ and\ used\ by}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ the\ compatible\ solvers\ to\ approximate\ the\ Hessian\ (or}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ inverse\ Hessian)\ used\ by\ the\ optimization\ algorithms.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00036}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_adb6ce6ed753461cf9fc159c48303ebd9}{00036}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_adb6ce6ed753461cf9fc159c48303ebd9}{initialize}}(self,\ n,\ approx\_type):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Initialize\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00038}00038\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Allocate\ internal\ memory\ for\ storing\ and\ updating}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ Hessian\ or\ its\ inverse.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00041}00041\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ n\ :\ int}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Problem\ dimension.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ approx\_type\ :\ \{'hess',\ 'inv\_hess'\}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Selects\ either\ the\ Hessian\ or\ the\ inverse\ Hessian.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ When\ set\ to\ 'hess'\ the\ Hessian\ will\ be\ stored\ and\ updated.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ When\ set\ to\ 'inv\_hess'\ its\ inverse\ will\ be\ used\ instead.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}The\ method\ \`{}\`{}initialize(n,\ approx\_type)``"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ not\ implemented."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00054}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_a78eacef2a021da7ebc6a4242e93accb8}{00054}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_a78eacef2a021da7ebc6a4242e93accb8}{update}}(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Update\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00056}00056\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Update\ Hessian\ matrix\ or\ its\ inverse\ (depending\ on\ how\ 'approx\_type'}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ defined)\ using\ information\ about\ the\ last\ evaluated\ points.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00059}00059\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ delta\_x\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ difference\ between\ two\ points\ the\ gradient}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ function\ have\ been\ evaluated\ at:\ \`{}\`{}delta\_x\ =\ x2\ -\/\ x1\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ delta\_grad\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ difference\ between\ the\ gradients:}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}delta\_grad\ =\ grad(x2)\ -\/\ grad(x1)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}The\ method\ \`{}\`{}update(delta\_x,\ delta\_grad)``"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ not\ implemented."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00072}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_af1357f2d8fcf9432018377929382407b}{00072}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_af1357f2d8fcf9432018377929382407b}{dot}}(self,\ p):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ product\ of\ the\ internal\ matrix\ with\ the\ given\ vector.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00074}00074\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 1-\/D\ array\ representing\ a\ vector.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00079}00079\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Hp\ :\ array}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 1-\/D\ represents\ the\ result\ of\ multiplying\ the\ approximation\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ by\ vector\ p.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}The\ method\ \`{}\`{}dot(p)``"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ not\ implemented."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00089}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_aeb9099b9d047ad7e78d6fa2748fdda62}{00089}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_aeb9099b9d047ad7e78d6fa2748fdda62}{get\_matrix}}(self):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ current\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00091}00091\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ H\ :\ ndarray,\ shape\ (n,\ n)}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Dense\ matrix\ containing\ either\ the\ Hessian}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ or\ its\ inverse\ (depending\ on\ how\ 'approx\_type'}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ is\ defined).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}The\ method\ \`{}\`{}get\_matrix(p)``"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ not\ implemented."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00103}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy}{00103}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy}{FullHessianUpdateStrategy}}(\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy}{HessianUpdateStrategy}}):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00104}00104\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Hessian\ update\ strategy\ with\ full\ dimensional\ internal\ representation.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00106}00106\ \ \ \ \ \_syr\ =\ get\_blas\_funcs(\textcolor{stringliteral}{'syr'},\ dtype=\textcolor{stringliteral}{'d'})\ \ \textcolor{comment}{\#\ Symmetric\ rank\ 1\ update}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00107}00107\ \ \ \ \ \_syr2\ =\ get\_blas\_funcs(\textcolor{stringliteral}{'syr2'},\ dtype=\textcolor{stringliteral}{'d'})\ \ \textcolor{comment}{\#\ Symmetric\ rank\ 2\ update}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00108}00108\ \ \ \ \ \textcolor{comment}{\#\ Symmetric\ matrix-\/vector\ product}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00109}00109\ \ \ \ \ \_symv\ =\ get\_blas\_funcs(\textcolor{stringliteral}{'symv'},\ dtype=\textcolor{stringliteral}{'d'})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00111}00111\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ init\_scale='auto'):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5f5f401057b9712b5962f1f4cd65c403}{init\_scale}}\ =\ init\_scale}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Until\ initialize\ is\ called\ we\ can't\ really\ use\ the\ class,}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ so\ it\ makes\ sense\ to\ set\ everything\ to\ None.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a94375d61e752b0ee412d6535b539f14d}{first\_iteration}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00120}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a9bab753ccacd3d4733169efef42bbd7c}{00120}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a9bab753ccacd3d4733169efef42bbd7c}{initialize}}(self,\ n,\ approx\_type):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Initialize\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00122}00122\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Allocate\ internal\ memory\ for\ storing\ and\ updating}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ Hessian\ or\ its\ inverse.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00125}00125\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00128}00128\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ n\ :\ int}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Problem\ dimension.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00130}00130\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ approx\_type\ :\ \{'hess',\ 'inv\_hess'\}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Selects\ either\ the\ Hessian\ or\ the\ inverse\ Hessian.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ When\ set\ to\ 'hess'\ the\ Hessian\ will\ be\ stored\ and\ updated.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ When\ set\ to\ 'inv\_hess'\ its\ inverse\ will\ be\ used\ instead.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a94375d61e752b0ee412d6535b539f14d}{first\_iteration}}\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a09a409822b2fd2be83184518c92b1b9a}{n}}\ =\ n}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ =\ approx\_type}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ approx\_type\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'hess'},\ \textcolor{stringliteral}{'inv\_hess'}):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}approx\_type`\ must\ be\ 'hess'\ or\ 'inv\_hess'."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ np.eye(n,\ dtype=float)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ np.eye(n,\ dtype=float)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00146}00146\ \ \ \ \ \textcolor{keyword}{def\ }\_auto\_scale(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Heuristic\ to\ scale\ matrix\ at\ first\ iteration.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Described\ in\ Nocedal\ and\ Wright\ "{}Numerical\ Optimization"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ p.143\ formula\ (6.20).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ s\_norm2\ =\ np.dot(delta\_x,\ delta\_x)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ y\_norm2\ =\ np.dot(delta\_grad,\ delta\_grad)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ ys\ =\ np.abs(np.dot(delta\_grad,\ delta\_x))}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ys\ ==\ 0.0\ \textcolor{keywordflow}{or}\ y\_norm2\ ==\ 0\ \textcolor{keywordflow}{or}\ s\_norm2\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ y\_norm2\ /\ ys}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ys\ /\ y\_norm2}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00160}00160\ \ \ \ \ \textcolor{keyword}{def\ }\_update\_implementation(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}The\ method\ \`{}\`{}\_update\_implementation``"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ not\ implemented."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00163}00163\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00164}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a2a1bbd1b4cc369231212e228d4dd7117}{00164}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a2a1bbd1b4cc369231212e228d4dd7117}{update}}(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Update\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00166}00166\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Update\ Hessian\ matrix\ or\ its\ inverse\ (depending\ on\ how\ 'approx\_type'}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ defined)\ using\ information\ about\ the\ last\ evaluated\ points.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00169}00169\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ delta\_x\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ difference\ between\ two\ points\ the\ gradient}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ function\ have\ been\ evaluated\ at:\ \`{}\`{}delta\_x\ =\ x2\ -\/\ x1\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ delta\_grad\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ difference\ between\ the\ gradients:}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}delta\_grad\ =\ grad(x2)\ -\/\ grad(x1)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.all(delta\_x\ ==\ 0.0):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.all(delta\_grad\ ==\ 0.0):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ warn(\textcolor{stringliteral}{'delta\_grad\ ==\ 0.0.\ Check\ if\ the\ approximated\ '}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'function\ is\ linear.\ If\ the\ function\ is\ linear\ '}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'better\ results\ can\ be\ obtained\ by\ defining\ the\ '}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'Hessian\ as\ zero\ instead\ of\ using\ quasi-\/Newton\ '}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'approximations.'},\ UserWarning)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a94375d61e752b0ee412d6535b539f14d}{first\_iteration}}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ user\ specific\ scale}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5f5f401057b9712b5962f1f4cd65c403}{init\_scale}}\ ==\ \textcolor{stringliteral}{"{}auto"{}}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a0d1c4fb4a90d3b937a43f608a9482997}{\_auto\_scale}}(delta\_x,\ delta\_grad)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale\ =\ float(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5f5f401057b9712b5962f1f4cd65c403}{init\_scale}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scale\ initial\ matrix\ with\ \`{}\`{}scale\ *\ np.eye(n)``}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ *=\ scale}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ *=\ scale}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a94375d61e752b0ee412d6535b539f14d}{first\_iteration}}\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ae2fb3534e9cc30f931ba6507f81aba21}{\_update\_implementation}}(delta\_x,\ delta\_grad)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00202}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ab26ce25ad5187d7244d8cfd52e437fe8}{00202}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ab26ce25ad5187d7244d8cfd52e437fe8}{dot}}(self,\ p):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ product\ of\ the\ internal\ matrix\ with\ the\ given\ vector.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00204}00204\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ p\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 1-\/D\ array\ representing\ a\ vector.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00209}00209\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Hp\ :\ array}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 1-\/D\ represents\ the\ result\ of\ multiplying\ the\ approximation\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ by\ vector\ p.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_aab42e5985cbfd47b100b835cefd2d54e}{\_symv}}(1,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}},\ p)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_aab42e5985cbfd47b100b835cefd2d54e}{\_symv}}(1,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}},\ p)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00220}00220\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00221}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a8c287f193beef9d1ec4da5925b944d87}{00221}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a8c287f193beef9d1ec4da5925b944d87}{get\_matrix}}(self):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ the\ current\ internal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00223}00223\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ M\ :\ ndarray,\ shape\ (n,\ n)}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Dense\ matrix\ containing\ either\ the\ Hessian\ or\ its\ inverse}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ (depending\ on\ how\ \`{}approx\_type\`{}\ was\ defined).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ M\ =\ np.copy(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ M\ =\ np.copy(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ li\ =\ np.tril\_indices\_from(M,\ k=-\/1)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ M[li]\ =\ M.T[li]}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ M}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00237}00237\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00238}00238\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00239}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS}{00239}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS}{BFGS}}(\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy}{FullHessianUpdateStrategy}}):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00240}00240\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Broyden-\/Fletcher-\/Goldfarb-\/Shanno\ (BFGS)\ Hessian\ update\ strategy.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00241}00241\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ exception\_strategy\ :\ \{'skip\_update',\ 'damp\_update'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Define\ how\ to\ proceed\ when\ the\ curvature\ condition\ is\ violated.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ it\ to\ 'skip\_update'\ to\ just\ skip\ the\ update.\ Or,\ alternatively,}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ set\ it\ to\ 'damp\_update'\ to\ interpolate\ between\ the\ actual\ BFGS}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ result\ and\ the\ unmodified\ matrix.\ Both\ exceptions\ strategies}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ are\ explained\ \ in\ [1]\_,\ p.536-\/537.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ min\_curvature\ :\ float}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ number,\ scaled\ by\ a\ normalization\ factor,\ defines\ the}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ minimum\ curvature\ \`{}\`{}dot(delta\_grad,\ delta\_x)\`{}\`{}\ allowed\ to\ go}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ unaffected\ by\ the\ exception\ strategy.\ By\ default\ is\ equal\ to}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1e-\/8\ when\ \`{}\`{}exception\_strategy\ =\ 'skip\_update'\`{}\`{}\ and\ equal}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ 0.2\ when\ \`{}\`{}exception\_strategy\ =\ 'damp\_update'\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ init\_scale\ :\ \{float,\ 'auto'\}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Matrix\ scale\ at\ first\ iteration.\ At\ the\ first}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ iteration\ the\ Hessian\ matrix\ or\ its\ inverse\ will\ be\ initialized}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ with\ \`{}\`{}init\_scale*np.eye(n)\`{}\`{},\ where\ \`{}\`{}n\`{}\`{}\ is\ the\ problem\ dimension.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ it\ to\ 'auto'\ in\ order\ to\ use\ an\ automatic\ heuristic\ for\ choosing}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ initial\ scale.\ The\ heuristic\ is\ described\ in\ [1]\_,\ p.143.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ By\ default\ uses\ 'auto'.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00263}00263\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ The\ update\ is\ based\ on\ the\ description\ in\ [1]\_,\ p.140.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00267}00267\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Nocedal,\ Jorge,\ and\ Stephen\ J.\ Wright.\ "{}Numerical\ optimization"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Second\ Edition\ (2006).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00274}00274\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ exception\_strategy='skip\_update',\ min\_curvature=None,}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ init\_scale='auto'):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ exception\_strategy\ ==\ \textcolor{stringliteral}{'skip\_update'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ min\_curvature\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}}\ =\ min\_curvature}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}}\ =\ 1e-\/8}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ exception\_strategy\ ==\ \textcolor{stringliteral}{'damp\_update'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ min\_curvature\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}}\ =\ min\_curvature}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}}\ =\ 0.2}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}\`{}exception\_strategy`\ must\ be\ 'skip\_update'\ "{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}or\ 'damp\_update'."{}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(init\_scale)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_a3fab2d65c7edf73677abf27973e54d73}{exception\_strategy}}\ =\ exception\_strategy}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00292}00292\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00293}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9b848bd1c341e26ef8734958412f9c7}{00293}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9b848bd1c341e26ef8734958412f9c7}{\_update\_inverse\_hessian}}(self,\ ys,\ Hy,\ yHy,\ s):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Update\ the\ inverse\ Hessian\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00295}00295\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ BFGS\ update\ using\ the\ formula:}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00297}00297\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}H\ <-\/\ H\ +\ ((H*y).T*y\ +\ s.T*y)/(s.T*y)\string^2\ *\ (s*s.T)}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/\ 1/(s.T*y)\ *\ ((H*y)*s.T\ +\ s*(H*y).T)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00300}00300\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ \`{}\`{}s\ =\ delta\_x\`{}\`{}\ and\ \`{}\`{}y\ =\ delta\_grad\`{}\`{}.\ This\ formula\ is}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ equivalent\ to\ (6.17)\ in\ [1]\_\ written\ in\ a\ more\ efficient\ way}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ implementation.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00304}00304\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [1]\ Nocedal,\ Jorge,\ and\ Stephen\ J.\ Wright.\ "{}Numerical\ optimization"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Second\ Edition\ (2006).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a41402f6fcc2569a308931f1e97d7948a}{\_syr2}}(-\/1.0\ /\ ys,\ s,\ Hy,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5463a4b0a586c7bde6e3b0b1ad9798e3}{\_syr}}((ys+yHy)/ys**2,\ s,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00313}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_adfcf2a3af1df936a4b8b7458daa1554e}{00313}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_adfcf2a3af1df936a4b8b7458daa1554e}{\_update\_hessian}}(self,\ ys,\ Bs,\ sBs,\ y):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Update\ the\ Hessian\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00315}00315\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ BFGS\ update\ using\ the\ formula:}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00317}00317\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \`{}\`{}B\ <-\/\ B\ -\/\ (B*s)*(B*s).T/s.T*(B*s)\ +\ y*y\string^T/s.T*y\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00319}00319\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ \`{}\`{}s\`{}\`{}\ is\ short\ for\ \`{}\`{}delta\_x\`{}\`{}\ and\ \`{}\`{}y\`{}\`{}\ is\ short}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ \`{}\`{}delta\_grad\`{}\`{}.\ Formula\ (6.19)\ in\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00322}00322\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ [1]\ Nocedal,\ Jorge,\ and\ Stephen\ J.\ Wright.\ "{}Numerical\ optimization"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Second\ Edition\ (2006).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5463a4b0a586c7bde6e3b0b1ad9798e3}{\_syr}}(1.0\ /\ ys,\ y,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5463a4b0a586c7bde6e3b0b1ad9798e3}{\_syr}}(-\/1.0\ /\ sBs,\ Bs,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00330}00330\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00331}00331\ \ \ \ \ \textcolor{keyword}{def\ }\_update\_implementation(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Auxiliary\ variables\ w\ and\ z}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ delta\_x}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ delta\_grad}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ delta\_grad}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ delta\_x}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Do\ some\ common\ operations}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ wz\ =\ np.dot(w,\ z)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ Mw\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_af1357f2d8fcf9432018377929382407b}{dot}}(w)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ wMw\ =\ Mw.dot(w)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Guarantee\ that\ wMw\ >\ 0\ by\ reinitializing\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ While\ this\ is\ always\ true\ in\ exact\ arithmetics,}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ indefinite\ matrix\ may\ appear\ due\ to\ roundoff\ errors.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ wMw\ <=\ 0.0:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ scale\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a0d1c4fb4a90d3b937a43f608a9482997}{\_auto\_scale}}(delta\_x,\ delta\_grad)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reinitialize\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ scale\ *\ np.eye(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a09a409822b2fd2be83184518c92b1b9a}{n}},\ dtype=float)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ scale\ *\ np.eye(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a09a409822b2fd2be83184518c92b1b9a}{n}},\ dtype=float)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Do\ common\ operations\ for\ new\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ Mw\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_af1357f2d8fcf9432018377929382407b}{dot}}(w)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ \ \ \ \ wMw\ =\ Mw.dot(w)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ curvature\ condition\ is\ violated}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00357}00357\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ wz\ <=\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}}\ *\ wMw:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ option\ 'skip\_update'\ is\ set}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00359}00359\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ just\ skip\ the\ update\ when\ the\ condion}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ is\ violated.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_a3fab2d65c7edf73677abf27973e54d73}{exception\_strategy}}\ ==\ \textcolor{stringliteral}{'skip\_update'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ option\ 'damp\_update'\ is\ set\ we}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ interpolate\ between\ the\ actual\ BFGS}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ result\ and\ the\ unmodified\ matrix.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_a3fab2d65c7edf73677abf27973e54d73}{exception\_strategy}}\ ==\ \textcolor{stringliteral}{'damp\_update'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ update\_factor\ =\ (1-\/self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9468ee8062289cd9440ce7c593b78bb}{min\_curvature}})\ /\ (1\ -\/\ wz/wMw)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ update\_factor*z\ +\ (1-\/update\_factor)*Mw}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ wz\ =\ np.dot(w,\ z)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_adfcf2a3af1df936a4b8b7458daa1554e}{\_update\_hessian}}(wz,\ Mw,\ wMw,\ z)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00373}00373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00374}00374\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1BFGS_ac9b848bd1c341e26ef8734958412f9c7}{\_update\_inverse\_hessian}}(wz,\ Mw,\ wMw,\ z)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00375}00375\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00376}00376\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00377}\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1SR1}{00377}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1SR1}{SR1}}(\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy}{FullHessianUpdateStrategy}}):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00378}00378\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Symmetric-\/rank-\/1\ Hessian\ update\ strategy.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00379}00379\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ min\_denominator\ :\ float}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ number,\ scaled\ by\ a\ normalization\ factor,}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ defines\ the\ minimum\ denominator\ magnitude\ allowed}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ the\ update.\ When\ the\ condition\ is\ violated\ we\ skip}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ update.\ By\ default\ uses\ \`{}\`{}1e-\/8\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ init\_scale\ :\ \{float,\ 'auto'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Matrix\ scale\ at\ first\ iteration.\ At\ the\ first}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ iteration\ the\ Hessian\ matrix\ or\ its\ inverse\ will\ be\ initialized}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ with\ \`{}\`{}init\_scale*np.eye(n)\`{}\`{},\ where\ \`{}\`{}n\`{}\`{}\ is\ the\ problem\ dimension.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ it\ to\ 'auto'\ in\ order\ to\ use\ an\ automatic\ heuristic\ for\ choosing}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ initial\ scale.\ The\ heuristic\ is\ described\ in\ [1]\_,\ p.143.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ By\ default\ uses\ 'auto'.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00394}00394\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ The\ update\ is\ based\ on\ the\ description\ in\ [1]\_,\ p.144-\/146.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00398}00398\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Nocedal,\ Jorge,\ and\ Stephen\ J.\ Wright.\ "{}Numerical\ optimization"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Second\ Edition\ (2006).}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00404}00404\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00405}00405\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ min\_denominator=1e-\/8,\ init\_scale='auto'):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1SR1_ae7cd39597cd7d1c38c9d427a9624bf94}{min\_denominator}}\ =\ min\_denominator}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(init\_scale)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00408}00408\ }
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00409}00409\ \ \ \ \ \textcolor{keyword}{def\ }\_update\_implementation(self,\ delta\_x,\ delta\_grad):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Auxiliary\ variables\ w\ and\ z}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ delta\_x}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ delta\_grad}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ delta\_grad}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ delta\_x}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Do\ some\ common\ operations}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ Mw\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1HessianUpdateStrategy_af1357f2d8fcf9432018377929382407b}{dot}}(w)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ z\_minus\_Mw\ =\ z\ -\/\ Mw}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ denominator\ =\ np.dot(w,\ z\_minus\_Mw)}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ denominator\ is\ too\ small}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ just\ skip\ the\ update.}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.abs(denominator)\ <=\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1SR1_ae7cd39597cd7d1c38c9d427a9624bf94}{min\_denominator}}*norm(w)*norm(z\_minus\_Mw):}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ matrix}}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a63788c3d35ec30f6864397813da4059e}{approx\_type}}\ ==\ \textcolor{stringliteral}{'hess'}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5463a4b0a586c7bde6e3b0b1ad9798e3}{\_syr}}(1/denominator,\ z\_minus\_Mw,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a3e7097d3bc0c68ea15abbea8ec16b517}{B}})}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00428}00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__hessian__update__strategy_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_a5463a4b0a586c7bde6e3b0b1ad9798e3}{\_syr}}(1/denominator,\ z\_minus\_Mw,\ a=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__hessian__update__strategy_1_1FullHessianUpdateStrategy_ad9d8b818eb9172f13f73e57c3307364f}{H}})}

\end{DoxyCode}
