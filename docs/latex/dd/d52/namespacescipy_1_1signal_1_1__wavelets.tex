\doxysection{scipy.\+signal.\+\_\+wavelets Namespace Reference}
\hypertarget{namespacescipy_1_1signal_1_1__wavelets}{}\label{namespacescipy_1_1signal_1_1__wavelets}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a1ddaf84a9500f37120ad1ea60d9a44b4}{daub}} (p)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a206eb1106499b934885c7f502a91134b}{qmf}} (hk)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a985cb37604ad304f33698d8c37a28454}{cascade}} (hk, J=7)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a486bcbeaae06e28136dc9598e28d9f0c}{morlet}} (M, w=5.\+0, s=1.\+0, complete=\mbox{\hyperlink{classTrue}{True}})
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ac519a29940a04c86e800210c8b5a4c21}{ricker}} (points, a)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_acf9c535d1f7ce2b5badf3b616683f8fb}{morlet2}} (M, s, w=5)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ad7d0d3a944a75bf5ed9a72e178e61f05}{cwt}} (data, wavelet, widths, dtype=None, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ac760a1ad0ace9c7b05cb1e3b2f6e6d65}{\+\_\+\+\_\+all\+\_\+\+\_\+}} = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a1ddaf84a9500f37120ad1ea60d9a44b4}{daub}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a206eb1106499b934885c7f502a91134b}{qmf}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a985cb37604ad304f33698d8c37a28454}{cascade}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a486bcbeaae06e28136dc9598e28d9f0c}{morlet}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ac519a29940a04c86e800210c8b5a4c21}{ricker}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_acf9c535d1f7ce2b5badf3b616683f8fb}{morlet2}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ad7d0d3a944a75bf5ed9a72e178e61f05}{cwt}}\textquotesingle{}\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_a985cb37604ad304f33698d8c37a28454}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!cascade@{cascade}}
\index{cascade@{cascade}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{cascade()}{cascade()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_a985cb37604ad304f33698d8c37a28454} 
scipy.\+signal.\+\_\+wavelets.\+cascade (\begin{DoxyParamCaption}\item[{}]{hk}{, }\item[{}]{J}{ = {\ttfamily 7}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return (x, phi, psi) at dyadic points ``K/2**J`` from filter coefficients.

Parameters
----------
hk : array_like
    Coefficients of low-pass filter.
J : int, optional
    Values will be computed at grid points ``K/2**J``. Default is 7.

Returns
-------
x : ndarray
    The dyadic points ``K/2**J`` for ``K=0...N * (2**J)-1`` where
    ``len(hk) = len(gk) = N+1``.
phi : ndarray
    The scaling function ``phi(x)`` at `x`:
    ``phi(x) = sum(hk * phi(2x-k))``, where k is from 0 to N.
psi : ndarray, optional
    The wavelet function ``psi(x)`` at `x`:
    ``phi(x) = sum(gk * phi(2x-k))``, where k is from 0 to N.
    `psi` is only returned if `gk` is not None.

Notes
-----
The algorithm uses the vector cascade algorithm described by Strang and
Nguyen in "Wavelets and Filter Banks".  It builds a dictionary of values
and slices for quick reuse.  Then inserts vectors into final vector at the
end.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00098}{98}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.



References \mbox{\hyperlink{__wavelets_8py_source_l00078}{qmf()}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_ad7d0d3a944a75bf5ed9a72e178e61f05}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!cwt@{cwt}}
\index{cwt@{cwt}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{cwt()}{cwt()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_ad7d0d3a944a75bf5ed9a72e178e61f05} 
scipy.\+signal.\+\_\+wavelets.\+cwt (\begin{DoxyParamCaption}\item[{}]{data}{, }\item[{}]{wavelet}{, }\item[{}]{widths}{, }\item[{}]{dtype}{ = {\ttfamily None}, }\item[{\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{kwargs}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Continuous wavelet transform.

Performs a continuous wavelet transform on `data`,
using the `wavelet` function. A CWT performs a convolution
with `data` using the `wavelet` function, which is characterized
by a width parameter and length parameter. The `wavelet` function
is allowed to be complex.

Parameters
----------
data : (N,) ndarray
    data on which to perform the transform.
wavelet : function
    Wavelet function, which should take 2 arguments.
    The first argument is the number of points that the returned vector
    will have (len(wavelet(length,width)) == length).
    The second is a width parameter, defining the size of the wavelet
    (e.g. standard deviation of a gaussian). See `ricker`, which
    satisfies these requirements.
widths : (M,) sequence
    Widths to use for transform.
dtype : data-type, optional
    The desired data type of output. Defaults to ``float64`` if the
    output of `wavelet` is real and ``complex128`` if it is complex.

    .. versionadded:: 1.4.0

kwargs
    Keyword arguments passed to wavelet function.

    .. versionadded:: 1.4.0

Returns
-------
cwt: (M, N) ndarray
    Will have shape of (len(widths), len(data)).

Notes
-----

.. versionadded:: 1.4.0

For non-symmetric, complex-valued wavelets, the input signal is convolved
with the time-reversed complex-conjugate of the wavelet data [1].

::

    length = min(10 * width[ii], len(data))
    cwt[ii,:] = signal.convolve(data, np.conj(wavelet(length, width[ii],
                                    **kwargs))[::-1], mode='same')

References
----------
.. [1] S. Mallat, "A Wavelet Tour of Signal Processing (3rd Edition)",
    Academic Press, 2009.

Examples
--------
>>> import numpy as np
>>> from scipy import signal
>>> import matplotlib.pyplot as plt
>>> t = np.linspace(-1, 1, 200, endpoint=False)
>>> sig  = np.cos(2 * np.pi * 7 * t) + signal.gausspulse(t - 0.4, fc=2)
>>> widths = np.arange(1, 31)
>>> cwtmatr = signal.cwt(sig, signal.ricker, widths)

.. note:: For cwt matrix plotting it is advisable to flip the y-axis

>>> cwtmatr_yflip = np.flipud(cwtmatr)
>>> plt.imshow(cwtmatr_yflip, extent=[-1, 1, 1, 31], cmap='PRGn', aspect='auto',
...            vmax=abs(cwtmatr).max(), vmin=-abs(cwtmatr).max())
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00407}{407}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.



References \mbox{\hyperlink{__signaltools_8py_source_l01299}{scipy.\+signal.\+\_\+signaltools.\+convolve()}}.



Referenced by \mbox{\hyperlink{__peak__finding_8py_source_l01202}{scipy.\+signal.\+\_\+peak\+\_\+finding.\+find\+\_\+peaks\+\_\+cwt()}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_a1ddaf84a9500f37120ad1ea60d9a44b4}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!daub@{daub}}
\index{daub@{daub}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{daub()}{daub()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_a1ddaf84a9500f37120ad1ea60d9a44b4} 
scipy.\+signal.\+\_\+wavelets.\+daub (\begin{DoxyParamCaption}\item[{}]{p}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}The coefficients for the FIR low-pass filter producing Daubechies wavelets.

p>=1 gives the order of the zero at f=1/2.
There are 2p filter coefficients.

Parameters
----------
p : int
    Order of the zero at f=1/2, can have values from 1 to 34.

Returns
-------
daub : ndarray
    Return
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00009}{9}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_a486bcbeaae06e28136dc9598e28d9f0c}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!morlet@{morlet}}
\index{morlet@{morlet}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{morlet()}{morlet()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_a486bcbeaae06e28136dc9598e28d9f0c} 
scipy.\+signal.\+\_\+wavelets.\+morlet (\begin{DoxyParamCaption}\item[{}]{M}{, }\item[{}]{w}{ = {\ttfamily 5.0}, }\item[{}]{s}{ = {\ttfamily 1.0}, }\item[{}]{complete}{ = {\ttfamily \mbox{\hyperlink{classTrue}{True}}}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Complex Morlet wavelet.

Parameters
----------
M : int
    Length of the wavelet.
w : float, optional
    Omega0. Default is 5
s : float, optional
    Scaling factor, windowed from ``-s*2*pi`` to ``+s*2*pi``. Default is 1.
complete : bool, optional
    Whether to use the complete or the standard version.

Returns
-------
morlet : (M,) ndarray

See Also
--------
morlet2 : Implementation of Morlet wavelet, compatible with `cwt`.
scipy.signal.gausspulse

Notes
-----
The standard version::

    pi**-0.25 * exp(1j*w*x) * exp(-0.5*(x**2))

This commonly used wavelet is often referred to simply as the
Morlet wavelet.  Note that this simplified version can cause
admissibility problems at low values of `w`.

The complete version::

    pi**-0.25 * (exp(1j*w*x) - exp(-0.5*(w**2))) * exp(-0.5*(x**2))

This version has a correction
term to improve admissibility. For `w` greater than 5, the
correction term is negligible.

Note that the energy of the return wavelet is not normalised
according to `s`.

The fundamental frequency of this wavelet in Hz is given
by ``f = 2*s*w*r / M`` where `r` is the sampling rate.

Note: This function was created before `cwt` and is not compatible
with it.

Examples
--------
>>> from scipy import signal
>>> import matplotlib.pyplot as plt

>>> M = 100
>>> s = 4.0
>>> w = 2.0
>>> wavelet = signal.morlet(M, s, w)
>>> plt.plot(wavelet.real, label="real")
>>> plt.plot(wavelet.imag, label="imag")
>>> plt.legend()
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00204}{204}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_acf9c535d1f7ce2b5badf3b616683f8fb}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!morlet2@{morlet2}}
\index{morlet2@{morlet2}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{morlet2()}{morlet2()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_acf9c535d1f7ce2b5badf3b616683f8fb} 
scipy.\+signal.\+\_\+wavelets.\+morlet2 (\begin{DoxyParamCaption}\item[{}]{M}{, }\item[{}]{s}{, }\item[{}]{w}{ = {\ttfamily 5}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Complex Morlet wavelet, designed to work with `cwt`.

Returns the complete version of morlet wavelet, normalised
according to `s`::

    exp(1j*w*x/s) * exp(-0.5*(x/s)**2) * pi**(-0.25) * sqrt(1/s)

Parameters
----------
M : int
    Length of the wavelet.
s : float
    Width parameter of the wavelet.
w : float, optional
    Omega0. Default is 5

Returns
-------
morlet : (M,) ndarray

See Also
--------
morlet : Implementation of Morlet wavelet, incompatible with `cwt`

Notes
-----

.. versionadded:: 1.4.0

This function was designed to work with `cwt`. Because `morlet2`
returns an array of complex numbers, the `dtype` argument of `cwt`
should be set to `complex128` for best results.

Note the difference in implementation with `morlet`.
The fundamental frequency of this wavelet in Hz is given by::

    f = w*fs / (2*s*np.pi)

where ``fs`` is the sampling rate and `s` is the wavelet width parameter.
Similarly we can get the wavelet width parameter at ``f``::

    s = w*fs / (2*f*np.pi)

Examples
--------
>>> import numpy as np
>>> from scipy import signal
>>> import matplotlib.pyplot as plt

>>> M = 100
>>> s = 4.0
>>> w = 2.0
>>> wavelet = signal.morlet2(M, s, w)
>>> plt.plot(abs(wavelet))
>>> plt.show()

This example shows basic use of `morlet2` with `cwt` in time-frequency
analysis:

>>> t, dt = np.linspace(0, 1, 200, retstep=True)
>>> fs = 1/dt
>>> w = 6.
>>> sig = np.cos(2*np.pi*(50 + 10*t)*t) + np.sin(40*np.pi*t)
>>> freq = np.linspace(1, fs/2, 100)
>>> widths = w*fs / (2*freq*np.pi)
>>> cwtm = signal.cwt(sig, signal.morlet2, widths, w=w)
>>> plt.pcolormesh(t, freq, np.abs(cwtm), cmap='viridis', shading='gouraud')
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00328}{328}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_a206eb1106499b934885c7f502a91134b}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!qmf@{qmf}}
\index{qmf@{qmf}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{qmf()}{qmf()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_a206eb1106499b934885c7f502a91134b} 
scipy.\+signal.\+\_\+wavelets.\+qmf (\begin{DoxyParamCaption}\item[{}]{hk}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return high-pass qmf filter from low-pass

Parameters
----------
hk : array_like
    Coefficients of high-pass filter.

Returns
-------
array_like
    High-pass filter coefficients.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00078}{78}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.



Referenced by \mbox{\hyperlink{__wavelets_8py_source_l00098}{cascade()}}.

\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_ac519a29940a04c86e800210c8b5a4c21}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!ricker@{ricker}}
\index{ricker@{ricker}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{ricker()}{ricker()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_ac519a29940a04c86e800210c8b5a4c21} 
scipy.\+signal.\+\_\+wavelets.\+ricker (\begin{DoxyParamCaption}\item[{}]{points}{, }\item[{}]{a}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return a Ricker wavelet, also known as the "Mexican hat wavelet".

It models the function:

    ``A * (1 - (x/a)**2) * exp(-0.5*(x/a)**2)``,

where ``A = 2/(sqrt(3*a)*(pi**0.25))``.

Parameters
----------
points : int
    Number of points in `vector`.
    Will be centered around 0.
a : scalar
    Width parameter of the wavelet.

Returns
-------
vector : (N,) ndarray
    Array of length `points` in shape of ricker curve.

Examples
--------
>>> from scipy import signal
>>> import matplotlib.pyplot as plt

>>> points = 100
>>> a = 4.0
>>> vec2 = signal.ricker(points, a)
>>> print(len(vec2))
100
>>> plt.plot(vec2)
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00281}{281}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.



\doxysubsection{Variable Documentation}
\Hypertarget{namespacescipy_1_1signal_1_1__wavelets_ac760a1ad0ace9c7b05cb1e3b2f6e6d65}\index{scipy.signal.\_wavelets@{scipy.signal.\_wavelets}!\_\_all\_\_@{\_\_all\_\_}}
\index{\_\_all\_\_@{\_\_all\_\_}!scipy.signal.\_wavelets@{scipy.signal.\_wavelets}}
\doxysubsubsection{\texorpdfstring{\_\_all\_\_}{\_\_all\_\_}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__wavelets_ac760a1ad0ace9c7b05cb1e3b2f6e6d65} 
list scipy.\+signal.\+\_\+wavelets.\+\_\+\+\_\+all\+\_\+\+\_\+ = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a1ddaf84a9500f37120ad1ea60d9a44b4}{daub}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a206eb1106499b934885c7f502a91134b}{qmf}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a985cb37604ad304f33698d8c37a28454}{cascade}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_a486bcbeaae06e28136dc9598e28d9f0c}{morlet}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ac519a29940a04c86e800210c8b5a4c21}{ricker}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_acf9c535d1f7ce2b5badf3b616683f8fb}{morlet2}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__wavelets_ad7d0d3a944a75bf5ed9a72e178e61f05}{cwt}}\textquotesingle{}\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{__wavelets_8py_source_l00006}{6}} of file \mbox{\hyperlink{__wavelets_8py_source}{\+\_\+wavelets.\+py}}.

