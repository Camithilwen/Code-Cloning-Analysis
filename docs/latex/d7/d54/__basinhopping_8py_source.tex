\doxysection{\+\_\+basinhopping.\+py}
\hypertarget{__basinhopping_8py_source}{}\label{__basinhopping_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_basinhopping.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_basinhopping.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__basinhopping}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00002}00002\ \textcolor{stringliteral}{basinhopping:\ The\ basinhopping\ global\ optimization\ algorithm}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00004}00004\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00005}00005\ \textcolor{keyword}{import}\ math}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00006}00006\ \textcolor{keyword}{import}\ inspect}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00007}00007\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1__lib_1_1__util}{scipy.\_lib.\_util}}\ \textcolor{keyword}{import}\ check\_random\_state}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00010}00010\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'basinhopping'}]}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00013}00013\ \_params\ =\ (inspect.Parameter(\textcolor{stringliteral}{'res\_new'},\ kind=inspect.Parameter.KEYWORD\_ONLY),}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00014}00014\ \ \ \ \ \ \ \ \ \ \ \ inspect.Parameter(\textcolor{stringliteral}{'res\_old'},\ kind=inspect.Parameter.KEYWORD\_ONLY))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00015}00015\ \_new\_accept\_test\_signature\ =\ inspect.Signature(parameters=\_params)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00018}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage}{00018}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage}{Storage}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00019}00019\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ Class\ used\ to\ store\ the\ lowest\ energy\ structure}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ minres):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_aedc2103a40bb4814432395c2fa46bbba}{\_add}}(minres)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{def\ }\_add(self,\ minres):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_a4a2c3203f207debf69eacd5ffcbb7505}{minres}}\ =\ minres}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_a4a2c3203f207debf69eacd5ffcbb7505}{minres}}.x\ =\ np.copy(minres.x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00029}00029\ \ \ \ \ \textcolor{keyword}{def\ }update(self,\ minres):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ minres.success\ \textcolor{keywordflow}{and}\ (minres.fun\ <\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_a4a2c3203f207debf69eacd5ffcbb7505}{minres}}.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_a4a2c3203f207debf69eacd5ffcbb7505}{minres}}.success):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_aedc2103a40bb4814432395c2fa46bbba}{\_add}}(minres)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00037}00037\ \ \ \ \ \textcolor{keyword}{def\ }get\_lowest(self):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage_a4a2c3203f207debf69eacd5ffcbb7505}{minres}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00041}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner}{00041}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner}{BasinHoppingRunner}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00042}00042\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}This\ class\ implements\ the\ core\ of\ the\ basinhopping\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00043}00043\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ x0\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ starting\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ minimizer\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ local\ minimizer,\ with\ signature\ \`{}\`{}result\ =\ minimizer(x)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ return\ value\ is\ an\ \`{}optimize.OptimizeResult\`{}\ object.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ step\_taking\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ function\ displaces\ the\ coordinates\ randomly.\ Signature\ should}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ \`{}\`{}x\_new\ =\ step\_taking(x)\`{}\`{}.\ Note\ that\ \`{}x\`{}\ may\ be\ modified\ in-\/place.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ accept\_tests\ :\ list\ of\ callables}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Each\ test\ is\ passed\ the\ kwargs\ \`{}f\_new\`{},\ \`{}x\_new\`{},\ \`{}f\_old\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}x\_old\`{}.\ These\ tests\ will\ be\ used\ to\ judge\ whether\ or\ not\ to\ accept}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ step.\ The\ acceptable\ return\ values\ are\ True,\ False,\ or\ \`{}\`{}"{}force}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ accept"{}\`{}\`{}.\ If\ any\ of\ the\ tests\ return\ False\ then\ the\ step\ is\ rejected.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}"{}force\ accept"{}\`{}\`{},\ then\ this\ will\ override\ any\ other\ tests\ in}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ order\ to\ accept\ the\ step.\ This\ can\ be\ used,\ for\ example,\ to\ forcefully}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ escape\ from\ a\ local\ minimum\ that\ \`{}\`{}basinhopping\`{}\`{}\ is\ trapped\ in.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ disp\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Display\ status\ messages.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00062}00062\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00064}00064\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ x0,\ minimizer,\ step\_taking,\ accept\_tests,\ disp=False):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}}\ =\ np.copy(x0)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a1b2912fd40092940be6d65c87e50b5eb}{minimizer}}\ =\ minimizer}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_addc75a36cc905ebf4b97f7db8e3b2038}{step\_taking}}\ =\ step\_taking}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5aebee93b77f27602f75f9aec9c02d69}{accept\_tests}}\ =\ accept\_tests}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a38498b8dd7adb0aa35bffd6c48cc85ce}{disp}}\ =\ disp}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac0ee5f2ac66dd7d1499761c1c3510a14}{nstep}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ initialize\ return\ object}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__optimize_1_1OptimizeResult}{scipy.optimize.OptimizeResult}}()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.minimization\_failures\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ do\ initial\ minimization}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ minres\ =\ minimizer(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ minres.success:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.minimization\_failures\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a38498b8dd7adb0aa35bffd6c48cc85ce}{disp}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}warning:\ basinhopping:\ local\ minimization\ failure"{}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}}\ =\ np.copy(minres.x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}}\ =\ minres.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5a53845df7c1e645ed9cd3b09dc6ad55}{incumbent\_minres}}\ =\ minres\ \ \textcolor{comment}{\#\ best\ minimize\ result\ found\ so\ far}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a38498b8dd7adb0aa35bffd6c48cc85ce}{disp}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}basinhopping\ step\ \%d:\ f\ \%g"{}}\ \%\ (self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac0ee5f2ac66dd7d1499761c1c3510a14}{nstep}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}}))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ initialize\ storage\ class}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5f3413a307aa2be3fdbe2fc42f43f215}{storage}}\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Storage}{Storage}}(minres)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}nfev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.nfev\ =\ minres.nfev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}njev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.njev\ =\ minres.njev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}nhev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.nhev\ =\ minres.nhev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00099}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a8621722e79b71be04948d86c5e0d82b1}{00099}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a8621722e79b71be04948d86c5e0d82b1}{\_monte\_carlo\_step}}(self):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Do\ one\ Monte\ Carlo\ iteration}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00101}00101\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Randomly\ displace\ the\ coordinates,\ minimize,\ and\ decide\ whether}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ or\ not\ to\ accept\ the\ new\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Take\ a\ random\ step.\ \ Make\ a\ copy\ of\ x\ because\ the\ step\_taking}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ algorithm\ might\ change\ x\ in\ place}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ x\_after\_step\ =\ np.copy(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ x\_after\_step\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_addc75a36cc905ebf4b97f7db8e3b2038}{step\_taking}}(x\_after\_step)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ do\ a\ local\ minimization}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ minres\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a1b2912fd40092940be6d65c87e50b5eb}{minimizer}}(x\_after\_step)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ x\_after\_quench\ =\ minres.x}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ energy\_after\_quench\ =\ minres.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ minres.success:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.minimization\_failures\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a38498b8dd7adb0aa35bffd6c48cc85ce}{disp}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}warning:\ basinhopping:\ local\ minimization\ failure"{}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}nfev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.nfev\ +=\ minres.nfev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}njev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.njev\ +=\ minres.njev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(minres,\ \textcolor{stringliteral}{"{}nhev"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_af12798c5465d35cc67dbac54b4fdf6bc}{res}}.nhev\ +=\ minres.nhev}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ accept\ the\ move\ based\ on\ self.accept\_tests.\ If\ any\ test\ is\ False,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ then\ reject\ the\ step.\ \ If\ any\ test\ returns\ the\ special\ string}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 'force\ accept',\ then\ accept\ the\ step\ regardless.\ This\ can\ be\ used}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ forcefully\ escape\ from\ a\ local\ minimum\ if\ normal\ basin\ hopping}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ steps\ are\ not\ sufficient.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ accept\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ test\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5aebee93b77f27602f75f9aec9c02d69}{accept\_tests}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ inspect.signature(test)\ ==\ \_new\_accept\_test\_signature:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testres\ =\ \mbox{\hyperlink{namespacetest}{test}}(res\_new=minres,\ res\_old=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5a53845df7c1e645ed9cd3b09dc6ad55}{incumbent\_minres}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testres\ =\ \mbox{\hyperlink{namespacetest}{test}}(f\_new=energy\_after\_quench,\ x\_new=x\_after\_quench,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\_old=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}},\ x\_old=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ testres\ ==\ \textcolor{stringliteral}{'force\ accept'}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ testres\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}accept\_tests\ must\ return\ True,\ False,\ or\ "{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}'force\ accept'"{}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{keywordflow}{not}\ testres:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Report\ the\ result\ of\ the\ acceptance\ test\ to\ the\ take\ step\ class.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ for\ adaptive\ step\ taking}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_addc75a36cc905ebf4b97f7db8e3b2038}{step\_taking}},\ \textcolor{stringliteral}{"{}report"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_addc75a36cc905ebf4b97f7db8e3b2038}{step\_taking}}.report(accept,\ f\_new=energy\_after\_quench,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_new=x\_after\_quench,\ f\_old=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}},}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_old=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ accept,\ minres}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00156}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_aae2c8c6c0c6462f04b961ddcf7aaf727}{00156}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_aae2c8c6c0c6462f04b961ddcf7aaf727}{one\_cycle}}(self):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Do\ one\ cycle\ of\ the\ basinhopping\ algorithm}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac0ee5f2ac66dd7d1499761c1c3510a14}{nstep}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ new\_global\_min\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ accept,\ minres\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a8621722e79b71be04948d86c5e0d82b1}{\_monte\_carlo\_step}}()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00163}00163\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ accept:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}}\ =\ minres.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a0cedd1dcabb923cdd1dd0311017bf952}{x}}\ =\ np.copy(minres.x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5a53845df7c1e645ed9cd3b09dc6ad55}{incumbent\_minres}}\ =\ minres\ \ \textcolor{comment}{\#\ best\ minimize\ result\ found\ so\ far}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ new\_global\_min\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5f3413a307aa2be3fdbe2fc42f43f215}{storage}}.update(minres)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ print\ some\ information}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a38498b8dd7adb0aa35bffd6c48cc85ce}{disp}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5b9bf9e5443a57427c6c7d4ecdcbc9ed}{print\_report}}(minres.fun,\ accept)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ new\_global\_min:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}found\ new\ global\ minimum\ on\ step\ \%d\ with\ function"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ value\ \%g"{}}\ \%\ (self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac0ee5f2ac66dd7d1499761c1c3510a14}{nstep}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}}))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ save\ some\ variables\ as\ BasinHoppingRunner\ attributes}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac3f512962103da46e1e2859ebc40ad1f}{xtrial}}\ =\ minres.x}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ae126fac59c3f43975b1c534650eb65ba}{energy\_trial}}\ =\ minres.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_aab55ad72469a157cdd18089e209bf9de}{accept}}\ =\ accept}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ new\_global\_min}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00184}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5b9bf9e5443a57427c6c7d4ecdcbc9ed}{00184}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5b9bf9e5443a57427c6c7d4ecdcbc9ed}{print\_report}}(self,\ energy\_trial,\ accept):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}print\ a\ status\ update"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ minres\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a5f3413a307aa2be3fdbe2fc42f43f215}{storage}}.get\_lowest()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}basinhopping\ step\ \%d:\ f\ \%g\ trial\_f\ \%g\ accepted\ \%d\ "{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ lowest\_f\ \%g"{}}\ \%\ (self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_ac0ee5f2ac66dd7d1499761c1c3510a14}{nstep}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner_a95695f7d5397a85840eeafa9bc940927}{energy}},\ energy\_trial,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept,\ minres.fun))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00191}00191\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00192}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize}{00192}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize}{AdaptiveStepsize}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00193}00193\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00194}00194\ \textcolor{stringliteral}{\ \ \ \ Class\ to\ implement\ adaptive\ stepsize.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00195}00195\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ This\ class\ wraps\ the\ step\ taking\ class\ and\ modifies\ the\ stepsize\ to}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ ensure\ the\ true\ acceptance\ rate\ is\ as\ close\ as\ possible\ to\ the\ target.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00198}00198\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ takestep\ :\ callable}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ step\ taking\ routine.\ \ Must\ contain\ modifiable\ attribute}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ takestep.stepsize}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ accept\_rate\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ target\ step\ acceptance\ rate}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ interval\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interval\ for\ how\ often\ to\ update\ the\ stepsize}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ factor\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ step\ size\ is\ multiplied\ or\ divided\ by\ this\ factor\ upon\ each}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ update.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ verbose\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Print\ information\ about\ each\ update}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00213}00213\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00215}00215\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ takestep,\ accept\_rate=0.5,\ interval=50,\ factor=0.9,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verbose=True):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}\ =\ takestep}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a742a08f538bcb508524c9fd2ec9db748}{target\_accept\_rate}}\ =\ accept\_rate}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa2ff25deaa1514748aa897a529c6d8b2}{interval}}\ =\ interval}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a96f4d2eb19f90d7da9957a1703502f36}{factor}}\ =\ factor}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a0fc1833897f80294d6b78e82177f286b}{verbose}}\ =\ verbose}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_adb16e33a585ebb1b324a07395e76502b}{nstep}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_ac723b541f871c573a0511eb84b324015}{nstep\_tot}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a0cd4aadeacf34398796d93eda3f8add7}{naccept}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00227}00227\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a35dcb75b2a7ee0d2c467a03f75bfa82a}{take\_step}}(x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00229}00229\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00230}00230\ \ \ \ \ \textcolor{keyword}{def\ }\_adjust\_step\_size(self):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ old\_stepsize\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}.stepsize}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ accept\_rate\ =\ float(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a0cd4aadeacf34398796d93eda3f8add7}{naccept}})\ /\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_adb16e33a585ebb1b324a07395e76502b}{nstep}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ accept\_rate\ >\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a742a08f538bcb508524c9fd2ec9db748}{target\_accept\_rate}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We're\ accepting\ too\ many\ steps.\ This\ generally\ means\ we're}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ trapped\ in\ a\ basin.\ Take\ bigger\ steps.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}.stepsize\ /=\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a96f4d2eb19f90d7da9957a1703502f36}{factor}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We're\ not\ accepting\ enough\ steps.\ Take\ smaller\ steps.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}.stepsize\ *=\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a96f4d2eb19f90d7da9957a1703502f36}{factor}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a0fc1833897f80294d6b78e82177f286b}{verbose}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}adaptive\ stepsize:\ acceptance\ rate\ \{:f\}\ target\ \{:f\}\ new\ "{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}stepsize\ \{:g\}\ old\ stepsize\ \{:g\}"{}}.format(accept\_rate,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a742a08f538bcb508524c9fd2ec9db748}{target\_accept\_rate}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}.stepsize,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_stepsize))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00245}00245\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00246}00246\ \ \ \ \ \textcolor{keyword}{def\ }take\_step(self,\ x):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_adb16e33a585ebb1b324a07395e76502b}{nstep}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_ac723b541f871c573a0511eb84b324015}{nstep\_tot}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_adb16e33a585ebb1b324a07395e76502b}{nstep}}\ \%\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa2ff25deaa1514748aa897a529c6d8b2}{interval}}\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_ade68efa3d77adcff79503295ebf181a3}{\_adjust\_step\_size}}()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_aa93c7f3a433bccfed715417c04e45795}{takestep}}(x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00252}00252\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00253}00253\ \ \ \ \ \textcolor{keyword}{def\ }report(self,\ accept,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}called\ by\ basinhopping\ to\ report\ the\ result\ of\ the\ step"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ accept:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize_a0cd4aadeacf34398796d93eda3f8add7}{naccept}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00258}00258\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00259}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement}{00259}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement}{RandomDisplacement}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00260}00260\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Add\ a\ random\ displacement\ of\ maximum\ size\ \`{}stepsize\`{}\ to\ each\ coordinate.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00261}00261\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ Calling\ this\ updates\ \`{}x\`{}\ in-\/place.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00263}00263\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ stepsize\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ stepsize\ in\ any\ dimension}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ random\_gen\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00270}00270\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ None\ (or\ \`{}np.random\`{}),\ the\ \`{}numpy.random.RandomState\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}seed\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}\ instance\ then}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00277}00277\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00278}00278\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00280}00280\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ stepsize=0.5,\ random\_gen=None):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement_a7a95c352140dd181c4ab950217134ffe}{stepsize}}\ =\ stepsize}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement_a14c4192f1fa9f773b014c70de62bef57}{random\_gen}}\ =\ check\_random\_state(random\_gen)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00283}00283\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00284}00284\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ x\ +=\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement_a14c4192f1fa9f773b014c70de62bef57}{random\_gen}}.uniform(-\/self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement_a7a95c352140dd181c4ab950217134ffe}{stepsize}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement_a7a95c352140dd181c4ab950217134ffe}{stepsize}},}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.shape(x))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00288}00288\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00290}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper}{00290}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper}{MinimizerWrapper}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00291}00291\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ wrap\ a\ minimizer\ function\ as\ a\ minimizer\ class}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00294}00294\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ minimizer,\ func=None,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_a37c13256f2724eacd50f5a1a5bfc47eb}{minimizer}}\ =\ minimizer}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_add644cb78613b1b95178d4a690ea77fc}{func}}\ =\ func}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_ab8236ab1ea2d705ed7b6a7ff9ed57519}{kwargs}}\ =\ kwargs}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00298}00298\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00299}00299\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x0):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_add644cb78613b1b95178d4a690ea77fc}{func}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_a37c13256f2724eacd50f5a1a5bfc47eb}{minimizer}}(x0,\ **self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_ab8236ab1ea2d705ed7b6a7ff9ed57519}{kwargs}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_a37c13256f2724eacd50f5a1a5bfc47eb}{minimizer}}(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_add644cb78613b1b95178d4a690ea77fc}{func}},\ x0,\ **self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper_ab8236ab1ea2d705ed7b6a7ff9ed57519}{kwargs}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00304}00304\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00306}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis}{00306}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis}{Metropolis}}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00307}00307\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Metropolis\ acceptance\ criterion.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00308}00308\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ T\ :\ float}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ "{}temperature"{}\ parameter\ for\ the\ accept\ or\ reject\ criterion.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ random\_gen\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00315}00315\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ None\ (or\ \`{}np.random\`{}),\ the\ \`{}numpy.random.RandomState\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}seed\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}\ instance\ then}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Random\ number\ generator\ used\ for\ acceptance\ test.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00323}00323\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00326}00326\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ T,\ random\_gen=None):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00327}00327\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Avoid\ ZeroDivisionError\ since\ "{}MBH\ can\ be\ regarded\ as\ a\ special\ case}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ the\ BH\ framework\ with\ the\ Metropolis\ criterion,\ where\ temperature}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ T\ =\ 0."{}\ (Reject\ all\ steps\ that\ increase\ energy.)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a825ab9e3090967ae2f26b44ae519005f}{beta}}\ =\ 1.0\ /\ T\ \textcolor{keywordflow}{if}\ T\ !=\ 0\ \textcolor{keywordflow}{else}\ float(\textcolor{stringliteral}{'inf'})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a6a363e74df2ad36dae5d8e96ffdfcea2}{random\_gen}}\ =\ check\_random\_state(random\_gen)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00332}00332\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00333}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a63c7e3303ca0b29d503c8c44b6369c9b}{00333}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a63c7e3303ca0b29d503c8c44b6369c9b}{accept\_reject}}(self,\ res\_new,\ res\_old):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Assuming\ the\ local\ search\ underlying\ res\_new\ was\ successful:}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ new\ energy\ is\ lower\ than\ old,\ it\ will\ always\ be\ accepted.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ new\ is\ higher\ than\ old,\ there\ is\ a\ chance\ it\ will\ be\ accepted,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ less\ likely\ for\ larger\ differences.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ energy\ values\ being\ fed\ to\ Metropolis\ are\ 1-\/length\ arrays,\ and\ if}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ they\ are\ equal,\ their\ difference\ is\ 0,\ which\ gets\ multiplied\ by\ beta,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ which\ is\ inf,\ and\ array([0])\ *\ float('inf')\ causes}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ RuntimeWarning:\ invalid\ value\ encountered\ in\ multiply}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Ignore\ this\ warning\ so\ when\ the\ algorithm\ is\ on\ a\ flat\ plane,\ it\ always}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ accepts\ the\ step,\ to\ try\ to\ move\ off\ the\ plane.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ prod\ =\ -\/(res\_new.fun\ -\/\ res\_old.fun)\ *\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a825ab9e3090967ae2f26b44ae519005f}{beta}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ math.exp(min(0,\ prod))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00351}00351\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ rand\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a6a363e74df2ad36dae5d8e96ffdfcea2}{random\_gen}}.uniform()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\ >=\ rand\ \textcolor{keywordflow}{and}\ (res\_new.success\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ res\_old.success)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00354}00354\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00355}\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_aac3a9f449a382ca3ba1ed595598f1d64}{00355}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_aac3a9f449a382ca3ba1ed595598f1d64}{\_\_call\_\_}}(self,\ *,\ res\_new,\ res\_old):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ f\_new\ and\ f\_old\ are\ mandatory\ in\ kwargs}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00359}00359\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ bool(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis_a63c7e3303ca0b29d503c8c44b6369c9b}{accept\_reject}}(res\_new,\ res\_old))}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00360}00360\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00361}00361\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00362}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__basinhopping_af8b0571db1fc5b5e4cd91116082e7d3c}{00362}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__basinhopping_af8b0571db1fc5b5e4cd91116082e7d3c}{basinhopping}}(func,\ x0,\ niter=100,\ T=1.0,\ stepsize=0.5,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=None,\ take\_step=None,\ accept\_test=None,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ callback=None,\ interval=50,\ disp=False,\ niter\_success=None,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=None,\ *,\ target\_accept\_rate=0.5,\ stepwise\_factor=0.9):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00366}00366\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Find\ the\ global\ minimum\ of\ a\ function\ using\ the\ basin-\/hopping\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00367}00367\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ Basin-\/hopping\ is\ a\ two-\/phase\ method\ that\ combines\ a\ global\ stepping}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ algorithm\ with\ local\ minimization\ at\ each\ step.\ Designed\ to\ mimic}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ the\ natural\ process\ of\ energy\ minimization\ of\ clusters\ of\ atoms,\ it\ works}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ well\ for\ similar\ problems\ with\ "{}funnel-\/like,\ but\ rugged"{}\ energy\ landscapes}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ [5]\_.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00373}00373\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ As\ the\ step-\/taking,\ step\ acceptance,\ and\ minimization\ methods\ are\ all}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ customizable,\ this\ function\ can\ also\ be\ used\ to\ implement\ other\ two-\/phase}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ methods.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00377}00377\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ func\ :\ callable\ \`{}\`{}f(x,\ *args)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Function\ to\ be\ optimized.\ \ \`{}\`{}args\`{}\`{}\ can\ be\ passed\ as\ an\ optional\ item}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ the\ dict\ \`{}minimizer\_kwargs\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ x0\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ guess.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ niter\ :\ integer,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ basin-\/hopping\ iterations.\ There\ will\ be\ a\ total\ of}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}niter\ +\ 1\`{}\`{}\ runs\ of\ the\ local\ minimizer.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ T\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ "{}temperature"{}\ parameter\ for\ the\ acceptance\ or\ rejection\ criterion.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Higher\ "{}temperatures"{}\ mean\ that\ larger\ jumps\ in\ function\ value\ will\ be}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ accepted.\ \ For\ best\ results\ \`{}T\`{}\ should\ be\ comparable\ to\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ separation\ (in\ function\ value)\ between\ local\ minima.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ stepsize\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ step\ size\ for\ use\ in\ the\ random\ displacement.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ minimizer\_kwargs\ :\ dict,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Extra\ keyword\ arguments\ to\ be\ passed\ to\ the\ local\ minimizer}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}scipy.optimize.minimize\`{}\ Some\ important\ options\ could\ be:}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00398}00398\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ method\ :\ str}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ The\ minimization\ method\ (e.g.\ \`{}\`{}"{}L-\/BFGS-\/B"{}\`{}\`{})}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ args\ :\ tuple}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Extra\ arguments\ passed\ to\ the\ objective\ function\ (\`{}func\`{})\ and}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ its\ derivatives\ (Jacobian,\ Hessian).}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00404}00404\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ take\_step\ :\ callable\ \`{}\`{}take\_step(x)\`{}\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Replace\ the\ default\ step-\/taking\ routine\ with\ this\ routine.\ The\ default}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ step-\/taking\ routine\ is\ a\ random\ displacement\ of\ the\ coordinates,\ but}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ other\ step-\/taking\ algorithms\ may\ be\ better\ for\ some\ systems.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}take\_step\`{}\ can\ optionally\ have\ the\ attribute\ \`{}\`{}take\_step.stepsize\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ this\ attribute\ exists,\ then\ \`{}basinhopping\`{}\ will\ adjust}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}take\_step.stepsize\`{}\`{}\ in\ order\ to\ try\ to\ optimize\ the\ global\ minimum}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ search.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ accept\_test\ :\ callable,\ \`{}\`{}accept\_test(f\_new=f\_new,\ x\_new=x\_new,\ f\_old=fold,\ x\_old=x\_old)\`{}\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Define\ a\ test\ which\ will\ be\ used\ to\ judge\ whether\ to\ accept\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ step.\ This\ will\ be\ used\ in\ addition\ to\ the\ Metropolis\ test\ based\ on}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00416}00416\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}temperature"{}\ \`{}T\`{}.\ The\ acceptable\ return\ values\ are\ True,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ False,\ or\ \`{}\`{}"{}force\ accept"{}\`{}\`{}.\ If\ any\ of\ the\ tests\ return\ False}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ then\ the\ step\ is\ rejected.\ If\ the\ latter,\ then\ this\ will\ override\ any}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ other\ tests\ in\ order\ to\ accept\ the\ step.\ This\ can\ be\ used,\ for\ example,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ forcefully\ escape\ from\ a\ local\ minimum\ that\ \`{}basinhopping\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ trapped\ in.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00422}00422\ \textcolor{stringliteral}{\ \ \ \ callback\ :\ callable,\ \`{}\`{}callback(x,\ f,\ accept)\`{}\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ callback\ function\ which\ will\ be\ called\ for\ all\ minima\ found.\ \`{}\`{}x\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ \`{}\`{}f\`{}\`{}\ are\ the\ coordinates\ and\ function\ value\ of\ the\ trial\ minimum,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ \`{}\`{}accept\`{}\`{}\ is\ whether\ that\ minimum\ was\ accepted.\ This\ can}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ used,\ for\ example,\ to\ save\ the\ lowest\ N\ minima\ found.\ Also,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}callback\`{}\ can\ be\ used\ to\ specify\ a\ user\ defined\ stop\ criterion\ by}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ optionally\ returning\ True\ to\ stop\ the\ \`{}basinhopping\`{}\ routine.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00429}00429\ \textcolor{stringliteral}{\ \ \ \ interval\ :\ integer,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ interval\ for\ how\ often\ to\ update\ the\ \`{}stepsize\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ disp\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ to\ True\ to\ print\ status\ messages}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ niter\_success\ :\ integer,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Stop\ the\ run\ if\ the\ global\ minimum\ candidate\ remains\ the\ same\ for\ this}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ of\ iterations.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00436}00436\ \textcolor{stringliteral}{\ \ \ \ seed\ :\ \{None,\ int,\ \`{}numpy.random.Generator\`{},\ \`{}numpy.random.RandomState\`{}\},\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00437}00437\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ None\ (or\ \`{}np.random\`{}),\ the\ \`{}numpy.random.RandomState\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ singleton\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ an\ int,\ a\ new\ \`{}\`{}RandomState\`{}\`{}\ instance\ is\ used,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ seeded\ with\ \`{}seed\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}seed\`{}\ is\ already\ a\ \`{}\`{}Generator\`{}\`{}\ or\ \`{}\`{}RandomState\`{}\`{}\ instance\ then}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ instance\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00444}00444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Specify\ \`{}seed\`{}\ for\ repeatable\ minimizations.\ The\ random\ numbers}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ generated\ with\ this\ seed\ only\ affect\ the\ default\ Metropolis}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00446}00446\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}accept\_test\`{}\ and\ the\ default\ \`{}take\_step\`{}.\ If\ you\ supply\ your\ own}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}take\_step\`{}\ and\ \`{}accept\_test\`{},\ and\ these\ functions\ use\ random}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00448}00448\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ generation,\ then\ those\ functions\ are\ responsible\ for\ the\ state}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ their\ random\ number\ generator.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ target\_accept\_rate\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ target\ acceptance\ rate\ that\ is\ used\ to\ adjust\ the\ \`{}stepsize\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ the\ current\ acceptance\ rate\ is\ greater\ than\ the\ target,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ then\ the\ \`{}stepsize\`{}\ is\ increased.\ Otherwise,\ it\ is\ decreased.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Range\ is\ (0,\ 1).\ Default\ is\ 0.5.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00455}00455\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00456}00456\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionadded::\ 1.8.0}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00457}00457\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ stepwise\_factor\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ \`{}stepsize\`{}\ is\ multiplied\ or\ divided\ by\ this\ stepwise\ factor\ upon}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ each\ update.\ Range\ is\ (0,\ 1).\ Default\ is\ 0.9.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00461}00461\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionadded::\ 1.8.0}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00463}00463\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00464}00464\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00465}00465\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ res\ :\ OptimizeResult}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00467}00467\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ optimization\ result\ represented\ as\ a\ \`{}OptimizeResult\`{}\ object.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Important\ attributes\ are:\ \`{}\`{}x\`{}\`{}\ the\ solution\ array,\ \`{}\`{}fun\`{}\`{}\ the\ value}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ the\ function\ at\ the\ solution,\ and\ \`{}\`{}message\`{}\`{}\ which\ describes\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00470}00470\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ cause\ of\ the\ termination.\ The\ \`{}\`{}OptimizeResult\`{}\`{}\ object\ returned\ by\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ selected\ minimizer\ at\ the\ lowest\ minimum\ is\ also\ contained\ within\ this}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ object\ and\ can\ be\ accessed\ through\ the\ \`{}\`{}lowest\_optimization\_result\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ attribute.\ \ See\ \`{}OptimizeResult\`{}\ for\ a\ description\ of\ other\ attributes.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00474}00474\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00477}00477\ \textcolor{stringliteral}{\ \ \ \ minimize\ :}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00478}00478\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ local\ minimization\ function\ called\ once\ for\ each\ basinhopping\ step.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00479}00479\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}minimizer\_kwargs\`{}\ is\ passed\ to\ this\ routine.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00480}00480\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ Basin-\/hopping\ is\ a\ stochastic\ algorithm\ which\ attempts\ to\ find\ the\ global}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ minimum\ of\ a\ smooth\ scalar\ function\ of\ one\ or\ more\ variables\ [1]\_\ [2]\_\ [3]\_}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ [4]\_.\ The\ algorithm\ in\ its\ current\ form\ was\ described\ by\ David\ Wales\ and}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ Jonathan\ Doye\ [2]\_\ http://www-\/wales.ch.cam.ac.uk/.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00487}00487\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ The\ algorithm\ is\ iterative\ with\ each\ cycle\ composed\ of\ the\ following}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ features}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00490}00490\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ 1)\ random\ perturbation\ of\ the\ coordinates}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00492}00492\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00493}00493\ \textcolor{stringliteral}{\ \ \ \ 2)\ local\ minimization}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00494}00494\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ 3)\ accept\ or\ reject\ the\ new\ coordinates\ based\ on\ the\ minimized\ function}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ \ \ \ value}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00497}00497\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ The\ acceptance\ test\ used\ here\ is\ the\ Metropolis\ criterion\ of\ standard\ Monte}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ Carlo\ algorithms,\ although\ there\ are\ many\ other\ possibilities\ [3]\_.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00500}00500\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ This\ global\ minimization\ method\ has\ been\ shown\ to\ be\ extremely\ efficient}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ for\ a\ wide\ variety\ of\ problems\ in\ physics\ and\ chemistry.\ It\ is}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ particularly\ useful\ when\ the\ function\ has\ many\ minima\ separated\ by\ large}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ barriers.\ See\ the\ \`{}Cambridge\ Cluster\ Database}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ <https://www-\/wales.ch.cam.ac.uk/CCD.html>\`{}\_\ for\ databases\ of\ molecular}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ systems\ that\ have\ been\ optimized\ primarily\ using\ basin-\/hopping.\ This}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ database\ includes\ minimization\ problems\ exceeding\ 300\ degrees\ of\ freedom.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00508}00508\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ See\ the\ free\ software\ program\ \`{}GMIN\ <https://www-\/wales.ch.cam.ac.uk/GMIN>\`{}\_}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ for\ a\ Fortran\ implementation\ of\ basin-\/hopping.\ This\ implementation\ has\ many}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00511}00511\ \textcolor{stringliteral}{\ \ \ \ variations\ of\ the\ procedure\ described\ above,\ including\ more}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ advanced\ step\ taking\ algorithms\ and\ alternate\ acceptance\ criterion.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00513}00513\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00514}00514\ \textcolor{stringliteral}{\ \ \ \ For\ stochastic\ global\ optimization\ there\ is\ no\ way\ to\ determine\ if\ the\ true}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00515}00515\ \textcolor{stringliteral}{\ \ \ \ global\ minimum\ has\ actually\ been\ found.\ Instead,\ as\ a\ consistency\ check,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00516}00516\ \textcolor{stringliteral}{\ \ \ \ the\ algorithm\ can\ be\ run\ from\ a\ number\ of\ different\ random\ starting\ points}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00517}00517\ \textcolor{stringliteral}{\ \ \ \ to\ ensure\ the\ lowest\ minimum\ found\ in\ each\ example\ has\ converged\ to\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ global\ minimum.\ For\ this\ reason,\ \`{}basinhopping\`{}\ will\ by\ default\ simply}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00519}00519\ \textcolor{stringliteral}{\ \ \ \ run\ for\ the\ number\ of\ iterations\ \`{}niter\`{}\ and\ return\ the\ lowest\ minimum}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00520}00520\ \textcolor{stringliteral}{\ \ \ \ found.\ It\ is\ left\ to\ the\ user\ to\ ensure\ that\ this\ is\ in\ fact\ the\ global}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00521}00521\ \textcolor{stringliteral}{\ \ \ \ minimum.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00522}00522\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ Choosing\ \`{}stepsize\`{}:\ \ This\ is\ a\ crucial\ parameter\ in\ \`{}basinhopping\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00524}00524\ \textcolor{stringliteral}{\ \ \ \ depends\ on\ the\ problem\ being\ solved.\ The\ step\ is\ chosen\ uniformly\ in\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ region\ from\ x0-\/stepsize\ to\ x0+stepsize,\ in\ each\ dimension.\ Ideally,\ it}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00526}00526\ \textcolor{stringliteral}{\ \ \ \ should\ be\ comparable\ to\ the\ typical\ separation\ (in\ argument\ values)\ between}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ local\ minima\ of\ the\ function\ being\ optimized.\ \`{}basinhopping\`{}\ will,\ by}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ default,\ adjust\ \`{}stepsize\`{}\ to\ find\ an\ optimal\ value,\ but\ this\ may\ take}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00529}00529\ \textcolor{stringliteral}{\ \ \ \ many\ iterations.\ You\ will\ get\ quicker\ results\ if\ you\ set\ a\ sensible}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ initial\ value\ for\ \`{}\`{}stepsize\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00531}00531\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ Choosing\ \`{}T\`{}:\ The\ parameter\ \`{}T\`{}\ is\ the\ "{}temperature"{}\ used\ in\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ Metropolis\ criterion.\ Basinhopping\ steps\ are\ always\ accepted\ if}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}func(xnew)\ <\ func(xold)\`{}\`{}.\ Otherwise,\ they\ are\ accepted\ with}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ probability::}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00536}00536\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00537}00537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ exp(\ -\/(func(xnew)\ -\/\ func(xold))\ /\ T\ )}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00538}00538\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00539}00539\ \textcolor{stringliteral}{\ \ \ \ So,\ for\ best\ results,\ \`{}T\`{}\ should\ to\ be\ comparable\ to\ the\ typical}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00540}00540\ \textcolor{stringliteral}{\ \ \ \ difference\ (in\ function\ values)\ between\ local\ minima.\ (The\ height\ of}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00541}00541\ \textcolor{stringliteral}{\ \ \ \ "{}walls"{}\ between\ local\ minima\ is\ irrelevant.)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00542}00542\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00543}00543\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}T\`{}\ is\ 0,\ the\ algorithm\ becomes\ Monotonic\ Basin-\/Hopping,\ in\ which\ all}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00544}00544\ \textcolor{stringliteral}{\ \ \ \ steps\ that\ increase\ energy\ are\ rejected.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00545}00545\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00546}00546\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.12.0}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00547}00547\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00548}00548\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00549}00549\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00550}00550\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Wales,\ David\ J.\ 2003,\ Energy\ Landscapes,\ Cambridge\ University\ Press,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00551}00551\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Cambridge,\ UK.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00552}00552\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ Wales,\ D\ J,\ and\ Doye\ J\ P\ K,\ Global\ Optimization\ by\ Basin-\/Hopping\ and}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00553}00553\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ Lowest\ Energy\ Structures\ of\ Lennard-\/Jones\ Clusters\ Containing\ up\ to}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00554}00554\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 110\ Atoms.\ \ Journal\ of\ Physical\ Chemistry\ A,\ 1997,\ 101,\ 5111.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00555}00555\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ Li,\ Z.\ and\ Scheraga,\ H.\ A.,\ Monte\ Carlo-\/minimization\ approach\ to\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00556}00556\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ multiple-\/minima\ problem\ in\ protein\ folding,\ Proc.\ Natl.\ Acad.\ Sci.\ USA,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00557}00557\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1987,\ 84,\ 6611.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00558}00558\ \textcolor{stringliteral}{\ \ \ \ ..\ [4]\ Wales,\ D.\ J.\ and\ Scheraga,\ H.\ A.,\ Global\ optimization\ of\ clusters,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00559}00559\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ crystals,\ and\ biomolecules,\ Science,\ 1999,\ 285,\ 1368.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ ..\ [5]\ Olson,\ B.,\ Hashmi,\ I.,\ Molloy,\ K.,\ and\ Shehu1,\ A.,\ Basin\ Hopping\ as}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00561}00561\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ General\ and\ Versatile\ Optimization\ Framework\ for\ the\ Characterization}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00562}00562\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ Biological\ Macromolecules,\ Advances\ in\ Artificial\ Intelligence,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00563}00563\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Volume\ 2012\ (2012),\ Article\ ID\ 674832,\ :doi:\`{}10.1155/2012/674832\`{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00564}00564\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00565}00565\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00566}00566\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00567}00567\ \textcolor{stringliteral}{\ \ \ \ The\ following\ example\ is\ a\ 1-\/D\ minimization\ problem,\ with\ many}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00568}00568\ \textcolor{stringliteral}{\ \ \ \ local\ minima\ superimposed\ on\ a\ parabola.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00569}00569\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00570}00570\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00571}00571\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.optimize\ import\ basinhopping}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00572}00572\ \textcolor{stringliteral}{\ \ \ \ >>>\ func\ =\ lambda\ x:\ np.cos(14.5\ *\ x\ -\/\ 0.3)\ +\ (x\ +\ 0.2)\ *\ x}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00573}00573\ \textcolor{stringliteral}{\ \ \ \ >>>\ x0\ =\ [1.]}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00574}00574\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00575}00575\ \textcolor{stringliteral}{\ \ \ \ Basinhopping,\ internally,\ uses\ a\ local\ minimization\ algorithm.\ We\ will\ use}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00576}00576\ \textcolor{stringliteral}{\ \ \ \ the\ parameter\ \`{}minimizer\_kwargs\`{}\ to\ tell\ basinhopping\ which\ algorithm\ to}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00577}00577\ \textcolor{stringliteral}{\ \ \ \ use\ and\ how\ to\ set\ up\ that\ minimizer.\ This\ parameter\ will\ be\ passed\ to}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00578}00578\ \textcolor{stringliteral}{\ \ \ \ \`{}scipy.optimize.minimize\`{}.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00579}00579\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00580}00580\ \textcolor{stringliteral}{\ \ \ \ >>>\ minimizer\_kwargs\ =\ \{"{}method"{}:\ "{}BFGS"{}\}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00581}00581\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ basinhopping(func,\ x0,\ minimizer\_kwargs=minimizer\_kwargs,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00582}00582\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ niter=200)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00583}00583\ \textcolor{stringliteral}{\ \ \ \ >>>\ print("{}global\ minimum:\ x\ =\ \%.4f,\ f(x)\ =\ \%.4f"{}\ \%\ (ret.x,\ ret.fun))}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00584}00584\ \textcolor{stringliteral}{\ \ \ \ global\ minimum:\ x\ =\ -\/0.1951,\ f(x)\ =\ -\/1.0009}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00585}00585\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00586}00586\ \textcolor{stringliteral}{\ \ \ \ Next\ consider\ a\ 2-\/D\ minimization\ problem.\ Also,\ this\ time,\ we}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00587}00587\ \textcolor{stringliteral}{\ \ \ \ will\ use\ gradient\ information\ to\ significantly\ speed\ up\ the\ search.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00588}00588\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00589}00589\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ func2d(x):}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00590}00590\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ f\ =\ np.cos(14.5\ *\ x[0]\ -\/\ 0.3)\ +\ (x[1]\ +\ 0.2)\ *\ x[1]\ +\ (x[0]\ +}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00591}00591\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.2)\ *\ x[0]}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00592}00592\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ df\ =\ np.zeros(2)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00593}00593\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ df[0]\ =\ -\/14.5\ *\ np.sin(14.5\ *\ x[0]\ -\/\ 0.3)\ +\ 2.\ *\ x[0]\ +\ 0.2}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00594}00594\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ df[1]\ =\ 2.\ *\ x[1]\ +\ 0.2}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00595}00595\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ return\ f,\ df}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00596}00596\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00597}00597\ \textcolor{stringliteral}{\ \ \ \ We'll\ also\ use\ a\ different\ local\ minimization\ algorithm.\ Also,\ we\ must\ tell}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00598}00598\ \textcolor{stringliteral}{\ \ \ \ the\ minimizer\ that\ our\ function\ returns\ both\ energy\ and\ gradient\ (Jacobian).}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00599}00599\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00600}00600\ \textcolor{stringliteral}{\ \ \ \ >>>\ minimizer\_kwargs\ =\ \{"{}method"{}:"{}L-\/BFGS-\/B"{},\ "{}jac"{}:True\}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00601}00601\ \textcolor{stringliteral}{\ \ \ \ >>>\ x0\ =\ [1.0,\ 1.0]}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00602}00602\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ basinhopping(func2d,\ x0,\ minimizer\_kwargs=minimizer\_kwargs,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00603}00603\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ niter=200)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00604}00604\ \textcolor{stringliteral}{\ \ \ \ >>>\ print("{}global\ minimum:\ x\ =\ [\%.4f,\ \%.4f],\ f(x)\ =\ \%.4f"{}\ \%\ (ret.x[0],}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00605}00605\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret.x[1],}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00606}00606\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret.fun))}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00607}00607\ \textcolor{stringliteral}{\ \ \ \ global\ minimum:\ x\ =\ [-\/0.1951,\ -\/0.1000],\ f(x)\ =\ -\/1.0109}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00608}00608\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00609}00609\ \textcolor{stringliteral}{\ \ \ \ Here\ is\ an\ example\ using\ a\ custom\ step-\/taking\ routine.\ Imagine\ you\ want}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00610}00610\ \textcolor{stringliteral}{\ \ \ \ the\ first\ coordinate\ to\ take\ larger\ steps\ than\ the\ rest\ of\ the\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00611}00611\ \textcolor{stringliteral}{\ \ \ \ This\ can\ be\ implemented\ like\ so:}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00612}00612\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00613}00613\ \textcolor{stringliteral}{\ \ \ \ >>>\ class\ MyTakeStep:}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00614}00614\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ def\ \_\_init\_\_(self,\ stepsize=0.5):}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00615}00615\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ self.stepsize\ =\ stepsize}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00616}00616\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ self.rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00617}00617\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ def\ \_\_call\_\_(self,\ x):}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00618}00618\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ s\ =\ self.stepsize}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00619}00619\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ x[0]\ +=\ self.rng.uniform(-\/2.*s,\ 2.*s)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00620}00620\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ x[1:]\ +=\ self.rng.uniform(-\/s,\ s,\ x[1:].shape)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00621}00621\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ return\ x}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00622}00622\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00623}00623\ \textcolor{stringliteral}{\ \ \ \ Since\ \`{}\`{}MyTakeStep.stepsize\`{}\`{}\ exists\ basinhopping\ will\ adjust\ the\ magnitude}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00624}00624\ \textcolor{stringliteral}{\ \ \ \ of\ \`{}stepsize\`{}\ to\ optimize\ the\ search.\ We'll\ use\ the\ same\ 2-\/D\ function\ as}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00625}00625\ \textcolor{stringliteral}{\ \ \ \ before}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00626}00626\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00627}00627\ \textcolor{stringliteral}{\ \ \ \ >>>\ mytakestep\ =\ MyTakeStep()}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00628}00628\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ basinhopping(func2d,\ x0,\ minimizer\_kwargs=minimizer\_kwargs,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00629}00629\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ niter=200,\ take\_step=mytakestep)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00630}00630\ \textcolor{stringliteral}{\ \ \ \ >>>\ print("{}global\ minimum:\ x\ =\ [\%.4f,\ \%.4f],\ f(x)\ =\ \%.4f"{}\ \%\ (ret.x[0],}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00631}00631\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret.x[1],}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00632}00632\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ret.fun))}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00633}00633\ \textcolor{stringliteral}{\ \ \ \ global\ minimum:\ x\ =\ [-\/0.1951,\ -\/0.1000],\ f(x)\ =\ -\/1.0109}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00634}00634\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00635}00635\ \textcolor{stringliteral}{\ \ \ \ Now,\ let's\ do\ an\ example\ using\ a\ custom\ callback\ function\ which\ prints\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00636}00636\ \textcolor{stringliteral}{\ \ \ \ value\ of\ every\ minimum\ found}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00637}00637\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00638}00638\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ print\_fun(x,\ f,\ accepted):}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00639}00639\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ print("{}at\ minimum\ \%.4f\ accepted\ \%d"{}\ \%\ (f,\ int(accepted)))}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00640}00640\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00641}00641\ \textcolor{stringliteral}{\ \ \ \ We'll\ run\ it\ for\ only\ 10\ basinhopping\ steps\ this\ time.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00642}00642\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00643}00643\ \textcolor{stringliteral}{\ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00644}00644\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ basinhopping(func2d,\ x0,\ minimizer\_kwargs=minimizer\_kwargs,}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00645}00645\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ niter=10,\ callback=print\_fun,\ seed=rng)}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00646}00646\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ 0.4159\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00647}00647\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.4317\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00648}00648\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/1.0109\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00649}00649\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.9073\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00650}00650\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.4317\ accepted\ 0}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00651}00651\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.1021\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00652}00652\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.7425\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00653}00653\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.9073\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00654}00654\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.4317\ accepted\ 0}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00655}00655\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.7425\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00656}00656\ \textcolor{stringliteral}{\ \ \ \ at\ minimum\ -\/0.9073\ accepted\ 1}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00657}00657\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00658}00658\ \textcolor{stringliteral}{\ \ \ \ The\ minimum\ at\ -\/1.0109\ is\ actually\ the\ global\ minimum,\ found\ already\ on\ the}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00659}00659\ \textcolor{stringliteral}{\ \ \ \ 8th\ iteration.}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00660}00660\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00661}00661\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00662}00662\ \ \ \ \ \textcolor{keywordflow}{if}\ target\_accept\_rate\ <=\ 0.\ \textcolor{keywordflow}{or}\ target\_accept\_rate\ >=\ 1.:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'target\_accept\_rate\ has\ to\ be\ in\ range\ (0,\ 1)'})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00664}00664\ \ \ \ \ \textcolor{keywordflow}{if}\ stepwise\_factor\ <=\ 0.\ \textcolor{keywordflow}{or}\ stepwise\_factor\ >=\ 1.:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'stepwise\_factor\ has\ to\ be\ in\ range\ (0,\ 1)'})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00666}00666\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00667}00667\ \ \ \ \ x0\ =\ np.array(x0)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00668}00668\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00669}00669\ \ \ \ \ \textcolor{comment}{\#\ set\ up\ the\ np.random\ generator}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00670}00670\ \ \ \ \ rng\ =\ check\_random\_state(seed)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00671}00671\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00672}00672\ \ \ \ \ \textcolor{comment}{\#\ set\ up\ minimizer}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00673}00673\ \ \ \ \ \textcolor{keywordflow}{if}\ minimizer\_kwargs\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ minimizer\_kwargs\ =\ dict()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00675}00675\ \ \ \ \ wrapped\_minimizer\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1MinimizerWrapper}{MinimizerWrapper}}(scipy.optimize.minimize,\ func,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00676}00676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ **minimizer\_kwargs)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00677}00677\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00678}00678\ \ \ \ \ \textcolor{comment}{\#\ set\ up\ step-\/taking\ algorithm}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00679}00679\ \ \ \ \ \textcolor{keywordflow}{if}\ take\_step\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ callable(take\_step):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}take\_step\ must\ be\ callable"{}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00682}00682\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ take\_step.stepsize\ exists\ then\ use\ AdaptiveStepsize\ to\ control}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ take\_step.stepsize}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00684}00684\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(take\_step,\ \textcolor{stringliteral}{"{}stepsize"{}}):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00685}00685\ \ \ \ \ \ \ \ \ \ \ \ \ take\_step\_wrapped\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize}{AdaptiveStepsize}}(}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00686}00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ take\_step,\ interval=interval,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00687}00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\_rate=target\_accept\_rate,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00688}00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ factor=stepwise\_factor,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verbose=disp)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00690}00690\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00691}00691\ \ \ \ \ \ \ \ \ \ \ \ \ take\_step\_wrapped\ =\ take\_step}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00692}00692\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00693}00693\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ use\ default}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ displace\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1RandomDisplacement}{RandomDisplacement}}(stepsize=stepsize,\ random\_gen=rng)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00695}00695\ \ \ \ \ \ \ \ \ take\_step\_wrapped\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1AdaptiveStepsize}{AdaptiveStepsize}}(displace,\ interval=interval,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\_rate=target\_accept\_rate,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00697}00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ factor=stepwise\_factor,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00698}00698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verbose=disp)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00699}00699\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00700}00700\ \ \ \ \ \textcolor{comment}{\#\ set\ up\ accept\ tests}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00701}00701\ \ \ \ \ accept\_tests\ =\ []}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00702}00702\ \ \ \ \ \textcolor{keywordflow}{if}\ accept\_test\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00703}00703\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ callable(accept\_test):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00704}00704\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}accept\_test\ must\ be\ callable"{}})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00705}00705\ \ \ \ \ \ \ \ \ accept\_tests\ =\ [accept\_test]}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00706}00706\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00707}00707\ \ \ \ \ \textcolor{comment}{\#\ use\ default}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00708}00708\ \ \ \ \ metropolis\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1Metropolis}{Metropolis}}(T,\ random\_gen=rng)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00709}00709\ \ \ \ \ accept\_tests.append(metropolis)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00710}00710\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00711}00711\ \ \ \ \ \textcolor{keywordflow}{if}\ niter\_success\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00712}00712\ \ \ \ \ \ \ \ \ niter\_success\ =\ niter\ +\ 2}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00713}00713\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00714}00714\ \ \ \ \ bh\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__basinhopping_1_1BasinHoppingRunner}{BasinHoppingRunner}}(x0,\ wrapped\_minimizer,\ take\_step\_wrapped,}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00715}00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\_tests,\ disp=disp)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00716}00716\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00717}00717\ \ \ \ \ \textcolor{comment}{\#\ The\ wrapped\ minimizer\ is\ called\ once\ during\ construction\ of}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00718}00718\ \ \ \ \ \textcolor{comment}{\#\ BasinHoppingRunner,\ so\ run\ the\ callback}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00719}00719\ \ \ \ \ \textcolor{keywordflow}{if}\ callable(callback):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00720}00720\ \ \ \ \ \ \ \ \ callback(bh.storage.minres.x,\ bh.storage.minres.fun,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00721}00721\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00722}00722\ \ \ \ \ \textcolor{comment}{\#\ start\ main\ iteration\ loop}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00723}00723\ \ \ \ \ count,\ i\ =\ 0,\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00724}00724\ \ \ \ \ message\ =\ [\textcolor{stringliteral}{"{}requested\ number\ of\ basinhopping\ iterations\ completed"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00725}00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ successfully"{}}]}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00726}00726\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(niter):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00727}00727\ \ \ \ \ \ \ \ \ new\_global\_min\ =\ bh.one\_cycle()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00728}00728\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00729}00729\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ callable(callback):}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ should\ we\ pass\ a\ copy\ of\ x?}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00731}00731\ \ \ \ \ \ \ \ \ \ \ \ \ val\ =\ callback(bh.xtrial,\ bh.energy\_trial,\ bh.accept)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ val\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ val:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ [\textcolor{stringliteral}{"{}callback\ function\ requested\ stop\ early\ by"{}}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00735}00735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}returning\ True"{}}]}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00736}00736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00737}00737\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00738}00738\ \ \ \ \ \ \ \ \ count\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00739}00739\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ new\_global\_min:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00740}00740\ \ \ \ \ \ \ \ \ \ \ \ \ count\ =\ 0}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00741}00741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ count\ >\ niter\_success:}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ [\textcolor{stringliteral}{"{}success\ condition\ satisfied"{}}]}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00744}00744\ }
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00745}00745\ \ \ \ \ \textcolor{comment}{\#\ prepare\ return\ object}}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00746}00746\ \ \ \ \ res\ =\ bh.res}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00747}00747\ \ \ \ \ res.lowest\_optimization\_result\ =\ bh.storage.get\_lowest()}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00748}00748\ \ \ \ \ res.x\ =\ np.copy(res.lowest\_optimization\_result.x)}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00749}00749\ \ \ \ \ res.fun\ =\ res.lowest\_optimization\_result.fun}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00750}00750\ \ \ \ \ res.message\ =\ message}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00751}00751\ \ \ \ \ res.nit\ =\ i\ +\ 1}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00752}00752\ \ \ \ \ res.success\ =\ res.lowest\_optimization\_result.success}
\DoxyCodeLine{\Hypertarget{__basinhopping_8py_source_l00753}00753\ \ \ \ \ \textcolor{keywordflow}{return}\ res}

\end{DoxyCode}
