\doxysection{test\+\_\+lambertw.\+py}
\hypertarget{test__lambertw_8py_source}{}\label{test__lambertw_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/special/tests/test\_lambertw.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/special/tests/test\_lambertw.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1special_1_1tests_1_1test__lambertw}{00001}}\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00002}00002\ \textcolor{comment}{\#\ Tests\ for\ the\ lambertw\ function,}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00003}00003\ \textcolor{comment}{\#\ Adapted\ from\ the\ MPMath\ tests\ [1]\ by\ Yosef\ Meller,\ mellerf@netvision.net.il}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00004}00004\ \textcolor{comment}{\#\ Distributed\ under\ the\ same\ license\ as\ SciPy\ itself.}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00005}00005\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00006}00006\ \textcolor{comment}{\#\ [1]\ mpmath\ source\ code,\ Subversion\ revision\ 992}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00007}00007\ \textcolor{comment}{\#\ \ \ \ \ http://code.google.com/p/mpmath/source/browse/trunk/mpmath/tests/test\_functions2.py?spec=svn994\&r=992}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00009}00009\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00010}00010\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_,\ assert\_equal,\ assert\_array\_almost\_equal}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00012}00012\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special}{scipy.special}}\ \textcolor{keyword}{import}\ lambertw}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00013}00013\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ nan,\ inf,\ pi,\ e,\ isnan,\ log,\ r\_,\ array,\ complex\_}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00015}00015\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special_1_1__testutils}{scipy.special.\_testutils}}\ \textcolor{keyword}{import}\ FuncData}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00018}00018\ \textcolor{keyword}{def\ }test\_values():}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00019}00019\ \ \ \ \ assert\_(isnan(lambertw(nan)))}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00020}00020\ \ \ \ \ assert\_equal(lambertw(inf,1).real,\ inf)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00021}00021\ \ \ \ \ assert\_equal(lambertw(inf,1).imag,\ 2*pi)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00022}00022\ \ \ \ \ assert\_equal(lambertw(-\/inf,1).real,\ inf)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00023}00023\ \ \ \ \ assert\_equal(lambertw(-\/inf,1).imag,\ 3*pi)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00025}00025\ \ \ \ \ assert\_equal(lambertw(1.),\ lambertw(1.,\ 0))}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00027}00027\ \ \ \ \ data\ =\ [}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ (0,0,\ 0),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ (0+0j,0,\ 0),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ (inf,0,\ inf),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ (0,-\/1,\ -\/inf),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ (0,1,\ -\/inf),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ (0,3,\ -\/inf),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ (e,0,\ 1),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ (1,0,\ 0.567143290409783873),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ (-\/pi/2,0,\ 1j*pi/2),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ (-\/log(2)/2,0,\ -\/log(2)),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ (0.25,0,\ 0.203888354702240164),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ (-\/0.25,0,\ -\/0.357402956181388903),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ (-\/1./10000,0,\ -\/0.000100010001500266719),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ (-\/0.25,-\/1,\ -\/2.15329236411034965),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ (0.25,-\/1,\ -\/3.00899800997004620-\/4.07652978899159763j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ (-\/0.25,-\/1,\ -\/2.15329236411034965),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ (0.25,1,\ -\/3.00899800997004620+4.07652978899159763j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ (-\/0.25,1,\ -\/3.48973228422959210+7.41405453009603664j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ (-\/4,0,\ 0.67881197132094523+1.91195078174339937j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ (-\/4,1,\ -\/0.66743107129800988+7.76827456802783084j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ (-\/4,-\/1,\ 0.67881197132094523-\/1.91195078174339937j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ (1000,0,\ 5.24960285240159623),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ (1000,1,\ 4.91492239981054535+5.44652615979447070j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ (1000,-\/1,\ 4.91492239981054535-\/5.44652615979447070j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ (1000,5,\ 3.5010625305312892+29.9614548941181328j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ (3+4j,0,\ 1.281561806123775878+0.533095222020971071j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ (-\/0.4+0.4j,0,\ -\/0.10396515323290657+0.61899273315171632j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ (3+4j,1,\ -\/0.11691092896595324+5.61888039871282334j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ (3+4j,-\/1,\ 0.25856740686699742-\/3.85211668616143559j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ (-\/0.5,-\/1,\ -\/0.794023632344689368-\/0.770111750510379110j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ (-\/1./10000,1,\ -\/11.82350837248724344+6.80546081842002101j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ (-\/1./10000,-\/1,\ -\/11.6671145325663544),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ (-\/1./10000,-\/2,\ -\/11.82350837248724344-\/6.80546081842002101j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ (-\/1./100000,4,\ -\/14.9186890769540539+26.1856750178782046j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ (-\/1./100000,5,\ -\/15.0931437726379218666+32.5525721210262290086j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ ((2+1j)/10,0,\ 0.173704503762911669+0.071781336752835511j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ ((2+1j)/10,1,\ -\/3.21746028349820063+4.56175438896292539j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ ((2+1j)/10,-\/1,\ -\/3.03781405002993088-\/3.53946629633505737j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ ((2+1j)/10,4,\ -\/4.6878509692773249+23.8313630697683291j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ (-\/(2+1j)/10,0,\ -\/0.226933772515757933-\/0.164986470020154580j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ (-\/(2+1j)/10,1,\ -\/2.43569517046110001+0.76974067544756289j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ (-\/(2+1j)/10,-\/1,\ -\/3.54858738151989450-\/6.91627921869943589j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ (-\/(2+1j)/10,4,\ -\/4.5500846928118151+20.6672982215434637j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ (pi,0,\ 1.073658194796149172092178407024821347547745350410314531),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Former\ bug\ in\ generated\ branch,}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ (-\/0.5+0.002j,0,\ -\/0.78917138132659918344\ +\ 0.76743539379990327749j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ (-\/0.5-\/0.002j,0,\ -\/0.78917138132659918344\ -\/\ 0.76743539379990327749j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ (-\/0.448+0.4j,0,\ -\/0.11855133765652382241\ +\ 0.66570534313583423116j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ (-\/0.448-\/0.4j,0,\ -\/0.11855133765652382241\ -\/\ 0.66570534313583423116j),}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00078}00078\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00079}00079\ \ \ \ \ data\ =\ array(data,\ dtype=complex\_)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00081}00081\ \ \ \ \ \textcolor{keyword}{def\ }w(x,\ y):}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lambertw(x,\ y.real.astype(int))}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00083}00083\ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(all=\textcolor{stringliteral}{'ignore'}):}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classscipy_1_1special_1_1__testutils_1_1FuncData}{FuncData}}(w,\ data,\ (0,1),\ 2,\ rtol=1e-\/10,\ atol=1e-\/13).check()}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00087}00087\ \textcolor{keyword}{def\ }test\_ufunc():}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00088}00088\ \ \ \ \ assert\_array\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ lambertw(r\_[0.,\ e,\ 1.]),\ r\_[0.,\ 1.,\ 0.567143290409783873])}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00092}00092\ \textcolor{keyword}{def\ }test\_lambertw\_ufunc\_loop\_selection():}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00093}00093\ \ \ \ \ \textcolor{comment}{\#\ see\ https://github.com/scipy/scipy/issues/4895}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00094}00094\ \ \ \ \ dt\ =\ np.dtype(np.complex128)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00095}00095\ \ \ \ \ assert\_equal(lambertw(0,\ 0,\ 0).dtype,\ dt)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00096}00096\ \ \ \ \ assert\_equal(lambertw([0],\ 0,\ 0).dtype,\ dt)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00097}00097\ \ \ \ \ assert\_equal(lambertw(0,\ [0],\ 0).dtype,\ dt)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00098}00098\ \ \ \ \ assert\_equal(lambertw(0,\ 0,\ [0]).dtype,\ dt)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00099}00099\ \ \ \ \ assert\_equal(lambertw([0],\ [0],\ [0]).dtype,\ dt)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00102}00102\ \textcolor{preprocessor}{@pytest.mark.parametrize('z',\ [1e-\/316,\ -\/2e-\/320j,\ -\/5e-\/318+1e-\/320j])}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00103}00103\ \textcolor{keyword}{def\ }test\_lambertw\_subnormal\_k0(z):}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00104}00104\ \ \ \ \ \textcolor{comment}{\#\ Verify\ that\ subnormal\ inputs\ are\ handled\ correctly\ on}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00105}00105\ \ \ \ \ \textcolor{comment}{\#\ the\ branch\ k=0\ (regression\ test\ for\ gh-\/16291).}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00106}00106\ \ \ \ \ w\ =\ lambertw(z)}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00107}00107\ \ \ \ \ \textcolor{comment}{\#\ For\ values\ this\ small,\ we\ can\ be\ sure\ that\ numerically,}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00108}00108\ \ \ \ \ \textcolor{comment}{\#\ lambertw(z)\ is\ z.}}
\DoxyCodeLine{\Hypertarget{test__lambertw_8py_source_l00109}00109\ \ \ \ \ \textcolor{keyword}{assert}\ w\ ==\ z}

\end{DoxyCode}
