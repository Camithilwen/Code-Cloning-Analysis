\doxysection{linalg.\+py}
\hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source}{}\label{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_compat/torch/linalg.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_compat/torch/linalg.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__compat_1_1torch_1_1linalg}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00003}00003\ \textcolor{keyword}{import}\ torch}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00004}00004\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ Optional,\ Union,\ Tuple}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00006}00006\ \textcolor{keyword}{from}\ torch.linalg\ \textcolor{keyword}{import}\ *\ \textcolor{comment}{\#\ noqa:\ F403}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00008}00008\ \textcolor{comment}{\#\ torch.linalg\ doesn't\ define\ \_\_all\_\_}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00009}00009\ \textcolor{comment}{\#\ from\ torch.linalg\ import\ \_\_all\_\_\ as\ linalg\_all}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00010}00010\ \textcolor{keyword}{from}\ torch\ \textcolor{keyword}{import}\ linalg\ \textcolor{keyword}{as}\ torch\_linalg}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00011}00011\ linalg\_all\ =\ [i\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ dir(torch\_linalg)\ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ i.startswith(\textcolor{stringliteral}{'\_'})]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00013}00013\ \textcolor{comment}{\#\ outer\ is\ implemented\ in\ torch\ but\ aren't\ in\ the\ linalg\ namespace}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00014}00014\ \textcolor{keyword}{from}\ torch\ \textcolor{keyword}{import}\ outer}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00015}00015\ \textcolor{keyword}{from}\ .\_aliases\ \textcolor{keyword}{import}\ \_fix\_promotion,\ sum}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00016}00016\ \textcolor{comment}{\#\ These\ functions\ are\ in\ both\ the\ main\ and\ linalg\ namespaces}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00017}00017\ \textcolor{keyword}{from}\ .\_aliases\ \textcolor{keyword}{import}\ matmul,\ matrix\_transpose,\ tensordot}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00018}00018\ \textcolor{keyword}{from}\ .\_typing\ \textcolor{keyword}{import}\ Array,\ DType}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00019}00019\ \textcolor{keyword}{from}\ ..common.\_typing\ \textcolor{keyword}{import}\ JustInt,\ JustFloat}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00021}00021\ \textcolor{comment}{\#\ Note:\ torch.linalg.cross\ does\ not\ default\ to\ axis=-\/1\ (it\ defaults\ to\ the}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00022}00022\ \textcolor{comment}{\#\ first\ axis\ with\ size\ 3),\ see\ https://github.com/pytorch/pytorch/issues/58743}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00024}00024\ \textcolor{comment}{\#\ torch.cross\ also\ does\ not\ support\ broadcasting\ when\ it\ would\ add\ new}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00025}00025\ \textcolor{comment}{\#\ dimensions\ https://github.com/pytorch/pytorch/issues/39656}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00026}00026\ \textcolor{keyword}{def\ }cross(x1:\ Array,\ x2:\ Array,\ /,\ *,\ axis:\ int\ =\ -\/1)\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00027}00027\ \ \ \ \ x1,\ x2\ =\ \_fix\_promotion(x1,\ x2,\ only\_scalar=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00028}00028\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ (-\/min(x1.ndim,\ x2.ndim)\ <=\ axis\ <\ max(x1.ndim,\ x2.ndim)):}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}axis\ \{axis\}\ out\ of\ bounds\ for\ cross\ product\ of\ arrays\ with\ shapes\ \{x1.shape\}\ and\ \{x2.shape\}"{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ (x1.shape[axis]\ ==\ x2.shape[axis]\ ==\ 3):}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{"{}cross\ product\ axis\ must\ have\ size\ 3,\ got\ \{x1.shape[axis]\}\ and\ \{x2.shape[axis]\}"{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00032}00032\ \ \ \ \ x1,\ x2\ =\ torch.broadcast\_tensors(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{return}\ torch\_linalg.cross(x1,\ x2,\ dim=axis)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00035}00035\ \textcolor{keyword}{def\ }vecdot(x1:\ Array,\ x2:\ Array,\ /,\ *,\ axis:\ int\ =\ -\/1,\ **kwargs)\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00036}00036\ \ \ \ \ \textcolor{keyword}{from}\ .\_aliases\ \textcolor{keyword}{import}\ isdtype}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00038}00038\ \ \ \ \ x1,\ x2\ =\ \_fix\_promotion(x1,\ x2,\ only\_scalar=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00040}00040\ \ \ \ \ \textcolor{comment}{\#\ torch.linalg.vecdot\ incorrectly\ allows\ broadcasting\ along\ the\ contracted\ dimension}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00041}00041\ \ \ \ \ \textcolor{keywordflow}{if}\ x1.shape[axis]\ !=\ x2.shape[axis]:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}x1\ and\ x2\ must\ have\ the\ same\ size\ along\ the\ given\ axis"{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00044}00044\ \ \ \ \ \textcolor{comment}{\#\ torch.linalg.vecdot\ doesn't\ support\ integer\ dtypes}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00045}00045\ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__compat_1_1torch_1_1__aliases_a1290b96a444fe6ef6c5cf3ebe7b83915}{isdtype}}(x1.dtype,\ \textcolor{stringliteral}{'integral'})\ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__compat_1_1torch_1_1__aliases_a1290b96a444fe6ef6c5cf3ebe7b83915}{isdtype}}(x2.dtype,\ \textcolor{stringliteral}{'integral'}):}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ kwargs:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classRuntimeError}{RuntimeError}}(\textcolor{stringliteral}{"{}vecdot\ kwargs\ not\ supported\ for\ integral\ dtypes"{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ x1\_\ =\ torch.moveaxis(x1,\ axis,\ -\/1)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ x2\_\ =\ torch.moveaxis(x2,\ axis,\ -\/1)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ x1\_,\ x2\_\ =\ torch.broadcast\_tensors(x1\_,\ x2\_)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ res\ =\ x1\_[...,\ \textcolor{keywordtype}{None},\ :]\ @\ x2\_[...,\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res[...,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00055}00055\ \ \ \ \ \textcolor{keywordflow}{return}\ torch.linalg.vecdot(x1,\ x2,\ dim=axis,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00057}00057\ \textcolor{keyword}{def\ }solve(x1:\ Array,\ x2:\ Array,\ /,\ **kwargs)\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00058}00058\ \ \ \ \ x1,\ x2\ =\ \_fix\_promotion(x1,\ x2,\ only\_scalar=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ Torch\ tries\ to\ emulate\ NumPy\ 1\ solve\ behavior\ by\ using\ batched\ 1-\/D\ solve}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00060}00060\ \ \ \ \ \textcolor{comment}{\#\ whenever}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00061}00061\ \ \ \ \ \textcolor{comment}{\#\ 1.\ x1.ndim\ -\/\ 1\ ==\ x2.ndim}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00062}00062\ \ \ \ \ \textcolor{comment}{\#\ 2.\ x1.shape[:-\/1]\ ==\ x2.shape}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00063}00063\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00064}00064\ \ \ \ \ \textcolor{comment}{\#\ See\ linalg\_solve\_is\_vector\_rhs\ in}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00065}00065\ \ \ \ \ \textcolor{comment}{\#\ aten/src/ATen/native/LinearAlgebraUtils.h\ and}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00066}00066\ \ \ \ \ \textcolor{comment}{\#\ TORCH\_META\_FUNC(\_linalg\_solve\_ex)\ in}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00067}00067\ \ \ \ \ \textcolor{comment}{\#\ aten/src/ATen/native/BatchLinearAlgebra.cpp\ in\ the\ PyTorch\ source\ code.}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00068}00068\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00069}00069\ \ \ \ \ \textcolor{comment}{\#\ The\ easiest\ way\ to\ work\ around\ this\ is\ to\ prepend\ a\ size\ 1\ dimension\ to}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00070}00070\ \ \ \ \ \textcolor{comment}{\#\ x2,\ since\ x2\ is\ already\ one\ dimension\ less\ than\ x1.}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00071}00071\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00072}00072\ \ \ \ \ \textcolor{comment}{\#\ See\ https://github.com/pytorch/pytorch/issues/52915}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00073}00073\ \ \ \ \ \textcolor{keywordflow}{if}\ x2.ndim\ !=\ 1\ \textcolor{keywordflow}{and}\ x1.ndim\ -\/\ 1\ ==\ x2.ndim\ \textcolor{keywordflow}{and}\ x1.shape[:-\/1]\ ==\ x2.shape:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ x2\ =\ x2[\textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{return}\ torch.linalg.solve(x1,\ x2,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00077}00077\ \textcolor{comment}{\#\ torch.trace\ doesn't\ support\ the\ offset\ argument\ and\ doesn't\ support\ stacking}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00078}00078\ \textcolor{keyword}{def\ }trace(x:\ Array,\ /,\ *,\ offset:\ int\ =\ 0,\ dtype:\ Optional[DType]\ =\ \textcolor{keywordtype}{None})\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00079}00079\ \ \ \ \ \textcolor{comment}{\#\ Use\ our\ wrapped\ sum\ to\ make\ sure\ it\ does\ upcasting\ correctly}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ sum(torch.diagonal(x,\ offset=offset,\ dim1=-\/2,\ dim2=-\/1),\ axis=-\/1,\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00082}00082\ \textcolor{keyword}{def\ }vector\_norm(}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00083}00083\ \ \ \ \ x:\ Array,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00084}00084\ \ \ \ \ /,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00085}00085\ \ \ \ \ *,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00086}00086\ \ \ \ \ axis:\ Optional[Union[int,\ Tuple[int,\ ...]]]\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00087}00087\ \ \ \ \ keepdims:\ bool\ =\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00088}00088\ \ \ \ \ \textcolor{comment}{\#\ JustFloat\ stands\ for\ inf\ |\ -\/inf,\ which\ are\ not\ valid\ for\ Literal}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00089}00089\ \ \ \ \ ord:\ JustInt\ |\ JustFloat\ =\ 2,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00090}00090\ \ \ \ \ **kwargs,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00091}00091\ )\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00092}00092\ \ \ \ \ \textcolor{comment}{\#\ torch.vector\_norm\ incorrectly\ treats\ axis=()\ the\ same\ as\ axis=None}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00093}00093\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ ==\ ():}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ out\ =\ kwargs.get(\textcolor{stringliteral}{'out'})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ out\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ dtype\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x.dtype\ ==\ torch.complex64:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype\ =\ torch.float32}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ x.dtype\ ==\ torch.complex128:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype\ =\ torch.float64}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ out\ =\ torch.zeros\_like(x,\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ norm\ of\ a\ single\ scalar\ works\ out\ to\ abs(x)\ in\ every\ case\ except}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ ord=0,\ which\ is\ x\ !=\ 0.}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ord\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ out[:]\ =\ (x\ !=\ 0)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ out[:]\ =\ torch.abs(x)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ out}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{return}\ torch.linalg.vector\_norm(x,\ ord=ord,\ axis=axis,\ keepdim=keepdims,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00113}00113\ \_\_all\_\_\ =\ linalg\_all\ +\ [\textcolor{stringliteral}{'outer'},\ \textcolor{stringliteral}{'matmul'},\ \textcolor{stringliteral}{'matrix\_transpose'},\ \textcolor{stringliteral}{'tensordot'},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'cross'},\ \textcolor{stringliteral}{'vecdot'},\ \textcolor{stringliteral}{'solve'},\ \textcolor{stringliteral}{'trace'},\ \textcolor{stringliteral}{'vector\_norm'}]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00116}00116\ \_all\_ignore\ =\ [\textcolor{stringliteral}{'torch\_linalg'},\ \textcolor{stringliteral}{'sum'}]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00118}00118\ del\ linalg\_all}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00120}00120\ \textcolor{keyword}{def\ }\_\_dir\_\_()\ -\/>\ list[str]:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2torch_2linalg_8py_source_l00121}00121\ \ \ \ \ \textcolor{keywordflow}{return}\ \_\_all\_\_}

\end{DoxyCode}
