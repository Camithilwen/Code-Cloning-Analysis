\doxysection{\+\_\+lbfgsb\+\_\+py.\+py}
\hypertarget{__lbfgsb__py_8py_source}{}\label{__lbfgsb__py_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_lbfgsb\_py.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_lbfgsb\_py.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00002}00002\ \textcolor{stringliteral}{Functions}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00003}00003\ \textcolor{stringliteral}{-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00004}00004\ \textcolor{stringliteral}{..\ autosummary::}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00005}00005\ \textcolor{stringliteral}{\ \ \ :toctree:\ generated/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00006}00006\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00007}00007\ \textcolor{stringliteral}{\ \ \ \ fmin\_l\_bfgs\_b}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00008}00008\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00009}00009\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00036}00036\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00037}00037\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ array,\ asarray,\ float64,\ zeros}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00038}00038\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ \_lbfgsb}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00039}00039\ \textcolor{keyword}{from}\ .\_optimize\ \textcolor{keyword}{import}\ (MemoizeJac,\ OptimizeResult,\ \_call\_callback\_maybe\_halt,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_wrap\_callback,\ \_check\_unknown\_options,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_prepare\_scalar\_function)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00042}00042\ \textcolor{keyword}{from}\ .\_constraints\ \textcolor{keyword}{import}\ old\_bound\_to\_new}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00044}00044\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg}{scipy.sparse.linalg}}\ \textcolor{keyword}{import}\ LinearOperator}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00046}00046\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'fmin\_l\_bfgs\_b'},\ \textcolor{stringliteral}{'LbfgsInvHessProduct'}]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00049}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py_a577fc761e80b4a6d16727f96afc4fa05}{00049}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py_a577fc761e80b4a6d16727f96afc4fa05}{fmin\_l\_bfgs\_b}}(func,\ x0,\ fprime=None,\ args=(),}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ approx\_grad=0,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bounds=\textcolor{keywordtype}{None},\ m=10,\ factr=1e7,\ pgtol=1e-\/5,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ epsilon=1e-\/8,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iprint=-\/1,\ maxfun=15000,\ maxiter=15000,\ disp=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ callback=\textcolor{keywordtype}{None},\ maxls=20):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00055}00055\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ Minimize\ a\ function\ func\ using\ the\ L-\/BFGS-\/B\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00057}00057\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ func\ :\ callable\ f(x,*args)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Function\ to\ minimize.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ x0\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ guess.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ fprime\ :\ callable\ fprime(x,*args),\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ gradient\ of\ \`{}func\`{}.\ If\ None,\ then\ \`{}func\`{}\ returns\ the\ function}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ value\ and\ the\ gradient\ (\`{}\`{}f,\ g\ =\ func(x,\ *args)\`{}\`{}),\ unless}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}approx\_grad\`{}\ is\ True\ in\ which\ case\ \`{}func\`{}\ returns\ only\ \`{}\`{}f\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ args\ :\ sequence,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Arguments\ to\ pass\ to\ \`{}func\`{}\ and\ \`{}fprime\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ approx\_grad\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ approximate\ the\ gradient\ numerically\ (in\ which\ case}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}func\`{}\ returns\ only\ the\ function\ value).}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ bounds\ :\ list,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(min,\ max)\`{}\`{}\ pairs\ for\ each\ element\ in\ \`{}\`{}x\`{}\`{},\ defining}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ bounds\ on\ that\ parameter.\ Use\ None\ or\ +-\/inf\ for\ one\ of\ \`{}\`{}min\`{}\`{}\ or}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}max\`{}\`{}\ when\ there\ is\ no\ bound\ in\ that\ direction.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ m\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ maximum\ number\ of\ variable\ metric\ corrections}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ used\ to\ define\ the\ limited\ memory\ matrix.\ (The\ limited\ memory\ BFGS}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ method\ does\ not\ store\ the\ full\ hessian\ but\ uses\ this\ many\ terms\ in\ an}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ approximation\ to\ it.)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ factr\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ iteration\ stops\ when}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(f\string^k\ -\/\ f\string^\{k+1\})/max\{|f\string^k|,|f\string^\{k+1\}|,1\}\ <=\ factr\ *\ eps\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ \`{}\`{}eps\`{}\`{}\ is\ the\ machine\ precision,\ which\ is\ automatically}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ generated\ by\ the\ code.\ Typical\ values\ for\ \`{}factr\`{}\ are:\ 1e12\ for}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ low\ accuracy;\ 1e7\ for\ moderate\ accuracy;\ 10.0\ for\ extremely}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ high\ accuracy.\ See\ Notes\ for\ relationship\ to\ \`{}ftol\`{},\ which\ is\ exposed}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (instead\ of\ \`{}factr\`{})\ by\ the\ \`{}scipy.optimize.minimize\`{}\ interface\ to}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ L-\/BFGS-\/B.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ pgtol\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ iteration\ will\ stop\ when}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}max\{|proj\ g\_i\ |\ i\ =\ 1,\ ...,\ n\}\ <=\ pgtol\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ where\ \`{}\`{}pg\_i\`{}\`{}\ is\ the\ i-\/th\ component\ of\ the\ projected\ gradient.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ epsilon\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Step\ size\ used\ when\ \`{}approx\_grad\`{}\ is\ True,\ for\ numerically}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ calculating\ the\ gradient}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ iprint\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Controls\ the\ frequency\ of\ output.\ \`{}\`{}iprint\ <\ 0\`{}\`{}\ means\ no\ output;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 0\`{}\`{}\ \ \ \ print\ only\ one\ line\ at\ the\ last\ iteration;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}0\ <\ iprint\ <\ 99\`{}\`{}\ print\ also\ f\ and\ \`{}\`{}|proj\ g|\`{}\`{}\ every\ iprint\ iterations;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 99\`{}\`{}\ \ \ print\ details\ of\ every\ iteration\ except\ n-\/vectors;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 100\`{}\`{}\ \ print\ also\ the\ changes\ of\ active\ set\ and\ final\ x;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ >\ 100\`{}\`{}\ \ print\ details\ of\ every\ iteration\ including\ x\ and\ g.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ disp\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ zero,\ then\ no\ output.\ If\ a\ positive\ number,\ then\ this\ over-\/rides}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}iprint\`{}\ (i.e.,\ \`{}iprint\`{}\ gets\ the\ value\ of\ \`{}disp\`{}).}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ maxfun\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ function\ evaluations.\ Note\ that\ this\ function}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ may\ violate\ the\ limit\ because\ of\ evaluating\ gradients\ by\ numerical}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ differentiation.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ maxiter\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ callback\ :\ callable,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Called\ after\ each\ iteration,\ as\ \`{}\`{}callback(xk)\`{}\`{},\ where\ \`{}\`{}xk\`{}\`{}\ is\ the}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ current\ parameter\ vector.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ maxls\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ line\ search\ steps\ (per\ iteration).\ Default\ is\ 20.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00119}00119\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Estimated\ position\ of\ the\ minimum.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ f\ :\ float}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Value\ of\ \`{}func\`{}\ at\ the\ minimum.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ d\ :\ dict}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Information\ dictionary.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00128}00128\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ d['warnflag']\ is}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00130}00130\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ -\/\ 0\ if\ converged,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ -\/\ 1\ if\ too\ many\ function\ evaluations\ or\ too\ many\ iterations,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ -\/\ 2\ if\ stopped\ for\ another\ reason,\ given\ in\ d['task']}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00134}00134\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ d['grad']\ is\ the\ gradient\ at\ the\ minimum\ (should\ be\ 0\ ish)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ d['funcalls']\ is\ the\ number\ of\ function\ calls\ made.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ d['nit']\ is\ the\ number\ of\ iterations.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00138}00138\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ See\ also}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ minimize:\ Interface\ to\ minimization\ algorithms\ for\ multivariate}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ functions.\ See\ the\ 'L-\/BFGS-\/B'\ \`{}method\`{}\ in\ particular.\ Note\ that\ the}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}ftol\`{}\ option\ is\ made\ available\ via\ that\ interface,\ while\ \`{}factr\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ provided\ via\ this\ interface,\ where\ \`{}factr\`{}\ is\ the\ factor\ multiplying}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ default\ machine\ floating-\/point\ precision\ to\ arrive\ at\ \`{}ftol\`{}:}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}ftol\ =\ factr\ *\ numpy.finfo(float).eps\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00147}00147\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ License\ of\ L-\/BFGS-\/B\ (FORTRAN\ code):}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00151}00151\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ The\ version\ included\ here\ (in\ fortran\ code)\ is\ 3.0}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ (released\ April\ 25,\ 2011).\ It\ was\ written\ by\ Ciyou\ Zhu,\ Richard\ Byrd,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ and\ Jorge\ Nocedal\ <nocedal@ece.nwu.edu>.\ It\ carries\ the\ following}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ condition\ for\ use:}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00156}00156\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ This\ software\ is\ freely\ available,\ but\ we\ expect\ that\ all\ publications}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ describing\ work\ using\ this\ software,\ or\ all\ commercial\ products\ using\ it,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ quote\ at\ least\ one\ of\ the\ references\ given\ below.\ This\ software\ is\ released}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ under\ the\ BSD\ License.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00161}00161\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ *\ R.\ H.\ Byrd,\ P.\ Lu\ and\ J.\ Nocedal.\ A\ Limited\ Memory\ Algorithm\ for\ Bound}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ \ \ Constrained\ Optimization,\ (1995),\ SIAM\ Journal\ on\ Scientific\ and}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ \ \ Statistical\ Computing,\ 16,\ 5,\ pp.\ 1190-\/1208.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ *\ C.\ Zhu,\ R.\ H.\ Byrd\ and\ J.\ Nocedal.\ L-\/BFGS-\/B:\ Algorithm\ 778:\ L-\/BFGS-\/B,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ FORTRAN\ routines\ for\ large\ scale\ bound\ constrained\ optimization\ (1997),}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ \ \ ACM\ Transactions\ on\ Mathematical\ Software,\ 23,\ 4,\ pp.\ 550\ -\/\ 560.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ *\ J.L.\ Morales\ and\ J.\ Nocedal.\ L-\/BFGS-\/B:\ Remark\ on\ Algorithm\ 778:\ L-\/BFGS-\/B,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ FORTRAN\ routines\ for\ large\ scale\ bound\ constrained\ optimization\ (2011),}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ \ \ ACM\ Transactions\ on\ Mathematical\ Software,\ 38,\ 1.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00173}00173\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00175}00175\ \ \ \ \ \textcolor{comment}{\#\ handle\ fprime/approx\_grad}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00176}00176\ \ \ \ \ \textcolor{keywordflow}{if}\ approx\_grad:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ fun\ =\ func}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ jac\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00179}00179\ \ \ \ \ \textcolor{keywordflow}{elif}\ fprime\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ fun\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__optimize_1_1MemoizeJac}{MemoizeJac}}(func)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ jac\ =\ fun.derivative}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00182}00182\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ fun\ =\ func}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ jac\ =\ fprime}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00186}00186\ \ \ \ \ \textcolor{comment}{\#\ build\ options}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00187}00187\ \ \ \ \ callback\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__optimize_ad1f8fee294ebdb8f4608bd0fd21527e2}{\_wrap\_callback}}(callback)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00188}00188\ \ \ \ \ opts\ =\ \{\textcolor{stringliteral}{'disp'}:\ disp,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'iprint'}:\ iprint,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'maxcor'}:\ m,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ftol'}:\ factr\ *\ np.finfo(float).eps,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'gtol'}:\ pgtol,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'eps'}:\ epsilon,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'maxfun'}:\ maxfun,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'maxiter'}:\ maxiter,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'callback'}:\ callback,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'maxls'}:\ maxls\}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00199}00199\ \ \ \ \ res\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py_af8b51e06e060fcdd7ce8a447d35e836e}{\_minimize\_lbfgsb}}(fun,\ x0,\ args=args,\ jac=jac,\ bounds=bounds,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ **opts)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00201}00201\ \ \ \ \ d\ =\ \{\textcolor{stringliteral}{'grad'}:\ res[\textcolor{stringliteral}{'jac'}],}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'task'}:\ res[\textcolor{stringliteral}{'message'}],}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'funcalls'}:\ res[\textcolor{stringliteral}{'nfev'}],}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'nit'}:\ res[\textcolor{stringliteral}{'nit'}],}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'warnflag'}:\ res[\textcolor{stringliteral}{'status'}]\}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00206}00206\ \ \ \ \ f\ =\ res[\textcolor{stringliteral}{'fun'}]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00207}00207\ \ \ \ \ x\ =\ res[\textcolor{stringliteral}{'x'}]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00209}00209\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ f,\ d}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00212}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py_af8b51e06e060fcdd7ce8a447d35e836e}{00212}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lbfgsb__py_af8b51e06e060fcdd7ce8a447d35e836e}{\_minimize\_lbfgsb}}(fun,\ x0,\ args=(),\ jac=\textcolor{keywordtype}{None},\ bounds=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disp=\textcolor{keywordtype}{None},\ maxcor=10,\ ftol=2.2204460492503131e-\/09,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gtol=1e-\/5,\ eps=1e-\/8,\ maxfun=15000,\ maxiter=15000,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iprint=-\/1,\ callback=\textcolor{keywordtype}{None},\ maxls=20,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finite\_diff\_rel\_step=\textcolor{keywordtype}{None},\ **unknown\_options):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00217}00217\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ Minimize\ a\ scalar\ function\ of\ one\ or\ more\ variables\ using\ the\ L-\/BFGS-\/B}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ algorithm.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00220}00220\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ Options}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ disp\ :\ None\ or\ int}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}disp\ is\ None\`{}\ (the\ default),\ then\ the\ supplied\ version\ of\ \`{}iprint\`{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ used.\ If\ \`{}disp\ is\ not\ None\`{},\ then\ it\ overrides\ the\ supplied\ version}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ \`{}iprint\`{}\ with\ the\ behaviour\ you\ outlined.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ maxcor\ :\ int}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ maximum\ number\ of\ variable\ metric\ corrections\ used\ to}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ define\ the\ limited\ memory\ matrix.\ (The\ limited\ memory\ BFGS}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00230}00230\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ method\ does\ not\ store\ the\ full\ hessian\ but\ uses\ this\ many\ terms}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00231}00231\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ an\ approximation\ to\ it.)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00232}00232\ \textcolor{stringliteral}{\ \ \ \ ftol\ :\ float}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00233}00233\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ iteration\ stops\ when\ \`{}\`{}(f\string^k\ -\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ f\string^\{k+1\})/max\{|f\string^k|,|f\string^\{k+1\}|,1\}\ <=\ ftol\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00235}00235\ \textcolor{stringliteral}{\ \ \ \ gtol\ :\ float}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ iteration\ will\ stop\ when\ \`{}\`{}max\{|proj\ g\_i\ |\ i\ =\ 1,\ ...,\ n\}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ <=\ gtol\`{}\`{}\ where\ \`{}\`{}pg\_i\`{}\`{}\ is\ the\ i-\/th\ component\ of\ the}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ projected\ gradient.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00239}00239\ \textcolor{stringliteral}{\ \ \ \ eps\ :\ float\ or\ ndarray}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00240}00240\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}jac\ is\ None\`{}\ the\ absolute\ step\ size\ used\ for\ numerical}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ approximation\ of\ the\ jacobian\ via\ forward\ differences.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ maxfun\ :\ int}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ function\ evaluations.\ Note\ that\ this\ function}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ may\ violate\ the\ limit\ because\ of\ evaluating\ gradients\ by\ numerical}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ differentiation.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ maxiter\ :\ int}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ iprint\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Controls\ the\ frequency\ of\ output.\ \`{}\`{}iprint\ <\ 0\`{}\`{}\ means\ no\ output;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 0\`{}\`{}\ \ \ \ print\ only\ one\ line\ at\ the\ last\ iteration;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}0\ <\ iprint\ <\ 99\`{}\`{}\ print\ also\ f\ and\ \`{}\`{}|proj\ g|\`{}\`{}\ every\ iprint\ iterations;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 99\`{}\`{}\ \ \ print\ details\ of\ every\ iteration\ except\ n-\/vectors;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ =\ 100\`{}\`{}\ \ print\ also\ the\ changes\ of\ active\ set\ and\ final\ x;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}iprint\ >\ 100\`{}\`{}\ \ print\ details\ of\ every\ iteration\ including\ x\ and\ g.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ maxls\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ line\ search\ steps\ (per\ iteration).\ Default\ is\ 20.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ finite\_diff\_rel\_step\ :\ None\ or\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}jac\ in\ ['2-\/point',\ '3-\/point',\ 'cs']\`{}\ the\ relative\ step\ size\ to}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ use\ for\ numerical\ approximation\ of\ the\ jacobian.\ The\ absolute\ step}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ size\ is\ computed\ as\ \`{}\`{}h\ =\ rel\_step\ *\ sign(x)\ *\ max(1,\ abs(x))\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ possibly\ adjusted\ to\ fit\ into\ the\ bounds.\ For\ \`{}\`{}method='3-\/point'\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ sign\ of\ \`{}h\`{}\ is\ ignored.\ If\ None\ (default)\ then\ step\ is\ selected}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ automatically.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00264}00264\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ The\ option\ \`{}ftol\`{}\ is\ exposed\ via\ the\ \`{}scipy.optimize.minimize\`{}\ interface,}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ but\ calling\ \`{}scipy.optimize.fmin\_l\_bfgs\_b\`{}\ directly\ exposes\ \`{}factr\`{}.\ The}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ relationship\ between\ the\ two\ is\ \`{}\`{}ftol\ =\ factr\ *\ numpy.finfo(float).eps\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ I.e.,\ \`{}factr\`{}\ multiplies\ the\ default\ machine\ floating-\/point\ precision\ to}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ arrive\ at\ \`{}ftol\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00272}00272\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00274}00274\ \ \ \ \ \_check\_unknown\_options(unknown\_options)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00275}00275\ \ \ \ \ m\ =\ maxcor}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00276}00276\ \ \ \ \ pgtol\ =\ gtol}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00277}00277\ \ \ \ \ factr\ =\ ftol\ /\ np.finfo(float).eps}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00279}00279\ \ \ \ \ x0\ =\ asarray(x0).ravel()}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00280}00280\ \ \ \ \ n,\ =\ x0.shape}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00282}00282\ \ \ \ \ \textcolor{keywordflow}{if}\ bounds\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ bounds\ =\ [(\textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None})]\ *\ n}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00284}00284\ \ \ \ \ \textcolor{keywordflow}{if}\ len(bounds)\ !=\ n:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'length\ of\ x0\ !=\ length\ of\ bounds'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00287}00287\ \ \ \ \ \textcolor{comment}{\#\ unbounded\ variables\ must\ use\ None,\ not\ +-\/inf,\ for\ optimizer\ to\ work\ properly}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00288}00288\ \ \ \ \ bounds\ =\ [(\textcolor{keywordtype}{None}\ \textcolor{keywordflow}{if}\ l\ ==\ -\/np.inf\ \textcolor{keywordflow}{else}\ l,\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{if}\ u\ ==\ np.inf\ \textcolor{keywordflow}{else}\ u)\ \textcolor{keywordflow}{for}\ l,\ u\ \textcolor{keywordflow}{in}\ bounds]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00289}00289\ \ \ \ \ \textcolor{comment}{\#\ LBFGSB\ is\ sent\ 'old-\/style'\ bounds,\ 'new-\/style'\ bounds\ are\ required\ by}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00290}00290\ \ \ \ \ \textcolor{comment}{\#\ approx\_derivative\ and\ ScalarFunction}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00291}00291\ \ \ \ \ new\_bounds\ =\ old\_bound\_to\_new(bounds)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00292}00292\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00293}00293\ \ \ \ \ \textcolor{comment}{\#\ check\ bounds}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00294}00294\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_bounds[0]\ >\ new\_bounds[1]).any():}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}LBFGSB\ -\/\ one\ of\ the\ lower\ bounds\ is\ greater\ than\ an\ upper\ bound."{}})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00297}00297\ \ \ \ \ \textcolor{comment}{\#\ initial\ vector\ must\ lie\ within\ the\ bounds.\ Otherwise\ ScalarFunction\ and}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00298}00298\ \ \ \ \ \textcolor{comment}{\#\ approx\_derivative\ will\ cause\ problems}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00299}00299\ \ \ \ \ x0\ =\ np.clip(x0,\ new\_bounds[0],\ new\_bounds[1])}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00301}00301\ \ \ \ \ \textcolor{keywordflow}{if}\ disp\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ disp\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ iprint\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ iprint\ =\ disp}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00306}00306\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00307}00307\ \ \ \ \ sf\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__optimize_ad73454f855569a9ca1a9979e3d9b7a0a}{\_prepare\_scalar\_function}}(fun,\ x0,\ jac=jac,\ args=args,\ epsilon=eps,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bounds=new\_bounds,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finite\_diff\_rel\_step=finite\_diff\_rel\_step)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00310}00310\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00311}00311\ \ \ \ \ func\_and\_grad\ =\ sf.fun\_and\_grad}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00313}00313\ \ \ \ \ fortran\_int\ =\ \_lbfgsb.types.intvar.dtype}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00314}00314\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00315}00315\ \ \ \ \ nbd\ =\ zeros(n,\ fortran\_int)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00316}00316\ \ \ \ \ low\_bnd\ =\ zeros(n,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00317}00317\ \ \ \ \ upper\_bnd\ =\ zeros(n,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00318}00318\ \ \ \ \ bounds\_map\ =\ \{(\textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}):\ 0,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1,\ \textcolor{keywordtype}{None}):\ 1,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1,\ 1):\ 2,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{None},\ 1):\ 3\}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00322}00322\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(0,\ n):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00323}00323\ \ \ \ \ \ \ \ \ l,\ u\ =\ bounds[i]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ l\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ low\_bnd[i]\ =\ l}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ l\ =\ 1}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00327}00327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ u\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ upper\_bnd[i]\ =\ u}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ u\ =\ 1}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ nbd[i]\ =\ bounds\_map[l,\ u]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00332}00332\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ maxls\ >\ 0:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'maxls\ must\ be\ positive.'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00334}00334\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00335}00335\ \ \ \ \ x\ =\ array(x0,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00336}00336\ \ \ \ \ f\ =\ array(0.0,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00337}00337\ \ \ \ \ g\ =\ zeros((n,),\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00338}00338\ \ \ \ \ wa\ =\ zeros(2*m*n\ +\ 5*n\ +\ 11*m*m\ +\ 8*m,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00339}00339\ \ \ \ \ iwa\ =\ zeros(3*n,\ fortran\_int)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00340}00340\ \ \ \ \ task\ =\ zeros(1,\ \textcolor{stringliteral}{'S60'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00341}00341\ \ \ \ \ csave\ =\ zeros(1,\ \textcolor{stringliteral}{'S60'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00342}00342\ \ \ \ \ lsave\ =\ zeros(4,\ fortran\_int)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00343}00343\ \ \ \ \ isave\ =\ zeros(44,\ fortran\_int)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00344}00344\ \ \ \ \ dsave\ =\ zeros(29,\ float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00345}00345\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00346}00346\ \ \ \ \ task[:]\ =\ \textcolor{stringliteral}{'START'}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00347}00347\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00348}00348\ \ \ \ \ n\_iterations\ =\ 0}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00350}00350\ \ \ \ \ \textcolor{keywordflow}{while}\ 1:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ g\ may\ become\ float32\ if\ a\ user\ provides\ a\ function\ that\ calculates}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ Jacobian\ in\ float32\ (see\ gh-\/18730).\ The\ underlying\ Fortran\ code}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ expects\ float64,\ so\ upcast\ it}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ g\ =\ g.astype(np.float64)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ x,\ f,\ g,\ wa,\ iwa,\ task,\ csave,\ lsave,\ isave,\ dsave\ =\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \_lbfgsb.setulb(m,\ x,\ low\_bnd,\ upper\_bnd,\ nbd,\ f,\ g,\ factr,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pgtol,\ wa,\ iwa,\ task,\ iprint,\ csave,\ lsave,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ isave,\ dsave,\ maxls)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00359}00359\ \ \ \ \ \ \ \ \ task\_str\ =\ task.tobytes()}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ task\_str.startswith(b\textcolor{stringliteral}{'FG'}):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ minimization\ routine\ wants\ f\ and\ g\ at\ the\ current\ x.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ interruptions\ due\ to\ maxfun\ are\ postponed}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ until\ the\ completion\ of\ the\ current\ minimization\ iteration.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Overwrite\ f\ and\ g:}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \ \ \ \ f,\ g\ =\ func\_and\_grad(x)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ task\_str.startswith(b\textcolor{stringliteral}{'NEW\_X'}):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ new\ iteration}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ \ \ \ \ n\_iterations\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00369}00369\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ \ \ \ \ intermediate\_result\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__optimize_1_1OptimizeResult}{OptimizeResult}}(x=x,\ fun=f)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__optimize_a15df8b8131f027070766bef3407058fe}{\_call\_callback\_maybe\_halt}}(callback,\ intermediate\_result):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task[:]\ =\ \textcolor{stringliteral}{'STOP:\ CALLBACK\ REQUESTED\ HALT'}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00373}00373\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\_iterations\ >=\ maxiter:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00374}00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task[:]\ =\ \textcolor{stringliteral}{'STOP:\ TOTAL\ NO.\ of\ ITERATIONS\ REACHED\ LIMIT'}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ sf.nfev\ >\ maxfun:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00376}00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ task[:]\ =\ (\textcolor{stringliteral}{'STOP:\ TOTAL\ NO.\ of\ f\ AND\ g\ EVALUATIONS\ '}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'EXCEEDS\ LIMIT'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00378}00378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00379}00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00380}00380\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00381}00381\ \ \ \ \ task\_str\ =\ task.tobytes().strip(b\textcolor{stringliteral}{'\(\backslash\)x00'}).strip()}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00382}00382\ \ \ \ \ \textcolor{keywordflow}{if}\ task\_str.startswith(b\textcolor{stringliteral}{'CONV'}):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ warnflag\ =\ 0}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00384}00384\ \ \ \ \ \textcolor{keywordflow}{elif}\ sf.nfev\ >\ maxfun\ \textcolor{keywordflow}{or}\ n\_iterations\ >=\ maxiter:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ warnflag\ =\ 1}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00386}00386\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00387}00387\ \ \ \ \ \ \ \ \ warnflag\ =\ 2}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00388}00388\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00389}00389\ \ \ \ \ \textcolor{comment}{\#\ These\ two\ portions\ of\ the\ workspace\ are\ described\ in\ the\ mainlb}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00390}00390\ \ \ \ \ \textcolor{comment}{\#\ subroutine\ in\ lbfgsb.f.\ See\ line\ 363.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00391}00391\ \ \ \ \ s\ =\ wa[0:\ m*n].reshape(m,\ n)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00392}00392\ \ \ \ \ y\ =\ wa[m*n:\ 2*m*n].reshape(m,\ n)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00393}00393\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00394}00394\ \ \ \ \ \textcolor{comment}{\#\ See\ lbfgsb.f\ line\ 160\ for\ this\ portion\ of\ the\ workspace.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00395}00395\ \ \ \ \ \textcolor{comment}{\#\ isave(31)\ =\ the\ total\ number\ of\ BFGS\ updates\ prior\ the\ current\ iteration;}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00396}00396\ \ \ \ \ n\_bfgs\_updates\ =\ isave[30]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00397}00397\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00398}00398\ \ \ \ \ n\_corrs\ =\ min(n\_bfgs\_updates,\ maxcor)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00399}00399\ \ \ \ \ hess\_inv\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct}{LbfgsInvHessProduct}}(s[:n\_corrs],\ y[:n\_corrs])}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00400}00400\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00401}00401\ \ \ \ \ task\_str\ =\ task\_str.decode()}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00402}00402\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__optimize_1_1OptimizeResult}{OptimizeResult}}(fun=f,\ jac=g,\ nfev=sf.nfev,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ njev=sf.ngev,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nit=n\_iterations,\ status=warnflag,\ message=task\_str,}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x=x,\ success=(warnflag\ ==\ 0),\ hess\_inv=hess\_inv)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00407}00407\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00408}\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct}{00408}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct}{LbfgsInvHessProduct}}(\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1__interface_1_1LinearOperator}{LinearOperator}}):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00409}00409\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Linear\ operator\ for\ the\ L-\/BFGS\ approximate\ inverse\ Hessian.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00410}00410\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ This\ operator\ computes\ the\ product\ of\ a\ vector\ with\ the\ approximate\ inverse}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ of\ the\ Hessian\ of\ the\ objective\ function,\ using\ the\ L-\/BFGS\ limited}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ memory\ approximation\ to\ the\ inverse\ Hessian,\ accumulated\ during\ the}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ optimization.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00415}00415\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00416}00416\ \textcolor{stringliteral}{\ \ \ \ Objects\ of\ this\ class\ implement\ the\ \`{}\`{}scipy.sparse.linalg.LinearOperator\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ interface.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00418}00418\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ sk\ :\ array\_like,\ shape=(n\_corr,\ n)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00422}00422\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ of\ \`{}n\_corr\`{}\ most\ recent\ updates\ to\ the\ solution\ vector.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (See\ [1]).}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ yk\ :\ array\_like,\ shape=(n\_corr,\ n)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ of\ \`{}n\_corr\`{}\ most\ recent\ updates\ to\ the\ gradient.\ (See\ [1]).}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00426}00426\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00429}00429\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Nocedal,\ Jorge.\ "{}Updating\ quasi-\/Newton\ matrices\ with\ limited}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ \ \ \ storage."{}\ Mathematics\ of\ computation\ 35.151\ (1980):\ 773-\/782.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00431}00431\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00433}00433\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00434}\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a3395f5773fd3ffbf918374b08865d997}{00434}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a3395f5773fd3ffbf918374b08865d997}{\_\_init\_\_}}(self,\ sk,\ yk):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Construct\ the\ operator."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ sk.shape\ !=\ yk.shape\ \textcolor{keywordflow}{or}\ sk.ndim\ !=\ 2:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'sk\ and\ yk\ must\ have\ matching\ shape,\ (n\_corrs,\ n)'})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ n\_corrs,\ n\ =\ sk.shape}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00439}00439\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ super().\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a3395f5773fd3ffbf918374b08865d997}{\_\_init\_\_}}(dtype=np.float64,\ shape=(n,\ n))}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00441}00441\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00442}00442\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a1419b7a4f13fcb65099fdd562ab33d4a}{sk}}\ =\ sk}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a2a8c79dfb667025e406c93bc094345a9}{yk}}\ =\ yk}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a06832fc7e82ba6a8971522abf2f32806}{n\_corrs}}\ =\ n\_corrs}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a354aa4841e387d6e3211a45b05125c76}{rho}}\ =\ 1\ /\ np.einsum(\textcolor{stringliteral}{'ij,ij-\/>i'},\ sk,\ yk)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00446}00446\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00447}\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a7392c960500750db9b9e34ff0f55fe63}{00447}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a7392c960500750db9b9e34ff0f55fe63}{\_matvec}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Efficient\ matrix-\/vector\ multiply\ with\ the\ BFGS\ matrices.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00449}00449\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ calculation\ is\ described\ in\ Section\ (4)\ of\ [1].}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00451}00451\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ An\ array\ with\ shape\ (n,)\ or\ (n,1).}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00456}00456\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ matrix-\/vector\ product}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00461}00461\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00463}00463\ \ \ \ \ \ \ \ \ s,\ y,\ n\_corrs,\ rho\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a1419b7a4f13fcb65099fdd562ab33d4a}{sk}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a2a8c79dfb667025e406c93bc094345a9}{yk}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a06832fc7e82ba6a8971522abf2f32806}{n\_corrs}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a354aa4841e387d6e3211a45b05125c76}{rho}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00464}00464\ \ \ \ \ \ \ \ \ q\ =\ np.array(x,\ dtype=self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1__interface_1_1LinearOperator_aed0f20d98ba472d11bc124a90123f3ae}{dtype}},\ copy=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00465}00465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ q.ndim\ ==\ 2\ \textcolor{keywordflow}{and}\ q.shape[1]\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00466}00466\ \ \ \ \ \ \ \ \ \ \ \ \ q\ =\ q.reshape(-\/1)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ alpha\ =\ np.empty(n\_corrs)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00469}00469\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00470}00470\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_corrs-\/1,\ -\/1,\ -\/1):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ \ \ \ \ alpha[i]\ =\ rho[i]\ *\ np.dot(s[i],\ q)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ \ \ \ \ q\ =\ q\ -\/\ alpha[i]*y[i]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00473}00473\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ r\ =\ q}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_corrs):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ \ \ \ \ beta\ =\ rho[i]\ *\ np.dot(y[i],\ r)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ r\ +\ s[i]\ *\ (alpha[i]\ -\/\ beta)}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00478}00478\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ r}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00481}\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a3adb1052e5af99526e6b0caa6410e150}{00481}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a3adb1052e5af99526e6b0caa6410e150}{todense}}(self):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ a\ dense\ array\ representation\ of\ this\ operator.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00483}00483\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ arr\ :\ ndarray,\ shape=(n,\ n)}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ An\ array\ with\ the\ same\ shape\ and\ containing}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ the\ same\ data\ represented\ by\ this\ \`{}LinearOperator\`{}.}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00489}00489\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00490}00490\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00491}00491\ \ \ \ \ \ \ \ \ s,\ y,\ n\_corrs,\ rho\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a1419b7a4f13fcb65099fdd562ab33d4a}{sk}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a2a8c79dfb667025e406c93bc094345a9}{yk}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a06832fc7e82ba6a8971522abf2f32806}{n\_corrs}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1__lbfgsb__py_1_1LbfgsInvHessProduct_a354aa4841e387d6e3211a45b05125c76}{rho}}}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00492}00492\ \ \ \ \ \ \ \ \ I\ =\ np.eye(*self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1__interface_1_1LinearOperator_a68f2fc4963a57afc2c37c185a052d15d}{shape}},\ dtype=self.\mbox{\hyperlink{classscipy_1_1sparse_1_1linalg_1_1__interface_1_1LinearOperator_aed0f20d98ba472d11bc124a90123f3ae}{dtype}})}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00493}00493\ \ \ \ \ \ \ \ \ Hk\ =\ I}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00494}00494\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00495}00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_corrs):}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00496}00496\ \ \ \ \ \ \ \ \ \ \ \ \ A1\ =\ I\ -\/\ s[i][:,\ np.newaxis]\ *\ y[i][np.newaxis,\ :]\ *\ rho[i]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00497}00497\ \ \ \ \ \ \ \ \ \ \ \ \ A2\ =\ I\ -\/\ y[i][:,\ np.newaxis]\ *\ s[i][np.newaxis,\ :]\ *\ rho[i]}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00498}00498\ }
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00499}00499\ \ \ \ \ \ \ \ \ \ \ \ \ Hk\ =\ np.dot(A1,\ np.dot(Hk,\ A2))\ +\ (rho[i]\ *\ s[i][:,\ np.newaxis]\ *}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s[i][np.newaxis,\ :])}
\DoxyCodeLine{\Hypertarget{__lbfgsb__py_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Hk}

\end{DoxyCode}
