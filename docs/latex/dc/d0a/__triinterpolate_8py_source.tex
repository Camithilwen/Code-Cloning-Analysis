\doxysection{\+\_\+triinterpolate.\+py}
\hypertarget{__triinterpolate_8py_source}{}\label{__triinterpolate_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/matplotlib/tri/\_triinterpolate.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/matplotlib/tri/\_triinterpolate.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00001}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00002}00002\ \textcolor{stringliteral}{Interpolation\ inside\ triangular\ grids.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00005}00005\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00007}00007\ \textcolor{keyword}{from}\ matplotlib\ \textcolor{keyword}{import}\ \_api}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1tri}{matplotlib.tri}}\ \textcolor{keyword}{import}\ Triangulation}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__trifinder}{matplotlib.tri.\_trifinder}}\ \textcolor{keyword}{import}\ TriFinder}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__tritools}{matplotlib.tri.\_tritools}}\ \textcolor{keyword}{import}\ TriAnalyzer}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00012}00012\ \_\_all\_\_\ =\ (\textcolor{stringliteral}{'TriInterpolator'},\ \textcolor{stringliteral}{'LinearTriInterpolator'},\ \textcolor{stringliteral}{'CubicTriInterpolator'})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00015}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator}{00015}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator}{TriInterpolator}}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00016}00016\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ Abstract\ base\ class\ for\ classes\ used\ to\ interpolate\ on\ a\ triangular\ grid.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00018}00018\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ Derived\ classes\ implement\ the\ following\ methods:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00020}00020\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ -\/\ \`{}\`{}\_\_call\_\_(x,\ y)\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ \ \ where\ x,\ y\ are\ array-\/like\ point\ coordinates\ of\ the\ same\ shape,\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ \ \ that\ returns\ a\ masked\ array\ of\ the\ same\ shape\ containing\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ \ \ interpolated\ z-\/values.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00025}00025\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ -\/\ \`{}\`{}gradient(x,\ y)\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ \ \ where\ x,\ y\ are\ array-\/like\ point\ coordinates\ of\ the\ same}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ \ \ shape,\ and\ that\ returns\ a\ list\ of\ 2\ masked\ arrays\ of\ the\ same\ shape}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ \ containing\ the\ 2\ derivatives\ of\ the\ interpolator\ (derivatives\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ \ \ interpolated\ z\ values\ with\ respect\ to\ x\ and\ y).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ triangulation,\ z,\ trifinder=None):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \_api.check\_isinstance(Triangulation,\ triangulation=triangulation)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}}\ =\ triangulation}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a469cc65e72fbbecdc304c7ac6461c09e}{\_z}}\ =\ np.asarray(z)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a469cc65e72fbbecdc304c7ac6461c09e}{\_z}}.shape\ !=\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}}.x.shape:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}z\ array\ must\ have\ same\ length\ as\ triangulation\ x"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ and\ y\ arrays"{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \_api.check\_isinstance((TriFinder,\ \textcolor{keywordtype}{None}),\ trifinder=trifinder)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_aaaf3d66ec5608cb1e1301d4d115f7767}{\_trifinder}}\ =\ trifinder\ \textcolor{keywordflow}{or}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}}.get\_trifinder()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Default\ scaling\ factors\ :\ 1.0\ (=\ no\ scaling)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Scaling\ may\ be\ used\ for\ interpolations\ for\ which\ the\ order\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ magnitude\ of\ x,\ y\ has\ an\ impact\ on\ the\ interpolant\ definition.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Please\ refer\ to\ :meth:`\_interpolate\_multikeys`\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_ae9719284e1ceb83ffb23645028d3e32a}{\_unit\_x}}\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a8c2c85864c4ed0276a0a0ddfca3304e5}{\_unit\_y}}\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Default\ triangle\ renumbering:\ None\ (=\ no\ renumbering)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Renumbering\ may\ be\ used\ to\ avoid\ unnecessary\ computations}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ complex\ calculations\ are\ done\ inside\ the\ Interpolator.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Please\ refer\ to\ :meth:`\_interpolate\_multikeys`\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a5a15c46d48b9c1673aea393fed3482c9}{\_tri\_renum}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00058}00058\ \ \ \ \ \textcolor{comment}{\#\ \_\_call\_\_\ and\ gradient\ docstrings\ are\ shared\ by\ all\ subclasses}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ (except,\ if\ needed,\ relevant\ additions).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00060}00060\ \ \ \ \ \textcolor{comment}{\#\ However\ these\ methods\ are\ only\ implemented\ in\ subclasses\ to\ avoid}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00061}00061\ \ \ \ \ \textcolor{comment}{\#\ confusion\ in\ the\ documentation.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00062}00062\ \ \ \ \ \_docstring\_\_call\_\_\ =\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ a\ masked\ array\ containing\ interpolated\ values\ at\ the\ specified}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00065}00065\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x,\ y\ :\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x\ and\ y\ coordinates\ of\ the\ same\ shape\ and\ any\ number\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ dimensions.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00071}00071\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ np.ma.array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Masked\ array\ of\ the\ same\ shape\ as\ *x*\ and\ *y*;\ values\ corresponding}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ to\ (*x*,\ *y*)\ points\ outside\ of\ the\ triangulation\ are\ masked\ out.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00077}00077\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00080}00080\ \ \ \ \ \_docstringgradient\ =\ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ a\ list\ of\ 2\ masked\ arrays\ containing\ interpolated\ derivatives}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ at\ the\ specified\ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00083}00083\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x,\ y\ :\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x\ and\ y\ coordinates\ of\ the\ same\ shape\ and\ any\ number\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ dimensions.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00089}00089\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dzdx,\ dzdy\ :\ np.ma.array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 2\ masked\ arrays\ of\ the\ same\ shape\ as\ *x*\ and\ *y*;\ values}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ corresponding\ to\ (x,\ y)\ points\ outside\ of\ the\ triangulation}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ are\ masked\ out.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ first\ returned\ array\ contains\ the\ values\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ :math:\`{}\(\backslash\)frac\{\(\backslash\)partial\ z\}\{\(\backslash\)partial\ x\}\`{}\ and\ the\ second\ those\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ :math:\`{}\(\backslash\)frac\{\(\backslash\)partial\ z\}\{\(\backslash\)partial\ y\}\`{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00099}00099\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00102}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{00102}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{\_interpolate\_multikeys}}(self,\ x,\ y,\ tri\_index=None,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_keys=(\textcolor{stringliteral}{'z'},)):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Versatile\ (private)\ method\ defined\ for\ all\ TriInterpolators.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00106}00106\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :meth:\`{}\_interpolate\_multikeys\`{}\ is\ a\ wrapper\ around\ method}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :meth:\`{}\_interpolate\_single\_key\`{}\ (to\ be\ defined\ in\ the\ child}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ subclasses).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :meth:\`{}\_interpolate\_single\_key\ actually\ performs\ the\ interpolation,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ but\ only\ for\ 1-\/dimensional\ inputs\ and\ at\ valid\ locations\ (inside}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ unmasked\ triangles\ of\ the\ triangulation).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00113}00113\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ purpose\ of\ :meth:\`{}\_interpolate\_multikeys\`{}\ is\ to\ implement\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ following\ common\ tasks\ needed\ in\ all\ subclasses\ implementations:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00116}00116\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ calculation\ of\ containing\ triangles}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ dealing\ with\ more\ than\ one\ interpolation\ request\ at\ the\ same}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00119}00119\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ location\ (e.g.,\ if\ the\ 2\ derivatives\ are\ requested,\ it\ is}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ unnecessary\ to\ compute\ the\ containing\ triangles\ twice)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ scaling\ according\ to\ self.\_unit\_x,\ self.\_unit\_y}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ dealing\ with\ points\ outside\ of\ the\ grid\ (with\ fill\ value\ np.nan)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ dealing\ with\ multi-\/dimensional\ *x*,\ *y*\ arrays:\ flattening\ for}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ :meth:\`{}\_interpolate\_params\`{}\ call\ and\ final\ reshaping.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00125}00125\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (Note\ that\ np.vectorize\ could\ do\ most\ of\ those\ things\ very\ well\ for}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ you,\ but\ it\ does\ it\ by\ function\ evaluations\ over\ successive\ tuples\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00128}00128\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ input\ arrays.\ Therefore,\ this\ tends\ to\ be\ more\ time-\/consuming\ than}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ using\ optimized\ numpy\ functions\ -\/\ e.g.,\ np.dot\ -\/\ which\ can\ be\ used}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00130}00130\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ easily\ on\ the\ flattened\ inputs,\ in\ the\ child-\/subclass\ methods}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ :meth:\`{}\_interpolate\_single\_key\`{}.)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00132}00132\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ It\ is\ guaranteed\ that\ the\ calls\ to\ :meth:\`{}\_interpolate\_single\_key\`{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ be\ done\ with\ flattened\ (1-\/d)\ array-\/like\ input\ parameters\ *x*,\ *y*}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ with\ flattened,\ valid\ \`{}tri\_index\`{}\ arrays\ (no\ -\/1\ index\ allowed).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00136}00136\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x,\ y\ :\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x\ and\ y\ coordinates\ where\ interpolated\ values\ are\ requested.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tri\_index\ :\ array-\/like\ of\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Array\ of\ the\ containing\ triangle\ indices,\ same\ shape\ as}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ *x*\ and\ *y*.\ Defaults\ to\ None.\ If\ None,\ these\ indices}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ will\ be\ computed\ by\ a\ TriFinder\ instance.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ (Note:\ For\ point\ outside\ the\ grid,\ tri\_index[ipt]\ shall\ be\ -\/1).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\_keys\ :\ tuple\ of\ keys\ from\ \{'z',\ 'dzdx',\ 'dzdy'\}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Defines\ the\ interpolation\ arrays\ to\ return,\ and\ in\ which\ order.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00148}00148\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00151}00151\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ list\ of\ arrays}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Each\ array-\/like\ contains\ the\ expected\ interpolated\ values\ in\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ order\ defined\ by\ *return\_keys*\ parameter.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Flattening\ and\ rescaling\ inputs\ arrays\ x,\ y}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (initial\ shape\ is\ stored\ for\ output)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ x\ =\ np.asarray(x,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ y\ =\ np.asarray(y,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ sh\_ret\ =\ x.shape}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ x.shape\ !=\ y.shape:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}x\ and\ y\ shall\ have\ same\ shapes."{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ Given:\ \{x.shape\}\ and\ \{y.shape\}"{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ x\ =\ np.ravel(x)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ y\ =\ np.ravel(y)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ x\_scaled\ =\ x/self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_ae9719284e1ceb83ffb23645028d3e32a}{\_unit\_x}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ y\_scaled\ =\ y/self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a8c2c85864c4ed0276a0a0ddfca3304e5}{\_unit\_y}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ size\_ret\ =\ np.size(x\_scaled)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00168}00168\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computes\ \&\ ravels\ the\ element\ indexes,\ extract\ the\ valid\ ones.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tri\_index\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ tri\_index\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_aaaf3d66ec5608cb1e1301d4d115f7767}{\_trifinder}}(x,\ y)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tri\_index.shape\ !=\ sh\_ret:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}tri\_index\ array\ is\ provided\ and\ shall"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ have\ same\ shape\ as\ x\ and\ y.\ Given:\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{tri\_index.shape\}\ and\ \{sh\_ret\}"{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ tri\_index\ =\ np.ravel(tri\_index)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ mask\_in\ =\ (tri\_index\ !=\ -\/1)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a5a15c46d48b9c1673aea393fed3482c9}{\_tri\_renum}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ valid\_tri\_index\ =\ tri\_index[mask\_in]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ valid\_tri\_index\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a5a15c46d48b9c1673aea393fed3482c9}{\_tri\_renum}}[tri\_index[mask\_in]]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ valid\_x\ =\ x\_scaled[mask\_in]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ valid\_y\ =\ y\_scaled[mask\_in]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ ret\ =\ []}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ return\_key\ \textcolor{keywordflow}{in}\ return\_keys:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ the\ return\ index\ associated\ with\ the\ key.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_index\ =\ \{\textcolor{stringliteral}{'z'}:\ 0,\ \textcolor{stringliteral}{'dzdx'}:\ 1,\ \textcolor{stringliteral}{'dzdy'}:\ 2\}[return\_key]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError\ \textcolor{keyword}{as}\ err:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}return\_keys\ items\ shall\ take\ values\ in"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \{'z',\ 'dzdx',\ 'dzdy'\}"{}})\ \textcolor{keyword}{from}\ err}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Sets\ the\ scale\ factor\ for\ f\ \&\ df\ components}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ scale\ =\ [1.,\ 1./self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_ae9719284e1ceb83ffb23645028d3e32a}{\_unit\_x}},\ 1./self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a8c2c85864c4ed0276a0a0ddfca3304e5}{\_unit\_y}}][return\_index]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computes\ the\ interpolation}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ ret\_loc\ =\ np.empty(size\_ret,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ ret\_loc[\string~mask\_in]\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ ret\_loc[mask\_in]\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3c77ef4bea6da3ccb9b5f3f83210b323}{\_interpolate\_single\_key}}(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_key,\ valid\_tri\_index,\ valid\_x,\ valid\_y)\ *\ scale}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ ret\ +=\ [np.ma.masked\_invalid(ret\_loc.reshape(sh\_ret),\ copy=\textcolor{keyword}{False})]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00209}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3c77ef4bea6da3ccb9b5f3f83210b323}{00209}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3c77ef4bea6da3ccb9b5f3f83210b323}{\_interpolate\_single\_key}}(self,\ return\_key,\ tri\_index,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Interpolate\ at\ points\ belonging\ to\ the\ triangulation}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (inside\ an\ unmasked\ triangles).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00213}00213\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\_key\ :\ \{'z',\ 'dzdx',\ 'dzdy'\}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ requested\ values\ (z\ or\ its\ derivatives).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tri\_index\ :\ 1D\ int\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Valid\ triangle\ index\ (cannot\ be\ -\/1).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x,\ y\ :\ 1D\ arrays,\ same\ shape\ as\ \`{}tri\_index\`{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Valid\ locations\ where\ interpolation\ is\ requested.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00222}00222\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1-\/d\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Returned\ array\ of\ the\ same\ size\ as\ *tri\_index*}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classNotImplementedError}{NotImplementedError}}(\textcolor{stringliteral}{"{}TriInterpolator\ subclasses"{}}\ +}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}should\ implement\ \_interpolate\_single\_key!"{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00232}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator}{00232}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator}{LinearTriInterpolator}}(\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator}{TriInterpolator}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00233}00233\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ Linear\ interpolator\ on\ a\ triangular\ grid.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00235}00235\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ Each\ triangle\ is\ represented\ by\ a\ plane\ so\ that\ an\ interpolated\ value\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ point\ (x,\ y)\ lies\ on\ the\ plane\ of\ the\ triangle\ containing\ (x,\ y).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ Interpolated\ values\ are\ therefore\ continuous\ across\ the\ triangulation,\ but}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00239}00239\ \textcolor{stringliteral}{\ \ \ \ their\ first\ derivatives\ are\ discontinuous\ at\ edges\ between\ triangles.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00240}00240\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ triangulation\ :\ \`{}\string~matplotlib.tri.Triangulation\`{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ triangulation\ to\ interpolate\ over.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ z\ :\ (npoints,)\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ of\ values,\ defined\ at\ grid\ points,\ to\ interpolate\ between.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ trifinder\ :\ \`{}\string~matplotlib.tri.TriFinder\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ this\ is\ not\ specified,\ the\ Triangulation's\ default\ TriFinder\ will}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ used\ by\ calling\ \`{}.Triangulation.get\_trifinder\`{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00250}00250\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \`{}\_\_call\_\_\`{}\ (x,\ y)\ :\ Returns\ interpolated\ values\ at\ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \`{}gradient\`{}\ (x,\ y)\ :\ Returns\ interpolated\ derivatives\ at\ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00255}00255\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00257}00257\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ triangulation,\ z,\ trifinder=None):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(triangulation,\ z,\ trifinder)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00259}00259\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Store\ plane\ coefficients\ for\ fast\ interpolation\ calculations.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}\ =\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}}.calculate\_plane\_coefficients(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a469cc65e72fbbecdc304c7ac6461c09e}{\_z}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00263}00263\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00264}00264\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{\_interpolate\_multikeys}}(x,\ y,\ tri\_index=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_keys=(\textcolor{stringliteral}{'z'},))[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00267}00267\ \ \ \ \ \_\_call\_\_.\_\_doc\_\_\ =\ TriInterpolator.\_docstring\_\_call\_\_}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00269}00269\ \ \ \ \ \textcolor{keyword}{def\ }gradient(self,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{\_interpolate\_multikeys}}(x,\ y,\ tri\_index=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_keys=(\textcolor{stringliteral}{'dzdx'},\ \textcolor{stringliteral}{'dzdy'}))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00272}00272\ \ \ \ \ gradient.\_\_doc\_\_\ =\ TriInterpolator.\_docstringgradient}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00274}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_aad7bd87c7ea51824f013b40ac556862e}{00274}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_aad7bd87c7ea51824f013b40ac556862e}{\_interpolate\_single\_key}}(self,\ return\_key,\ tri\_index,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \_api.check\_in\_list([\textcolor{stringliteral}{'z'},\ \textcolor{stringliteral}{'dzdx'},\ \textcolor{stringliteral}{'dzdy'}],\ return\_key=return\_key)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_key\ ==\ \textcolor{stringliteral}{'z'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}[tri\_index,\ 0]*x\ +}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}[tri\_index,\ 1]*y\ +}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}[tri\_index,\ 2])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ return\_key\ ==\ \textcolor{stringliteral}{'dzdx'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}[tri\_index,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 'dzdy'}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1LinearTriInterpolator_a6408e1ce42407c3b37e693a062ff9f71}{\_plane\_coefficients}}[tri\_index,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00284}00284\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00285}00285\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00286}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator}{00286}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator}{CubicTriInterpolator}}(\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator}{TriInterpolator}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00287}00287\ \ \ \ \ \textcolor{stringliteral}{r"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ Cubic\ interpolator\ on\ a\ triangular\ grid.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00289}00289\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ In\ one-\/dimension\ -\/\ on\ a\ segment\ -\/\ a\ cubic\ interpolating\ function\ is}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ defined\ by\ the\ values\ of\ the\ function\ and\ its\ derivative\ at\ both\ ends.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ This\ is\ almost\ the\ same\ in\ 2D\ inside\ a\ triangle,\ except\ that\ the\ values}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ of\ the\ function\ and\ its\ 2\ derivatives\ have\ to\ be\ defined\ at\ each\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ node.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00295}00295\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ The\ CubicTriInterpolator\ takes\ the\ value\ of\ the\ function\ at\ each\ node\ -\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ provided\ by\ the\ user\ -\/\ and\ internally\ computes\ the\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ derivatives,\ resulting\ in\ a\ smooth\ interpolation.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ (As\ a\ special\ feature,\ the\ user\ can\ also\ impose\ the\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ derivatives\ at\ each\ node,\ but\ this\ is\ not\ supposed\ to\ be\ the\ common}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ usage.)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00302}00302\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ triangulation\ :\ \`{}\string~matplotlib.tri.Triangulation\`{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ triangulation\ to\ interpolate\ over.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ z\ :\ (npoints,)\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Array\ of\ values,\ defined\ at\ grid\ points,\ to\ interpolate\ between.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ kind\ :\ \{'min\_E',\ 'geom',\ 'user'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Choice\ of\ the\ smoothing\ algorithm,\ in\ order\ to\ compute}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ interpolant\ derivatives\ (defaults\ to\ 'min\_E'):}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00312}00312\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ if\ 'min\_E':\ (default)\ The\ derivatives\ at\ each\ node\ is\ computed}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ to\ minimize\ a\ bending\ energy.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ if\ 'geom':\ The\ derivatives\ at\ each\ node\ is\ computed\ as\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ weighted\ average\ of\ relevant\ triangle\ normals.\ To\ be\ used\ for}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ speed\ optimization\ (large\ grids).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ if\ 'user':\ The\ user\ provides\ the\ argument\ *dz*,\ no\ computation}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ is\ hence\ needed.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00320}00320\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ trifinder\ :\ \`{}\string~matplotlib.tri.TriFinder\`{},\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ not\ specified,\ the\ Triangulation's\ default\ TriFinder\ will}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ used\ by\ calling\ \`{}.Triangulation.get\_trifinder\`{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ dz\ :\ tuple\ of\ array-\/likes\ (dzdx,\ dzdy),\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Used\ only\ if\ \ *kind*\ ='user'.\ In\ this\ case\ *dz*\ must\ be\ provided\ as}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (dzdx,\ dzdy)\ where\ dzdx,\ dzdy\ are\ arrays\ of\ the\ same\ shape\ as\ *z*\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ are\ the\ interpolant\ first\ derivatives\ at\ the\ *triangulation*\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00328}00328\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ Methods}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ \`{}\_\_call\_\_\`{}\ (x,\ y)\ :\ Returns\ interpolated\ values\ at\ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ \`{}gradient\`{}\ (x,\ y)\ :\ Returns\ interpolated\ derivatives\ at\ (x,\ y)\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00333}00333\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ This\ note\ is\ a\ bit\ technical\ and\ details\ how\ the\ cubic\ interpolation\ is}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ computed.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00338}00338\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ The\ interpolation\ is\ based\ on\ a\ Clough-\/Tocher\ subdivision\ scheme\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ the\ *triangulation*\ mesh\ (to\ make\ it\ clearer,\ each\ triangle\ of\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ grid\ will\ be\ divided\ in\ 3\ child-\/triangles,\ and\ on\ each\ child\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ the\ interpolated\ function\ is\ a\ cubic\ polynomial\ of\ the\ 2\ coordinates).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ This\ technique\ originates\ from\ FEM\ (Finite\ Element\ Method)\ analysis;}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ the\ element\ used\ is\ a\ reduced\ Hsieh-\/Clough-\/Tocher\ (HCT)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ element.\ Its\ shape\ functions\ are\ described\ in\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ The\ assembled\ function\ is\ guaranteed\ to\ be\ C1-\/smooth,\ i.e.\ it\ is}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ continuous\ and\ its\ first\ derivatives\ are\ also\ continuous\ (this}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ is\ easy\ to\ show\ inside\ the\ triangles\ but\ is\ also\ true\ when\ crossing\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ edges).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00350}00350\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ In\ the\ default\ case\ (*kind*\ ='min\_E'),\ the\ interpolant\ minimizes\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ curvature\ energy\ on\ the\ functional\ space\ generated\ by\ the\ HCT\ element}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ shape\ functions\ -\/\ with\ imposed\ values\ but\ arbitrary\ derivatives\ at\ each}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ node.\ The\ minimized\ functional\ is\ the\ integral\ of\ the\ so-\/called\ total}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00355}00355\ \textcolor{stringliteral}{\ \ \ \ curvature\ (implementation\ based\ on\ an\ algorithm\ from\ [2]\_\ -\/\ PCG\ sparse}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ solver):}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00357}00357\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ ..\ math::}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00359}00359\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ E(z)\ =\ \(\backslash\)frac\{1\}\{2\}\ \(\backslash\)int\_\{\(\backslash\)Omega\}\ \(\backslash\)left(}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)left(\ \(\backslash\)frac\{\(\backslash\)partial\string^2\{z\}\}\{\(\backslash\)partial\{x\}\string^2\}\ \(\backslash\)right)\string^2\ +}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00362}00362\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)left(\ \(\backslash\)frac\{\(\backslash\)partial\string^2\{z\}\}\{\(\backslash\)partial\{y\}\string^2\}\ \(\backslash\)right)\string^2\ +}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00363}00363\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 2\(\backslash\)left(\ \(\backslash\)frac\{\(\backslash\)partial\string^2\{z\}\}\{\(\backslash\)partial\{y\}\(\backslash\)partial\{x\}\}\ \(\backslash\)right)\string^2}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \(\backslash\)right)\ dx\(\backslash\),dy}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00365}00365\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ If\ the\ case\ *kind*\ ='geom'\ is\ chosen\ by\ the\ user,\ a\ simple\ geometric}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ approximation\ is\ used\ (weighted\ average\ of\ the\ triangle\ normal}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ vectors),\ which\ could\ improve\ speed\ on\ very\ large\ grids.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00369}00369\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Michel\ Bernadou,\ Kamal\ Hassan,\ "{}Basis\ functions\ for\ general}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Hsieh-\/Clough-\/Tocher\ triangles,\ complete\ or\ reduced."{},}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ International\ Journal\ for\ Numerical\ Methods\ in\ Engineering,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 17(5):784\ -\/\ 789.\ 2.01.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ C.T.\ Kelley,\ "{}Iterative\ Methods\ for\ Optimization"{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00377}00377\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00379}00379\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ triangulation,\ z,\ kind='min\_E',\ trifinder=None,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00380}00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dz=None):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00381}00381\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(triangulation,\ z,\ trifinder)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00382}00382\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Loads\ the\ underlying\ c++\ \_triangulation.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00384}00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (During\ loading,\ reordering\ of\ triangulation.\_triangles\ may\ occur\ so}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ that\ all\ final\ triangles\ are\ now\ anti-\/clockwise)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00386}00386\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}}.get\_cpp\_triangulation()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00388}00388\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ To\ build\ the\ stiffness\ matrix\ and\ avoid\ zero-\/energy\ spurious\ modes}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00389}00389\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ will\ only\ store\ internally\ the\ valid\ (unmasked)\ triangles\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00390}00390\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ necessary\ (used)\ points\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00391}00391\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2\ renumbering\ tables\ need\ to\ be\ computed\ and\ stored:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00392}00392\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ -\/\ a\ triangle\ renum\ table\ in\ order\ to\ translate\ the\ result\ from\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00393}00393\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ TriFinder\ instance\ into\ the\ internal\ stored\ triangle\ number.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ -\/\ a\ node\ renum\ table\ to\ overwrite\ the\ self.\_z\ values\ into\ the\ new}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00395}00395\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ (used)\ node\ numbering.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ tri\_analyzer\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__tritools_1_1TriAnalyzer}{TriAnalyzer}}(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a068fdeef221fe16a2f0ea8eda139f8c7}{\_triangulation}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ (compressed\_triangles,\ compressed\_x,\ compressed\_y,\ tri\_renum,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00398}00398\ \ \ \ \ \ \ \ \ \ node\_renum)\ =\ tri\_analyzer.\_get\_compressed\_triangulation()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_af49d35af14c737595bbe21f17a817dc4}{\_triangles}}\ =\ compressed\_triangles}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00400}00400\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a5a15c46d48b9c1673aea393fed3482c9}{\_tri\_renum}}\ =\ tri\_renum}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Taking\ into\ account\ the\ node\ renumbering\ in\ self.\_z:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ valid\_node\ =\ (node\_renum\ !=\ -\/1)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a469cc65e72fbbecdc304c7ac6461c09e}{\_z}}[node\_renum[valid\_node]]\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a469cc65e72fbbecdc304c7ac6461c09e}{\_z}}[valid\_node]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00404}00404\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ scale\ factors}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_ae9719284e1ceb83ffb23645028d3e32a}{\_unit\_x}}\ =\ np.ptp(compressed\_x)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a8c2c85864c4ed0276a0a0ddfca3304e5}{\_unit\_y}}\ =\ np.ptp(compressed\_y)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a560ef6623e9c2c39fb3471934f093ade}{\_pts}}\ =\ np.column\_stack([compressed\_x\ /\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_ae9719284e1ceb83ffb23645028d3e32a}{\_unit\_x}},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ compressed\_y\ /\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a8c2c85864c4ed0276a0a0ddfca3304e5}{\_unit\_y}}])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00410}00410\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ triangle\ points}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_ac59b2530111f2ea2f46d8590e1da841e}{\_tris\_pts}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a560ef6623e9c2c39fb3471934f093ade}{\_pts}}[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_af49d35af14c737595bbe21f17a817dc4}{\_triangles}}]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ eccentricities}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa8a96afe0ac2de6f42b1cddd6fd8dc6b}{\_eccs}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa5c5aa53719e678f3a4d5969206ab139}{\_compute\_tri\_eccentricities}}(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_ac59b2530111f2ea2f46d8590e1da841e}{\_tris\_pts}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ dof\ estimations\ for\ HCT\ triangle\ shape\ function}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ \_api.check\_in\_list([\textcolor{stringliteral}{'user'},\ \textcolor{stringliteral}{'geom'},\ \textcolor{stringliteral}{'min\_E'}],\ kind=kind)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_afa582241f7bcc2b97a6c75e093f973fd}{\_dof}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_af534eb8f72b9f0549c865b0567e6b74e}{\_compute\_dof}}(kind,\ dz=dz)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Loading\ HCT\ element}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a56d1b85c6ace4eb794ee41fe359db587}{\_ReferenceElement}}\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element}{\_ReducedHCT\_Element}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00419}00419\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00420}00420\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{\_interpolate\_multikeys}}(x,\ y,\ tri\_index=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_keys=(\textcolor{stringliteral}{'z'},))[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00423}00423\ \ \ \ \ \_\_call\_\_.\_\_doc\_\_\ =\ TriInterpolator.\_docstring\_\_call\_\_}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00424}00424\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00425}00425\ \ \ \ \ \textcolor{keyword}{def\ }gradient(self,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1TriInterpolator_a3cb13157c9676373e720ac9373a7c357}{\_interpolate\_multikeys}}(x,\ y,\ tri\_index=\textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_keys=(\textcolor{stringliteral}{'dzdx'},\ \textcolor{stringliteral}{'dzdy'}))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00428}00428\ \ \ \ \ gradient.\_\_doc\_\_\ =\ TriInterpolator.\_docstringgradient}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00429}00429\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00430}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa16867c0cc2145dc23da177411dac6db}{00430}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa16867c0cc2145dc23da177411dac6db}{\_interpolate\_single\_key}}(self,\ return\_key,\ tri\_index,\ x,\ y):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ \_api.check\_in\_list([\textcolor{stringliteral}{'z'},\ \textcolor{stringliteral}{'dzdx'},\ \textcolor{stringliteral}{'dzdy'}],\ return\_key=return\_key)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ tris\_pts\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_ac59b2530111f2ea2f46d8590e1da841e}{\_tris\_pts}}[tri\_index]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ alpha\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a5070766d816b55bc341d4b8dd95f6ab8}{\_get\_alpha\_vec}}(x,\ y,\ tris\_pts)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ ecc\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa8a96afe0ac2de6f42b1cddd6fd8dc6b}{\_eccs}}[tri\_index]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ dof\ =\ np.expand\_dims(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_afa582241f7bcc2b97a6c75e093f973fd}{\_dof}}[tri\_index],\ axis=1)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_key\ ==\ \textcolor{stringliteral}{'z'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a56d1b85c6ace4eb794ee41fe359db587}{\_ReferenceElement}}.get\_function\_values(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha,\ ecc,\ dof)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00439}00439\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 'dzdx',\ 'dzdy'}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ \ \ \ \ J\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a9fa59cbafd5f8f99846a624fc8534732}{\_get\_jacobian}}(tris\_pts)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00441}00441\ \ \ \ \ \ \ \ \ \ \ \ \ dzdx\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a56d1b85c6ace4eb794ee41fe359db587}{\_ReferenceElement}}.get\_function\_derivatives(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00442}00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha,\ J,\ ecc,\ dof)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_key\ ==\ \textcolor{stringliteral}{'dzdx'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dzdx[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dzdx[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00448}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_af534eb8f72b9f0549c865b0567e6b74e}{00448}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_af534eb8f72b9f0549c865b0567e6b74e}{\_compute\_dof}}(self,\ kind,\ dz=None):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ and\ return\ nodal\ dofs\ according\ to\ kind.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00451}00451\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ kind\ :\ \{'min\_E',\ 'geom',\ 'user'\}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Choice\ of\ the\ \_DOF\_estimator\ subclass\ to\ estimate\ the\ gradient.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00456}00456\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dz\ :\ tuple\ of\ array-\/likes\ (dzdx,\ dzdy),\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Used\ only\ if\ *kind*=user;\ in\ this\ case\ passed\ to\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ :class:\`{}\_DOF\_estimator\_user\`{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00459}00459\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00461}00461\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ array-\/like,\ shape\ (npts,\ 2)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Estimation\ of\ the\ gradient\ at\ triangulation\ nodes\ (stored\ as}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00464}00464\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ degree\ of\ freedoms\ of\ reduced-\/HCT\ triangle\ elements).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00465}00465\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00466}00466\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ kind\ ==\ \textcolor{stringliteral}{'user'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dz\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00468}00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}For\ a\ CubicTriInterpolator\ with\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}*kind*='user',\ a\ valid\ *dz*\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00470}00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}argument\ is\ expected."{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00471}00471\ \ \ \ \ \ \ \ \ \ \ \ \ TE\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__user}{\_DOF\_estimator\_user}}(self,\ dz=dz)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00472}00472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ kind\ ==\ \textcolor{stringliteral}{'geom'}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00473}00473\ \ \ \ \ \ \ \ \ \ \ \ \ TE\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom}{\_DOF\_estimator\_geom}}(self)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 'min\_E',\ checked\ in\ \_\_init\_\_}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ \ \ \ \ TE\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E}{\_DOF\_estimator\_min\_E}}(self)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TE.compute\_dof\_from\_df()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00477}00477\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00478}00478\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00479}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a5070766d816b55bc341d4b8dd95f6ab8}{00479}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a5070766d816b55bc341d4b8dd95f6ab8}{\_get\_alpha\_vec}}(x,\ y,\ tris\_pts):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Fast\ (vectorized)\ function\ to\ compute\ barycentric\ coordinates\ alpha.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00482}00482\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x,\ y\ :\ array-\/like\ of\ dim\ 1\ (shape\ (nx,))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Coordinates\ of\ the\ points\ whose\ points\ barycentric\ coordinates\ are}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ requested.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tris\_pts\ :\ array\ like\ of\ dim\ 3\ (shape:\ (nx,\ 3,\ 2))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Coordinates\ of\ the\ containing\ triangles\ apexes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00490}00490\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00492}00492\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00493}00493\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ array\ of\ dim\ 2\ (shape\ (nx,\ 3))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Barycentric\ coordinates\ of\ the\ points\ inside\ the\ containing}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ triangles.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00497}00497\ \ \ \ \ \ \ \ \ ndim\ =\ tris\_pts.ndim-\/2}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00498}00498\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00499}00499\ \ \ \ \ \ \ \ \ a\ =\ tris\_pts[:,\ 1,\ :]\ -\/\ tris\_pts[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ b\ =\ tris\_pts[:,\ 2,\ :]\ -\/\ tris\_pts[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ abT\ =\ np.stack([a,\ b],\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00502}00502\ \ \ \ \ \ \ \ \ ab\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(abT)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00503}00503\ \ \ \ \ \ \ \ \ OM\ =\ np.stack([x,\ y],\ axis=1)\ -\/\ tris\_pts[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00504}00504\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00505}00505\ \ \ \ \ \ \ \ \ metric\ =\ ab\ @\ abT}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00506}00506\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ try\ to\ deal\ with\ the\ colinear\ cases.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00507}00507\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ metric\_inv\ is\ in\ this\ case\ set\ to\ the\ Moore-\/Penrose\ pseudo-\/inverse}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00508}00508\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ meaning\ that\ we\ will\ still\ return\ a\ set\ of\ valid\ barycentric}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ metric\_inv\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a35e96be952e386567060ae058d73b547}{\_pseudo\_inv22sym\_vectorized}}(metric)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00511}00511\ \ \ \ \ \ \ \ \ Covar\ =\ ab\ @\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(np.expand\_dims(OM,\ ndim))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ ksi\ =\ metric\_inv\ @\ Covar}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00513}00513\ \ \ \ \ \ \ \ \ alpha\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00514}00514\ \ \ \ \ \ \ \ \ \ \ \ \ [1-\/ksi[:,\ 0,\ 0]-\/ksi[:,\ 1,\ 0]],\ [ksi[:,\ 0,\ 0]],\ [ksi[:,\ 1,\ 0]]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00515}00515\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ alpha}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00516}00516\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00517}00517\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00518}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a9fa59cbafd5f8f99846a624fc8534732}{00518}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_a9fa59cbafd5f8f99846a624fc8534732}{\_get\_jacobian}}(tris\_pts):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00520}00520\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Fast\ (vectorized)\ function\ to\ compute\ triangle\ jacobian\ matrix.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00521}00521\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00522}00522\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00524}00524\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tris\_pts\ :\ array\ like\ of\ dim\ 3\ (shape:\ (nx,\ 3,\ 2))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Coordinates\ of\ the\ containing\ triangles\ apexes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00526}00526\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00529}00529\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ array\ of\ dim\ 3\ (shape\ (nx,\ 2,\ 2))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Barycentric\ coordinates\ of\ the\ points\ inside\ the\ containing}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00531}00531\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ triangles.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ J[itri,\ :,\ :]\ is\ the\ jacobian\ matrix\ at\ apex\ 0\ of\ the\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ itri,\ so\ that\ the\ following\ (matrix)\ relationship\ holds:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [dz/dksi]\ =\ [J]\ x\ [dz/dx]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ with\ x:\ global\ coordinates}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00536}00536\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ksi:\ element\ parametric\ coordinates\ in\ triangle\ first\ apex}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00537}00537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ local\ basis.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ a\ =\ np.array(tris\_pts[:,\ 1,\ :]\ -\/\ tris\_pts[:,\ 0,\ :])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ b\ =\ np.array(tris\_pts[:,\ 2,\ :]\ -\/\ tris\_pts[:,\ 0,\ :])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ J\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([[a[:,\ 0],\ a[:,\ 1]],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [b[:,\ 0],\ b[:,\ 1]]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00543}00543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00544}00544\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00545}00545\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00546}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa5c5aa53719e678f3a4d5969206ab139}{00546}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1CubicTriInterpolator_aa5c5aa53719e678f3a4d5969206ab139}{\_compute\_tri\_eccentricities}}(tris\_pts):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00547}00547\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00548}00548\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ triangle\ eccentricities.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00549}00549\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00550}00550\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00551}00551\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00552}00552\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tris\_pts\ :\ array\ like\ of\ dim\ 3\ (shape:\ (nx,\ 3,\ 2))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00553}00553\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Coordinates\ of\ the\ triangles\ apexes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00554}00554\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00555}00555\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00556}00556\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00557}00557\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ array\ like\ of\ dim\ 2\ (shape:\ (nx,\ 3))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00558}00558\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ so-\/called\ eccentricity\ parameters\ [1]\ needed\ for\ HCT\ triangular}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00559}00559\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ element.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ a\ =\ np.expand\_dims(tris\_pts[:,\ 2,\ :]\ -\/\ tris\_pts[:,\ 1,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ b\ =\ np.expand\_dims(tris\_pts[:,\ 0,\ :]\ -\/\ tris\_pts[:,\ 2,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00563}00563\ \ \ \ \ \ \ \ \ c\ =\ np.expand\_dims(tris\_pts[:,\ 1,\ :]\ -\/\ tris\_pts[:,\ 0,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00564}00564\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Do\ not\ use\ np.squeeze,\ this\ is\ dangerous\ if\ only\ one\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00565}00565\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ the\ triangulation...}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ dot\_a\ =\ (\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(a)\ @\ a)[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00567}00567\ \ \ \ \ \ \ \ \ dot\_b\ =\ (\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(b)\ @\ b)[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00568}00568\ \ \ \ \ \ \ \ \ dot\_c\ =\ (\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(c)\ @\ c)[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00569}00569\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note\ that\ this\ line\ will\ raise\ a\ warning\ for\ dot\_a,\ dot\_b\ or\ dot\_c}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00570}00570\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ zeros,\ but\ we\ choose\ not\ to\ support\ triangles\ with\ duplicate\ points.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00571}00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([[(dot\_c-\/dot\_b)\ /\ dot\_a],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(dot\_a-\/dot\_c)\ /\ dot\_b],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00573}00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [(dot\_b-\/dot\_a)\ /\ dot\_c]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00574}00574\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00575}00575\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00576}00576\ \textcolor{comment}{\#\ FEM\ element\ used\ for\ interpolation\ and\ for\ solving\ minimisation}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00577}00577\ \textcolor{comment}{\#\ problem\ (Reduced\ HCT\ element)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00578}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element}{00578}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element}{\_ReducedHCT\_Element}}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00579}00579\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00580}00580\ \textcolor{stringliteral}{\ \ \ \ Implementation\ of\ reduced\ HCT\ triangular\ element\ with\ explicit\ shape}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00581}00581\ \textcolor{stringliteral}{\ \ \ \ functions.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00582}00582\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00583}00583\ \textcolor{stringliteral}{\ \ \ \ Computes\ z,\ dz,\ d2z\ and\ the\ element\ stiffness\ matrix\ for\ bending\ energy:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00584}00584\ \textcolor{stringliteral}{\ \ \ \ E(f)\ =\ integral(\ (d2z/dx2\ +\ d2z/dy2)**2\ dA)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00585}00585\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00586}00586\ \textcolor{stringliteral}{\ \ \ \ ***\ Reference\ for\ the\ shape\ functions:\ ***}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00587}00587\ \textcolor{stringliteral}{\ \ \ \ [1]\ Basis\ functions\ for\ general\ Hsieh-\/Clough-\/Tocher\ \_triangles,\ complete\ or}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00588}00588\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ reduced.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00589}00589\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Michel\ Bernadou,\ Kamal\ Hassan}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00590}00590\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ International\ Journal\ for\ Numerical\ Methods\ in\ Engineering.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00591}00591\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 17(5):784\ -\/\ 789.\ \ 2.01}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00592}00592\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00593}00593\ \textcolor{stringliteral}{\ \ \ \ ***\ Element\ description:\ ***}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00594}00594\ \textcolor{stringliteral}{\ \ \ \ 9\ dofs:\ z\ and\ dz\ given\ at\ 3\ apex}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00595}00595\ \textcolor{stringliteral}{\ \ \ \ C1\ (conform)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00596}00596\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00597}00597\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00598}00598\ \ \ \ \ \textcolor{comment}{\#\ 1)\ Loads\ matrices\ to\ generate\ shape\ functions\ as\ a\ function\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00599}00599\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ triangle\ eccentricities\ -\/\ based\ on\ [1]\ p.11\ '''}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00600}00600\ \ \ \ \ M\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 4.50,\ \ 4.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ [-\/0.25,\ 0.00,\ 0.00,\ \ 0.50,\ \ 1.25,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00603}00603\ \ \ \ \ \ \ \ \ [-\/0.25,\ 0.00,\ 0.00,\ \ 1.25,\ \ 0.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ [\ 0.50,\ 1.00,\ 0.00,\ -\/1.50,\ \ 0.00,\ 3.00,\ 3.00,\ 0.00,\ 0.00,\ 3.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00605}00605\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ -\/0.25,\ \ 0.25,\ 0.00,\ 1.00,\ 0.00,\ 0.00,\ 0.50],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ [\ 0.25,\ 0.00,\ 0.00,\ -\/0.50,\ -\/0.25,\ 1.00,\ 0.00,\ 0.00,\ 0.00,\ 1.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ [\ 0.50,\ 0.00,\ 1.00,\ \ 0.00,\ -\/1.50,\ 0.00,\ 0.00,\ 3.00,\ 3.00,\ 3.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ [\ 0.25,\ 0.00,\ 0.00,\ -\/0.25,\ -\/0.50,\ 0.00,\ 0.00,\ 0.00,\ 1.00,\ 1.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.25,\ -\/0.25,\ 0.00,\ 0.00,\ 1.00,\ 0.00,\ 0.50]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00610}00610\ \ \ \ \ M0\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ [-\/1.00,\ 0.00,\ 0.00,\ \ 1.50,\ \ 1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ -\/3.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ [-\/0.50,\ 0.00,\ 0.00,\ \ 0.75,\ \ 0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ -\/1.50],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ [\ 1.00,\ 0.00,\ 0.00,\ -\/1.50,\ -\/1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 3.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ [\ 0.50,\ 0.00,\ 0.00,\ -\/0.75,\ -\/0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 1.50]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00620}00620\ \ \ \ \ M1\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ [-\/0.50,\ 0.00,\ 0.00,\ \ 1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ [-\/0.25,\ 0.00,\ 0.00,\ \ 0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ [\ 0.50,\ 0.00,\ 0.00,\ -\/1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ [\ 0.25,\ 0.00,\ 0.00,\ -\/0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00629}00629\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00630}00630\ \ \ \ \ M2\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ [\ 0.50,\ 0.00,\ 0.00,\ 0.00,\ -\/1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ [\ 0.25,\ 0.00,\ 0.00,\ 0.00,\ -\/0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ [-\/0.50,\ 0.00,\ 0.00,\ 0.00,\ \ 1.50,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ [-\/0.25,\ 0.00,\ 0.00,\ 0.00,\ \ 0.75,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00638}00638\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ [\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ \ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00,\ 0.00]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00640}00640\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00641}00641\ \ \ \ \ \textcolor{comment}{\#\ 2)\ Loads\ matrices\ to\ rotate\ components\ of\ gradient\ \&\ Hessian}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00642}00642\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ vectors\ in\ the\ reference\ basis\ of\ triangle\ first\ apex\ (a0)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00643}00643\ \ \ \ \ rotate\_dV\ =\ np.array([[\ 1.,\ \ 0.],\ [\ 0.,\ \ 1.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 0.,\ \ 1.],\ [-\/1.,\ -\/1.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00645}00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.,\ -\/1.],\ [\ 1.,\ \ 0.]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00646}00646\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00647}00647\ \ \ \ \ rotate\_d2V\ =\ np.array([[1.,\ 0.,\ 0.],\ [0.,\ 1.,\ 0.],\ [\ 0.,\ \ 0.,\ \ 1.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 1.,\ 0.],\ [1.,\ 1.,\ 1.],\ [\ 0.,\ -\/2.,\ -\/1.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1.,\ 1.,\ 1.],\ [1.,\ 0.,\ 0.],\ [-\/2.,\ \ 0.,\ -\/1.]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00650}00650\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00651}00651\ \ \ \ \ \textcolor{comment}{\#\ 3)\ Loads\ Gauss\ points\ \&\ weights\ on\ the\ 3\ sub-\/\_triangles\ for\ P2}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00652}00652\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ exact\ integral\ -\/\ 3\ points\ on\ each\ subtriangles.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00653}00653\ \ \ \ \ \textcolor{comment}{\#\ NOTE:\ as\ the\ 2nd\ derivative\ is\ discontinuous\ ,\ we\ really\ need\ those\ 9}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00654}00654\ \ \ \ \ \textcolor{comment}{\#\ points!}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00655}00655\ \ \ \ \ n\_gauss\ =\ 9}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00656}00656\ \ \ \ \ gauss\_pts\ =\ np.array([[13./18.,\ \ 4./18.,\ \ 1./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 4./18.,\ 13./18.,\ \ 1./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 7./18.,\ \ 7./18.,\ \ 4./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 1./18.,\ 13./18.,\ \ 4./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 1./18.,\ \ 4./18.,\ 13./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 4./18.,\ \ 7./18.,\ \ 7./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00662}00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 4./18.,\ \ 1./18.,\ 13./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [13./18.,\ \ 1./18.,\ \ 4./18.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 7./18.,\ \ 4./18.,\ \ 7./18.]],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00665}00665\ \ \ \ \ gauss\_w\ =\ np.ones([9],\ dtype=np.float64)\ /\ 9.}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00666}00666\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00667}00667\ \ \ \ \ \textcolor{comment}{\#\ \ 4)\ Stiffness\ matrix\ for\ curvature\ energy}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00668}00668\ \ \ \ \ E\ =\ np.array([[1.,\ 0.,\ 0.],\ [0.,\ 1.,\ 0.],\ [0.,\ 0.,\ 2.]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00669}00669\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00670}00670\ \ \ \ \ \textcolor{comment}{\#\ \ 5)\ Loads\ the\ matrix\ to\ compute\ DOF\_rot\ from\ tri\_J\ at\ apex\ 0}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00671}00671\ \ \ \ \ J0\_to\_J1\ =\ np.array([[-\/1.,\ \ 1.],\ [-\/1.,\ \ 0.]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00672}00672\ \ \ \ \ J0\_to\_J2\ =\ np.array([[\ 0.,\ -\/1.],\ [\ 1.,\ -\/1.]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00673}00673\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00674}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a27460b7128d9e2485b21184d83622026}{00674}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a27460b7128d9e2485b21184d83622026}{get\_function\_values}}(self,\ alpha,\ ecc,\ dofs):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00675}00675\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00676}00676\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00677}00677\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00678}00678\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ alpha\ :\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00679}00679\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ barycentric\ coordinates,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00680}00680\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ecc\ :\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00681}00681\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00682}00682\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dofs\ :\ is\ a\ (N\ x\ 1\ x\ 9)\ arrays\ (arrays\ of\ row-\/matrices)\ of\ computed}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00683}00683\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ degrees\ of\ freedom.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00684}00684\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00685}00685\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00686}00686\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00687}00687\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ N-\/array\ of\ interpolated\ function\ values.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00688}00688\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00689}00689\ \ \ \ \ \ \ \ \ subtri\ =\ np.argmin(alpha,\ axis=1)[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00690}00690\ \ \ \ \ \ \ \ \ ksi\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(alpha,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00691}00691\ \ \ \ \ \ \ \ \ E\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(ecc,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ x\ =\ ksi[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00693}00693\ \ \ \ \ \ \ \ \ y\ =\ ksi[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ z\ =\ ksi[:,\ 2,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00695}00695\ \ \ \ \ \ \ \ \ x\_sq\ =\ x*x}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ y\_sq\ =\ y*y}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00697}00697\ \ \ \ \ \ \ \ \ z\_sq\ =\ z*z}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00698}00698\ \ \ \ \ \ \ \ \ V\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00699}00699\ \ \ \ \ \ \ \ \ \ \ \ \ [x\_sq*x],\ [y\_sq*y],\ [z\_sq*z],\ [x\_sq*z],\ [x\_sq*y],\ [y\_sq*x],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00700}00700\ \ \ \ \ \ \ \ \ \ \ \ \ [y\_sq*z],\ [z\_sq*y],\ [z\_sq*x],\ [x*y*z]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00701}00701\ \ \ \ \ \ \ \ \ prod\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a7bff49e225747ca6985d104069630ca9}{M}}\ @\ V}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00702}00702\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 0,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_af5c0f146732777be474dc67c6df7c798}{M0}}\ @\ V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00703}00703\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 1,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a40f0c0483ec890c675e3af176fbaf7de}{M1}}\ @\ V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00704}00704\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 2,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_aa93780a9f54e423b289d9091b244dece}{M2}}\ @\ V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00705}00705\ \ \ \ \ \ \ \ \ s\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(prod,\ 3*subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00706}00706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (dofs\ @\ s)[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00707}00707\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00708}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6a28d28ebcf308d0bd8cce0ba4cf225e}{00708}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6a28d28ebcf308d0bd8cce0ba4cf225e}{get\_function\_derivatives}}(self,\ alpha,\ J,\ ecc,\ dofs):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00709}00709\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00710}00710\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00711}00711\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00712}00712\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *alpha*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00713}00713\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ barycentric\ coordinates)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00714}00714\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *J*\ is\ a\ (N\ x\ 2\ x\ 2)\ array\ of\ jacobian\ matrices\ (jacobian\ matrix\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00715}00715\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ first\ apex)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00716}00716\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *ecc*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00717}00717\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00718}00718\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *dofs*\ is\ a\ (N\ x\ 1\ x\ 9)\ arrays\ (arrays\ of\ row-\/matrices)\ of\ computed}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00719}00719\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ degrees\ of\ freedom.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00720}00720\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00721}00721\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00722}00722\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00723}00723\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ values\ of\ interpolated\ function\ derivatives\ [dz/dx,\ dz/dy]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00724}00724\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ global\ coordinates\ at\ locations\ alpha,\ as\ a\ column-\/matrices\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00725}00725\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ shape\ (N\ x\ 2\ x\ 1).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00726}00726\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00727}00727\ \ \ \ \ \ \ \ \ subtri\ =\ np.argmin(alpha,\ axis=1)[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00728}00728\ \ \ \ \ \ \ \ \ ksi\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(alpha,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00729}00729\ \ \ \ \ \ \ \ \ E\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(ecc,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ x\ =\ ksi[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00731}00731\ \ \ \ \ \ \ \ \ y\ =\ ksi[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ z\ =\ ksi[:,\ 2,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ x\_sq\ =\ x*x}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ y\_sq\ =\ y*y}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00735}00735\ \ \ \ \ \ \ \ \ z\_sq\ =\ z*z}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00736}00736\ \ \ \ \ \ \ \ \ dV\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00737}00737\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ -\/3.*x\_sq,\ \ \ \ \ -\/3.*x\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00738}00738\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ 3.*y\_sq,\ \ \ \ \ \ \ \ \ \ \ 0.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00739}00739\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ \ \ \ 0.,\ \ \ \ \ \ 3.*z\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00740}00740\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ -\/2.*x*z,\ -\/2.*x*z+x\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00741}00741\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/2.*x*y+x\_sq,\ \ \ \ \ \ -\/2.*x*y],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ \ \ \ \ [\ 2.*x*y-\/y\_sq,\ \ \ \ \ \ \ \ -\/y\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ 2.*y*z,\ \ \ \ \ \ \ \ \ y\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ \ z\_sq,\ \ \ \ \ \ \ 2.*y*z],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00745}00745\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ -\/z\_sq,\ \ 2.*x*z-\/z\_sq],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00746}00746\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ x*z-\/y*z,\ \ \ \ \ \ x*y-\/y*z]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00747}00747\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Puts\ back\ dV\ in\ first\ apex\ basis}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00748}00748\ \ \ \ \ \ \ \ \ dV\ =\ dV\ @\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a20fbcf30d888929f741f348a88e21a29}{\_extract\_submatrices}}(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00749}00749\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_ab919ac71c37fbe8bad8f65d7a1864439}{rotate\_dV}},\ subtri,\ block\_size=2,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00750}00750\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00751}00751\ \ \ \ \ \ \ \ \ prod\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a7bff49e225747ca6985d104069630ca9}{M}}\ @\ dV}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 0,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_af5c0f146732777be474dc67c6df7c798}{M0}}\ @\ dV)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00753}00753\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 1,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a40f0c0483ec890c675e3af176fbaf7de}{M1}}\ @\ dV)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00754}00754\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 2,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_aa93780a9f54e423b289d9091b244dece}{M2}}\ @\ dV)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00755}00755\ \ \ \ \ \ \ \ \ dsdksi\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(prod,\ 3*subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00756}00756\ \ \ \ \ \ \ \ \ dfdksi\ =\ dofs\ @\ dsdksi}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00757}00757\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ global\ coordinates:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00758}00758\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ try\ to\ deal\ with\ the\ simplest\ colinear\ cases,\ returning\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00759}00759\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ null\ matrix.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00760}00760\ \ \ \ \ \ \ \ \ J\_inv\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_acc11bb85cb90fac2a1ea3295cb79a6c9}{\_safe\_inv22\_vectorized}}(J)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00761}00761\ \ \ \ \ \ \ \ \ dfdx\ =\ J\_inv\ @\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(dfdksi)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00762}00762\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dfdx}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00763}00763\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00764}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a30fd78a622b41fe4789a04f281a2b4d5}{00764}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a30fd78a622b41fe4789a04f281a2b4d5}{get\_function\_hessians}}(self,\ alpha,\ J,\ ecc,\ dofs):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00765}00765\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00766}00766\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00767}00767\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00768}00768\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *alpha*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00769}00769\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ barycentric\ coordinates}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00770}00770\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *J*\ is\ a\ (N\ x\ 2\ x\ 2)\ array\ of\ jacobian\ matrices\ (jacobian\ matrix\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00771}00771\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ first\ apex)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00772}00772\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *ecc*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00773}00773\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00774}00774\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *dofs*\ is\ a\ (N\ x\ 1\ x\ 9)\ arrays\ (arrays\ of\ row-\/matrices)\ of\ computed}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00775}00775\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ degrees\ of\ freedom.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00776}00776\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00777}00777\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00778}00778\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00779}00779\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ values\ of\ interpolated\ function\ 2nd-\/derivatives}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00780}00780\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [d2z/dx2,\ d2z/dy2,\ d2z/dxdy]\ in\ global\ coordinates\ at\ locations\ alpha,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00781}00781\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ a\ column-\/matrices\ of\ shape\ (N\ x\ 3\ x\ 1).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00782}00782\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00783}00783\ \ \ \ \ \ \ \ \ d2sdksi2\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a69a03be49e1cd103e713519fe0d6ce29}{get\_d2Sidksij2}}(alpha,\ ecc)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00784}00784\ \ \ \ \ \ \ \ \ d2fdksi2\ =\ dofs\ @\ d2sdksi2}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00785}00785\ \ \ \ \ \ \ \ \ H\_rot\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6d497cabcf8bce100cc388b053347630}{get\_Hrot\_from\_J}}(J)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00786}00786\ \ \ \ \ \ \ \ \ d2fdx2\ =\ d2fdksi2\ @\ H\_rot}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00787}00787\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(d2fdx2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00788}00788\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00789}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a69a03be49e1cd103e713519fe0d6ce29}{00789}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a69a03be49e1cd103e713519fe0d6ce29}{get\_d2Sidksij2}}(self,\ alpha,\ ecc):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00790}00790\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00791}00791\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00792}00792\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00793}00793\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *alpha*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00794}00794\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ barycentric\ coordinates}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00795}00795\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *ecc*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00796}00796\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00797}00797\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00798}00798\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00799}00799\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00800}00800\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ arrays\ d2sdksi2\ (N\ x\ 3\ x\ 1)\ Hessian\ of\ shape\ functions}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00801}00801\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ expressed\ in\ covariant\ coordinates\ in\ first\ apex\ basis.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00802}00802\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00803}00803\ \ \ \ \ \ \ \ \ subtri\ =\ np.argmin(alpha,\ axis=1)[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00804}00804\ \ \ \ \ \ \ \ \ ksi\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(alpha,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00805}00805\ \ \ \ \ \ \ \ \ E\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(ecc,\ -\/subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00806}00806\ \ \ \ \ \ \ \ \ x\ =\ ksi[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00807}00807\ \ \ \ \ \ \ \ \ y\ =\ ksi[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00808}00808\ \ \ \ \ \ \ \ \ z\ =\ ksi[:,\ 2,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00809}00809\ \ \ \ \ \ \ \ \ d2V\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00810}00810\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ 6.*x,\ \ \ \ \ \ 6.*x,\ \ \ \ \ \ 6.*x],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00811}00811\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ 6.*y,\ \ \ \ \ \ \ \ 0.,\ \ \ \ \ \ \ \ 0.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00812}00812\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ 0.,\ \ \ \ \ \ 6.*z,\ \ \ \ \ \ \ \ 0.],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00813}00813\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ 2.*z,\ 2.*z-\/4.*x,\ 2.*z-\/2.*x],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00814}00814\ \ \ \ \ \ \ \ \ \ \ \ \ [2.*y-\/4.*x,\ \ \ \ \ \ 2.*y,\ 2.*y-\/2.*x],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00815}00815\ \ \ \ \ \ \ \ \ \ \ \ \ [2.*x-\/4.*y,\ \ \ \ \ \ \ \ 0.,\ \ \ \ \ -\/2.*y],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00816}00816\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ 2.*z,\ \ \ \ \ \ \ \ 0.,\ \ \ \ \ \ 2.*y],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00817}00817\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ 0.,\ \ \ \ \ \ 2.*y,\ \ \ \ \ \ 2.*z],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00818}00818\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ 0.,\ 2.*x-\/4.*z,\ \ \ \ \ -\/2.*z],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00819}00819\ \ \ \ \ \ \ \ \ \ \ \ \ [\ \ \ \ -\/2.*z,\ \ \ \ \ -\/2.*y,\ \ \ \ \ x-\/y-\/z]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00820}00820\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Puts\ back\ d2V\ in\ first\ apex\ basis}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00821}00821\ \ \ \ \ \ \ \ \ d2V\ =\ d2V\ @\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a20fbcf30d888929f741f348a88e21a29}{\_extract\_submatrices}}(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00822}00822\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_ab436d5d9a73bec464679602e80d8fcd8}{rotate\_d2V}},\ subtri,\ block\_size=3,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00823}00823\ \ \ \ \ \ \ \ \ prod\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a7bff49e225747ca6985d104069630ca9}{M}}\ @\ d2V}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00824}00824\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 0,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_af5c0f146732777be474dc67c6df7c798}{M0}}\ @\ d2V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00825}00825\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 1,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a40f0c0483ec890c675e3af176fbaf7de}{M1}}\ @\ d2V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00826}00826\ \ \ \ \ \ \ \ \ prod\ +=\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(E[:,\ 2,\ 0],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_aa93780a9f54e423b289d9091b244dece}{M2}}\ @\ d2V)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00827}00827\ \ \ \ \ \ \ \ \ d2sdksi2\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(prod,\ 3*subtri,\ axis=0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00828}00828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ d2sdksi2}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00829}00829\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00830}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a314c05d9e9523563d55e1e7c611fc759}{00830}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a314c05d9e9523563d55e1e7c611fc759}{get\_bending\_matrices}}(self,\ J,\ ecc):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00831}00831\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00832}00832\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00833}00833\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00834}00834\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *J*\ is\ a\ (N\ x\ 2\ x\ 2)\ array\ of\ jacobian\ matrices\ (jacobian\ matrix\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00835}00835\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ first\ apex)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00836}00836\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *ecc*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00837}00837\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00838}00838\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00839}00839\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00840}00840\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00841}00841\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ the\ element\ K\ matrices\ for\ bending\ energy\ expressed\ in}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00842}00842\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ GLOBAL\ nodal\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00843}00843\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ K\_ij\ =\ integral\ [\ (d2zi/dx2\ +\ d2zi/dy2)\ *\ (d2zj/dx2\ +\ d2zj/dy2)\ dA]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00844}00844\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tri\_J\ is\ needed\ to\ rotate\ dofs\ from\ local\ basis\ to\ global\ basis}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00845}00845\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00846}00846\ \ \ \ \ \ \ \ \ n\ =\ np.size(ecc,\ 0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00847}00847\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00848}00848\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 1)\ matrix\ to\ rotate\ dofs\ in\ global\ coordinates}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00849}00849\ \ \ \ \ \ \ \ \ J1\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_af2cf493acb69008ef4f5666705ccf086}{J0\_to\_J1}}\ @\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00850}00850\ \ \ \ \ \ \ \ \ J2\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a66ab7bf5002302da3fe8d681d7c5396d}{J0\_to\_J2}}\ @\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00851}00851\ \ \ \ \ \ \ \ \ DOF\_rot\ =\ np.zeros([n,\ 9,\ 9],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00852}00852\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 0,\ 0]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00853}00853\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 3,\ 3]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00854}00854\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 6,\ 6]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00855}00855\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 1:3,\ 1:3]\ =\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00856}00856\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 4:6,\ 4:6]\ =\ J1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00857}00857\ \ \ \ \ \ \ \ \ DOF\_rot[:,\ 7:9,\ 7:9]\ =\ J2}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00858}00858\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00859}00859\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2)\ matrix\ to\ rotate\ Hessian\ in\ global\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00860}00860\ \ \ \ \ \ \ \ \ H\_rot,\ area\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6d497cabcf8bce100cc388b053347630}{get\_Hrot\_from\_J}}(J,\ return\_area=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00861}00861\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00862}00862\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 3)\ Computes\ stiffness\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00863}00863\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Gauss\ quadrature.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00864}00864\ \ \ \ \ \ \ \ \ K\ =\ np.zeros([n,\ 9,\ 9],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00865}00865\ \ \ \ \ \ \ \ \ weights\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a5fac43b5b7c631774a682e237bd8b62a}{gauss\_w}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00866}00866\ \ \ \ \ \ \ \ \ pts\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a15110a1c82b75c107417eca05a0597c6}{gauss\_pts}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00867}00867\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ igauss\ \textcolor{keywordflow}{in}\ range(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6afb49c1f5f0423c16644e4e367ac9da}{n\_gauss}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00868}00868\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ =\ np.tile(pts[igauss,\ :],\ n).reshape(n,\ 3)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00869}00869\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\ =\ np.expand\_dims(alpha,\ 2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00870}00870\ \ \ \ \ \ \ \ \ \ \ \ \ weight\ =\ weights[igauss]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00871}00871\ \ \ \ \ \ \ \ \ \ \ \ \ d2Skdksi2\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a69a03be49e1cd103e713519fe0d6ce29}{get\_d2Sidksij2}}(alpha,\ ecc)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00872}00872\ \ \ \ \ \ \ \ \ \ \ \ \ d2Skdx2\ =\ d2Skdksi2\ @\ H\_rot}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00873}00873\ \ \ \ \ \ \ \ \ \ \ \ \ K\ +=\ weight\ *\ (d2Skdx2\ @\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a56e2426c6b5a8a44e65d9710a4cdb02f}{E}}\ @\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(d2Skdx2))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00874}00874\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00875}00875\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 4)\ With\ nodal\ (not\ elem)\ dofs}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00876}00876\ \ \ \ \ \ \ \ \ K\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(DOF\_rot)\ @\ K\ @\ DOF\_rot}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00877}00877\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00878}00878\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 5)\ Need\ the\ area\ to\ compute\ total\ element\ energy}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00879}00879\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(area,\ K)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00880}00880\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00881}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6d497cabcf8bce100cc388b053347630}{00881}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a6d497cabcf8bce100cc388b053347630}{get\_Hrot\_from\_J}}(self,\ J,\ return\_area=False):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00882}00882\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00883}00883\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00884}00884\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00885}00885\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *J*\ is\ a\ (N\ x\ 2\ x\ 2)\ array\ of\ jacobian\ matrices\ (jacobian\ matrix\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00886}00886\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ first\ apex)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00887}00887\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00888}00888\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00889}00889\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00890}00890\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns\ H\_rot\ used\ to\ rotate\ Hessian\ from\ local\ basis\ of\ first\ apex,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00891}00891\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ global\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00892}00892\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ *return\_area*\ is\ True,\ returns\ also\ the\ triangle\ area\ (0.5*det(J))}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00893}00893\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00894}00894\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ try\ to\ deal\ with\ the\ simplest\ colinear\ cases;\ a\ null}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00895}00895\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ energy\ and\ area\ is\ imposed.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00896}00896\ \ \ \ \ \ \ \ \ J\_inv\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_acc11bb85cb90fac2a1ea3295cb79a6c9}{\_safe\_inv22\_vectorized}}(J)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00897}00897\ \ \ \ \ \ \ \ \ Ji00\ =\ J\_inv[:,\ 0,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00898}00898\ \ \ \ \ \ \ \ \ Ji11\ =\ J\_inv[:,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00899}00899\ \ \ \ \ \ \ \ \ Ji10\ =\ J\_inv[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00900}00900\ \ \ \ \ \ \ \ \ Ji01\ =\ J\_inv[:,\ 0,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00901}00901\ \ \ \ \ \ \ \ \ H\_rot\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00902}00902\ \ \ \ \ \ \ \ \ \ \ \ \ [Ji00*Ji00,\ Ji10*Ji10,\ Ji00*Ji10],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00903}00903\ \ \ \ \ \ \ \ \ \ \ \ \ [Ji01*Ji01,\ Ji11*Ji11,\ Ji01*Ji11],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00904}00904\ \ \ \ \ \ \ \ \ \ \ \ \ [2*Ji00*Ji01,\ 2*Ji11*Ji10,\ Ji00*Ji11+Ji10*Ji01]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00905}00905\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ return\_area:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00906}00906\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ H\_rot}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00907}00907\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00908}00908\ \ \ \ \ \ \ \ \ \ \ \ \ area\ =\ 0.5\ *\ (J[:,\ 0,\ 0]*J[:,\ 1,\ 1]\ -\/\ J[:,\ 0,\ 1]*J[:,\ 1,\ 0])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00909}00909\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ H\_rot,\ area}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00910}00910\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00911}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a8bcf79216447fab6b60b1cbb89240831}{00911}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a8bcf79216447fab6b60b1cbb89240831}{get\_Kff\_and\_Ff}}(self,\ J,\ ecc,\ triangles,\ Uc):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00912}00912\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00913}00913\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Build\ K\ and\ F\ for\ the\ following\ elliptic\ formulation:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00914}00914\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ minimization\ of\ curvature\ energy\ with\ value\ of\ function\ at\ node}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00915}00915\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ imposed\ and\ derivatives\ 'free'.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00916}00916\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00917}00917\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Build\ the\ global\ Kff\ matrix\ in\ cco\ format.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00918}00918\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Build\ the\ full\ Ff\ vec\ Ff\ =\ -\/\ Kfc\ x\ Uc.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00919}00919\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00920}00920\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00921}00921\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00922}00922\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *J*\ is\ a\ (N\ x\ 2\ x\ 2)\ array\ of\ jacobian\ matrices\ (jacobian\ matrix\ at}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00923}00923\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ first\ apex)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00924}00924\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *ecc*\ is\ a\ (N\ x\ 3\ x\ 1)\ array\ (array\ of\ column-\/matrices)\ of\ triangle}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00925}00925\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ eccentricities}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00926}00926\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *triangles*\ is\ a\ (N\ x\ 3)\ array\ of\ nodes\ indexes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00927}00927\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *Uc*\ is\ (N\ x\ 3)\ array\ of\ imposed\ displacements\ at\ nodes}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00928}00928\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00929}00929\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00930}00930\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00931}00931\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (Kff\_rows,\ Kff\_cols,\ Kff\_vals)\ Kff\ matrix\ in\ coo\ format\ -\/\ Duplicate}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00932}00932\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (row,\ col)\ entries\ must\ be\ summed.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00933}00933\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Ff:\ force\ vector\ -\/\ dim\ npts\ *\ 3}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00934}00934\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00935}00935\ \ \ \ \ \ \ \ \ ntri\ =\ np.size(ecc,\ 0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00936}00936\ \ \ \ \ \ \ \ \ vec\_range\ =\ np.arange(ntri,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00937}00937\ \ \ \ \ \ \ \ \ c\_indices\ =\ np.full(ntri,\ -\/1,\ dtype=np.int32)\ \ \textcolor{comment}{\#\ for\ unused\ dofs,\ -\/1}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00938}00938\ \ \ \ \ \ \ \ \ f\_dof\ =\ [1,\ 2,\ 4,\ 5,\ 7,\ 8]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00939}00939\ \ \ \ \ \ \ \ \ c\_dof\ =\ [0,\ 3,\ 6]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00940}00940\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00941}00941\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ vals,\ rows\ and\ cols\ indices\ in\ global\ dof\ numbering}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00942}00942\ \ \ \ \ \ \ \ \ f\_dof\_indices\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([[}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00943}00943\ \ \ \ \ \ \ \ \ \ \ \ \ c\_indices,\ triangles[:,\ 0]*2,\ triangles[:,\ 0]*2+1,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00944}00944\ \ \ \ \ \ \ \ \ \ \ \ \ c\_indices,\ triangles[:,\ 1]*2,\ triangles[:,\ 1]*2+1,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00945}00945\ \ \ \ \ \ \ \ \ \ \ \ \ c\_indices,\ triangles[:,\ 2]*2,\ triangles[:,\ 2]*2+1]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00946}00946\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00947}00947\ \ \ \ \ \ \ \ \ expand\_indices\ =\ np.ones([ntri,\ 9,\ 1],\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00948}00948\ \ \ \ \ \ \ \ \ f\_row\_indices\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(expand\_indices\ @\ f\_dof\_indices)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00949}00949\ \ \ \ \ \ \ \ \ f\_col\_indices\ =\ expand\_indices\ @\ f\_dof\_indices}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00950}00950\ \ \ \ \ \ \ \ \ K\_elem\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element_a314c05d9e9523563d55e1e7c611fc759}{get\_bending\_matrices}}(J,\ ecc)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00951}00951\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00952}00952\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Extracting\ sub-\/matrices}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00953}00953\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Explanation\ \&\ notations:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00954}00954\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ Subscript\ f\ denotes\ 'free'\ degrees\ of\ freedom\ (i.e.\ dz/dx,\ dz/dx)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00955}00955\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ Subscript\ c\ denotes\ 'condensated'\ (imposed)\ degrees\ of\ freedom}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00956}00956\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ (i.e.\ z\ at\ all\ nodes)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00957}00957\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ F\ =\ [Ff,\ Fc]\ is\ the\ force\ vector}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00958}00958\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ U\ =\ [Uf,\ Uc]\ is\ the\ imposed\ dof\ vector}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00959}00959\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ [\ Kff\ Kfc\ ]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00960}00960\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ K\ =\ \ [\ \ \ \ \ \ \ \ \ ]\ \ is\ the\ laplacian\ stiffness\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00961}00961\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ [\ Kcf\ Kff\ ]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00962}00962\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ *\ As\ F\ =\ K\ x\ U\ one\ gets\ straightforwardly:\ Ff\ =\ -\/\ Kfc\ x\ Uc}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00963}00963\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00964}00964\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ Kff\ stiffness\ matrix\ in\ sparse\ coo\ format}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00965}00965\ \ \ \ \ \ \ \ \ Kff\_vals\ =\ np.ravel(K\_elem[np.ix\_(vec\_range,\ f\_dof,\ f\_dof)])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00966}00966\ \ \ \ \ \ \ \ \ Kff\_rows\ =\ np.ravel(f\_row\_indices[np.ix\_(vec\_range,\ f\_dof,\ f\_dof)])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00967}00967\ \ \ \ \ \ \ \ \ Kff\_cols\ =\ np.ravel(f\_col\_indices[np.ix\_(vec\_range,\ f\_dof,\ f\_dof)])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00968}00968\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00969}00969\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Computing\ Ff\ force\ vector\ in\ sparse\ coo\ format}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00970}00970\ \ \ \ \ \ \ \ \ Kfc\_elem\ =\ K\_elem[np.ix\_(vec\_range,\ f\_dof,\ c\_dof)]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00971}00971\ \ \ \ \ \ \ \ \ Uc\_elem\ =\ np.expand\_dims(Uc,\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00972}00972\ \ \ \ \ \ \ \ \ Ff\_elem\ =\ -\/(Kfc\_elem\ @\ Uc\_elem)[:,\ :,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00973}00973\ \ \ \ \ \ \ \ \ Ff\_indices\ =\ f\_dof\_indices[np.ix\_(vec\_range,\ [0],\ f\_dof)][:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00974}00974\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00975}00975\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Extracting\ Ff\ force\ vector\ in\ dense\ format}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00976}00976\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ have\ to\ sum\ duplicate\ indices\ -\/\ \ using\ bincount}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00977}00977\ \ \ \ \ \ \ \ \ Ff\ =\ np.bincount(np.ravel(Ff\_indices),\ weights=np.ravel(Ff\_elem))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00978}00978\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Kff\_rows,\ Kff\_cols,\ Kff\_vals,\ Ff}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00979}00979\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00980}00980\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00981}00981\ \textcolor{comment}{\#\ :class:\_DOF\_estimator,\ \_DOF\_estimator\_user,\ \_DOF\_estimator\_geom,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00982}00982\ \textcolor{comment}{\#\ \_DOF\_estimator\_min\_E}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00983}00983\ \textcolor{comment}{\#\ Private\ classes\ used\ to\ compute\ the\ degree\ of\ freedom\ of\ each\ triangular}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00984}00984\ \textcolor{comment}{\#\ element\ for\ the\ TriCubicInterpolator.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00985}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator}{00985}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator}{\_DOF\_estimator}}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00986}00986\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00987}00987\ \textcolor{stringliteral}{\ \ \ \ Abstract\ base\ class\ for\ classes\ used\ to\ estimate\ a\ function's\ first}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00988}00988\ \textcolor{stringliteral}{\ \ \ \ derivatives,\ and\ deduce\ the\ dofs\ for\ a\ CubicTriInterpolator\ using\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00989}00989\ \textcolor{stringliteral}{\ \ \ \ reduced\ HCT\ element\ formulation.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00990}00990\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00991}00991\ \textcolor{stringliteral}{\ \ \ \ Derived\ classes\ implement\ \`{}\`{}compute\_df(self,\ **kwargs)\`{}\`{},\ returning}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00992}00992\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}np.vstack([dfx,\ dfy]).T\`{}\`{}\ where\ \`{}\`{}dfx,\ dfy\`{}\`{}\ are\ the\ estimation\ of\ the\ 2}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00993}00993\ \textcolor{stringliteral}{\ \ \ \ gradient\ coordinates.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00994}00994\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00995}00995\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ interpolator,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00996}00996\ \ \ \ \ \ \ \ \ \_api.check\_isinstance(CubicTriInterpolator,\ interpolator=interpolator)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00997}00997\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_aba4ed08c1d78136280245fcf34632990}{\_pts}}\ =\ interpolator.\_pts}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00998}00998\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_afa0ddbfea27be23ef3d2023f5644606c}{\_tris\_pts}}\ =\ interpolator.\_tris\_pts}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l00999}00999\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3f46b199082479305d0c2e8c605259f}{z}}\ =\ interpolator.\_z}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01000}01000\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}\ =\ interpolator.\_triangles}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01001}01001\ \ \ \ \ \ \ \ \ (self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a77c965ac63fe4bb4cccd629596d19d6d}{\_unit\_x}},\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3acacf18ae7b672d25440cedf654977}{\_unit\_y}})\ =\ (interpolator.\_unit\_x,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01002}01002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ interpolator.\_unit\_y)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01003}01003\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_adabe6667bf7690f984ff19adbcb02df4}{dz}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a58bec0b52573863a0a8a4aa9a3eb4b9c}{compute\_dz}}(**kwargs)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01004}01004\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a82fc2322de1f48dd303f98320e104301}{compute\_dof\_from\_df}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01005}01005\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01006}01006\ \ \ \ \ \textcolor{keyword}{def\ }compute\_dz(self,\ **kwargs):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01007}01007\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ NotImplementedError}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01008}01008\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01009}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a82fc2322de1f48dd303f98320e104301}{01009}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a82fc2322de1f48dd303f98320e104301}{compute\_dof\_from\_df}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01010}01010\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01011}01011\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ reduced-\/HCT\ elements\ degrees\ of\ freedom,\ from\ the\ gradient.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01012}01012\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01013}01013\ \ \ \ \ \ \ \ \ J\ =\ CubicTriInterpolator.\_get\_jacobian(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_afa0ddbfea27be23ef3d2023f5644606c}{\_tris\_pts}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01014}01014\ \ \ \ \ \ \ \ \ tri\_z\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3f46b199082479305d0c2e8c605259f}{z}}[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01015}01015\ \ \ \ \ \ \ \ \ tri\_dz\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_adabe6667bf7690f984ff19adbcb02df4}{dz}}[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01016}01016\ \ \ \ \ \ \ \ \ tri\_dof\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_aae5dea45479b94d29232a954ddf4a486}{get\_dof\_vec}}(tri\_z,\ tri\_dz,\ J)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01017}01017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tri\_dof}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01018}01018\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01019}01019\ \ \ \ \ \textcolor{preprocessor}{@staticmethod}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01020}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_aae5dea45479b94d29232a954ddf4a486}{01020}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_aae5dea45479b94d29232a954ddf4a486}{get\_dof\_vec}}(tri\_z,\ tri\_dz,\ J):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01021}01021\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01022}01022\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ the\ dof\ vector\ of\ a\ triangle,\ from\ the\ value\ of\ f,\ df\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01023}01023\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ the\ local\ Jacobian\ at\ each\ node.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01024}01024\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01025}01025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01026}01026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01027}01027\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tri\_z\ :\ shape\ (3,)\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01028}01028\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ f\ nodal\ values.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01029}01029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ tri\_dz\ :\ shape\ (3,\ 2)\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01030}01030\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ df/dx,\ df/dy\ nodal\ values.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01031}01031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ J}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01032}01032\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Jacobian\ matrix\ in\ local\ basis\ of\ apex\ 0.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01033}01033\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01034}01034\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01035}01035\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01036}01036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dof\ :\ shape\ (9,)\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01037}01037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ For\ each\ apex\ \`{}\`{}iapex\`{}\`{}::}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01038}01038\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01039}01039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dof[iapex*3+0]\ =\ f(Ai)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01040}01040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dof[iapex*3+1]\ =\ df(Ai).(AiAi+)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01041}01041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dof[iapex*3+2]\ =\ df(Ai).(AiAi-\/)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01042}01042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01043}01043\ \ \ \ \ \ \ \ \ npt\ =\ tri\_z.shape[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01044}01044\ \ \ \ \ \ \ \ \ dof\ =\ np.zeros([npt,\ 9],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01045}01045\ \ \ \ \ \ \ \ \ J1\ =\ \_ReducedHCT\_Element.J0\_to\_J1\ @\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01046}01046\ \ \ \ \ \ \ \ \ J2\ =\ \_ReducedHCT\_Element.J0\_to\_J2\ @\ J}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01047}01047\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01048}01048\ \ \ \ \ \ \ \ \ col0\ =\ J\ @\ np.expand\_dims(tri\_dz[:,\ 0,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01049}01049\ \ \ \ \ \ \ \ \ col1\ =\ J1\ @\ np.expand\_dims(tri\_dz[:,\ 1,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01050}01050\ \ \ \ \ \ \ \ \ col2\ =\ J2\ @\ np.expand\_dims(tri\_dz[:,\ 2,\ :],\ axis=2)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01051}01051\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01052}01052\ \ \ \ \ \ \ \ \ dfdksi\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}([}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01053}01053\ \ \ \ \ \ \ \ \ \ \ \ \ [col0[:,\ 0,\ 0],\ col1[:,\ 0,\ 0],\ col2[:,\ 0,\ 0]],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01054}01054\ \ \ \ \ \ \ \ \ \ \ \ \ [col0[:,\ 1,\ 0],\ col1[:,\ 1,\ 0],\ col2[:,\ 1,\ 0]]])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01055}01055\ \ \ \ \ \ \ \ \ dof[:,\ 0:7:3]\ =\ tri\_z}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01056}01056\ \ \ \ \ \ \ \ \ dof[:,\ 1:8:3]\ =\ dfdksi[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01057}01057\ \ \ \ \ \ \ \ \ dof[:,\ 2:9:3]\ =\ dfdksi[:,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01058}01058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dof}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01059}01059\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01060}01060\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01061}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__user}{01061}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__user}{\_DOF\_estimator\_user}}(\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator}{\_DOF\_estimator}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01062}01062\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}dz\ is\ imposed\ by\ user;\ accounts\ for\ scaling\ if\ any."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01063}01063\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01064}01064\ \ \ \ \ \textcolor{keyword}{def\ }compute\_dz(self,\ dz):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01065}01065\ \ \ \ \ \ \ \ \ (dzdx,\ dzdy)\ =\ dz}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01066}01066\ \ \ \ \ \ \ \ \ dzdx\ =\ dzdx\ *\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a77c965ac63fe4bb4cccd629596d19d6d}{\_unit\_x}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01067}01067\ \ \ \ \ \ \ \ \ dzdy\ =\ dzdy\ *\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3acacf18ae7b672d25440cedf654977}{\_unit\_y}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01068}01068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.vstack([dzdx,\ dzdy]).T}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01069}01069\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01070}01070\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01071}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom}{01071}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom}{\_DOF\_estimator\_geom}}(\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator}{\_DOF\_estimator}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01072}01072\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Fast\ 'geometric'\ approximation,\ recommended\ for\ large\ arrays."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01073}01073\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01074}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a26ccbeb3fab104038f75852af07bd515}{01074}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a26ccbeb3fab104038f75852af07bd515}{compute\_dz}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01075}01075\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01076}01076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ self.df\ is\ computed\ as\ weighted\ average\ of\ \_triangles\ sharing\ a\ common}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01077}01077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ node.\ On\ each\ triangle\ itri\ f\ is\ first\ assumed\ linear\ (=\ \string~f),\ which}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01078}01078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ allows\ to\ compute\ d\string~f[itri]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01079}01079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Then\ the\ following\ approximation\ of\ df\ nodal\ values\ is\ then\ proposed:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01080}01080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ f[ipt]\ =\ SUM\ (\ w[itri]\ x\ d\string~f[itri]\ ,\ for\ itri\ sharing\ apex\ ipt)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01081}01081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ weighted\ coeff.\ w[itri]\ are\ proportional\ to\ the\ angle\ of\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01082}01082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ triangle\ itri\ at\ apex\ ipt}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01083}01083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01084}01084\ \ \ \ \ \ \ \ \ el\_geom\_w\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a63b7307a722cf4403d0cfa9e9e875358}{compute\_geom\_weights}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01085}01085\ \ \ \ \ \ \ \ \ el\_geom\_grad\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a7058dd5c22f422a59feab9f2f179ea92}{compute\_geom\_grads}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01086}01086\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01087}01087\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Sum\ of\ weights\ coeffs}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01088}01088\ \ \ \ \ \ \ \ \ w\_node\_sum\ =\ np.bincount(np.ravel(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}),}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01089}01089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=np.ravel(el\_geom\_w))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01090}01090\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01091}01091\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Sum\ of\ weighted\ df\ =\ (dfx,\ dfy)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01092}01092\ \ \ \ \ \ \ \ \ dfx\_el\_w\ =\ np.empty\_like(el\_geom\_w)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01093}01093\ \ \ \ \ \ \ \ \ dfy\_el\_w\ =\ np.empty\_like(el\_geom\_w)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01094}01094\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ iapex\ \textcolor{keywordflow}{in}\ range(3):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01095}01095\ \ \ \ \ \ \ \ \ \ \ \ \ dfx\_el\_w[:,\ iapex]\ =\ el\_geom\_w[:,\ iapex]*el\_geom\_grad[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01096}01096\ \ \ \ \ \ \ \ \ \ \ \ \ dfy\_el\_w[:,\ iapex]\ =\ el\_geom\_w[:,\ iapex]*el\_geom\_grad[:,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01097}01097\ \ \ \ \ \ \ \ \ dfx\_node\_sum\ =\ np.bincount(np.ravel(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}),}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01098}01098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=np.ravel(dfx\_el\_w))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01099}01099\ \ \ \ \ \ \ \ \ dfy\_node\_sum\ =\ np.bincount(np.ravel(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}),}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01100}01100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=np.ravel(dfy\_el\_w))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01101}01101\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01102}01102\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Estimation\ of\ df}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01103}01103\ \ \ \ \ \ \ \ \ dfx\_estim\ =\ dfx\_node\_sum/w\_node\_sum}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01104}01104\ \ \ \ \ \ \ \ \ dfy\_estim\ =\ dfy\_node\_sum/w\_node\_sum}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01105}01105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.vstack([dfx\_estim,\ dfy\_estim]).T}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01106}01106\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01107}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a63b7307a722cf4403d0cfa9e9e875358}{01107}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a63b7307a722cf4403d0cfa9e9e875358}{compute\_geom\_weights}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01108}01108\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01109}01109\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Build\ the\ (nelems,\ 3)\ weights\ coeffs\ of\ \_triangles\ angles,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01110}01110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ renormalized\ so\ that\ np.sum(weights,\ axis=1)\ ==\ np.ones(nelems)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01111}01111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01112}01112\ \ \ \ \ \ \ \ \ weights\ =\ np.zeros([np.size(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}},\ 0),\ 3])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01113}01113\ \ \ \ \ \ \ \ \ tris\_pts\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_afa0ddbfea27be23ef3d2023f5644606c}{\_tris\_pts}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01114}01114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ipt\ \textcolor{keywordflow}{in}\ range(3):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01115}01115\ \ \ \ \ \ \ \ \ \ \ \ \ p0\ =\ tris\_pts[:,\ ipt\ \%\ 3,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01116}01116\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ tris\_pts[:,\ (ipt+1)\ \%\ 3,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01117}01117\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ tris\_pts[:,\ (ipt-\/1)\ \%\ 3,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01118}01118\ \ \ \ \ \ \ \ \ \ \ \ \ alpha1\ =\ np.arctan2(p1[:,\ 1]-\/p0[:,\ 1],\ p1[:,\ 0]-\/p0[:,\ 0])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01119}01119\ \ \ \ \ \ \ \ \ \ \ \ \ alpha2\ =\ np.arctan2(p2[:,\ 1]-\/p0[:,\ 1],\ p2[:,\ 0]-\/p0[:,\ 0])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01120}01120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ the\ below\ formula\ we\ could\ take\ modulo\ 2.\ but}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01121}01121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ modulo\ 1.\ is\ safer\ regarding\ round-\/off\ errors\ (flat\ triangles).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01122}01122\ \ \ \ \ \ \ \ \ \ \ \ \ angle\ =\ np.abs(((alpha2-\/alpha1)\ /\ np.pi)\ \%\ 1)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01123}01123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Weight\ proportional\ to\ angle\ up\ np.pi/2;\ null\ weight\ for}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01124}01124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ degenerated\ cases\ 0\ and\ np.pi\ (note\ that\ *angle*\ is\ normalized}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01125}01125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ by\ np.pi).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01126}01126\ \ \ \ \ \ \ \ \ \ \ \ \ weights[:,\ ipt]\ =\ 0.5\ -\/\ np.abs(angle-\/0.5)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01127}01127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ weights}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01128}01128\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01129}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a7058dd5c22f422a59feab9f2f179ea92}{01129}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom_a7058dd5c22f422a59feab9f2f179ea92}{compute\_geom\_grads}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01130}01130\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01131}01131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compute\ the\ (global)\ gradient\ component\ of\ f\ assumed\ linear\ (\string~f).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01132}01132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ returns\ array\ df\ of\ shape\ (nelems,\ 2)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01133}01133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ df[ielem].dM[ielem]\ =\ dz[ielem]\ i.e.\ df\ =\ dz\ x\ dM\ =\ dM.T\string^-\/1\ x\ dz}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01134}01134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01135}01135\ \ \ \ \ \ \ \ \ tris\_pts\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_afa0ddbfea27be23ef3d2023f5644606c}{\_tris\_pts}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01136}01136\ \ \ \ \ \ \ \ \ tris\_f\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3f46b199082479305d0c2e8c605259f}{z}}[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01137}01137\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01138}01138\ \ \ \ \ \ \ \ \ dM1\ =\ tris\_pts[:,\ 1,\ :]\ -\/\ tris\_pts[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01139}01139\ \ \ \ \ \ \ \ \ dM2\ =\ tris\_pts[:,\ 2,\ :]\ -\/\ tris\_pts[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01140}01140\ \ \ \ \ \ \ \ \ dM\ =\ np.dstack([dM1,\ dM2])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01141}01141\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ try\ to\ deal\ with\ the\ simplest\ colinear\ cases:\ a\ null}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01142}01142\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ gradient\ is\ assumed\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01143}01143\ \ \ \ \ \ \ \ \ dM\_inv\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_acc11bb85cb90fac2a1ea3295cb79a6c9}{\_safe\_inv22\_vectorized}}(dM)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01144}01144\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01145}01145\ \ \ \ \ \ \ \ \ dZ1\ =\ tris\_f[:,\ 1]\ -\/\ tris\_f[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01146}01146\ \ \ \ \ \ \ \ \ dZ2\ =\ tris\_f[:,\ 2]\ -\/\ tris\_f[:,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01147}01147\ \ \ \ \ \ \ \ \ dZ\ =\ np.vstack([dZ1,\ dZ2]).T}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01148}01148\ \ \ \ \ \ \ \ \ df\ =\ np.empty\_like(dZ)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01149}01149\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01150}01150\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ With\ np.einsum:\ could\ be\ ej,eji\ -\/>\ ej}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01151}01151\ \ \ \ \ \ \ \ \ df[:,\ 0]\ =\ dZ[:,\ 0]*dM\_inv[:,\ 0,\ 0]\ +\ dZ[:,\ 1]*dM\_inv[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01152}01152\ \ \ \ \ \ \ \ \ df[:,\ 1]\ =\ dZ[:,\ 0]*dM\_inv[:,\ 0,\ 1]\ +\ dZ[:,\ 1]*dM\_inv[:,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01153}01153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01154}01154\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01155}01155\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01156}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E}{01156}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E}{\_DOF\_estimator\_min\_E}}(\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__geom}{\_DOF\_estimator\_geom}}):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01157}01157\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01158}01158\ \textcolor{stringliteral}{\ \ \ \ The\ 'smoothest'\ approximation,\ df\ is\ computed\ through\ global\ minimization}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01159}01159\ \textcolor{stringliteral}{\ \ \ \ of\ the\ bending\ energy:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01160}01160\ \textcolor{stringliteral}{\ \ \ \ \ \ E(f)\ =\ integral[(d2z/dx2\ +\ d2z/dy2\ +\ 2\ d2z/dxdy)**2\ dA]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01161}01161\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01162}01162\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ Interpolator):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01163}01163\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E_a073d1ae45c96dff317c2907dc001b168}{\_eccs}}\ =\ Interpolator.\_eccs}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01164}01164\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(Interpolator)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01165}01165\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01166}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E_aaefd247767879eedbbf40fe834c4b3ff}{01166}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E_aaefd247767879eedbbf40fe834c4b3ff}{compute\_dz}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01167}01167\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01168}01168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Elliptic\ solver\ for\ bending\ energy\ minimization.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01169}01169\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Uses\ a\ dedicated\ 'toy'\ sparse\ Jacobi\ PCG\ solver.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01170}01170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01171}01171\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initial\ guess\ for\ iterative\ PCG\ solver.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01172}01172\ \ \ \ \ \ \ \ \ dz\_init\ =\ super().\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E_aaefd247767879eedbbf40fe834c4b3ff}{compute\_dz}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01173}01173\ \ \ \ \ \ \ \ \ Uf0\ =\ np.ravel(dz\_init)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01174}01174\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01175}01175\ \ \ \ \ \ \ \ \ reference\_element\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__ReducedHCT__Element}{\_ReducedHCT\_Element}}()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01176}01176\ \ \ \ \ \ \ \ \ J\ =\ CubicTriInterpolator.\_get\_jacobian(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_afa0ddbfea27be23ef3d2023f5644606c}{\_tris\_pts}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01177}01177\ \ \ \ \ \ \ \ \ eccs\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator__min__E_a073d1ae45c96dff317c2907dc001b168}{\_eccs}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01178}01178\ \ \ \ \ \ \ \ \ triangles\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01179}01179\ \ \ \ \ \ \ \ \ Uc\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_ad3f46b199082479305d0c2e8c605259f}{z}}[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_a31b9af43d29a4389075dc990ba012000}{\_triangles}}]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01180}01180\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01181}01181\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Building\ stiffness\ matrix\ and\ force\ vector\ in\ coo\ format}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01182}01182\ \ \ \ \ \ \ \ \ Kff\_rows,\ Kff\_cols,\ Kff\_vals,\ Ff\ =\ reference\_element.get\_Kff\_and\_Ff(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01183}01183\ \ \ \ \ \ \ \ \ \ \ \ \ J,\ eccs,\ triangles,\ Uc)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01184}01184\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01185}01185\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Building\ sparse\ matrix\ and\ solving\ minimization\ problem}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01186}01186\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ could\ use\ scipy.sparse\ direct\ solver;\ however\ to\ avoid\ this}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01187}01187\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ external\ dependency\ an\ implementation\ of\ a\ simple\ PCG\ solver\ with}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01188}01188\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\ simple\ diagonal\ Jacobi\ preconditioner\ is\ implemented.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01189}01189\ \ \ \ \ \ \ \ \ tol\ =\ 1.e-\/10}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01190}01190\ \ \ \ \ \ \ \ \ n\_dof\ =\ Ff.shape[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01191}01191\ \ \ \ \ \ \ \ \ Kff\_coo\ =\ \mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo}{\_Sparse\_Matrix\_coo}}(Kff\_vals,\ Kff\_rows,\ Kff\_cols,}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01192}01192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shape=(n\_dof,\ n\_dof))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01193}01193\ \ \ \ \ \ \ \ \ Kff\_coo.compress\_csc()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01194}01194\ \ \ \ \ \ \ \ \ Uf,\ err\ =\ \mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_aa5eff9355c0a78bf39e0d9cc6b1ea8bd}{\_cg}}(A=Kff\_coo,\ b=Ff,\ x0=Uf0,\ tol=tol)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01195}01195\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ PCG\ did\ not\ converge,\ we\ return\ the\ best\ guess\ between\ Uf0}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01196}01196\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ Uf.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01197}01197\ \ \ \ \ \ \ \ \ err0\ =\ np.linalg.norm(Kff\_coo.dot(Uf0)\ -\/\ Ff)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01198}01198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ err0\ <\ err:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01199}01199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Maybe\ a\ good\ occasion\ to\ raise\ a\ warning\ here\ ?}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01200}01200\ \ \ \ \ \ \ \ \ \ \ \ \ \_api.warn\_external(\textcolor{stringliteral}{"{}In\ TriCubicInterpolator\ initialization,\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01201}01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PCG\ sparse\ solver\ did\ not\ converge\ after\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01202}01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}1000\ iterations.\ \`{}geom`\ approximation\ is\ "{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01203}01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}used\ instead\ of\ \`{}min\_E`"{}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01204}01204\ \ \ \ \ \ \ \ \ \ \ \ \ Uf\ =\ Uf0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01205}01205\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01206}01206\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Building\ dz\ from\ Uf}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01207}01207\ \ \ \ \ \ \ \ \ dz\ =\ np.empty([self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__DOF__estimator_aba4ed08c1d78136280245fcf34632990}{\_pts}}.shape[0],\ 2],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01208}01208\ \ \ \ \ \ \ \ \ dz[:,\ 0]\ =\ Uf[::2]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01209}01209\ \ \ \ \ \ \ \ \ dz[:,\ 1]\ =\ Uf[1::2]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01210}01210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ dz}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01211}01211\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01212}01212\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01213}01213\ \textcolor{comment}{\#\ The\ following\ private\ :class:\_Sparse\_Matrix\_coo\ and\ :func:\_cg\ provide}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01214}01214\ \textcolor{comment}{\#\ a\ PCG\ sparse\ solver\ for\ (symmetric)\ elliptic\ problems.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01215}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo}{01215}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo}{\_Sparse\_Matrix\_coo}}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01216}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae732ea137af34d8d11c91b240b8fa893}{01216}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae732ea137af34d8d11c91b240b8fa893}{\_\_init\_\_}}(self,\ vals,\ rows,\ cols,\ shape):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01217}01217\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01218}01218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Create\ a\ sparse\ matrix\ in\ coo\ format.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01219}01219\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *vals*:\ arrays\ of\ values\ of\ non-\/null\ entries\ of\ the\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01220}01220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *rows*:\ int\ arrays\ of\ rows\ of\ non-\/null\ entries\ of\ the\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01221}01221\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *cols*:\ int\ arrays\ of\ cols\ of\ non-\/null\ entries\ of\ the\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01222}01222\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *shape*:\ 2-\/tuple\ (n,\ m)\ of\ matrix\ shape}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01223}01223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01224}01224\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac185106b53ffa9ad34d818082790ba64}{n}},\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac48d2ac94cda71c0e2096315ef085794}{m}}\ =\ shape}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01225}01225\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}\ =\ np.asarray(vals,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01226}01226\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ =\ np.asarray(rows,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01227}01227\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}\ =\ np.asarray(cols,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01228}01228\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01229}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ad73fa043bdcca1334aa5e9737a71db49}{01229}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ad73fa043bdcca1334aa5e9737a71db49}{dot}}(self,\ V):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01230}01230\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01231}01231\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Dot\ product\ of\ self\ by\ a\ vector\ *V*\ in\ sparse-\/dense\ to\ dense\ format}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01232}01232\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *V*\ dense\ vector\ of\ shape\ (self.m,).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01233}01233\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01234}01234\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ V.shape\ ==\ (self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac48d2ac94cda71c0e2096315ef085794}{m}},)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01235}01235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.bincount(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01236}01236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights=self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}*V[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}],}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01237}01237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minlength=self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac48d2ac94cda71c0e2096315ef085794}{m}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01238}01238\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01239}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ad1b7c7f7cf98bbe7dee6ff50c7ff4287}{01239}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ad1b7c7f7cf98bbe7dee6ff50c7ff4287}{compress\_csc}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01240}01240\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01241}01241\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compress\ rows,\ cols,\ vals\ /\ summing\ duplicates.\ Sort\ for\ csc\ format.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01242}01242\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01243}01243\ \ \ \ \ \ \ \ \ \_,\ unique,\ indices\ =\ np.unique(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01244}01244\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ +\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac185106b53ffa9ad34d818082790ba64}{n}}*self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01245}01245\ \ \ \ \ \ \ \ \ \ \ \ \ return\_index=\textcolor{keyword}{True},\ return\_inverse=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01246}01246\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}[unique]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01247}01247\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}[unique]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01248}01248\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}\ =\ np.bincount(indices,\ weights=self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01249}01249\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01250}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_abdf816af71e42f9ae4ad3bd28d02397f}{01250}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_abdf816af71e42f9ae4ad3bd28d02397f}{compress\_csr}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01251}01251\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01252}01252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Compress\ rows,\ cols,\ vals\ /\ summing\ duplicates.\ Sort\ for\ csr\ format.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01253}01253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01254}01254\ \ \ \ \ \ \ \ \ \_,\ unique,\ indices\ =\ np.unique(}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01255}01255\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac48d2ac94cda71c0e2096315ef085794}{m}}*self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ +\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}},}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01256}01256\ \ \ \ \ \ \ \ \ \ \ \ \ return\_index=\textcolor{keyword}{True},\ return\_inverse=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01257}01257\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}[unique]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01258}01258\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}[unique]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01259}01259\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}\ =\ np.bincount(indices,\ weights=self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01260}01260\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01261}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a5297b777eea44142923927064edfe999}{01261}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a5297b777eea44142923927064edfe999}{to\_dense}}(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01262}01262\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01263}01263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return\ a\ dense\ matrix\ representing\ self,\ mainly\ for\ debugging\ purposes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01264}01264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01265}01265\ \ \ \ \ \ \ \ \ ret\ =\ np.zeros([self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac185106b53ffa9ad34d818082790ba64}{n}},\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac48d2ac94cda71c0e2096315ef085794}{m}}],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01266}01266\ \ \ \ \ \ \ \ \ nvals\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}.size}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01267}01267\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(nvals):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01268}01268\ \ \ \ \ \ \ \ \ \ \ \ \ ret[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}[i],\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}}[i]]\ +=\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}[i]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01269}01269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01270}01270\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01271}01271\ \ \ \ \ \textcolor{keyword}{def\ }\_\_str\_\_(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01272}01272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a5297b777eea44142923927064edfe999}{to\_dense}}().\_\_str\_\_()}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01273}01273\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01274}01274\ \ \ \ \ \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01275}\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae0c7e4e32ec623346223315608810312}{01275}}\ \ \ \ \ \textcolor{keyword}{def\ }diag(self):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01276}01276\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ the\ (dense)\ vector\ of\ the\ diagonal\ elements."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01277}01277\ \ \ \ \ \ \ \ \ in\_diag\ =\ (self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}\ ==\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_af52b36bcd0d49c2dbc2c00361b4cafce}{cols}})}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01278}01278\ \ \ \ \ \ \ \ \ diag\ =\ np.zeros(min(self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac185106b53ffa9ad34d818082790ba64}{n}},\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ac185106b53ffa9ad34d818082790ba64}{n}}),\ dtype=np.float64)\ \ \textcolor{comment}{\#\ default\ 0.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01279}01279\ \ \ \ \ \ \ \ \ diag[self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_ae42512759e8b1aa0229bde972ea01cf0}{rows}}[in\_diag]]\ =\ self.\mbox{\hyperlink{classmatplotlib_1_1tri_1_1__triinterpolate_1_1__Sparse__Matrix__coo_a4303379f1c597a54f01d591d82043704}{vals}}[in\_diag]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01280}01280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ diag}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01281}01281\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01282}01282\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01283}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_aa5eff9355c0a78bf39e0d9cc6b1ea8bd}{01283}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_aa5eff9355c0a78bf39e0d9cc6b1ea8bd}{\_cg}}(A,\ b,\ x0=None,\ tol=1.e-\/10,\ maxiter=1000):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01284}01284\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01285}01285\ \textcolor{stringliteral}{\ \ \ \ Use\ Preconditioned\ Conjugate\ Gradient\ iteration\ to\ solve\ A\ x\ =\ b}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01286}01286\ \textcolor{stringliteral}{\ \ \ \ A\ simple\ Jacobi\ (diagonal)\ preconditioner\ is\ used.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01287}01287\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01288}01288\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01289}01289\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01290}01290\ \textcolor{stringliteral}{\ \ \ \ A\ :\ \_Sparse\_Matrix\_coo}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01291}01291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *A*\ must\ have\ been\ compressed\ before\ by\ compress\_csc\ or}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01292}01292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ compress\_csr\ method.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01293}01293\ \textcolor{stringliteral}{\ \ \ \ b\ :\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01294}01294\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right\ hand\ side\ of\ the\ linear\ system.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01295}01295\ \textcolor{stringliteral}{\ \ \ \ x0\ :\ array,\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01296}01296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Starting\ guess\ for\ the\ solution.\ Defaults\ to\ the\ zero\ vector.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01297}01297\ \textcolor{stringliteral}{\ \ \ \ tol\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01298}01298\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Tolerance\ to\ achieve.\ The\ algorithm\ terminates\ when\ the\ relative}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01299}01299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ residual\ is\ below\ tol.\ Default\ is\ 1e-\/10.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01300}01300\ \textcolor{stringliteral}{\ \ \ \ maxiter\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01301}01301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations.\ \ Iteration\ will\ stop\ after\ *maxiter*}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01302}01302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ steps\ even\ if\ the\ specified\ tolerance\ has\ not\ been\ achieved.\ Defaults}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01303}01303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ 1000.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01304}01304\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01305}01305\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01306}01306\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01307}01307\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01308}01308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ converged\ solution.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01309}01309\ \textcolor{stringliteral}{\ \ \ \ err\ :\ float}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01310}01310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ absolute\ error\ np.linalg.norm(A.dot(x)\ -\/\ b)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01311}01311\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01312}01312\ \ \ \ \ n\ =\ b.size}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01313}01313\ \ \ \ \ \textcolor{keyword}{assert}\ A.n\ ==\ n}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01314}01314\ \ \ \ \ \textcolor{keyword}{assert}\ A.m\ ==\ n}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01315}01315\ \ \ \ \ b\_norm\ =\ np.linalg.norm(b)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01316}01316\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01317}01317\ \ \ \ \ \textcolor{comment}{\#\ Jacobi\ pre-\/conditioner}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01318}01318\ \ \ \ \ kvec\ =\ A.diag}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01319}01319\ \ \ \ \ \textcolor{comment}{\#\ For\ diag\ elem\ <\ 1e-\/6\ we\ keep\ 1e-\/6.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01320}01320\ \ \ \ \ kvec\ =\ np.maximum(kvec,\ 1e-\/6)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01321}01321\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01322}01322\ \ \ \ \ \textcolor{comment}{\#\ Initial\ guess}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01323}01323\ \ \ \ \ \textcolor{keywordflow}{if}\ x0\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01324}01324\ \ \ \ \ \ \ \ \ x\ =\ np.zeros(n)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01325}01325\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01326}01326\ \ \ \ \ \ \ \ \ x\ =\ x0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01327}01327\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01328}01328\ \ \ \ \ r\ =\ b\ -\/\ A.dot(x)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01329}01329\ \ \ \ \ w\ =\ r/kvec}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01330}01330\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01331}01331\ \ \ \ \ p\ =\ np.zeros(n)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01332}01332\ \ \ \ \ beta\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01333}01333\ \ \ \ \ rho\ =\ np.dot(r,\ w)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01334}01334\ \ \ \ \ k\ =\ 0}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01335}01335\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01336}01336\ \ \ \ \ \textcolor{comment}{\#\ Following\ C.\ T.\ Kelley}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01337}01337\ \ \ \ \ \textcolor{keywordflow}{while}\ (np.sqrt(abs(rho))\ >\ tol*b\_norm)\ \textcolor{keywordflow}{and}\ (k\ <\ maxiter):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01338}01338\ \ \ \ \ \ \ \ \ p\ =\ w\ +\ beta*p}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01339}01339\ \ \ \ \ \ \ \ \ z\ =\ A.dot(p)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01340}01340\ \ \ \ \ \ \ \ \ alpha\ =\ rho/np.dot(p,\ z)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01341}01341\ \ \ \ \ \ \ \ \ r\ =\ r\ -\/\ alpha*z}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01342}01342\ \ \ \ \ \ \ \ \ w\ =\ r/kvec}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01343}01343\ \ \ \ \ \ \ \ \ rhoold\ =\ rho}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01344}01344\ \ \ \ \ \ \ \ \ rho\ =\ np.dot(r,\ w)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01345}01345\ \ \ \ \ \ \ \ \ x\ =\ x\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01346}01346\ \ \ \ \ \ \ \ \ beta\ =\ rho/rhoold}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01347}01347\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ err\ =\ np.linalg.norm(A.dot(x)\ -\/\ b)\ \ \#\ absolute\ accuracy\ -\/\ not\ used}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01348}01348\ \ \ \ \ \ \ \ \ k\ +=\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01349}01349\ \ \ \ \ err\ =\ np.linalg.norm(A.dot(x)\ -\/\ b)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01350}01350\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ err}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01351}01351\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01352}01352\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01353}01353\ \textcolor{comment}{\#\ The\ following\ private\ functions:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01354}01354\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_safe\_inv22\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01355}01355\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_pseudo\_inv22sym\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01356}01356\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_scalar\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01357}01357\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_transpose\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01358}01358\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_roll\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01359}01359\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_to\_matrix\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01360}01360\ \textcolor{comment}{\#\ \ \ \ \ :func:`\_extract\_submatrices`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01361}01361\ \textcolor{comment}{\#\ provide\ fast\ numpy\ implementation\ of\ some\ standard\ operations\ on\ arrays\ of}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01362}01362\ \textcolor{comment}{\#\ matrices\ -\/\ stored\ as\ (:,\ n\_rows,\ n\_cols)-\/shaped\ np.arrays.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01363}01363\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01364}01364\ \textcolor{comment}{\#\ Development\ note:\ Dealing\ with\ pathologic\ 'flat'\ triangles\ in\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01365}01365\ \textcolor{comment}{\#\ CubicTriInterpolator\ code\ and\ impact\ on\ (2,\ 2)-\/matrix\ inversion\ functions}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01366}01366\ \textcolor{comment}{\#\ :func:`\_safe\_inv22\_vectorized`\ and\ :func:`\_pseudo\_inv22sym\_vectorized`.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01367}01367\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01368}01368\ \textcolor{comment}{\#\ Goals:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01369}01369\ \textcolor{comment}{\#\ 1)\ The\ CubicTriInterpolator\ should\ be\ able\ to\ handle\ flat\ or\ almost\ flat}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01370}01370\ \textcolor{comment}{\#\ \ \ \ triangles\ without\ raising\ an\ error,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01371}01371\ \textcolor{comment}{\#\ 2)\ These\ degenerated\ triangles\ should\ have\ no\ impact\ on\ the\ automatic\ dof}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01372}01372\ \textcolor{comment}{\#\ \ \ \ calculation\ (associated\ with\ null\ weight\ for\ the\ \_DOF\_estimator\_geom\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01373}01373\ \textcolor{comment}{\#\ \ \ \ with\ null\ energy\ for\ the\ \_DOF\_estimator\_min\_E),}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01374}01374\ \textcolor{comment}{\#\ 3)\ Linear\ patch\ test\ should\ be\ passed\ exactly\ on\ degenerated\ meshes,}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01375}01375\ \textcolor{comment}{\#\ 4)\ Interpolation\ (with\ :meth:`\_interpolate\_single\_key`\ or}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01376}01376\ \textcolor{comment}{\#\ \ \ \ :meth:`\_interpolate\_multi\_key`)\ shall\ be\ correctly\ handled\ even\ *inside*}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01377}01377\ \textcolor{comment}{\#\ \ \ \ the\ pathologic\ triangles,\ to\ interact\ correctly\ with\ a\ TriRefiner\ class.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01378}01378\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01379}01379\ \textcolor{comment}{\#\ Difficulties:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01380}01380\ \textcolor{comment}{\#\ Flat\ triangles\ have\ rank-\/deficient\ *J*\ (so-\/called\ jacobian\ matrix)\ and}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01381}01381\ \textcolor{comment}{\#\ *metric*\ (the\ metric\ tensor\ =\ J\ x\ J.T).\ Computation\ of\ the\ local}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01382}01382\ \textcolor{comment}{\#\ tangent\ plane\ is\ also\ problematic.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01383}01383\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01384}01384\ \textcolor{comment}{\#\ Implementation:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01385}01385\ \textcolor{comment}{\#\ Most\ of\ the\ time,\ when\ computing\ the\ inverse\ of\ a\ rank-\/deficient\ matrix\ it}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01386}01386\ \textcolor{comment}{\#\ is\ safe\ to\ simply\ return\ the\ null\ matrix\ (which\ is\ the\ implementation\ in}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01387}01387\ \textcolor{comment}{\#\ :func:`\_safe\_inv22\_vectorized`).\ This\ is\ because\ of\ point\ 2),\ itself}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01388}01388\ \textcolor{comment}{\#\ enforced\ by:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01389}01389\ \textcolor{comment}{\#\ \ \ \ -\/\ null\ area\ hence\ null\ energy\ in\ :class:`\_DOF\_estimator\_min\_E`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01390}01390\ \textcolor{comment}{\#\ \ \ \ -\/\ angles\ close\ or\ equal\ to\ 0\ or\ np.pi\ hence\ null\ weight\ in}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01391}01391\ \textcolor{comment}{\#\ \ \ \ \ \ :class:`\_DOF\_estimator\_geom`.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01392}01392\ \textcolor{comment}{\#\ \ \ \ \ \ Note\ that\ the\ function\ angle\ -\/>\ weight\ is\ continuous\ and\ maximum\ for\ an}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01393}01393\ \textcolor{comment}{\#\ \ \ \ \ \ angle\ np.pi/2\ (refer\ to\ :meth:`compute\_geom\_weights`)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01394}01394\ \textcolor{comment}{\#\ The\ exception\ is\ the\ computation\ of\ barycentric\ coordinates,\ which\ is\ done}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01395}01395\ \textcolor{comment}{\#\ by\ inversion\ of\ the\ *metric*\ matrix.\ In\ this\ case,\ we\ need\ to\ compute\ a\ set}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01396}01396\ \textcolor{comment}{\#\ of\ valid\ coordinates\ (1\ among\ numerous\ possibilities),\ to\ ensure\ point\ 4).}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01397}01397\ \textcolor{comment}{\#\ We\ benefit\ here\ from\ the\ symmetry\ of\ metric\ =\ J\ x\ J.T,\ which\ makes\ it\ easier}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01398}01398\ \textcolor{comment}{\#\ to\ compute\ a\ pseudo-\/inverse\ in\ :func:`\_pseudo\_inv22sym\_vectorized`}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01399}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_acc11bb85cb90fac2a1ea3295cb79a6c9}{01399}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_acc11bb85cb90fac2a1ea3295cb79a6c9}{\_safe\_inv22\_vectorized}}(M):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01400}01400\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01401}01401\ \textcolor{stringliteral}{\ \ \ \ Inversion\ of\ arrays\ of\ (2,\ 2)\ matrices,\ returns\ 0\ for\ rank-\/deficient}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01402}01402\ \textcolor{stringliteral}{\ \ \ \ matrices.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01403}01403\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01404}01404\ \textcolor{stringliteral}{\ \ \ \ *M*\ :\ array\ of\ (2,\ 2)\ matrices\ to\ inverse,\ shape\ (n,\ 2,\ 2)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01405}01405\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01406}01406\ \ \ \ \ \_api.check\_shape((\textcolor{keywordtype}{None},\ 2,\ 2),\ M=M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01407}01407\ \ \ \ \ M\_inv\ =\ np.empty\_like(M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01408}01408\ \ \ \ \ prod1\ =\ M[:,\ 0,\ 0]*M[:,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01409}01409\ \ \ \ \ delta\ =\ prod1\ -\/\ M[:,\ 0,\ 1]*M[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01410}01410\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01411}01411\ \ \ \ \ \textcolor{comment}{\#\ We\ set\ delta\_inv\ to\ 0.\ in\ case\ of\ a\ rank\ deficient\ matrix;\ a}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01412}01412\ \ \ \ \ \textcolor{comment}{\#\ rank-\/deficient\ input\ matrix\ *M*\ will\ lead\ to\ a\ null\ matrix\ in\ output}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01413}01413\ \ \ \ \ rank2\ =\ (np.abs(delta)\ >\ 1e-\/8*np.abs(prod1))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01414}01414\ \ \ \ \ \textcolor{keywordflow}{if}\ np.all(rank2):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01415}01415\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Normal\ 'optimized'\ flow.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01416}01416\ \ \ \ \ \ \ \ \ delta\_inv\ =\ 1./delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01417}01417\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01418}01418\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 'Pathologic'\ flow.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01419}01419\ \ \ \ \ \ \ \ \ delta\_inv\ =\ np.zeros(M.shape[0])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01420}01420\ \ \ \ \ \ \ \ \ delta\_inv[rank2]\ =\ 1./delta[rank2]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01421}01421\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01422}01422\ \ \ \ \ M\_inv[:,\ 0,\ 0]\ =\ M[:,\ 1,\ 1]*delta\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01423}01423\ \ \ \ \ M\_inv[:,\ 0,\ 1]\ =\ -\/M[:,\ 0,\ 1]*delta\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01424}01424\ \ \ \ \ M\_inv[:,\ 1,\ 0]\ =\ -\/M[:,\ 1,\ 0]*delta\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01425}01425\ \ \ \ \ M\_inv[:,\ 1,\ 1]\ =\ M[:,\ 0,\ 0]*delta\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01426}01426\ \ \ \ \ \textcolor{keywordflow}{return}\ M\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01427}01427\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01428}01428\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01429}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a35e96be952e386567060ae058d73b547}{01429}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a35e96be952e386567060ae058d73b547}{\_pseudo\_inv22sym\_vectorized}}(M):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01430}01430\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01431}01431\ \textcolor{stringliteral}{\ \ \ \ Inversion\ of\ arrays\ of\ (2,\ 2)\ SYMMETRIC\ matrices;\ returns\ the}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01432}01432\ \textcolor{stringliteral}{\ \ \ \ (Moore-\/Penrose)\ pseudo-\/inverse\ for\ rank-\/deficient\ matrices.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01433}01433\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01434}01434\ \textcolor{stringliteral}{\ \ \ \ In\ case\ M\ is\ of\ rank\ 1,\ we\ have\ M\ =\ trace(M)\ x\ P\ where\ P\ is\ the\ orthogonal}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01435}01435\ \textcolor{stringliteral}{\ \ \ \ projection\ on\ Im(M),\ and\ we\ return\ trace(M)\string^-\/1\ x\ P\ ==\ M\ /\ trace(M)**2}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01436}01436\ \textcolor{stringliteral}{\ \ \ \ In\ case\ M\ is\ of\ rank\ 0,\ we\ return\ the\ null\ matrix.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01437}01437\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01438}01438\ \textcolor{stringliteral}{\ \ \ \ *M*\ :\ array\ of\ (2,\ 2)\ matrices\ to\ inverse,\ shape\ (n,\ 2,\ 2)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01439}01439\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01440}01440\ \ \ \ \ \_api.check\_shape((\textcolor{keywordtype}{None},\ 2,\ 2),\ M=M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01441}01441\ \ \ \ \ M\_inv\ =\ np.empty\_like(M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01442}01442\ \ \ \ \ prod1\ =\ M[:,\ 0,\ 0]*M[:,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01443}01443\ \ \ \ \ delta\ =\ prod1\ -\/\ M[:,\ 0,\ 1]*M[:,\ 1,\ 0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01444}01444\ \ \ \ \ rank2\ =\ (np.abs(delta)\ >\ 1e-\/8*np.abs(prod1))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01445}01445\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01446}01446\ \ \ \ \ \textcolor{keywordflow}{if}\ np.all(rank2):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01447}01447\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Normal\ 'optimized'\ flow.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01448}01448\ \ \ \ \ \ \ \ \ M\_inv[:,\ 0,\ 0]\ =\ M[:,\ 1,\ 1]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01449}01449\ \ \ \ \ \ \ \ \ M\_inv[:,\ 0,\ 1]\ =\ -\/M[:,\ 0,\ 1]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01450}01450\ \ \ \ \ \ \ \ \ M\_inv[:,\ 1,\ 0]\ =\ -\/M[:,\ 1,\ 0]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01451}01451\ \ \ \ \ \ \ \ \ M\_inv[:,\ 1,\ 1]\ =\ M[:,\ 0,\ 0]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01452}01452\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01453}01453\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 'Pathologic'\ flow.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01454}01454\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ have\ to\ deal\ with\ 2\ sub-\/cases}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01455}01455\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 1)\ First\ sub-\/case:\ matrices\ of\ rank\ 2:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01456}01456\ \ \ \ \ \ \ \ \ delta\ =\ delta[rank2]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01457}01457\ \ \ \ \ \ \ \ \ M\_inv[rank2,\ 0,\ 0]\ =\ M[rank2,\ 1,\ 1]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01458}01458\ \ \ \ \ \ \ \ \ M\_inv[rank2,\ 0,\ 1]\ =\ -\/M[rank2,\ 0,\ 1]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01459}01459\ \ \ \ \ \ \ \ \ M\_inv[rank2,\ 1,\ 0]\ =\ -\/M[rank2,\ 1,\ 0]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01460}01460\ \ \ \ \ \ \ \ \ M\_inv[rank2,\ 1,\ 1]\ =\ M[rank2,\ 0,\ 0]\ /\ delta}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01461}01461\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2)\ Second\ sub-\/case:\ rank-\/deficient\ matrices\ of\ rank\ 0\ and\ 1:}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01462}01462\ \ \ \ \ \ \ \ \ rank01\ =\ \string~rank2}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01463}01463\ \ \ \ \ \ \ \ \ tr\ =\ M[rank01,\ 0,\ 0]\ +\ M[rank01,\ 1,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01464}01464\ \ \ \ \ \ \ \ \ tr\_zeros\ =\ (np.abs(tr)\ <\ 1.e-\/8)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01465}01465\ \ \ \ \ \ \ \ \ sq\_tr\_inv\ =\ (1.-\/tr\_zeros)\ /\ (tr**2+tr\_zeros)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01466}01466\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sq\_tr\_inv\ =\ 1.\ /\ tr**2}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01467}01467\ \ \ \ \ \ \ \ \ M\_inv[rank01,\ 0,\ 0]\ =\ M[rank01,\ 0,\ 0]\ *\ sq\_tr\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01468}01468\ \ \ \ \ \ \ \ \ M\_inv[rank01,\ 0,\ 1]\ =\ M[rank01,\ 0,\ 1]\ *\ sq\_tr\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01469}01469\ \ \ \ \ \ \ \ \ M\_inv[rank01,\ 1,\ 0]\ =\ M[rank01,\ 1,\ 0]\ *\ sq\_tr\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01470}01470\ \ \ \ \ \ \ \ \ M\_inv[rank01,\ 1,\ 1]\ =\ M[rank01,\ 1,\ 1]\ *\ sq\_tr\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01471}01471\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01472}01472\ \ \ \ \ \textcolor{keywordflow}{return}\ M\_inv}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01473}01473\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01474}01474\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01475}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{01475}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_af0d6eb72366c92922afcc6f4283a05d9}{\_scalar\_vectorized}}(scalar,\ M):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01476}01476\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01477}01477\ \textcolor{stringliteral}{\ \ \ \ Scalar\ product\ between\ scalars\ and\ matrices.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01478}01478\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01479}01479\ \ \ \ \ \textcolor{keywordflow}{return}\ scalar[:,\ np.newaxis,\ np.newaxis]*M}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01480}01480\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01481}01481\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01482}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{01482}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a8f9f1eff0df36aad9a6fb0f872481706}{\_transpose\_vectorized}}(M):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01483}01483\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01484}01484\ \textcolor{stringliteral}{\ \ \ \ Transposition\ of\ an\ array\ of\ matrices\ *M*.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01485}01485\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01486}01486\ \ \ \ \ \textcolor{keywordflow}{return}\ np.transpose(M,\ [0,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01487}01487\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01488}01488\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01489}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{01489}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0908d8fae881ab710d09ff98c6ed5258}{\_roll\_vectorized}}(M,\ roll\_indices,\ axis):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01490}01490\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01491}01491\ \textcolor{stringliteral}{\ \ \ \ Roll\ an\ array\ of\ matrices\ along\ *axis*\ (0:\ rows,\ 1:\ columns)\ according\ to}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01492}01492\ \textcolor{stringliteral}{\ \ \ \ an\ array\ of\ indices\ *roll\_indices*.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01493}01493\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01494}01494\ \ \ \ \ \textcolor{keyword}{assert}\ axis\ \textcolor{keywordflow}{in}\ [0,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01495}01495\ \ \ \ \ ndim\ =\ M.ndim}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01496}01496\ \ \ \ \ \textcolor{keyword}{assert}\ ndim\ ==\ 3}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01497}01497\ \ \ \ \ ndim\_roll\ =\ roll\_indices.ndim}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01498}01498\ \ \ \ \ \textcolor{keyword}{assert}\ ndim\_roll\ ==\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01499}01499\ \ \ \ \ sh\ =\ M.shape}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01500}01500\ \ \ \ \ r,\ c\ =\ sh[-\/2:]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01501}01501\ \ \ \ \ \textcolor{keyword}{assert}\ sh[0]\ ==\ roll\_indices.shape[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01502}01502\ \ \ \ \ vec\_indices\ =\ np.arange(sh[0],\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01503}01503\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01504}01504\ \ \ \ \ \textcolor{comment}{\#\ Builds\ the\ rolled\ matrix}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01505}01505\ \ \ \ \ M\_roll\ =\ np.empty\_like(M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01506}01506\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01507}01507\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ir\ \textcolor{keywordflow}{in}\ range(r):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01508}01508\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ic\ \textcolor{keywordflow}{in}\ range(c):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01509}01509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M\_roll[:,\ ir,\ ic]\ =\ M[vec\_indices,\ (-\/roll\_indices+ir)\ \%\ r,\ ic]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01510}01510\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 1}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01511}01511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ir\ \textcolor{keywordflow}{in}\ range(r):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01512}01512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ic\ \textcolor{keywordflow}{in}\ range(c):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01513}01513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M\_roll[:,\ ir,\ ic]\ =\ M[vec\_indices,\ ir,\ (-\/roll\_indices+ic)\ \%\ c]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01514}01514\ \ \ \ \ \textcolor{keywordflow}{return}\ M\_roll}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01515}01515\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01516}01516\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01517}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{01517}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a0077efc1ff24fe9a813c5c39fd98f1c8}{\_to\_matrix\_vectorized}}(M):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01518}01518\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01519}01519\ \textcolor{stringliteral}{\ \ \ \ Build\ an\ array\ of\ matrices\ from\ individuals\ np.arrays\ of\ identical\ shapes.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01520}01520\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01521}01521\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01522}01522\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01523}01523\ \textcolor{stringliteral}{\ \ \ \ M}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01524}01524\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ncols-\/list\ of\ nrows-\/lists\ of\ shape\ sh.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01525}01525\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01526}01526\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01527}01527\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01528}01528\ \textcolor{stringliteral}{\ \ \ \ M\_res\ :\ np.array\ of\ shape\ (sh,\ nrow,\ ncols)}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01529}01529\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *M\_res*\ satisfies\ \`{}\`{}M\_res[...,\ i,\ j]\ =\ M[i][j]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01530}01530\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01531}01531\ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(M,\ (tuple,\ list))}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01532}01532\ \ \ \ \ \textcolor{keyword}{assert}\ all(isinstance(item,\ (tuple,\ list))\ \textcolor{keywordflow}{for}\ item\ \textcolor{keywordflow}{in}\ M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01533}01533\ \ \ \ \ c\_vec\ =\ np.asarray([len(item)\ \textcolor{keywordflow}{for}\ item\ \textcolor{keywordflow}{in}\ M])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01534}01534\ \ \ \ \ \textcolor{keyword}{assert}\ np.all(c\_vec-\/c\_vec[0]\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01535}01535\ \ \ \ \ r\ =\ len(M)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01536}01536\ \ \ \ \ c\ =\ c\_vec[0]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01537}01537\ \ \ \ \ M00\ =\ np.asarray(M[0][0])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01538}01538\ \ \ \ \ dt\ =\ M00.dtype}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01539}01539\ \ \ \ \ sh\ =\ [M00.shape[0],\ r,\ c]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01540}01540\ \ \ \ \ M\_ret\ =\ np.empty(sh,\ dtype=dt)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01541}01541\ \ \ \ \ \textcolor{keywordflow}{for}\ irow\ \textcolor{keywordflow}{in}\ range(r):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01542}01542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ icol\ \textcolor{keywordflow}{in}\ range(c):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01543}01543\ \ \ \ \ \ \ \ \ \ \ \ \ M\_ret[:,\ irow,\ icol]\ =\ np.asarray(M[irow][icol])}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01544}01544\ \ \ \ \ \textcolor{keywordflow}{return}\ M\_ret}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01545}01545\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01546}01546\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01547}\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a20fbcf30d888929f741f348a88e21a29}{01547}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacematplotlib_1_1tri_1_1__triinterpolate_a20fbcf30d888929f741f348a88e21a29}{\_extract\_submatrices}}(M,\ block\_indices,\ block\_size,\ axis):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01548}01548\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01549}01549\ \textcolor{stringliteral}{\ \ \ \ Extract\ selected\ blocks\ of\ a\ matrices\ *M*\ depending\ on\ parameters}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01550}01550\ \textcolor{stringliteral}{\ \ \ \ *block\_indices*\ and\ *block\_size*.}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01551}01551\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01552}01552\ \textcolor{stringliteral}{\ \ \ \ Returns\ the\ array\ of\ extracted\ matrices\ *Mres*\ so\ that\ ::}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01553}01553\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01554}01554\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ M\_res[...,\ ir,\ :]\ =\ M[(block\_indices*block\_size+ir),\ :]}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01555}01555\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01556}01556\ \ \ \ \ \textcolor{keyword}{assert}\ block\_indices.ndim\ ==\ 1}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01557}01557\ \ \ \ \ \textcolor{keyword}{assert}\ axis\ \textcolor{keywordflow}{in}\ [0,\ 1]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01558}01558\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01559}01559\ \ \ \ \ r,\ c\ =\ M.shape}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01560}01560\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01561}01561\ \ \ \ \ \ \ \ \ sh\ =\ [block\_indices.shape[0],\ block\_size,\ c]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01562}01562\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 1}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01563}01563\ \ \ \ \ \ \ \ \ sh\ =\ [block\_indices.shape[0],\ r,\ block\_size]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01564}01564\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01565}01565\ \ \ \ \ dt\ =\ M.dtype}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01566}01566\ \ \ \ \ M\_res\ =\ np.empty(sh,\ dtype=dt)}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01567}01567\ \ \ \ \ \textcolor{keywordflow}{if}\ axis\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01568}01568\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ir\ \textcolor{keywordflow}{in}\ range(block\_size):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01569}01569\ \ \ \ \ \ \ \ \ \ \ \ \ M\_res[:,\ ir,\ :]\ =\ M[(block\_indices*block\_size+ir),\ :]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01570}01570\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ 1}}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01571}01571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ic\ \textcolor{keywordflow}{in}\ range(block\_size):}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01572}01572\ \ \ \ \ \ \ \ \ \ \ \ \ M\_res[:,\ :,\ ic]\ =\ M[:,\ (block\_indices*block\_size+ic)]}
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01573}01573\ }
\DoxyCodeLine{\Hypertarget{__triinterpolate_8py_source_l01574}01574\ \ \ \ \ \textcolor{keywordflow}{return}\ M\_res}

\end{DoxyCode}
