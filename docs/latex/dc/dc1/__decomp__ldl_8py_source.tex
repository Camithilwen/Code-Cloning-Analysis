\doxysection{\+\_\+decomp\+\_\+ldl.\+py}
\hypertarget{__decomp__ldl_8py_source}{}\label{__decomp__ldl_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/\_decomp\_ldl.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/linalg/\_decomp\_ldl.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl}{00001}}\ \textcolor{keyword}{from}\ warnings\ \textcolor{keyword}{import}\ warn}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00004}00004\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ (atleast\_2d,\ ComplexWarning,\ arange,\ zeros\_like,\ imag,\ diag,}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00005}00005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iscomplexobj,\ tril,\ triu,\ argsort,\ empty\_like)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00006}00006\ \textcolor{keyword}{from}\ .\_decomp\ \textcolor{keyword}{import}\ \_asarray\_validated}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00007}00007\ \textcolor{keyword}{from}\ .lapack\ \textcolor{keyword}{import}\ get\_lapack\_funcs,\ \_compute\_lwork}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00009}00009\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'ldl'}]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00012}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{00012}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_ac2db6038080fa62f91cb928efeb3984d}{ldl}}(A,\ lower=True,\ hermitian=True,\ overwrite\_a=False,\ check\_finite=True):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00013}00013\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Computes\ the\ LDLt\ or\ Bunch-\/Kaufman\ factorization\ of\ a\ symmetric/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ hermitian\ matrix.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00015}00015\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ This\ function\ returns\ a\ block\ diagonal\ matrix\ D\ consisting\ blocks\ of\ size}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ at\ most\ 2x2\ and\ also\ a\ possibly\ permuted\ unit\ lower\ triangular\ matrix}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}L\`{}\`{}\ such\ that\ the\ factorization\ \`{}\`{}A\ =\ L\ D\ L\string^H\`{}\`{}\ or\ \`{}\`{}A\ =\ L\ D\ L\string^T\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ holds.\ If\ \`{}lower\`{}\ is\ False\ then\ (again\ possibly\ permuted)\ upper}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ triangular\ matrices\ are\ returned\ as\ outer\ factors.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00021}00021\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ The\ permutation\ array\ can\ be\ used\ to\ triangularize\ the\ outer\ factors}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ simply\ by\ a\ row\ shuffle,\ i.e.,\ \`{}\`{}lu[perm,\ :]\`{}\`{}\ is\ an\ upper/lower}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ triangular\ matrix.\ This\ is\ also\ equivalent\ to\ multiplication\ with\ a}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ permutation\ matrix\ \`{}\`{}P.dot(lu)\`{}\`{},\ where\ \`{}\`{}P\`{}\`{}\ is\ a\ column-\/permuted}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ identity\ matrix\ \`{}\`{}I[:,\ perm]\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00027}00027\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ Depending\ on\ the\ value\ of\ the\ boolean\ \`{}lower\`{},\ only\ upper\ or\ lower}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ triangular\ part\ of\ the\ input\ array\ is\ referenced.\ Hence,\ a\ triangular}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ matrix\ on\ entry\ would\ give\ the\ same\ result\ as\ if\ the\ full\ matrix\ is}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ supplied.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00032}00032\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ A\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Square\ input\ array}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ lower\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ switches\ between\ the\ lower\ and\ upper\ triangular\ outer\ factors\ of}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ factorization.\ Lower\ triangular\ (\`{}\`{}lower=True\`{}\`{})\ is\ the\ default.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ hermitian\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ complex-\/valued\ arrays,\ this\ defines\ whether\ \`{}\`{}A\ =\ A.conj().T\`{}\`{}\ or}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}A\ =\ A.T\`{}\`{}\ is\ assumed.\ For\ real-\/valued\ arrays,\ this\ switch\ has\ no}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ effect.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ overwrite\_a\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Allow\ overwriting\ data\ in\ \`{}A\`{}\ (may\ enhance\ performance).\ The\ default}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ False.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ check\_finite\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ to\ check\ that\ the\ input\ matrices\ contain\ only\ finite\ numbers.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Disabling\ may\ give\ a\ performance\ gain,\ but\ may\ result\ in\ problems}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (crashes,\ non-\/termination)\ if\ the\ inputs\ do\ contain\ infinities\ or\ NaNs.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00051}00051\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ lu\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ (possibly)\ permuted\ upper/lower\ triangular\ outer\ factor\ of\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ factorization.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ d\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ block\ diagonal\ multiplier\ of\ the\ factorization.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ perm\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ row-\/permutation\ index\ array\ that\ brings\ lu\ into\ triangular\ form.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00061}00061\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ Raises}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ ValueError}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ input\ array\ is\ not\ square.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ ComplexWarning}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ a\ complex-\/valued\ array\ with\ nonzero\ imaginary\ parts\ on\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ diagonal\ is\ given\ and\ hermitian\ is\ set\ to\ True.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00069}00069\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ cholesky,\ lu}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00073}00073\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ This\ function\ uses\ \`{}\`{}?SYTRF\`{}\`{}\ routines\ for\ symmetric\ matrices\ and}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}?HETRF\`{}\`{}\ routines\ for\ Hermitian\ matrices\ from\ LAPACK.\ See\ [1]\_\ for}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ the\ algorithm\ details.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00079}00079\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ Depending\ on\ the\ \`{}lower\`{}\ keyword\ value,\ only\ lower\ or\ upper\ triangular}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ part\ of\ the\ input\ array\ is\ referenced.\ Moreover,\ this\ keyword\ also\ defines}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ the\ structure\ of\ the\ outer\ factors\ of\ the\ factorization.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00083}00083\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 1.1.0}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00085}00085\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ J.R.\ Bunch,\ L.\ Kaufman,\ Some\ stable\ methods\ for\ calculating}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ inertia\ and\ solving\ symmetric\ linear\ systems,\ Math.\ Comput.\ Vol.31,}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ 1977.\ :doi:\`{}10.2307/2005787\`{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00091}00091\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ Given\ an\ upper\ triangular\ array\ \`{}\`{}a\`{}\`{}\ that\ represents\ the\ full\ symmetric}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ array\ with\ its\ entries,\ obtain\ \`{}\`{}l\`{}\`{},\ 'd'\ and\ the\ permutation\ vector\ \`{}perm\`{}:}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00096}00096\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.linalg\ import\ ldl}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ >>>\ a\ =\ np.array([[2,\ -\/1,\ 3],\ [0,\ 2,\ 0],\ [0,\ 0,\ 1]])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ >>>\ lu,\ d,\ perm\ =\ ldl(a,\ lower=0)\ \#\ Use\ the\ upper\ part}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ >>>\ lu}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ array([[\ 0.\ ,\ \ 0.\ ,\ \ 1.\ ],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 0.\ ,\ \ 1.\ ,\ -\/0.5],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 1.\ ,\ \ 1.\ ,\ \ 1.5]])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ >>>\ d}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ array([[-\/5.\ ,\ \ 0.\ ,\ \ 0.\ ],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 0.\ ,\ \ 1.5,\ \ 0.\ ],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 0.\ ,\ \ 0.\ ,\ \ 2.\ ]])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ >>>\ perm}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ array([2,\ 1,\ 0])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ >>>\ lu[perm,\ :]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ array([[\ 1.\ ,\ \ 1.\ ,\ \ 1.5],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 0.\ ,\ \ 1.\ ,\ -\/0.5],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 0.\ ,\ \ 0.\ ,\ \ 1.\ ]])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ >>>\ lu.dot(d).dot(lu.T)}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ array([[\ 2.,\ -\/1.,\ \ 3.],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [-\/1.,\ \ 2.,\ \ 0.],}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [\ 3.,\ \ 0.,\ \ 1.]])}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00119}00119\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00121}00121\ \ \ \ \ a\ =\ atleast\_2d(\_asarray\_validated(A,\ check\_finite=check\_finite))}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00122}00122\ \ \ \ \ \textcolor{keywordflow}{if}\ a.shape[0]\ !=\ a.shape[1]:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'The\ input\ array\ "{}a"{}\ should\ be\ square.'})}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00124}00124\ \ \ \ \ \textcolor{comment}{\#\ Return\ empty\ arrays\ for\ empty\ square\ input}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00125}00125\ \ \ \ \ \textcolor{keywordflow}{if}\ a.size\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ empty\_like(a),\ empty\_like(a),\ np.array([],\ dtype=int)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00128}00128\ \ \ \ \ n\ =\ a.shape[0]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00129}00129\ \ \ \ \ r\_or\_c\ =\ complex\ \textcolor{keywordflow}{if}\ iscomplexobj(a)\ \textcolor{keywordflow}{else}\ float}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00131}00131\ \ \ \ \ \textcolor{comment}{\#\ Get\ the\ LAPACK\ routine}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00132}00132\ \ \ \ \ \textcolor{keywordflow}{if}\ r\_or\_c\ \textcolor{keywordflow}{is}\ complex\ \textcolor{keywordflow}{and}\ hermitian:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ s,\ sl\ =\ \textcolor{stringliteral}{'hetrf'},\ \textcolor{stringliteral}{'hetrf\_lwork'}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(imag(diag(a))):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ warn(\textcolor{stringliteral}{'scipy.linalg.ldl():\(\backslash\)nThe\ imaginary\ parts\ of\ the\ diagonal'}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'are\ ignored.\ Use\ "{}hermitian=False"{}\ for\ factorization\ of'}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'complex\ symmetric\ arrays.'},\ ComplexWarning,\ stacklevel=2)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00138}00138\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ s,\ sl\ =\ \textcolor{stringliteral}{'sytrf'},\ \textcolor{stringliteral}{'sytrf\_lwork'}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00141}00141\ \ \ \ \ solver,\ solver\_lwork\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1lapack_ac91f10877b228186bc36e9f3c9c82e3f}{get\_lapack\_funcs}}((s,\ sl),\ (a,))}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00142}00142\ \ \ \ \ lwork\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1lapack_abbd01dcbd4e8fef0d61be684a003b7e5}{\_compute\_lwork}}(solver\_lwork,\ n,\ lower=lower)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00143}00143\ \ \ \ \ ldu,\ piv,\ info\ =\ solver(a,\ lwork=lwork,\ lower=lower,}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ overwrite\_a=overwrite\_a)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00145}00145\ \ \ \ \ \textcolor{keywordflow}{if}\ info\ <\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'\{\}\ exited\ with\ the\ internal\ error\ "{}illegal\ value\ '}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'in\ argument\ number\ \{\}"{}.\ See\ LAPACK\ documentation\ '}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'for\ the\ error\ codes.'}.format(s.upper(),\ -\/info))}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00150}00150\ \ \ \ \ swap\_arr,\ pivot\_arr\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a7eedb78c7345807bf643562d92d87b82}{\_ldl\_sanitize\_ipiv}}(piv,\ lower=lower)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00151}00151\ \ \ \ \ d,\ lu\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a6c2f91b69d0b09187e3d5a9ab1140ae4}{\_ldl\_get\_d\_and\_l}}(ldu,\ pivot\_arr,\ lower=lower,\ hermitian=hermitian)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00152}00152\ \ \ \ \ lu,\ perm\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a623d1f16b7941606322f77288f90f165}{\_ldl\_construct\_tri\_factor}}(lu,\ swap\_arr,\ pivot\_arr,\ lower=lower)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00154}00154\ \ \ \ \ \textcolor{keywordflow}{return}\ lu,\ d,\ perm}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00157}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a7eedb78c7345807bf643562d92d87b82}{00157}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a7eedb78c7345807bf643562d92d87b82}{\_ldl\_sanitize\_ipiv}}(a,\ lower=True):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00158}00158\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ This\ helper\ function\ takes\ the\ rather\ strangely\ encoded\ permutation\ array}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ returned\ by\ the\ LAPACK\ routines\ ?(HE/SY)TRF\ and\ converts\ it\ into}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ regularized\ permutation\ and\ diagonal\ pivot\ size\ format.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00162}00162\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ Since\ FORTRAN\ uses\ 1-\/indexing\ and\ LAPACK\ uses\ different\ start\ points\ for}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ upper\ and\ lower\ formats\ there\ are\ certain\ offsets\ in\ the\ indices\ used}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ below.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00166}00166\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ Let's\ assume\ a\ result\ where\ the\ matrix\ is\ 6x6\ and\ there\ are\ two\ 2x2}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ and\ two\ 1x1\ blocks\ reported\ by\ the\ routine.\ To\ ease\ the\ coding\ efforts,}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ we\ still\ populate\ a\ 6-\/sized\ array\ and\ fill\ zeros\ as\ the\ following\ ::}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00170}00170\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ pivots\ =\ [2,\ 0,\ 2,\ 0,\ 1,\ 1]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00172}00172\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ This\ denotes\ a\ diagonal\ matrix\ of\ the\ form\ ::}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00174}00174\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [x\ x\ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [x\ x\ \ \ \ \ \ \ \ ]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [\ \ \ \ x\ x\ \ \ \ ]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [\ \ \ \ x\ x\ \ \ \ ]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ \ x\ \ ]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [\ \ \ \ \ \ \ \ \ \ x]}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00181}00181\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ In\ other\ words,\ we\ write\ 2\ when\ the\ 2x2\ block\ is\ first\ encountered\ and}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ automatically\ write\ 0\ to\ the\ next\ entry\ and\ skip\ the\ next\ spin\ of\ the}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ loop.\ Thus,\ a\ separate\ counter\ or\ array\ appends\ to\ keep\ track\ of\ block}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ sizes\ are\ avoided.\ If\ needed,\ zeros\ can\ be\ filtered\ out\ later\ without}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ losing\ the\ block\ structure.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00187}00187\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00190}00190\ \textcolor{stringliteral}{\ \ \ \ a\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00191}00191\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ permutation\ array\ ipiv\ returned\ by\ LAPACK}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ lower\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ switch\ to\ select\ whether\ upper\ or\ lower\ triangle\ is\ chosen\ in}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00194}00194\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ LAPACK\ call.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00195}00195\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ swap\_\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ array\ that\ defines\ the\ row/column\ swap\ operations.\ For\ example,}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ row\ two\ is\ swapped\ with\ row\ four,\ the\ result\ is\ [0,\ 3,\ 2,\ 3].}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ pivots\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ array\ that\ defines\ the\ block\ diagonal\ structure\ as\ given\ above.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00203}00203\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00205}00205\ \ \ \ \ n\ =\ a.size}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00206}00206\ \ \ \ \ swap\_\ =\ arange(n)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00207}00207\ \ \ \ \ pivots\ =\ zeros\_like(swap\_,\ dtype=int)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00208}00208\ \ \ \ \ skip\_2x2\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00210}00210\ \ \ \ \ \textcolor{comment}{\#\ Some\ upper/lower\ dependent\ offset\ values}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00211}00211\ \ \ \ \ \textcolor{comment}{\#\ range\ (s)tart,\ r(e)nd,\ r(i)ncrement}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00212}00212\ \ \ \ \ x,\ y,\ rs,\ re,\ ri\ =\ (1,\ 0,\ 0,\ n,\ 1)\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ (-\/1,\ -\/1,\ n-\/1,\ -\/1,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00214}00214\ \ \ \ \ \textcolor{keywordflow}{for}\ ind\ \textcolor{keywordflow}{in}\ range(rs,\ re,\ ri):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ previous\ spin\ belonged\ already\ to\ a\ 2x2\ block}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ skip\_2x2:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ skip\_2x2\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00219}00219\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ cur\_val\ =\ a[ind]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ do\ we\ have\ a\ 1x1\ block\ or\ not?}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cur\_val\ >\ 0:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cur\_val\ !=\ ind+1:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Index\ value\ !=\ array\ value\ -\/-\/>\ permutation\ required}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ swap\_[ind]\ =\ swap\_[cur\_val-\/1]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ pivots[ind]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Not.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ cur\_val\ <\ 0\ \textcolor{keywordflow}{and}\ cur\_val\ ==\ a[ind+x]:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ first\ neg\ entry\ of\ 2x2\ block\ identifier}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ -\/cur\_val\ !=\ ind+2:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Index\ value\ !=\ array\ value\ -\/-\/>\ permutation\ required}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ swap\_[ind+x]\ =\ swap\_[-\/cur\_val-\/1]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ pivots[ind+y]\ =\ 2}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ skip\_2x2\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ Doesn't\ make\ sense,\ give\ up}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'While\ parsing\ the\ permutation\ array\ '}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'in\ "{}scipy.linalg.ldl"{},\ invalid\ entries\ '}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'found.\ The\ array\ syntax\ is\ invalid.'})}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00239}00239\ \ \ \ \ \textcolor{keywordflow}{return}\ swap\_,\ pivots}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00240}00240\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00242}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a6c2f91b69d0b09187e3d5a9ab1140ae4}{00242}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a6c2f91b69d0b09187e3d5a9ab1140ae4}{\_ldl\_get\_d\_and\_l}}(ldu,\ pivs,\ lower=True,\ hermitian=True):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00243}00243\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ Helper\ function\ to\ extract\ the\ diagonal\ and\ triangular\ matrices\ for}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ LDL.T\ factorization.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00246}00246\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ ldu\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ compact\ output\ returned\ by\ the\ LAPACK\ routing}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ pivs\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sanitized\ array\ of\ \{0,\ 1,\ 2\}\ denoting\ the\ sizes\ of\ the\ pivots.\ For}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ every\ 2\ there\ is\ a\ succeeding\ 0.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ lower\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ set\ to\ False,\ upper\ triangular\ part\ is\ considered.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ hermitian\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ set\ to\ False\ a\ symmetric\ complex\ array\ is\ assumed.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00258}00258\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ d\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ block\ diagonal\ matrix.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ lu\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ upper/lower\ triangular\ matrix}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00266}00266\ \ \ \ \ is\_c\ =\ iscomplexobj(ldu)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00267}00267\ \ \ \ \ d\ =\ diag(diag(ldu))}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00268}00268\ \ \ \ \ n\ =\ d.shape[0]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00269}00269\ \ \ \ \ blk\_i\ =\ 0\ \ \textcolor{comment}{\#\ block\ index}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00270}00270\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00271}00271\ \ \ \ \ \textcolor{comment}{\#\ row/column\ offsets\ for\ selecting\ sub-\/,\ super-\/diagonal}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00272}00272\ \ \ \ \ x,\ y\ =\ (1,\ 0)\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ (0,\ 1)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00274}00274\ \ \ \ \ lu\ =\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__special__matrices_a5e9df53d999e3af2182cfee51b697af2}{tril}}(ldu,\ -\/1)\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ \mbox{\hyperlink{namespacescipy_1_1linalg_1_1__special__matrices_aef9793e4c7a01acf622dbf785e15cc45}{triu}}(ldu,\ 1)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00275}00275\ \ \ \ \ diag\_inds\ =\ arange(n)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00276}00276\ \ \ \ \ lu[diag\_inds,\ diag\_inds]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00278}00278\ \ \ \ \ \textcolor{keywordflow}{for}\ blk\ \textcolor{keywordflow}{in}\ pivs[pivs\ !=\ 0]:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ increment\ the\ block\ index\ and\ check\ for\ 2s}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ 2\ then\ copy\ the\ off\ diagonals\ depending\ on\ uplo}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ inc\ =\ blk\_i\ +\ blk}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ blk\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ \ \ \ \ d[blk\_i+x,\ blk\_i+y]\ =\ ldu[blk\_i+x,\ blk\_i+y]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ Hermitian\ matrix\ is\ factorized,\ the\ cross-\/offdiagonal\ element}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ should\ be\ conjugated.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ is\_c\ \textcolor{keywordflow}{and}\ hermitian:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[blk\_i+y,\ blk\_i+x]\ =\ ldu[blk\_i+x,\ blk\_i+y].conj()}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[blk\_i+y,\ blk\_i+x]\ =\ ldu[blk\_i+x,\ blk\_i+y]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00291}00291\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ lu[blk\_i+x,\ blk\_i+y]\ =\ 0.}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ blk\_i\ =\ inc}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00295}00295\ \ \ \ \ \textcolor{keywordflow}{return}\ d,\ lu}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00297}00297\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00298}\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a623d1f16b7941606322f77288f90f165}{00298}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1linalg_1_1__decomp__ldl_a623d1f16b7941606322f77288f90f165}{\_ldl\_construct\_tri\_factor}}(lu,\ swap\_vec,\ pivs,\ lower=True):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00299}00299\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ Helper\ function\ to\ construct\ explicit\ outer\ factors\ of\ LDL\ factorization.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00301}00301\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ If\ lower\ is\ True\ the\ permuted\ factors\ are\ multiplied\ as\ L(1)*L(2)*...*L(k).}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ Otherwise,\ the\ permuted\ factors\ are\ multiplied\ as\ L(k)*...*L(2)*L(1).\ See}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ LAPACK\ documentation\ for\ more\ details.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00305}00305\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ lu\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ triangular\ array\ that\ is\ extracted\ from\ LAPACK\ routine\ call\ with}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ones\ on\ the\ diagonals.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ swap\_vec\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ array\ that\ defines\ the\ row\ swapping\ indices.\ If\ the\ kth\ entry\ is\ m}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ then\ rows\ k,m\ are\ swapped.\ Notice\ that\ the\ mth\ entry\ is\ not\ necessarily}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ k\ to\ avoid\ undoing\ the\ swapping.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ pivs\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ array\ that\ defines\ the\ block\ diagonal\ structure\ returned\ by}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \_ldl\_sanitize\_ipiv().}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ lower\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ boolean\ to\ switch\ between\ lower\ and\ upper\ triangular\ structure.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00320}00320\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ lu\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ square\ outer\ factor\ which\ satisfies\ the\ L\ *\ D\ *\ L.T\ =\ A}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ perm\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ permutation\ vector\ that\ brings\ the\ lu\ to\ the\ triangular\ form}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00327}00327\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ the\ original\ argument\ "{}lu"{}\ is\ overwritten.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00331}00331\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00333}00333\ \ \ \ \ n\ =\ lu.shape[0]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00334}00334\ \ \ \ \ perm\ =\ arange(n)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00335}00335\ \ \ \ \ \textcolor{comment}{\#\ Setup\ the\ reading\ order\ of\ the\ permutation\ matrix\ for\ upper/lower}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00336}00336\ \ \ \ \ rs,\ re,\ ri\ =\ (n-\/1,\ -\/1,\ -\/1)\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ (0,\ n,\ 1)}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00337}00337\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00338}00338\ \ \ \ \ \textcolor{keywordflow}{for}\ ind\ \textcolor{keywordflow}{in}\ range(rs,\ re,\ ri):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ s\_ind\ =\ swap\_vec[ind]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ s\_ind\ !=\ ind:}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Column\ start\ and\ end\ positions}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ col\_s\ =\ ind\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ 0}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ col\_e\ =\ n\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ ind+1}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00344}00344\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we\ stumble\ upon\ a\ 2x2\ block\ include\ both\ cols\ in\ the\ perm.}}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pivs[ind]\ ==\ (0\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ 2):}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_s\ +=\ -\/1\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ 0}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ col\_e\ +=\ 0\ \textcolor{keywordflow}{if}\ lower\ \textcolor{keywordflow}{else}\ 1}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ lu[[s\_ind,\ ind],\ col\_s:col\_e]\ =\ lu[[ind,\ s\_ind],\ col\_s:col\_e]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ perm[[s\_ind,\ ind]]\ =\ perm[[ind,\ s\_ind]]}
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00351}00351\ }
\DoxyCodeLine{\Hypertarget{__decomp__ldl_8py_source_l00352}00352\ \ \ \ \ \textcolor{keywordflow}{return}\ lu,\ argsort(perm)}

\end{DoxyCode}
