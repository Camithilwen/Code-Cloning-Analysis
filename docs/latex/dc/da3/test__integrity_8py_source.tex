\doxysection{test\+\_\+integrity.\+py}
\hypertarget{test__integrity_8py_source}{}\label{test__integrity_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/pandas/tests/indexes/multi/test\_integrity.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/pandas/tests/indexes/multi/test\_integrity.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00001}\mbox{\hyperlink{namespacepandas_1_1tests_1_1indexes_1_1multi_1_1test__integrity}{00001}}\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00003}00003\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00004}00004\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacepandas_1_1__libs}{pandas.\_libs}}\ \textcolor{keyword}{import}\ index\ \textcolor{keyword}{as}\ libindex}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacepandas_1_1core_1_1dtypes_1_1cast}{pandas.core.dtypes.cast}}\ \textcolor{keyword}{import}\ construct\_1d\_object\_array\_from\_listlike}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00010}00010\ \textcolor{keyword}{import}\ pandas\ \textcolor{keyword}{as}\ pd}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00011}00011\ \textcolor{keyword}{from}\ pandas\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00012}00012\ \ \ \ \ Index,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00013}00013\ \ \ \ \ IntervalIndex,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00014}00014\ \ \ \ \ MultiIndex,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00015}00015\ \ \ \ \ RangeIndex,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00016}00016\ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00017}00017\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacepandas_1_1__testing}{pandas.\_testing}}\ \textcolor{keyword}{as}\ tm}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00020}00020\ \textcolor{keyword}{def\ }test\_labels\_dtypes():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00021}00021\ \ \ \ \ \textcolor{comment}{\#\ GH\ 8456}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00022}00022\ \ \ \ \ i\ =\ MultiIndex.from\_tuples([(\textcolor{stringliteral}{"{}A"{}},\ 1),\ (\textcolor{stringliteral}{"{}A"{}},\ 2)])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{assert}\ i.codes[0].dtype\ ==\ \textcolor{stringliteral}{"{}int8"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{assert}\ i.codes[1].dtype\ ==\ \textcolor{stringliteral}{"{}int8"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00026}00026\ \ \ \ \ i\ =\ MultiIndex.from\_product([[\textcolor{stringliteral}{"{}a"{}}],\ range(40)])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{assert}\ i.codes[1].dtype\ ==\ \textcolor{stringliteral}{"{}int8"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00028}00028\ \ \ \ \ i\ =\ MultiIndex.from\_product([[\textcolor{stringliteral}{"{}a"{}}],\ range(400)])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00029}00029\ \ \ \ \ \textcolor{keyword}{assert}\ i.codes[1].dtype\ ==\ \textcolor{stringliteral}{"{}int16"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00030}00030\ \ \ \ \ i\ =\ MultiIndex.from\_product([[\textcolor{stringliteral}{"{}a"{}}],\ range(40000)])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{assert}\ i.codes[1].dtype\ ==\ \textcolor{stringliteral}{"{}int32"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00033}00033\ \ \ \ \ i\ =\ MultiIndex.from\_product([[\textcolor{stringliteral}{"{}a"{}}],\ range(1000)])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00034}00034\ \ \ \ \ \textcolor{keyword}{assert}\ (i.codes[0]\ >=\ 0).all()}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00035}00035\ \ \ \ \ \textcolor{keyword}{assert}\ (i.codes[1]\ >=\ 0).all()}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00038}00038\ \textcolor{keyword}{def\ }test\_values\_boxed():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00039}00039\ \ \ \ \ tuples\ =\ [}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ (1,\ pd.Timestamp(\textcolor{stringliteral}{"{}2000-\/01-\/01"{}})),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ (2,\ pd.NaT),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ (3,\ pd.Timestamp(\textcolor{stringliteral}{"{}2000-\/01-\/03"{}})),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ (1,\ pd.Timestamp(\textcolor{stringliteral}{"{}2000-\/01-\/04"{}})),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ (2,\ pd.Timestamp(\textcolor{stringliteral}{"{}2000-\/01-\/02"{}})),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ (3,\ pd.Timestamp(\textcolor{stringliteral}{"{}2000-\/01-\/03"{}})),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00046}00046\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00047}00047\ \ \ \ \ result\ =\ MultiIndex.from\_tuples(tuples)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00048}00048\ \ \ \ \ expected\ =\ construct\_1d\_object\_array\_from\_listlike(tuples)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00049}00049\ \ \ \ \ tm.assert\_numpy\_array\_equal(result.values,\ expected)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00050}00050\ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ code\ branches\ for\ boxed\ values\ produce\ identical\ results}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00051}00051\ \ \ \ \ tm.assert\_numpy\_array\_equal(result.values[:4],\ result[:4].values)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00054}00054\ \textcolor{keyword}{def\ }test\_values\_multiindex\_datetimeindex():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00055}00055\ \ \ \ \ \textcolor{comment}{\#\ Test\ to\ ensure\ we\ hit\ the\ boxing\ /\ nobox\ part\ of\ MI.values}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00056}00056\ \ \ \ \ ints\ =\ np.arange(10**18,\ 10**18\ +\ 5)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00057}00057\ \ \ \ \ naive\ =\ pd.DatetimeIndex(ints)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00059}00059\ \ \ \ \ aware\ =\ pd.DatetimeIndex(ints,\ tz=\textcolor{stringliteral}{"{}US/Central"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00061}00061\ \ \ \ \ idx\ =\ MultiIndex.from\_arrays([naive,\ aware])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00062}00062\ \ \ \ \ result\ =\ idx.values}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00064}00064\ \ \ \ \ outer\ =\ pd.DatetimeIndex([x[0]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00065}00065\ \ \ \ \ tm.assert\_index\_equal(outer,\ naive)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00067}00067\ \ \ \ \ inner\ =\ pd.DatetimeIndex([x[1]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00068}00068\ \ \ \ \ tm.assert\_index\_equal(inner,\ aware)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00070}00070\ \ \ \ \ \textcolor{comment}{\#\ n\_lev\ >\ n\_lab}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00071}00071\ \ \ \ \ result\ =\ idx[:2].values}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00073}00073\ \ \ \ \ outer\ =\ pd.DatetimeIndex([x[0]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00074}00074\ \ \ \ \ tm.assert\_index\_equal(outer,\ naive[:2])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00076}00076\ \ \ \ \ inner\ =\ pd.DatetimeIndex([x[1]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00077}00077\ \ \ \ \ tm.assert\_index\_equal(inner,\ aware[:2])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00080}00080\ \textcolor{keyword}{def\ }test\_values\_multiindex\_periodindex():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00081}00081\ \ \ \ \ \textcolor{comment}{\#\ Test\ to\ ensure\ we\ hit\ the\ boxing\ /\ nobox\ part\ of\ MI.values}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00082}00082\ \ \ \ \ ints\ =\ np.arange(2007,\ 2012)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00083}00083\ \ \ \ \ pidx\ =\ pd.PeriodIndex(ints,\ freq=\textcolor{stringliteral}{"{}D"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00085}00085\ \ \ \ \ idx\ =\ MultiIndex.from\_arrays([ints,\ pidx])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00086}00086\ \ \ \ \ result\ =\ idx.values}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00088}00088\ \ \ \ \ outer\ =\ Index([x[0]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00089}00089\ \ \ \ \ tm.assert\_index\_equal(outer,\ Index(ints,\ dtype=np.int64))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00091}00091\ \ \ \ \ inner\ =\ pd.PeriodIndex([x[1]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00092}00092\ \ \ \ \ tm.assert\_index\_equal(inner,\ pidx)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00094}00094\ \ \ \ \ \textcolor{comment}{\#\ n\_lev\ >\ n\_lab}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00095}00095\ \ \ \ \ result\ =\ idx[:2].values}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00097}00097\ \ \ \ \ outer\ =\ Index([x[0]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00098}00098\ \ \ \ \ tm.assert\_index\_equal(outer,\ Index(ints[:2],\ dtype=np.int64))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00100}00100\ \ \ \ \ inner\ =\ pd.PeriodIndex([x[1]\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ result])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00101}00101\ \ \ \ \ tm.assert\_index\_equal(inner,\ pidx[:2])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00104}00104\ \textcolor{keyword}{def\ }test\_consistency():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00105}00105\ \ \ \ \ \textcolor{comment}{\#\ need\ to\ construct\ an\ overflow}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00106}00106\ \ \ \ \ major\_axis\ =\ list(range(70000))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00107}00107\ \ \ \ \ minor\_axis\ =\ list(range(10))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00109}00109\ \ \ \ \ major\_codes\ =\ np.arange(70000)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00110}00110\ \ \ \ \ minor\_codes\ =\ np.repeat(range(10),\ 7000)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00112}00112\ \ \ \ \ \textcolor{comment}{\#\ the\ fact\ that\ is\ works\ means\ it's\ consistent}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00113}00113\ \ \ \ \ index\ =\ MultiIndex(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ levels=[major\_axis,\ minor\_axis],\ codes=[major\_codes,\ minor\_codes]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00115}00115\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00117}00117\ \ \ \ \ \textcolor{comment}{\#\ inconsistent}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00118}00118\ \ \ \ \ major\_codes\ =\ np.array([0,\ 0,\ 1,\ 1,\ 1,\ 2,\ 2,\ 3,\ 3])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00119}00119\ \ \ \ \ minor\_codes\ =\ np.array([0,\ 1,\ 0,\ 1,\ 1,\ 0,\ 1,\ 0,\ 1])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00120}00120\ \ \ \ \ index\ =\ MultiIndex(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ levels=[major\_axis,\ minor\_axis],\ codes=[major\_codes,\ minor\_codes]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00122}00122\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00124}00124\ \ \ \ \ \textcolor{keyword}{assert}\ index.is\_unique\ \textcolor{keywordflow}{is}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00127}00127\ \textcolor{preprocessor}{@pytest.mark.slow}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00128}00128\ \textcolor{keyword}{def\ }test\_hash\_collisions(monkeypatch):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00129}00129\ \ \ \ \ \textcolor{comment}{\#\ non-\/smoke\ test\ that\ we\ don't\ get\ hash\ collisions}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00130}00130\ \ \ \ \ size\_cutoff\ =\ 50}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00131}00131\ \ \ \ \ \textcolor{keyword}{with}\ monkeypatch.context()\ \textcolor{keyword}{as}\ m:}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ m.setattr(libindex,\ \textcolor{stringliteral}{"{}\_SIZE\_CUTOFF"{}},\ size\_cutoff)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ index\ =\ MultiIndex.from\_product(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ [np.arange(8),\ np.arange(8)],\ names=[\textcolor{stringliteral}{"{}one"{}},\ \textcolor{stringliteral}{"{}two"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ result\ =\ index.get\_indexer(index.values)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ tm.assert\_numpy\_array\_equal(result,\ np.arange(len(index),\ dtype=\textcolor{stringliteral}{"{}intp"{}}))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ [0,\ 1,\ len(index)\ -\/\ 2,\ len(index)\ -\/\ 1]:}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ index.get\_loc(index[i])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ result\ ==\ i}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00144}00144\ \textcolor{keyword}{def\ }test\_dims():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00145}00145\ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00148}00148\ \textcolor{keyword}{def\ }test\_take\_invalid\_kwargs():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00149}00149\ \ \ \ \ vals\ =\ [[\textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}B"{}}],\ [pd.Timestamp(\textcolor{stringliteral}{"{}2011-\/01-\/01"{}}),\ pd.Timestamp(\textcolor{stringliteral}{"{}2011-\/01-\/02"{}})]]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00150}00150\ \ \ \ \ idx\ =\ MultiIndex.from\_product(vals,\ names=[\textcolor{stringliteral}{"{}str"{}},\ \textcolor{stringliteral}{"{}dt"{}}])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00151}00151\ \ \ \ \ indices\ =\ [1,\ 2]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00153}00153\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{r"{}take\(\backslash\)(\(\backslash\))\ got\ an\ unexpected\ keyword\ argument\ 'foo'"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00154}00154\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ idx.take(indices,\ foo=2)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00157}00157\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}the\ 'out'\ parameter\ is\ not\ supported"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00158}00158\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ idx.take(indices,\ out=indices)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00161}00161\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}the\ 'mode'\ parameter\ is\ not\ supported"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00162}00162\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ idx.take(indices,\ mode=\textcolor{stringliteral}{"{}clip"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00166}00166\ \textcolor{keyword}{def\ }test\_isna\_behavior(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00167}00167\ \ \ \ \ \textcolor{comment}{\#\ should\ not\ segfault\ GH5123}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00168}00168\ \ \ \ \ \textcolor{comment}{\#\ NOTE:\ if\ MI\ representation\ changes,\ may\ make\ sense\ to\ allow}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00169}00169\ \ \ \ \ \textcolor{comment}{\#\ isna(MI)}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00170}00170\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}isna\ is\ not\ defined\ for\ MultiIndex"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00171}00171\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(NotImplementedError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ pd.isna(idx)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00175}00175\ \textcolor{keyword}{def\ }test\_large\_multiindex\_error(monkeypatch):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00176}00176\ \ \ \ \ \textcolor{comment}{\#\ GH12527}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00177}00177\ \ \ \ \ size\_cutoff\ =\ 50}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00178}00178\ \ \ \ \ \textcolor{keyword}{with}\ monkeypatch.context()\ \textcolor{keyword}{as}\ m:}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ m.setattr(libindex,\ \textcolor{stringliteral}{"{}\_SIZE\_CUTOFF"{}},\ size\_cutoff)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ df\_below\_cutoff\ =\ pd.DataFrame(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ index=MultiIndex.from\_product([[1,\ 2],\ range(size\_cutoff\ -\/\ 1)]),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ columns=[\textcolor{stringliteral}{"{}dest"{}}],}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(KeyError,\ match=\textcolor{stringliteral}{r"{}\string^\(\backslash\)(-\/1,\ 0\(\backslash\))\$"{}}):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ df\_below\_cutoff.loc[(-\/1,\ 0),\ \textcolor{stringliteral}{"{}dest"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(KeyError,\ match=\textcolor{stringliteral}{r"{}\string^\(\backslash\)(3,\ 0\(\backslash\))\$"{}}):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ df\_below\_cutoff.loc[(3,\ 0),\ \textcolor{stringliteral}{"{}dest"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ df\_above\_cutoff\ =\ pd.DataFrame(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ index=MultiIndex.from\_product([[1,\ 2],\ range(size\_cutoff\ +\ 1)]),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ columns=[\textcolor{stringliteral}{"{}dest"{}}],}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(KeyError,\ match=\textcolor{stringliteral}{r"{}\string^\(\backslash\)(-\/1,\ 0\(\backslash\))\$"{}}):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ df\_above\_cutoff.loc[(-\/1,\ 0),\ \textcolor{stringliteral}{"{}dest"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(KeyError,\ match=\textcolor{stringliteral}{r"{}\string^\(\backslash\)(3,\ 0\(\backslash\))\$"{}}):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ df\_above\_cutoff.loc[(3,\ 0),\ \textcolor{stringliteral}{"{}dest"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00198}00198\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00200}00200\ \textcolor{keyword}{def\ }test\_mi\_hashtable\_populated\_attribute\_error(monkeypatch):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00201}00201\ \ \ \ \ \textcolor{comment}{\#\ GH\ 18165}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00202}00202\ \ \ \ \ monkeypatch.setattr(libindex,\ \textcolor{stringliteral}{"{}\_SIZE\_CUTOFF"{}},\ 50)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00203}00203\ \ \ \ \ r\ =\ range(50)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00204}00204\ \ \ \ \ df\ =\ pd.DataFrame(\{\textcolor{stringliteral}{"{}a"{}}:\ r,\ \textcolor{stringliteral}{"{}b"{}}:\ r\},\ index=MultiIndex.from\_arrays([r,\ r]))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00206}00206\ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}'Series'\ object\ has\ no\ attribute\ 'foo'"{}}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00207}00207\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(AttributeError,\ match=msg):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{"{}a"{}}].\mbox{\hyperlink{namespacefoo}{foo}}()}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00211}00211\ \textcolor{keyword}{def\ }test\_can\_hold\_identifiers(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00212}00212\ \ \ \ \ key\ =\ idx[0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00213}00213\ \ \ \ \ \textcolor{keyword}{assert}\ idx.\_can\_hold\_identifiers\_and\_holds\_name(key)\ \textcolor{keywordflow}{is}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00216}00216\ \textcolor{keyword}{def\ }test\_metadata\_immutable(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00217}00217\ \ \ \ \ levels,\ codes\ =\ idx.levels,\ idx.codes}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00218}00218\ \ \ \ \ \textcolor{comment}{\#\ shouldn't\ be\ able\ to\ set\ at\ either\ the\ top\ level\ or\ base\ level}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00219}00219\ \ \ \ \ mutable\_regex\ =\ re.compile(\textcolor{stringliteral}{"{}does\ not\ support\ mutable\ operations"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00220}00220\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=mutable\_regex):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ levels[0]\ =\ levels[0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00222}00222\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=mutable\_regex):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ levels[0][0]\ =\ levels[0][0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00224}00224\ \ \ \ \ \textcolor{comment}{\#\ ditto\ for\ labels}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00225}00225\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=mutable\_regex):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ codes[0]\ =\ codes[0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00227}00227\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}assignment\ destination\ is\ read-\/only"{}}):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ codes[0][0]\ =\ codes[0][0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00229}00229\ \ \ \ \ \textcolor{comment}{\#\ and\ for\ names}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00230}00230\ \ \ \ \ names\ =\ idx.names}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00231}00231\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=mutable\_regex):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ names[0]\ =\ names[0]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00233}00233\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00235}00235\ \textcolor{keyword}{def\ }test\_level\_setting\_resets\_attributes():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00236}00236\ \ \ \ \ ind\ =\ MultiIndex.from\_arrays([[\textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}B"{}},\ \textcolor{stringliteral}{"{}B"{}},\ \textcolor{stringliteral}{"{}B"{}}],\ [1,\ 2,\ 1,\ 2,\ 3]])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00237}00237\ \ \ \ \ \textcolor{keyword}{assert}\ ind.is\_monotonic\_increasing}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00238}00238\ \ \ \ \ ind\ =\ ind.set\_levels([[\textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}B"{}}],\ [1,\ 3,\ 2]])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00239}00239\ \ \ \ \ \textcolor{comment}{\#\ if\ this\ fails,\ probably\ didn't\ reset\ the\ cache\ correctly.}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00240}00240\ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ ind.is\_monotonic\_increasing}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00242}00242\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00243}00243\ \textcolor{keyword}{def\ }test\_rangeindex\_fallback\_coercion\_bug():}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00244}00244\ \ \ \ \ \textcolor{comment}{\#\ GH\ 12893}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00245}00245\ \ \ \ \ df1\ =\ pd.DataFrame(np.arange(100).reshape((10,\ 10)))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00246}00246\ \ \ \ \ df2\ =\ pd.DataFrame(np.arange(100).reshape((10,\ 10)))}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00247}00247\ \ \ \ \ df\ =\ pd.concat(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}df1"{}}:\ df1.stack(future\_stack=\textcolor{keyword}{True}),\ \textcolor{stringliteral}{"{}df2"{}}:\ df2.stack(future\_stack=\textcolor{keyword}{True})\},}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ axis=1,}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00250}00250\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00251}00251\ \ \ \ \ df.index.names\ =\ [\textcolor{stringliteral}{"{}fizz"{}},\ \textcolor{stringliteral}{"{}buzz"{}}]}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00252}00252\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00253}00253\ \ \ \ \ expected\ =\ pd.DataFrame(}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}df2"{}}:\ np.arange(100),\ \textcolor{stringliteral}{"{}df1"{}}:\ np.arange(100)\},}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ index=MultiIndex.from\_product([range(10),\ range(10)],\ names=[\textcolor{stringliteral}{"{}fizz"{}},\ \textcolor{stringliteral}{"{}buzz"{}}]),}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00256}00256\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00257}00257\ \ \ \ \ tm.assert\_frame\_equal(df,\ expected,\ check\_like=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00258}00258\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00259}00259\ \ \ \ \ result\ =\ df.index.get\_level\_values(\textcolor{stringliteral}{"{}fizz"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00260}00260\ \ \ \ \ expected\ =\ Index(np.arange(10,\ dtype=np.int64),\ name=\textcolor{stringliteral}{"{}fizz"{}}).repeat(10)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00261}00261\ \ \ \ \ tm.assert\_index\_equal(result,\ expected)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00263}00263\ \ \ \ \ result\ =\ df.index.get\_level\_values(\textcolor{stringliteral}{"{}buzz"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00264}00264\ \ \ \ \ expected\ =\ Index(np.tile(np.arange(10,\ dtype=np.int64),\ 10),\ name=\textcolor{stringliteral}{"{}buzz"{}})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00265}00265\ \ \ \ \ tm.assert\_index\_equal(result,\ expected)}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00266}00266\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00267}00267\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00268}00268\ \textcolor{keyword}{def\ }test\_memory\_usage(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00269}00269\ \ \ \ \ result\ =\ idx.memory\_usage()}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00270}00270\ \ \ \ \ \textcolor{keywordflow}{if}\ len(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ idx.get\_loc(idx[0])}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ result2\ =\ idx.memory\_usage()}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ result3\ =\ idx.memory\_usage(deep=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00274}00274\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ RangeIndex,\ IntervalIndex}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ don't\ have\ engines}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(idx,\ (RangeIndex,\ IntervalIndex)):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ result2\ >\ result}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ idx.inferred\_type\ ==\ \textcolor{stringliteral}{"{}object"{}}:}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ result3\ >\ result2}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00283}00283\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ report\ 0\ for\ no-\/length}}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ result\ ==\ 0}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00288}00288\ \textcolor{keyword}{def\ }test\_nlevels(idx):}
\DoxyCodeLine{\Hypertarget{test__integrity_8py_source_l00289}00289\ \ \ \ \ \textcolor{keyword}{assert}\ idx.nlevels\ ==\ 2}

\end{DoxyCode}
