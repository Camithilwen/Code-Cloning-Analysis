\doxysection{\+\_\+binned\+\_\+statistic.\+py}
\hypertarget{__binned__statistic_8py_source}{}\label{__binned__statistic_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_binned\_statistic.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_binned\_statistic.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic}{00001}}\ \textcolor{keyword}{import}\ builtins}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00002}00002\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ suppress\_warnings}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00004}00004\ \textcolor{keyword}{from}\ operator\ \textcolor{keyword}{import}\ index}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00005}00005\ \textcolor{keyword}{from}\ collections\ \textcolor{keyword}{import}\ namedtuple}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00007}00007\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'binned\_statistic'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00008}00008\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'binned\_statistic\_2d'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00009}00009\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'binned\_statistic\_dd'}]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00012}00012\ BinnedStatisticResult\ =\ \mbox{\hyperlink{classnamedtuple}{namedtuple}}(\textcolor{stringliteral}{'BinnedStatisticResult'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00013}00013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'bin\_edges'},\ \textcolor{stringliteral}{'binnumber'}))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00016}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a5cd625761034ea56de8bda72e2be7d3e}{00016}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a5cd625761034ea56de8bda72e2be7d3e}{binned\_statistic}}(x,\ values,\ statistic='mean',}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bins=10,\ range=None):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00018}00018\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ Compute\ a\ binned\ statistic\ for\ one\ or\ more\ sets\ of\ data.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00020}00020\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ This\ is\ a\ generalization\ of\ a\ histogram\ function.\ \ A\ histogram\ divides}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ the\ space\ into\ bins,\ and\ returns\ the\ count\ of\ the\ number\ of\ points\ in}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ each\ bin.\ \ This\ function\ allows\ the\ computation\ of\ the\ sum,\ mean,\ median,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ or\ other\ statistic\ of\ the\ values\ (or\ set\ of\ values)\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00025}00025\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ x\ :\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ of\ values\ to\ be\ binned.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ values\ :\ (N,)\ array\_like\ or\ list\ of\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ data\ on\ which\ the\ statistic\ will\ be\ computed.\ \ This\ must\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ same\ shape\ as\ \`{}x\`{},\ or\ a\ set\ of\ sequences\ -\/\ each\ the\ same\ shape\ as}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}x\`{}.\ \ If\ \`{}values\`{}\ is\ a\ set\ of\ sequences,\ the\ statistic\ will\ be\ computed}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ on\ each\ independently.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ string\ or\ callable,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ statistic\ to\ compute\ (default\ is\ 'mean').}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ following\ statistics\ are\ available:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00038}00038\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'mean'\ :\ compute\ the\ mean\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'std'\ :\ compute\ the\ standard\ deviation\ within\ each\ bin.\ This}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ is\ implicitly\ calculated\ with\ ddof=0.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'median'\ :\ compute\ the\ median\ of\ values\ for\ points\ within\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ bin.\ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'count'\ :\ compute\ the\ count\ of\ points\ within\ each\ bin.\ \ This\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ identical\ to\ an\ unweighted\ histogram.\ \ \`{}values\`{}\ array\ is\ not}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ referenced.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'sum'\ :\ compute\ the\ sum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ This\ is\ identical\ to\ a\ weighted\ histogram.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'min'\ :\ compute\ the\ minimum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'max'\ :\ compute\ the\ maximum\ of\ values\ for\ point\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ function\ :\ a\ user-\/defined\ function\ which\ takes\ a\ 1D\ array\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ values,\ and\ outputs\ a\ single\ numerical\ statistic.\ This\ function}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ will\ be\ called\ on\ the\ values\ in\ each\ bin.\ \ Empty\ bins\ will\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ represented\ by\ function([]),\ or\ NaN\ if\ this\ returns\ an\ error.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00058}00058\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ bins\ :\ int\ or\ sequence\ of\ scalars,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}bins\`{}\ is\ an\ int,\ it\ defines\ the\ number\ of\ equal-\/width\ bins\ in\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ given\ range\ (10\ by\ default).\ \ If\ \`{}bins\`{}\ is\ a\ sequence,\ it\ defines\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bin\ edges,\ including\ the\ rightmost\ edge,\ allowing\ for\ non-\/uniform\ bin}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ widths.\ \ Values\ in\ \`{}x\`{}\ that\ are\ smaller\ than\ lowest\ bin\ edge\ are}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ assigned\ to\ bin\ number\ 0,\ values\ beyond\ the\ highest\ bin\ are\ assigned\ to}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}bins[-\/1]\`{}\`{}.\ \ If\ the\ bin\ edges\ are\ specified,\ the\ number\ of\ bins\ will}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be,\ (nx\ =\ len(bins)-\/1).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ range\ :\ (float,\ float)\ or\ [(float,\ float)],\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ lower\ and\ upper\ range\ of\ the\ bins.\ \ If\ not\ provided,\ range}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ simply\ \`{}\`{}(x.min(),\ x.max())\`{}\`{}.\ \ Values\ outside\ the\ range\ are}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ignored.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00071}00071\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ array}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ of\ the\ selected\ statistic\ in\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ bin\_edges\ :\ array\ of\ dtype\ float}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return\ the\ bin\ edges\ \`{}\`{}(length(statistic)+1)\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ binnumber:\ 1-\/D\ ndarray\ of\ ints}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Indices\ of\ the\ bins\ (corresponding\ to\ \`{}bin\_edges\`{})\ in\ which\ each\ value}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ \`{}x\`{}\ belongs.\ \ Same\ length\ as\ \`{}values\`{}.\ \ A\ binnumber\ of\ \`{}i\`{}\ means\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ corresponding\ value\ is\ between\ (bin\_edges[i-\/1],\ bin\_edges[i]).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00082}00082\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ numpy.digitize,\ numpy.histogram,\ binned\_statistic\_2d,\ binned\_statistic\_dd}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00086}00086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ All\ but\ the\ last\ (righthand-\/most)\ bin\ is\ half-\/open.\ \ In\ other\ words,\ if}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \`{}bins\`{}\ is\ \`{}\`{}[1,\ 2,\ 3,\ 4]\`{}\`{},\ then\ the\ first\ bin\ is\ \`{}\`{}[1,\ 2)\`{}\`{}\ (including\ 1,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ but\ excluding\ 2)\ and\ the\ second\ \`{}\`{}[2,\ 3)\`{}\`{}.\ \ The\ last\ bin,\ however,\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}[3,\ 4]\`{}\`{},\ which\ *includes*\ 4.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00093}00093\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.11.0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00095}00095\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00101}00101\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ First\ some\ basic\ examples:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00103}00103\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ Create\ two\ evenly\ spaced\ bins\ in\ the\ range\ of\ the\ given\ sample,\ and\ sum\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ corresponding\ values\ in\ each\ of\ those\ bins:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00106}00106\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ >>>\ values\ =\ [1.0,\ 1.0,\ 2.0,\ 1.5,\ 3.0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ >>>\ stats.binned\_statistic([1,\ 1,\ 2,\ 5,\ 7],\ values,\ 'sum',\ bins=2)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ BinnedStatisticResult(statistic=array([4.\ ,\ 4.5]),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ bin\_edges=array([1.,\ 4.,\ 7.]),\ binnumber=array([1,\ 1,\ 1,\ 2,\ 2]))}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00111}00111\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ Multiple\ arrays\ of\ values\ can\ also\ be\ passed.\ \ The\ statistic\ is\ calculated}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ on\ each\ set\ independently:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00114}00114\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ >>>\ values\ =\ [[1.0,\ 1.0,\ 2.0,\ 1.5,\ 3.0],\ [2.0,\ 2.0,\ 4.0,\ 3.0,\ 6.0]]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ >>>\ stats.binned\_statistic([1,\ 1,\ 2,\ 5,\ 7],\ values,\ 'sum',\ bins=2)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ BinnedStatisticResult(statistic=array([[4.\ ,\ 4.5],}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [8.\ ,\ 9.\ ]]),\ bin\_edges=array([1.,\ 4.,\ 7.]),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00119}00119\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ binnumber=array([1,\ 1,\ 1,\ 2,\ 2]))}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00120}00120\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ >>>\ stats.binned\_statistic([1,\ 2,\ 1,\ 2,\ 4],\ np.arange(5),\ statistic='mean',}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bins=3)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ BinnedStatisticResult(statistic=array([1.,\ 2.,\ 4.]),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ bin\_edges=array([1.,\ 2.,\ 3.,\ 4.]),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ binnumber=array([1,\ 2,\ 1,\ 2,\ 3]))}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00126}00126\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ As\ a\ second\ example,\ we\ now\ generate\ some\ random\ data\ of\ sailing\ boat\ speed}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00128}00128\ \textcolor{stringliteral}{\ \ \ \ as\ a\ function\ of\ wind\ speed,\ and\ then\ determine\ how\ fast\ our\ boat\ is\ for}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ certain\ wind\ speeds:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00130}00130\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ >>>\ rng\ =\ np.random.default\_rng()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ >>>\ windspeed\ =\ 8\ *\ rng.random(500)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ >>>\ boatspeed\ =\ .3\ *\ windspeed**.5\ +\ .2\ *\ rng.random(500)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ >>>\ bin\_means,\ bin\_edges,\ binnumber\ =\ stats.binned\_statistic(windspeed,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boatspeed,\ statistic='median',\ bins=[1,2,3,4,5,6,7])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.figure()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(windspeed,\ boatspeed,\ 'b.',\ label='raw\ data')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.hlines(bin\_means,\ bin\_edges[:-\/1],\ bin\_edges[1:],\ colors='g',\ lw=5,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ label='binned\ statistic\ of\ data')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.legend()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00141}00141\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ Now\ we\ can\ use\ \`{}\`{}binnumber\`{}\`{}\ to\ select\ all\ datapoints\ with\ a\ windspeed}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ below\ 1:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00144}00144\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ >>>\ low\_boatspeed\ =\ boatspeed[binnumber\ ==\ 0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00146}00146\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ As\ a\ final\ example,\ we\ will\ use\ \`{}\`{}bin\_edges\`{}\`{}\ and\ \`{}\`{}binnumber\`{}\`{}\ to\ make\ a}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ plot\ of\ a\ distribution\ that\ shows\ the\ mean\ and\ distribution\ around\ that}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ mean\ per\ bin,\ on\ top\ of\ a\ regular\ histogram\ and\ the\ probability}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ distribution\ function:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00151}00151\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(0,\ 5,\ num=500)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\_pdf\ =\ stats.maxwell.pdf(x)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ >>>\ samples\ =\ stats.maxwell.rvs(size=10000)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00155}00155\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00156}00156\ \textcolor{stringliteral}{\ \ \ \ >>>\ bin\_means,\ bin\_edges,\ binnumber\ =\ stats.binned\_statistic(x,\ x\_pdf,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ statistic='mean',\ bins=25)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ >>>\ bin\_width\ =\ (bin\_edges[1]\ -\/\ bin\_edges[0])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ >>>\ bin\_centers\ =\ bin\_edges[1:]\ -\/\ bin\_width/2}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00160}00160\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.figure()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.hist(samples,\ bins=50,\ density=True,\ histtype='stepfilled',}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ alpha=0.2,\ label='histogram\ of\ data')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(x,\ x\_pdf,\ 'r-\/',\ label='analytical\ pdf')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.hlines(bin\_means,\ bin\_edges[:-\/1],\ bin\_edges[1:],\ colors='g',\ lw=2,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ label='binned\ statistic\ of\ data')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot((binnumber\ -\/\ 0.5)\ *\ bin\_width,\ x\_pdf,\ 'g.',\ alpha=0.5)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.legend(fontsize=10)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00170}00170\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ N\ =\ len(bins)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00174}00174\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ N\ =\ 1}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00177}00177\ \ \ \ \ \textcolor{keywordflow}{if}\ N\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ bins\ =\ [np.asarray(bins,\ float)]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00180}00180\ \ \ \ \ \textcolor{keywordflow}{if}\ range\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(range)\ ==\ 2:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ range\ =\ [range]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00184}00184\ \ \ \ \ medians,\ edges,\ binnumbers\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a501a78ea072090c86a91fbb425112eca}{binned\_statistic\_dd}}(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ [x],\ values,\ statistic,\ bins,\ range)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00186}00186\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00187}00187\ \ \ \ \ \textcolor{keywordflow}{return}\ BinnedStatisticResult(medians,\ edges[0],\ binnumbers)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00190}00190\ BinnedStatistic2dResult\ =\ \mbox{\hyperlink{classnamedtuple}{namedtuple}}(\textcolor{stringliteral}{'BinnedStatistic2dResult'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'x\_edge'},\ \textcolor{stringliteral}{'y\_edge'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'binnumber'}))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00195}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a33b0bb6c6eab69e2bbb24f8059db82f5}{00195}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a33b0bb6c6eab69e2bbb24f8059db82f5}{binned\_statistic\_2d}}(x,\ y,\ values,\ statistic='mean',}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bins=10,\ range=None,\ expand\_binnumbers=False):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00197}00197\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ Compute\ a\ bidimensional\ binned\ statistic\ for\ one\ or\ more\ sets\ of\ data.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00199}00199\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ This\ is\ a\ generalization\ of\ a\ histogram2d\ function.\ \ A\ histogram\ divides}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ the\ space\ into\ bins,\ and\ returns\ the\ count\ of\ the\ number\ of\ points\ in}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ each\ bin.\ \ This\ function\ allows\ the\ computation\ of\ the\ sum,\ mean,\ median,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ or\ other\ statistic\ of\ the\ values\ (or\ set\ of\ values)\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00204}00204\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ x\ :\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ of\ values\ to\ be\ binned\ along\ the\ first\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ y\ :\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ of\ values\ to\ be\ binned\ along\ the\ second\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ values\ :\ (N,)\ array\_like\ or\ list\ of\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ data\ on\ which\ the\ statistic\ will\ be\ computed.\ \ This\ must\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ same\ shape\ as\ \`{}x\`{},\ or\ a\ list\ of\ sequences\ -\/\ each\ with\ the\ same}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ shape\ as\ \`{}x\`{}.\ \ If\ \`{}values\`{}\ is\ such\ a\ list,\ the\ statistic\ will\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ computed\ on\ each\ independently.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ string\ or\ callable,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00217}00217\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ statistic\ to\ compute\ (default\ is\ 'mean').}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ following\ statistics\ are\ available:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00219}00219\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00220}00220\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'mean'\ :\ compute\ the\ mean\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'std'\ :\ compute\ the\ standard\ deviation\ within\ each\ bin.\ This}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ is\ implicitly\ calculated\ with\ ddof=0.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00224}00224\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'median'\ :\ compute\ the\ median\ of\ values\ for\ points\ within\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ bin.\ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'count'\ :\ compute\ the\ count\ of\ points\ within\ each\ bin.\ \ This\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00227}00227\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ identical\ to\ an\ unweighted\ histogram.\ \ \`{}values\`{}\ array\ is\ not}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ referenced.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'sum'\ :\ compute\ the\ sum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00230}00230\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ This\ is\ identical\ to\ a\ weighted\ histogram.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00231}00231\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'min'\ :\ compute\ the\ minimum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00232}00232\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00233}00233\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'max'\ :\ compute\ the\ maximum\ of\ values\ for\ point\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00235}00235\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ function\ :\ a\ user-\/defined\ function\ which\ takes\ a\ 1D\ array\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ values,\ and\ outputs\ a\ single\ numerical\ statistic.\ This\ function}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ will\ be\ called\ on\ the\ values\ in\ each\ bin.\ \ Empty\ bins\ will\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ represented\ by\ function([]),\ or\ NaN\ if\ this\ returns\ an\ error.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00239}00239\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00240}00240\ \textcolor{stringliteral}{\ \ \ \ bins\ :\ int\ or\ [int,\ int]\ or\ array\_like\ or\ [array,\ array],\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bin\ specification:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00242}00242\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ the\ number\ of\ bins\ for\ the\ two\ dimensions\ (nx\ =\ ny\ =\ bins),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ the\ number\ of\ bins\ in\ each\ dimension\ (nx,\ ny\ =\ bins),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ the\ bin\ edges\ for\ the\ two\ dimensions\ (x\_edge\ =\ y\_edge\ =\ bins),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ the\ bin\ edges\ in\ each\ dimension\ (x\_edge,\ y\_edge\ =\ bins).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00247}00247\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ the\ bin\ edges\ are\ specified,\ the\ number\ of\ bins\ will\ be,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (nx\ =\ len(x\_edge)-\/1,\ ny\ =\ len(y\_edge)-\/1).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00250}00250\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ range\ :\ (2,2)\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ leftmost\ and\ rightmost\ edges\ of\ the\ bins\ along\ each\ dimension}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (if\ not\ specified\ explicitly\ in\ the\ \`{}bins\`{}\ parameters):}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ [[xmin,\ xmax],\ [ymin,\ ymax]].\ All\ values\ outside\ of\ this\ range\ will\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ considered\ outliers\ and\ not\ tallied\ in\ the\ histogram.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ expand\_binnumbers\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'False'\ (default):\ the\ returned\ \`{}binnumber\`{}\ is\ a\ shape\ (N,)\ array\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ linearized\ bin\ indices.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'True':\ the\ returned\ \`{}binnumber\`{}\ is\ 'unraveled'\ into\ a\ shape\ (2,N)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ndarray,\ where\ each\ row\ gives\ the\ bin\ numbers\ in\ the\ corresponding}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ the\ \`{}binnumber\`{}\ returned\ value,\ and\ the\ \`{}Examples\`{}\ section.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00263}00263\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionadded::\ 0.17.0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00265}00265\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ (nx,\ ny)\ ndarray}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ of\ the\ selected\ statistic\ in\ each\ two-\/dimensional\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ x\_edge\ :\ (nx\ +\ 1)\ ndarray}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bin\ edges\ along\ the\ first\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ y\_edge\ :\ (ny\ +\ 1)\ ndarray}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bin\ edges\ along\ the\ second\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ binnumber\ :\ (N,)\ array\ of\ ints\ or\ (2,N)\ ndarray\ of\ ints}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ assigns\ to\ each\ element\ of\ \`{}sample\`{}\ an\ integer\ that\ represents\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bin\ in\ which\ this\ observation\ falls.\ \ The\ representation\ depends\ on\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}expand\_binnumbers\`{}\ argument.\ \ See\ \`{}Notes\`{}\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00278}00278\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00279}00279\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ numpy.digitize,\ numpy.histogram2d,\ binned\_statistic,\ binned\_statistic\_dd}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00283}00283\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00285}00285\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ Binedges:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ All\ but\ the\ last\ (righthand-\/most)\ bin\ is\ half-\/open.\ \ In\ other\ words,\ if}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ \`{}bins\`{}\ is\ \`{}\`{}[1,\ 2,\ 3,\ 4]\`{}\`{},\ then\ the\ first\ bin\ is\ \`{}\`{}[1,\ 2)\`{}\`{}\ (including\ 1,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00289}00289\ \textcolor{stringliteral}{\ \ \ \ but\ excluding\ 2)\ and\ the\ second\ \`{}\`{}[2,\ 3)\`{}\`{}.\ \ The\ last\ bin,\ however,\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}[3,\ 4]\`{}\`{},\ which\ *includes*\ 4.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00291}00291\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ \`{}binnumber\`{}:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ This\ returned\ argument\ assigns\ to\ each\ element\ of\ \`{}sample\`{}\ an\ integer\ that}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ represents\ the\ bin\ in\ which\ it\ belongs.\ \ The\ representation\ depends\ on\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ \`{}expand\_binnumbers\`{}\ argument.\ If\ 'False'\ (default):\ The\ returned}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \`{}binnumber\`{}\ is\ a\ shape\ (N,)\ array\ of\ linearized\ indices\ mapping\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ element\ of\ \`{}sample\`{}\ to\ its\ corresponding\ bin\ (using\ row-\/major\ ordering).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ the\ returned\ linearized\ bin\ indices\ are\ used\ for\ an\ array\ with}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ extra\ bins\ on\ the\ outer\ binedges\ to\ capture\ values\ outside\ of\ the\ defined}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ bin\ bounds.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ If\ 'True':\ The\ returned\ \`{}binnumber\`{}\ is\ a\ shape\ (2,N)\ ndarray\ where}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ each\ row\ indicates\ bin\ placements\ for\ each\ dimension\ respectively.\ \ In\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ dimension,\ a\ binnumber\ of\ \`{}i\`{}\ means\ the\ corresponding\ value\ is\ between}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ (D\_edge[i-\/1],\ D\_edge[i]),\ where\ 'D'\ is\ either\ 'x'\ or\ 'y'.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00305}00305\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.11.0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00307}00307\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00311}00311\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ Calculate\ the\ counts\ with\ explicit\ bin-\/edges:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00313}00313\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ [0.1,\ 0.1,\ 0.1,\ 0.6]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00315}00315\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ [2.1,\ 2.6,\ 2.1,\ 2.1]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ >>>\ binx\ =\ [0.0,\ 0.5,\ 1.0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ >>>\ biny\ =\ [2.0,\ 2.5,\ 3.0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ stats.binned\_statistic\_2d(x,\ y,\ None,\ 'count',\ bins=[binx,\ biny])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret.statistic}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ array([[2.,\ 1.],}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [1.,\ 0.]])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00322}00322\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ The\ bin\ in\ which\ each\ sample\ is\ placed\ is\ given\ by\ the\ \`{}binnumber\`{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ returned\ parameter.\ \ By\ default,\ these\ are\ the\ linearized\ bin\ indices:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00325}00325\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret.binnumber}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ array([5,\ 6,\ 5,\ 9])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00328}00328\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ The\ bin\ indices\ can\ also\ be\ expanded\ into\ separate\ entries\ for\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ dimension\ using\ the\ \`{}expand\_binnumbers\`{}\ parameter:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00331}00331\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ stats.binned\_statistic\_2d(x,\ y,\ None,\ 'count',\ bins=[binx,\ biny],}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expand\_binnumbers=True)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret.binnumber}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ array([[1,\ 1,\ 1,\ 2],}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [1,\ 2,\ 1,\ 1]])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00337}00337\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ Which\ shows\ that\ the\ first\ three\ elements\ belong\ in\ the\ xbin\ 1,\ and\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ fourth\ into\ xbin\ 2;\ and\ so\ on\ for\ y.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00340}00340\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00342}00342\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00343}00343\ \ \ \ \ \textcolor{comment}{\#\ This\ code\ is\ based\ on\ np.histogram2d}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00344}00344\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ N\ =\ len(bins)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00346}00346\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ N\ =\ 1}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00348}00348\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00349}00349\ \ \ \ \ \textcolor{keywordflow}{if}\ N\ !=\ 1\ \textcolor{keywordflow}{and}\ N\ !=\ 2:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ xedges\ =\ yedges\ =\ np.asarray(bins,\ float)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ bins\ =\ [xedges,\ yedges]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00352}00352\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00353}00353\ \ \ \ \ medians,\ edges,\ binnumbers\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a501a78ea072090c86a91fbb425112eca}{binned\_statistic\_dd}}(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ [x,\ y],\ values,\ statistic,\ bins,\ range,}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ expand\_binnumbers=expand\_binnumbers)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00356}00356\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00357}00357\ \ \ \ \ \textcolor{keywordflow}{return}\ BinnedStatistic2dResult(medians,\ edges[0],\ edges[1],\ binnumbers)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00360}00360\ BinnedStatisticddResult\ =\ \mbox{\hyperlink{classnamedtuple}{namedtuple}}(\textcolor{stringliteral}{'BinnedStatisticddResult'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'statistic'},\ \textcolor{stringliteral}{'bin\_edges'},}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'binnumber'}))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00364}00364\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00365}00365\ \textcolor{keyword}{def\ }\_bincount(x,\ weights):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00366}00366\ \ \ \ \ \textcolor{keywordflow}{if}\ np.iscomplexobj(weights):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ a\ =\ np.bincount(x,\ np.real(weights))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ b\ =\ np.bincount(x,\ np.imag(weights))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ z\ =\ a\ +\ b*1j}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00371}00371\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ z\ =\ np.bincount(x,\ weights)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00373}00373\ \ \ \ \ \textcolor{keywordflow}{return}\ z}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00374}00374\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00375}00375\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00376}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a501a78ea072090c86a91fbb425112eca}{00376}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a501a78ea072090c86a91fbb425112eca}{binned\_statistic\_dd}}(sample,\ values,\ statistic='mean',}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bins=10,\ range=None,\ expand\_binnumbers=False,}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ binned\_statistic\_result=None):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00379}00379\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ Compute\ a\ multidimensional\ binned\ statistic\ for\ a\ set\ of\ data.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00381}00381\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ This\ is\ a\ generalization\ of\ a\ histogramdd\ function.\ \ A\ histogram\ divides}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00383}00383\ \textcolor{stringliteral}{\ \ \ \ the\ space\ into\ bins,\ and\ returns\ the\ count\ of\ the\ number\ of\ points\ in}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ each\ bin.\ \ This\ function\ allows\ the\ computation\ of\ the\ sum,\ mean,\ median,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ or\ other\ statistic\ of\ the\ values\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00386}00386\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ sample\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00390}00390\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Data\ to\ histogram\ passed\ as\ a\ sequence\ of\ N\ arrays\ of\ length\ D,\ or}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ an\ (N,D)\ array.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ values\ :\ (N,)\ array\_like\ or\ list\ of\ (N,)\ array\_like}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ data\ on\ which\ the\ statistic\ will\ be\ computed.\ \ This\ must\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00394}00394\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ same\ shape\ as\ \`{}sample\`{},\ or\ a\ list\ of\ sequences\ -\/\ each\ with\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ same\ shape\ as\ \`{}sample\`{}.\ \ If\ \`{}values\`{}\ is\ such\ a\ list,\ the\ statistic}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ will\ be\ computed\ on\ each\ independently.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ string\ or\ callable,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00398}00398\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ statistic\ to\ compute\ (default\ is\ 'mean').}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ following\ statistics\ are\ available:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00400}00400\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'mean'\ :\ compute\ the\ mean\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'median'\ :\ compute\ the\ median\ of\ values\ for\ points\ within\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00404}00404\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ bin.\ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'count'\ :\ compute\ the\ count\ of\ points\ within\ each\ bin.\ \ This\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ identical\ to\ an\ unweighted\ histogram.\ \ \`{}values\`{}\ array\ is\ not}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00407}00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ referenced.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'sum'\ :\ compute\ the\ sum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ This\ is\ identical\ to\ a\ weighted\ histogram.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'std'\ :\ compute\ the\ standard\ deviation\ within\ each\ bin.\ This}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ is\ implicitly\ calculated\ with\ ddof=0.\ If\ the\ number\ of\ values}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ within\ a\ given\ bin\ is\ 0\ or\ 1,\ the\ computed\ standard\ deviation\ value}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ will\ be\ 0\ for\ the\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'min'\ :\ compute\ the\ minimum\ of\ values\ for\ points\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00416}00416\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'max'\ :\ compute\ the\ maximum\ of\ values\ for\ point\ within\ each\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Empty\ bins\ will\ be\ represented\ by\ NaN.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ function\ :\ a\ user-\/defined\ function\ which\ takes\ a\ 1D\ array\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ values,\ and\ outputs\ a\ single\ numerical\ statistic.\ This\ function}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ will\ be\ called\ on\ the\ values\ in\ each\ bin.\ \ Empty\ bins\ will\ be}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ represented\ by\ function([]),\ or\ NaN\ if\ this\ returns\ an\ error.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00422}00422\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ bins\ :\ sequence\ or\ positive\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ bin\ specification\ must\ be\ in\ one\ of\ the\ following\ forms:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00425}00425\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ A\ sequence\ of\ arrays\ describing\ the\ bin\ edges\ along\ each\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ The\ number\ of\ bins\ for\ each\ dimension\ (nx,\ ny,\ ...\ =\ bins).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ The\ number\ of\ bins\ for\ all\ dimensions\ (nx\ =\ ny\ =\ ...\ =\ bins).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00429}00429\ \textcolor{stringliteral}{\ \ \ \ range\ :\ sequence,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ of\ lower\ and\ upper\ bin\ edges\ to\ be\ used\ if\ the\ edges\ are}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ not\ given\ explicitly\ in\ \`{}bins\`{}.\ Defaults\ to\ the\ minimum\ and\ maximum}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ values\ along\ each\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ expand\_binnumbers\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'False'\ (default):\ the\ returned\ \`{}binnumber\`{}\ is\ a\ shape\ (N,)\ array\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ linearized\ bin\ indices.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00436}00436\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'True':\ the\ returned\ \`{}binnumber\`{}\ is\ 'unraveled'\ into\ a\ shape\ (D,N)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00437}00437\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ndarray,\ where\ each\ row\ gives\ the\ bin\ numbers\ in\ the\ corresponding}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ the\ \`{}binnumber\`{}\ returned\ value,\ and\ the\ \`{}Examples\`{}\ section\ of}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}binned\_statistic\_2d\`{}.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ binned\_statistic\_result\ :\ binnedStatisticddResult}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Result\ of\ a\ previous\ call\ to\ the\ function\ in\ order\ to\ reuse\ bin\ edges}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ bin\ numbers\ with\ new\ values\ and/or\ a\ different\ statistic.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00444}00444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ To\ reuse\ bin\ numbers,\ \`{}expand\_binnumbers\`{}\ must\ have\ been\ set\ to\ False}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (the\ default)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00446}00446\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionadded::\ 0.17.0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00448}00448\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ statistic\ :\ ndarray,\ shape(nx1,\ nx2,\ nx3,...)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ of\ the\ selected\ statistic\ in\ each\ two-\/dimensional\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ bin\_edges\ :\ list\ of\ ndarrays}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ list\ of\ D\ arrays\ describing\ the\ (nxi\ +\ 1)\ bin\ edges\ for\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00456}00456\ \textcolor{stringliteral}{\ \ \ \ binnumber\ :\ (N,)\ array\ of\ ints\ or\ (D,N)\ ndarray\ of\ ints}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ assigns\ to\ each\ element\ of\ \`{}sample\`{}\ an\ integer\ that\ represents\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bin\ in\ which\ this\ observation\ falls.\ \ The\ representation\ depends\ on\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}expand\_binnumbers\`{}\ argument.\ \ See\ \`{}Notes\`{}\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00460}00460\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00461}00461\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00464}00464\ \textcolor{stringliteral}{\ \ \ \ numpy.digitize,\ numpy.histogramdd,\ binned\_statistic,\ binned\_statistic\_2d}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00465}00465\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00467}00467\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ Binedges:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ All\ but\ the\ last\ (righthand-\/most)\ bin\ is\ half-\/open\ in\ each\ dimension.\ \ In}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00470}00470\ \textcolor{stringliteral}{\ \ \ \ other\ words,\ if\ \`{}bins\`{}\ is\ \`{}\`{}[1,\ 2,\ 3,\ 4]\`{}\`{},\ then\ the\ first\ bin\ is}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}[1,\ 2)\`{}\`{}\ (including\ 1,\ but\ excluding\ 2)\ and\ the\ second\ \`{}\`{}[2,\ 3)\`{}\`{}.\ \ The}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ last\ bin,\ however,\ is\ \`{}\`{}[3,\ 4]\`{}\`{},\ which\ *includes*\ 4.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00473}00473\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00474}00474\ \textcolor{stringliteral}{\ \ \ \ \`{}binnumber\`{}:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ This\ returned\ argument\ assigns\ to\ each\ element\ of\ \`{}sample\`{}\ an\ integer\ that}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ represents\ the\ bin\ in\ which\ it\ belongs.\ \ The\ representation\ depends\ on\ the}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00477}00477\ \textcolor{stringliteral}{\ \ \ \ \`{}expand\_binnumbers\`{}\ argument.\ If\ 'False'\ (default):\ The\ returned}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00478}00478\ \textcolor{stringliteral}{\ \ \ \ \`{}binnumber\`{}\ is\ a\ shape\ (N,)\ array\ of\ linearized\ indices\ mapping\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00479}00479\ \textcolor{stringliteral}{\ \ \ \ element\ of\ \`{}sample\`{}\ to\ its\ corresponding\ bin\ (using\ row-\/major\ ordering).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00480}00480\ \textcolor{stringliteral}{\ \ \ \ If\ 'True':\ The\ returned\ \`{}binnumber\`{}\ is\ a\ shape\ (D,N)\ ndarray\ where}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ each\ row\ indicates\ bin\ placements\ for\ each\ dimension\ respectively.\ \ In\ each}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ dimension,\ a\ binnumber\ of\ \`{}i\`{}\ means\ the\ corresponding\ value\ is\ between}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00483}00483\ \textcolor{stringliteral}{\ \ \ \ (bin\_edges[D][i-\/1],\ bin\_edges[D][i]),\ for\ each\ dimension\ 'D'.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00484}00484\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.11.0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00486}00486\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00490}00490\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ stats}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00492}00492\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ mpl\_toolkits.mplot3d\ import\ Axes3D}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00493}00493\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ Take\ an\ array\ of\ 600\ (x,\ y)\ coordinates\ as\ an\ example.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ \`{}binned\_statistic\_dd\`{}\ can\ handle\ arrays\ of\ higher\ dimension\ \`{}D\`{}.\ But\ a\ plot}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ of\ dimension\ \`{}D+1\`{}\ is\ required.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00497}00497\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ >>>\ mu\ =\ np.array([0.,\ 1.])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ >>>\ sigma\ =\ np.array([[1.,\ -\/0.5],[-\/0.5,\ 1.5]])}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00500}00500\ \textcolor{stringliteral}{\ \ \ \ >>>\ multinormal\ =\ stats.multivariate\_normal(mu,\ sigma)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ >>>\ data\ =\ multinormal.rvs(size=600,\ random\_state=235412)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ >>>\ data.shape}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ (600,\ 2)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00504}00504\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ Create\ bins\ and\ count\ how\ many\ arrays\ fall\ in\ each\ bin:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00506}00506\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ >>>\ N\ =\ 60}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00508}00508\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ np.linspace(-\/3,\ 3,\ N)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ np.linspace(-\/3,\ 4,\ N)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret\ =\ stats.binned\_statistic\_dd(data,\ np.arange(600),\ bins=[x,\ y],}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00511}00511\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ statistic='count')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ >>>\ bincounts\ =\ ret.statistic}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00513}00513\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00514}00514\ \textcolor{stringliteral}{\ \ \ \ Set\ the\ volume\ and\ the\ location\ of\ bars:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00515}00515\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00516}00516\ \textcolor{stringliteral}{\ \ \ \ >>>\ dx\ =\ x[1]\ -\/\ x[0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00517}00517\ \textcolor{stringliteral}{\ \ \ \ >>>\ dy\ =\ y[1]\ -\/\ y[0]}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ >>>\ x,\ y\ =\ np.meshgrid(x[:-\/1]+dx/2,\ y[:-\/1]+dy/2)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00519}00519\ \textcolor{stringliteral}{\ \ \ \ >>>\ z\ =\ 0}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00520}00520\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00521}00521\ \textcolor{stringliteral}{\ \ \ \ >>>\ bincounts\ =\ bincounts.ravel()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00522}00522\ \textcolor{stringliteral}{\ \ \ \ >>>\ x\ =\ x.ravel()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ >>>\ y\ =\ y.ravel()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00524}00524\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig\ =\ plt.figure()}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00526}00526\ \textcolor{stringliteral}{\ \ \ \ >>>\ ax\ =\ fig.add\_subplot(111,\ projection='3d')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ >>>\ with\ np.errstate(divide='ignore'):\ \ \ \#\ silence\ random\ axes3d\ warning}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.bar3d(x,\ y,\ z,\ dx,\ dy,\ bincounts)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00529}00529\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ Reuse\ bin\ numbers\ and\ bin\ edges\ with\ new\ values:}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00531}00531\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ >>>\ ret2\ =\ stats.binned\_statistic\_dd(data,\ -\/np.arange(600),}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ binned\_statistic\_result=ret,}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ statistic='mean')}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00536}00536\ \ \ \ \ known\_stats\ =\ [\textcolor{stringliteral}{'mean'},\ \textcolor{stringliteral}{'median'},\ \textcolor{stringliteral}{'count'},\ \textcolor{stringliteral}{'sum'},\ \textcolor{stringliteral}{'std'},\ \textcolor{stringliteral}{'min'},\ \textcolor{stringliteral}{'max'}]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00537}00537\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ callable(statistic)\ \textcolor{keywordflow}{and}\ statistic\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ known\_stats:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00538}00538\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{'invalid\ statistic\ \{statistic!r\}'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00539}00539\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00540}00540\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ bins\ =\ index(bins)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00542}00542\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00543}00543\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bins\ is\ not\ an\ integer}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00544}00544\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00545}00545\ \ \ \ \ \textcolor{comment}{\#\ If\ bins\ was\ an\ integer-\/like\ object,\ now\ it\ is\ an\ actual\ Python\ int.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00546}00546\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00547}00547\ \ \ \ \ \textcolor{comment}{\#\ NOTE:\ for\ \_bin\_edges(),\ see\ e.g.\ gh-\/11365}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00548}00548\ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(bins,\ int)\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ np.isfinite(sample).all():}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00549}00549\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(f\textcolor{stringliteral}{'\{sample!r\}\ contains\ non-\/finite\ values.'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00550}00550\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00551}00551\ \ \ \ \ \textcolor{comment}{\#\ \`{}Ndim`\ is\ the\ number\ of\ dimensions\ (e.g.\ \`{}2`\ for\ \`{}binned\_statistic\_2d`)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00552}00552\ \ \ \ \ \textcolor{comment}{\#\ \`{}Dlen`\ is\ the\ length\ of\ elements\ along\ each\ dimension.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00553}00553\ \ \ \ \ \textcolor{comment}{\#\ This\ code\ is\ based\ on\ np.histogramdd}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00554}00554\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00555}00555\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}sample`\ is\ an\ ND-\/array.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00556}00556\ \ \ \ \ \ \ \ \ Dlen,\ Ndim\ =\ sample.shape}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00557}00557\ \ \ \ \ \textcolor{keywordflow}{except}\ (AttributeError,\ ValueError):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00558}00558\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}sample`\ is\ a\ sequence\ of\ 1D\ arrays.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ sample\ =\ np.atleast\_2d(sample).T}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ Dlen,\ Ndim\ =\ sample.shape}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00561}00561\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00562}00562\ \ \ \ \ \textcolor{comment}{\#\ Store\ initial\ shape\ of\ \`{}values`\ to\ preserve\ it\ in\ the\ output}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00563}00563\ \ \ \ \ values\ =\ np.asarray(values)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00564}00564\ \ \ \ \ input\_shape\ =\ list(values.shape)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00565}00565\ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ that\ \`{}values`\ is\ 2D\ to\ iterate\ over\ rows}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00566}00566\ \ \ \ \ values\ =\ np.atleast\_2d(values)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00567}00567\ \ \ \ \ Vdim,\ Vlen\ =\ values.shape}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00568}00568\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00569}00569\ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ \`{}values`\ match\ \`{}sample`}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00570}00570\ \ \ \ \ \textcolor{keywordflow}{if}\ statistic\ !=\ \textcolor{stringliteral}{'count'}\ \textcolor{keywordflow}{and}\ Vlen\ !=\ Dlen:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00571}00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classAttributeError}{AttributeError}}(\textcolor{stringliteral}{'The\ number\ of\ \`{}values`\ elements\ must\ match\ the\ '}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'length\ of\ each\ \`{}sample`\ dimension.'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00573}00573\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00574}00574\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00575}00575\ \ \ \ \ \ \ \ \ M\ =\ len(bins)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00576}00576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ M\ !=\ Ndim:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00577}00577\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classAttributeError}{AttributeError}}(\textcolor{stringliteral}{'The\ dimension\ of\ bins\ must\ be\ equal\ '}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'to\ the\ dimension\ of\ the\ sample\ x.'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00579}00579\ \ \ \ \ \textcolor{keywordflow}{except}\ TypeError:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00580}00580\ \ \ \ \ \ \ \ \ bins\ =\ Ndim\ *\ [bins]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00581}00581\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00582}00582\ \ \ \ \ \textcolor{keywordflow}{if}\ binned\_statistic\_result\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ nbin,\ edges,\ dedges\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a5f5aba885684856e29831cac609fdc4c}{\_bin\_edges}}(sample,\ bins,\ range)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00584}00584\ \ \ \ \ \ \ \ \ binnumbers\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_add91192a96b892185e2f050dd18c69f4}{\_bin\_numbers}}(sample,\ nbin,\ edges,\ dedges)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00585}00585\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ edges\ =\ binned\_statistic\_result.bin\_edges}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ nbin\ =\ np.array([len(edges[i])\ +\ 1\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(Ndim)])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ +1\ for\ outlier\ bins}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ dedges\ =\ [np.diff(edges[i])\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(Ndim)]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00590}00590\ \ \ \ \ \ \ \ \ binnumbers\ =\ binned\_statistic\_result.binnumber}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00591}00591\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00592}00592\ \ \ \ \ \textcolor{comment}{\#\ Avoid\ overflow\ with\ double\ precision.\ Complex\ \`{}values`\ -\/>\ \`{}complex128`.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00593}00593\ \ \ \ \ result\_type\ =\ np.result\_type(values,\ np.float64)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00594}00594\ \ \ \ \ result\ =\ np.empty([Vdim,\ nbin.prod()],\ dtype=result\_type)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00595}00595\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00596}00596\ \ \ \ \ \textcolor{keywordflow}{if}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'mean'},\ np.mean\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00597}00597\ \ \ \ \ \ \ \ \ result.fill(np.nan)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00598}00598\ \ \ \ \ \ \ \ \ flatcount\ =\ \_bincount(binnumbers,\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00599}00599\ \ \ \ \ \ \ \ \ a\ =\ flatcount.nonzero()}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00600}00600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ flatsum\ =\ \_bincount(binnumbers,\ values[vv])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ a]\ =\ flatsum[a]\ /\ flatcount[a]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00603}00603\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'std'},\ np.std\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ result.fill(np.nan)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00605}00605\ \ \ \ \ \ \ \ \ flatcount\ =\ \_bincount(binnumbers,\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ a\ =\ flatcount.nonzero()}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \ \ \ flatsum\ =\ \_bincount(binnumbers,\ values[vv])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ delta\ =\ values[vv]\ -\/\ flatsum[binnumbers]\ /\ flatcount[binnumbers]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ std\ =\ np.sqrt(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_bincount(binnumbers,\ delta*np.conj(delta))[a]\ /\ flatcount[a]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ a]\ =\ std}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ result\ =\ np.real(result)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00615}00615\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ ==\ \textcolor{stringliteral}{'count'}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ result\ =\ np.empty([Vdim,\ nbin.prod()],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ result.fill(0)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ flatcount\ =\ \_bincount(binnumbers,\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ a\ =\ np.arange(len(flatcount))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ result[:,\ a]\ =\ flatcount[np.newaxis,\ :]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00621}00621\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'sum'},\ np.sum\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ result.fill(0)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ \ \ \ \ flatsum\ =\ \_bincount(binnumbers,\ values[vv])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ np.arange(len(flatsum))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ a]\ =\ flatsum}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00627}00627\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'median'},\ np.median\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ result.fill(np.nan)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00629}00629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ np.lexsort((values[vv],\ binnumbers))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \_,\ j,\ counts\ =\ np.unique(binnumbers[i],}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_index=\textcolor{keyword}{True},\ return\_counts=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ mid\ =\ j\ +\ (counts\ -\/\ 1)\ /\ 2}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ mid\_a\ =\ values[vv,\ i][np.floor(mid).astype(int)]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ mid\_b\ =\ values[vv,\ i][np.ceil(mid).astype(int)]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ \ \ \ \ medians\ =\ (mid\_a\ +\ mid\_b)\ /\ 2}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ binnumbers[i][j]]\ =\ medians}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00638}00638\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'min'},\ np.min\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ result.fill(np.nan)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00640}00640\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00641}00641\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ np.argsort(values[vv])[::-\/1]\ \ \textcolor{comment}{\#\ Reversed\ so\ the\ min\ is\ last}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ binnumbers[i]]\ =\ values[vv,\ i]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00643}00643\ \ \ \ \ \textcolor{keywordflow}{elif}\ statistic\ \textcolor{keywordflow}{in}\ \{\textcolor{stringliteral}{'max'},\ np.max\}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00644}00644\ \ \ \ \ \ \ \ \ result.fill(np.nan)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00645}00645\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00646}00646\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ np.argsort(values[vv])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ binnumbers[i]]\ =\ values[vv,\ i]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00648}00648\ \ \ \ \ \textcolor{keywordflow}{elif}\ callable(statistic):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ np.errstate(invalid=\textcolor{stringliteral}{'ignore'}),\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(RuntimeWarning)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ null\ =\ statistic([])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ null\ =\ np.nan}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00655}00655\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.iscomplexobj(null):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ result.astype(np.complex128)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ result.fill(null)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \_calc\_binned\_statistic(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vdim,\ binnumbers,\ result,\ values,\ statistic}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00662}00662\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ ValueError:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00663}00663\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ result.astype(np.complex128)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ \_calc\_binned\_statistic(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vdim,\ binnumbers,\ result,\ values,\ statistic}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00666}00666\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00668}00668\ \ \ \ \ \textcolor{comment}{\#\ Shape\ into\ a\ proper\ matrix}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00669}00669\ \ \ \ \ result\ =\ result.reshape(np.append(Vdim,\ nbin))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00670}00670\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00671}00671\ \ \ \ \ \textcolor{comment}{\#\ Remove\ outliers\ (indices\ 0\ and\ -\/1\ for\ each\ bin-\/dimension).}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00672}00672\ \ \ \ \ core\ =\ tuple([slice(\textcolor{keywordtype}{None})]\ +\ Ndim\ *\ [slice(1,\ -\/1)])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00673}00673\ \ \ \ \ result\ =\ result[core]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00674}00674\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00675}00675\ \ \ \ \ \textcolor{comment}{\#\ Unravel\ binnumbers\ into\ an\ ndarray,\ each\ row\ the\ bins\ for\ each\ dimension}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00676}00676\ \ \ \ \ \textcolor{keywordflow}{if}\ expand\_binnumbers\ \textcolor{keywordflow}{and}\ Ndim\ >\ 1:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00677}00677\ \ \ \ \ \ \ \ \ binnumbers\ =\ np.asarray(np.unravel\_index(binnumbers,\ nbin))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00678}00678\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00679}00679\ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(result.shape[1:]\ !=\ nbin\ -\/\ 2):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classRuntimeError}{RuntimeError}}(\textcolor{stringliteral}{'Internal\ Shape\ Error'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00681}00681\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00682}00682\ \ \ \ \ \textcolor{comment}{\#\ Reshape\ to\ have\ output\ (`result`)\ match\ input\ (`values`)\ shape}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00683}00683\ \ \ \ \ result\ =\ result.reshape(input\_shape[:-\/1]\ +\ list(nbin-\/2))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00684}00684\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00685}00685\ \ \ \ \ \textcolor{keywordflow}{return}\ BinnedStatisticddResult(result,\ edges,\ binnumbers)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00686}00686\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00687}00687\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00688}00688\ \textcolor{keyword}{def\ }\_calc\_binned\_statistic(Vdim,\ bin\_numbers,\ result,\ values,\ stat\_func):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00689}00689\ \ \ \ \ unique\_bin\_numbers\ =\ np.unique(bin\_numbers)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00690}00690\ \ \ \ \ \textcolor{keywordflow}{for}\ vv\ \textcolor{keywordflow}{in}\ builtins.range(Vdim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00691}00691\ \ \ \ \ \ \ \ \ bin\_map\ =\ \mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a46c08bd7a9626e3c1c6a533195897c22}{\_create\_binned\_data}}(bin\_numbers,\ unique\_bin\_numbers,}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00692}00692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ values,\ vv)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00693}00693\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ unique\_bin\_numbers:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00694}00694\ \ \ \ \ \ \ \ \ \ \ \ \ stat\ =\ stat\_func(np.array(bin\_map[i]))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00695}00695\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.iscomplexobj(stat)\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ np.iscomplexobj(result):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ statistic\ function\ returns\ complex\ "{}})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00697}00697\ \ \ \ \ \ \ \ \ \ \ \ \ result[vv,\ i]\ =\ stat}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00698}00698\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00699}00699\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00700}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a46c08bd7a9626e3c1c6a533195897c22}{00700}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a46c08bd7a9626e3c1c6a533195897c22}{\_create\_binned\_data}}(bin\_numbers,\ unique\_bin\_numbers,\ values,\ vv):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00701}00701\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Create\ hashmap\ of\ bin\ ids\ to\ values\ in\ bins}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00702}00702\ \textcolor{stringliteral}{\ \ \ \ key:\ bin\ number}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00703}00703\ \textcolor{stringliteral}{\ \ \ \ value:\ list\ of\ binned\ data}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00704}00704\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00705}00705\ \ \ \ \ bin\_map\ =\ dict()}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00706}00706\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ unique\_bin\_numbers:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00707}00707\ \ \ \ \ \ \ \ \ bin\_map[i]\ =\ []}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00708}00708\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(len(bin\_numbers)):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00709}00709\ \ \ \ \ \ \ \ \ bin\_map[bin\_numbers[i]].append(values[vv,\ i])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00710}00710\ \ \ \ \ \textcolor{keywordflow}{return}\ bin\_map}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00711}00711\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00712}00712\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00713}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a5f5aba885684856e29831cac609fdc4c}{00713}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_a5f5aba885684856e29831cac609fdc4c}{\_bin\_edges}}(sample,\ bins=None,\ range=None):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00714}00714\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Create\ edge\ arrays}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00715}00715\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00716}00716\ \ \ \ \ Dlen,\ Ndim\ =\ sample.shape}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00717}00717\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00718}00718\ \ \ \ \ nbin\ =\ np.empty(Ndim,\ int)\ \ \ \ \textcolor{comment}{\#\ Number\ of\ bins\ in\ each\ dimension}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00719}00719\ \ \ \ \ edges\ =\ Ndim\ *\ [\textcolor{keywordtype}{None}]\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Bin\ edges\ for\ each\ dim\ (will\ be\ 2D\ array)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00720}00720\ \ \ \ \ dedges\ =\ Ndim\ *\ [\textcolor{keywordtype}{None}]\ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Spacing\ between\ edges\ (will\ be\ 2D\ array)}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00721}00721\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00722}00722\ \ \ \ \ \textcolor{comment}{\#\ Select\ range\ for\ each\ dimension}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00723}00723\ \ \ \ \ \textcolor{comment}{\#\ Used\ only\ if\ number\ of\ bins\ is\ given.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00724}00724\ \ \ \ \ \textcolor{keywordflow}{if}\ range\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00725}00725\ \ \ \ \ \ \ \ \ smin\ =\ np.atleast\_1d(np.array(sample.min(axis=0),\ float))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00726}00726\ \ \ \ \ \ \ \ \ smax\ =\ np.atleast\_1d(np.array(sample.max(axis=0),\ float))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00727}00727\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00728}00728\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(range)\ !=\ Ndim:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00729}00729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00730}00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}range\ given\ for\ \{len(range)\}\ dimensions;\ \{Ndim\}\ required"{}})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00731}00731\ \ \ \ \ \ \ \ \ smin\ =\ np.empty(Ndim)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00732}00732\ \ \ \ \ \ \ \ \ smax\ =\ np.empty(Ndim)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00733}00733\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(Ndim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00734}00734\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ range[i][1]\ <\ range[i][0]:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00735}00735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00736}00736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}In\ \{\}range,\ start\ must\ be\ <=\ stop"{}}.format(}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00737}00737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}dimension\ \{i\ +\ 1\}\ of\ "{}}\ \textcolor{keywordflow}{if}\ Ndim\ >\ 1\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00738}00738\ \ \ \ \ \ \ \ \ \ \ \ \ smin[i],\ smax[i]\ =\ range[i]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00739}00739\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00740}00740\ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ the\ bins\ have\ a\ finite\ width.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00741}00741\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(len(smin)):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00742}00742\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ smin[i]\ ==\ smax[i]:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00743}00743\ \ \ \ \ \ \ \ \ \ \ \ \ smin[i]\ =\ smin[i]\ -\/\ .5}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ smax[i]\ =\ smax[i]\ +\ .5}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00745}00745\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00746}00746\ \ \ \ \ \textcolor{comment}{\#\ Preserve\ sample\ floating\ point\ precision\ in\ bin\ edges}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00747}00747\ \ \ \ \ edges\_dtype\ =\ (sample.dtype\ \textcolor{keywordflow}{if}\ np.issubdtype(sample.dtype,\ np.floating)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00748}00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ float)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00749}00749\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00750}00750\ \ \ \ \ \textcolor{comment}{\#\ Create\ edge\ arrays}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00751}00751\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ builtins.range(Ndim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.isscalar(bins[i]):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00753}00753\ \ \ \ \ \ \ \ \ \ \ \ \ nbin[i]\ =\ bins[i]\ +\ 2\ \ \textcolor{comment}{\#\ +2\ for\ outlier\ bins}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00754}00754\ \ \ \ \ \ \ \ \ \ \ \ \ edges[i]\ =\ np.linspace(smin[i],\ smax[i],\ nbin[i]\ -\/\ 1,}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00755}00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=edges\_dtype)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00756}00756\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00757}00757\ \ \ \ \ \ \ \ \ \ \ \ \ edges[i]\ =\ np.asarray(bins[i],\ edges\_dtype)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00758}00758\ \ \ \ \ \ \ \ \ \ \ \ \ nbin[i]\ =\ len(edges[i])\ +\ 1\ \ \textcolor{comment}{\#\ +1\ for\ outlier\ bins}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00759}00759\ \ \ \ \ \ \ \ \ dedges[i]\ =\ np.diff(edges[i])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00760}00760\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00761}00761\ \ \ \ \ nbin\ =\ np.asarray(nbin)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00762}00762\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00763}00763\ \ \ \ \ \textcolor{keywordflow}{return}\ nbin,\ edges,\ dedges}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00764}00764\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00765}00765\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00766}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_add91192a96b892185e2f050dd18c69f4}{00766}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__binned__statistic_add91192a96b892185e2f050dd18c69f4}{\_bin\_numbers}}(sample,\ nbin,\ edges,\ dedges):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00767}00767\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ bin\ number\ each\ sample\ falls\ into,\ in\ each\ dimension}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00768}00768\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00769}00769\ \ \ \ \ Dlen,\ Ndim\ =\ sample.shape}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00770}00770\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00771}00771\ \ \ \ \ sampBin\ =\ [}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00772}00772\ \ \ \ \ \ \ \ \ np.digitize(sample[:,\ i],\ edges[i])}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00773}00773\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(Ndim)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00774}00774\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00775}00775\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00776}00776\ \ \ \ \ \textcolor{comment}{\#\ Using\ \`{}digitize`,\ values\ that\ fall\ on\ an\ edge\ are\ put\ in\ the\ right\ bin.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00777}00777\ \ \ \ \ \textcolor{comment}{\#\ For\ the\ rightmost\ bin,\ we\ want\ values\ equal\ to\ the\ right}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00778}00778\ \ \ \ \ \textcolor{comment}{\#\ edge\ to\ be\ counted\ in\ the\ last\ bin,\ and\ not\ as\ an\ outlier.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00779}00779\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(Ndim):}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00780}00780\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ the\ rounding\ precision}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00781}00781\ \ \ \ \ \ \ \ \ dedges\_min\ =\ dedges[i].min()}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00782}00782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dedges\_min\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00783}00783\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'The\ smallest\ edge\ difference\ is\ numerically\ 0.'})}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00784}00784\ \ \ \ \ \ \ \ \ decimal\ =\ int(-\/np.log10(dedges\_min))\ +\ 6}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00785}00785\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ which\ points\ are\ on\ the\ rightmost\ edge.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00786}00786\ \ \ \ \ \ \ \ \ on\_edge\ =\ np.where((sample[:,\ i]\ >=\ edges[i][-\/1])\ \&}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00787}00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.around(sample[:,\ i],\ decimal)\ ==}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00788}00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.around(edges[i][-\/1],\ decimal)))[0]}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00789}00789\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Shift\ these\ points\ one\ bin\ to\ the\ left.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00790}00790\ \ \ \ \ \ \ \ \ sampBin[i][on\_edge]\ -\/=\ 1}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00791}00791\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00792}00792\ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ sample\ indices\ in\ the\ flattened\ statistic\ matrix.}}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00793}00793\ \ \ \ \ binnumbers\ =\ np.ravel\_multi\_index(sampBin,\ nbin)}
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00794}00794\ }
\DoxyCodeLine{\Hypertarget{__binned__statistic_8py_source_l00795}00795\ \ \ \ \ \textcolor{keywordflow}{return}\ binnumbers}

\end{DoxyCode}
