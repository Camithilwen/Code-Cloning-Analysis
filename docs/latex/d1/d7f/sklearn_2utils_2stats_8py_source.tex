\doxysection{stats.\+py}
\hypertarget{sklearn_2utils_2stats_8py_source}{}\label{sklearn_2utils_2stats_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/utils/stats.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/utils/stats.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1utils_1_1stats}{00001}}\ \textcolor{comment}{\#\ Authors:\ The\ scikit-\/learn\ developers}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00002}00002\ \textcolor{comment}{\#\ SPDX-\/License-\/Identifier:\ BSD-\/3-\/Clause}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00004}00004\ \textcolor{keyword}{from}\ ..utils.\_array\_api\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00005}00005\ \ \ \ \ \_find\_matching\_floating\_dtype,}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00006}00006\ \ \ \ \ get\_namespace\_and\_device,}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00007}00007\ )}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00010}\mbox{\hyperlink{namespacesklearn_1_1utils_1_1stats_af65a4d3d510b1c6851098b756fd4cf75}{00010}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1utils_1_1stats_af65a4d3d510b1c6851098b756fd4cf75}{\_weighted\_percentile}}(array,\ sample\_weight,\ percentile\_rank=50,\ xp=None):}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00011}00011\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ weighted\ percentile\ with\ method\ 'inverted\_cdf'.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00012}00012\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ When\ the\ percentile\ lies\ between\ two\ data\ points\ of\ \`{}array\`{},\ the\ function\ returns}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ the\ lower\ value.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00015}00015\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}array\`{}\ is\ a\ 2D\ array,\ the\ \`{}values\`{}\ are\ selected\ along\ axis\ 0.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00017}00017\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ \`{}NaN\`{}\ values\ are\ ignored\ by\ setting\ their\ weights\ to\ 0.\ If\ \`{}array\`{}\ is\ 2D,\ this}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ is\ done\ in\ a\ column-\/isolated\ manner:\ a\ \`{}NaN\`{}\ in\ the\ second\ column,\ does\ not\ impact}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ the\ percentile\ computed\ for\ the\ first\ column\ even\ if\ \`{}sample\_weight\`{}\ is\ 1D.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00021}00021\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionchanged::\ 0.24}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Accepts\ 2D\ \`{}array\`{}.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00024}00024\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionchanged::\ 1.7}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Supports\ handling\ of\ \`{}NaN\`{}\ values.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00027}00027\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ array\ :\ 1D\ or\ 2D\ array}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Values\ to\ take\ the\ weighted\ percentile\ of.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00032}00032\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ sample\_weight:\ 1D\ or\ 2D\ array}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Weights\ for\ each\ value\ in\ \`{}array\`{}.\ Must\ be\ same\ shape\ as\ \`{}array\`{}\ or\ of\ shape}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}(array.shape[0],)\`{}.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00036}00036\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ percentile\_rank:\ int\ or\ float,\ default=50}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ probability\ level\ of\ the\ percentile\ to\ compute,\ in\ percent.\ Must\ be\ between}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 0\ and\ 100.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00040}00040\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ xp\ :\ array\_namespace,\ default=None}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ standard-\/compatible\ namespace\ for\ \`{}array\`{}.\ Default:\ infer.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00043}00043\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ percentile\ :\ scalar\ or\ 0D\ array\ if\ \`{}array\`{}\ 1D\ (or\ 0D),\ array\ if\ \`{}array\`{}\ 2D}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Weighted\ percentile\ at\ the\ requested\ probability\ level.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00049}00049\ \ \ \ \ xp,\ \_,\ device\ =\ get\_namespace\_and\_device(array)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00050}00050\ \ \ \ \ \textcolor{comment}{\#\ \`{}sample\_weight`\ should\ follow\ \`{}array`\ for\ dtypes}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00051}00051\ \ \ \ \ floating\_dtype\ =\ \_find\_matching\_floating\_dtype(array,\ xp=xp)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00052}00052\ \ \ \ \ array\ =\ xp.asarray(array,\ dtype=floating\_dtype,\ device=device)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00053}00053\ \ \ \ \ sample\_weight\ =\ xp.asarray(sample\_weight,\ dtype=floating\_dtype,\ device=device)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00055}00055\ \ \ \ \ n\_dim\ =\ array.ndim}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00056}00056\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_dim\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ array}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00058}00058\ \ \ \ \ \textcolor{keywordflow}{if}\ array.ndim\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ array\ =\ xp.reshape(array,\ (-\/1,\ 1))}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00060}00060\ \ \ \ \ \textcolor{comment}{\#\ When\ sample\_weight\ 1D,\ repeat\ for\ each\ array.shape[1]}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{if}\ array.shape\ !=\ sample\_weight.shape\ \textcolor{keywordflow}{and}\ array.shape[0]\ ==\ sample\_weight.shape[0]:}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ sample\_weight\ =\ xp.tile(sample\_weight,\ (array.shape[1],\ 1)).T}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00063}00063\ \ \ \ \ \textcolor{comment}{\#\ Sort\ \`{}array`\ and\ \`{}sample\_weight`\ along\ axis=0:}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00064}00064\ \ \ \ \ sorted\_idx\ =\ xp.argsort(array,\ axis=0)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00065}00065\ \ \ \ \ sorted\_weights\ =\ xp.take\_along\_axis(sample\_weight,\ sorted\_idx,\ axis=0)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00067}00067\ \ \ \ \ \textcolor{comment}{\#\ Set\ NaN\ values\ in\ \`{}sample\_weight`\ to\ 0.\ Only\ perform\ this\ operation\ if\ NaN}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00068}00068\ \ \ \ \ \textcolor{comment}{\#\ values\ present\ to\ avoid\ temporary\ allocations\ of\ size\ \`{}(n\_samples,\ n\_features)`.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00069}00069\ \ \ \ \ n\_features\ =\ array.shape[1]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00070}00070\ \ \ \ \ largest\_value\_per\_column\ =\ array[}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ sorted\_idx[-\/1,\ ...],\ xp.arange(n\_features,\ device=device)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00072}00072\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00073}00073\ \ \ \ \ \textcolor{comment}{\#\ NaN\ values\ get\ sorted\ to\ end\ (largest\ value)}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00074}00074\ \ \ \ \ \textcolor{keywordflow}{if}\ xp.any(xp.isnan(largest\_value\_per\_column)):}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ sorted\_nan\_mask\ =\ xp.take\_along\_axis(xp.isnan(array),\ sorted\_idx,\ axis=0)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ sorted\_weights[sorted\_nan\_mask]\ =\ 0}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00078}00078\ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ weighted\ cumulative\ distribution\ function\ (CDF)\ based\ on}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00079}00079\ \ \ \ \ \textcolor{comment}{\#\ \`{}sample\_weight`\ and\ scale\ \`{}percentile\_rank`\ along\ it.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00080}00080\ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00081}00081\ \ \ \ \ \textcolor{comment}{\#\ Note:\ we\ call\ \`{}xp.cumulative\_sum`\ on\ the\ transposed\ \`{}sorted\_weights`\ to}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00082}00082\ \ \ \ \ \textcolor{comment}{\#\ ensure\ that\ the\ result\ is\ of\ shape\ \`{}(n\_features,\ n\_samples)`\ so}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00083}00083\ \ \ \ \ \textcolor{comment}{\#\ \`{}xp.searchsorted`\ calls\ take\ contiguous\ inputs\ as\ a\ result\ (for}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00084}00084\ \ \ \ \ \textcolor{comment}{\#\ performance\ reasons).}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00085}00085\ \ \ \ \ weight\_cdf\ =\ xp.cumulative\_sum(sorted\_weights.T,\ axis=1)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00086}00086\ \ \ \ \ adjusted\_percentile\_rank\ =\ percentile\_rank\ /\ 100\ *\ weight\_cdf[...,\ -\/1]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00088}00088\ \ \ \ \ \textcolor{comment}{\#\ Ignore\ leading\ \`{}sample\_weight=0`\ observations\ when\ \`{}percentile\_rank=0`\ (\#20528)}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00089}00089\ \ \ \ \ mask\ =\ adjusted\_percentile\_rank\ ==\ 0}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00090}00090\ \ \ \ \ adjusted\_percentile\_rank[mask]\ =\ xp.nextafter(}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ adjusted\_percentile\_rank[mask],\ adjusted\_percentile\_rank[mask]\ +\ 1}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00092}00092\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00093}00093\ \ \ \ \ \textcolor{comment}{\#\ For\ each\ feature\ with\ index\ j,\ find\ sample\ index\ i\ of\ the\ scalar\ value}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00094}00094\ \ \ \ \ \textcolor{comment}{\#\ \`{}adjusted\_percentile\_rank[j]`\ in\ 1D\ array\ \`{}weight\_cdf[j]`,\ such\ that:}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00095}00095\ \ \ \ \ \textcolor{comment}{\#\ weight\_cdf[j,\ i-\/1]\ <\ adjusted\_percentile\_rank[j]\ <=\ weight\_cdf[j,\ i].}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00096}00096\ \ \ \ \ percentile\_indices\ =\ xp.stack(}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ xp.searchsorted(}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weight\_cdf[feature\_idx,\ ...],\ adjusted\_percentile\_rank[feature\_idx]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ feature\_idx\ \textcolor{keywordflow}{in}\ range(weight\_cdf.shape[0])}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00103}00103\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00104}00104\ \ \ \ \ \textcolor{comment}{\#\ In\ rare\ cases,\ \`{}percentile\_indices`\ equals\ to\ \`{}sorted\_idx.shape[0]`}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00105}00105\ \ \ \ \ max\_idx\ =\ sorted\_idx.shape[0]\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00106}00106\ \ \ \ \ percentile\_indices\ =\ xp.clip(percentile\_indices,\ 0,\ max\_idx)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00108}00108\ \ \ \ \ col\_indices\ =\ xp.arange(array.shape[1],\ device=device)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00109}00109\ \ \ \ \ percentile\_in\_sorted\ =\ sorted\_idx[percentile\_indices,\ col\_indices]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00111}00111\ \ \ \ \ result\ =\ array[percentile\_in\_sorted,\ col\_indices]}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00113}00113\ \ \ \ \ \textcolor{keywordflow}{return}\ result[0]\ \textcolor{keywordflow}{if}\ n\_dim\ ==\ 1\ \textcolor{keywordflow}{else}\ result}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00116}00116\ \textcolor{comment}{\#\ TODO:\ refactor\ to\ do\ the\ symmetrisation\ inside\ \_weighted\_percentile\ to\ avoid}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00117}00117\ \textcolor{comment}{\#\ sorting\ the\ input\ array\ twice.}}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00118}00118\ \textcolor{keyword}{def\ }\_averaged\_weighted\_percentile(array,\ sample\_weight,\ percentile\_rank=50,\ xp=None):}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00119}00119\ \ \ \ \ \textcolor{keywordflow}{return}\ (}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1stats_af65a4d3d510b1c6851098b756fd4cf75}{\_weighted\_percentile}}(array,\ sample\_weight,\ percentile\_rank,\ xp=xp)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ -\/\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1stats_af65a4d3d510b1c6851098b756fd4cf75}{\_weighted\_percentile}}(-\/array,\ sample\_weight,\ 100\ -\/\ percentile\_rank,\ xp=xp)}
\DoxyCodeLine{\Hypertarget{sklearn_2utils_2stats_8py_source_l00122}00122\ \ \ \ \ )\ /\ 2}

\end{DoxyCode}
