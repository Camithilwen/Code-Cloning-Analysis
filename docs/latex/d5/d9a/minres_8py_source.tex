\doxysection{minres.\+py}
\hypertarget{minres_8py_source}{}\label{minres_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/sparse/linalg/\_isolve/minres.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/sparse/linalg/\_isolve/minres.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1minres}{00001}}\ \textcolor{keyword}{from}\ numpy\ \textcolor{keyword}{import}\ inner,\ zeros,\ inf,\ finfo}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00002}00002\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1linalg}{numpy.linalg}}\ \textcolor{keyword}{import}\ norm}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00003}00003\ \textcolor{keyword}{from}\ math\ \textcolor{keyword}{import}\ sqrt}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00005}00005\ \textcolor{keyword}{from}\ .utils\ \textcolor{keyword}{import}\ make\_system}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00007}00007\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'minres'}]}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00010}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1minres_a8b62c2ba1cf2568c9c34dfda3e83245f}{00010}}\ \textcolor{keyword}{def\ }minres(A,\ b,\ x0=None,\ shift=0.0,\ tol=1e-\/5,\ maxiter=None,}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00011}00011\ \ \ \ \ \ \ \ \ \ \ \ M=None,\ callback=None,\ show=False,\ check=False):}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00012}00012\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ Use\ MINimum\ RESidual\ iteration\ to\ solve\ Ax=b}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00014}00014\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ MINRES\ minimizes\ norm(Ax\ -\/\ b)\ for\ a\ real\ symmetric\ matrix\ A.\ \ Unlike}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ the\ Conjugate\ Gradient\ method,\ A\ can\ be\ indefinite\ or\ singular.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00017}00017\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ If\ shift\ !=\ 0\ then\ the\ method\ solves\ (A\ -\/\ shift*I)x\ =\ b}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00019}00019\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ A\ :\ \{sparse\ matrix,\ ndarray,\ LinearOperator\}}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ real\ symmetric\ N-\/by-\/N\ matrix\ of\ the\ linear\ system}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Alternatively,\ \`{}\`{}A\`{}\`{}\ can\ be\ a\ linear\ operator\ which\ can}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ produce\ \`{}\`{}Ax\`{}\`{}\ using,\ e.g.,}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}scipy.sparse.linalg.LinearOperator\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ b\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right\ hand\ side\ of\ the\ linear\ system.\ Has\ shape\ (N,)\ or\ (N,1).}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00029}00029\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ x\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ converged\ solution.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ info\ :\ integer}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Provides\ convergence\ information:}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 0\ \ :\ successful\ exit}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ >0\ :\ convergence\ to\ tolerance\ not\ achieved,\ number\ of\ iterations}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ <0\ :\ illegal\ input\ or\ breakdown}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00039}00039\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ Other\ Parameters}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ x0\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Starting\ guess\ for\ the\ solution.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ shift\ :\ float}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Value\ to\ apply\ to\ the\ system\ \`{}\`{}(A\ -\/\ shift\ *\ I)x\ =\ b\`{}\`{}.\ Default\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ tol\ :\ float}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Tolerance\ to\ achieve.\ The\ algorithm\ terminates\ when\ the\ relative}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00048}00048\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ residual\ is\ below\ \`{}tol\`{}.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ maxiter\ :\ integer}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations.\ \ Iteration\ will\ stop\ after\ maxiter}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ steps\ even\ if\ the\ specified\ tolerance\ has\ not\ been\ achieved.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ M\ :\ \{sparse\ matrix,\ ndarray,\ LinearOperator\}}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Preconditioner\ for\ A.\ \ The\ preconditioner\ should\ approximate\ the}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ inverse\ of\ A.\ \ Effective\ preconditioning\ dramatically\ improves\ the}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ rate\ of\ convergence,\ which\ implies\ that\ fewer\ iterations\ are\ needed}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ reach\ a\ given\ error\ tolerance.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ callback\ :\ function}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ User-\/supplied\ function\ to\ call\ after\ each\ iteration.\ \ It\ is\ called}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ as\ callback(xk),\ where\ xk\ is\ the\ current\ solution\ vector.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ show\ :\ bool}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}True\`{}\`{},\ print\ out\ a\ summary\ and\ metrics\ related\ to\ the\ solution}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ during\ iterations.\ Default\ is\ \`{}\`{}False\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ check\ :\ bool}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}True\`{}\`{},\ run\ additional\ input\ validation\ to\ check\ that\ \`{}A\`{}\ and}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}M\`{}\ (if\ specified)\ are\ symmetric.\ Default\ is\ \`{}\`{}False\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00066}00066\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.sparse\ import\ csc\_matrix}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.sparse.linalg\ import\ minres}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ >>>\ A\ =\ csc\_matrix([[3,\ 2,\ 0],\ [1,\ -\/1,\ 0],\ [0,\ 5,\ 1]],\ dtype=float)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ >>>\ A\ =\ A\ +\ A.T}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ >>>\ b\ =\ np.array([2,\ 4,\ -\/1],\ dtype=float)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ >>>\ x,\ exitCode\ =\ minres(A,\ b)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(exitCode)\ \ \ \ \ \ \ \ \ \ \ \ \#\ 0\ indicates\ successful\ convergence}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ 0}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ >>>\ np.allclose(A.dot(x),\ b)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00080}00080\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ Solution\ of\ sparse\ indefinite\ systems\ of\ linear\ equations,}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ C.\ C.\ Paige\ and\ M.\ A.\ Saunders\ (1975),}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ SIAM\ J.\ Numer.\ Anal.\ 12(4),\ pp.\ 617-\/629.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://web.stanford.edu/group/SOL/software/minres/}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00087}00087\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ This\ file\ is\ a\ translation\ of\ the\ following\ MATLAB\ implementation:}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ https://web.stanford.edu/group/SOL/software/minres/minres-\/matlab.zip}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00090}00090\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00092}00092\ \ \ \ \ A,\ M,\ x,\ b,\ postprocess\ =\ make\_system(A,\ M,\ x0,\ b)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00094}00094\ \ \ \ \ matvec\ =\ A.matvec}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00095}00095\ \ \ \ \ psolve\ =\ M.matvec}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00097}00097\ \ \ \ \ first\ =\ \textcolor{stringliteral}{'Enter\ minres.\ \ \ '}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00098}00098\ \ \ \ \ last\ =\ \textcolor{stringliteral}{'Exit\ \ minres.\ \ \ '}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00100}00100\ \ \ \ \ n\ =\ A.shape[0]}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00102}00102\ \ \ \ \ \textcolor{keywordflow}{if}\ maxiter\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ maxiter\ =\ 5\ *\ n}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00105}00105\ \ \ \ \ msg\ =\ [\textcolor{stringliteral}{'\ beta2\ =\ 0.\ \ If\ M\ =\ I,\ b\ and\ x\ are\ eigenvectors\ \ \ \ '},\ \ \ \textcolor{comment}{\#\ -\/1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ beta1\ =\ 0.\ \ The\ exact\ solution\ is\ x0\ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 0}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ A\ solution\ to\ Ax\ =\ b\ was\ found,\ given\ rtol\ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ A\ least-\/squares\ solution\ was\ found,\ given\ rtol\ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 2}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ Reasonable\ accuracy\ achieved,\ given\ eps\ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 3}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ x\ has\ converged\ to\ an\ eigenvector\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 4}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ acond\ has\ exceeded\ 0.1/eps\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 5}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ The\ iteration\ limit\ was\ reached\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 6}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ A\ \ does\ not\ define\ a\ symmetric\ matrix\ \ \ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 7}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ M\ \ does\ not\ define\ a\ symmetric\ matrix\ \ \ \ \ \ \ \ \ \ \ \ \ '},\ \ \ \textcolor{comment}{\#\ 8}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ M\ \ does\ not\ define\ a\ pos-\/def\ preconditioner\ \ \ \ \ \ \ '}]\ \ \ \textcolor{comment}{\#\ 9}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00117}00117\ \ \ \ \ \textcolor{keywordflow}{if}\ show:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ print(first\ +\ \textcolor{stringliteral}{'Solution\ of\ symmetric\ Ax\ =\ b'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ print(first\ +\ f\textcolor{stringliteral}{'n\ \ \ \ \ \ =\ \ \{n:3g\}\ \ \ \ \ shift\ \ =\ \ \{shift:23.14e\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ print(first\ +\ f\textcolor{stringliteral}{'itnlim\ =\ \ \{maxiter:3g\}\ \ \ \ \ rtol\ \ \ =\ \ \{tol:11.2e\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00123}00123\ \ \ \ \ istop\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00124}00124\ \ \ \ \ itn\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00125}00125\ \ \ \ \ Anorm\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00126}00126\ \ \ \ \ Acond\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00127}00127\ \ \ \ \ rnorm\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00128}00128\ \ \ \ \ ynorm\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00130}00130\ \ \ \ \ xtype\ =\ x.dtype}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00132}00132\ \ \ \ \ eps\ =\ \mbox{\hyperlink{classnumpy_1_1core_1_1getlimits_1_1finfo}{finfo}}(xtype).eps}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00134}00134\ \ \ \ \ \textcolor{comment}{\#\ Set\ up\ y\ and\ v\ for\ the\ first\ Lanczos\ vector\ v1.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00135}00135\ \ \ \ \ \textcolor{comment}{\#\ y\ \ =\ \ beta1\ P'\ v1,\ \ where\ \ P\ =\ C**(-\/1).}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00136}00136\ \ \ \ \ \textcolor{comment}{\#\ v\ is\ really\ P'\ v1.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00138}00138\ \ \ \ \ \textcolor{keywordflow}{if}\ x0\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ r1\ =\ b.copy()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00140}00140\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ r1\ =\ b\ -\/\ A\textcolor{preprocessor}{@x}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00142}00142\ \ \ \ \ y\ =\ psolve(r1)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00144}00144\ \ \ \ \ beta1\ =\ inner(r1,\ y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00146}00146\ \ \ \ \ \textcolor{keywordflow}{if}\ beta1\ <\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'indefinite\ preconditioner'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00148}00148\ \ \ \ \ \textcolor{keywordflow}{elif}\ beta1\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (postprocess(x),\ 0)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00151}00151\ \ \ \ \ bnorm\ =\ norm(b)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00152}00152\ \ \ \ \ \textcolor{keywordflow}{if}\ bnorm\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ x\ =\ b}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (postprocess(x),\ 0)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00156}00156\ \ \ \ \ beta1\ =\ sqrt(beta1)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00158}00158\ \ \ \ \ \textcolor{keywordflow}{if}\ check:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ are\ these\ too\ strict?}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ see\ if\ A\ is\ symmetric}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ w\ =\ matvec(y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ r2\ =\ matvec(w)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ s\ =\ inner(w,w)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ t\ =\ inner(y,r2)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ z\ =\ abs(s\ -\/\ t)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ epsa\ =\ (s\ +\ eps)\ *\ eps**(1.0/3.0)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ z\ >\ epsa:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'non-\/symmetric\ matrix'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ see\ if\ M\ is\ symmetric}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ r2\ =\ psolve(y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ s\ =\ inner(y,y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ t\ =\ inner(r1,r2)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ z\ =\ abs(s\ -\/\ t)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ epsa\ =\ (s\ +\ eps)\ *\ eps**(1.0/3.0)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ z\ >\ epsa:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'non-\/symmetric\ preconditioner'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00180}00180\ \ \ \ \ \textcolor{comment}{\#\ Initialize\ other\ quantities}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00181}00181\ \ \ \ \ oldb\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00182}00182\ \ \ \ \ beta\ =\ beta1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00183}00183\ \ \ \ \ dbar\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00184}00184\ \ \ \ \ epsln\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00185}00185\ \ \ \ \ qrnorm\ =\ beta1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00186}00186\ \ \ \ \ phibar\ =\ beta1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00187}00187\ \ \ \ \ rhs1\ =\ beta1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00188}00188\ \ \ \ \ rhs2\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00189}00189\ \ \ \ \ tnorm2\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00190}00190\ \ \ \ \ gmax\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00191}00191\ \ \ \ \ gmin\ =\ \mbox{\hyperlink{classnumpy_1_1core_1_1getlimits_1_1finfo}{finfo}}(xtype).max}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00192}00192\ \ \ \ \ cs\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00193}00193\ \ \ \ \ sn\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00194}00194\ \ \ \ \ w\ =\ zeros(n,\ dtype=xtype)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00195}00195\ \ \ \ \ w2\ =\ zeros(n,\ dtype=xtype)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00196}00196\ \ \ \ \ r2\ =\ r1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00198}00198\ \ \ \ \ \textcolor{keywordflow}{if}\ show:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{'\ \ \ Itn\ \ \ \ \ x(1)\ \ \ \ \ Compatible\ \ \ \ LS\ \ \ \ \ \ \ norm(A)\ \ cond(A)\ gbar/|A|'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00202}00202\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00203}00203\ \ \ \ \ \textcolor{keywordflow}{while}\ itn\ <\ maxiter:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ itn\ +=\ 1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00206}00206\ \ \ \ \ \ \ \ \ s\ =\ 1.0/beta}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ v\ =\ s*y}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ y\ =\ matvec(v)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00210}00210\ \ \ \ \ \ \ \ \ y\ =\ y\ -\/\ shift\ *\ v}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ >=\ 2:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ y\ =\ y\ -\/\ (beta/oldb)*r1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ alfa\ =\ inner(v,y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ y\ =\ y\ -\/\ (alfa/beta)*r2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ r1\ =\ r2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ r2\ =\ y}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ y\ =\ psolve(r2)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ oldb\ =\ beta}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ beta\ =\ inner(r2,y)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ beta\ <\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'non-\/symmetric\ matrix'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ beta\ =\ sqrt(beta)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ tnorm2\ +=\ alfa**2\ +\ oldb**2\ +\ beta**2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ beta/beta1\ <=\ 10*eps:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ -\/1\ \ \textcolor{comment}{\#\ Terminate\ later}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Apply\ previous\ rotation\ Qk-\/1\ to\ get}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ [deltak\ epslnk+1]\ =\ [cs\ \ sn][dbark\ \ \ \ 0\ \ \ ]}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ [gbar\ k\ dbar\ k+1]\ \ \ [sn\ -\/cs][alfak\ betak+1].}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ oldeps\ =\ epsln}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ delta\ =\ cs\ *\ dbar\ +\ sn\ *\ alfa\ \ \ \textcolor{comment}{\#\ delta1\ =\ 0\ \ \ \ \ \ \ \ \ deltak}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ gbar\ =\ sn\ *\ dbar\ -\/\ cs\ *\ alfa\ \ \ \textcolor{comment}{\#\ gbar\ 1\ =\ alfa1\ \ \ \ \ gbar\ k}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ epsln\ =\ sn\ *\ beta\ \ \ \ \ \textcolor{comment}{\#\ epsln2\ =\ 0\ \ \ \ \ \ \ \ \ epslnk+1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ dbar\ =\ -\/\ cs\ *\ beta\ \ \ \textcolor{comment}{\#\ dbar\ 2\ =\ beta2\ \ \ \ \ dbar\ k+1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ root\ =\ norm([gbar,\ dbar])}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ Arnorm\ =\ phibar\ *\ root}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00242}00242\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ next\ plane\ rotation\ Qk}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ gamma\ =\ norm([gbar,\ beta])\ \ \ \ \ \ \ \textcolor{comment}{\#\ gammak}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ gamma\ =\ max(gamma,\ eps)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ cs\ =\ gbar\ /\ gamma\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ck}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ sn\ =\ beta\ /\ gamma\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sk}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ phi\ =\ cs\ *\ phibar\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ phik}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ phibar\ =\ sn\ *\ phibar\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ phibark+1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00251}00251\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ \ x.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ denom\ =\ 1.0/gamma}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ w1\ =\ w2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ w2\ =\ w}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ w\ =\ (v\ -\/\ oldeps*w1\ -\/\ delta*w2)\ *\ denom}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ x\ =\ x\ +\ phi*w}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00259}00259\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Go\ round\ again.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ gmax\ =\ max(gmax,\ gamma)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ gmin\ =\ min(gmin,\ gamma)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ z\ =\ rhs1\ /\ gamma}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ rhs1\ =\ rhs2\ -\/\ delta*z}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ rhs2\ =\ -\/\ epsln*z}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00267}00267\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Estimate\ various\ norms\ and\ test\ for\ convergence.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ Anorm\ =\ sqrt(tnorm2)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ ynorm\ =\ norm(x)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ epsa\ =\ Anorm\ *\ eps}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ epsx\ =\ Anorm\ *\ ynorm\ *\ eps}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ epsr\ =\ Anorm\ *\ ynorm\ *\ tol}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ diag\ =\ gbar}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ diag\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ diag\ =\ epsa}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ qrnorm\ =\ phibar}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00281}00281\ \ \ \ \ \ \ \ \ rnorm\ =\ qrnorm}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ynorm\ ==\ 0\ \textcolor{keywordflow}{or}\ Anorm\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ test1\ =\ inf}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ test1\ =\ rnorm\ /\ (Anorm*ynorm)\ \ \ \ \textcolor{comment}{\#\ ||r||\ \ /\ (||A||\ ||x||)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ Anorm\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ test2\ =\ inf}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ test2\ =\ root\ /\ Anorm\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ ||Ar||\ /\ (||A||\ ||r||)}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Estimate\ \ cond(A).}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ this\ version\ we\ look\ at\ the\ diagonals\ of\ \ R\ \ in\ the}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ factorization\ of\ the\ lower\ Hessenberg\ matrix,\ \ Q\ @\ H\ =\ R,}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ where\ H\ is\ the\ tridiagonal\ matrix\ from\ Lanczos\ with\ one}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ extra\ row,\ beta(k+1)\ e\_k\string^T.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ Acond\ =\ gmax/gmin}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00298}00298\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ if\ any\ of\ the\ stopping\ criteria\ are\ satisfied.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ rare\ cases,\ istop\ is\ already\ -\/1\ from\ above\ (Abar\ =\ const*I).}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ istop\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ t1\ =\ 1\ +\ test1\ \ \ \ \ \ \textcolor{comment}{\#\ These\ tests\ work\ if\ tol\ <\ eps}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ t2\ =\ 1\ +\ test2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t2\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ t1\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ >=\ maxiter:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 6}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ Acond\ >=\ 0.1/eps:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 4}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ epsx\ >=\ beta1:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 3}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ rnorm\ <=\ epsx\ \ \ :\ istop\ =\ 2}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ rnorm\ <=\ epsr\ \ \ :\ istop\ =\ 1}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ test2\ <=\ tol:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 2}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ test1\ <=\ tol:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ istop\ =\ 1}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00323}00323\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See\ if\ it\ is\ time\ to\ print\ something.}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00324}00324\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ n\ <=\ 40:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ <=\ 10:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ >=\ maxiter-\/10:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ \%\ 10\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ qrnorm\ <=\ 10*epsx:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ qrnorm\ <=\ 10*epsr:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ Acond\ <=\ 1e-\/2/eps:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ istop\ !=\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ prnt\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00342}00342\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ show\ \textcolor{keywordflow}{and}\ prnt:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ str1\ =\ f\textcolor{stringliteral}{'\{itn:6g\}\ \{x[0]:12.5e\}\ \{test1:10.3e\}'}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ str2\ =\ f\textcolor{stringliteral}{'\ \{test2:10.3e\}'}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ str3\ =\ f\textcolor{stringliteral}{'\ \{Anorm:8.1e\}\ \{Acond:8.1e\}\ \{gbar/Anorm:8.1e\}'}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00347}00347\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ print(str1\ +\ str2\ +\ str3)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ itn\ \%\ 10\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00352}00352\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ callback\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ callback(x)}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00355}00355\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ istop\ !=\ 0:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}\ \ \textcolor{comment}{\#\ TODO\ check\ this}}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00359}00359\ \ \ \ \ \textcolor{keywordflow}{if}\ show:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ print()}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ print(last\ +\ f\textcolor{stringliteral}{'\ istop\ \ \ =\ \ \{istop:3g\}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ itn\ \ \ =\{itn:5g\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ print(last\ +\ f\textcolor{stringliteral}{'\ Anorm\ \ \ =\ \ \{Anorm:12.4e\}\ \ \ \ \ \ Acond\ =\ \ \{Acond:12.4e\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00363}00363\ \ \ \ \ \ \ \ \ print(last\ +\ f\textcolor{stringliteral}{'\ rnorm\ \ \ =\ \ \{rnorm:12.4e\}\ \ \ \ \ \ ynorm\ =\ \ \{ynorm:12.4e\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ print(last\ +\ f\textcolor{stringliteral}{'\ Arnorm\ \ =\ \ \{Arnorm:12.4e\}'})}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ print(last\ +\ msg[istop+1])}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00367}00367\ \ \ \ \ \textcolor{keywordflow}{if}\ istop\ ==\ 6:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ info\ =\ maxiter}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00369}00369\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ info\ =\ 0}
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{minres_8py_source_l00372}00372\ \ \ \ \ \textcolor{keywordflow}{return}\ (postprocess(x),info)}

\end{DoxyCode}
