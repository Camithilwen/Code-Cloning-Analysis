\doxysection{test\+\_\+polynomial.\+py}
\hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source}{}\label{numpy_2lib_2tests_2test__polynomial_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/numpy/lib/tests/test\_polynomial.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/numpy/lib/tests/test\_polynomial.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00001}\mbox{\hyperlink{namespacenumpy_1_1lib_1_1tests_1_1test__polynomial}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00002}00002\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00003}00003\ \ \ \ \ assert\_,\ assert\_equal,\ assert\_array\_equal,\ assert\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00004}00004\ \ \ \ \ assert\_array\_almost\_equal,\ assert\_raises,\ assert\_allclose}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00005}00005\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00007}00007\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00009}00009\ \textcolor{comment}{\#\ \`{}poly1d`\ has\ some\ support\ for\ \`{}bool\_`\ and\ \`{}timedelta64`,}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00010}00010\ \textcolor{comment}{\#\ but\ it\ is\ limited\ and\ they\ are\ therefore\ excluded\ here}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00011}00011\ TYPE\_CODES\ =\ np.typecodes[\textcolor{stringliteral}{"{}AllInteger"{}}]\ +\ np.typecodes[\textcolor{stringliteral}{"{}AllFloat"{}}]\ +\ \textcolor{stringliteral}{"{}O"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00014}\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial}{00014}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial}{TestPolynomial}}:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00015}00015\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly1d\_str\_and\_repr(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1.,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ assert\_equal(repr(p),\ \textcolor{stringliteral}{'poly1d([1.,\ 2.,\ 3.])'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ assert\_equal(str(p),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'1\ x\ +\ 2\ x\ +\ 3'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([3.,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ assert\_equal(repr(q),\ \textcolor{stringliteral}{'poly1d([3.,\ 2.,\ 1.])'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ assert\_equal(str(q),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'3\ x\ +\ 2\ x\ +\ 1'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ r\ =\ np.poly1d([1.89999\ +\ 2j,\ -\/3j,\ -\/5.12345678,\ 2\ +\ 1j])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ assert\_equal(str(r),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ \ \ \ \ \ \ \ \ \ 3\ \ \ \ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'(1.9\ +\ 2j)\ x\ -\/\ 3j\ x\ -\/\ 5.123\ x\ +\ (2\ +\ 1j)'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ assert\_equal(str(np.poly1d([-\/3,\ -\/2,\ -\/1])),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'-\/3\ x\ -\/\ 2\ x\ -\/\ 1'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00037}00037\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly1d\_resolution(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1.,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([3.,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ assert\_equal(p(0),\ 3.0)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ assert\_equal(p(5),\ 38.0)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ assert\_equal(q(0),\ 1.0)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ assert\_equal(q(5),\ 86.0)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00045}00045\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly1d\_math(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ here\ we\ use\ some\ simple\ coeffs\ to\ make\ calculations\ easier}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1.,\ 2,\ 4])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([4.,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ assert\_equal(p/q,\ (np.poly1d([0.25]),\ np.poly1d([1.5,\ 3.75])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ assert\_equal(p.integ(),\ np.poly1d([1/3,\ 1.,\ 4.,\ 0.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ assert\_equal(p.integ(1),\ np.poly1d([1/3,\ 1.,\ 4.,\ 0.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1.,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([3.,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ assert\_equal(p\ *\ q,\ np.poly1d([3.,\ 8.,\ 14.,\ 8.,\ 3.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ assert\_equal(p\ +\ q,\ np.poly1d([4.,\ 4.,\ 4.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ assert\_equal(p\ -\/\ q,\ np.poly1d([-\/2.,\ 0.,\ 2.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ assert\_equal(p\ **\ 4,\ np.poly1d([1.,\ 8.,\ 36.,\ 104.,\ 214.,\ 312.,\ 324.,\ 216.,\ 81.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ assert\_equal(p(q),\ np.poly1d([9.,\ 12.,\ 16.,\ 8.,\ 6.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ assert\_equal(q(p),\ np.poly1d([3.,\ 12.,\ 32.,\ 40.,\ 34.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ assert\_equal(p.deriv(),\ np.poly1d([2.,\ 2.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ assert\_equal(p.deriv(2),\ np.poly1d([2.]))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ assert\_equal(np.polydiv(np.poly1d([1,\ 0,\ -\/1]),\ np.poly1d([1,\ 1])),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (np.poly1d([1.,\ -\/1.]),\ np.poly1d([0.])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00066}00066\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize("{}type\_code"{},\ TYPE\_CODES)}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00067}00067\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly1d\_misc(self,\ type\_code:\ str)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ dtype\ =\ np.dtype(type\_code)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ ar\ =\ np.array([1,\ 2,\ 3],\ dtype=dtype)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d(ar)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}\_\_eq\_\_`}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ assert\_equal(np.asarray(p),\ ar)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ assert\_equal(np.asarray(p).dtype,\ dtype)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ assert\_equal(len(p),\ 2)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \`{}\_\_getitem\_\_`}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ comparison\_dct\ =\ \{-\/1:\ 0,\ 0:\ 3,\ 1:\ 2,\ 2:\ 1,\ 3:\ 0\}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ index,\ ref\ \textcolor{keywordflow}{in}\ comparison\_dct.items():}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ scalar\ =\ p[index]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(scalar,\ ref)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dtype\ ==\ np.object\_:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(scalar,\ int)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(scalar.dtype,\ dtype)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00087}00087\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly1d\_variable\_arg(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([1.,\ 2,\ 3],\ variable=\textcolor{stringliteral}{'y'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ assert\_equal(str(q),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'1\ y\ +\ 2\ y\ +\ 3'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ q\ =\ np.poly1d([1.,\ 2,\ 3],\ variable=\textcolor{stringliteral}{'lambda'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ assert\_equal(str(q),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ \ \ \ \ \ \ \ 2\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'1\ lambda\ +\ 2\ lambda\ +\ 3'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00097}00097\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.poly([3,\ -\/np.sqrt(2),\ np.sqrt(2)]),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ -\/3,\ -\/2,\ 6])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ From\ matlab\ docs}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ A\ =\ [[1,\ 2,\ 3],\ [4,\ 5,\ 6],\ [7,\ 8,\ 0]]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(np.poly(A),\ [1,\ -\/6,\ -\/72,\ -\/27])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Should\ produce\ real\ output\ for\ perfect\ conjugates}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([+1.082j,\ +2.613j,\ -\/2.613j,\ -\/1.082j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([0+1j,\ -\/0+-\/1j,\ 1+2j,}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1-\/2j,\ 1.+3.5j,\ 1-\/3.5j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([1j,\ -\/1j,\ 1+2j,\ 1-\/2j,\ 1+3j,\ 1-\/3.j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([1j,\ -\/1j,\ 1+2j,\ 1-\/2j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([1j,\ -\/1j,\ 2j,\ -\/2j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([1j,\ -\/1j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly([1,\ -\/1])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ assert\_(np.iscomplexobj(np.poly([1j,\ -\/1.0000001j])))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00116}00116\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ a\ =\ np.random.randn(100)\ +\ 1j*np.random.randn(100)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ assert\_(np.isrealobj(np.poly(np.concatenate((a,\ np.conjugate(a))))))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00121}00121\ \ \ \ \ \textcolor{keyword}{def\ }test\_roots(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ assert\_array\_equal(np.roots([1,\ 0,\ 0]),\ [0,\ 0])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00123}00123\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00124}00124\ \ \ \ \ \textcolor{keyword}{def\ }test\_str\_leading\_zeros(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([4,\ 3,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ p[3]\ =\ 0}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ assert\_equal(str(p),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ 2\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}3\ x\ +\ 2\ x\ +\ 1"{}})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1,\ 2])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ p[0]\ =\ 0}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ p[1]\ =\ 0}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ assert\_equal(str(p),\ \textcolor{stringliteral}{"{}\ \(\backslash\)n0"{}})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00136}00136\ \ \ \ \ \textcolor{keyword}{def\ }test\_polyfit(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ c\ =\ np.array([3.,\ 2.,\ 1.])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ x\ =\ np.linspace(0,\ 2,\ 7)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ y\ =\ np.polyval(c,\ x)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ err\ =\ [1,\ -\/1,\ 1,\ -\/1,\ 1,\ -\/1,\ 1]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ weights\ =\ np.arange(8,\ 1,\ -\/1)**2/7.0}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ exception\ when\ too\ few\ points\ for\ variance\ estimate.\ Note\ that}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ estimate\ requires\ the\ number\ of\ data\ points\ to\ exceed}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ degree\ +\ 1}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ np.polyfit,}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1],\ [1],\ deg=0,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ 1D\ case}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ m,\ cov\ =\ np.polyfit(x,\ y+err,\ 2,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ est\ =\ [3.8571,\ 0.2857,\ 1.619]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ assert\_almost\_equal(est,\ m,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ val0\ =\ [[\ 1.4694,\ -\/2.9388,\ \ 0.8163],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/2.9388,\ \ 6.3673,\ -\/2.1224],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 0.8163,\ -\/2.1224,\ \ 1.161\ ]]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ assert\_almost\_equal(val0,\ cov,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ m2,\ cov2\ =\ np.polyfit(x,\ y+err,\ 2,\ w=weights,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ assert\_almost\_equal([4.8927,\ -\/1.0177,\ 1.7768],\ m2,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ val\ =\ [[\ 4.3964,\ -\/5.0052,\ \ 0.4878],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/5.0052,\ \ 6.8067,\ -\/0.9089],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 0.4878,\ -\/0.9089,\ \ 0.3337]]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ assert\_almost\_equal(val,\ cov2,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ m3,\ cov3\ =\ np.polyfit(x,\ y+err,\ 2,\ w=weights,\ cov=\textcolor{stringliteral}{"{}unscaled"{}})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ assert\_almost\_equal([4.8927,\ -\/1.0177,\ 1.7768],\ m3,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ val\ =\ [[\ 0.1473,\ -\/0.1677,\ \ 0.0163],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/0.1677,\ \ 0.228\ ,\ -\/0.0304],}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\ 0.0163,\ -\/0.0304,\ \ 0.0112]]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ assert\_almost\_equal(val,\ cov3,\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ 2D\ (n,1)\ case}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ y\ =\ y[:,\ np.newaxis]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ c\ =\ c[:,\ np.newaxis]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ assert\_almost\_equal(c,\ np.polyfit(x,\ y,\ 2))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ 2D\ (n,2)\ case}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ yy\ =\ np.concatenate((y,\ y),\ axis=1)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ cc\ =\ np.concatenate((c,\ c),\ axis=1)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ assert\_almost\_equal(cc,\ np.polyfit(x,\ yy,\ 2))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ m,\ cov\ =\ np.polyfit(x,\ yy\ +\ np.array(err)[:,\ np.newaxis],\ 2,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ assert\_almost\_equal(est,\ m[:,\ 0],\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ assert\_almost\_equal(est,\ m[:,\ 1],\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ assert\_almost\_equal(val0,\ cov[:,\ :,\ 0],\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ assert\_almost\_equal(val0,\ cov[:,\ :,\ 1],\ decimal=4)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00186}00186\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ order\ 1\ (deg=0)\ case,\ were\ the\ analytic\ results\ are\ simple}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ np.random.seed(123)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ y\ =\ np.random.normal(size=(4,\ 10000))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00190}00190\ \ \ \ \ \ \ \ \ mean,\ cov\ =\ np.polyfit(np.zeros(y.shape[0]),\ y,\ deg=0,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Should\ get\ sigma\_mean\ =\ sigma/sqrt(N)\ =\ 1./sqrt(4)\ =\ 0.5.}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ assert\_allclose(mean.std(),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ assert\_allclose(np.sqrt(cov.mean()),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Without\ scaling,\ since\ reduced\ chi2\ is\ 1,\ the\ result\ should\ be\ the\ same.}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ mean,\ cov\ =\ np.polyfit(np.zeros(y.shape[0]),\ y,\ w=np.ones(y.shape[0]),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ deg=0,\ cov=\textcolor{stringliteral}{"{}unscaled"{}})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ assert\_allclose(mean.std(),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ assert\_almost\_equal(np.sqrt(cov.mean()),\ 0.5)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we\ estimate\ our\ errors\ wrong,\ no\ change\ with\ scaling:}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ w\ =\ np.full(y.shape[0],\ 1./0.5)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ mean,\ cov\ =\ np.polyfit(np.zeros(y.shape[0]),\ y,\ w=w,\ deg=0,\ cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ assert\_allclose(mean.std(),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ assert\_allclose(np.sqrt(cov.mean()),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ But\ if\ we\ do\ not\ scale,\ our\ estimate\ for\ the\ error\ in\ the\ mean\ will}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ differ.}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00206}00206\ \ \ \ \ \ \ \ \ mean,\ cov\ =\ np.polyfit(np.zeros(y.shape[0]),\ y,\ w=w,\ deg=0,\ cov=\textcolor{stringliteral}{"{}unscaled"{}})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ assert\_allclose(mean.std(),\ 0.5,\ atol=0.01)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ assert\_almost\_equal(np.sqrt(cov.mean()),\ 0.25)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00210}00210\ \ \ \ \ \textcolor{keyword}{def\ }test\_objects(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ decimal\ \textcolor{keyword}{import}\ Decimal}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([Decimal(\textcolor{stringliteral}{'4.0'}),\ Decimal(\textcolor{stringliteral}{'3.0'}),\ Decimal(\textcolor{stringliteral}{'2.0'})])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ p2\ =\ p\ *\ Decimal(\textcolor{stringliteral}{'1.333333333333333'})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ assert\_(p2[1]\ ==\ Decimal(\textcolor{stringliteral}{"{}3.9999999999999990"{}}))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ p2\ =\ p.deriv()}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ assert\_(p2[1]\ ==\ Decimal(\textcolor{stringliteral}{'8.0'}))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ p2\ =\ p.integ()}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ assert\_(p2[3]\ ==\ Decimal(\textcolor{stringliteral}{"{}1.333333333333333333333333333"{}}))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ assert\_(p2[2]\ ==\ Decimal(\textcolor{stringliteral}{'1.5'}))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ assert\_(np.issubdtype(p2.coeffs.dtype,\ np.object\_))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ p\ =\ np.poly([Decimal(1),\ Decimal(2)])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ assert\_equal(np.poly([Decimal(1),\ Decimal(2)]),}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ Decimal(-\/3),\ Decimal(2)])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00225}00225\ \ \ \ \ \textcolor{keyword}{def\ }test\_complex(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([3j,\ 2j,\ 1j])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ p2\ =\ p.integ()}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ assert\_((p2.coeffs\ ==\ [1j,\ 1j,\ 1j,\ 0]).\mbox{\hyperlink{namespacenumpy_1_1core_1_1fromnumeric_ae94233643e35acde1817d89be3a2aeac}{all}}())}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ p2\ =\ p.deriv()}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ assert\_((p2.coeffs\ ==\ [6j,\ 2j]).\mbox{\hyperlink{namespacenumpy_1_1core_1_1fromnumeric_ae94233643e35acde1817d89be3a2aeac}{all}}())}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00232}00232\ \ \ \ \ \textcolor{keyword}{def\ }test\_integ\_coeffs(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([3,\ 2,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ p2\ =\ p.integ(3,\ k=[9,\ 7,\ 6])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ assert\_(}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ (p2.coeffs\ ==\ [1/4./5.,\ 1/3./4.,\ 1/2./3.,\ 9/1./2.,\ 7,\ 6]).\mbox{\hyperlink{namespacenumpy_1_1core_1_1fromnumeric_ae94233643e35acde1817d89be3a2aeac}{all}}())}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00237}00237\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00238}00238\ \ \ \ \ \textcolor{keyword}{def\ }test\_zero\_dims(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ np.poly(np.zeros((0,\ 0)))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ ValueError:}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00244}\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a604de300ebfb932178c51260acbb45cd}{00244}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a604de300ebfb932178c51260acbb45cd}{test\_poly\_int\_overflow}}(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Regression\ test\ for\ gh-\/5096.}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ v\ =\ np.arange(1,\ 21)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ assert\_almost\_equal(np.poly(v),\ np.poly(np.diag(v)))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00251}\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a33204768e299cde96b930cd1d5daf2a5}{00251}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a33204768e299cde96b930cd1d5daf2a5}{test\_zero\_poly\_dtype}}(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Regression\ test\ for\ gh-\/16354.}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ z\ =\ np.array([0,\ 0,\ 0])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d(z.astype(np.int64))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ assert\_equal(p.coeffs.dtype,\ np.int64)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00258}00258\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d(z.astype(np.float32))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ assert\_equal(p.coeffs.dtype,\ np.float32)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d(z.astype(np.complex64))}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ assert\_equal(p.coeffs.dtype,\ np.complex64)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00265}00265\ \ \ \ \ \textcolor{keyword}{def\ }test\_poly\_eq(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ p2\ =\ np.poly1d([1,\ 2,\ 4])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ assert\_equal(p\ ==\ \textcolor{keywordtype}{None},\ \textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ assert\_equal(p\ !=\ \textcolor{keywordtype}{None},\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ assert\_equal(p\ ==\ p,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ assert\_equal(p\ ==\ p2,\ \textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00272}00272\ \ \ \ \ \ \ \ \ assert\_equal(p\ !=\ p2,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00274}00274\ \ \ \ \ \textcolor{keyword}{def\ }test\_polydiv(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ b\ =\ np.poly1d([2,\ 6,\ 6,\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ a\ =\ np.poly1d([-\/1j,\ (1+2j),\ -\/(2+1j),\ 1])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ q,\ r\ =\ np.polydiv(b,\ a)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ assert\_equal(q.coeffs.dtype,\ np.complex128)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ assert\_equal(r.coeffs.dtype,\ np.complex128)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ assert\_equal(q*a\ +\ r,\ b)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ c\ =\ [1,\ 2,\ 3]}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ d\ =\ np.poly1d([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ s,\ t\ =\ np.polydiv(c,\ d)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(s,\ np.poly1d)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(t,\ np.poly1d)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ u,\ v\ =\ np.polydiv(d,\ c)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(u,\ np.poly1d)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ isinstance(v,\ np.poly1d)}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00290}00290\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00291}\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a5c0ec5aceb119cd205eb75c46714ee89}{00291}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classnumpy_1_1lib_1_1tests_1_1test__polynomial_1_1TestPolynomial_a5c0ec5aceb119cd205eb75c46714ee89}{test\_poly\_coeffs\_mutable}}(self):}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ Coefficients\ should\ be\ modifiable\ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ p\ =\ np.poly1d([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ p.coeffs\ +=\ 1}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ assert\_equal(p.coeffs,\ [2,\ 3,\ 4])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00297}00297\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ p.coeffs[2]\ +=\ 10}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ assert\_equal(p.coeffs,\ [2,\ 3,\ 14])}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00301}00301\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ this\ never\ used\ to\ be\ allowed\ -\/\ let's\ not\ add\ features\ to\ deprecated}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ APIs}}
\DoxyCodeLine{\Hypertarget{numpy_2lib_2tests_2test__polynomial_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ assert\_raises(AttributeError,\ setattr,\ p,\ \textcolor{stringliteral}{'coeffs'},\ np.array(1))}

\end{DoxyCode}
