\doxysection{scipy.\+signal.\+\_\+czt Namespace Reference}
\hypertarget{namespacescipy_1_1signal_1_1__czt}{}\label{namespacescipy_1_1signal_1_1__czt}\index{scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1CZT}{CZT}}
\item 
class \mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1ZoomFFT}{Zoom\+FFT}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a330a4957d42d0965ef8cdfc2cc3e4956}{\+\_\+validate\+\_\+sizes}} (n, m)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a81e6bb32a718b2d63025dabd60afddb1}{czt\+\_\+points}} (m, w=None, a=1+0j)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_aa630e14a9bc05420692445f7100ded52}{czt}} (x, m=None, w=None, a=1+0j, \texorpdfstring{$\ast$}{*}, axis=-\/1)
\item 
\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a781f8c416430067770b387da1e74cd64}{zoom\+\_\+fft}} (x, fn, m=None, \texorpdfstring{$\ast$}{*}, fs=2, endpoint=False, axis=-\/1)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a84332ae62c20b9664ea8363f46723f5a}{\+\_\+\+\_\+all\+\_\+\+\_\+}} = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_aa630e14a9bc05420692445f7100ded52}{czt}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a781f8c416430067770b387da1e74cd64}{zoom\+\_\+fft}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1CZT}{CZT}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1ZoomFFT}{Zoom\+FFT}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a81e6bb32a718b2d63025dabd60afddb1}{czt\+\_\+points}}\textquotesingle{}\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Chirp z-transform.

We provide two interfaces to the chirp z-transform: an object interface
which precalculates part of the transform and can be applied efficiently
to many different data sets, and a functional interface which is applied
only to the given data set.

Transforms
----------

CZT : callable (x, axis=-1) -> array
   Define a chirp z-transform that can be applied to different signals.
ZoomFFT : callable (x, axis=-1) -> array
   Define a Fourier transform on a range of frequencies.

Functions
---------

czt : array
   Compute the chirp z-transform for a signal.
zoom_fft : array
   Compute the Fourier transform on a range of frequencies.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacescipy_1_1signal_1_1__czt_a330a4957d42d0965ef8cdfc2cc3e4956}\index{scipy.signal.\_czt@{scipy.signal.\_czt}!\_validate\_sizes@{\_validate\_sizes}}
\index{\_validate\_sizes@{\_validate\_sizes}!scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection{\texorpdfstring{\_validate\_sizes()}{\_validate\_sizes()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__czt_a330a4957d42d0965ef8cdfc2cc3e4956} 
scipy.\+signal.\+\_\+czt.\+\_\+validate\+\_\+sizes (\begin{DoxyParamCaption}\item[{}]{n}{, }\item[{}]{m}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{__czt_8py_source_l00037}{37}} of file \mbox{\hyperlink{__czt_8py_source}{\+\_\+czt.\+py}}.

\Hypertarget{namespacescipy_1_1signal_1_1__czt_aa630e14a9bc05420692445f7100ded52}\index{scipy.signal.\_czt@{scipy.signal.\_czt}!czt@{czt}}
\index{czt@{czt}!scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection{\texorpdfstring{czt()}{czt()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__czt_aa630e14a9bc05420692445f7100ded52} 
scipy.\+signal.\+\_\+czt.\+czt (\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{m}{ = {\ttfamily None}, }\item[{}]{w}{ = {\ttfamily None}, }\item[{}]{a}{ = {\ttfamily 1+0j}, }\item[{\texorpdfstring{$\ast$}{*}}]{}{, }\item[{}]{axis}{ = {\ttfamily -\/1}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute the frequency response around a spiral in the Z plane.

Parameters
----------
x : array
    The signal to transform.
m : int, optional
    The number of output points desired.  Default is the length of the
    input data.
w : complex, optional
    The ratio between points in each step.  This must be precise or the
    accumulated error will degrade the tail of the output sequence.
    Defaults to equally spaced points around the entire unit circle.
a : complex, optional
    The starting point in the complex plane.  Default is 1+0j.
axis : int, optional
    Axis over which to compute the FFT. If not given, the last axis is
    used.

Returns
-------
out : ndarray
    An array of the same dimensions as `x`, but with the length of the
    transformed axis set to `m`.

See Also
--------
CZT : Class that creates a callable chirp z-transform function.
zoom_fft : Convenience function for partial FFT calculations.

Notes
-----
The defaults are chosen such that ``signal.czt(x)`` is equivalent to
``fft.fft(x)`` and, if ``m > len(x)``, that ``signal.czt(x, m)`` is
equivalent to ``fft.fft(x, m)``.

If the transform needs to be repeated, use `CZT` to construct a
specialized transform function which can be reused without
recomputing constants.

An example application is in system identification, repeatedly evaluating
small slices of the z-transform of a system, around where a pole is
expected to exist, to refine the estimate of the pole's true location. [1]_

References
----------
.. [1] Steve Alan Shilling, "A study of the chirp z-transform and its
       applications", pg 20 (1970)
       https://krex.k-state.edu/dspace/bitstream/handle/2097/7844/LD2668R41972S43.pdf

Examples
--------
Generate a sinusoid:

>>> import numpy as np
>>> f1, f2, fs = 8, 10, 200  # Hz
>>> t = np.linspace(0, 1, fs, endpoint=False)
>>> x = np.sin(2*np.pi*t*f2)
>>> import matplotlib.pyplot as plt
>>> plt.plot(t, x)
>>> plt.axis([0, 1, -1.1, 1.1])
>>> plt.show()

Its discrete Fourier transform has all of its energy in a single frequency
bin:

>>> from scipy.fft import rfft, rfftfreq
>>> from scipy.signal import czt, czt_points
>>> plt.plot(rfftfreq(fs, 1/fs), abs(rfft(x)))
>>> plt.margins(0, 0.1)
>>> plt.show()

However, if the sinusoid is logarithmically-decaying:

>>> x = np.exp(-t*f1) * np.sin(2*np.pi*t*f2)
>>> plt.plot(t, x)
>>> plt.axis([0, 1, -1.1, 1.1])
>>> plt.show()

the DFT will have spectral leakage:

>>> plt.plot(rfftfreq(fs, 1/fs), abs(rfft(x)))
>>> plt.margins(0, 0.1)
>>> plt.show()

While the DFT always samples the z-transform around the unit circle, the
chirp z-transform allows us to sample the Z-transform along any
logarithmic spiral, such as a circle with radius smaller than unity:

>>> M = fs // 2  # Just positive frequencies, like rfft
>>> a = np.exp(-f1/fs)  # Starting point of the circle, radius < 1
>>> w = np.exp(-1j*np.pi/M)  # "Step size" of circle
>>> points = czt_points(M + 1, w, a)  # M + 1 to include Nyquist
>>> plt.plot(points.real, points.imag, '.')
>>> plt.gca().add_patch(plt.Circle((0,0), radius=1, fill=False, alpha=.3))
>>> plt.axis('equal'); plt.axis([-1.05, 1.05, -0.05, 1.05])
>>> plt.show()

With the correct radius, this transforms the decaying sinusoid (and others
with the same decay rate) without spectral leakage:

>>> z_vals = czt(x, M + 1, w, a)  # Include Nyquist for comparison to rfft
>>> freqs = np.angle(points)*fs/(2*np.pi)  # angle = omega, radius = sigma
>>> plt.plot(freqs, abs(z_vals))
>>> plt.margins(0, 0.1)
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__czt_8py_source_l00394}{394}} of file \mbox{\hyperlink{__czt_8py_source}{\+\_\+czt.\+py}}.

\Hypertarget{namespacescipy_1_1signal_1_1__czt_a81e6bb32a718b2d63025dabd60afddb1}\index{scipy.signal.\_czt@{scipy.signal.\_czt}!czt\_points@{czt\_points}}
\index{czt\_points@{czt\_points}!scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection{\texorpdfstring{czt\_points()}{czt\_points()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__czt_a81e6bb32a718b2d63025dabd60afddb1} 
scipy.\+signal.\+\_\+czt.\+czt\+\_\+points (\begin{DoxyParamCaption}\item[{}]{m}{, }\item[{}]{w}{ = {\ttfamily None}, }\item[{}]{a}{ = {\ttfamily 1+0j}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the points at which the chirp z-transform is computed.

Parameters
----------
m : int
    The number of points desired.
w : complex, optional
    The ratio between points in each step.
    Defaults to equally spaced points around the entire unit circle.
a : complex, optional
    The starting point in the complex plane.  Default is 1+0j.

Returns
-------
out : ndarray
    The points in the Z plane at which `CZT` samples the z-transform,
    when called with arguments `m`, `w`, and `a`, as complex numbers.

See Also
--------
CZT : Class that creates a callable chirp z-transform function.
czt : Convenience function for quickly calculating CZT.

Examples
--------
Plot the points of a 16-point FFT:

>>> import numpy as np
>>> from scipy.signal import czt_points
>>> points = czt_points(16)
>>> import matplotlib.pyplot as plt
>>> plt.plot(points.real, points.imag, 'o')
>>> plt.gca().add_patch(plt.Circle((0,0), radius=1, fill=False, alpha=.3))
>>> plt.axis('equal')
>>> plt.show()

and a 91-point logarithmic spiral that crosses the unit circle:

>>> m, w, a = 91, 0.995*np.exp(-1j*np.pi*.05), 0.8*np.exp(1j*np.pi/6)
>>> points = czt_points(m, w, a)
>>> plt.plot(points.real, points.imag, 'o')
>>> plt.gca().add_patch(plt.Circle((0,0), radius=1, fill=False, alpha=.3))
>>> plt.axis('equal')
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__czt_8py_source_l00053}{53}} of file \mbox{\hyperlink{__czt_8py_source}{\+\_\+czt.\+py}}.



Referenced by \mbox{\hyperlink{__czt_8py_source_l00268}{scipy.\+signal.\+\_\+czt.\+CZT.\+points()}}.

\Hypertarget{namespacescipy_1_1signal_1_1__czt_a781f8c416430067770b387da1e74cd64}\index{scipy.signal.\_czt@{scipy.signal.\_czt}!zoom\_fft@{zoom\_fft}}
\index{zoom\_fft@{zoom\_fft}!scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection{\texorpdfstring{zoom\_fft()}{zoom\_fft()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__czt_a781f8c416430067770b387da1e74cd64} 
scipy.\+signal.\+\_\+czt.\+zoom\+\_\+fft (\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{fn}{, }\item[{}]{m}{ = {\ttfamily None}, }\item[{\texorpdfstring{$\ast$}{*}}]{}{, }\item[{}]{fs}{ = {\ttfamily 2}, }\item[{}]{endpoint}{ = {\ttfamily False}, }\item[{}]{axis}{ = {\ttfamily -\/1}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute the DFT of `x` only for frequencies in range `fn`.

Parameters
----------
x : array
    The signal to transform.
fn : array_like
    A length-2 sequence [`f1`, `f2`] giving the frequency range, or a
    scalar, for which the range [0, `fn`] is assumed.
m : int, optional
    The number of points to evaluate.  The default is the length of `x`.
fs : float, optional
    The sampling frequency.  If ``fs=10`` represented 10 kHz, for example,
    then `f1` and `f2` would also be given in kHz.
    The default sampling frequency is 2, so `f1` and `f2` should be
    in the range [0, 1] to keep the transform below the Nyquist
    frequency.
endpoint : bool, optional
    If True, `f2` is the last sample. Otherwise, it is not included.
    Default is False.
axis : int, optional
    Axis over which to compute the FFT. If not given, the last axis is
    used.

Returns
-------
out : ndarray
    The transformed signal.  The Fourier transform will be calculated
    at the points f1, f1+df, f1+2df, ..., f2, where df=(f2-f1)/m.

See Also
--------
ZoomFFT : Class that creates a callable partial FFT function.

Notes
-----
The defaults are chosen such that ``signal.zoom_fft(x, 2)`` is equivalent
to ``fft.fft(x)`` and, if ``m > len(x)``, that ``signal.zoom_fft(x, 2, m)``
is equivalent to ``fft.fft(x, m)``.

To graph the magnitude of the resulting transform, use::

    plot(linspace(f1, f2, m, endpoint=False), abs(zoom_fft(x, [f1, f2], m)))

If the transform needs to be repeated, use `ZoomFFT` to construct
a specialized transform function which can be reused without
recomputing constants.

Examples
--------
To plot the transform results use something like the following:

>>> import numpy as np
>>> from scipy.signal import zoom_fft
>>> t = np.linspace(0, 1, 1021)
>>> x = np.cos(2*np.pi*15*t) + np.sin(2*np.pi*17*t)
>>> f1, f2 = 5, 27
>>> X = zoom_fft(x, [f1, f2], len(x), fs=1021)
>>> f = np.linspace(f1, f2, len(x))
>>> import matplotlib.pyplot as plt
>>> plt.plot(f, 20*np.log10(np.abs(X)))
>>> plt.show()
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__czt_8py_source_l00508}{508}} of file \mbox{\hyperlink{__czt_8py_source}{\+\_\+czt.\+py}}.



\doxysubsection{Variable Documentation}
\Hypertarget{namespacescipy_1_1signal_1_1__czt_a84332ae62c20b9664ea8363f46723f5a}\index{scipy.signal.\_czt@{scipy.signal.\_czt}!\_\_all\_\_@{\_\_all\_\_}}
\index{\_\_all\_\_@{\_\_all\_\_}!scipy.signal.\_czt@{scipy.signal.\_czt}}
\doxysubsubsection{\texorpdfstring{\_\_all\_\_}{\_\_all\_\_}}
{\footnotesize\ttfamily \label{namespacescipy_1_1signal_1_1__czt_a84332ae62c20b9664ea8363f46723f5a} 
list scipy.\+signal.\+\_\+czt.\+\_\+\+\_\+all\+\_\+\+\_\+ = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_aa630e14a9bc05420692445f7100ded52}{czt}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a781f8c416430067770b387da1e74cd64}{zoom\+\_\+fft}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1CZT}{CZT}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{classscipy_1_1signal_1_1__czt_1_1ZoomFFT}{Zoom\+FFT}}\textquotesingle{}, \textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__czt_a81e6bb32a718b2d63025dabd60afddb1}{czt\+\_\+points}}\textquotesingle{}\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{__czt_8py_source_l00034}{34}} of file \mbox{\hyperlink{__czt_8py_source}{\+\_\+czt.\+py}}.

