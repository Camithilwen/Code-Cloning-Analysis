\doxysection{\+\_\+bisect\+\_\+k\+\_\+means.\+py}
\hypertarget{__bisect__k__means_8py_source}{}\label{__bisect__k__means_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/cluster/\_bisect\_k\_means.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/cluster/\_bisect\_k\_means.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1cluster_1_1__bisect__k__means}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Bisecting\ K-\/means\ clustering."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00003}00003\ \textcolor{comment}{\#\ Authors:\ The\ scikit-\/learn\ developers}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00004}00004\ \textcolor{comment}{\#\ SPDX-\/License-\/Identifier:\ BSD-\/3-\/Clause}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00006}00006\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00008}00008\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00009}00009\ \textcolor{keyword}{import}\ \mbox{\hyperlink{namespacescipy_1_1sparse}{scipy.sparse}}\ \textcolor{keyword}{as}\ sp}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00011}00011\ \textcolor{keyword}{from}\ ..base\ \textcolor{keyword}{import}\ \_fit\_context}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00012}00012\ \textcolor{keyword}{from}\ ..utils.\_openmp\_helpers\ \textcolor{keyword}{import}\ \_openmp\_effective\_n\_threads}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00013}00013\ \textcolor{keyword}{from}\ ..utils.\_param\_validation\ \textcolor{keyword}{import}\ Integral,\ Interval,\ StrOptions}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00014}00014\ \textcolor{keyword}{from}\ ..utils.extmath\ \textcolor{keyword}{import}\ row\_norms}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00015}00015\ \textcolor{keyword}{from}\ ..utils.validation\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00016}00016\ \ \ \ \ \_check\_sample\_weight,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00017}00017\ \ \ \ \ check\_is\_fitted,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00018}00018\ \ \ \ \ check\_random\_state,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00019}00019\ \ \ \ \ validate\_data,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00020}00020\ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00021}00021\ \textcolor{keyword}{from}\ .\_k\_means\_common\ \textcolor{keyword}{import}\ \_inertia\_dense,\ \_inertia\_sparse}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00022}00022\ \textcolor{keyword}{from}\ .\_kmeans\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00023}00023\ \ \ \ \ \_BaseKMeans,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00024}00024\ \ \ \ \ \_kmeans\_single\_elkan,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00025}00025\ \ \ \ \ \_kmeans\_single\_lloyd,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00026}00026\ \ \ \ \ \_labels\_inertia\_threadpool\_limit,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00027}00027\ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00030}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree}{00030}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree}{\_BisectingTree}}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00031}00031\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Tree\ structure\ representing\ the\ hierarchical\ clusters\ of\ BisectingKMeans."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00033}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ac9569fdebb0de26c102a60ba6ee1cde0}{00033}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ac9569fdebb0de26c102a60ba6ee1cde0}{\_\_init\_\_}}(self,\ center,\ indices,\ score):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Create\ a\ new\ cluster\ node\ in\ the\ tree.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00035}00035\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ node\ holds\ the\ center\ of\ this\ cluster\ and\ the\ indices\ of\ the\ data\ points}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ that\ belong\ to\ it.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a08cd39ad24936049f4ee76c2f92497c2}{center}}\ =\ center}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_aeb48181e94304a9ca9a3d02e9ae4ca99}{indices}}\ =\ indices}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a348f1917dc487441220574d65f458f04}{score}}\ =\ score}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a2ebaded6d57054bab452cd1eac858cff}{left}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a0f3b35df0802bf6e472b7505b8002ecc}{right}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00046}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a1287d7a2f95b3988a064f3a80fc1b4c8}{00046}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a1287d7a2f95b3988a064f3a80fc1b4c8}{split}}(self,\ labels,\ centers,\ scores):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Split\ the\ cluster\ node\ into\ two\ subclusters."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a2ebaded6d57054bab452cd1eac858cff}{left}}\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree}{\_BisectingTree}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ indices=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_aeb48181e94304a9ca9a3d02e9ae4ca99}{indices}}[labels\ ==\ 0],\ center=centers[0],\ score=scores[0]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a0f3b35df0802bf6e472b7505b8002ecc}{right}}\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree}{\_BisectingTree}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ indices=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_aeb48181e94304a9ca9a3d02e9ae4ca99}{indices}}[labels\ ==\ 1],\ center=centers[1],\ score=scores[1]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ reset\ the\ indices\ attribute\ to\ save\ memory}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_aeb48181e94304a9ca9a3d02e9ae4ca99}{indices}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00058}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a9461b22fbe1a235a09a361afd77fff90}{00058}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a9461b22fbe1a235a09a361afd77fff90}{get\_cluster\_to\_bisect}}(self):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ the\ cluster\ node\ to\ bisect\ next.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00060}00060\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ It's\ based\ on\ the\ score\ of\ the\ cluster,\ which\ can\ be\ either\ the\ number\ of}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ data\ points\ assigned\ to\ that\ cluster\ or\ the\ inertia\ of\ that\ cluster}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (see\ \`{}bisecting\_strategy\`{}\ for\ details).}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ max\_score\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ cluster\_leaf\ \textcolor{keywordflow}{in}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ab2292cb28f7b48e0800531cb5343895e}{iter\_leaves}}():}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ max\_score\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ cluster\_leaf.score\ >\ max\_score:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_score\ =\ cluster\_leaf.score}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_cluster\_leaf\ =\ cluster\_leaf}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ best\_cluster\_leaf}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00074}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ab2292cb28f7b48e0800531cb5343895e}{00074}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ab2292cb28f7b48e0800531cb5343895e}{iter\_leaves}}(self):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Iterate\ over\ all\ the\ cluster\ leaves\ in\ the\ tree."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a2ebaded6d57054bab452cd1eac858cff}{left}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ self}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ \textcolor{keyword}{from}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a2ebaded6d57054bab452cd1eac858cff}{left}}.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ab2292cb28f7b48e0800531cb5343895e}{iter\_leaves}}()}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ \textcolor{keyword}{from}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_a0f3b35df0802bf6e472b7505b8002ecc}{right}}.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree_ab2292cb28f7b48e0800531cb5343895e}{iter\_leaves}}()}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00083}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{00083}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{BisectingKMeans}}(\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans}{\_BaseKMeans}}):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00084}00084\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Bisecting\ K-\/Means\ clustering.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00085}00085\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00086}00086\ \textcolor{stringliteral}{\ \ \ \ Read\ more\ in\ the\ :ref:\`{}User\ Guide\ <bisect\_k\_means>\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00087}00087\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 1.1}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00089}00089\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ n\_clusters\ :\ int,\ default=8}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ clusters\ to\ form\ as\ well\ as\ the\ number\ of}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ centroids\ to\ generate.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00095}00095\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ init\ :\ \{'k-\/means++',\ 'random'\}\ or\ callable,\ default='random'}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Method\ for\ initialization:}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00098}00098\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'k-\/means++'\ :\ selects\ initial\ cluster\ centers\ for\ k-\/mean}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ clustering\ in\ a\ smart\ way\ to\ speed\ up\ convergence.\ See\ section}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Notes\ in\ k\_init\ for\ more\ details.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00102}00102\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 'random':\ choose\ \`{}n\_clusters\`{}\ observations\ (rows)\ at\ random\ from\ data}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ the\ initial\ centroids.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00105}00105\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ a\ callable\ is\ passed,\ it\ should\ take\ arguments\ X,\ n\_clusters\ and\ a}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ random\ state\ and\ return\ an\ initialization.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00108}00108\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00109}00109\ \textcolor{stringliteral}{\ \ \ \ n\_init\ :\ int,\ default=1}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ time\ the\ inner\ k-\/means\ algorithm\ will\ be\ run\ with\ different}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ centroid\ seeds\ in\ each\ bisection.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ That\ will\ result\ producing\ for\ each\ bisection\ best\ output\ of\ n\_init}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00113}00113\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ consecutive\ runs\ in\ terms\ of\ inertia.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00114}00114\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ random\_state\ :\ int,\ RandomState\ instance\ or\ None,\ default=None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Determines\ random\ number\ generation\ for\ centroid\ initialization}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ inner\ K-\/Means.\ Use\ an\ int\ to\ make\ the\ randomness\ deterministic.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ :term:\`{}Glossary\ <random\_state>\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00119}00119\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ max\_iter\ :\ int,\ default=300}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00121}00121\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations\ of\ the\ inner\ k-\/means\ algorithm\ at\ each}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bisection.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00123}00123\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ verbose\ :\ int,\ default=0}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Verbosity\ mode.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00126}00126\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00127}00127\ \textcolor{stringliteral}{\ \ \ \ tol\ :\ float,\ default=1e-\/4}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00128}00128\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Relative\ tolerance\ with\ regards\ to\ Frobenius\ norm\ of\ the\ difference}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00129}00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ the\ cluster\ centers\ of\ two\ consecutive\ iterations\ \ to\ declare}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00130}00130\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ convergence.\ Used\ in\ inner\ k-\/means\ algorithm\ at\ each\ bisection\ to\ pick}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00131}00131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ best\ possible\ clusters.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00132}00132\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ copy\_x\ :\ bool,\ default=True}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ pre-\/computing\ distances\ it\ is\ more\ numerically\ accurate\ to\ center}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ data\ first.\ If\ copy\_x\ is\ True\ (default),\ then\ the\ original\ data\ is}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ not\ modified.\ If\ False,\ the\ original\ data\ is\ modified,\ and\ put\ back}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ before\ the\ function\ returns,\ but\ small\ numerical\ differences\ may\ be}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ introduced\ by\ subtracting\ and\ then\ adding\ the\ data\ mean.\ Note\ that\ if}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ original\ data\ is\ not\ C-\/contiguous,\ a\ copy\ will\ be\ made\ even\ if}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ copy\_x\ is\ False.\ If\ the\ original\ data\ is\ sparse,\ but\ not\ in\ CSR\ format,}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ copy\ will\ be\ made\ even\ if\ copy\_x\ is\ False.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00142}00142\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ algorithm\ :\ \{"{}lloyd"{},\ "{}elkan"{}\},\ default="{}lloyd"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Inner\ K-\/means\ algorithm\ used\ in\ bisection.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ classical\ EM-\/style\ algorithm\ is\ \`{}"{}lloyd"{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ \`{}"{}elkan"{}\`{}\ variation\ can\ be\ more\ efficient\ on\ some\ datasets\ with}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ well-\/defined\ clusters,\ by\ using\ the\ triangle\ inequality.\ However\ it's}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ more\ memory\ intensive\ due\ to\ the\ allocation\ of\ an\ extra\ array\ of\ shape}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}(n\_samples,\ n\_clusters)\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00150}00150\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00151}00151\ \textcolor{stringliteral}{\ \ \ \ bisecting\_strategy\ :\ \{"{}biggest\_inertia"{},\ "{}largest\_cluster"{}\},\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ default="{}biggest\_inertia"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Defines\ how\ bisection\ should\ be\ performed:}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00154}00154\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ "{}biggest\_inertia"{}\ means\ that\ BisectingKMeans\ will\ always\ check}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00156}00156\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ all\ calculated\ cluster\ for\ cluster\ with\ biggest\ SSE}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ (Sum\ of\ squared\ errors)\ and\ bisect\ it.\ This\ approach\ concentrates\ on}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ precision,\ but\ may\ be\ costly\ in\ terms\ of\ execution\ time\ (especially\ for}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ larger\ amount\ of\ data\ points).}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00160}00160\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ "{}largest\_cluster"{}\ -\/\ BisectingKMeans\ will\ always\ split\ cluster\ with}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ largest\ amount\ of\ points\ assigned\ to\ it\ from\ all\ clusters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ previously\ calculated.\ That\ should\ work\ faster\ than\ picking\ by\ SSE}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ ('biggest\_inertia')\ and\ may\ produce\ similar\ results\ in\ most\ cases.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00165}00165\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ Attributes}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ cluster\_centers\_\ :\ ndarray\ of\ shape\ (n\_clusters,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Coordinates\ of\ cluster\ centers.\ If\ the\ algorithm\ stops\ before\ fully}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ converging\ (see\ \`{}\`{}tol\`{}\`{}\ and\ \`{}\`{}max\_iter\`{}\`{}),\ these\ will\ not\ be}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ consistent\ with\ \`{}\`{}labels\_\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00172}00172\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ labels\_\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Labels\ of\ each\ point.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00175}00175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ inertia\_\ :\ float}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Sum\ of\ squared\ distances\ of\ samples\ to\ their\ closest\ cluster\ center,}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ weighted\ by\ the\ sample\ weights\ if\ provided.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00179}00179\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ n\_features\_in\_\ :\ int}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Number\ of\ features\ seen\ during\ :term:\`{}fit\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00182}00182\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ feature\_names\_in\_\ :\ ndarray\ of\ shape\ (\`{}n\_features\_in\_\`{},)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Names\ of\ features\ seen\ during\ :term:\`{}fit\`{}.\ Defined\ only\ when\ \`{}X\`{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ has\ feature\ names\ that\ are\ all\ strings.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00186}00186\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00189}00189\ \textcolor{stringliteral}{\ \ \ \ KMeans\ :\ Original\ implementation\ of\ K-\/Means\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00190}00190\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00191}00191\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ It\ might\ be\ inefficient\ when\ n\_cluster\ is\ less\ than\ 3,\ due\ to\ unnecessary}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00194}00194\ \textcolor{stringliteral}{\ \ \ \ calculations\ for\ that\ case.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00195}00195\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ sklearn.cluster\ import\ BisectingKMeans}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ >>>\ X\ =\ np.array([[1,\ 1],\ [10,\ 1],\ [3,\ 1],}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00201}00201\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10,\ 0],\ [2,\ 1],\ [10,\ 2],}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [10,\ 8],\ [10,\ 9],\ [10,\ 10]])}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ >>>\ bisect\_means\ =\ BisectingKMeans(n\_clusters=3,\ random\_state=0).fit(X)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ >>>\ bisect\_means.labels\_}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ array([0,\ 2,\ 0,\ 2,\ 0,\ 2,\ 1,\ 1,\ 1],\ dtype=int32)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ >>>\ bisect\_means.predict([[0,\ 0],\ [12,\ 3]])}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ array([0,\ 2],\ dtype=int32)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ >>>\ bisect\_means.cluster\_centers\_}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ array([[\ 2.,\ 1.],}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [10.,\ 9.],}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ [10.,\ 1.]])}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00212}00212\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ For\ a\ comparison\ between\ BisectingKMeans\ and\ K-\/Means\ refer\ to\ example}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ :ref:\`{}sphx\_glr\_auto\_examples\_cluster\_plot\_bisect\_kmeans.py\`{}.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00217}00217\ \ \ \ \ \_parameter\_constraints:\ dict\ =\ \{}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ **\_BaseKMeans.\_parameter\_constraints,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}init"{}}:\ [\mbox{\hyperlink{classsklearn_1_1utils_1_1__param__validation_1_1StrOptions}{StrOptions}}(\{\textcolor{stringliteral}{"{}k-\/means++"{}},\ \textcolor{stringliteral}{"{}random"{}}\}),\ callable],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}n\_init"{}}:\ [\mbox{\hyperlink{classsklearn_1_1utils_1_1__param__validation_1_1Interval}{Interval}}(Integral,\ 1,\ \textcolor{keywordtype}{None},\ closed=\textcolor{stringliteral}{"{}left"{}})],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}copy\_x"{}}:\ [\textcolor{stringliteral}{"{}boolean"{}}],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}algorithm"{}}:\ [\mbox{\hyperlink{classsklearn_1_1utils_1_1__param__validation_1_1StrOptions}{StrOptions}}(\{\textcolor{stringliteral}{"{}lloyd"{}},\ \textcolor{stringliteral}{"{}elkan"{}}\})],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00223}00223\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}bisecting\_strategy"{}}:\ [\mbox{\hyperlink{classsklearn_1_1utils_1_1__param__validation_1_1StrOptions}{StrOptions}}(\{\textcolor{stringliteral}{"{}biggest\_inertia"{}},\ \textcolor{stringliteral}{"{}largest\_cluster"{}}\})],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00224}00224\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00226}00226\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ n\_clusters=8,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ *,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ init="{}random"{},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ n\_init=1,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ random\_state=None,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ max\_iter=300,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ verbose=0,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ tol=1e-\/4,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ copy\_x=True,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ algorithm="{}lloyd"{},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ bisecting\_strategy="{}biggest\_inertia"{},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00239}00239\ \ \ \ \ ):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ super().\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ n\_clusters=n\_clusters,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ init=init,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ max\_iter=max\_iter,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ verbose=verbose,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=random\_state,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ tol=tol,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ n\_init=n\_init,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00250}00250\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a2799c382563d60bbe8d11392babd15f2}{copy\_x}}\ =\ copy\_x}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ab2a2ac0b351f5d0ff78675b4fa589329}{algorithm}}\ =\ algorithm}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a07e29b99bfd76504ff016d904dbb1acc}{bisecting\_strategy}}\ =\ bisecting\_strategy}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00254}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ad46c206f9513fb0bae7195302b423fdc}{00254}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ad46c206f9513fb0bae7195302b423fdc}{\_warn\_mkl\_vcomp}}(self,\ n\_active\_threads):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Warn\ when\ vcomp\ and\ mkl\ are\ both\ present"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ warnings.warn(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}BisectingKMeans\ is\ known\ to\ have\ a\ memory\ leak\ on\ Windows\ "{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}with\ MKL,\ when\ there\ are\ less\ chunks\ than\ available\ "{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}threads.\ You\ can\ avoid\ it\ by\ setting\ the\ environment"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00260}00260\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\ variable\ OMP\_NUM\_THREADS=\{n\_active\_threads\}."{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00263}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a72028da5358cdf54626f1399a18fd07a}{00263}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a72028da5358cdf54626f1399a18fd07a}{\_inertia\_per\_cluster}}(self,\ X,\ centers,\ labels,\ sample\_weight):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Calculate\ the\ sum\ of\ squared\ errors\ (inertia)\ per\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00265}00265\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ X\ :\ \{ndarray,\ csr\_matrix\}\ of\ shape\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ input\ samples.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00270}00270\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ centers\ :\ ndarray\ of\ shape\ (n\_clusters=2,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ cluster\ centers.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00273}00273\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ labels\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Index\ of\ the\ cluster\ each\ sample\ belongs\ to.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00276}00276\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\_weight\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00278}00278\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ weights\ for\ each\ observation\ in\ X.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00279}00279\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ inertia\_per\_cluster\ :\ ndarray\ of\ shape\ (n\_clusters=2,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00283}00283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Sum\ of\ squared\ errors\ (inertia)\ for\ each\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ n\_clusters\ =\ centers.shape[0]\ \ \textcolor{comment}{\#\ =\ 2\ since\ centers\ comes\ from\ a\ bisection}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \_inertia\ =\ \_inertia\_sparse\ \textcolor{keywordflow}{if}\ sp.issparse(X)\ \textcolor{keywordflow}{else}\ \_inertia\_dense}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ inertia\_per\_cluster\ =\ np.empty(n\_clusters)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ label\ \textcolor{keywordflow}{in}\ range(n\_clusters):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ inertia\_per\_cluster[label]\ =\ \_inertia(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,\ sample\_weight,\ centers,\ labels,\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{\_n\_threads}},\ single\_label=label}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00293}00293\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00294}00294\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ inertia\_per\_cluster}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00295}00295\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00296}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a7a910f612901320c3b1eb05a399f086d}{00296}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a7a910f612901320c3b1eb05a399f086d}{\_bisect}}(self,\ X,\ x\_squared\_norms,\ sample\_weight,\ cluster\_to\_bisect):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Split\ a\ cluster\ into\ 2\ subsclusters.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00298}00298\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ X\ :\ \{ndarray,\ csr\_matrix\}\ of\ shape\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Training\ instances\ to\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00303}00303\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ x\_squared\_norms\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Squared\ euclidean\ norm\ of\ each\ data\ point.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00306}00306\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\_weight\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ weights\ for\ each\ observation\ in\ X.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00309}00309\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ cluster\_to\_bisect\ :\ \_BisectingTree\ node\ object}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ cluster\ node\ to\ split.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ X\ =\ X[cluster\_to\_bisect.indices]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ x\_squared\_norms\ =\ x\_squared\_norms[cluster\_to\_bisect.indices]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ sample\_weight\ =\ sample\_weight[cluster\_to\_bisect.indices]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00316}00316\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00317}00317\ \ \ \ \ \ \ \ \ best\_inertia\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00318}00318\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Split\ samples\ in\ X\ into\ 2\ clusters.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Repeating\ \`{}n\_init`\ times\ to\ obtain\ best\ clusters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{n\_init}}):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00322}00322\ \ \ \ \ \ \ \ \ \ \ \ \ centers\_init\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a5393488d92e6fe04702682e54855d26e}{\_init\_centroids}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_squared\_norms=x\_squared\_norms,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ init=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a0058754fb9fa902a858f734aad82c41c}{init}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a876acb0e594f06ca0965aef2dd779d9a}{\_random\_state}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_centroids=2,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\_weight=sample\_weight,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00330}00330\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ labels,\ inertia,\ centers,\ \_\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a29ce228790c569db86e9fb202a5504ab}{\_kmeans\_single}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\_weight,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ centers\_init,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_iter=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a20f07156fd841fc5498c874ef14908cb}{max\_iter}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ verbose=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{verbose}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tol=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a0474778173426ca77e1379ffaf437d2e}{tol}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ n\_threads=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{\_n\_threads}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00340}00340\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ allow\ small\ tolerance\ on\ the\ inertia\ to\ accommodate\ for}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ non-\/deterministic\ rounding\ errors\ due\ to\ parallel\ computation}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ best\_inertia\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ inertia\ <\ best\_inertia\ *\ (1\ -\/\ 1e-\/6):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_labels\ =\ labels}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_centers\ =\ centers}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_inertia\ =\ inertia}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00347}00347\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{verbose}}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}New\ centroids\ from\ bisection:\ \{best\_centers\}"{}})}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00350}00350\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a07e29b99bfd76504ff016d904dbb1acc}{bisecting\_strategy}}\ ==\ \textcolor{stringliteral}{"{}biggest\_inertia"{}}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ scores\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a72028da5358cdf54626f1399a18fd07a}{\_inertia\_per\_cluster}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ X,\ best\_centers,\ best\_labels,\ sample\_weight}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ bisecting\_strategy\ ==\ "{}largest\_cluster"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Using\ minlength\ to\ make\ sure\ that\ we\ have\ the\ counts\ for\ both\ labels\ even}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ if\ all\ samples\ are\ labelled\ 0.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ scores\ =\ np.bincount(best\_labels,\ minlength=2)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ cluster\_to\_bisect.split(best\_labels,\ best\_centers,\ scores)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00361}00361\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00362}00362\ \ \ \ \ \textcolor{preprocessor}{@\_fit\_context(prefer\_skip\_nested\_validation=True)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00363}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_adda5d4572c6afd1f3a1b47a0cd0dcca5}{00363}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_adda5d4572c6afd1f3a1b47a0cd0dcca5}{fit}}(self,\ X,\ y=None,\ sample\_weight=None):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00364}00364\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ bisecting\ k-\/means\ clustering.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00365}00365\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00368}00368\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ X\ :\ \{array-\/like,\ sparse\ matrix\}\ of\ shape\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00369}00369\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Training\ instances\ to\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00371}00371\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ ..\ note::\ The\ data\ will\ be\ converted\ to\ C\ ordering,}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ which\ will\ cause\ a\ memory\ copy}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ the\ given\ data\ is\ not\ C-\/contiguous.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00375}00375\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ y\ :\ Ignored}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Not\ used,\ present\ here\ for\ API\ consistency\ by\ convention.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00378}00378\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\_weight\ :\ array-\/like\ of\ shape\ (n\_samples,),\ default=None}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ weights\ for\ each\ observation\ in\ X.\ If\ None,\ all\ observations}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ are\ assigned\ equal\ weight.\ \`{}sample\_weight\`{}\ is\ not\ used\ during}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ initialization\ if\ \`{}init\`{}\ is\ a\ callable.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00383}00383\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ self}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Fitted\ estimator.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00389}00389\ \ \ \ \ \ \ \ \ X\ =\ validate\_data(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00390}00390\ \ \ \ \ \ \ \ \ \ \ \ \ self,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00391}00391\ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00392}00392\ \ \ \ \ \ \ \ \ \ \ \ \ accept\_sparse=\textcolor{stringliteral}{"{}csr"{}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00393}00393\ \ \ \ \ \ \ \ \ \ \ \ \ dtype=[np.float64,\ np.float32],}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ order=\textcolor{stringliteral}{"{}C"{}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00395}00395\ \ \ \ \ \ \ \ \ \ \ \ \ copy=self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a2799c382563d60bbe8d11392babd15f2}{copy\_x}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ \ \ \ \ accept\_large\_sparse=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_acc8329d33cebd50db8046d28c792142b}{\_check\_params\_vs\_input}}(X)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00400}00400\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a876acb0e594f06ca0965aef2dd779d9a}{\_random\_state}}\ =\ check\_random\_state(self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_ae5e9540e37d4abfec4356351b43d41d3}{random\_state}})}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ sample\_weight\ =\ \_check\_sample\_weight(sample\_weight,\ X,\ dtype=X.dtype)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{\_n\_threads}}\ =\ \_openmp\_effective\_n\_threads()}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00404}00404\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ab2a2ac0b351f5d0ff78675b4fa589329}{algorithm}}\ ==\ \textcolor{stringliteral}{"{}lloyd"{}}\ \textcolor{keywordflow}{or}\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a096dc6f7b4a22fd669bdbff91faef5ca}{n\_clusters}}\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a29ce228790c569db86e9fb202a5504ab}{\_kmeans\_single}}\ =\ \_kmeans\_single\_lloyd}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a3bcf41afe761bd4b6e388d2402ea8f88}{\_check\_mkl\_vcomp}}(X,\ X.shape[0])}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a29ce228790c569db86e9fb202a5504ab}{\_kmeans\_single}}\ =\ \_kmeans\_single\_elkan}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00410}00410\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Subtract\ of\ mean\ of\ X\ for\ more\ accurate\ distance\ computations}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ sp.issparse(X):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a5bac881a42889ec10a56a9a371ac21b4}{\_X\_mean}}\ =\ X.mean(axis=0)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \ \ \ \ X\ -\/=\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a5bac881a42889ec10a56a9a371ac21b4}{\_X\_mean}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00415}00415\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00416}00416\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initialize\ the\ hierarchical\ clusters\ tree}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00417}00417\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ac0534e246947faba81acccba0b9ea8f0}{\_bisecting\_tree}}\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1__BisectingTree}{\_BisectingTree}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ indices=np.arange(X.shape[0]),}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ center=X.mean(axis=0),}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ score=0,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00422}00422\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ x\_squared\_norms\ =\ row\_norms(X,\ squared=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00424}00424\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a096dc6f7b4a22fd669bdbff91faef5ca}{n\_clusters}}\ -\/\ 1):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Chose\ cluster\ to\ bisect}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ cluster\_to\_bisect\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ac0534e246947faba81acccba0b9ea8f0}{\_bisecting\_tree}}.get\_cluster\_to\_bisect()}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00428}00428\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Split\ this\ cluster\ into\ 2\ subclusters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a7a910f612901320c3b1eb05a399f086d}{\_bisect}}(X,\ x\_squared\_norms,\ sample\_weight,\ cluster\_to\_bisect)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00431}00431\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Aggregate\ final\ labels\ and\ centers\ from\ the\ bisecting\ tree}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a23c8dd5f87e99e086493504b1a3a8268}{labels\_}}\ =\ np.full(X.shape[0],\ -\/1,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{cluster\_centers\_}}\ =\ np.empty((self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_a096dc6f7b4a22fd669bdbff91faef5ca}{n\_clusters}},\ X.shape[1]),\ dtype=X.dtype)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00435}00435\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i,\ cluster\_node\ \textcolor{keywordflow}{in}\ enumerate(self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ac0534e246947faba81acccba0b9ea8f0}{\_bisecting\_tree}}.iter\_leaves()):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a23c8dd5f87e99e086493504b1a3a8268}{labels\_}}[cluster\_node.indices]\ =\ i}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{cluster\_centers\_}}[i]\ =\ cluster\_node.center}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00439}00439\ \ \ \ \ \ \ \ \ \ \ \ \ cluster\_node.label\ =\ i\ \ \textcolor{comment}{\#\ label\ final\ clusters\ for\ future\ prediction}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ \ \ \ \ cluster\_node.indices\ =\ \textcolor{keywordtype}{None}\ \ \textcolor{comment}{\#\ release\ memory}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00441}00441\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00442}00442\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Restore\ original\ data}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ sp.issparse(X):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00444}00444\ \ \ \ \ \ \ \ \ \ \ \ \ X\ +=\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a5bac881a42889ec10a56a9a371ac21b4}{\_X\_mean}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00445}00445\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{cluster\_centers\_}}\ +=\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a5bac881a42889ec10a56a9a371ac21b4}{\_X\_mean}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00446}00446\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00447}00447\ \ \ \ \ \ \ \ \ \_inertia\ =\ \_inertia\_sparse\ \textcolor{keywordflow}{if}\ sp.issparse(X)\ \textcolor{keywordflow}{else}\ \_inertia\_dense}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_acf112194a9e6b4c54096d1439bf676a4}{inertia\_}}\ =\ \_inertia(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ \ \ \ \ X,\ sample\_weight,\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{cluster\_centers\_}},\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a23c8dd5f87e99e086493504b1a3a8268}{labels\_}},\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{\_n\_threads}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00450}00450\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00451}00451\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00452}00452\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1base_1_1ClassNamePrefixFeaturesOutMixin_ac6b97c99e9c50c38b8cabdfb587f0daf}{\_n\_features\_out}}\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{cluster\_centers\_}}.shape[0]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00453}00453\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00454}00454\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00455}00455\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00456}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a18c00a533a6d797f9ecd0aae94d49632}{00456}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a18c00a533a6d797f9ecd0aae94d49632}{predict}}(self,\ X):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00457}00457\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Predict\ which\ cluster\ each\ sample\ in\ X\ belongs\ to.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00458}00458\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Prediction\ is\ made\ by\ going\ down\ the\ hierarchical\ tree}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ searching\ of\ closest\ leaf\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00461}00461\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ In\ the\ vector\ quantization\ literature,\ \`{}cluster\_centers\_\`{}\ is\ called}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ code\ book\ and\ each\ value\ returned\ by\ \`{}predict\`{}\ is\ the\ index\ of}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00464}00464\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ closest\ code\ in\ the\ code\ book.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00465}00465\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00467}00467\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ X\ :\ \{array-\/like,\ sparse\ matrix\}\ of\ shape\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ New\ data\ to\ predict.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00470}00470\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ labels\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00474}00474\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Index\ of\ the\ cluster\ each\ sample\ belongs\ to.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ check\_is\_fitted(self)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00477}00477\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ X\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__kmeans_1_1__BaseKMeans_aa297a881754af62ce63fe0655cc3d1f0}{\_check\_test\_data}}(X)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ x\_squared\_norms\ =\ row\_norms(X,\ squared=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sample\ weights\ are\ unused\ but\ necessary\ in\ cython\ helpers}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ sample\_weight\ =\ np.ones\_like(x\_squared\_norms)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00483}00483\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00484}00484\ \ \ \ \ \ \ \ \ labels\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a779ea800ac71b45a2cfda548ad555e1e}{\_predict\_recursive}}(X,\ sample\_weight,\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_ac0534e246947faba81acccba0b9ea8f0}{\_bisecting\_tree}})}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00485}00485\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ labels}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00488}\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a779ea800ac71b45a2cfda548ad555e1e}{00488}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a779ea800ac71b45a2cfda548ad555e1e}{\_predict\_recursive}}(self,\ X,\ sample\_weight,\ cluster\_node):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00489}00489\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Predict\ recursively\ by\ going\ down\ the\ hierarchical\ tree.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00490}00490\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00491}00491\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00492}00492\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00493}00493\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ X\ :\ \{ndarray,\ csr\_matrix\}\ of\ shape\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00494}00494\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ data\ points,\ currently\ assigned\ to\ \`{}cluster\_node\`{},\ to\ predict\ between}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00495}00495\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ the\ subclusters\ of\ this\ node.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00496}00496\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00497}00497\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ sample\_weight\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ weights\ for\ each\ observation\ in\ X.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00499}00499\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00500}00500\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ cluster\_node\ :\ \_BisectingTree\ node\ object}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00501}00501\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ cluster\ node\ of\ the\ hierarchical\ tree.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00502}00502\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ labels\ :\ ndarray\ of\ shape\ (n\_samples,)}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Index\ of\ the\ cluster\ each\ sample\ belongs\ to.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00508}00508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cluster\_node.left\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ cluster\ has\ no\ subcluster.\ Labels\ are\ just\ the\ label\ of\ the\ cluster.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.full(X.shape[0],\ cluster\_node.label,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00511}00511\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Determine\ if\ data\ points\ belong\ to\ the\ left\ or\ right\ subcluster}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00513}00513\ \ \ \ \ \ \ \ \ centers\ =\ np.vstack((cluster\_node.left.center,\ cluster\_node.right.center))}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00514}00514\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(self,\ \textcolor{stringliteral}{"{}\_X\_mean"{}}):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00515}00515\ \ \ \ \ \ \ \ \ \ \ \ \ centers\ +=\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a5bac881a42889ec10a56a9a371ac21b4}{\_X\_mean}}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00516}00516\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00517}00517\ \ \ \ \ \ \ \ \ cluster\_labels\ =\ \_labels\_inertia\_threadpool\_limit(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00518}00518\ \ \ \ \ \ \ \ \ \ \ \ \ X,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ \ \ \ \ sample\_weight,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ centers,}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans}{\_n\_threads}},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00522}00522\ \ \ \ \ \ \ \ \ \ \ \ \ return\_inertia=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00523}00523\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00524}00524\ \ \ \ \ \ \ \ \ mask\ =\ cluster\_labels\ ==\ 0}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00525}00525\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00526}00526\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ the\ labels\ for\ each\ subset\ of\ the\ data\ points.}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ labels\ =\ np.full(X.shape[0],\ -\/1,\ dtype=np.int32)}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00528}00528\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00529}00529\ \ \ \ \ \ \ \ \ labels[mask]\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a779ea800ac71b45a2cfda548ad555e1e}{\_predict\_recursive}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ \ \ \ \ X[mask],\ sample\_weight[mask],\ cluster\_node.left}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00531}00531\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00532}00532\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00533}00533\ \ \ \ \ \ \ \ \ labels[\string~mask]\ =\ self.\mbox{\hyperlink{classsklearn_1_1cluster_1_1__bisect__k__means_1_1BisectingKMeans_a779ea800ac71b45a2cfda548ad555e1e}{\_predict\_recursive}}(}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00534}00534\ \ \ \ \ \ \ \ \ \ \ \ \ X[\string~mask],\ sample\_weight[\string~mask],\ cluster\_node.right}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00535}00535\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00536}00536\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00537}00537\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ labels}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00538}00538\ }
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00539}00539\ \ \ \ \ \textcolor{keyword}{def\ }\_\_sklearn\_tags\_\_(self):}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ tags\ =\ super().\_\_sklearn\_tags\_\_()}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ tags.input\_tags.sparse\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ tags.transformer\_tags.preserves\_dtype\ =\ [\textcolor{stringliteral}{"{}float64"{}},\ \textcolor{stringliteral}{"{}float32"{}}]}
\DoxyCodeLine{\Hypertarget{__bisect__k__means_8py_source_l00543}00543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tags}

\end{DoxyCode}
