\doxysection{popen\+\_\+loky\+\_\+win32.\+py}
\hypertarget{popen__loky__win32_8py_source}{}\label{popen__loky__win32_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/backend/popen\_loky\_win32.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/backend/popen\_loky\_win32.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00002}00002\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00003}00003\ \textcolor{keyword}{import}\ msvcrt}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00004}00004\ \textcolor{keyword}{import}\ \_winapi}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00005}00005\ \textcolor{keyword}{from}\ pickle\ \textcolor{keyword}{import}\ load}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00006}00006\ \textcolor{keyword}{from}\ multiprocessing\ \textcolor{keyword}{import}\ process,\ util}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00007}00007\ \textcolor{keyword}{from}\ multiprocessing.context\ \textcolor{keyword}{import}\ set\_spawning\_popen}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00008}00008\ \textcolor{keyword}{from}\ multiprocessing.popen\_spawn\_win32\ \textcolor{keyword}{import}\ Popen\ \textcolor{keyword}{as}\ \_Popen}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00010}00010\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ reduction,\ spawn}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00013}00013\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{"{}Popen"{}}]}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00015}00015\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00016}00016\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00017}00017\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00020}00020\ \textcolor{keyword}{def\ }\_path\_eq(p1,\ p2):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00021}00021\ \ \ \ \ \textcolor{keywordflow}{return}\ p1\ ==\ p2\ \textcolor{keywordflow}{or}\ os.path.normcase(p1)\ ==\ os.path.normcase(p2)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00024}00024\ WINENV\ =\ hasattr(sys,\ \textcolor{stringliteral}{"{}\_base\_executable"{}})\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ \_path\_eq(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00025}00025\ \ \ \ \ sys.executable,\ sys.\_base\_executable}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00026}00026\ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00029}00029\ \textcolor{keyword}{def\ }\_close\_handles(*handles):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{for}\ handle\ \textcolor{keywordflow}{in}\ handles:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \_winapi.CloseHandle(handle)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00034}00034\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00035}00035\ \textcolor{comment}{\#\ We\ define\ a\ Popen\ class\ similar\ to\ the\ one\ from\ subprocess,\ but}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00036}00036\ \textcolor{comment}{\#\ whose\ constructor\ takes\ a\ process\ object\ as\ its\ argument.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00037}00037\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00040}\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen}{00040}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen}{Popen}}(\mbox{\hyperlink{class__Popen}{\_Popen}}):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00041}00041\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ Start\ a\ subprocess\ to\ run\ the\ code\ of\ a\ process\ object.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00043}00043\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ We\ differ\ from\ cpython\ implementation\ with\ the\ way\ we\ handle\ environment}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ variables,\ in\ order\ to\ be\ able\ to\ modify\ then\ in\ the\ child\ processes\ before}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ importing\ any\ library,\ in\ order\ to\ control\ the\ number\ of\ threads\ in\ C-\/level}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ threadpools.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00048}00048\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ We\ also\ use\ the\ loky\ preparation\ data,\ in\ particular\ to\ handle\ main\_module}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ inits\ and\ the\ loky\ resource\ tracker.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00053}00053\ \ \ \ \ method\ =\ \textcolor{stringliteral}{"{}loky"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00055}00055\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ process\_obj):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ prep\_data\ =\ spawn.get\_preparation\_data(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ process\_obj.\_name,\ getattr(process\_obj,\ \textcolor{stringliteral}{"{}init\_main\_module"{}},\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ read\ end\ of\ pipe\ will\ be\ duplicated\ by\ the\ child\ process}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ -\/-\/\ see\ spawn\_main()\ in\ spawn.py.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bpo-\/33929:\ Previously,\ the\ read\ end\ of\ pipe\ was\ "{}stolen"{}\ by\ the\ child}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ process,\ but\ it\ leaked\ a\ handle\ if\ the\ child\ process\ had\ been}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ terminated\ before\ it\ could\ steal\ the\ handle\ from\ the\ parent\ process.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ rhandle,\ whandle\ =\ \_winapi.CreatePipe(\textcolor{keywordtype}{None},\ 0)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ wfd\ =\ msvcrt.open\_osfhandle(whandle,\ 0)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ cmd\ =\ \mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_ab1cd54638754dfc3a4ad0bca5f199540}{get\_command\_line}}(parent\_pid=os.getpid(),\ pipe\_handle=rhandle)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ python\_exe\ =\ spawn.get\_executable()}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ copy\ the\ environment\ variables\ to\ set\ in\ the\ child\ process}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ child\_env\ =\ \{**os.environ,\ **process\_obj.env\}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bpo-\/35797:\ When\ running\ in\ a\ venv,\ we\ bypass\ the\ redirect}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ executor\ and\ launch\ our\ base\ Python.}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ WINENV\ \textcolor{keywordflow}{and}\ \_path\_eq(python\_exe,\ sys.executable):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ cmd[0]\ =\ python\_exe\ =\ sys.\_base\_executable}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ child\_env[\textcolor{stringliteral}{"{}\_\_PYVENV\_LAUNCHER\_\_"{}}]\ =\ sys.executable}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ cmd\ =\ \textcolor{stringliteral}{"{}\ "{}}.join(f\textcolor{stringliteral}{'"{}\{x\}"{}'}\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ cmd)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(wfd,\ \textcolor{stringliteral}{"{}wb"{}})\ \textcolor{keyword}{as}\ to\_child:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ start\ process}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hp,\ ht,\ pid,\ \_\ =\ \_winapi.CreateProcess(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ python\_exe,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmd,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ child\_env,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_winapi.CloseHandle(ht)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ BaseException:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_winapi.CloseHandle(rhandle)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ set\ attributes\ of\ self}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_aa0e135939ebd43ad963db08d13f95abd}{pid}}\ =\ pid}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_a55e217142fec2339d3a5d1d772eb7fa4}{returncode}}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_ac32bce3bcd5d587837a2ab1c3049b046}{\_handle}}\ =\ hp}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_ad40762cf05507b68d49f87e3e3973903}{sentinel}}\ =\ int(hp)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_ac11584b1214cd3e11aa589688ed30790}{finalizer}}\ =\ util.Finalize(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self,\ \_close\_handles,\ (self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_1_1Popen_ad40762cf05507b68d49f87e3e3973903}{sentinel}},\ int(rhandle))}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ send\ information\ to\ child}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ set\_spawning\_popen(self)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reduction.dump(prep\_data,\ to\_child)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reduction.dump(process\_obj,\ to\_child)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ set\_spawning\_popen(\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00120}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_ab1cd54638754dfc3a4ad0bca5f199540}{00120}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_ab1cd54638754dfc3a4ad0bca5f199540}{get\_command\_line}}(pipe\_handle,\ parent\_pid,\ **kwds):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00121}00121\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Returns\ prefix\ of\ command\ line\ used\ for\ spawning\ a\ child\ process."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00122}00122\ \ \ \ \ \textcolor{keywordflow}{if}\ getattr(sys,\ \textcolor{stringliteral}{"{}frozen"{}},\ \textcolor{keyword}{False}):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [sys.executable,\ \textcolor{stringliteral}{"{}-\/-\/multiprocessing-\/fork"{}},\ pipe\_handle]}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ prog\ =\ (}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}from\ joblib.externals.loky.backend.popen\_loky\_win32\ import\ main;\ "{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}main(pipe\_handle=\{pipe\_handle\},\ parent\_pid=\{parent\_pid\})"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ opts\ =\ util.\_args\_from\_interpreter\_flags()}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ spawn.get\_executable(),}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ *opts,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/c"{}},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ prog,}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/-\/multiprocessing-\/fork"{}},}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00139}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_a5d1dabbf75bf977175128e784f0575e2}{00139}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_a5d1dabbf75bf977175128e784f0575e2}{is\_forking}}(argv):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00140}00140\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ whether\ commandline\ indicates\ we\ are\ forking."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00141}00141\ \ \ \ \ \textcolor{keywordflow}{if}\ len(argv)\ >=\ 2\ \textcolor{keywordflow}{and}\ argv[1]\ ==\ \textcolor{stringliteral}{"{}-\/-\/multiprocessing-\/fork"{}}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00143}00143\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00147}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_ad9aab5c36aa414a89611fb6edd3b39cb}{00147}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacemain}{main}}(pipe\_handle,\ parent\_pid=None):}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00148}00148\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Run\ code\ specified\ by\ data\ received\ over\ pipe."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00149}00149\ \ \ \ \ \textcolor{keyword}{assert}\ \mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1backend_1_1popen__loky__win32_a5d1dabbf75bf977175128e784f0575e2}{is\_forking}}(sys.argv),\ \textcolor{stringliteral}{"{}Not\ forking"{}}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00151}00151\ \ \ \ \ \textcolor{keywordflow}{if}\ parent\_pid\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ source\_process\ =\ \_winapi.OpenProcess(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ \_winapi.SYNCHRONIZE\ |\ \_winapi.PROCESS\_DUP\_HANDLE,\ \textcolor{keyword}{False},\ parent\_pid}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00155}00155\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ source\_process\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00157}00157\ \ \ \ \ new\_handle\ =\ reduction.duplicate(}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ pipe\_handle,\ source\_process=source\_process}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00159}00159\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00160}00160\ \ \ \ \ fd\ =\ msvcrt.open\_osfhandle(new\_handle,\ os.O\_RDONLY)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00161}00161\ \ \ \ \ parent\_sentinel\ =\ source\_process}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00163}00163\ \ \ \ \ \textcolor{keyword}{with}\ os.fdopen(fd,\ \textcolor{stringliteral}{"{}rb"{}},\ closefd=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ from\_parent:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ process.current\_process().\_inheriting\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ preparation\_data\ =\ load(from\_parent)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ spawn.prepare(preparation\_data,\ parent\_sentinel)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ self\ =\ load(from\_parent)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ del\ process.current\_process().\_inheriting}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00172}00172\ \ \ \ \ exitcode\ =\ self.\_bootstrap(parent\_sentinel)}
\DoxyCodeLine{\Hypertarget{popen__loky__win32_8py_source_l00173}00173\ \ \ \ \ sys.exit(exitcode)}

\end{DoxyCode}
