\doxysection{qp\+\_\+subproblem.\+py}
\hypertarget{qp__subproblem_8py_source}{}\label{qp__subproblem_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_trustregion\_constr/qp\_subproblem.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/\_trustregion\_constr/qp\_subproblem.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Equality-\/constrained\ quadratic\ programming\ solvers."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1sparse}{scipy.sparse}}\ \textcolor{keyword}{import}\ (linalg,\ bmat,\ csc\_matrix)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00004}00004\ \textcolor{keyword}{from}\ math\ \textcolor{keyword}{import}\ copysign}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00005}00005\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1linalg}{numpy.linalg}}\ \textcolor{keyword}{import}\ norm}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00008}00008\ \_\_all\_\_\ =\ [}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00009}00009\ \ \ \ \ \textcolor{stringliteral}{'eqp\_kktfact'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00010}00010\ \ \ \ \ \textcolor{stringliteral}{'sphere\_intersections'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00011}00011\ \ \ \ \ \textcolor{stringliteral}{'box\_intersections'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00012}00012\ \ \ \ \ \textcolor{stringliteral}{'box\_sphere\_intersections'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00013}00013\ \ \ \ \ \textcolor{stringliteral}{'inside\_box\_boundaries'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00014}00014\ \ \ \ \ \textcolor{stringliteral}{'modified\_dogleg'},}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00015}00015\ \ \ \ \ \textcolor{stringliteral}{'projected\_cg'}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00016}00016\ ]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00019}00019\ \textcolor{comment}{\#\ For\ comparison\ with\ the\ projected\ CG}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00020}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a589001114b412afb46c5040276ff789a}{00020}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a589001114b412afb46c5040276ff789a}{eqp\_kktfact}}(H,\ c,\ A,\ b):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00021}00021\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Solve\ equality-\/constrained\ quadratic\ programming\ (EQP)\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00022}00022\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ Solve\ \`{}\`{}min\ 1/2\ x.T\ H\ x\ +\ x.t\ c\`{}\`{}\ subject\ to\ \`{}\`{}A\ x\ +\ b\ =\ 0\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ using\ direct\ factorization\ of\ the\ KKT\ system.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00025}00025\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ H\ :\ sparse\ matrix,\ shape\ (n,\ n)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Hessian\ matrix\ of\ the\ EQP\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ c\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Gradient\ of\ the\ quadratic\ objective\ function.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ A\ :\ sparse\ matrix}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Jacobian\ matrix\ of\ the\ EQP\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ b\ :\ array\_like,\ shape\ (m,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right-\/hand\ side\ of\ the\ constraint\ equation.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00036}00036\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Solution\ of\ the\ KKT\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ lagrange\_multipliers\ :\ ndarray,\ shape\ (m,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lagrange\ multipliers\ of\ the\ KKT\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00044}00044\ \ \ \ \ n,\ =\ np.shape(c)\ \ \textcolor{comment}{\#\ Number\ of\ parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00045}00045\ \ \ \ \ m,\ =\ np.shape(b)\ \ \textcolor{comment}{\#\ Number\ of\ constraints}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00047}00047\ \ \ \ \ \textcolor{comment}{\#\ Karush-\/Kuhn-\/Tucker\ matrix\ of\ coefficients.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00048}00048\ \ \ \ \ \textcolor{comment}{\#\ Defined\ as\ in\ Nocedal/Wright\ "{}Numerical}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00049}00049\ \ \ \ \ \textcolor{comment}{\#\ Optimization"{}\ p.452\ in\ Eq.\ (16.4).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00050}00050\ \ \ \ \ kkt\_matrix\ =\ \mbox{\hyperlink{classscipy_1_1sparse_1_1__csc_1_1csc__matrix}{csc\_matrix}}(bmat([[H,\ A.T],\ [A,\ \textcolor{keywordtype}{None}]]))}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00051}00051\ \ \ \ \ \textcolor{comment}{\#\ Vector\ of\ coefficients.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00052}00052\ \ \ \ \ kkt\_vec\ =\ np.hstack([-\/c,\ -\/b])}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00054}00054\ \ \ \ \ \textcolor{comment}{\#\ TODO:\ Use\ a\ symmetric\ indefinite\ factorization}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00055}00055\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ to\ solve\ the\ system\ twice\ as\ fast\ (because}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00056}00056\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ of\ the\ symmetry).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00057}00057\ \ \ \ \ lu\ =\ linalg.splu(kkt\_matrix)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00058}00058\ \ \ \ \ kkt\_sol\ =\ lu.solve(kkt\_vec)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00059}00059\ \ \ \ \ x\ =\ kkt\_sol[:n]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00060}00060\ \ \ \ \ lagrange\_multipliers\ =\ -\/kkt\_sol[n:n+m]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00062}00062\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ lagrange\_multipliers}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00065}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a72bdbfec9996e131841cfb3d86f63be3}{00065}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a72bdbfec9996e131841cfb3d86f63be3}{sphere\_intersections}}(z,\ d,\ trust\_radius,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entire\_line=False):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00067}00067\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Find\ the\ intersection\ between\ segment\ (or\ line)\ and\ spherical\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00068}00068\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ Find\ the\ intersection\ between\ the\ segment\ (or\ line)\ defined\ by\ the}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ parametric\ \ equation\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ and\ the\ ball}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}||x||\ <=\ trust\_radius\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00072}00072\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00073}00073\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ z\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ point.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ d\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Direction.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ trust\_radius\ :\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00080}00080\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Ball\ radius.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ entire\_line\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ the\ function\ returns\ the\ intersection\ between\ the\ line}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ (\`{}\`{}t\`{}\`{}\ can\ assume\ any\ value)\ and\ the\ ball}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}||x||\ <=\ trust\_radius\`{}\`{}.\ When\ \`{}\`{}False\`{}\`{},\ the\ function\ returns\ the\ intersection}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ between\ the\ segment\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{},\ \`{}\`{}0\ <=\ t\ <=\ 1\`{}\`{},\ and\ the\ ball.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00086}00086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ ta,\ tb\ :\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ line/segment\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ is\ inside\ the\ ball\ for}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ \`{}\`{}ta\ <=\ t\ <=\ tb\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ intersect\ :\ bool}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00093}00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ there\ is\ a\ intersection\ between\ the\ line/segment}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ the\ sphere.\ On\ the\ other\ hand,\ when\ \`{}\`{}False\`{}\`{},\ there\ is\ no}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00095}00095\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ intersection.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00097}00097\ \ \ \ \ \textcolor{comment}{\#\ Special\ case\ when\ d=0}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00098}00098\ \ \ \ \ \textcolor{keywordflow}{if}\ norm(d)\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0,\ 0,\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00100}00100\ \ \ \ \ \textcolor{comment}{\#\ Check\ for\ inf\ trust\_radius}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00101}00101\ \ \ \ \ \textcolor{keywordflow}{if}\ np.isinf(trust\_radius):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ entire\_line:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ -\/np.inf}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ np.inf}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ 1}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ta,\ tb,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00111}00111\ \ \ \ \ a\ =\ np.dot(d,\ d)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00112}00112\ \ \ \ \ b\ =\ 2\ *\ np.dot(z,\ d)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00113}00113\ \ \ \ \ c\ =\ np.dot(z,\ z)\ -\/\ trust\_radius**2}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00114}00114\ \ \ \ \ discriminant\ =\ b*b\ -\/\ 4*a*c}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{if}\ discriminant\ <\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0,\ 0,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00118}00118\ \ \ \ \ sqrt\_discriminant\ =\ np.sqrt(discriminant)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00120}00120\ \ \ \ \ \textcolor{comment}{\#\ The\ following\ calculation\ is\ mathematically}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00121}00121\ \ \ \ \ \textcolor{comment}{\#\ equivalent\ to:}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00122}00122\ \ \ \ \ \textcolor{comment}{\#\ ta\ =\ (-\/b\ -\/\ sqrt\_discriminant)\ /\ (2*a)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00123}00123\ \ \ \ \ \textcolor{comment}{\#\ tb\ =\ (-\/b\ +\ sqrt\_discriminant)\ /\ (2*a)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00124}00124\ \ \ \ \ \textcolor{comment}{\#\ but\ produce\ smaller\ round\ off\ errors.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00125}00125\ \ \ \ \ \textcolor{comment}{\#\ Look\ at\ Matrix\ Computation\ p.97}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00126}00126\ \ \ \ \ \textcolor{comment}{\#\ for\ a\ better\ justification.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00127}00127\ \ \ \ \ aux\ =\ b\ +\ copysign(sqrt\_discriminant,\ b)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00128}00128\ \ \ \ \ ta\ =\ -\/aux\ /\ (2*a)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00129}00129\ \ \ \ \ tb\ =\ -\/2*c\ /\ aux}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00130}00130\ \ \ \ \ ta,\ tb\ =\ sorted([ta,\ tb])}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00132}00132\ \ \ \ \ \textcolor{keywordflow}{if}\ entire\_line:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00134}00134\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Checks\ to\ see\ if\ intersection\ happens}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ within\ vectors\ length.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tb\ <\ 0\ \textcolor{keywordflow}{or}\ ta\ >\ 1:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Restrict\ intersection\ interval}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ between\ 0\ and\ 1.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ max(0,\ ta)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ min(1,\ tb)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00148}00148\ \ \ \ \ \textcolor{keywordflow}{return}\ ta,\ tb,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00151}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a283c8c5342dfe1a3c2927a2c27d9d3f0}{00151}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a283c8c5342dfe1a3c2927a2c27d9d3f0}{box\_intersections}}(z,\ d,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entire\_line=False):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00153}00153\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Find\ the\ intersection\ between\ segment\ (or\ line)\ and\ box\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00154}00154\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ Find\ the\ intersection\ between\ the\ segment\ (or\ line)\ defined\ by\ the}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00156}00156\ \textcolor{stringliteral}{\ \ \ \ parametric\ \ equation\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ and\ the\ rectangular\ box}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}lb\ <=\ x\ <=\ ub\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00158}00158\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ z\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ point.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ d\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Direction.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ lb\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lower\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.\ Used}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00167}00167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ delimit\ the\ rectangular\ box.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ ub\ :\ array\_like,\ shape\ (n,\ )}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.\ Used}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ delimit\ the\ rectangular\ box.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00171}00171\ \textcolor{stringliteral}{\ \ \ \ entire\_line\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ the\ function\ returns\ the\ intersection\ between\ the\ line}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ (\`{}\`{}t\`{}\`{}\ can\ assume\ any\ value)\ and\ the\ rectangular}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ box.\ When\ \`{}\`{}False\`{}\`{},\ the\ function\ returns\ the\ intersection\ between\ the\ segment}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00175}00175\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{},\ \`{}\`{}0\ <=\ t\ <=\ 1\`{}\`{},\ and\ the\ rectangular\ box.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00176}00176\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00177}00177\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ ta,\ tb\ :\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ line/segment\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ is\ inside\ the\ box\ for}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ \`{}\`{}ta\ <=\ t\ <=\ tb\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ intersect\ :\ bool}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ there\ is\ a\ intersection\ between\ the\ line\ (or\ segment)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ the\ rectangular\ box.\ On\ the\ other\ hand,\ when\ \`{}\`{}False\`{}\`{},\ there\ is\ no}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ intersection.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00186}00186\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00187}00187\ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ it\ is\ a\ numpy\ array}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00188}00188\ \ \ \ \ z\ =\ np.asarray(z)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00189}00189\ \ \ \ \ d\ =\ np.asarray(d)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00190}00190\ \ \ \ \ lb\ =\ np.asarray(lb)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00191}00191\ \ \ \ \ ub\ =\ np.asarray(ub)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00192}00192\ \ \ \ \ \textcolor{comment}{\#\ Special\ case\ when\ d=0}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00193}00193\ \ \ \ \ \textcolor{keywordflow}{if}\ norm(d)\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0,\ 0,\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00196}00196\ \ \ \ \ \textcolor{comment}{\#\ Get\ values\ for\ which\ d==0}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00197}00197\ \ \ \ \ zero\_d\ =\ (d\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00198}00198\ \ \ \ \ \textcolor{comment}{\#\ If\ the\ boundaries\ are\ not\ satisfied\ for\ some\ coordinate}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00199}00199\ \ \ \ \ \textcolor{comment}{\#\ for\ which\ "{}d"{}\ is\ zero,\ there\ is\ no\ box-\/line\ intersection.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00200}00200\ \ \ \ \ \textcolor{keywordflow}{if}\ (z[zero\_d]\ <\ lb[zero\_d]).any()\ \textcolor{keywordflow}{or}\ (z[zero\_d]\ >\ ub[zero\_d]).any():}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0,\ 0,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00203}00203\ \ \ \ \ \textcolor{comment}{\#\ Remove\ values\ for\ which\ d\ is\ zero}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00204}00204\ \ \ \ \ not\_zero\_d\ =\ np.logical\_not(zero\_d)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00205}00205\ \ \ \ \ z\ =\ z[not\_zero\_d]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00206}00206\ \ \ \ \ d\ =\ d[not\_zero\_d]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00207}00207\ \ \ \ \ lb\ =\ lb[not\_zero\_d]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00208}00208\ \ \ \ \ ub\ =\ ub[not\_zero\_d]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00209}00209\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00210}00210\ \ \ \ \ \textcolor{comment}{\#\ Find\ a\ series\ of\ intervals\ (t\_lb[i],\ t\_ub[i]).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00211}00211\ \ \ \ \ t\_lb\ =\ (lb-\/z)\ /\ d}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00212}00212\ \ \ \ \ t\_ub\ =\ (ub-\/z)\ /\ d}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00213}00213\ \ \ \ \ \textcolor{comment}{\#\ Get\ the\ intersection\ of\ all\ those\ intervals.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00214}00214\ \ \ \ \ ta\ =\ max(np.minimum(t\_lb,\ t\_ub))}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00215}00215\ \ \ \ \ tb\ =\ min(np.maximum(t\_lb,\ t\_ub))}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00216}00216\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00217}00217\ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ intersection\ is\ feasible}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00218}00218\ \ \ \ \ \textcolor{keywordflow}{if}\ ta\ <=\ tb:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00220}00220\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00222}00222\ \ \ \ \ \textcolor{comment}{\#\ Checks\ to\ see\ if\ intersection\ happens\ within\ vectors\ length.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00223}00223\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ entire\_line:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tb\ <\ 0\ \textcolor{keywordflow}{or}\ ta\ >\ 1:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Restrict\ intersection\ interval\ between\ 0\ and\ 1.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ ta\ =\ max(0,\ ta)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ tb\ =\ min(1,\ tb)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00232}00232\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00233}00233\ \ \ \ \ \textcolor{keywordflow}{return}\ ta,\ tb,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00235}00235\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00236}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{00236}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(z,\ d,\ lb,\ ub,\ trust\_radius,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entire\_line=False,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extra\_info=False):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00239}00239\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Find\ the\ intersection\ between\ segment\ (or\ line)\ and\ box/sphere\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00240}00240\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ Find\ the\ intersection\ between\ the\ segment\ (or\ line)\ defined\ by\ the}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ parametric\ \ equation\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{},\ the\ rectangular\ box}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}lb\ <=\ x\ <=\ ub\`{}\`{}\ and\ the\ ball\ \`{}\`{}||x||\ <=\ trust\_radius\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00244}00244\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ z\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Initial\ point.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00249}00249\ \textcolor{stringliteral}{\ \ \ \ d\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Direction.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00251}00251\ \textcolor{stringliteral}{\ \ \ \ lb\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lower\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.\ Used}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ delimit\ the\ rectangular\ box.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ ub\ :\ array\_like,\ shape\ (n,\ )}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.\ Used}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ delimit\ the\ rectangular\ box.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ trust\_radius\ :\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Ball\ radius.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ entire\_line\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ the\ function\ returns\ the\ intersection\ between\ the\ line}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ (\`{}\`{}t\`{}\`{}\ can\ assume\ any\ value)\ and\ the\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}False\`{}\`{},\ the\ function\ returns\ the\ intersection\ between\ the\ segment}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{},\ \`{}\`{}0\ <=\ t\ <=\ 1\`{}\`{}\ and\ the\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ extra\_info\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ the\ function\ returns\ \`{}\`{}intersect\_sphere\`{}\`{}\ and\ \`{}\`{}intersect\_box\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00266}00266\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ ta,\ tb\ :\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ line/segment\ \`{}\`{}x(t)\ =\ z\ +\ t*d\`{}\`{}\ is\ inside\ the\ rectangular\ box\ and}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ inside\ the\ ball\ for\ \`{}\`{}ta\ <=\ t\ <=\ tb\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ intersect\ :\ bool}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00273}00273\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}True\`{}\`{},\ there\ is\ a\ intersection\ between\ the\ line\ (or\ segment)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ and\ both\ constraints.\ On\ the\ other\ hand,\ when\ \`{}\`{}False\`{}\`{},\ there\ is\ no}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ intersection.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ sphere\_info\ :\ dict,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Dictionary\ \`{}\`{}\{ta,\ tb,\ intersect\}\`{}\`{}\ containing\ the\ interval\ \`{}\`{}[ta,\ tb]\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00278}00278\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ which\ the\ line\ intercepts\ the\ ball.\ And\ a\ boolean\ value\ indicating}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00279}00279\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ whether\ the\ sphere\ is\ intersected\ by\ the\ line.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ box\_info\ :\ dict,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Dictionary\ \`{}\`{}\{ta,\ tb,\ intersect\}\`{}\`{}\ containing\ the\ interval\ \`{}\`{}[ta,\ tb]\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ which\ the\ line\ intercepts\ the\ box.\ And\ a\ boolean\ value\ indicating}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00283}00283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ whether\ the\ box\ is\ intersected\ by\ the\ line.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00285}00285\ \ \ \ \ ta\_b,\ tb\_b,\ intersect\_b\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a283c8c5342dfe1a3c2927a2c27d9d3f0}{box\_intersections}}(z,\ d,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entire\_line)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00287}00287\ \ \ \ \ ta\_s,\ tb\_s,\ intersect\_s\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a72bdbfec9996e131841cfb3d86f63be3}{sphere\_intersections}}(z,\ d,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ entire\_line)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00290}00290\ \ \ \ \ ta\ =\ np.maximum(ta\_b,\ ta\_s)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00291}00291\ \ \ \ \ tb\ =\ np.minimum(tb\_b,\ tb\_s)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00292}00292\ \ \ \ \ \textcolor{keywordflow}{if}\ intersect\_b\ \textcolor{keywordflow}{and}\ intersect\_s\ \textcolor{keywordflow}{and}\ ta\ <=\ tb:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00294}00294\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ intersect\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00296}00296\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00297}00297\ \ \ \ \ \textcolor{keywordflow}{if}\ extra\_info:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ sphere\_info\ =\ \{\textcolor{stringliteral}{'ta'}:\ ta\_s,\ \textcolor{stringliteral}{'tb'}:\ tb\_s,\ \textcolor{stringliteral}{'intersect'}:\ intersect\_s\}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ box\_info\ =\ \{\textcolor{stringliteral}{'ta'}:\ ta\_b,\ \textcolor{stringliteral}{'tb'}:\ tb\_b,\ \textcolor{stringliteral}{'intersect'}:\ intersect\_b\}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ta,\ tb,\ intersect,\ sphere\_info,\ box\_info}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00301}00301\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ta,\ tb,\ intersect}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00303}00303\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00304}00304\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00305}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_acac0fddf9aafcd85ea23e093354ce79a}{00305}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_acac0fddf9aafcd85ea23e093354ce79a}{inside\_box\_boundaries}}(x,\ lb,\ ub):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00306}00306\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ if\ lb\ <=\ x\ <=\ ub."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00307}00307\ \ \ \ \ \textcolor{keywordflow}{return}\ (lb\ <=\ x).all()\ \textcolor{keywordflow}{and}\ (x\ <=\ ub).all()}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00308}00308\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00310}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_ac51b9ac5fcaa6233d692695bc0bbea9b}{00310}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_ac51b9ac5fcaa6233d692695bc0bbea9b}{reinforce\_box\_boundaries}}(x,\ lb,\ ub):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00311}00311\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ clipped\ value\ of\ x"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00312}00312\ \ \ \ \ \textcolor{keywordflow}{return}\ np.minimum(np.maximum(x,\ lb),\ ub)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00314}00314\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00315}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_aab64eacd71d3bb3804fbc14244451862}{00315}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_aab64eacd71d3bb3804fbc14244451862}{modified\_dogleg}}(A,\ Y,\ b,\ trust\_radius,\ lb,\ ub):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00316}00316\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Approximately\ \ minimize\ \`{}\`{}1/2*||\ A\ x\ +\ b\ ||\string^2\`{}\`{}\ inside\ trust-\/region.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00317}00317\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ Approximately\ solve\ the\ problem\ of\ minimizing\ \`{}\`{}1/2*||\ A\ x\ +\ b\ ||\string^2\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ subject\ to\ \`{}\`{}||x||\ <\ Delta\`{}\`{}\ and\ \`{}\`{}lb\ <=\ x\ <=\ ub\`{}\`{}\ using\ a\ modification}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ of\ the\ classical\ dogleg\ approach.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00321}00321\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ A\ :\ LinearOperator\ (or\ sparse\ matrix\ or\ ndarray),\ shape\ (m,\ n)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Matrix\ \`{}\`{}A\`{}\`{}\ in\ the\ minimization\ problem.\ It\ should\ have}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ dimension\ \`{}\`{}(m,\ n)\`{}\`{}\ such\ that\ \`{}\`{}m\ <\ n\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ Y\ :\ LinearOperator\ (or\ sparse\ matrix\ or\ ndarray),\ shape\ (n,\ m)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ LinearOperator\ that\ apply\ the\ projection\ matrix}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}Q\ =\ A.T\ inv(A\ A.T)\`{}\`{}\ to\ the\ vector.\ The\ obtained\ vector}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}y\ =\ Q\ x\`{}\`{}\ being\ the\ minimum\ norm\ solution\ of\ \`{}\`{}A\ y\ =\ x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ b\ :\ array\_like,\ shape\ (m,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Vector\ \`{}\`{}b\`{}\`{}in\ the\ minimization\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ trust\_radius:\ float}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Trust\ radius\ to\ be\ considered.\ Delimits\ a\ sphere\ boundary}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ to\ the\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ lb\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lower\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ It\ is\ expected\ that\ \`{}\`{}lb\ <=\ 0\`{}\`{},\ otherwise\ the\ algorithm}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ may\ fail.\ If\ \`{}\`{}lb[i]\ =\ -\/Inf\`{}\`{},\ the\ lower}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bound\ for\ the\ ith\ component\ is\ just\ ignored.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ ub\ :\ array\_like,\ shape\ (n,\ )}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ It\ is\ expected\ that\ \`{}\`{}ub\ >=\ 0\`{}\`{},\ otherwise\ the\ algorithm}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ may\ fail.\ If\ \`{}\`{}ub[i]\ =\ Inf\`{}\`{},\ the\ upper\ bound\ for\ the\ ith}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ component\ is\ just\ ignored.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00346}00346\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00350}00350\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Solution\ to\ the\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00351}00351\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ Based\ on\ implementations\ described\ in\ pp.\ 885-\/886\ from\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00355}00355\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00358}00358\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Byrd,\ Richard\ H.,\ Mary\ E.\ Hribar,\ and\ Jorge\ Nocedal.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ "{}An\ interior\ point\ algorithm\ for\ large-\/scale\ nonlinear}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ programming."{}\ SIAM\ Journal\ on\ Optimization\ 9.4\ (1999):\ 877-\/900.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00362}00362\ \ \ \ \ \textcolor{comment}{\#\ Compute\ minimum\ norm\ minimizer\ of\ 1/2*||\ A\ x\ +\ b\ ||\string^2.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00363}00363\ \ \ \ \ newton\_point\ =\ -\/Y.dot(b)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00364}00364\ \ \ \ \ \textcolor{comment}{\#\ Check\ for\ interior\ point}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00365}00365\ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_acac0fddf9aafcd85ea23e093354ce79a}{inside\_box\_boundaries}}(newton\_point,\ lb,\ ub)\ \ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00366}00366\ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ norm(newton\_point)\ <=\ trust\_radius:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ x\ =\ newton\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00369}00369\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00370}00370\ \ \ \ \ \textcolor{comment}{\#\ Compute\ gradient\ vector\ \`{}\`{}g\ =\ A.T\ b``}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00371}00371\ \ \ \ \ g\ =\ A.T.dot(b)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00372}00372\ \ \ \ \ \textcolor{comment}{\#\ Compute\ Cauchy\ point}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00373}00373\ \ \ \ \ \textcolor{comment}{\#\ \`{}cauchy\_point\ =\ g.T\ g\ /\ (g.T\ A.T\ A\ g)``.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00374}00374\ \ \ \ \ A\_g\ =\ A.dot(g)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00375}00375\ \ \ \ \ cauchy\_point\ =\ -\/np.dot(g,\ g)\ /\ np.dot(A\_g,\ A\_g)\ *\ g}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00376}00376\ \ \ \ \ \textcolor{comment}{\#\ Origin}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00377}00377\ \ \ \ \ origin\_point\ =\ np.zeros\_like(cauchy\_point)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00378}00378\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00379}00379\ \ \ \ \ \textcolor{comment}{\#\ Check\ the\ segment\ between\ cauchy\_point\ and\ newton\_point}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00380}00380\ \ \ \ \ \textcolor{comment}{\#\ for\ a\ possible\ solution.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00381}00381\ \ \ \ \ z\ =\ cauchy\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00382}00382\ \ \ \ \ p\ =\ newton\_point\ -\/\ cauchy\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00383}00383\ \ \ \ \ \_,\ alpha,\ intersect\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(z,\ p,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00384}00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00385}00385\ \ \ \ \ \textcolor{keywordflow}{if}\ intersect:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00386}00386\ \ \ \ \ \ \ \ \ x1\ =\ z\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00387}00387\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00388}00388\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ the\ segment\ between\ the\ origin\ and\ cauchy\_point}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00389}00389\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ a\ possible\ solution.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00390}00390\ \ \ \ \ \ \ \ \ z\ =\ origin\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00391}00391\ \ \ \ \ \ \ \ \ p\ =\ cauchy\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00392}00392\ \ \ \ \ \ \ \ \ \_,\ alpha,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(z,\ p,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00393}00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00394}00394\ \ \ \ \ \ \ \ \ x1\ =\ z\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00395}00395\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00396}00396\ \ \ \ \ \textcolor{comment}{\#\ Check\ the\ segment\ between\ origin\ and\ newton\_point}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00397}00397\ \ \ \ \ \textcolor{comment}{\#\ for\ a\ possible\ solution.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00398}00398\ \ \ \ \ z\ =\ origin\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00399}00399\ \ \ \ \ p\ =\ newton\_point}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00400}00400\ \ \ \ \ \_,\ alpha,\ \_\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(z,\ p,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00402}00402\ \ \ \ \ x2\ =\ z\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00403}00403\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00404}00404\ \ \ \ \ \textcolor{comment}{\#\ Return\ the\ best\ solution\ among\ x1\ and\ x2.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00405}00405\ \ \ \ \ \textcolor{keywordflow}{if}\ norm(A.dot(x1)\ +\ b)\ <\ norm(A.dot(x2)\ +\ b):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x1}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00407}00407\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x2}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00409}00409\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00410}00410\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00411}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a4cee5152087a4e9ceab1a80f52d258f3}{00411}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a4cee5152087a4e9ceab1a80f52d258f3}{projected\_cg}}(H,\ c,\ Z,\ Y,\ b,\ trust\_radius=np.inf,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lb=None,\ ub=None,\ tol=None,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max\_iter=None,\ max\_infeasible\_iter=None,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\_all=False):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00415}00415\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Solve\ EQP\ problem\ with\ projected\ CG\ method.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00416}00416\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ Solve\ equality-\/constrained\ quadratic\ programming\ problem}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}min\ 1/2\ x.T\ H\ x\ +\ x.t\ c\`{}\`{}\ \ subject\ to\ \`{}\`{}A\ x\ +\ b\ =\ 0\`{}\`{}\ and,}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00419}00419\ \textcolor{stringliteral}{\ \ \ \ possibly,\ to\ trust\ region\ constraints\ \`{}\`{}||x||\ <\ trust\_radius\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ and\ box\ constraints\ \`{}\`{}lb\ <=\ x\ <=\ ub\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00421}00421\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00422}00422\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00424}00424\ \textcolor{stringliteral}{\ \ \ \ H\ :\ LinearOperator\ (or\ sparse\ matrix\ or\ ndarray),\ shape\ (n,\ n)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Operator\ for\ computing\ \`{}\`{}H\ v\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ c\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Gradient\ of\ the\ quadratic\ objective\ function.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ Z\ :\ LinearOperator\ (or\ sparse\ matrix\ or\ ndarray),\ shape\ (n,\ n)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00429}00429\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Operator\ for\ projecting\ \`{}\`{}x\`{}\`{}\ into\ the\ null\ space\ of\ A.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ Y\ :\ LinearOperator,\ \ sparse\ matrix,\ ndarray,\ shape\ (n,\ m)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Operator\ that,\ for\ a\ given\ a\ vector\ \`{}\`{}b\`{}\`{},\ compute\ smallest}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ norm\ solution\ of\ \`{}\`{}A\ x\ +\ b\ =\ 0\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ b\ :\ array\_like,\ shape\ (m,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Right-\/hand\ side\ of\ the\ constraint\ equation.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ trust\_radius\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00436}00436\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Trust\ radius\ to\ be\ considered.\ By\ default,\ uses\ \`{}\`{}trust\_radius=inf\`{}\`{},}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00437}00437\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ which\ means\ no\ trust\ radius\ at\ all.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ lb\ :\ array\_like,\ shape\ (n,),\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Lower\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00440}00440\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}lb[i]\ =\ -\/Inf\`{}\`{}\ the\ lower\ bound\ for\ the\ i-\/th}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ component\ is\ just\ ignored\ (default).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ ub\ :\ array\_like,\ shape\ (n,\ ),\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ bounds\ to\ each\ one\ of\ the\ components\ of\ \`{}\`{}x\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00444}00444\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}\`{}ub[i]\ =\ Inf\`{}\`{}\ the\ upper\ bound\ for\ the\ i-\/th}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ component\ is\ just\ ignored\ (default).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00446}00446\ \textcolor{stringliteral}{\ \ \ \ tol\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Tolerance\ used\ to\ interrupt\ the\ algorithm.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00448}00448\ \textcolor{stringliteral}{\ \ \ \ max\_iter\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ algorithm\ iterations.\ Where\ \`{}\`{}max\_inter\ <=\ n-\/m\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ By\ default,\ uses\ \`{}\`{}max\_iter\ =\ n-\/m\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ max\_infeasible\_iter\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ infeasible\ (regarding\ box\ constraints)\ iterations\ the}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00453}00453\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ algorithm\ is\ allowed\ to\ take.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ By\ default,\ uses\ \`{}\`{}max\_infeasible\_iter\ =\ n-\/m\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ return\_all\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00456}00456\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ When\ \`{}\`{}true\`{}\`{},\ return\ the\ list\ of\ all\ vectors\ through\ the\ iterations.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00457}00457\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00458}00458\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00459}00459\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00460}00460\ \textcolor{stringliteral}{\ \ \ \ x\ :\ array\_like,\ shape\ (n,)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00461}00461\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Solution\ of\ the\ EQP\ problem.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00462}00462\ \textcolor{stringliteral}{\ \ \ \ info\ :\ Dict}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00463}00463\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Dictionary\ containing\ the\ following:}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00464}00464\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00465}00465\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ -\/\ niter\ :\ Number\ of\ iterations.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00466}00466\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ -\/\ stop\_cond\ :\ Reason\ for\ algorithm\ termination:}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00467}00467\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.\ Iteration\ limit\ was\ reached;}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00468}00468\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.\ Reached\ the\ trust-\/region\ boundary;}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00469}00469\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.\ Negative\ curvature\ detected;}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00470}00470\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 4.\ Tolerance\ was\ satisfied.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00471}00471\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ -\/\ allvecs\ :\ List\ containing\ all\ intermediary\ vectors\ (optional).}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00472}00472\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ -\/\ hits\_boundary\ :\ True\ if\ the\ proposed\ step\ is\ on\ the\ boundary}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00473}00473\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ of\ the\ trust\ region.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00474}00474\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00475}00475\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00476}00476\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00477}00477\ \textcolor{stringliteral}{\ \ \ \ Implementation\ of\ Algorithm\ 6.2\ on\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00478}00478\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00479}00479\ \textcolor{stringliteral}{\ \ \ \ In\ the\ absence\ of\ spherical\ and\ box\ constraints,\ for\ sufficient}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00480}00480\ \textcolor{stringliteral}{\ \ \ \ iterations,\ the\ method\ returns\ a\ truly\ optimal\ result.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00481}00481\ \textcolor{stringliteral}{\ \ \ \ In\ the\ presence\ of\ those\ constraints,\ the\ value\ returned\ is\ only}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00482}00482\ \textcolor{stringliteral}{\ \ \ \ a\ inexpensive\ approximation\ of\ the\ optimal\ value.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00483}00483\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00484}00484\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00485}00485\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00486}00486\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Gould,\ Nicholas\ IM,\ Mary\ E.\ Hribar,\ and\ Jorge\ Nocedal.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00487}00487\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ "{}On\ the\ solution\ of\ equality\ constrained\ quadratic}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00488}00488\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ programming\ problems\ arising\ in\ optimization."{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00489}00489\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ SIAM\ Journal\ on\ Scientific\ Computing\ 23.4\ (2001):\ 1376-\/1395.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00490}00490\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00491}00491\ \ \ \ \ CLOSE\_TO\_ZERO\ =\ 1e-\/25}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00492}00492\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00493}00493\ \ \ \ \ n,\ =\ np.shape(c)\ \ \textcolor{comment}{\#\ Number\ of\ parameters}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00494}00494\ \ \ \ \ m,\ =\ np.shape(b)\ \ \textcolor{comment}{\#\ Number\ of\ constraints}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00495}00495\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00496}00496\ \ \ \ \ \textcolor{comment}{\#\ Initial\ Values}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00497}00497\ \ \ \ \ x\ =\ Y.dot(-\/b)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00498}00498\ \ \ \ \ r\ =\ Z.dot(H.dot(x)\ +\ c)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00499}00499\ \ \ \ \ g\ =\ Z.dot(r)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00500}00500\ \ \ \ \ p\ =\ -\/g}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00501}00501\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00502}00502\ \ \ \ \ \textcolor{comment}{\#\ Store\ \`{}\`{}x``\ value}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00503}00503\ \ \ \ \ \textcolor{keywordflow}{if}\ return\_all:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00504}00504\ \ \ \ \ \ \ \ \ allvecs\ =\ [x]}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00505}00505\ \ \ \ \ \textcolor{comment}{\#\ Values\ for\ the\ first\ iteration}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00506}00506\ \ \ \ \ H\_p\ =\ H.dot(p)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00507}00507\ \ \ \ \ rt\_g\ =\ norm(g)**2\ \ \textcolor{comment}{\#\ g.T\ g\ =\ r.T\ Z\ g\ =\ r.T\ g\ (ref\ [1]\_\ p.1389)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00508}00508\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00509}00509\ \ \ \ \ \textcolor{comment}{\#\ If\ x\ >\ trust-\/region\ the\ problem\ does\ not\ have\ a\ solution.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00510}00510\ \ \ \ \ tr\_distance\ =\ trust\_radius\ -\/\ norm(x)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00511}00511\ \ \ \ \ \textcolor{keywordflow}{if}\ tr\_distance\ <\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Trust\ region\ problem\ does\ not\ have\ a\ solution."{}})}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00513}00513\ \ \ \ \ \textcolor{comment}{\#\ If\ x\ ==\ trust\_radius,\ then\ x\ is\ the\ solution}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00514}00514\ \ \ \ \ \textcolor{comment}{\#\ to\ the\ optimization\ problem,\ since\ x\ is\ the}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00515}00515\ \ \ \ \ \textcolor{comment}{\#\ minimum\ norm\ solution\ to\ Ax=b.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00516}00516\ \ \ \ \ \textcolor{keywordflow}{elif}\ tr\_distance\ <\ CLOSE\_TO\_ZERO:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00517}00517\ \ \ \ \ \ \ \ \ info\ =\ \{\textcolor{stringliteral}{'niter'}:\ 0,\ \textcolor{stringliteral}{'stop\_cond'}:\ 2,\ \textcolor{stringliteral}{'hits\_boundary'}:\ \textcolor{keyword}{True}\}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00518}00518\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_all:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ \ \ \ \ allvecs.append(x)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ info[\textcolor{stringliteral}{'allvecs'}]\ =\ allvecs}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00521}00521\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ info}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00522}00522\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00523}00523\ \ \ \ \ \textcolor{comment}{\#\ Set\ default\ tolerance}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00524}00524\ \ \ \ \ \textcolor{keywordflow}{if}\ tol\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00525}00525\ \ \ \ \ \ \ \ \ tol\ =\ max(min(0.01\ *\ np.sqrt(rt\_g),\ 0.1\ *\ rt\_g),\ CLOSE\_TO\_ZERO)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00526}00526\ \ \ \ \ \textcolor{comment}{\#\ Set\ default\ lower\ and\ upper\ bounds}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00527}00527\ \ \ \ \ \textcolor{keywordflow}{if}\ lb\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00528}00528\ \ \ \ \ \ \ \ \ lb\ =\ np.full(n,\ -\/np.inf)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00529}00529\ \ \ \ \ \textcolor{keywordflow}{if}\ ub\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ ub\ =\ np.full(n,\ np.inf)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00531}00531\ \ \ \ \ \textcolor{comment}{\#\ Set\ maximum\ iterations}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00532}00532\ \ \ \ \ \textcolor{keywordflow}{if}\ max\_iter\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00533}00533\ \ \ \ \ \ \ \ \ max\_iter\ =\ n-\/m}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00534}00534\ \ \ \ \ max\_iter\ =\ min(max\_iter,\ n-\/m)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00535}00535\ \ \ \ \ \textcolor{comment}{\#\ Set\ maximum\ infeasible\ iterations}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00536}00536\ \ \ \ \ \textcolor{keywordflow}{if}\ max\_infeasible\_iter\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00537}00537\ \ \ \ \ \ \ \ \ max\_infeasible\_iter\ =\ n-\/m}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00538}00538\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00539}00539\ \ \ \ \ hits\_boundary\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00540}00540\ \ \ \ \ stop\_cond\ =\ 1}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00541}00541\ \ \ \ \ counter\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00542}00542\ \ \ \ \ last\_feasible\_x\ =\ np.zeros\_like(x)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00543}00543\ \ \ \ \ k\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00544}00544\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(max\_iter):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00545}00545\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stop\ criteria\ -\/\ Tolerance\ :\ r.T\ g\ <\ tol}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00546}00546\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ rt\_g\ <\ tol:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00547}00547\ \ \ \ \ \ \ \ \ \ \ \ \ stop\_cond\ =\ 4}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00548}00548\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00549}00549\ \ \ \ \ \ \ \ \ k\ +=\ 1}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00550}00550\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ curvature}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00551}00551\ \ \ \ \ \ \ \ \ pt\_H\_p\ =\ H\_p.dot(p)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00552}00552\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stop\ criteria\ -\/\ Negative\ curvature}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00553}00553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pt\_H\_p\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00554}00554\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.isinf(trust\_radius):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00555}00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Negative\ curvature\ not\ allowed\ "{}}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00556}00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}for\ unrestricted\ problems."{}})}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00557}00557\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00558}00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ intersection\ with\ constraints}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00559}00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_,\ alpha,\ intersect\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00560}00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x,\ p,\ lb,\ ub,\ trust\_radius,\ entire\_line=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00561}00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ solution}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00562}00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ intersect:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00563}00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ x\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00564}00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reinforce\ variables\ are\ inside\ box\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00565}00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ only\ necessary\ because\ of\ roundoff\ errors.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00566}00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_ac51b9ac5fcaa6233d692695bc0bbea9b}{reinforce\_box\_boundaries}}(x,\ lb,\ ub)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00567}00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Attribute\ information}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00568}00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stop\_cond\ =\ 3}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00569}00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hits\_boundary\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00570}00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00571}00571\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00572}00572\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ next\ step}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00573}00573\ \ \ \ \ \ \ \ \ alpha\ =\ rt\_g\ /\ pt\_H\_p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00574}00574\ \ \ \ \ \ \ \ \ x\_next\ =\ x\ +\ alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00575}00575\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00576}00576\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stop\ criteria\ -\/\ Hits\ boundary}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00577}00577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ np.linalg.norm(x\_next)\ >=\ trust\_radius:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00578}00578\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Find\ intersection\ with\ box\ constraints}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00579}00579\ \ \ \ \ \ \ \ \ \ \ \ \ \_,\ theta,\ intersect\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(x,\ alpha*p,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00580}00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00581}00581\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ solution}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00582}00582\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ intersect:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ x\ +\ theta*alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00584}00584\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reinforce\ variables\ are\ inside\ box\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00585}00585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ only\ necessary\ because\ of\ roundoff\ errors.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00586}00586\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_ac51b9ac5fcaa6233d692695bc0bbea9b}{reinforce\_box\_boundaries}}(x,\ lb,\ ub)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00587}00587\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Attribute\ information}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00588}00588\ \ \ \ \ \ \ \ \ \ \ \ \ stop\_cond\ =\ 2}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00589}00589\ \ \ \ \ \ \ \ \ \ \ \ \ hits\_boundary\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00590}00590\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00591}00591\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00592}00592\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ \`{}\`{}x``\ is\ inside\ the\ box\ and\ start\ counter\ if\ it\ is\ not.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00593}00593\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_acac0fddf9aafcd85ea23e093354ce79a}{inside\_box\_boundaries}}(x\_next,\ lb,\ ub):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00594}00594\ \ \ \ \ \ \ \ \ \ \ \ \ counter\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00595}00595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00596}00596\ \ \ \ \ \ \ \ \ \ \ \ \ counter\ +=\ 1}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00597}00597\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Whenever\ outside\ box\ constraints\ keep\ looking\ for\ intersections.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00598}00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ counter\ >\ 0:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00599}00599\ \ \ \ \ \ \ \ \ \ \ \ \ \_,\ theta,\ intersect\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_a6d6ec7c3c45458dd6ddcd4de54b54a9c}{box\_sphere\_intersections}}(x,\ alpha*p,\ lb,\ ub,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00600}00600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ trust\_radius)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ intersect:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00602}00602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_feasible\_x\ =\ x\ +\ theta*alpha*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00603}00603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Reinforce\ variables\ are\ inside\ box\ constraints.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ only\ necessary\ because\ of\ roundoff\ errors.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00605}00605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_feasible\_x\ =\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_ac51b9ac5fcaa6233d692695bc0bbea9b}{reinforce\_box\_boundaries}}(last\_feasible\_x,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lb,\ ub)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter\ =\ 0}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Stop\ after\ too\ many\ infeasible\ (regarding\ box\ constraints)\ iteration.}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ counter\ >\ max\_infeasible\_iter:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Store\ \`{}\`{}x\_next``\ value}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ return\_all:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ \ \ \ \ allvecs.append(x\_next)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00614}00614\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ residual}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ r\_next\ =\ r\ +\ alpha*H\_p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Project\ residual\ g+\ =\ Z\ r+}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ g\_next\ =\ Z.dot(r\_next)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00619}00619\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Compute\ conjugate\ direction\ step\ d}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ rt\_g\_next\ =\ norm(g\_next)**2\ \ \textcolor{comment}{\#\ g.T\ g\ =\ r.T\ g\ (ref\ [1]\_\ p.1389)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ beta\ =\ rt\_g\_next\ /\ rt\_g}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ p\ =\ -\/\ g\_next\ +\ beta*p}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Prepare\ for\ next\ iteration}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ x\ =\ x\_next}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ g\ =\ g\_next}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ r\ =\ g\_next}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ rt\_g\ =\ norm(g)**2\ \ \textcolor{comment}{\#\ g.T\ g\ =\ r.T\ Z\ g\ =\ r.T\ g\ (ref\ [1]\_\ p.1389)}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ H\_p\ =\ H.dot(p)}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00629}00629\ }
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00630}00630\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__trustregion__constr_1_1qp__subproblem_acac0fddf9aafcd85ea23e093354ce79a}{inside\_box\_boundaries}}(x,\ lb,\ ub):}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ x\ =\ last\_feasible\_x}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ hits\_boundary\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00633}00633\ \ \ \ \ info\ =\ \{\textcolor{stringliteral}{'niter'}:\ k,\ \textcolor{stringliteral}{'stop\_cond'}:\ stop\_cond,}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'hits\_boundary'}:\ hits\_boundary\}}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00635}00635\ \ \ \ \ \textcolor{keywordflow}{if}\ return\_all:}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ info[\textcolor{stringliteral}{'allvecs'}]\ =\ allvecs}
\DoxyCodeLine{\Hypertarget{qp__subproblem_8py_source_l00637}00637\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ info}

\end{DoxyCode}
