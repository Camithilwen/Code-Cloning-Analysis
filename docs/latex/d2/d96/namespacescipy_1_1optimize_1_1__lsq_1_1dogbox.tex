\doxysection{scipy.\+optimize.\+\_\+lsq.\+dogbox Namespace Reference}
\hypertarget{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox}{}\label{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox}\index{scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a0c0d8aab13720da552f556e02874c822}{lsmr\+\_\+operator}} (Jop, d, active\+\_\+set)
\item 
\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a8a373fd922a44114a73c059e6ca27ac2}{find\+\_\+intersection}} (x, tr\+\_\+bounds, lb, ub)
\item 
\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_abfd1d147e11752eac0f55e73c1c2d9e4}{dogleg\+\_\+step}} (x, newton\+\_\+step, g, a, b, tr\+\_\+bounds, lb, ub)
\item 
\mbox{\hyperlink{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a427a2ca6f5c8b727ad1b9301f0ea636d}{dogbox}} (fun, jac, x0, f0, J0, lb, ub, ftol, xtol, gtol, max\+\_\+nfev, x\+\_\+scale, loss\+\_\+function, tr\+\_\+solver, tr\+\_\+options, verbose)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Dogleg algorithm with rectangular trust regions for least-squares minimization.

The description of the algorithm can be found in [Voglis]_. The algorithm does
trust-region iterations, but the shape of trust regions is rectangular as
opposed to conventional elliptical. The intersection of a trust region and
an initial feasible region is again some rectangle. Thus, on each iteration a
bound-constrained quadratic optimization problem is solved.

A quadratic problem is solved by well-known dogleg approach, where the
function is minimized along piecewise-linear "dogleg" path [NumOpt]_,
Chapter 4. If Jacobian is not rank-deficient then the function is decreasing
along this path, and optimization amounts to simply following along this
path as long as a point stays within the bounds. A constrained Cauchy step
(along the anti-gradient) is considered for safety in rank deficient cases,
in this situations the convergence might be slow.

If during iterations some variable hit the initial bound and the component
of anti-gradient points outside the feasible region, then a next dogleg step
won't make any progress. At this state such variables satisfy first-order
optimality conditions and they are excluded before computing a next dogleg
step.

Gauss-Newton step can be computed exactly by `numpy.linalg.lstsq` (for dense
Jacobian matrices) or by iterative procedure `scipy.sparse.linalg.lsmr` (for
dense and sparse matrices, or Jacobian being LinearOperator). The second
option allows to solve very large problems (up to couple of millions of
residuals on a regular PC), provided the Jacobian matrix is sufficiently
sparse. But note that dogbox is not very good for solving problems with
large number of constraints, because of variables exclusion-inclusion on each
iteration (a required number of function evaluations might be high or accuracy
of a solution will be poor), thus its large-scale usage is probably limited
to unconstrained problems.

References
----------
.. [Voglis] C. Voglis and I. E. Lagaris, "A Rectangular Trust Region Dogleg
            Approach for Unconstrained and Bound Constrained Nonlinear
            Optimization", WSEAS International Conference on Applied
            Mathematics, Corfu, Greece, 2004.
.. [NumOpt] J. Nocedal and S. J. Wright, "Numerical optimization, 2nd edition".
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a427a2ca6f5c8b727ad1b9301f0ea636d}\index{scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}!dogbox@{dogbox}}
\index{dogbox@{dogbox}!scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}}
\doxysubsubsection{\texorpdfstring{dogbox()}{dogbox()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a427a2ca6f5c8b727ad1b9301f0ea636d} 
scipy.\+optimize.\+\_\+lsq.\+dogbox.\+dogbox (\begin{DoxyParamCaption}\item[{}]{fun}{, }\item[{}]{jac}{, }\item[{}]{x0}{, }\item[{}]{f0}{, }\item[{}]{J0}{, }\item[{}]{lb}{, }\item[{}]{ub}{, }\item[{}]{ftol}{, }\item[{}]{xtol}{, }\item[{}]{gtol}{, }\item[{}]{max\+\_\+nfev}{, }\item[{}]{x\+\_\+scale}{, }\item[{}]{loss\+\_\+function}{, }\item[{}]{tr\+\_\+solver}{, }\item[{}]{tr\+\_\+options}{, }\item[{}]{verbose}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{dogbox_8py_source_l00149}{149}} of file \mbox{\hyperlink{dogbox_8py_source}{dogbox.\+py}}.

\Hypertarget{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_abfd1d147e11752eac0f55e73c1c2d9e4}\index{scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}!dogleg\_step@{dogleg\_step}}
\index{dogleg\_step@{dogleg\_step}!scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}}
\doxysubsubsection{\texorpdfstring{dogleg\_step()}{dogleg\_step()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_abfd1d147e11752eac0f55e73c1c2d9e4} 
scipy.\+optimize.\+\_\+lsq.\+dogbox.\+dogleg\+\_\+step (\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{newton\+\_\+step}{, }\item[{}]{g}{, }\item[{}]{a}{, }\item[{}]{b}{, }\item[{}]{tr\+\_\+bounds}{, }\item[{}]{lb}{, }\item[{}]{ub}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Find dogleg step in a rectangular region.

Returns
-------
step : ndarray, shape (n,)
    Computed dogleg step.
bound_hits : ndarray of int, shape (n,)
    Each component shows whether a corresponding variable hits the
    initial bound after the step is taken:
        *  0 - a variable doesn't hit the bound.
        * -1 - lower bound is hit.
        *  1 - upper bound is hit.
tr_hit : bool
    Whether the step hit the boundary of the trust-region.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dogbox_8py_source_l00106}{106}} of file \mbox{\hyperlink{dogbox_8py_source}{dogbox.\+py}}.



References \mbox{\hyperlink{dogbox_8py_source_l00106}{dogleg\+\_\+step()}}, \mbox{\hyperlink{dogbox_8py_source_l00077}{find\+\_\+intersection()}}, and \mbox{\hyperlink{dogbox_8py_source_l00056}{lsmr\+\_\+operator()}}.



Referenced by \mbox{\hyperlink{dogbox_8py_source_l00106}{dogleg\+\_\+step()}}.

\Hypertarget{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a8a373fd922a44114a73c059e6ca27ac2}\index{scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}!find\_intersection@{find\_intersection}}
\index{find\_intersection@{find\_intersection}!scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}}
\doxysubsubsection{\texorpdfstring{find\_intersection()}{find\_intersection()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a8a373fd922a44114a73c059e6ca27ac2} 
scipy.\+optimize.\+\_\+lsq.\+dogbox.\+find\+\_\+intersection (\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{tr\+\_\+bounds}{, }\item[{}]{lb}{, }\item[{}]{ub}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Find intersection of trust-region bounds and initial bounds.

Returns
-------
lb_total, ub_total : ndarray with shape of x
    Lower and upper bounds of the intersection region.
orig_l, orig_u : ndarray of bool with shape of x
    True means that an original bound is taken as a corresponding bound
    in the intersection region.
tr_l, tr_u : ndarray of bool with shape of x
    True means that a trust-region bound is taken as a corresponding bound
    in the intersection region.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dogbox_8py_source_l00077}{77}} of file \mbox{\hyperlink{dogbox_8py_source}{dogbox.\+py}}.



Referenced by \mbox{\hyperlink{dogbox_8py_source_l00106}{dogleg\+\_\+step()}}.

\Hypertarget{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a0c0d8aab13720da552f556e02874c822}\index{scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}!lsmr\_operator@{lsmr\_operator}}
\index{lsmr\_operator@{lsmr\_operator}!scipy.optimize.\_lsq.dogbox@{scipy.optimize.\_lsq.dogbox}}
\doxysubsubsection{\texorpdfstring{lsmr\_operator()}{lsmr\_operator()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1optimize_1_1__lsq_1_1dogbox_a0c0d8aab13720da552f556e02874c822} 
scipy.\+optimize.\+\_\+lsq.\+dogbox.\+lsmr\+\_\+operator (\begin{DoxyParamCaption}\item[{}]{Jop}{, }\item[{}]{d}{, }\item[{}]{active\+\_\+set}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute LinearOperator to use in LSMR by dogbox algorithm.

`active_set` mask is used to excluded active variables from computations
of matrix-vector products.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{dogbox_8py_source_l00056}{56}} of file \mbox{\hyperlink{dogbox_8py_source}{dogbox.\+py}}.



Referenced by \mbox{\hyperlink{dogbox_8py_source_l00106}{dogleg\+\_\+step()}}.

