\doxysection{sklearn.\+linear\+\_\+model.\+\_\+base Namespace Reference}
\hypertarget{namespacesklearn_1_1linear__model_1_1__base}{}\label{namespacesklearn_1_1linear__model_1_1__base}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__base_1_1LinearClassifierMixin}{Linear\+Classifier\+Mixin}}
\item 
class \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__base_1_1LinearModel}{Linear\+Model}}
\item 
class \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__base_1_1LinearRegression}{Linear\+Regression}}
\item 
class \mbox{\hyperlink{classsklearn_1_1linear__model_1_1__base_1_1SparseCoefMixin}{Sparse\+Coef\+Mixin}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_abc94508f025e1cab4a1cc91a0bc64a11}{make\+\_\+dataset}} (X, y, sample\+\_\+weight, random\+\_\+state=None)
\item 
\mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_aebf19284ae368e2996afb63a6a74285d}{\+\_\+preprocess\+\_\+data}} (X, y, \texorpdfstring{$\ast$}{*}, fit\+\_\+intercept, copy=\mbox{\hyperlink{classTrue}{True}}, copy\+\_\+y=\mbox{\hyperlink{classTrue}{True}}, sample\+\_\+weight=None, check\+\_\+input=\mbox{\hyperlink{classTrue}{True}})
\item 
\mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_a482decda18b5957324d87b04e24a1fe9}{\+\_\+rescale\+\_\+data}} (X, y, sample\+\_\+weight, inplace=False)
\item 
\mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_a7fd083594cbdcd35e3a5b15633bbd395}{\+\_\+check\+\_\+precomputed\+\_\+gram\+\_\+matrix}} (X, precompute, X\+\_\+offset, X\+\_\+scale, rtol=None, atol=1e-\/5)
\item 
\mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_afef4607b9c267126b02c19eff8399be4}{\+\_\+pre\+\_\+fit}} (X, y, Xy, precompute, fit\+\_\+intercept, copy, check\+\_\+input=\mbox{\hyperlink{classTrue}{True}}, sample\+\_\+weight=None)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
float \mbox{\hyperlink{namespacesklearn_1_1linear__model_1_1__base_aa160fd961899aaff36932501ec6610cb}{SPARSE\+\_\+\+INTERCEPT\+\_\+\+DECAY}} = 0.\+01
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Generalized Linear Models.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_a7fd083594cbdcd35e3a5b15633bbd395}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!\_check\_precomputed\_gram\_matrix@{\_check\_precomputed\_gram\_matrix}}
\index{\_check\_precomputed\_gram\_matrix@{\_check\_precomputed\_gram\_matrix}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{\_check\_precomputed\_gram\_matrix()}{\_check\_precomputed\_gram\_matrix()}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_a7fd083594cbdcd35e3a5b15633bbd395} 
sklearn.\+linear\+\_\+model.\+\_\+base.\+\_\+check\+\_\+precomputed\+\_\+gram\+\_\+matrix (\begin{DoxyParamCaption}\item[{}]{X}{, }\item[{}]{precompute}{, }\item[{}]{X\+\_\+offset}{, }\item[{}]{X\+\_\+scale}{, }\item[{}]{rtol}{ = {\ttfamily None}, }\item[{}]{atol}{ = {\ttfamily 1e-\/5}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Computes a single element of the gram matrix and compares it to
the corresponding element of the user supplied gram matrix.

If the values do not match a ValueError will be thrown.

Parameters
----------
X : ndarray of shape (n_samples, n_features)
    Data array.

precompute : array-like of shape (n_features, n_features)
    User-supplied gram matrix.

X_offset : ndarray of shape (n_features,)
    Array of feature means used to center design matrix.

X_scale : ndarray of shape (n_features,)
    Array of feature scale factors used to normalize design matrix.

rtol : float, default=None
    Relative tolerance; see numpy.allclose
    If None, it is set to 1e-4 for arrays of dtype numpy.float32 and 1e-7
    otherwise.

atol : float, default=1e-5
    absolute tolerance; see :func`numpy.allclose`. Note that the default
    here is more tolerant than the default for
    :func:`numpy.testing.assert_allclose`, where `atol=0`.

Raises
------
ValueError
    Raised when the provided Gram matrix is not consistent.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00715}{715}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.



Referenced by \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00788}{\+\_\+pre\+\_\+fit()}}.

\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_afef4607b9c267126b02c19eff8399be4}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!\_pre\_fit@{\_pre\_fit}}
\index{\_pre\_fit@{\_pre\_fit}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{\_pre\_fit()}{\_pre\_fit()}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_afef4607b9c267126b02c19eff8399be4} 
sklearn.\+linear\+\_\+model.\+\_\+base.\+\_\+pre\+\_\+fit (\begin{DoxyParamCaption}\item[{}]{X}{, }\item[{}]{y}{, }\item[{}]{Xy}{, }\item[{}]{precompute}{, }\item[{}]{fit\+\_\+intercept}{, }\item[{}]{copy}{, }\item[{}]{check\+\_\+input}{ = {\ttfamily \mbox{\hyperlink{classTrue}{True}}}, }\item[{}]{sample\+\_\+weight}{ = {\ttfamily None}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Function used at beginning of fit in linear models with L1 or L0 penalty.

This function applies _preprocess_data and additionally computes the gram matrix
`precompute` as needed as well as `Xy`.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00779}{779}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.



References \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00717}{\+\_\+check\+\_\+precomputed\+\_\+gram\+\_\+matrix()}}, \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00117}{\+\_\+preprocess\+\_\+data()}}, and \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00210}{\+\_\+rescale\+\_\+data()}}.

\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_aebf19284ae368e2996afb63a6a74285d}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!\_preprocess\_data@{\_preprocess\_data}}
\index{\_preprocess\_data@{\_preprocess\_data}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{\_preprocess\_data()}{\_preprocess\_data()}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_aebf19284ae368e2996afb63a6a74285d} 
sklearn.\+linear\+\_\+model.\+\_\+base.\+\_\+preprocess\+\_\+data (\begin{DoxyParamCaption}\item[{}]{X}{, }\item[{}]{y}{, }\item[{\texorpdfstring{$\ast$}{*}}]{}{, }\item[{}]{fit\+\_\+intercept}{, }\item[{}]{copy}{ = {\ttfamily \mbox{\hyperlink{classTrue}{True}}}, }\item[{}]{copy\+\_\+y}{ = {\ttfamily \mbox{\hyperlink{classTrue}{True}}}, }\item[{}]{sample\+\_\+weight}{ = {\ttfamily None}, }\item[{}]{check\+\_\+input}{ = {\ttfamily \mbox{\hyperlink{classTrue}{True}}}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Common data preprocessing for fitting linear models.

This helper is in charge of the following steps:

- Ensure that `sample_weight` is an array or `None`.
- If `check_input=True`, perform standard input validation of `X`, `y`.
- Perform copies if requested to avoid side-effects in case of inplace
  modifications of the input.

Then, if `fit_intercept=True` this preprocessing centers both `X` and `y` as
follows:
    - if `X` is dense, center the data and
    store the mean vector in `X_offset`.
    - if `X` is sparse, store the mean in `X_offset`
    without centering `X`. The centering is expected to be handled by the
    linear solver where appropriate.
    - in either case, always center `y` and store the mean in `y_offset`.
    - both `X_offset` and `y_offset` are always weighted by `sample_weight`
      if not set to `None`.

If `fit_intercept=False`, no centering is performed and `X_offset`, `y_offset`
are set to zero.

Returns
-------
X_out : {ndarray, sparse matrix} of shape (n_samples, n_features)
    If copy=True a copy of the input X is triggered, otherwise operations are
    inplace.
    If input X is dense, then X_out is centered.
y_out : {ndarray, sparse matrix} of shape (n_samples,) or (n_samples, n_targets)
    Centered version of y. Possibly performed inplace on input y depending
    on the copy_y parameter.
X_offset : ndarray of shape (n_features,)
    The mean per column of input X.
y_offset : float or ndarray of shape (n_features,)
X_scale : ndarray of shape (n_features,)
    Always an array of ones. TODO: refactor the code base to make it
    possible to remove this unused variable.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00108}{108}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.



Referenced by \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00788}{\+\_\+pre\+\_\+fit()}}, and \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00591}{sklearn.\+linear\+\_\+model.\+\_\+base.\+Linear\+Regression.\+fit()}}.

\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_a482decda18b5957324d87b04e24a1fe9}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!\_rescale\_data@{\_rescale\_data}}
\index{\_rescale\_data@{\_rescale\_data}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{\_rescale\_data()}{\_rescale\_data()}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_a482decda18b5957324d87b04e24a1fe9} 
sklearn.\+linear\+\_\+model.\+\_\+base.\+\_\+rescale\+\_\+data (\begin{DoxyParamCaption}\item[{}]{X}{, }\item[{}]{y}{, }\item[{}]{sample\+\_\+weight}{, }\item[{}]{inplace}{ = {\ttfamily False}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Rescale data sample-wise by square root of sample_weight.

For many linear models, this enables easy support for sample_weight because

    (y - X w)' S (y - X w)

with S = diag(sample_weight) becomes

    ||y_rescaled - X_rescaled w||_2^2

when setting

    y_rescaled = sqrt(S) y
    X_rescaled = sqrt(S) X

Returns
-------
X_rescaled : {array-like, sparse matrix}

y_rescaled : {array-like, sparse matrix}
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00210}{210}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.



Referenced by \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00788}{\+\_\+pre\+\_\+fit()}}, and \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00591}{sklearn.\+linear\+\_\+model.\+\_\+base.\+Linear\+Regression.\+fit()}}.

\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_abc94508f025e1cab4a1cc91a0bc64a11}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!make\_dataset@{make\_dataset}}
\index{make\_dataset@{make\_dataset}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{make\_dataset()}{make\_dataset()}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_abc94508f025e1cab4a1cc91a0bc64a11} 
sklearn.\+linear\+\_\+model.\+\_\+base.\+make\+\_\+dataset (\begin{DoxyParamCaption}\item[{}]{X}{, }\item[{}]{y}{, }\item[{}]{sample\+\_\+weight}{, }\item[{}]{random\+\_\+state}{ = {\ttfamily None}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Create ``Dataset`` abstraction for sparse and dense inputs.

This also returns the ``intercept_decay`` which is different
for sparse datasets.

Parameters
----------
X : array-like, shape (n_samples, n_features)
    Training data

y : array-like, shape (n_samples, )
    Target values.

sample_weight : numpy array of shape (n_samples,)
    The weight of each sample

random_state : int, RandomState instance or None (default)
    Determines random number generation for dataset random sampling. It is not
    used for dataset shuffling.
    Pass an int for reproducible output across multiple function calls.
    See :term:`Glossary <random_state>`.

Returns
-------
dataset
    The ``Dataset`` abstraction
intercept_decay
    The intercept decay
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00055}{55}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.



\doxysubsection{Variable Documentation}
\Hypertarget{namespacesklearn_1_1linear__model_1_1__base_aa160fd961899aaff36932501ec6610cb}\index{sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}!SPARSE\_INTERCEPT\_DECAY@{SPARSE\_INTERCEPT\_DECAY}}
\index{SPARSE\_INTERCEPT\_DECAY@{SPARSE\_INTERCEPT\_DECAY}!sklearn.linear\_model.\_base@{sklearn.linear\_model.\_base}}
\doxysubsubsection{\texorpdfstring{SPARSE\_INTERCEPT\_DECAY}{SPARSE\_INTERCEPT\_DECAY}}
{\footnotesize\ttfamily \label{namespacesklearn_1_1linear__model_1_1__base_aa160fd961899aaff36932501ec6610cb} 
float sklearn.\+linear\+\_\+model.\+\_\+base.\+SPARSE\+\_\+\+INTERCEPT\+\_\+\+DECAY = 0.\+01}



Definition at line \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source_l00050}{50}} of file \mbox{\hyperlink{sklearn_2linear__model_2__base_8py_source}{\+\_\+base.\+py}}.

