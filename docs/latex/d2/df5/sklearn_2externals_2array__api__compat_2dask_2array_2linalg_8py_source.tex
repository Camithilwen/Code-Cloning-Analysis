\doxysection{linalg.\+py}
\hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source}{}\label{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_compat/dask/array/linalg.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_compat/dask/array/linalg.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__compat_1_1dask_1_1array_1_1linalg}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00003}00003\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ Literal}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00005}00005\ \textcolor{keyword}{import}\ dask.array\ \textcolor{keyword}{as}\ da}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00007}00007\ \textcolor{comment}{\#\ The\ \`{}matmul`\ and\ \`{}tensordot`\ functions\ are\ in\ both\ the\ main\ and\ linalg\ namespaces}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00008}00008\ \textcolor{keyword}{from}\ dask.array\ \textcolor{keyword}{import}\ matmul,\ outer,\ tensordot}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00010}00010\ \textcolor{comment}{\#\ Exports}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00011}00011\ \textcolor{keyword}{from}\ dask.array.linalg\ \textcolor{keyword}{import}\ *\ \ \textcolor{comment}{\#\ noqa:\ F403}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00013}00013\ \textcolor{keyword}{from}\ ...\_internal\ \textcolor{keyword}{import}\ get\_xp}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00014}00014\ \textcolor{keyword}{from}\ ...common\ \textcolor{keyword}{import}\ \_linalg}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00015}00015\ \textcolor{keyword}{from}\ ...common.\_typing\ \textcolor{keyword}{import}\ Array\ \textcolor{keyword}{as}\ \_Array}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00016}00016\ \textcolor{keyword}{from}\ .\_aliases\ \textcolor{keyword}{import}\ matrix\_transpose,\ vecdot}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00018}00018\ \textcolor{comment}{\#\ dask.array.linalg\ doesn't\ have\ \_\_all\_\_.\ If\ it\ is\ added,\ replace\ this\ with}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00019}00019\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00020}00020\ \textcolor{comment}{\#\ from\ dask.array.linalg\ import\ \_\_all\_\_\ as\ linalg\_all}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00021}00021\ \_n\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00022}00022\ exec(\textcolor{stringliteral}{'from\ dask.array.linalg\ import\ *'},\ \_n)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00023}00023\ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'\_\_builtins\_\_'},\ \textcolor{stringliteral}{'annotations'},\ \textcolor{stringliteral}{'operator'},\ \textcolor{stringliteral}{'warnings'},\ \textcolor{stringliteral}{'Array'}):}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00024}00024\ \ \ \ \ \_n.pop(k,\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00025}00025\ linalg\_all\ =\ list(\_n)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00026}00026\ del\ \_n,\ k}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00028}00028\ EighResult\ =\ \mbox{\hyperlink{classsklearn_1_1externals_1_1array__api__compat_1_1common_1_1__linalg_1_1EighResult}{\_linalg.EighResult}}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00029}00029\ QRResult\ =\ \mbox{\hyperlink{classsklearn_1_1externals_1_1array__api__compat_1_1common_1_1__linalg_1_1QRResult}{\_linalg.QRResult}}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00030}00030\ SlogdetResult\ =\ \mbox{\hyperlink{classsklearn_1_1externals_1_1array__api__compat_1_1common_1_1__linalg_1_1SlogdetResult}{\_linalg.SlogdetResult}}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00031}00031\ SVDResult\ =\ \mbox{\hyperlink{classsklearn_1_1externals_1_1array__api__compat_1_1common_1_1__linalg_1_1SVDResult}{\_linalg.SVDResult}}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00032}00032\ \textcolor{comment}{\#\ TODO:\ use\ the\ QR\ wrapper\ once\ dask}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00033}00033\ \textcolor{comment}{\#\ supports\ the\ mode\ keyword\ on\ QR}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00034}00034\ \textcolor{comment}{\#\ https://github.com/dask/dask/issues/10388}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00035}00035\ \textcolor{comment}{\#qr\ =\ get\_xp(da)(\_linalg.qr)}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00036}00036\ \textcolor{keyword}{def\ }qr(}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00037}00037\ \ \ \ \ x:\ \_Array,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00038}00038\ \ \ \ \ mode:\ Literal[\textcolor{stringliteral}{"{}reduced"{}},\ \textcolor{stringliteral}{"{}complete"{}}]\ =\ \textcolor{stringliteral}{"{}reduced"{}},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00039}00039\ \ \ \ \ **kwargs:\ object,}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00040}00040\ )\ -\/>\ QRResult:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00041}00041\ \ \ \ \ \textcolor{keywordflow}{if}\ mode\ !=\ \textcolor{stringliteral}{"{}reduced"{}}:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}dask\ arrays\ only\ support\ using\ mode='reduced'"{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00043}00043\ \ \ \ \ \textcolor{keywordflow}{return}\ QRResult(*da.linalg.qr(x,\ **kwargs))}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00044}00044\ trace\ =\ get\_xp(da)(\_linalg.trace)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00045}00045\ cholesky\ =\ get\_xp(da)(\_linalg.cholesky)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00046}00046\ matrix\_rank\ =\ get\_xp(da)(\_linalg.matrix\_rank)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00047}00047\ matrix\_norm\ =\ get\_xp(da)(\_linalg.matrix\_norm)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00050}00050\ \textcolor{comment}{\#\ Wrap\ the\ svd\ functions\ to\ not\ pass\ full\_matrices\ to\ dask}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00051}00051\ \textcolor{comment}{\#\ when\ full\_matrices=False\ (as\ that\ is\ the\ default\ behavior\ for\ dask),}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00052}00052\ \textcolor{comment}{\#\ and\ dask\ doesn't\ have\ the\ full\_matrices\ keyword}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00053}00053\ \textcolor{keyword}{def\ }svd(x:\ \_Array,\ full\_matrices:\ bool\ =\ \textcolor{keyword}{True},\ **kwargs)\ -\/>\ SVDResult:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{if}\ full\_matrices:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}full\_matrics=True\ is\ not\ supported\ by\ dask."{}})}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00056}00056\ \ \ \ \ \textcolor{keywordflow}{return}\ da.linalg.svd(x,\ coerce\_signs=\textcolor{keyword}{False},\ **kwargs)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00058}00058\ \textcolor{keyword}{def\ }svdvals(x:\ \_Array)\ -\/>\ \_Array:}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ TODO:\ can't\ avoid\ computing\ U\ or\ V\ for\ dask}}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00060}00060\ \ \ \ \ \_,\ s,\ \_\ =\ \ svd(x)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{return}\ s}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00063}00063\ vector\_norm\ =\ get\_xp(da)(\_linalg.vector\_norm)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00064}00064\ diagonal\ =\ get\_xp(da)(\_linalg.diagonal)}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00066}00066\ \_\_all\_\_\ =\ linalg\_all\ +\ [\textcolor{stringliteral}{"{}trace"{}},\ \textcolor{stringliteral}{"{}outer"{}},\ \textcolor{stringliteral}{"{}matmul"{}},\ \textcolor{stringliteral}{"{}tensordot"{}},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}matrix\_transpose"{}},\ \textcolor{stringliteral}{"{}vecdot"{}},\ \textcolor{stringliteral}{"{}EighResult"{}},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}QRResult"{}},\ \textcolor{stringliteral}{"{}SlogdetResult"{}},\ \textcolor{stringliteral}{"{}SVDResult"{}},\ \textcolor{stringliteral}{"{}qr"{}},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cholesky"{}},\ \textcolor{stringliteral}{"{}matrix\_rank"{}},\ \textcolor{stringliteral}{"{}matrix\_norm"{}},\ \textcolor{stringliteral}{"{}svdvals"{}},}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}vector\_norm"{}},\ \textcolor{stringliteral}{"{}diagonal"{}}]}
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{sklearn_2externals_2array__api__compat_2dask_2array_2linalg_8py_source_l00072}00072\ \_all\_ignore\ =\ [\textcolor{stringliteral}{'get\_xp'},\ \textcolor{stringliteral}{'da'},\ \textcolor{stringliteral}{'linalg\_all'},\ \textcolor{stringliteral}{'warnings'}]}

\end{DoxyCode}
