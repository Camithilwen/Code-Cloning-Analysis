\doxysection{\+\_\+fir\+\_\+filter\+\_\+design.\+py}
\hypertarget{__fir__filter__design_8py_source}{}\label{__fir__filter__design_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/signal/\_fir\_filter\_design.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/signal/\_fir\_filter\_design.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Functions\ for\ FIR\ filter\ design."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00003}00003\ \textcolor{keyword}{from}\ math\ \textcolor{keyword}{import}\ ceil,\ log}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00004}00004\ \textcolor{keyword}{import}\ operator}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00005}00005\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00007}00007\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1fft}{numpy.fft}}\ \textcolor{keyword}{import}\ irfft,\ fft,\ ifft}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1special}{scipy.special}}\ \textcolor{keyword}{import}\ sinc}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1linalg}{scipy.linalg}}\ \textcolor{keyword}{import}\ (toeplitz,\ hankel,\ solve,\ LinAlgError,\ LinAlgWarning,}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00011}00011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lstsq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00013}00013\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ \_sigtools}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00015}00015\ \_\_all\_\_\ =\ [\textcolor{stringliteral}{'kaiser\_beta'},\ \textcolor{stringliteral}{'kaiser\_atten'},\ \textcolor{stringliteral}{'kaiserord'},}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'firwin'},\ \textcolor{stringliteral}{'firwin2'},\ \textcolor{stringliteral}{'remez'},\ \textcolor{stringliteral}{'firls'},\ \textcolor{stringliteral}{'minimum\_phase'}]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00019}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a9b6d9b077f47727a463a031e87df6327}{00019}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a9b6d9b077f47727a463a031e87df6327}{\_get\_fs}}(fs,\ nyq):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00020}00020\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ Utility\ for\ replacing\ the\ argument\ 'nyq'\ (with\ default\ 1)\ with\ 'fs'.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00023}00023\ \ \ \ \ \textcolor{keywordflow}{if}\ nyq\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ fs\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ fs\ =\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{elif}\ nyq\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ fs\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Values\ cannot\ be\ given\ for\ both\ 'nyq'\ and\ 'fs'."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ msg\ =\ (\textcolor{stringliteral}{"{}Keyword\ argument\ 'nyq'\ is\ deprecated\ in\ favour\ of\ 'fs'\ and\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}will\ be\ removed\ in\ SciPy\ 1.12.0."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ warnings.warn(msg,\ DeprecationWarning,\ stacklevel=3)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ fs\ =\ 2*nyq}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{return}\ fs}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00035}00035\ \textcolor{comment}{\#\ Some\ notes\ on\ function\ parameters:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00036}00036\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00037}00037\ \textcolor{comment}{\#\ \`{}cutoff`\ and\ \`{}width`\ are\ given\ as\ numbers\ between\ 0\ and\ 1.\ \ These\ are}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00038}00038\ \textcolor{comment}{\#\ relative\ frequencies,\ expressed\ as\ a\ fraction\ of\ the\ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00039}00039\ \textcolor{comment}{\#\ For\ example,\ if\ the\ Nyquist\ frequency\ is\ 2\ KHz,\ then\ width=0.15\ is\ a\ width}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00040}00040\ \textcolor{comment}{\#\ of\ 300\ Hz.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00041}00041\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00042}00042\ \textcolor{comment}{\#\ The\ \`{}order`\ of\ a\ FIR\ filter\ is\ one\ less\ than\ the\ number\ of\ taps.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00043}00043\ \textcolor{comment}{\#\ This\ is\ a\ potential\ source\ of\ confusion,\ so\ in\ the\ following\ code,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00044}00044\ \textcolor{comment}{\#\ we\ will\ always\ use\ the\ number\ of\ taps\ as\ the\ parameterization\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00045}00045\ \textcolor{comment}{\#\ the\ 'size'\ of\ the\ filter.\ The\ "{}number\ of\ taps"{}\ means\ the\ number}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00046}00046\ \textcolor{comment}{\#\ of\ coefficients,\ which\ is\ the\ same\ as\ the\ length\ of\ the\ impulse}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00047}00047\ \textcolor{comment}{\#\ response\ of\ the\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00050}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a3aa1c6de0dbaf7aa0f1121be85ff1c3f}{00050}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a3aa1c6de0dbaf7aa0f1121be85ff1c3f}{kaiser\_beta}}(a):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00051}00051\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ Kaiser\ parameter\ \`{}beta\`{},\ given\ the\ attenuation\ \`{}a\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00052}00052\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ a\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ desired\ attenuation\ in\ the\ stopband\ and\ maximum\ ripple\ in}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ passband,\ in\ dB.\ \ This\ should\ be\ a\ *positive*\ number.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00058}00058\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00061}00061\ \textcolor{stringliteral}{\ \ \ \ beta\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00062}00062\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ \`{}beta\`{}\ parameter\ to\ be\ used\ in\ the\ formula\ for\ a\ Kaiser\ window.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00063}00063\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00064}00064\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ Oppenheim,\ Schafer,\ "{}Discrete-\/Time\ Signal\ Processing"{},\ p.475-\/476.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00067}00067\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00070}00070\ \textcolor{stringliteral}{\ \ \ \ Suppose\ we\ want\ to\ design\ a\ lowpass\ filter,\ with\ 65\ dB\ attenuation}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00071}00071\ \textcolor{stringliteral}{\ \ \ \ in\ the\ stop\ band.\ \ The\ Kaiser\ window\ parameter\ to\ be\ used\ in\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00072}00072\ \textcolor{stringliteral}{\ \ \ \ window\ method\ is\ computed\ by\ \`{}\`{}kaiser\_beta(65)\`{}\`{}:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00073}00073\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00074}00074\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.signal\ import\ kaiser\_beta}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ >>>\ kaiser\_beta(65)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ 6.20426}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00077}00077\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{if}\ a\ >\ 50:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ beta\ =\ 0.1102\ *\ (a\ -\/\ 8.7)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00081}00081\ \ \ \ \ \textcolor{keywordflow}{elif}\ a\ >\ 21:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ beta\ =\ 0.5842\ *\ (a\ -\/\ 21)\ **\ 0.4\ +\ 0.07886\ *\ (a\ -\/\ 21)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00083}00083\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ beta\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00085}00085\ \ \ \ \ \textcolor{keywordflow}{return}\ beta}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00088}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a50ac7cf55e5243fdc7cbac8b63108b0a}{00088}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a50ac7cf55e5243fdc7cbac8b63108b0a}{kaiser\_atten}}(numtaps,\ width):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00089}00089\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ attenuation\ of\ a\ Kaiser\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00090}00090\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00091}00091\ \textcolor{stringliteral}{\ \ \ \ Given\ the\ number\ of\ taps\ \`{}N\`{}\ and\ the\ transition\ width\ \`{}width\`{},\ compute\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00092}00092\ \textcolor{stringliteral}{\ \ \ \ attenuation\ \`{}a\`{}\ in\ dB,\ given\ by\ Kaiser's\ formula:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00093}00093\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00094}00094\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ a\ =\ 2.285\ *\ (N\ -\/\ 1)\ *\ pi\ *\ width\ +\ 7.95}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00095}00095\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00096}00096\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00097}00097\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00098}00098\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00099}00099\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ taps\ in\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ width\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ desired\ width\ of\ the\ transition\ region\ between\ passband\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ stopband\ (or,\ in\ general,\ at\ any\ discontinuity)\ for\ the\ filter,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ expressed\ as\ a\ fraction\ of\ the\ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00104}00104\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00107}00107\ \textcolor{stringliteral}{\ \ \ \ a\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00108}00108\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ attenuation\ of\ the\ ripple,\ in\ dB.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00109}00109\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00110}00110\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00111}00111\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00112}00112\ \textcolor{stringliteral}{\ \ \ \ kaiserord,\ kaiser\_beta}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00113}00113\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00114}00114\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00115}00115\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00116}00116\ \textcolor{stringliteral}{\ \ \ \ Suppose\ we\ want\ to\ design\ a\ FIR\ filter\ using\ the\ Kaiser\ window\ method}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00117}00117\ \textcolor{stringliteral}{\ \ \ \ that\ will\ have\ 211\ taps\ and\ a\ transition\ width\ of\ 9\ Hz\ for\ a\ signal\ that}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00118}00118\ \textcolor{stringliteral}{\ \ \ \ is\ sampled\ at\ 480\ Hz.\ Expressed\ as\ a\ fraction\ of\ the\ Nyquist\ frequency,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00119}00119\ \textcolor{stringliteral}{\ \ \ \ the\ width\ is\ 9/(0.5*480)\ =\ 0.0375.\ The\ approximate\ attenuation\ (in\ dB)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00120}00120\ \textcolor{stringliteral}{\ \ \ \ is\ computed\ as\ follows:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00121}00121\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.signal\ import\ kaiser\_atten}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ >>>\ kaiser\_atten(211,\ 0.0375)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ 64.48099630593983}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00125}00125\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00127}00127\ \ \ \ \ a\ =\ 2.285\ *\ (numtaps\ -\/\ 1)\ *\ np.pi\ *\ width\ +\ 7.95}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00128}00128\ \ \ \ \ \textcolor{keywordflow}{return}\ a}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00131}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_ac3198c7e00ea036cdc733e5ff5b93dd3}{00131}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_ac3198c7e00ea036cdc733e5ff5b93dd3}{kaiserord}}(ripple,\ width):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00132}00132\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ Determine\ the\ filter\ window\ parameters\ for\ the\ Kaiser\ window\ method.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00134}00134\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ The\ parameters\ returned\ by\ this\ function\ are\ generally\ used\ to\ create}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ a\ finite\ impulse\ response\ filter\ using\ the\ window\ method,\ with\ either}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \`{}firwin\`{}\ or\ \`{}firwin2\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00138}00138\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00140}00140\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ ripple\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Upper\ bound\ for\ the\ deviation\ (in\ dB)\ of\ the\ magnitude\ of\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ filter's\ frequency\ response\ from\ that\ of\ the\ desired\ filter\ (not}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ including\ frequencies\ in\ any\ transition\ intervals).\ That\ is,\ if\ w}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ is\ the\ frequency\ expressed\ as\ a\ fraction\ of\ the\ Nyquist\ frequency,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A(w)\ is\ the\ actual\ frequency\ response\ of\ the\ filter\ and\ D(w)\ is\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ desired\ frequency\ response,\ the\ design\ requirement\ is\ that::}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00148}00148\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ abs(A(w)\ -\/\ D(w)))\ <\ 10**(-\/ripple/20)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00150}00150\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00151}00151\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ 0\ <=\ w\ <=\ 1\ and\ w\ not\ in\ a\ transition\ interval.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ width\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Width\ of\ transition\ region,\ normalized\ so\ that\ 1\ corresponds\ to\ pi}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ radians\ /\ sample.\ That\ is,\ the\ frequency\ is\ expressed\ as\ a\ fraction}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ the\ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00156}00156\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ length\ of\ the\ Kaiser\ window.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ beta\ :\ float}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ beta\ parameter\ for\ the\ Kaiser\ window.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00163}00163\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ kaiser\_beta,\ kaiser\_atten}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00167}00167\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00169}00169\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00170}00170\ \textcolor{stringliteral}{\ \ \ \ There\ are\ several\ ways\ to\ obtain\ the\ Kaiser\ window:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00171}00171\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00172}00172\ \textcolor{stringliteral}{\ \ \ \ -\/\ \`{}\`{}signal.windows.kaiser(numtaps,\ beta,\ sym=True)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00173}00173\ \textcolor{stringliteral}{\ \ \ \ -\/\ \`{}\`{}signal.get\_window(beta,\ numtaps)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00174}00174\ \textcolor{stringliteral}{\ \ \ \ -\/\ \`{}\`{}signal.get\_window(('kaiser',\ beta),\ numtaps)\`{}\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00175}00175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00176}00176\ \textcolor{stringliteral}{\ \ \ \ The\ empirical\ equations\ discovered\ by\ Kaiser\ are\ used.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00177}00177\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ Oppenheim,\ Schafer,\ "{}Discrete-\/Time\ Signal\ Processing"{},\ pp.475-\/476.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00181}00181\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ We\ will\ use\ the\ Kaiser\ window\ method\ to\ design\ a\ lowpass\ FIR\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ for\ a\ signal\ that\ is\ sampled\ at\ 1000\ Hz.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00186}00186\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00187}00187\ \textcolor{stringliteral}{\ \ \ \ We\ want\ at\ least\ 65\ dB\ rejection\ in\ the\ stop\ band,\ and\ in\ the\ pass}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00188}00188\ \textcolor{stringliteral}{\ \ \ \ band\ the\ gain\ should\ vary\ no\ more\ than\ 0.5\%.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00189}00189\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00190}00190\ \textcolor{stringliteral}{\ \ \ \ We\ want\ a\ cutoff\ frequency\ of\ 175\ Hz,\ with\ a\ transition\ between\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00191}00191\ \textcolor{stringliteral}{\ \ \ \ pass\ band\ and\ the\ stop\ band\ of\ 24\ Hz.\ That\ is,\ in\ the\ band\ [0,\ 163],}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00192}00192\ \textcolor{stringliteral}{\ \ \ \ the\ gain\ varies\ no\ more\ than\ 0.5\%,\ and\ in\ the\ band\ [187,\ 500],\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00193}00193\ \textcolor{stringliteral}{\ \ \ \ signal\ is\ attenuated\ by\ at\ least\ 65\ dB.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00194}00194\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00195}00195\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00196}00196\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.signal\ import\ kaiserord,\ firwin,\ freqz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00197}00197\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00198}00198\ \textcolor{stringliteral}{\ \ \ \ >>>\ fs\ =\ 1000.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00199}00199\ \textcolor{stringliteral}{\ \ \ \ >>>\ cutoff\ =\ 175}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00200}00200\ \textcolor{stringliteral}{\ \ \ \ >>>\ width\ =\ 24}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00201}00201\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00202}00202\ \textcolor{stringliteral}{\ \ \ \ The\ Kaiser\ method\ accepts\ just\ a\ single\ parameter\ to\ control\ the\ pass}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ band\ ripple\ and\ the\ stop\ band\ rejection,\ so\ we\ use\ the\ more\ restrictive}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00204}00204\ \textcolor{stringliteral}{\ \ \ \ of\ the\ two.\ In\ this\ case,\ the\ pass\ band\ ripple\ is\ 0.005,\ or\ 46.02\ dB,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ so\ we\ will\ use\ 65\ dB\ as\ the\ design\ parameter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00206}00206\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ Use\ \`{}kaiserord\`{}\ to\ determine\ the\ length\ of\ the\ filter\ and\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ parameter\ for\ the\ Kaiser\ window.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00209}00209\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps,\ beta\ =\ kaiserord(65,\ width/(0.5*fs))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ 167}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ >>>\ beta}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ 6.20426}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00215}00215\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00216}00216\ \textcolor{stringliteral}{\ \ \ \ Use\ \`{}firwin\`{}\ to\ create\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00217}00217\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00218}00218\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ firwin(numtaps,\ cutoff,\ window=('kaiser',\ beta),}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00219}00219\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scale=False,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00220}00220\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00221}00221\ \textcolor{stringliteral}{\ \ \ \ Compute\ the\ frequency\ response\ of\ the\ filter.\ \ \`{}\`{}w\`{}\`{}\ is\ the\ array\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00222}00222\ \textcolor{stringliteral}{\ \ \ \ frequencies,\ and\ \`{}\`{}h\`{}\`{}\ is\ the\ corresponding\ complex\ array\ of\ frequency}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00223}00223\ \textcolor{stringliteral}{\ \ \ \ responses.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00224}00224\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00225}00225\ \textcolor{stringliteral}{\ \ \ \ >>>\ w,\ h\ =\ freqz(taps,\ worN=8000)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ >>>\ w\ *=\ 0.5*fs/np.pi\ \ \#\ Convert\ w\ to\ Hz.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00227}00227\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ Compute\ the\ deviation\ of\ the\ magnitude\ of\ the\ filter's\ response\ from}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ that\ of\ the\ ideal\ lowpass\ filter.\ Values\ in\ the\ transition\ region\ are}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00230}00230\ \textcolor{stringliteral}{\ \ \ \ set\ to\ \`{}\`{}nan\`{}\`{},\ so\ they\ won't\ appear\ in\ the\ plot.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00231}00231\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00232}00232\ \textcolor{stringliteral}{\ \ \ \ >>>\ ideal\ =\ w\ <\ cutoff\ \ \#\ The\ "{}ideal"{}\ frequency\ response.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00233}00233\ \textcolor{stringliteral}{\ \ \ \ >>>\ deviation\ =\ np.abs(np.abs(h)\ -\/\ ideal)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ >>>\ deviation[(w\ >\ cutoff\ -\/\ 0.5*width)\ \&\ (w\ <\ cutoff\ +\ 0.5*width)]\ =\ np.nan}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00235}00235\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ Plot\ the\ deviation.\ A\ close\ look\ at\ the\ left\ end\ of\ the\ stop\ band\ shows}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ that\ the\ requirement\ for\ 65\ dB\ attenuation\ is\ violated\ in\ the\ first\ lobe}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00238}00238\ \textcolor{stringliteral}{\ \ \ \ by\ about\ 0.125\ dB.\ This\ is\ not\ unusual\ for\ the\ Kaiser\ window\ method.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00239}00239\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00240}00240\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.plot(w,\ 20*np.log10(np.abs(deviation)))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00241}00241\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.xlim(0,\ 0.5*fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00242}00242\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.ylim(-\/90,\ -\/60)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00243}00243\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.grid(alpha=0.25)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00244}00244\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.axhline(-\/65,\ color='r',\ ls='-\/-\/',\ alpha=0.3)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00245}00245\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.xlabel('Frequency\ (Hz)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00246}00246\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.ylabel('Deviation\ from\ ideal\ (dB)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00247}00247\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.title('Lowpass\ Filter\ Frequency\ Response')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00248}00248\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00249}00249\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00251}00251\ \ \ \ \ A\ =\ abs(ripple)\ \ \textcolor{comment}{\#\ in\ case\ somebody\ is\ confused\ as\ to\ what's\ meant}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00252}00252\ \ \ \ \ \textcolor{keywordflow}{if}\ A\ <\ 8:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Formula\ for\ N\ is\ not\ valid\ in\ this\ range.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Requested\ maximum\ ripple\ attentuation\ \%f\ is\ too\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}small\ for\ the\ Kaiser\ formula."{}}\ \%\ A)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00256}00256\ \ \ \ \ beta\ =\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a3aa1c6de0dbaf7aa0f1121be85ff1c3f}{kaiser\_beta}}(A)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00258}00258\ \ \ \ \ \textcolor{comment}{\#\ Kaiser's\ formula\ (as\ given\ in\ Oppenheim\ and\ Schafer)\ is\ for\ the\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00259}00259\ \ \ \ \ \textcolor{comment}{\#\ order,\ so\ we\ have\ to\ add\ 1\ to\ get\ the\ number\ of\ taps.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00260}00260\ \ \ \ \ numtaps\ =\ (A\ -\/\ 7.95)\ /\ 2.285\ /\ (np.pi\ *\ width)\ +\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00262}00262\ \ \ \ \ \textcolor{keywordflow}{return}\ int(ceil(numtaps)),\ beta}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00263}00263\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00265}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a74e940213231a4c6a1271017ee67a9ab}{00265}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a74e940213231a4c6a1271017ee67a9ab}{firwin}}(numtaps,\ cutoff,\ width=None,\ window='hamming',\ pass\_zero=True,}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ scale=True,\ nyq=None,\ fs=None):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00267}00267\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ FIR\ filter\ design\ using\ the\ window\ method.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00269}00269\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ This\ function\ computes\ the\ coefficients\ of\ a\ finite\ impulse\ response}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ filter.\ The\ filter\ will\ have\ linear\ phase;\ it\ will\ be\ Type\ I\ if}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ \`{}numtaps\`{}\ is\ odd\ and\ Type\ II\ if\ \`{}numtaps\`{}\ is\ even.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00273}00273\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ Type\ II\ filters\ always\ have\ zero\ response\ at\ the\ Nyquist\ frequency,\ so\ a}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ ValueError\ exception\ is\ raised\ if\ firwin\ is\ called\ with\ \`{}numtaps\`{}\ even\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ having\ a\ passband\ whose\ right\ end\ is\ at\ the\ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00277}00277\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00278}00278\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00279}00279\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00280}00280\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Length\ of\ the\ filter\ (number\ of\ coefficients,\ i.e.\ the\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ order\ +\ 1).\ \ \`{}numtaps\`{}\ must\ be\ odd\ if\ a\ passband\ includes\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00283}00283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ cutoff\ :\ float\ or\ 1-\/D\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00285}00285\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Cutoff\ frequency\ of\ filter\ (expressed\ in\ the\ same\ units\ as\ \`{}fs\`{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ OR\ an\ array\ of\ cutoff\ frequencies\ (that\ is,\ band\ edges).\ In\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ latter\ case,\ the\ frequencies\ in\ \`{}cutoff\`{}\ should\ be\ positive\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ monotonically\ increasing\ between\ 0\ and\ \`{}fs/2\`{}.\ The\ values\ 0\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00289}00289\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}fs/2\`{}\ must\ not\ be\ included\ in\ \`{}cutoff\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ width\ :\ float\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ \`{}width\`{}\ is\ not\ None,\ then\ assume\ it\ is\ the\ approximate\ width}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ the\ transition\ region\ (expressed\ in\ the\ same\ units\ as\ \`{}fs\`{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ use\ in\ Kaiser\ FIR\ filter\ design.\ In\ this\ case,\ the\ \`{}window\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ argument\ is\ ignored.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ window\ :\ string\ or\ tuple\ of\ string\ and\ parameter\ values,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Desired\ window\ to\ use.\ See\ \`{}scipy.signal.get\_window\`{}\ for\ a\ list}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ of\ windows\ and\ required\ parameters.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ pass\_zero\ :\ \{True,\ False,\ 'bandpass',\ 'lowpass',\ 'highpass',\ 'bandstop'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ True,\ the\ gain\ at\ the\ frequency\ 0\ (i.e.,\ the\ "{}DC\ gain"{})\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ False,\ the\ DC\ gain\ is\ 0.\ Can\ also\ be\ a\ string\ argument\ for\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ desired\ filter\ type\ (equivalent\ to\ \`{}\`{}btype\`{}\`{}\ in\ IIR\ design\ functions).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00302}00302\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ versionadded::\ 1.3.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Support\ for\ string\ arguments.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ scale\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Set\ to\ True\ to\ scale\ the\ coefficients\ so\ that\ the\ frequency}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ response\ is\ exactly\ unity\ at\ a\ certain\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ That\ frequency\ is\ either:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00309}00309\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ 0\ (DC)\ if\ the\ first\ passband\ starts\ at\ 0\ (i.e.\ pass\_zero}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ is\ True)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ \`{}fs/2\`{}\ (the\ Nyquist\ frequency)\ if\ the\ first\ passband\ ends\ at}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \`{}fs/2\`{}\ (i.e\ the\ filter\ is\ a\ single\ band\ highpass\ filter);}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ center\ of\ first\ passband\ otherwise}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00315}00315\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ nyq\ :\ float,\ optional,\ deprecated}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ is\ the\ Nyquist\ frequency.\ Each\ frequency\ in\ \`{}cutoff\`{}\ must\ be}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00318}00318\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ between\ 0\ and\ \`{}nyq\`{}.\ Default\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00319}00319\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ deprecated::\ 1.0.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \`{}firwin\`{}\ keyword\ argument\ \`{}nyq\`{}\ is\ deprecated\ in\ favour\ of\ \`{}fs\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ will\ be\ removed\ in\ SciPy\ 1.12.0.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ fs\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sampling\ frequency\ of\ the\ signal.\ Each\ frequency\ in\ \`{}cutoff\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00325}00325\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ must\ be\ between\ 0\ and\ \`{}\`{}fs/2\`{}\`{}.\ \ Default\ is\ 2.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00326}00326\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00329}00329\ \textcolor{stringliteral}{\ \ \ \ h\ :\ (numtaps,)\ ndarray}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Coefficients\ of\ length\ \`{}numtaps\`{}\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00331}00331\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ Raises}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00333}00333\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ ValueError}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ any\ value\ in\ \`{}cutoff\`{}\ is\ less\ than\ or\ equal\ to\ 0\ or\ greater}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ than\ or\ equal\ to\ \`{}\`{}fs/2\`{}\`{},\ if\ the\ values\ in\ \`{}cutoff\`{}\ are\ not\ strictly}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ monotonically\ increasing,\ or\ if\ \`{}numtaps\`{}\ is\ even\ but\ a\ passband}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ includes\ the\ Nyquist\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00339}00339\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ firwin2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ firls}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ minimum\_phase}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ remez}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00346}00346\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ Low-\/pass\ from\ 0\ to\ f:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00350}00350\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ signal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps\ =\ 3}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ >>>\ f\ =\ 0.1}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ f)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00355}00355\ \textcolor{stringliteral}{\ \ \ \ array([\ 0.06799017,\ \ 0.86401967,\ \ 0.06799017])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00356}00356\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ Use\ a\ specific\ window\ function:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00358}00358\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ f,\ window='nuttall')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ array([\ \ 3.56607041e-\/04,\ \ \ 9.99286786e-\/01,\ \ \ 3.56607041e-\/04])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00361}00361\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00362}00362\ \textcolor{stringliteral}{\ \ \ \ High-\/pass\ ('stop'\ from\ 0\ to\ f):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00363}00363\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ f,\ pass\_zero=False)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00365}00365\ \textcolor{stringliteral}{\ \ \ \ array([-\/0.00859313,\ \ 0.98281375,\ -\/0.00859313])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00366}00366\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ Band-\/pass:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00368}00368\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ >>>\ f1,\ f2\ =\ 0.1,\ 0.2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ [f1,\ f2],\ pass\_zero=False)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ array([\ 0.06301614,\ \ 0.88770441,\ \ 0.06301614])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00372}00372\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00373}00373\ \textcolor{stringliteral}{\ \ \ \ Band-\/stop:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00374}00374\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ [f1,\ f2])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ array([-\/0.00801395,\ \ 1.0160279\ ,\ -\/0.00801395])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00377}00377\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00378}00378\ \textcolor{stringliteral}{\ \ \ \ Multi-\/band\ (passbands\ are\ [0,\ f1],\ [f2,\ f3]\ and\ [f4,\ 1]):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00379}00379\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ >>>\ f3,\ f4\ =\ 0.3,\ 0.4}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ [f1,\ f2,\ f3,\ f4])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ array([-\/0.01376344,\ \ 1.02752689,\ -\/0.01376344])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00383}00383\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ Multi-\/band\ (passbands\ are\ [f1,\ f2]\ and\ [f3,f4]):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00385}00385\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ >>>\ signal.firwin(numtaps,\ [f1,\ f2,\ f3,\ f4],\ pass\_zero=False)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00387}00387\ \textcolor{stringliteral}{\ \ \ \ array([\ 0.04890915,\ \ 0.91284326,\ \ 0.04890915])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00388}00388\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}\ \ \textcolor{comment}{\#\ noqa:\ E501}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00390}00390\ \ \ \ \ \textcolor{comment}{\#\ The\ major\ enhancements\ to\ this\ function\ added\ in\ November\ 2010\ were}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00391}00391\ \ \ \ \ \textcolor{comment}{\#\ developed\ by\ Tom\ Krauss\ (see\ ticket\ \#902).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00392}00392\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00393}00393\ \ \ \ \ nyq\ =\ 0.5\ *\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a9b6d9b077f47727a463a031e87df6327}{\_get\_fs}}(fs,\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00394}00394\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00395}00395\ \ \ \ \ cutoff\ =\ np.atleast\_1d(cutoff)\ /\ float(nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00396}00396\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00397}00397\ \ \ \ \ \textcolor{comment}{\#\ Check\ for\ invalid\ input.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00398}00398\ \ \ \ \ \textcolor{keywordflow}{if}\ cutoff.ndim\ >\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}The\ cutoff\ argument\ must\ be\ at\ most\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00400}00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}one-\/dimensional."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00401}00401\ \ \ \ \ \textcolor{keywordflow}{if}\ cutoff.size\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}At\ least\ one\ cutoff\ frequency\ must\ be\ given."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00403}00403\ \ \ \ \ \textcolor{keywordflow}{if}\ cutoff.min()\ <=\ 0\ \textcolor{keywordflow}{or}\ cutoff.max()\ >=\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Invalid\ cutoff\ frequency:\ frequencies\ must\ be\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}greater\ than\ 0\ and\ less\ than\ fs/2."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00406}00406\ \ \ \ \ \textcolor{keywordflow}{if}\ np.any(np.diff(cutoff)\ <=\ 0):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Invalid\ cutoff\ frequencies:\ the\ frequencies\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}must\ be\ strictly\ increasing."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00409}00409\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00410}00410\ \ \ \ \ \textcolor{keywordflow}{if}\ width\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00411}00411\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ width\ was\ given.\ \ Find\ the\ beta\ parameter\ of\ the\ Kaiser\ window}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00412}00412\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ set\ \`{}window`.\ \ This\ overrides\ the\ value\ of\ \`{}window`\ passed\ in.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00413}00413\ \ \ \ \ \ \ \ \ atten\ =\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a50ac7cf55e5243fdc7cbac8b63108b0a}{kaiser\_atten}}(numtaps,\ float(width)\ /\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ beta\ =\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a3aa1c6de0dbaf7aa0f1121be85ff1c3f}{kaiser\_beta}}(atten)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00415}00415\ \ \ \ \ \ \ \ \ window\ =\ (\textcolor{stringliteral}{'kaiser'},\ beta)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00417}00417\ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(pass\_zero,\ str):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00418}00418\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pass\_zero\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'bandstop'},\ \textcolor{stringliteral}{'lowpass'}):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pass\_zero\ ==\ \textcolor{stringliteral}{'lowpass'}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cutoff.size\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'cutoff\ must\ have\ one\ element\ if\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00422}00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'pass\_zero=="{}lowpass"{},\ got\ \%s'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00423}00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (cutoff.shape,))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ cutoff.size\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'cutoff\ must\ have\ at\ least\ two\ elements\ if\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'pass\_zero=="{}bandstop"{},\ got\ \%s'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (cutoff.shape,))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00428}00428\ \ \ \ \ \ \ \ \ \ \ \ \ pass\_zero\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00429}00429\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ pass\_zero\ \textcolor{keywordflow}{in}\ (\textcolor{stringliteral}{'bandpass'},\ \textcolor{stringliteral}{'highpass'}):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pass\_zero\ ==\ \textcolor{stringliteral}{'highpass'}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00431}00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cutoff.size\ !=\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00432}00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'cutoff\ must\ have\ one\ element\ if\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'pass\_zero=="{}highpass"{},\ got\ \%s'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00434}00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (cutoff.shape,))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ cutoff.size\ <=\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'cutoff\ must\ have\ at\ least\ two\ elements\ if\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'pass\_zero=="{}bandpass"{},\ got\ \%s'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00438}00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (cutoff.shape,))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00439}00439\ \ \ \ \ \ \ \ \ \ \ \ \ pass\_zero\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00440}00440\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00441}00441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'pass\_zero\ must\ be\ True,\ False,\ "{}bandpass"{},\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00442}00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'"{}lowpass"{},\ "{}highpass"{},\ or\ "{}bandstop"{},\ got\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00443}00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\{\}'}.format(pass\_zero))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00444}00444\ \ \ \ \ pass\_zero\ =\ bool(operator.index(pass\_zero))\ \ \textcolor{comment}{\#\ ensure\ bool-\/like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00445}00445\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00446}00446\ \ \ \ \ pass\_nyquist\ =\ bool(cutoff.size\ \&\ 1)\ \string^\ pass\_zero}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00447}00447\ \ \ \ \ \textcolor{keywordflow}{if}\ pass\_nyquist\ \textcolor{keywordflow}{and}\ numtaps\ \%\ 2\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00448}00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}A\ filter\ with\ an\ even\ number\ of\ coefficients\ must\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00449}00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}have\ zero\ response\ at\ the\ Nyquist\ frequency."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00450}00450\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00451}00451\ \ \ \ \ \textcolor{comment}{\#\ Insert\ 0\ and/or\ 1\ at\ the\ ends\ of\ cutoff\ so\ that\ the\ length\ of\ cutoff}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00452}00452\ \ \ \ \ \textcolor{comment}{\#\ is\ even,\ and\ each\ pair\ in\ cutoff\ corresponds\ to\ passband.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00453}00453\ \ \ \ \ cutoff\ =\ np.hstack(([0.0]\ *\ pass\_zero,\ cutoff,\ [1.0]\ *\ pass\_nyquist))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00454}00454\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00455}00455\ \ \ \ \ \textcolor{comment}{\#\ \`{}bands`\ is\ a\ 2-\/D\ array;\ each\ row\ gives\ the\ left\ and\ right\ edges\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00456}00456\ \ \ \ \ \textcolor{comment}{\#\ a\ passband.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00457}00457\ \ \ \ \ bands\ =\ cutoff.reshape(-\/1,\ 2)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00458}00458\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00459}00459\ \ \ \ \ \textcolor{comment}{\#\ Build\ up\ the\ coefficients.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00460}00460\ \ \ \ \ alpha\ =\ 0.5\ *\ (numtaps\ -\/\ 1)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00461}00461\ \ \ \ \ m\ =\ np.arange(0,\ numtaps)\ -\/\ alpha}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00462}00462\ \ \ \ \ h\ =\ 0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00463}00463\ \ \ \ \ \textcolor{keywordflow}{for}\ left,\ right\ \textcolor{keywordflow}{in}\ bands:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00464}00464\ \ \ \ \ \ \ \ \ h\ +=\ right\ *\ sinc(right\ *\ m)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00465}00465\ \ \ \ \ \ \ \ \ h\ -\/=\ left\ *\ sinc(left\ *\ m)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00466}00466\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00467}00467\ \ \ \ \ \textcolor{comment}{\#\ Get\ and\ apply\ the\ window\ function.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00468}00468\ \ \ \ \ \textcolor{keyword}{from}\ .windows\ \textcolor{keyword}{import}\ get\_window}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00469}00469\ \ \ \ \ win\ =\ get\_window(window,\ numtaps,\ fftbins=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00470}00470\ \ \ \ \ h\ *=\ win}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00471}00471\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00472}00472\ \ \ \ \ \textcolor{comment}{\#\ Now\ handle\ scaling\ if\ desired.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00473}00473\ \ \ \ \ \textcolor{keywordflow}{if}\ scale:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00474}00474\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Get\ the\ first\ passband.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00475}00475\ \ \ \ \ \ \ \ \ left,\ right\ =\ bands[0]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ left\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ \ \ \ \ scale\_frequency\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ right\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ \ \ \ \ scale\_frequency\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00481}00481\ \ \ \ \ \ \ \ \ \ \ \ \ scale\_frequency\ =\ 0.5\ *\ (left\ +\ right)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ c\ =\ np.cos(np.pi\ *\ m\ *\ scale\_frequency)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00483}00483\ \ \ \ \ \ \ \ \ s\ =\ np.sum(h\ *\ c)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00484}00484\ \ \ \ \ \ \ \ \ h\ /=\ s}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00485}00485\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00486}00486\ \ \ \ \ \textcolor{keywordflow}{return}\ h}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00488}00488\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00489}00489\ \textcolor{comment}{\#\ Original\ version\ of\ firwin2\ from\ scipy\ ticket\ \#457,\ submitted\ by\ "{}tash"{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00490}00490\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00491}00491\ \textcolor{comment}{\#\ Rewritten\ by\ Warren\ Weckesser,\ 2010.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00492}00492\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00493}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a1f7877c78a419877dd794b26a3c807cd}{00493}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a1f7877c78a419877dd794b26a3c807cd}{firwin2}}(numtaps,\ freq,\ gain,\ nfreqs=None,\ window='hamming',\ nyq=None,}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00494}00494\ \ \ \ \ \ \ \ \ \ \ \ \ antisymmetric=False,\ fs=None):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00495}00495\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00496}00496\ \textcolor{stringliteral}{\ \ \ \ FIR\ filter\ design\ using\ the\ window\ method.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00497}00497\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00498}00498\ \textcolor{stringliteral}{\ \ \ \ From\ the\ given\ frequencies\ \`{}freq\`{}\ and\ corresponding\ gains\ \`{}gain\`{},}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00499}00499\ \textcolor{stringliteral}{\ \ \ \ this\ function\ constructs\ an\ FIR\ filter\ with\ linear\ phase\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00500}00500\ \textcolor{stringliteral}{\ \ \ \ (approximately)\ the\ given\ frequency\ response.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00501}00501\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00502}00502\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00503}00503\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00504}00504\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00505}00505\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ taps\ in\ the\ FIR\ filter.\ \ \`{}numtaps\`{}\ must\ be\ less\ than}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00506}00506\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}nfreqs\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00507}00507\ \textcolor{stringliteral}{\ \ \ \ freq\ :\ array\_like,\ 1-\/D}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00508}00508\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ frequency\ sampling\ points.\ Typically\ 0.0\ to\ 1.0\ with\ 1.0\ being}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00509}00509\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Nyquist.\ \ The\ Nyquist\ frequency\ is\ half\ \`{}fs\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00510}00510\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ values\ in\ \`{}freq\`{}\ must\ be\ nondecreasing.\ A\ value\ can\ be\ repeated}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00511}00511\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ once\ to\ implement\ a\ discontinuity.\ The\ first\ value\ in\ \`{}freq\`{}\ must}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00512}00512\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ be\ 0,\ and\ the\ last\ value\ must\ be\ \`{}\`{}fs/2\`{}\`{}.\ Values\ 0\ and\ \`{}\`{}fs/2\`{}\`{}\ must}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00513}00513\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ not\ be\ repeated.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00514}00514\ \textcolor{stringliteral}{\ \ \ \ gain\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00515}00515\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ filter\ gains\ at\ the\ frequency\ sampling\ points.\ Certain}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00516}00516\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ constraints\ to\ gain\ values,\ depending\ on\ the\ filter\ type,\ are\ applied,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00517}00517\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ see\ Notes\ for\ details.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00518}00518\ \textcolor{stringliteral}{\ \ \ \ nfreqs\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00519}00519\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ size\ of\ the\ interpolation\ mesh\ used\ to\ construct\ the\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00520}00520\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ For\ most\ efficient\ behavior,\ this\ should\ be\ a\ power\ of\ 2\ plus\ 1}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00521}00521\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (e.g,\ 129,\ 257,\ etc).\ The\ default\ is\ one\ more\ than\ the\ smallest}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00522}00522\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ power\ of\ 2\ that\ is\ not\ less\ than\ \`{}numtaps\`{}.\ \`{}nfreqs\`{}\ must\ be\ greater}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00523}00523\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ than\ \`{}numtaps\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00524}00524\ \textcolor{stringliteral}{\ \ \ \ window\ :\ string\ or\ (string,\ float)\ or\ float,\ or\ None,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00525}00525\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Window\ function\ to\ use.\ Default\ is\ "{}hamming"{}.\ See}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00526}00526\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}scipy.signal.get\_window\`{}\ for\ the\ complete\ list\ of\ possible\ values.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00527}00527\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ None,\ no\ window\ function\ is\ applied.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00528}00528\ \textcolor{stringliteral}{\ \ \ \ nyq\ :\ float,\ optional,\ deprecated}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00529}00529\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ is\ the\ Nyquist\ frequency.\ Each\ frequency\ in\ \`{}freq\`{}\ must\ be}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00530}00530\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ between\ 0\ and\ \`{}nyq\`{}.\ Default\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00531}00531\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00532}00532\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ deprecated::\ 1.0.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00533}00533\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \`{}firwin2\`{}\ keyword\ argument\ \`{}nyq\`{}\ is\ deprecated\ in\ favour\ of\ \`{}fs\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00534}00534\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ will\ be\ removed\ in\ SciPy\ 1.12.0.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00535}00535\ \textcolor{stringliteral}{\ \ \ \ antisymmetric\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00536}00536\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Whether\ resulting\ impulse\ response\ is\ symmetric/antisymmetric.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00537}00537\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ See\ Notes\ for\ more\ details.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00538}00538\ \textcolor{stringliteral}{\ \ \ \ fs\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00539}00539\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sampling\ frequency\ of\ the\ signal.\ Each\ frequency\ in\ \`{}cutoff\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00540}00540\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ must\ be\ between\ 0\ and\ \`{}\`{}fs/2\`{}\`{}.\ Default\ is\ 2.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00541}00541\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00542}00542\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00543}00543\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00544}00544\ \textcolor{stringliteral}{\ \ \ \ taps\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00545}00545\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ filter\ coefficients\ of\ the\ FIR\ filter,\ as\ a\ 1-\/D\ array\ of\ length}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00546}00546\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}numtaps\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00547}00547\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00548}00548\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00549}00549\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00550}00550\ \textcolor{stringliteral}{\ \ \ \ firls}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00551}00551\ \textcolor{stringliteral}{\ \ \ \ firwin}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00552}00552\ \textcolor{stringliteral}{\ \ \ \ minimum\_phase}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00553}00553\ \textcolor{stringliteral}{\ \ \ \ remez}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00554}00554\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00555}00555\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00556}00556\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00557}00557\ \textcolor{stringliteral}{\ \ \ \ From\ the\ given\ set\ of\ frequencies\ and\ gains,\ the\ desired\ response\ is}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00558}00558\ \textcolor{stringliteral}{\ \ \ \ constructed\ in\ the\ frequency\ domain.\ The\ inverse\ FFT\ is\ applied\ to\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00559}00559\ \textcolor{stringliteral}{\ \ \ \ desired\ response\ to\ create\ the\ associated\ convolution\ kernel,\ and\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ first\ \`{}numtaps\`{}\ coefficients\ of\ this\ kernel,\ scaled\ by\ \`{}window\`{},\ are}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00561}00561\ \textcolor{stringliteral}{\ \ \ \ returned.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00562}00562\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00563}00563\ \textcolor{stringliteral}{\ \ \ \ The\ FIR\ filter\ will\ have\ linear\ phase.\ The\ type\ of\ filter\ is\ determined\ by}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00564}00564\ \textcolor{stringliteral}{\ \ \ \ the\ value\ of\ 'numtaps\`{}\ and\ \`{}antisymmetric\`{}\ flag.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00565}00565\ \textcolor{stringliteral}{\ \ \ \ There\ are\ four\ possible\ combinations:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00566}00566\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00567}00567\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ odd\ \ \`{}numtaps\`{},\ \`{}antisymmetric\`{}\ is\ False,\ type\ I\ filter\ is\ produced}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00568}00568\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ even\ \`{}numtaps\`{},\ \`{}antisymmetric\`{}\ is\ False,\ type\ II\ filter\ is\ produced}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00569}00569\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ odd\ \ \`{}numtaps\`{},\ \`{}antisymmetric\`{}\ is\ True,\ type\ III\ filter\ is\ produced}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00570}00570\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ even\ \`{}numtaps\`{},\ \`{}antisymmetric\`{}\ is\ True,\ type\ IV\ filter\ is\ produced}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00571}00571\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00572}00572\ \textcolor{stringliteral}{\ \ \ \ Magnitude\ response\ of\ all\ but\ type\ I\ filters\ are\ subjects\ to\ following}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00573}00573\ \textcolor{stringliteral}{\ \ \ \ constraints:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00574}00574\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00575}00575\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ type\ II\ \ -\/-\/\ zero\ at\ the\ Nyquist\ frequency}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00576}00576\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ type\ III\ -\/-\/\ zero\ at\ zero\ and\ Nyquist\ frequencies}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00577}00577\ \textcolor{stringliteral}{\ \ \ \ \ \ \ -\/\ type\ IV\ \ -\/-\/\ zero\ at\ zero\ frequency}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00578}00578\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00579}00579\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.9.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00580}00580\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00581}00581\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00582}00582\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00583}00583\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Oppenheim,\ A.\ V.\ and\ Schafer,\ R.\ W.,\ "{}Discrete-\/Time\ Signal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00584}00584\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Processing"{},\ Prentice-\/Hall,\ Englewood\ Cliffs,\ New\ Jersey\ (1989).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00585}00585\ \textcolor{stringliteral}{\ \ \ \ \ \ \ (See,\ for\ example,\ Section\ 7.4.)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00586}00586\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00587}00587\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ Smith,\ Steven\ W.,\ "{}The\ Scientist\ and\ Engineer's\ Guide\ to\ Digital}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00588}00588\ \textcolor{stringliteral}{\ \ \ \ \ \ \ Signal\ Processing"{},\ Ch.\ 17.\ http://www.dspguide.com/ch17/1.htm}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00589}00589\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00590}00590\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00591}00591\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00592}00592\ \textcolor{stringliteral}{\ \ \ \ A\ lowpass\ FIR\ filter\ with\ a\ response\ that\ is\ 1\ on\ [0.0,\ 0.5],\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00593}00593\ \textcolor{stringliteral}{\ \ \ \ that\ decreases\ linearly\ on\ [0.5,\ 1.0]\ from\ 1\ to\ 0:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00594}00594\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00595}00595\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ signal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00596}00596\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ signal.firwin2(150,\ [0.0,\ 0.5,\ 1.0],\ [1.0,\ 1.0,\ 0.0])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00597}00597\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(taps[72:78])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00598}00598\ \textcolor{stringliteral}{\ \ \ \ [-\/0.02286961\ -\/0.06362756\ \ 0.57310236\ \ 0.57310236\ -\/0.06362756\ -\/0.02286961]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00599}00599\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00600}00600\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00601}00601\ \ \ \ \ nyq\ =\ 0.5\ *\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a9b6d9b077f47727a463a031e87df6327}{\_get\_fs}}(fs,\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00602}00602\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00603}00603\ \ \ \ \ \textcolor{keywordflow}{if}\ len(freq)\ !=\ len(gain):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00604}00604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'freq\ and\ gain\ must\ be\ of\ same\ length.'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00605}00605\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00606}00606\ \ \ \ \ \textcolor{keywordflow}{if}\ nfreqs\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ numtaps\ >=\ nfreqs:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00607}00607\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}((\textcolor{stringliteral}{'ntaps\ must\ be\ less\ than\ nfreqs,\ but\ firwin2\ was\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'called\ with\ ntaps=\%d\ and\ nfreqs=\%s'})\ \%}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (numtaps,\ nfreqs))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00610}00610\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00611}00611\ \ \ \ \ \textcolor{keywordflow}{if}\ freq[0]\ !=\ 0\ \textcolor{keywordflow}{or}\ freq[-\/1]\ !=\ nyq:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'freq\ must\ start\ with\ 0\ and\ end\ with\ fs/2.'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00613}00613\ \ \ \ \ d\ =\ np.diff(freq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00614}00614\ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ <\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'The\ values\ in\ freq\ must\ be\ nondecreasing.'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00616}00616\ \ \ \ \ d2\ =\ d[:-\/1]\ +\ d[1:]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00617}00617\ \ \ \ \ \textcolor{keywordflow}{if}\ (d2\ ==\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00618}00618\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'A\ value\ in\ freq\ must\ not\ occur\ more\ than\ twice.'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00619}00619\ \ \ \ \ \textcolor{keywordflow}{if}\ freq[1]\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'Value\ 0\ must\ not\ be\ repeated\ in\ freq'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00621}00621\ \ \ \ \ \textcolor{keywordflow}{if}\ freq[-\/2]\ ==\ nyq:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'Value\ fs/2\ must\ not\ be\ repeated\ in\ freq'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00623}00623\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00624}00624\ \ \ \ \ \textcolor{keywordflow}{if}\ antisymmetric:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ numtaps\ \%\ 2\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ ftype\ =\ 4}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \ \ \ ftype\ =\ 3}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00629}00629\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00630}00630\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ numtaps\ \%\ 2\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ ftype\ =\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ ftype\ =\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00634}00634\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00635}00635\ \ \ \ \ \textcolor{keywordflow}{if}\ ftype\ ==\ 2\ \textcolor{keywordflow}{and}\ gain[-\/1]\ !=\ 0.0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}A\ Type\ II\ filter\ must\ have\ zero\ gain\ at\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00637}00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Nyquist\ frequency."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00638}00638\ \ \ \ \ \textcolor{keywordflow}{elif}\ ftype\ ==\ 3\ \textcolor{keywordflow}{and}\ (gain[0]\ !=\ 0.0\ \textcolor{keywordflow}{or}\ gain[-\/1]\ !=\ 0.0):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00639}00639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}A\ Type\ III\ filter\ must\ have\ zero\ gain\ at\ zero\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00640}00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}and\ Nyquist\ frequencies."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00641}00641\ \ \ \ \ \textcolor{keywordflow}{elif}\ ftype\ ==\ 4\ \textcolor{keywordflow}{and}\ gain[0]\ !=\ 0.0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00642}00642\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}A\ Type\ IV\ filter\ must\ have\ zero\ gain\ at\ zero\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00643}00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}frequency."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00644}00644\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00645}00645\ \ \ \ \ \textcolor{keywordflow}{if}\ nfreqs\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00646}00646\ \ \ \ \ \ \ \ \ nfreqs\ =\ 1\ +\ 2\ **\ int(ceil(log(numtaps,\ 2)))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00647}00647\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00648}00648\ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ ==\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Tweak\ any\ repeated\ values\ in\ freq\ so\ that\ interp\ works.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ freq\ =\ np.array(freq,\ copy=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ eps\ =\ np.finfo(float).eps\ *\ nyq}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k\ \textcolor{keywordflow}{in}\ range(len(freq)\ -\/\ 1):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ freq[k]\ ==\ freq[k\ +\ 1]:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ freq[k]\ =\ freq[k]\ -\/\ eps}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ freq[k\ +\ 1]\ =\ freq[k\ +\ 1]\ +\ eps}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ freq\ is\ strictly\ increasing\ after\ tweak}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ d\ =\ np.diff(freq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ <=\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00659}00659\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}freq\ cannot\ contain\ numbers\ that\ are\ too\ close\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(within\ eps\ *\ (fs/2):\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\{\})\ to\ a\ repeated\ value"{}}.format(eps))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00662}00662\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00663}00663\ \ \ \ \ \textcolor{comment}{\#\ Linearly\ interpolate\ the\ desired\ response\ on\ a\ uniform\ mesh\ \`{}x`.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00664}00664\ \ \ \ \ x\ =\ np.linspace(0.0,\ nyq,\ nfreqs)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00665}00665\ \ \ \ \ fx\ =\ np.interp(x,\ freq,\ gain)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00666}00666\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00667}00667\ \ \ \ \ \textcolor{comment}{\#\ Adjust\ the\ phases\ of\ the\ coefficients\ so\ that\ the\ first\ \`{}ntaps`\ of\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00668}00668\ \ \ \ \ \textcolor{comment}{\#\ inverse\ FFT\ are\ the\ desired\ filter\ coefficients.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00669}00669\ \ \ \ \ shift\ =\ np.exp(-\/(numtaps\ -\/\ 1)\ /\ 2.\ *\ 1.j\ *\ np.pi\ *\ x\ /\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00670}00670\ \ \ \ \ \textcolor{keywordflow}{if}\ ftype\ >\ 2:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00671}00671\ \ \ \ \ \ \ \ \ shift\ *=\ 1j}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00672}00672\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00673}00673\ \ \ \ \ fx2\ =\ fx\ *\ shift}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00674}00674\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00675}00675\ \ \ \ \ \textcolor{comment}{\#\ Use\ irfft\ to\ compute\ the\ inverse\ FFT.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00676}00676\ \ \ \ \ out\_full\ =\ irfft(fx2)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00677}00677\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00678}00678\ \ \ \ \ \textcolor{keywordflow}{if}\ window\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00679}00679\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Create\ the\ window\ to\ apply\ to\ the\ filter\ coefficients.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00680}00680\ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ .windows\ \textcolor{keyword}{import}\ get\_window}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00681}00681\ \ \ \ \ \ \ \ \ wind\ =\ get\_window(window,\ numtaps,\ fftbins=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00682}00682\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ wind\ =\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00684}00684\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00685}00685\ \ \ \ \ \textcolor{comment}{\#\ Keep\ only\ the\ first\ \`{}numtaps`\ coefficients\ in\ \`{}out`,\ and\ multiply\ by}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00686}00686\ \ \ \ \ \textcolor{comment}{\#\ the\ window.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00687}00687\ \ \ \ \ out\ =\ out\_full[:numtaps]\ *\ wind}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00688}00688\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00689}00689\ \ \ \ \ \textcolor{keywordflow}{if}\ ftype\ ==\ 3:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00690}00690\ \ \ \ \ \ \ \ \ out[out.size\ //\ 2]\ =\ 0.0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00691}00691\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00692}00692\ \ \ \ \ \textcolor{keywordflow}{return}\ out}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00693}00693\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00694}00694\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00695}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a909a3ff237b9a0c641ef2dd402a0a7ee}{00695}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a909a3ff237b9a0c641ef2dd402a0a7ee}{remez}}(numtaps,\ bands,\ desired,\ weight=None,\ Hz=None,\ type='bandpass',}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ maxiter=25,\ grid\_density=16,\ fs=None):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00697}00697\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00698}00698\ \textcolor{stringliteral}{\ \ \ \ Calculate\ the\ minimax\ optimal\ filter\ using\ the\ Remez\ exchange\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00699}00699\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00700}00700\ \textcolor{stringliteral}{\ \ \ \ Calculate\ the\ filter-\/coefficients\ for\ the\ finite\ impulse\ response}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00701}00701\ \textcolor{stringliteral}{\ \ \ \ (FIR)\ filter\ whose\ transfer\ function\ minimizes\ the\ maximum\ error}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00702}00702\ \textcolor{stringliteral}{\ \ \ \ between\ the\ desired\ gain\ and\ the\ realized\ gain\ in\ the\ specified}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00703}00703\ \textcolor{stringliteral}{\ \ \ \ frequency\ bands\ using\ the\ Remez\ exchange\ algorithm.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00704}00704\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00705}00705\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00706}00706\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00707}00707\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00708}00708\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ desired\ number\ of\ taps\ in\ the\ filter.\ The\ number\ of\ taps\ is}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00709}00709\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ number\ of\ terms\ in\ the\ filter,\ or\ the\ filter\ order\ plus\ one.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00710}00710\ \textcolor{stringliteral}{\ \ \ \ bands\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00711}00711\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ monotonic\ sequence\ containing\ the\ band\ edges.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00712}00712\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ All\ elements\ must\ be\ non-\/negative\ and\ less\ than\ half\ the\ sampling}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00713}00713\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ frequency\ as\ given\ by\ \`{}fs\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00714}00714\ \textcolor{stringliteral}{\ \ \ \ desired\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00715}00715\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ half\ the\ size\ of\ bands\ containing\ the\ desired\ gain}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00716}00716\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ in\ each\ of\ the\ specified\ bands.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00717}00717\ \textcolor{stringliteral}{\ \ \ \ weight\ :\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00718}00718\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ relative\ weighting\ to\ give\ to\ each\ band\ region.\ The\ length\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00719}00719\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}weight\`{}\ has\ to\ be\ half\ the\ length\ of\ \`{}bands\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00720}00720\ \textcolor{stringliteral}{\ \ \ \ Hz\ :\ scalar,\ optional,\ deprecated}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00721}00721\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sampling\ frequency\ in\ Hz.\ Default\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00722}00722\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00723}00723\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ deprecated::\ 1.0.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00724}00724\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \`{}remez\`{}\ keyword\ argument\ \`{}Hz\`{}\ is\ deprecated\ in\ favour\ of\ \`{}fs\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00725}00725\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ will\ be\ removed\ in\ SciPy\ 1.12.0.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00726}00726\ \textcolor{stringliteral}{\ \ \ \ type\ :\ \{'bandpass',\ 'differentiator',\ 'hilbert'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00727}00727\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ type\ of\ filter:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00728}00728\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00729}00729\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'bandpass'\ :\ flat\ response\ in\ bands.\ This\ is\ the\ default.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00730}00730\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00731}00731\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'differentiator'\ :\ frequency\ proportional\ response\ in\ bands.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00732}00732\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00733}00733\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ *\ 'hilbert'\ :\ filter\ with\ odd\ symmetry,\ that\ is,\ type\ III}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00734}00734\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (for\ even\ order)\ or\ type\ IV\ (for\ odd\ order)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00735}00735\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ linear\ phase\ filters.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00736}00736\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00737}00737\ \textcolor{stringliteral}{\ \ \ \ maxiter\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00738}00738\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maximum\ number\ of\ iterations\ of\ the\ algorithm.\ Default\ is\ 25.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00739}00739\ \textcolor{stringliteral}{\ \ \ \ grid\_density\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00740}00740\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Grid\ density.\ The\ dense\ grid\ used\ in\ \`{}remez\`{}\ is\ of\ size}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00741}00741\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(numtaps\ +\ 1)\ *\ grid\_density\`{}\`{}.\ Default\ is\ 16.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00742}00742\ \textcolor{stringliteral}{\ \ \ \ fs\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00743}00743\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sampling\ frequency\ of\ the\ signal.\ \ Default\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00744}00744\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00745}00745\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00746}00746\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00747}00747\ \textcolor{stringliteral}{\ \ \ \ out\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00748}00748\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ rank-\/1\ array\ containing\ the\ coefficients\ of\ the\ optimal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00749}00749\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ (in\ a\ minimax\ sense)\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00750}00750\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00751}00751\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00752}00752\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00753}00753\ \textcolor{stringliteral}{\ \ \ \ firls}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00754}00754\ \textcolor{stringliteral}{\ \ \ \ firwin}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00755}00755\ \textcolor{stringliteral}{\ \ \ \ firwin2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00756}00756\ \textcolor{stringliteral}{\ \ \ \ minimum\_phase}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00757}00757\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00758}00758\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00759}00759\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00760}00760\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ J.\ H.\ McClellan\ and\ T.\ W.\ Parks,\ "{}A\ unified\ approach\ to\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00761}00761\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ design\ of\ optimum\ FIR\ linear\ phase\ digital\ filters"{},}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00762}00762\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ IEEE\ Trans.\ Circuit\ Theory,\ vol.\ CT-\/20,\ pp.\ 697-\/701,\ 1973.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00763}00763\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ J.\ H.\ McClellan,\ T.\ W.\ Parks\ and\ L.\ R.\ Rabiner,\ "{}A\ Computer}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00764}00764\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Program\ for\ Designing\ Optimum\ FIR\ Linear\ Phase\ Digital}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00765}00765\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Filters"{},\ IEEE\ Trans.\ Audio\ Electroacoust.,\ vol.\ AU-\/21,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00766}00766\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ pp.\ 506-\/525,\ 1973.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00767}00767\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00768}00768\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00769}00769\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00770}00770\ \textcolor{stringliteral}{\ \ \ \ In\ these\ examples,\ \`{}remez\`{}\ is\ used\ to\ design\ low-\/pass,\ high-\/pass,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00771}00771\ \textcolor{stringliteral}{\ \ \ \ band-\/pass\ and\ band-\/stop\ filters.\ \ The\ parameters\ that\ define\ each\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00772}00772\ \textcolor{stringliteral}{\ \ \ \ are\ the\ filter\ order,\ the\ band\ boundaries,\ the\ transition\ widths\ of\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00773}00773\ \textcolor{stringliteral}{\ \ \ \ boundaries,\ the\ desired\ gains\ in\ each\ band,\ and\ the\ sampling\ frequency.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00774}00774\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00775}00775\ \textcolor{stringliteral}{\ \ \ \ We'll\ use\ a\ sample\ frequency\ of\ 22050\ Hz\ in\ all\ the\ examples.\ \ In\ each}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00776}00776\ \textcolor{stringliteral}{\ \ \ \ example,\ the\ desired\ gain\ in\ each\ band\ is\ either\ 0\ (for\ a\ stop\ band)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00777}00777\ \textcolor{stringliteral}{\ \ \ \ or\ 1\ (for\ a\ pass\ band).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00778}00778\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00779}00779\ \textcolor{stringliteral}{\ \ \ \ \`{}freqz\`{}\ is\ used\ to\ compute\ the\ frequency\ response\ of\ each\ filter,\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00780}00780\ \textcolor{stringliteral}{\ \ \ \ the\ utility\ function\ \`{}\`{}plot\_response\`{}\`{}\ defined\ below\ is\ used\ to\ plot}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00781}00781\ \textcolor{stringliteral}{\ \ \ \ the\ response.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00782}00782\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00783}00783\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00784}00784\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ signal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00785}00785\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00786}00786\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00787}00787\ \textcolor{stringliteral}{\ \ \ \ >>>\ fs\ =\ 22050\ \ \ \#\ Sample\ rate,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00788}00788\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00789}00789\ \textcolor{stringliteral}{\ \ \ \ >>>\ def\ plot\_response(w,\ h,\ title):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00790}00790\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ "{}Utility\ function\ to\ plot\ response\ functions"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00791}00791\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ fig\ =\ plt.figure()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00792}00792\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax\ =\ fig.add\_subplot(111)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00793}00793\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.plot(w,\ 20*np.log10(np.abs(h)))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00794}00794\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set\_ylim(-\/40,\ 5)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00795}00795\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.grid(True)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00796}00796\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set\_xlabel('Frequency\ (Hz)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00797}00797\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set\_ylabel('Gain\ (dB)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00798}00798\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set\_title(title)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00799}00799\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00800}00800\ \textcolor{stringliteral}{\ \ \ \ The\ first\ example\ is\ a\ low-\/pass\ filter,\ with\ cutoff\ frequency\ 8\ kHz.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00801}00801\ \textcolor{stringliteral}{\ \ \ \ The\ filter\ length\ is\ 325,\ and\ the\ transition\ width\ from\ pass\ to\ stop}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00802}00802\ \textcolor{stringliteral}{\ \ \ \ is\ 100\ Hz.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00803}00803\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00804}00804\ \textcolor{stringliteral}{\ \ \ \ >>>\ cutoff\ =\ 8000.0\ \ \ \ \#\ Desired\ cutoff\ frequency,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00805}00805\ \textcolor{stringliteral}{\ \ \ \ >>>\ trans\_width\ =\ 100\ \ \#\ Width\ of\ transition\ from\ pass\ to\ stop,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00806}00806\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps\ =\ 325\ \ \ \ \ \ \#\ Size\ of\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00807}00807\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ signal.remez(numtaps,\ [0,\ cutoff,\ cutoff\ +\ trans\_width,\ 0.5*fs],}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00808}00808\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [1,\ 0],\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00809}00809\ \textcolor{stringliteral}{\ \ \ \ >>>\ w,\ h\ =\ signal.freqz(taps,\ [1],\ worN=2000,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00810}00810\ \textcolor{stringliteral}{\ \ \ \ >>>\ plot\_response(w,\ h,\ "{}Low-\/pass\ Filter"{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00811}00811\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00812}00812\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00813}00813\ \textcolor{stringliteral}{\ \ \ \ This\ example\ shows\ a\ high-\/pass\ filter:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00814}00814\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00815}00815\ \textcolor{stringliteral}{\ \ \ \ >>>\ cutoff\ =\ 2000.0\ \ \ \ \#\ Desired\ cutoff\ frequency,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00816}00816\ \textcolor{stringliteral}{\ \ \ \ >>>\ trans\_width\ =\ 250\ \ \#\ Width\ of\ transition\ from\ pass\ to\ stop,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00817}00817\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps\ =\ 125\ \ \ \ \ \ \#\ Size\ of\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00818}00818\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ signal.remez(numtaps,\ [0,\ cutoff\ -\/\ trans\_width,\ cutoff,\ 0.5*fs],}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00819}00819\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 1],\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00820}00820\ \textcolor{stringliteral}{\ \ \ \ >>>\ w,\ h\ =\ signal.freqz(taps,\ [1],\ worN=2000,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00821}00821\ \textcolor{stringliteral}{\ \ \ \ >>>\ plot\_response(w,\ h,\ "{}High-\/pass\ Filter"{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00822}00822\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00823}00823\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00824}00824\ \textcolor{stringliteral}{\ \ \ \ This\ example\ shows\ a\ band-\/pass\ filter\ with\ a\ pass-\/band\ from\ 2\ kHz\ to}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00825}00825\ \textcolor{stringliteral}{\ \ \ \ 5\ kHz.\ \ The\ transition\ width\ is\ 260\ Hz\ and\ the\ length\ of\ the\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00826}00826\ \textcolor{stringliteral}{\ \ \ \ is\ 63,\ which\ is\ smaller\ than\ in\ the\ other\ examples:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00827}00827\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00828}00828\ \textcolor{stringliteral}{\ \ \ \ >>>\ band\ =\ [2000,\ 5000]\ \ \#\ Desired\ pass\ band,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00829}00829\ \textcolor{stringliteral}{\ \ \ \ >>>\ trans\_width\ =\ 260\ \ \ \ \#\ Width\ of\ transition\ from\ pass\ to\ stop,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00830}00830\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps\ =\ 63\ \ \ \ \ \ \ \ \ \#\ Size\ of\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00831}00831\ \textcolor{stringliteral}{\ \ \ \ >>>\ edges\ =\ [0,\ band[0]\ -\/\ trans\_width,\ band[0],\ band[1],}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00832}00832\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ band[1]\ +\ trans\_width,\ 0.5*fs]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00833}00833\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ signal.remez(numtaps,\ edges,\ [0,\ 1,\ 0],\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00834}00834\ \textcolor{stringliteral}{\ \ \ \ >>>\ w,\ h\ =\ signal.freqz(taps,\ [1],\ worN=2000,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00835}00835\ \textcolor{stringliteral}{\ \ \ \ >>>\ plot\_response(w,\ h,\ "{}Band-\/pass\ Filter"{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00836}00836\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00837}00837\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00838}00838\ \textcolor{stringliteral}{\ \ \ \ The\ low\ order\ leads\ to\ higher\ ripple\ and\ less\ steep\ transitions.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00839}00839\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00840}00840\ \textcolor{stringliteral}{\ \ \ \ The\ next\ example\ shows\ a\ band-\/stop\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00841}00841\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00842}00842\ \textcolor{stringliteral}{\ \ \ \ >>>\ band\ =\ [6000,\ 8000]\ \ \#\ Desired\ stop\ band,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00843}00843\ \textcolor{stringliteral}{\ \ \ \ >>>\ trans\_width\ =\ 200\ \ \ \ \#\ Width\ of\ transition\ from\ pass\ to\ stop,\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00844}00844\ \textcolor{stringliteral}{\ \ \ \ >>>\ numtaps\ =\ 175\ \ \ \ \ \ \ \ \#\ Size\ of\ the\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00845}00845\ \textcolor{stringliteral}{\ \ \ \ >>>\ edges\ =\ [0,\ band[0]\ -\/\ trans\_width,\ band[0],\ band[1],}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00846}00846\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ band[1]\ +\ trans\_width,\ 0.5*fs]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00847}00847\ \textcolor{stringliteral}{\ \ \ \ >>>\ taps\ =\ signal.remez(numtaps,\ edges,\ [1,\ 0,\ 1],\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00848}00848\ \textcolor{stringliteral}{\ \ \ \ >>>\ w,\ h\ =\ signal.freqz(taps,\ [1],\ worN=2000,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00849}00849\ \textcolor{stringliteral}{\ \ \ \ >>>\ plot\_response(w,\ h,\ "{}Band-\/stop\ Filter"{})}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00850}00850\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00851}00851\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00852}00852\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00853}00853\ \ \ \ \ \textcolor{keywordflow}{if}\ Hz\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ fs\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00854}00854\ \ \ \ \ \ \ \ \ fs\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00855}00855\ \ \ \ \ \textcolor{keywordflow}{elif}\ Hz\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00856}00856\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ fs\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00857}00857\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Values\ cannot\ be\ given\ for\ both\ 'Hz'\ and\ 'fs'."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00858}00858\ \ \ \ \ \ \ \ \ msg\ =\ (\textcolor{stringliteral}{"{}'remez'\ keyword\ argument\ 'Hz'\ is\ deprecated\ in\ favour\ of\ 'fs'"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00859}00859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ and\ will\ be\ removed\ in\ SciPy\ 1.12.0."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00860}00860\ \ \ \ \ \ \ \ \ warnings.warn(msg,\ DeprecationWarning,\ stacklevel=2)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00861}00861\ \ \ \ \ \ \ \ \ fs\ =\ Hz}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00862}00862\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00863}00863\ \ \ \ \ \textcolor{comment}{\#\ Convert\ type}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00864}00864\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00865}00865\ \ \ \ \ \ \ \ \ tnum\ =\ \{\textcolor{stringliteral}{'bandpass'}:\ 1,\ \textcolor{stringliteral}{'differentiator'}:\ 2,\ \textcolor{stringliteral}{'hilbert'}:\ 3\}[type]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00866}00866\ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00867}00867\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}Type\ must\ be\ 'bandpass',\ 'differentiator',\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00868}00868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}or\ 'hilbert'"{}})\ \textcolor{keyword}{from}\ e}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00869}00869\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00870}00870\ \ \ \ \ \textcolor{comment}{\#\ Convert\ weight}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00871}00871\ \ \ \ \ \textcolor{keywordflow}{if}\ weight\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00872}00872\ \ \ \ \ \ \ \ \ weight\ =\ [1]\ *\ len(desired)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00873}00873\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00874}00874\ \ \ \ \ bands\ =\ np.asarray(bands).copy()}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00875}00875\ \ \ \ \ \textcolor{keywordflow}{return}\ \_sigtools.\_remez(numtaps,\ bands,\ desired,\ weight,\ tnum,\ fs,}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00876}00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maxiter,\ grid\_density)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00877}00877\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00878}00878\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00879}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a30e0f668c9d6f42ff759cbf31c99b92d}{00879}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a30e0f668c9d6f42ff759cbf31c99b92d}{firls}}(numtaps,\ bands,\ desired,\ weight=None,\ nyq=None,\ fs=None):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00880}00880\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00881}00881\ \textcolor{stringliteral}{\ \ \ \ FIR\ filter\ design\ using\ least-\/squares\ error\ minimization.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00882}00882\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00883}00883\ \textcolor{stringliteral}{\ \ \ \ Calculate\ the\ filter\ coefficients\ for\ the\ linear-\/phase\ finite}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00884}00884\ \textcolor{stringliteral}{\ \ \ \ impulse\ response\ (FIR)\ filter\ which\ has\ the\ best\ approximation}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00885}00885\ \textcolor{stringliteral}{\ \ \ \ to\ the\ desired\ frequency\ response\ described\ by\ \`{}bands\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00886}00886\ \textcolor{stringliteral}{\ \ \ \ \`{}desired\`{}\ in\ the\ least\ squares\ sense\ (i.e.,\ the\ integral\ of\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00887}00887\ \textcolor{stringliteral}{\ \ \ \ weighted\ mean-\/squared\ error\ within\ the\ specified\ bands\ is}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00888}00888\ \textcolor{stringliteral}{\ \ \ \ minimized).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00889}00889\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00890}00890\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00891}00891\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00892}00892\ \textcolor{stringliteral}{\ \ \ \ numtaps\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00893}00893\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ taps\ in\ the\ FIR\ filter.\ \`{}numtaps\`{}\ must\ be\ odd.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00894}00894\ \textcolor{stringliteral}{\ \ \ \ bands\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00895}00895\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ monotonic\ nondecreasing\ sequence\ containing\ the\ band\ edges\ in}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00896}00896\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Hz.\ All\ elements\ must\ be\ non-\/negative\ and\ less\ than\ or\ equal\ to}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00897}00897\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ Nyquist\ frequency\ given\ by\ \`{}nyq\`{}.\ The\ bands\ are\ specified\ as}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00898}00898\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ frequency\ pairs,\ thus,\ if\ using\ a\ 1D\ array,\ its\ length\ must\ be}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00899}00899\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ even,\ e.g.,\ \`{}np.array([0,\ 1,\ 2,\ 3,\ 4,\ 5])\`{}.\ Alternatively,\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00900}00900\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bands\ can\ be\ specified\ as\ an\ nx2\ sized\ 2D\ array,\ where\ n\ is\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00901}00901\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ number\ of\ bands,\ e.g,\ \`{}np.array([[0,\ 1],\ [2,\ 3],\ [4,\ 5]])\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00902}00902\ \textcolor{stringliteral}{\ \ \ \ desired\ :\ array\_like}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00903}00903\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ sequence\ the\ same\ size\ as\ \`{}bands\`{}\ containing\ the\ desired\ gain}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00904}00904\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ at\ the\ start\ and\ end\ point\ of\ each\ band.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00905}00905\ \textcolor{stringliteral}{\ \ \ \ weight\ :\ array\_like,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00906}00906\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ A\ relative\ weighting\ to\ give\ to\ each\ band\ region\ when\ solving}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00907}00907\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ least\ squares\ problem.\ \`{}weight\`{}\ has\ to\ be\ half\ the\ size\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00908}00908\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}bands\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00909}00909\ \textcolor{stringliteral}{\ \ \ \ nyq\ :\ float,\ optional,\ deprecated}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00910}00910\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ is\ the\ Nyquist\ frequency.\ Each\ frequency\ in\ \`{}bands\`{}\ must\ be}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00911}00911\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ between\ 0\ and\ \`{}nyq\`{}\ (inclusive).\ Default\ is\ 1.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00912}00912\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00913}00913\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ ..\ deprecated::\ 1.0.0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00914}00914\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \`{}firls\`{}\ keyword\ argument\ \`{}nyq\`{}\ is\ deprecated\ in\ favour\ of\ \`{}fs\`{}\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00915}00915\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ will\ be\ removed\ in\ SciPy\ 1.12.0.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00916}00916\ \textcolor{stringliteral}{\ \ \ \ fs\ :\ float,\ optional}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00917}00917\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ sampling\ frequency\ of\ the\ signal.\ Each\ frequency\ in\ \`{}bands\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00918}00918\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ must\ be\ between\ 0\ and\ \`{}\`{}fs/2\`{}\`{}\ (inclusive).\ Default\ is\ 2.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00919}00919\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00920}00920\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00921}00921\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00922}00922\ \textcolor{stringliteral}{\ \ \ \ coeffs\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00923}00923\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Coefficients\ of\ the\ optimal\ (in\ a\ least\ squares\ sense)\ FIR\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00924}00924\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00925}00925\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00926}00926\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00927}00927\ \textcolor{stringliteral}{\ \ \ \ firwin}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00928}00928\ \textcolor{stringliteral}{\ \ \ \ firwin2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00929}00929\ \textcolor{stringliteral}{\ \ \ \ minimum\_phase}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00930}00930\ \textcolor{stringliteral}{\ \ \ \ remez}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00931}00931\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00932}00932\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00933}00933\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00934}00934\ \textcolor{stringliteral}{\ \ \ \ This\ implementation\ follows\ the\ algorithm\ given\ in\ [1]\_.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00935}00935\ \textcolor{stringliteral}{\ \ \ \ As\ noted\ there,\ least\ squares\ design\ has\ multiple\ advantages:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00936}00936\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00937}00937\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 1.\ Optimal\ in\ a\ least-\/squares\ sense.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00938}00938\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 2.\ Simple,\ non-\/iterative\ method.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00939}00939\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 3.\ The\ general\ solution\ can\ obtained\ by\ solving\ a\ linear}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00940}00940\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ system\ of\ equations.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00941}00941\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ 4.\ Allows\ the\ use\ of\ a\ frequency\ dependent\ weighting\ function.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00942}00942\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00943}00943\ \textcolor{stringliteral}{\ \ \ \ This\ function\ constructs\ a\ Type\ I\ linear\ phase\ FIR\ filter,\ which}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00944}00944\ \textcolor{stringliteral}{\ \ \ \ contains\ an\ odd\ number\ of\ \`{}coeffs\`{}\ satisfying\ for\ :math:\`{}n\ <\ numtaps\`{}:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00945}00945\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00946}00946\ \textcolor{stringliteral}{\ \ \ \ ..\ math::\ coeffs(n)\ =\ coeffs(numtaps\ -\/\ 1\ -\/\ n)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00947}00947\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00948}00948\ \textcolor{stringliteral}{\ \ \ \ The\ odd\ number\ of\ coefficients\ and\ filter\ symmetry\ avoid\ boundary}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00949}00949\ \textcolor{stringliteral}{\ \ \ \ conditions\ that\ could\ otherwise\ occur\ at\ the\ Nyquist\ and\ 0\ frequencies}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00950}00950\ \textcolor{stringliteral}{\ \ \ \ (e.g.,\ for\ Type\ II,\ III,\ or\ IV\ variants).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00951}00951\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00952}00952\ \textcolor{stringliteral}{\ \ \ \ ..\ versionadded::\ 0.18}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00953}00953\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00954}00954\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00955}00955\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00956}00956\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ Ivan\ Selesnick,\ Linear-\/Phase\ Fir\ Filter\ Design\ By\ Least\ Squares.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00957}00957\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ OpenStax\ CNX.\ Aug\ 9,\ 2005.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00958}00958\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ http://cnx.org/contents/eb1ecb35-\/03a9-\/4610-\/ba87-\/41cd771c95f2@7}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00959}00959\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00960}00960\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00961}00961\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00962}00962\ \textcolor{stringliteral}{\ \ \ \ We\ want\ to\ construct\ a\ band-\/pass\ filter.\ Note\ that\ the\ behavior\ in\ the}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00963}00963\ \textcolor{stringliteral}{\ \ \ \ frequency\ ranges\ between\ our\ stop\ bands\ and\ pass\ bands\ is\ unspecified,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00964}00964\ \textcolor{stringliteral}{\ \ \ \ and\ thus\ may\ overshoot\ depending\ on\ the\ parameters\ of\ our\ filter:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00965}00965\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00966}00966\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00967}00967\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy\ import\ signal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00968}00968\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00969}00969\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ axs\ =\ plt.subplots(2)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00970}00970\ \textcolor{stringliteral}{\ \ \ \ >>>\ fs\ =\ 10.0\ \ \#\ Hz}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00971}00971\ \textcolor{stringliteral}{\ \ \ \ >>>\ desired\ =\ (0,\ 0,\ 1,\ 1,\ 0,\ 0)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00972}00972\ \textcolor{stringliteral}{\ \ \ \ >>>\ for\ bi,\ bands\ in\ enumerate(((0,\ 1,\ 2,\ 3,\ 4,\ 5),\ (0,\ 1,\ 2,\ 4,\ 4.5,\ 5))):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00973}00973\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ fir\_firls\ =\ signal.firls(73,\ bands,\ desired,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00974}00974\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ fir\_remez\ =\ signal.remez(73,\ bands,\ desired[::2],\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00975}00975\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ fir\_firwin2\ =\ signal.firwin2(73,\ bands,\ desired,\ fs=fs)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00976}00976\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ hs\ =\ list()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00977}00977\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax\ =\ axs[bi]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00978}00978\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ for\ fir\ in\ (fir\_firls,\ fir\_remez,\ fir\_firwin2):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00979}00979\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ freq,\ response\ =\ signal.freqz(fir)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00980}00980\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ hs.append(ax.semilogy(0.5*fs*freq/np.pi,\ np.abs(response))[0])}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00981}00981\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ for\ band,\ gains\ in\ zip(zip(bands[::2],\ bands[1::2]),}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00982}00982\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ zip(desired[::2],\ desired[1::2])):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00983}00983\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ ax.semilogy(band,\ np.maximum(gains,\ 1e-\/7),\ 'k-\/-\/',\ linewidth=2)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00984}00984\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ if\ bi\ ==\ 0:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00985}00985\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ ax.legend(hs,\ ('firls',\ 'remez',\ 'firwin2'),}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00986}00986\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ loc='lower\ center',\ frameon=False)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00987}00987\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ else:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00988}00988\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ ax.set\_xlabel('Frequency\ (Hz)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00989}00989\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.grid(True)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00990}00990\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set(title='Band-\/pass\ \%d-\/\%d\ Hz'\ \%\ bands[2:4],\ ylabel='Magnitude')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00991}00991\ \textcolor{stringliteral}{\ \ \ \ ...}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00992}00992\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig.tight\_layout()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00993}00993\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.show()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00994}00994\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00995}00995\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00996}00996\ \ \ \ \ nyq\ =\ 0.5\ *\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a9b6d9b077f47727a463a031e87df6327}{\_get\_fs}}(fs,\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00997}00997\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00998}00998\ \ \ \ \ numtaps\ =\ int(numtaps)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l00999}00999\ \ \ \ \ \textcolor{keywordflow}{if}\ numtaps\ \%\ 2\ ==\ 0\ \textcolor{keywordflow}{or}\ numtaps\ <\ 1:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01000}01000\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}numtaps\ must\ be\ odd\ and\ >=\ 1"{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01001}01001\ \ \ \ \ M\ =\ (numtaps-\/1)\ //\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01002}01002\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01003}01003\ \ \ \ \ \textcolor{comment}{\#\ normalize\ bands\ 0-\/>1\ and\ make\ it\ 2\ columns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01004}01004\ \ \ \ \ nyq\ =\ float(nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01005}01005\ \ \ \ \ \textcolor{keywordflow}{if}\ nyq\ <=\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01006}01006\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'nyq\ must\ be\ positive,\ got\ \%s\ <=\ 0.'}\ \%\ nyq)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01007}01007\ \ \ \ \ bands\ =\ np.asarray(bands).flatten()\ /\ nyq}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01008}01008\ \ \ \ \ \textcolor{keywordflow}{if}\ len(bands)\ \%\ 2\ !=\ 0:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01009}01009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}bands\ must\ contain\ frequency\ pairs."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01010}01010\ \ \ \ \ \textcolor{keywordflow}{if}\ (bands\ <\ 0).any()\ \textcolor{keywordflow}{or}\ (bands\ >\ 1).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01011}01011\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}bands\ must\ be\ between\ 0\ and\ 1\ relative\ to\ Nyquist"{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01012}01012\ \ \ \ \ bands.shape\ =\ (-\/1,\ 2)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01013}01013\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01014}01014\ \ \ \ \ \textcolor{comment}{\#\ check\ remaining\ params}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01015}01015\ \ \ \ \ desired\ =\ np.asarray(desired).flatten()}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01016}01016\ \ \ \ \ \textcolor{keywordflow}{if}\ bands.size\ !=\ desired.size:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01017}01017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}desired\ must\ have\ one\ entry\ per\ frequency,\ got\ \%s\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01018}01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}gains\ for\ \%s\ frequencies."{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01019}01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (desired.size,\ bands.size))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01020}01020\ \ \ \ \ desired.shape\ =\ (-\/1,\ 2)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01021}01021\ \ \ \ \ \textcolor{keywordflow}{if}\ (np.diff(bands)\ <=\ 0).any()\ \textcolor{keywordflow}{or}\ (np.diff(bands[:,\ 0])\ <\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01022}01022\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}bands\ must\ be\ monotonically\ nondecreasing\ and\ have\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01023}01023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}width\ >\ 0."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01024}01024\ \ \ \ \ \textcolor{keywordflow}{if}\ (bands[:-\/1,\ 1]\ >\ bands[1:,\ 0]).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01025}01025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}bands\ must\ not\ overlap."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01026}01026\ \ \ \ \ \textcolor{keywordflow}{if}\ (desired\ <\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01027}01027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}desired\ must\ be\ non-\/negative."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01028}01028\ \ \ \ \ \textcolor{keywordflow}{if}\ weight\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01029}01029\ \ \ \ \ \ \ \ \ weight\ =\ np.ones(len(desired))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01030}01030\ \ \ \ \ weight\ =\ np.asarray(weight).flatten()}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01031}01031\ \ \ \ \ \textcolor{keywordflow}{if}\ len(weight)\ !=\ len(desired):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01032}01032\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}weight\ must\ be\ the\ same\ size\ as\ the\ number\ of\ "{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01033}01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}band\ pairs\ (\{\})."{}}.format(len(bands)))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01034}01034\ \ \ \ \ \textcolor{keywordflow}{if}\ (weight\ <\ 0).any():}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01035}01035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{"{}weight\ must\ be\ non-\/negative."{}})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01036}01036\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01037}01037\ \ \ \ \ \textcolor{comment}{\#\ Set\ up\ the\ linear\ matrix\ equation\ to\ be\ solved,\ Qa\ =\ b}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01038}01038\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01039}01039\ \ \ \ \ \textcolor{comment}{\#\ We\ can\ express\ Q(k,n)\ =\ 0.5\ Q1(k,n)\ +\ 0.5\ Q2(k,n)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01040}01040\ \ \ \ \ \textcolor{comment}{\#\ where\ Q1(k,n)=q(k-\/n)\ and\ Q2(k,n)=q(k+n),\ i.e.\ a\ Toeplitz\ plus\ Hankel.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01041}01041\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01042}01042\ \ \ \ \ \textcolor{comment}{\#\ We\ omit\ the\ factor\ of\ 0.5\ above,\ instead\ adding\ it\ during\ coefficient}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01043}01043\ \ \ \ \ \textcolor{comment}{\#\ calculation.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01044}01044\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01045}01045\ \ \ \ \ \textcolor{comment}{\#\ We\ also\ omit\ the\ 1/π\ from\ both\ Q\ and\ b\ equations,\ as\ they\ cancel}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01046}01046\ \ \ \ \ \textcolor{comment}{\#\ during\ solving.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01047}01047\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01048}01048\ \ \ \ \ \textcolor{comment}{\#\ We\ have\ that:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01049}01049\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ q(n)\ =\ 1/π\ ∫W(ω)cos(nω)dω\ (over\ 0-\/>π)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01050}01050\ \ \ \ \ \textcolor{comment}{\#\ Using\ our\ nomalization\ ω=πf\ and\ with\ a\ constant\ weight\ W\ over\ each}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01051}01051\ \ \ \ \ \textcolor{comment}{\#\ interval\ f1-\/>f2\ we\ get:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01052}01052\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ q(n)\ =\ W∫cos(πnf)df\ (0-\/>1)\ =\ Wf\ sin(πnf)/πnf}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01053}01053\ \ \ \ \ \textcolor{comment}{\#\ integrated\ over\ each\ f1-\/>f2\ pair\ (i.e.,\ value\ at\ f2\ -\/\ value\ at\ f1).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01054}01054\ \ \ \ \ n\ =\ np.arange(numtaps)[:,\ np.newaxis,\ np.newaxis]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01055}01055\ \ \ \ \ q\ =\ np.dot(np.diff(np.sinc(bands\ *\ n)\ *\ bands,\ axis=2)[:,\ :,\ 0],\ weight)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01056}01056\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01057}01057\ \ \ \ \ \textcolor{comment}{\#\ Now\ we\ assemble\ our\ sum\ of\ Toeplitz\ and\ Hankel}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01058}01058\ \ \ \ \ Q1\ =\ toeplitz(q[:M+1])}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01059}01059\ \ \ \ \ Q2\ =\ hankel(q[:M+1],\ q[M:])}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01060}01060\ \ \ \ \ Q\ =\ Q1\ +\ Q2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01061}01061\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01062}01062\ \ \ \ \ \textcolor{comment}{\#\ Now\ for\ b(n)\ we\ have\ that:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01063}01063\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ b(n)\ =\ 1/π\ ∫\ W(ω)D(ω)cos(nω)dω\ (over\ 0-\/>π)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01064}01064\ \ \ \ \ \textcolor{comment}{\#\ Using\ our\ normalization\ ω=πf\ and\ with\ a\ constant\ weight\ W\ over\ each}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01065}01065\ \ \ \ \ \textcolor{comment}{\#\ interval\ and\ a\ linear\ term\ for\ D(ω)\ we\ get\ (over\ each\ f1-\/>f2\ interval):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01066}01066\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ b(n)\ =\ W\ ∫\ (mf+c)cos(πnf)df}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01067}01067\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ =\ f(mf+c)sin(πnf)/πnf\ +\ mf**2\ cos(nπf)/(πnf)**2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01068}01068\ \ \ \ \ \textcolor{comment}{\#\ integrated\ over\ each\ f1-\/>f2\ pair\ (i.e.,\ value\ at\ f2\ -\/\ value\ at\ f1).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01069}01069\ \ \ \ \ n\ =\ n[:M\ +\ 1]\ \ \textcolor{comment}{\#\ only\ need\ this\ many\ coefficients\ here}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01070}01070\ \ \ \ \ \textcolor{comment}{\#\ Choose\ m\ and\ c\ such\ that\ we\ are\ at\ the\ start\ and\ end\ weights}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01071}01071\ \ \ \ \ m\ =\ (np.diff(desired,\ axis=1)\ /\ np.diff(bands,\ axis=1))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01072}01072\ \ \ \ \ c\ =\ desired[:,\ [0]]\ -\/\ bands[:,\ [0]]\ *\ m}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01073}01073\ \ \ \ \ b\ =\ bands\ *\ (m*bands\ +\ c)\ *\ np.sinc(bands\ *\ n)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01074}01074\ \ \ \ \ \textcolor{comment}{\#\ Use\ L'Hospital's\ rule\ here\ for\ cos(nπf)/(πnf)**2\ @\ n=0}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01075}01075\ \ \ \ \ b[0]\ -\/=\ m\ *\ bands\ *\ bands\ /\ 2.}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01076}01076\ \ \ \ \ b[1:]\ +=\ m\ *\ np.cos(n[1:]\ *\ np.pi\ *\ bands)\ /\ (np.pi\ *\ n[1:])\ **\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01077}01077\ \ \ \ \ b\ =\ np.dot(np.diff(b,\ axis=2)[:,\ :,\ 0],\ weight)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01078}01078\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01079}01079\ \ \ \ \ \textcolor{comment}{\#\ Now\ we\ can\ solve\ the\ equation}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01080}01080\ \ \ \ \ \textcolor{keywordflow}{try}:\ \ \textcolor{comment}{\#\ try\ the\ fast\ way}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01081}01081\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ w:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01082}01082\ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{'always'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01083}01083\ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ solve(Q,\ b,\ assume\_a=\textcolor{stringliteral}{"{}pos"{}},\ check\_finite=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01084}01084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ ww\ \textcolor{keywordflow}{in}\ w:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01085}01085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ww.category\ ==\ LinAlgWarning\ \textcolor{keywordflow}{and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01086}01086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str(ww.message).startswith(\textcolor{stringliteral}{'Ill-\/conditioned\ matrix'})):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01087}01087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classnumpy_1_1linalg_1_1linalg_1_1LinAlgError}{LinAlgError}}(str(ww.message))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01088}01088\ \ \ \ \ \textcolor{keywordflow}{except}\ LinAlgError:\ \ \textcolor{comment}{\#\ in\ case\ Q\ is\ rank\ deficient}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01089}01089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ is\ faster\ than\ pinvh,\ even\ though\ we\ don't\ explicitly\ use}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01090}01090\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ symmetry\ here.\ gelsy\ was\ faster\ than\ gelsd\ and\ gelss\ in}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01091}01091\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ some\ non-\/exhaustive\ tests.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01092}01092\ \ \ \ \ \ \ \ \ a\ =\ lstsq(Q,\ b,\ lapack\_driver=\textcolor{stringliteral}{'gelsy'})[0]}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01093}01093\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01094}01094\ \ \ \ \ \textcolor{comment}{\#\ make\ coefficients\ symmetric\ (linear\ phase)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01095}01095\ \ \ \ \ coeffs\ =\ np.hstack((a[:0:-\/1],\ 2\ *\ a[0],\ a[1:]))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01096}01096\ \ \ \ \ \textcolor{keywordflow}{return}\ coeffs}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01097}01097\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01098}01098\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01099}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a6df677277b316465bef06cda54628ac1}{01099}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a6df677277b316465bef06cda54628ac1}{\_dhtm}}(mag):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01100}01100\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ the\ modified\ 1-\/D\ discrete\ Hilbert\ transform}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01101}01101\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01102}01102\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01103}01103\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01104}01104\ \textcolor{stringliteral}{\ \ \ \ mag\ :\ ndarray}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01105}01105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ magnitude\ spectrum.\ Should\ be\ 1-\/D\ with\ an\ even\ length,\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01106}01106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ preferably\ a\ fast\ length\ for\ FFT/IFFT.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01107}01107\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01108}01108\ \ \ \ \ \textcolor{comment}{\#\ Adapted\ based\ on\ code\ by\ Niranjan\ Damera-\/Venkata,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01109}01109\ \ \ \ \ \textcolor{comment}{\#\ Brian\ L.\ Evans\ and\ Shawn\ R.\ McCaslin\ (see\ refs\ for\ \`{}minimum\_phase`)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01110}01110\ \ \ \ \ sig\ =\ np.zeros(len(mag))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01111}01111\ \ \ \ \ \textcolor{comment}{\#\ Leave\ Nyquist\ and\ DC\ at\ 0,\ knowing\ np.abs(fftfreq(N)[midpt])\ ==\ 0.5}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01112}01112\ \ \ \ \ midpt\ =\ len(mag)\ //\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01113}01113\ \ \ \ \ sig[1:midpt]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01114}01114\ \ \ \ \ sig[midpt+1:]\ =\ -\/1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01115}01115\ \ \ \ \ \textcolor{comment}{\#\ eventually\ if\ we\ want\ to\ support\ complex\ filters,\ we\ will\ need\ a}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01116}01116\ \ \ \ \ \textcolor{comment}{\#\ np.abs()\ on\ the\ mag\ inside\ the\ log,\ and\ should\ remove\ the\ .real}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01117}01117\ \ \ \ \ recon\ =\ ifft(mag\ *\ np.exp(fft(sig\ *\ ifft(np.log(mag))))).real}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01118}01118\ \ \ \ \ \textcolor{keywordflow}{return}\ recon}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01119}01119\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01120}01120\ }
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01121}\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_ac2de1b0b0595bd11e48606e002ec9542}{01121}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_ac2de1b0b0595bd11e48606e002ec9542}{minimum\_phase}}(h,\ method='homomorphic',\ n\_fft=None):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01122}01122\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Convert\ a\ linear-\/phase\ FIR\ filter\ to\ minimum\ phase}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01123}01123\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01124}01124\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01125}01125\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01126}01126\ \textcolor{stringliteral}{\ \ \ \ h\ :\ array}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01127}01127\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Linear-\/phase\ FIR\ filter\ coefficients.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01128}01128\ \textcolor{stringliteral}{\ \ \ \ method\ :\ \{'hilbert',\ 'homomorphic'\}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01129}01129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ method\ to\ use:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01130}01130\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01131}01131\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 'homomorphic'\ (default)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01132}01132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ This\ method\ [4]\_\ [5]\_\ works\ best\ with\ filters\ with\ an}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01133}01133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ odd\ number\ of\ taps,\ and\ the\ resulting\ minimum\ phase\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01134}01134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ will\ have\ a\ magnitude\ response\ that\ approximates\ the\ square}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01135}01135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ root\ of\ the\ original\ filter's\ magnitude\ response.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01136}01136\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01137}01137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ 'hilbert'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01138}01138\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ This\ method\ [1]\_\ is\ designed\ to\ be\ used\ with\ equiripple}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01139}01139\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filters\ (e.g.,\ from\ \`{}remez\`{})\ with\ unity\ or\ zero\ gain}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01140}01140\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ regions.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01141}01141\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01142}01142\ \textcolor{stringliteral}{\ \ \ \ n\_fft\ :\ int}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01143}01143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ number\ of\ points\ to\ use\ for\ the\ FFT.\ Should\ be\ at\ least\ a}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01144}01144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ few\ times\ larger\ than\ the\ signal\ length\ (see\ Notes).}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01145}01145\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01146}01146\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01147}01147\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01148}01148\ \textcolor{stringliteral}{\ \ \ \ h\_minimum\ :\ array}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01149}01149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ minimum-\/phase\ version\ of\ the\ filter,\ with\ length}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01150}01150\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \`{}\`{}(length(h)\ +\ 1)\ //\ 2\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01151}01151\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01152}01152\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01153}01153\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01154}01154\ \textcolor{stringliteral}{\ \ \ \ firwin}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01155}01155\ \textcolor{stringliteral}{\ \ \ \ firwin2}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01156}01156\ \textcolor{stringliteral}{\ \ \ \ remez}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01157}01157\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01158}01158\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01159}01159\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01160}01160\ \textcolor{stringliteral}{\ \ \ \ Both\ the\ Hilbert\ [1]\_\ or\ homomorphic\ [4]\_\ [5]\_\ methods\ require\ selection}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01161}01161\ \textcolor{stringliteral}{\ \ \ \ of\ an\ FFT\ length\ to\ estimate\ the\ complex\ cepstrum\ of\ the\ filter.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01162}01162\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01163}01163\ \textcolor{stringliteral}{\ \ \ \ In\ the\ case\ of\ the\ Hilbert\ method,\ the\ deviation\ from\ the\ ideal}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01164}01164\ \textcolor{stringliteral}{\ \ \ \ spectrum\ \`{}\`{}epsilon\`{}\`{}\ is\ related\ to\ the\ number\ of\ stopband\ zeros}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01165}01165\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}n\_stop\`{}\`{}\ and\ FFT\ length\ \`{}\`{}n\_fft\`{}\`{}\ as::}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01166}01166\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01167}01167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ epsilon\ =\ 2.\ *\ n\_stop\ /\ n\_fft}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01168}01168\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01169}01169\ \textcolor{stringliteral}{\ \ \ \ For\ example,\ with\ 100\ stopband\ zeros\ and\ a\ FFT\ length\ of\ 2048,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01170}01170\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}epsilon\ =\ 0.0976\`{}\`{}.\ If\ we\ conservatively\ assume\ that\ the\ number\ of}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01171}01171\ \textcolor{stringliteral}{\ \ \ \ stopband\ zeros\ is\ one\ less\ than\ the\ filter\ length,\ we\ can\ take\ the\ FFT}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01172}01172\ \textcolor{stringliteral}{\ \ \ \ length\ to\ be\ the\ next\ power\ of\ 2\ that\ satisfies\ \`{}\`{}epsilon=0.01\`{}\`{}\ as::}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01173}01173\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01174}01174\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ n\_fft\ =\ 2\ **\ int(np.ceil(np.log2(2\ *\ (len(h)\ -\/\ 1)\ /\ 0.01)))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01175}01175\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01176}01176\ \textcolor{stringliteral}{\ \ \ \ This\ gives\ reasonable\ results\ for\ both\ the\ Hilbert\ and\ homomorphic}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01177}01177\ \textcolor{stringliteral}{\ \ \ \ methods,\ and\ gives\ the\ value\ used\ when\ \`{}\`{}n\_fft=None\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01178}01178\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01179}01179\ \textcolor{stringliteral}{\ \ \ \ Alternative\ implementations\ exist\ for\ creating\ minimum-\/phase\ filters,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01180}01180\ \textcolor{stringliteral}{\ \ \ \ including\ zero\ inversion\ [2]\_\ and\ spectral\ factorization\ [3]\_\ [4]\_.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01181}01181\ \textcolor{stringliteral}{\ \ \ \ For\ more\ information,\ see:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01182}01182\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01183}01183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ http://dspguru.com/dsp/howtos/how-\/to-\/design-\/minimum-\/phase-\/fir-\/filters}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01184}01184\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01185}01185\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01186}01186\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01187}01187\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ N.\ Damera-\/Venkata\ and\ B.\ L.\ Evans,\ "{}Optimal\ design\ of\ real\ and}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01188}01188\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ complex\ minimum\ phase\ digital\ FIR\ filters,"{}\ Acoustics,\ Speech,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01189}01189\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ and\ Signal\ Processing,\ 1999.\ Proceedings.,\ 1999\ IEEE\ International}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01190}01190\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Conference\ on,\ Phoenix,\ AZ,\ 1999,\ pp.\ 1145-\/1148\ vol.3.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01191}01191\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ :doi:\`{}10.1109/ICASSP.1999.756179\`{}}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01192}01192\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ X.\ Chen\ and\ T.\ W.\ Parks,\ "{}Design\ of\ optimal\ minimum\ phase\ FIR}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01193}01193\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ filters\ by\ direct\ factorization,"{}\ Signal\ Processing,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01194}01194\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ vol.\ 10,\ no.\ 4,\ pp.\ 369-\/383,\ Jun.\ 1986.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01195}01195\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ T.\ Saramaki,\ "{}Finite\ Impulse\ Response\ Filter\ Design,"{}\ in}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01196}01196\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Handbook\ for\ Digital\ Signal\ Processing,\ chapter\ 4,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01197}01197\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ New\ York:\ Wiley-\/Interscience,\ 1993.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01198}01198\ \textcolor{stringliteral}{\ \ \ \ ..\ [4]\ J.\ S.\ Lim,\ Advanced\ Topics\ in\ Signal\ Processing.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01199}01199\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Englewood\ Cliffs,\ N.J.:\ Prentice\ Hall,\ 1988.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01200}01200\ \textcolor{stringliteral}{\ \ \ \ ..\ [5]\ A.\ V.\ Oppenheim,\ R.\ W.\ Schafer,\ and\ J.\ R.\ Buck,}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01201}01201\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ "{}Discrete-\/Time\ Signal\ Processing,"{}\ 2nd\ edition.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01202}01202\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Upper\ Saddle\ River,\ N.J.:\ Prentice\ Hall,\ 1999.}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01203}01203\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01204}01204\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01205}01205\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01206}01206\ \textcolor{stringliteral}{\ \ \ \ Create\ an\ optimal\ linear-\/phase\ filter,\ then\ convert\ it\ to\ minimum\ phase:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01207}01207\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01208}01208\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01209}01209\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.signal\ import\ remez,\ minimum\_phase,\ freqz,\ group\_delay}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01210}01210\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ matplotlib.pyplot\ as\ plt}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01211}01211\ \textcolor{stringliteral}{\ \ \ \ >>>\ freq\ =\ [0,\ 0.2,\ 0.3,\ 1.0]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01212}01212\ \textcolor{stringliteral}{\ \ \ \ >>>\ desired\ =\ [1,\ 0]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01213}01213\ \textcolor{stringliteral}{\ \ \ \ >>>\ h\_linear\ =\ remez(151,\ freq,\ desired,\ fs=2.)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01214}01214\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01215}01215\ \textcolor{stringliteral}{\ \ \ \ Convert\ it\ to\ minimum\ phase:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01216}01216\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01217}01217\ \textcolor{stringliteral}{\ \ \ \ >>>\ h\_min\_hom\ =\ minimum\_phase(h\_linear,\ method='homomorphic')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01218}01218\ \textcolor{stringliteral}{\ \ \ \ >>>\ h\_min\_hil\ =\ minimum\_phase(h\_linear,\ method='hilbert')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01219}01219\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01220}01220\ \textcolor{stringliteral}{\ \ \ \ Compare\ the\ three\ filters:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01221}01221\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01222}01222\ \textcolor{stringliteral}{\ \ \ \ >>>\ fig,\ axs\ =\ plt.subplots(4,\ figsize=(4,\ 8))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01223}01223\ \textcolor{stringliteral}{\ \ \ \ >>>\ for\ h,\ style,\ color\ in\ zip((h\_linear,\ h\_min\_hom,\ h\_min\_hil),}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01224}01224\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ('-\/',\ '-\/',\ '-\/-\/'),\ ('k',\ 'r',\ 'c')):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01225}01225\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ w,\ H\ =\ freqz(h)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01226}01226\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ w,\ gd\ =\ group\_delay((h,\ 1))}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01227}01227\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ w\ /=\ np.pi}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01228}01228\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ axs[0].plot(h,\ color=color,\ linestyle=style)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01229}01229\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ axs[1].plot(w,\ np.abs(H),\ color=color,\ linestyle=style)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01230}01230\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ axs[2].plot(w,\ 20\ *\ np.log10(np.abs(H)),\ color=color,\ linestyle=style)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01231}01231\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ axs[3].plot(w,\ gd,\ color=color,\ linestyle=style)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01232}01232\ \textcolor{stringliteral}{\ \ \ \ >>>\ for\ ax\ in\ axs:}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01233}01233\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.grid(True,\ color='0.5')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01234}01234\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.fill\_between(freq[1:3],\ *ax.get\_ylim(),\ color='\#ffeeaa',\ zorder=1)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01235}01235\ \textcolor{stringliteral}{\ \ \ \ >>>\ axs[0].set(xlim=[0,\ len(h\_linear)\ -\/\ 1],\ ylabel='Amplitude',\ xlabel='Samples')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01236}01236\ \textcolor{stringliteral}{\ \ \ \ >>>\ axs[1].legend(['Linear',\ 'Min-\/Hom',\ 'Min-\/Hil'],\ title='Phase')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01237}01237\ \textcolor{stringliteral}{\ \ \ \ >>>\ for\ ax,\ ylim\ in\ zip(axs[1:],\ ([0,\ 1.1],\ [-\/150,\ 10],\ [-\/60,\ 60])):}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01238}01238\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ ax.set(xlim=[0,\ 1],\ ylim=ylim,\ xlabel='Frequency')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01239}01239\ \textcolor{stringliteral}{\ \ \ \ >>>\ axs[1].set(ylabel='Magnitude')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01240}01240\ \textcolor{stringliteral}{\ \ \ \ >>>\ axs[2].set(ylabel='Magnitude\ (dB)')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01241}01241\ \textcolor{stringliteral}{\ \ \ \ >>>\ axs[3].set(ylabel='Group\ delay')}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01242}01242\ \textcolor{stringliteral}{\ \ \ \ >>>\ plt.tight\_layout()}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01243}01243\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01244}01244\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}\ \ \textcolor{comment}{\#\ noqa}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01245}01245\ \ \ \ \ h\ =\ np.asarray(h)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01246}01246\ \ \ \ \ \textcolor{keywordflow}{if}\ np.iscomplexobj(h):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01247}01247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'Complex\ filters\ not\ supported'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01248}01248\ \ \ \ \ \textcolor{keywordflow}{if}\ h.ndim\ !=\ 1\ \textcolor{keywordflow}{or}\ h.size\ <=\ 2:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01249}01249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'h\ must\ be\ 1-\/D\ and\ at\ least\ 2\ samples\ long'})}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01250}01250\ \ \ \ \ n\_half\ =\ len(h)\ //\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01251}01251\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ np.allclose(h[-\/n\_half:][::-\/1],\ h[:n\_half]):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01252}01252\ \ \ \ \ \ \ \ \ warnings.warn(\textcolor{stringliteral}{'h\ does\ not\ appear\ to\ by\ symmetric,\ conversion\ may\ '}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01253}01253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fail'},\ RuntimeWarning)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01254}01254\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(method,\ str)\ \textcolor{keywordflow}{or}\ method\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01255}01255\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'homomorphic'},\ \textcolor{stringliteral}{'hilbert'},):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01256}01256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'method\ must\ be\ "{}homomorphic"{}\ or\ "{}hilbert"{},\ got\ \%r'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01257}01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \%\ (method,))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01258}01258\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_fft\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01259}01259\ \ \ \ \ \ \ \ \ n\_fft\ =\ 2\ **\ int(np.ceil(np.log2(2\ *\ (len(h)\ -\/\ 1)\ /\ 0.01)))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01260}01260\ \ \ \ \ n\_fft\ =\ int(n\_fft)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01261}01261\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_fft\ <\ len(h):}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01262}01262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(\textcolor{stringliteral}{'n\_fft\ must\ be\ at\ least\ len(h)==\%s'}\ \%\ len(h))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01263}01263\ \ \ \ \ \textcolor{keywordflow}{if}\ method\ ==\ \textcolor{stringliteral}{'hilbert'}:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01264}01264\ \ \ \ \ \ \ \ \ w\ =\ np.arange(n\_fft)\ *\ (2\ *\ np.pi\ /\ n\_fft\ *\ n\_half)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01265}01265\ \ \ \ \ \ \ \ \ H\ =\ np.real(fft(h,\ n\_fft)\ *\ np.exp(1j\ *\ w))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01266}01266\ \ \ \ \ \ \ \ \ dp\ =\ max(H)\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01267}01267\ \ \ \ \ \ \ \ \ ds\ =\ 0\ -\/\ min(H)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01268}01268\ \ \ \ \ \ \ \ \ S\ =\ 4.\ /\ (np.sqrt(1+dp+ds)\ +\ np.sqrt(1-\/dp+ds))\ **\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01269}01269\ \ \ \ \ \ \ \ \ H\ +=\ ds}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01270}01270\ \ \ \ \ \ \ \ \ H\ *=\ S}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01271}01271\ \ \ \ \ \ \ \ \ H\ =\ np.sqrt(H,\ out=H)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01272}01272\ \ \ \ \ \ \ \ \ H\ +=\ 1e-\/10\ \ \textcolor{comment}{\#\ ensure\ that\ the\ log\ does\ not\ explode}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01273}01273\ \ \ \ \ \ \ \ \ h\_minimum\ =\ \mbox{\hyperlink{namespacescipy_1_1signal_1_1__fir__filter__design_a6df677277b316465bef06cda54628ac1}{\_dhtm}}(H)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01274}01274\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ method\ ==\ 'homomorphic'}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01275}01275\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ zero-\/pad;\ calculate\ the\ DFT}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01276}01276\ \ \ \ \ \ \ \ \ h\_temp\ =\ np.abs(fft(h,\ n\_fft))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01277}01277\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ take\ 0.25*log(|H|**2)\ =\ 0.5*log(|H|)}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01278}01278\ \ \ \ \ \ \ \ \ h\_temp\ +=\ 1e-\/7\ *\ h\_temp[h\_temp\ >\ 0].min()\ \ \textcolor{comment}{\#\ don't\ let\ log\ blow\ up}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01279}01279\ \ \ \ \ \ \ \ \ np.log(h\_temp,\ out=h\_temp)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01280}01280\ \ \ \ \ \ \ \ \ h\_temp\ *=\ 0.5}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01281}01281\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ IDFT}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01282}01282\ \ \ \ \ \ \ \ \ h\_temp\ =\ ifft(h\_temp).real}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01283}01283\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ multiply\ pointwise\ by\ the\ homomorphic\ filter}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01284}01284\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ lmin[n]\ =\ 2u[n]\ -\/\ d[n]}}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01285}01285\ \ \ \ \ \ \ \ \ win\ =\ np.zeros(n\_fft)}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01286}01286\ \ \ \ \ \ \ \ \ win[0]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01287}01287\ \ \ \ \ \ \ \ \ stop\ =\ (len(h)\ +\ 1)\ //\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01288}01288\ \ \ \ \ \ \ \ \ win[1:stop]\ =\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01289}01289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(h)\ \%\ 2:}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01290}01290\ \ \ \ \ \ \ \ \ \ \ \ \ win[stop]\ =\ 1}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01291}01291\ \ \ \ \ \ \ \ \ h\_temp\ *=\ win}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01292}01292\ \ \ \ \ \ \ \ \ h\_temp\ =\ ifft(np.exp(fft(h\_temp)))}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01293}01293\ \ \ \ \ \ \ \ \ h\_minimum\ =\ h\_temp.real}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01294}01294\ \ \ \ \ n\_out\ =\ n\_half\ +\ len(h)\ \%\ 2}
\DoxyCodeLine{\Hypertarget{__fir__filter__design_8py_source_l01295}01295\ \ \ \ \ \textcolor{keywordflow}{return}\ h\_minimum[:n\_out]}

\end{DoxyCode}
