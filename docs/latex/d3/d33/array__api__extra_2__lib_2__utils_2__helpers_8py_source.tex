\doxysection{\+\_\+helpers.\+py}
\hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source}{}\label{array__api__extra_2__lib_2__utils_2__helpers_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_extra/\_lib/\_utils/\_helpers.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/externals/array\_api\_extra/\_lib/\_utils/\_helpers.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Helper\ functions\ used\ by\ \`{}array\_api\_extra/\_funcs.py\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00005}00005\ \textcolor{keyword}{import}\ math}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacecollections_1_1abc}{collections.abc}}\ \textcolor{keyword}{import}\ Generator,\ Iterable}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00007}00007\ \textcolor{keyword}{from}\ types\ \textcolor{keyword}{import}\ ModuleType}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00008}00008\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ TYPE\_CHECKING,\ cast}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00010}00010\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ \_compat}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00011}00011\ \textcolor{keyword}{from}\ .\_compat\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00012}00012\ \ \ \ \ array\_namespace,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00013}00013\ \ \ \ \ is\_array\_api\_obj,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00014}00014\ \ \ \ \ is\_dask\_namespace,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00015}00015\ \ \ \ \ is\_numpy\_array,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00016}00016\ )}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00017}00017\ \textcolor{keyword}{from}\ .\_typing\ \textcolor{keyword}{import}\ Array}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00019}00019\ \textcolor{keywordflow}{if}\ TYPE\_CHECKING:\ \ \textcolor{comment}{\#\ pragma:\ no\ cover}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00020}00020\ \ \ \ \ \textcolor{comment}{\#\ TODO\ import\ from\ typing\ (requires\ Python\ >=3.13)}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00021}00021\ \ \ \ \ \textcolor{keyword}{from}\ typing\_extensions\ \textcolor{keyword}{import}\ TypeIs}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00024}00024\ \_\_all\_\_\ =\ [}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00025}00025\ \ \ \ \ \textcolor{stringliteral}{"{}asarrays"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00026}00026\ \ \ \ \ \textcolor{stringliteral}{"{}eager\_shape"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00027}00027\ \ \ \ \ \textcolor{stringliteral}{"{}in1d"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00028}00028\ \ \ \ \ \textcolor{stringliteral}{"{}is\_python\_scalar"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00029}00029\ \ \ \ \ \textcolor{stringliteral}{"{}mean"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00030}00030\ \ \ \ \ \textcolor{stringliteral}{"{}meta\_namespace"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00031}00031\ ]}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00034}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a2ba0eea9000b7676b12ab851341ea318}{00034}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a2ba0eea9000b7676b12ab851341ea318}{in1d}}(}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00035}00035\ \ \ \ \ x1:\ Array,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00036}00036\ \ \ \ \ x2:\ Array,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00037}00037\ \ \ \ \ /,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00038}00038\ \ \ \ \ *,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00039}00039\ \ \ \ \ assume\_unique:\ bool\ =\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00040}00040\ \ \ \ \ invert:\ bool\ =\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00041}00041\ \ \ \ \ xp:\ ModuleType\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00042}00042\ )\ -\/>\ Array:\ \ \textcolor{comment}{\#\ numpydoc\ ignore=PR01,RT01}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00043}00043\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ Check\ whether\ each\ element\ of\ an\ array\ is\ also\ present\ in\ a\ second\ array.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00045}00045\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ Returns\ a\ boolean\ array\ the\ same\ length\ as\ \`{}x1\`{}\ that\ is\ True}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00047}00047\ \textcolor{stringliteral}{\ \ \ \ where\ an\ element\ of\ \`{}x1\`{}\ is\ in\ \`{}x2\`{}\ and\ False\ otherwise.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00048}00048\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00049}00049\ \textcolor{stringliteral}{\ \ \ \ This\ function\ has\ been\ adapted\ using\ the\ original\ implementation}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ present\ in\ numpy:}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ https://github.com/numpy/numpy/blob/v1.26.0/numpy/lib/arraysetops.py\#L524-\/L758}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{if}\ xp\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ xp\ =\ array\_namespace(x1,\ x2)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00056}00056\ \ \ \ \ x1\_shape\ =\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0a6b9868c304a0aac6eeb4105caebc99}{eager\_shape}}(x1)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00057}00057\ \ \ \ \ x2\_shape\ =\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0a6b9868c304a0aac6eeb4105caebc99}{eager\_shape}}(x2)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00059}00059\ \ \ \ \ \textcolor{comment}{\#\ This\ code\ is\ run\ to\ make\ the\ code\ significantly\ faster}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00060}00060\ \ \ \ \ \textcolor{keywordflow}{if}\ x2\_shape[0]\ <\ 10\ *\ x1\_shape[0]\ **\ 0.145\ \textcolor{keywordflow}{and}\ isinstance(x2,\ Iterable):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ invert:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ =\ xp.ones(x1\_shape[0],\ dtype=xp.bool,\ device=\_compat.device(x1))}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ a\ \textcolor{keywordflow}{in}\ x2:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mask\ \&=\ x1\ !=\ a}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ mask\ =\ xp.zeros(x1\_shape[0],\ dtype=xp.bool,\ device=\_compat.device(x1))}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ a\ \textcolor{keywordflow}{in}\ x2:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mask\ |=\ x1\ ==\ a}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mask}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00071}00071\ \ \ \ \ rev\_idx\ =\ xp.empty(0)\ \ \textcolor{comment}{\#\ placeholder}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00072}00072\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ assume\_unique:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ x1,\ rev\_idx\ =\ xp.unique\_inverse(x1)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ x2\ =\ xp.unique\_values(x2)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00076}00076\ \ \ \ \ ar\ =\ xp.concat((x1,\ x2))}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00077}00077\ \ \ \ \ device\_\ =\ \_compat.device(ar)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00078}00078\ \ \ \ \ \textcolor{comment}{\#\ We\ need\ this\ to\ be\ a\ stable\ sort.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00079}00079\ \ \ \ \ order\ =\ xp.argsort(ar,\ stable=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00080}00080\ \ \ \ \ reverse\_order\ =\ xp.argsort(order,\ stable=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00081}00081\ \ \ \ \ sar\ =\ xp.take(ar,\ order,\ axis=0)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00082}00082\ \ \ \ \ ar\_size\ =\ \_compat.size(sar)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00083}00083\ \ \ \ \ \textcolor{keyword}{assert}\ ar\_size\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None},\ \textcolor{stringliteral}{"{}xp.unique*()\ on\ lazy\ backends\ raises"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00084}00084\ \ \ \ \ \textcolor{keywordflow}{if}\ ar\_size\ >=\ 1:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ bool\_ar\ =\ sar[1:]\ !=\ sar[:-\/1]\ \textcolor{keywordflow}{if}\ invert\ \textcolor{keywordflow}{else}\ sar[1:]\ ==\ sar[:-\/1]}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00086}00086\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ bool\_ar\ =\ xp.asarray([\textcolor{keyword}{False}])\ \textcolor{keywordflow}{if}\ invert\ \textcolor{keywordflow}{else}\ xp.asarray([\textcolor{keyword}{True}])}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00088}00088\ \ \ \ \ flag\ =\ xp.concat((bool\_ar,\ xp.asarray([invert],\ device=device\_)))}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00089}00089\ \ \ \ \ ret\ =\ xp.take(flag,\ reverse\_order,\ axis=0)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00091}00091\ \ \ \ \ \textcolor{keywordflow}{if}\ assume\_unique:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret[:\ x1.shape[0]]}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00093}00093\ \ \ \ \ \textcolor{keywordflow}{return}\ xp.take(ret,\ rev\_idx,\ axis=0)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00096}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_ab37342f746cdbb9c304962eb012659f4}{00096}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_ab37342f746cdbb9c304962eb012659f4}{mean}}(}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00097}00097\ \ \ \ \ x:\ Array,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00098}00098\ \ \ \ \ /,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00099}00099\ \ \ \ \ *,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00100}00100\ \ \ \ \ axis:\ int\ |\ tuple[int,\ ...]\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00101}00101\ \ \ \ \ keepdims:\ bool\ =\ \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00102}00102\ \ \ \ \ xp:\ ModuleType\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00103}00103\ )\ -\/>\ Array:\ \ \textcolor{comment}{\#\ numpydoc\ ignore=PR01,RT01}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00104}00104\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ Complex\ mean,\ https://github.com/data-\/apis/array-\/api/issues/846.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00107}00107\ \ \ \ \ \textcolor{keywordflow}{if}\ xp\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ xp\ =\ array\_namespace(x)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00110}00110\ \ \ \ \ \textcolor{keywordflow}{if}\ xp.isdtype(x.dtype,\ \textcolor{stringliteral}{"{}complex\ floating"{}}):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ x\_real\ =\ xp.real(x)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ x\_imag\ =\ xp.imag(x)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ mean\_real\ =\ xp.mean(x\_real,\ axis=axis,\ keepdims=keepdims)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ mean\_imag\ =\ xp.mean(x\_imag,\ axis=axis,\ keepdims=keepdims)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mean\_real\ +\ (mean\_imag\ *\ xp.asarray(1j))}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00116}00116\ \ \ \ \ \textcolor{keywordflow}{return}\ xp.mean(x,\ axis=axis,\ keepdims=keepdims)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00119}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a8a9a49f28b78ea161d8879b7de305af5}{00119}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a8a9a49f28b78ea161d8879b7de305af5}{is\_python\_scalar}}(x:\ object)\ -\/>\ TypeIs[complex]:\ \ \textcolor{comment}{\#\ numpydoc\ ignore=PR01,RT01}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00120}00120\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Return\ True\ if\ \`{}x\`{}\ is\ a\ Python\ scalar,\ False\ otherwise."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00121}00121\ \ \ \ \ \textcolor{comment}{\#\ isinstance(x,\ float)\ returns\ True\ for\ np.float64}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00122}00122\ \ \ \ \ \textcolor{comment}{\#\ isinstance(x,\ complex)\ returns\ True\ for\ np.complex128}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00123}00123\ \ \ \ \ \textcolor{comment}{\#\ bool\ is\ a\ subclass\ of\ int}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{return}\ isinstance(x,\ int\ |\ float\ |\ complex)\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ is\_numpy\_array(x)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00127}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a7878e20b0a4a6cad8a90fdd9de4b4737}{00127}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a7878e20b0a4a6cad8a90fdd9de4b4737}{asarrays}}(}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00128}00128\ \ \ \ \ a:\ Array\ |\ complex,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00129}00129\ \ \ \ \ b:\ Array\ |\ complex,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00130}00130\ \ \ \ \ xp:\ ModuleType,}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00131}00131\ )\ -\/>\ tuple[Array,\ Array]:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00132}00132\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ Ensure\ both\ \`{}a\`{}\ and\ \`{}b\`{}\ are\ arrays.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00134}00134\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}b\`{}\ is\ a\ python\ scalar,\ it\ is\ converted\ to\ the\ same\ dtype\ as\ \`{}a\`{},\ and\ vice\ versa.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00136}00136\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ Behavior\ is\ not\ specified\ when\ mixing\ a\ Python\ \`{}\`{}float\`{}\`{}\ and\ an\ array\ with\ an}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00138}00138\ \textcolor{stringliteral}{\ \ \ \ integer\ data\ type;\ this\ may\ give\ \`{}\`{}float32\`{}\`{},\ \`{}\`{}float64\`{}\`{},\ or\ raise\ an\ exception.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00139}00139\ \textcolor{stringliteral}{\ \ \ \ Behavior\ is\ implementation-\/specific.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00140}00140\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00141}00141\ \textcolor{stringliteral}{\ \ \ \ Similarly,\ behavior\ is\ not\ specified\ when\ mixing\ a\ Python\ \`{}\`{}complex\`{}\`{}\ and\ an\ array}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ with\ a\ real-\/valued\ data\ type;\ this\ may\ give\ \`{}\`{}complex64\`{}\`{},\ \`{}\`{}complex128\`{}\`{},\ or\ raise}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ an\ exception.\ Behavior\ is\ implementation-\/specific.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00144}00144\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ a,\ b\ :\ Array\ |\ int\ |\ float\ |\ complex\ |\ bool}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Input\ arrays\ or\ scalars.\ At\ least\ one\ must\ be\ an\ array.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ xp\ :\ array\_namespace,\ optional}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ standard-\/compatible\ namespace\ for\ \`{}x\`{}.\ Default:\ infer.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00151}00151\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00152}00152\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00153}00153\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00154}00154\ \textcolor{stringliteral}{\ \ \ \ Array,\ Array}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00155}00155\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ input\ arrays,\ possibly\ converted\ to\ arrays\ if\ they\ were\ scalars.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00156}00156\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00157}00157\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00158}00158\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ mixing-\/arrays-\/with-\/python-\/scalars\ :\ Array\ API\ specification\ for\ the\ behavior.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00161}00161\ \ \ \ \ a\_scalar\ =\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a8a9a49f28b78ea161d8879b7de305af5}{is\_python\_scalar}}(a)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00162}00162\ \ \ \ \ b\_scalar\ =\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a8a9a49f28b78ea161d8879b7de305af5}{is\_python\_scalar}}(b)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00163}00163\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ a\_scalar\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ b\_scalar:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ includes\ misc.\ malformed\ input\ e.g.\ str}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ a,\ b\ \ \textcolor{comment}{\#\ type:\ ignore[return-\/value]}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00167}00167\ \ \ \ \ swap\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00168}00168\ \ \ \ \ \textcolor{keywordflow}{if}\ a\_scalar:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ swap\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ b,\ a\ =\ a,\ b}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{if}\ is\_array\_api\_obj(a):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\ is\ an\ Array\ API\ object}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ b\ is\ a\ int\ |\ float\ |\ complex\ |\ bool}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ xa\ =\ a}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://data-\/apis.org/array-\/api/draft/API\_specification/type\_promotion.html\#mixing-\/arrays-\/with-\/python-\/scalars}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00178}00178\ \ \ \ \ \ \ \ \ same\_dtype\ =\ \{}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ bool:\ \textcolor{stringliteral}{"{}bool"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ int:\ (\textcolor{stringliteral}{"{}integral"{}},\ \textcolor{stringliteral}{"{}real\ floating"{}},\ \textcolor{stringliteral}{"{}complex\ floating"{}}),}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ float:\ (\textcolor{stringliteral}{"{}real\ floating"{}},\ \textcolor{stringliteral}{"{}complex\ floating"{}}),}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ complex:\ \textcolor{stringliteral}{"{}complex\ floating"{}},}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ kind\ =\ same\_dtype[type(cast(complex,\ b))]\ \ \textcolor{comment}{\#\ type:\ ignore[index]}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ xp.isdtype(a.dtype,\ kind):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ xb\ =\ xp.asarray(b,\ dtype=a.dtype)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Undefined\ behaviour.\ Let\ the\ function\ deal\ with\ it,\ if\ it\ can.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ xb\ =\ xp.asarray(b)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00191}00191\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Neither\ a\ nor\ b\ are\ Array\ API\ objects.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Note:\ we\ can\ only\ reach\ this\ point\ when\ one\ explicitly\ passes}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ xp=xp\ to\ the\ calling\ function;\ otherwise\ we\ fail\ earlier\ on}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ array\_namespace(a,\ b).}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ xa,\ xb\ =\ xp.asarray(a),\ xp.asarray(b)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00197}00197\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00198}00198\ \ \ \ \ \textcolor{keywordflow}{return}\ (xb,\ xa)\ \textcolor{keywordflow}{if}\ swap\ \textcolor{keywordflow}{else}\ (xa,\ xb)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00201}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_ab89b7e9621bf54298d2938ac4dde6b4a}{00201}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_ab89b7e9621bf54298d2938ac4dde6b4a}{ndindex}}(*x:\ int)\ -\/>\ Generator[tuple[int,\ ...]]:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00202}00202\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00203}00203\ \textcolor{stringliteral}{\ \ \ \ Generate\ all\ N-\/dimensional\ indices\ for\ a\ given\ array\ shape.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00204}00204\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00205}00205\ \textcolor{stringliteral}{\ \ \ \ Given\ the\ shape\ of\ an\ array,\ an\ ndindex\ instance\ iterates\ over\ the\ N-\/dimensional}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00206}00206\ \textcolor{stringliteral}{\ \ \ \ index\ of\ the\ array.\ At\ each\ iteration\ a\ tuple\ of\ indices\ is\ returned,\ the\ last}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ dimension\ is\ iterated\ over\ first.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00208}00208\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ This\ has\ an\ identical\ API\ to\ numpy.ndindex.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00210}00210\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00212}00212\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00213}00213\ \textcolor{stringliteral}{\ \ \ \ *x\ :\ int}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00214}00214\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ shape\ of\ the\ array.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00215}00215\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00216}00216\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ x:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ ()}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00219}00219\ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_ab89b7e9621bf54298d2938ac4dde6b4a}{ndindex}}(*x[:-\/1]):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ j\ \textcolor{keywordflow}{in}\ range(x[-\/1]):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{yield}\ *i,\ j}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00224}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0a6b9868c304a0aac6eeb4105caebc99}{00224}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0a6b9868c304a0aac6eeb4105caebc99}{eager\_shape}}(x:\ Array,\ /)\ -\/>\ tuple[int,\ ...]:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00225}00225\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00226}00226\ \textcolor{stringliteral}{\ \ \ \ Return\ shape\ of\ an\ array.\ Raise\ if\ shape\ is\ not\ fully\ defined.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00227}00227\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00228}00228\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00229}00229\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00230}00230\ \textcolor{stringliteral}{\ \ \ \ x\ :\ Array}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00231}00231\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Input\ array.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00232}00232\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00233}00233\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00234}00234\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00235}00235\ \textcolor{stringliteral}{\ \ \ \ tuple[int,\ ...]}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00236}00236\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Shape\ of\ the\ array.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00237}00237\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00238}00238\ \ \ \ \ shape\ =\ x.shape}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00239}00239\ \ \ \ \ \textcolor{comment}{\#\ Dask\ arrays\ uses\ non-\/standard\ NaN\ instead\ of\ None}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00240}00240\ \ \ \ \ \textcolor{keywordflow}{if}\ any(s\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ math.isnan(s)\ \textcolor{keywordflow}{for}\ s\ \textcolor{keywordflow}{in}\ shape):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Unsupported\ lazy\ shape"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(msg)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00243}00243\ \ \ \ \ \textcolor{keywordflow}{return}\ cast(tuple[int,\ ...],\ shape)}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00245}00245\ }
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00246}\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0435649ea98017a5d86f0837ed29080b}{00246}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1externals_1_1array__api__extra_1_1__lib_1_1__utils_1_1__helpers_a0435649ea98017a5d86f0837ed29080b}{meta\_namespace}}(}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00247}00247\ \ \ \ \ *arrays:\ Array\ |\ complex\ |\ \textcolor{keywordtype}{None},\ xp:\ ModuleType\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00248}00248\ )\ -\/>\ ModuleType:}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00249}00249\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00250}00250\ \textcolor{stringliteral}{\ \ \ \ Get\ the\ namespace\ of\ Dask\ chunks.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00251}00251\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00252}00252\ \textcolor{stringliteral}{\ \ \ \ On\ all\ other\ backends,\ just\ return\ the\ namespace\ of\ the\ arrays.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00253}00253\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ *arrays\ :\ Array\ |\ int\ |\ float\ |\ complex\ |\ bool\ |\ None}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Input\ arrays.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ xp\ :\ array\_namespace,\ optional}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ The\ standard-\/compatible\ namespace\ for\ the\ input\ arrays.\ Default:\ infer.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00260}00260\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ array\_namespace}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ If\ xp\ is\ Dask,\ the\ namespace\ of\ the\ Dask\ chunks;}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ otherwise,\ the\ namespace\ of\ the\ arrays.}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00267}00267\ \ \ \ \ xp\ =\ array\_namespace(*arrays)\ \textcolor{keywordflow}{if}\ xp\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ xp}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00268}00268\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ is\_dask\_namespace(xp):}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ xp}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00270}00270\ \ \ \ \ \textcolor{comment}{\#\ Quietly\ skip\ scalars\ and\ None's}}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00271}00271\ \ \ \ \ metas\ =\ [cast(Array\ |\ \textcolor{keywordtype}{None},\ getattr(a,\ \textcolor{stringliteral}{"{}\_meta"{}},\ \textcolor{keywordtype}{None}))\ \textcolor{keywordflow}{for}\ a\ \textcolor{keywordflow}{in}\ arrays]}
\DoxyCodeLine{\Hypertarget{array__api__extra_2__lib_2__utils_2__helpers_8py_source_l00272}00272\ \ \ \ \ \textcolor{keywordflow}{return}\ array\_namespace(*metas)}

\end{DoxyCode}
