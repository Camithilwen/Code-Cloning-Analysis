\doxysection{\+\_\+mannwhitneyu.\+py}
\hypertarget{__mannwhitneyu_8py_source}{}\label{__mannwhitneyu_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_mannwhitneyu.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/stats/\_mannwhitneyu.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00002}00002\ \textcolor{keyword}{from}\ collections\ \textcolor{keyword}{import}\ namedtuple}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00003}00003\ \textcolor{keyword}{from}\ scipy\ \textcolor{keyword}{import}\ special}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00004}00004\ \textcolor{keyword}{from}\ scipy\ \textcolor{keyword}{import}\ stats}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00005}00005\ \textcolor{keyword}{from}\ .\_axis\_nan\_policy\ \textcolor{keyword}{import}\ \_axis\_nan\_policy\_factory}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00008}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_abe09cdf7cd9737d0307872f19291fbab}{00008}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_abe09cdf7cd9737d0307872f19291fbab}{\_broadcast\_concatenate}}(x,\ y,\ axis):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00009}00009\ \ \ \ \ \textcolor{stringliteral}{'''Broadcast\ then\ concatenate\ arrays,\ leaving\ concatenation\ axis\ last'''}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00010}00010\ \ \ \ \ x\ =\ np.moveaxis(x,\ axis,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00011}00011\ \ \ \ \ y\ =\ np.moveaxis(y,\ axis,\ -\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00012}00012\ \ \ \ \ z\ =\ np.broadcast(x[...,\ 0],\ y[...,\ 0])}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00013}00013\ \ \ \ \ x\ =\ np.broadcast\_to(x,\ z.shape\ +\ (x.shape[-\/1],))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00014}00014\ \ \ \ \ y\ =\ np.broadcast\_to(y,\ z.shape\ +\ (y.shape[-\/1],))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00015}00015\ \ \ \ \ z\ =\ np.concatenate((x,\ y),\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00016}00016\ \ \ \ \ \textcolor{keywordflow}{return}\ x,\ y,\ z}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00019}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU}{00019}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU}{\_MWU}}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00020}00020\ \ \ \ \ \textcolor{stringliteral}{'''Distribution\ of\ MWU\ statistic\ under\ the\ null\ hypothesis'''}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00021}00021\ \ \ \ \ \textcolor{comment}{\#\ Possible\ improvement:\ if\ m\ and\ n\ are\ small\ enough,\ use\ integer\ arithmetic}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00023}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_a64e6e543bd669c7fa13cf0277ec89aa2}{00023}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_a64e6e543bd669c7fa13cf0277ec89aa2}{\_\_init\_\_}}(self):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''Minimal\ initializer'''}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ self.\_fmnks\ =\ -\/np.ones((1,\ 1,\ 1))}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ self.\_recursive\ =\ None}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00027}00027\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00028}00028\ \textcolor{stringliteral}{\ \ \ \ def\ pmf(self,\ k,\ m,\ n):}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00029}00029\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ if\ (self.\_recursive\ is\ None\ and\ m\ <=\ 500\ and\ n\ <=\ 500}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ or\ self.\_recursive):}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ return\ self.pmf\_recursive(k,\ m,\ n)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00032}00032\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ else:}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00033}00033\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ return\ self.pmf\_iterative(k,\ m,\ n)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00034}00034\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00035}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_ac8eb73d22cf088d15bb708c4fe9af7e3}{00035}}\ \textcolor{stringliteral}{\ \ \ \ def\ pmf\_recursive(self,\ k,\ m,\ n):}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}Probability\ mass\ function,\ recursive\ version'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ self.\_resize\_fmnks(m,\ n,\ np.max(k))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \#\ could\ loop\ over\ just\ the\ unique\ elements,\ but\ probably\ not\ worth}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \#\ the\ time\ to\ find\ them}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ for\ i\ in\ np.ravel(k):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_f(m,\ n,\ i)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ return\ self.\_fmnks[m,\ n,\ k]\ /\ special.binom(m\ +\ n,\ m)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00044}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_a6f183807a6bc439cb5ecf5f7933788b1}{00044}}\ \ \ \ \ def\ pmf\_iterative(self,\ k,\ m,\ n):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ '''Probability\ mass\ function,\ iterative\ version'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ fmnks\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ for\ i\ in\ np.ravel(k):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ fmnks\ =\ \_mwu\_f\_iterative(m,\ n,\ i,\ fmnks)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ return\ (np.array([fmnks[(m,\ n,\ ki)]\ for\ ki\ in\ k])}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ /\ special.binom(m\ +\ n,\ m))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00052}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_aa145152bc13dfa25377982c108a16354}{00052}}\ \ \ \ \ def\ cdf(self,\ k,\ m,\ n):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ '''Cumulative\ distribution\ function'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \#\ We\ could\ use\ the\ fact\ that\ the\ distribution\ is\ symmetric\ to\ avoid}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \#\ summing\ more\ than\ m*n/2\ terms,\ but\ it\ might\ not\ be\ worth\ the}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \#\ overhead.\ Let's\ leave\ that\ to\ an\ improvement.}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ pmfs\ =\ self.pmf(np.arange(0,\ np.max(k)\ +\ 1),\ m,\ n)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ cdfs\ =\ np.cumsum(pmfs)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ return\ cdfs[k]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00061}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_a111518b842bb458db3f2546883057128}{00061}}\ \ \ \ \ def\ sf(self,\ k,\ m,\ n):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ '''Survival\ function'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \#\ Use\ the\ fact\ that\ the\ distribution\ is\ symmetric;\ i.e.}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \#\ \_f(m,\ n,\ m*n-\/k)\ =\ \_f(m,\ n,\ k),\ and\ sum\ from\ the\ left}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ k\ =\ m*n\ -\/\ k}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \#\ Note\ that\ both\ CDF\ and\ SF\ include\ the\ PMF\ at\ k.\ The\ p-\/value\ is}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \#\ calculated\ from\ the\ SF\ and\ should\ include\ the\ mass\ at\ k,\ so\ this}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \#\ is\ desirable}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ return\ self.cdf(k,\ m,\ n)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00071}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_a326f68305ca46f180dfabc169f6d3e31}{00071}}\ \ \ \ \ def\ \_resize\_fmnks(self,\ m,\ n,\ k):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ '''If\ necessary,\ expand\ the\ array\ that\ remembers\ PMF\ values'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \#\ could\ probably\ use\ \`{}np.pad\`{}\ but\ I'm\ not\ sure\ it\ would\ save\ code}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ shape\_old\ =\ np.array(self.\_fmnks.shape)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ shape\_new\ =\ np.array((m+1,\ n+1,\ k+1))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ if\ np.any(shape\_new\ >\ shape\_old):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ shape\ =\ np.maximum(shape\_old,\ shape\_new)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ fmnks\ =\ -\/np.ones(shape)\ \ \ \ \ \ \ \ \ \ \ \ \ \#\ create\ the\ new\ array}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ m0,\ n0,\ k0\ =\ shape\_old}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ fmnks[:m0,\ :n0,\ :k0]\ =\ self.\_fmnks\ \ \#\ copy\ remembered\ values}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_fmnks\ =\ fmnks}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00083}\mbox{\hyperlink{classscipy_1_1stats_1_1__mannwhitneyu_1_1__MWU_ac5e8db50d650d68ac070a36f23602605}{00083}}\ \ \ \ \ def\ \_f(self,\ m,\ n,\ k):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ '''Recursive\ implementation\ of\ function\ of\ [3]\ Theorem\ 2.5'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \#\ [3]\ Theorem\ 2.5\ Line\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ if\ k\ <\ 0\ or\ m\ <\ 0\ or\ n\ <\ 0\ or\ k\ >\ m*n:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ return\ 0}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \#\ if\ already\ calculated,\ return\ the\ value}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ if\ self.\_fmnks[m,\ n,\ k]\ >=\ 0:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ return\ self.\_fmnks[m,\ n,\ k]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ if\ k\ ==\ 0\ and\ m\ >=\ 0\ and\ n\ >=\ 0:\ \ \#\ [3]\ Theorem\ 2.5\ Line\ 2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ fmnk\ =\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ else:\ \ \ \#\ [3]\ Theorem\ 2.5\ Line\ 3\ /\ Equation\ 3}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ fmnk\ =\ self.\_f(m-\/1,\ n,\ k-\/n)\ +\ self.\_f(m,\ n-\/1,\ k)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ self.\_fmnks[m,\ n,\ k]\ =\ fmnk\ \ \#\ remember\ result}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ return\ fmnk}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00102}00102\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00104}00104\ \#\ Maintain\ state\ for\ faster\ repeat\ calls\ to\ mannwhitneyu\ w/\ method='exact'}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00105}00105\ \_mwu\_state\ =\ \_MWU()}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00108}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_a54637562a743f044531b54a63ac5e57f}{00108}}\ def\ \_mwu\_f\_iterative(m,\ n,\ k,\ fmnks):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00109}00109\ \ \ \ \ '''Iterative\ implementation\ of\ function\ of\ [3]\ Theorem\ 2.5'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00111}00111\ \ \ \ \ def\ \_base\_case(m,\ n,\ k):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ '''Base\ cases\ from\ recursive\ version'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \#\ if\ already\ calculated,\ return\ the\ value}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ if\ fmnks.get((m,\ n,\ k),\ -\/1)\ >=\ 0:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ return\ fmnks[(m,\ n,\ k)]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \#\ [3]\ Theorem\ 2.5\ Line\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ elif\ k\ <\ 0\ or\ m\ <\ 0\ or\ n\ <\ 0\ or\ k\ >\ m*n:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ return\ 0}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \#\ [3]\ Theorem\ 2.5\ Line\ 2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ elif\ k\ ==\ 0\ and\ m\ >=\ 0\ and\ n\ >=\ 0:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ return\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ return\ None}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00128}00128\ \ \ \ \ stack\ =\ [(m,\ n,\ k)]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00129}00129\ \ \ \ \ fmnk\ =\ None}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00131}00131\ \ \ \ \ while\ stack:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \#\ Popping\ only\ if\ necessary\ would\ save\ a\ tiny\ bit\ of\ time,\ but\ NWI.}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ m,\ n,\ k\ =\ stack.pop()}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \#\ If\ we're\ at\ a\ base\ case,\ continue\ (stack\ unwinds)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ fmnk\ =\ \_base\_case(m,\ n,\ k)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ if\ fmnk\ is\ not\ None:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ fmnks[(m,\ n,\ k)]\ =\ fmnk}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ continue}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ \#\ If\ both\ terms\ are\ base\ cases,\ continue\ (stack\ unwinds)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ f1\ =\ \_base\_case(m-\/1,\ n,\ k-\/n)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ f2\ =\ \_base\_case(m,\ n-\/1,\ k)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ if\ f1\ is\ not\ None\ and\ f2\ is\ not\ None:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \#\ [3]\ Theorem\ 2.5\ Line\ 3\ /\ Equation\ 3}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ fmnk\ =\ f1\ +\ f2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ fmnks[(m,\ n,\ k)]\ =\ fmnk}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ continue}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \#\ recurse\ deeper}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ stack.append((m,\ n,\ k))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ if\ f1\ is\ None:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ stack.append((m-\/1,\ n,\ k-\/n))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ if\ f2\ is\ None:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ stack.append((m,\ n-\/1,\ k))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00157}00157\ \ \ \ \ return\ fmnks}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00160}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_a35a363e0a318a01c5ff260ee0b3136be}{00160}}\ def\ \_tie\_term(ranks):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00161}00161\ \ \ \ \ "{}"{}"{}Tie\ correction\ term"{}"{}"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00162}00162\ \ \ \ \ \#\ element\ i\ of\ t\ is\ the\ number\ of\ elements\ sharing\ rank\ i}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00163}00163\ \ \ \ \ \_,\ t\ =\ np.unique(ranks,\ return\_counts=True,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00164}00164\ \ \ \ \ return\ (t**3\ -\/\ t).sum(axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00167}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_a52ce46c372d21bd03893f2352088ad98}{00167}}\ def\ \_get\_mwu\_z(U,\ n1,\ n2,\ ranks,\ axis=0,\ continuity=True):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00168}00168\ \ \ \ \ '''Standardized\ MWU\ statistic'''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00169}00169\ \ \ \ \ \#\ Follows\ mannwhitneyu\ [2]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00170}00170\ \ \ \ \ mu\ =\ n1\ *\ n2\ /\ 2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00171}00171\ \ \ \ \ n\ =\ n1\ +\ n2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00172}00172\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00173}00173\ \ \ \ \ \#\ Tie\ correction\ according\ to\ [2]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00174}00174\ \ \ \ \ tie\_term\ =\ np.apply\_along\_axis(\_tie\_term,\ -\/1,\ ranks)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00175}00175\ \ \ \ \ s\ =\ np.sqrt(n1*n2/12\ *\ ((n\ +\ 1)\ -\/\ tie\_term/(n*(n-\/1))))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00177}00177\ \ \ \ \ \#\ equivalent\ to\ using\ scipy.stats.tiecorrect}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00178}00178\ \ \ \ \ \#\ T\ =\ np.apply\_along\_axis(stats.tiecorrect,\ -\/1,\ ranks)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00179}00179\ \ \ \ \ \#\ s\ =\ np.sqrt(T\ *\ n1\ *\ n2\ *\ (n1+n2+1)\ /\ 12.0)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00181}00181\ \ \ \ \ numerator\ =\ U\ -\/\ mu}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00183}00183\ \ \ \ \ \#\ Continuity\ correction.}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00184}00184\ \ \ \ \ \#\ Because\ SF\ is\ always\ used\ to\ calculate\ the\ p-\/value,\ we\ can\ always}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00185}00185\ \ \ \ \ \#\ \_subtract\_\ 0.5\ for\ the\ continuity\ correction.\ This\ always\ increases\ the}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00186}00186\ \ \ \ \ \#\ p-\/value\ to\ account\ for\ the\ rest\ of\ the\ probability\ mass\ \_at\_\ q\ =\ U.}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00187}00187\ \ \ \ \ if\ continuity:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ numerator\ -\/=\ 0.5}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00190}00190\ \ \ \ \ \#\ no\ problem\ evaluating\ the\ norm\ SF\ at\ an\ infinity}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00191}00191\ \ \ \ \ with\ np.errstate(divide='ignore',\ invalid='ignore'):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ z\ =\ numerator\ /\ s}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00193}00193\ \ \ \ \ return\ z}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00196}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_ab5aba3b89e940d590f3d1f0751e5dc0a}{00196}}\ def\ \_mwu\_input\_validation(x,\ y,\ use\_continuity,\ alternative,\ axis,\ method):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00197}00197\ \ \ \ \ '''\ Input\ validation\ and\ standardization\ for\ mannwhitneyu\ '''}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00198}00198\ \ \ \ \ \#\ Would\ use\ np.asarray\_chkfinite,\ but\ infs\ are\ OK}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00199}00199\ \ \ \ \ x,\ y\ =\ np.atleast\_1d(x),\ np.atleast\_1d(y)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00200}00200\ \ \ \ \ if\ np.isnan(x).any()\ or\ np.isnan(y).any():}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ raise\ ValueError('\`{}x\`{}\ and\ \`{}y\`{}\ must\ not\ contain\ NaNs.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00202}00202\ \ \ \ \ if\ np.size(x)\ ==\ 0\ or\ np.size(y)\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ raise\ ValueError('\`{}x\`{}\ and\ \`{}y\`{}\ must\ be\ of\ nonzero\ size.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00205}00205\ \ \ \ \ bools\ =\ \{True,\ False\}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00206}00206\ \ \ \ \ if\ use\_continuity\ not\ in\ bools:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ raise\ ValueError(f'\`{}use\_continuity\`{}\ must\ be\ one\ of\ \{bools\}.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00209}00209\ \ \ \ \ alternatives\ =\ \{"{}two-\/sided"{},\ "{}less"{},\ "{}greater"{}\}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00210}00210\ \ \ \ \ alternative\ =\ alternative.lower()}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00211}00211\ \ \ \ \ if\ alternative\ not\ in\ alternatives:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ raise\ ValueError(f'\`{}alternative\`{}\ must\ be\ one\ of\ \{alternatives\}.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00213}00213\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00214}00214\ \ \ \ \ axis\_int\ =\ int(axis)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00215}00215\ \ \ \ \ if\ axis\ !=\ axis\_int:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ raise\ ValueError('\`{}axis\`{}\ must\ be\ an\ integer.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00218}00218\ \ \ \ \ methods\ =\ \{"{}asymptotic"{},\ "{}exact"{},\ "{}auto"{}\}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00219}00219\ \ \ \ \ method\ =\ method.lower()}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00220}00220\ \ \ \ \ if\ method\ not\ in\ methods:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ raise\ ValueError(f'\`{}method\`{}\ must\ be\ one\ of\ \{methods\}.')}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00223}00223\ \ \ \ \ return\ x,\ y,\ use\_continuity,\ alternative,\ axis\_int,\ method}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00226}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_aca69f90f5e4c5ae7ba85644c97fa3f3d}{00226}}\ def\ \_tie\_check(xy):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00227}00227\ \ \ \ \ "{}"{}"{}Find\ any\ ties\ in\ data"{}"{}"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00228}00228\ \ \ \ \ \_,\ t\ =\ np.unique(xy,\ return\_counts=True,\ axis=-\/1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00229}00229\ \ \ \ \ return\ np.any(t\ !=\ 1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00230}00230\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00232}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_aa7143f854f85d4bb0374dfada95c8051}{00232}}\ def\ \_mwu\_choose\_method(n1,\ n2,\ xy,\ method):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00233}00233\ \ \ \ \ "{}"{}"{}Choose\ method\ 'asymptotic'\ or\ 'exact'\ depending\ on\ input\ size,\ ties"{}"{}"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00235}00235\ \ \ \ \ \#\ if\ both\ inputs\ are\ large,\ asymptotic\ is\ OK}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00236}00236\ \ \ \ \ if\ n1\ >\ 8\ and\ n2\ >\ 8:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ return\ "{}asymptotic"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00238}00238\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00239}00239\ \ \ \ \ \#\ if\ there\ are\ any\ ties,\ asymptotic\ is\ preferred}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00240}00240\ \ \ \ \ if\ np.apply\_along\_axis(\_tie\_check,\ -\/1,\ xy).any():}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ return\ "{}asymptotic"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00242}00242\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00243}00243\ \ \ \ \ return\ "{}exact"{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00245}00245\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00246}00246\ MannwhitneyuResult\ =\ namedtuple('MannwhitneyuResult',\ ('statistic',\ 'pvalue'))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00249}00249\ @\_axis\_nan\_policy\_factory(MannwhitneyuResult,\ n\_samples=2)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00250}\mbox{\hyperlink{namespacescipy_1_1stats_1_1__mannwhitneyu_a72ff0dc70b8aa3ab5b41469e741784f4}{00250}}\ def\ mannwhitneyu(x,\ y,\ use\_continuity=True,\ alternative="{}two-\/sided"{},}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ axis=0,\ method="{}auto"{}):}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00252}00252\ \ \ \ \ \textcolor{stringliteral}{r'''Perform\ the\ Mann-\/Whitney\ U\ rank\ test\ on\ two\ independent\ samples.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00253}00253\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00254}00254\ \textcolor{stringliteral}{\ \ \ \ The\ Mann-\/Whitney\ U\ test\ is\ a\ nonparametric\ test\ of\ the\ null\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ that\ the\ distribution\ underlying\ sample\ \`{}x\`{}\ is\ the\ same\ as\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ distribution\ underlying\ sample\ \`{}y\`{}.\ It\ is\ often\ used\ as\ a\ test\ of}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ difference\ in\ location\ between\ distributions.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00258}00258\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00259}00259\ \textcolor{stringliteral}{\ \ \ \ Parameters}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00261}00261\ \textcolor{stringliteral}{\ \ \ \ x,\ y\ :\ array-\/like}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00262}00262\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ N-\/d\ arrays\ of\ samples.\ The\ arrays\ must\ be\ broadcastable\ except\ along}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00263}00263\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ the\ dimension\ given\ by\ \`{}axis\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00264}00264\ \textcolor{stringliteral}{\ \ \ \ use\_continuity\ :\ bool,\ optional}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00265}00265\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Whether\ a\ continuity\ correction\ (1/2)\ should\ be\ applied.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00266}00266\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Default\ is\ True\ when\ \`{}method\`{}\ is\ \`{}\`{}'asymptotic'\`{}\`{};\ has\ no\ effect}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00267}00267\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ otherwise.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00268}00268\ \textcolor{stringliteral}{\ \ \ \ alternative\ :\ \{'two-\/sided',\ 'less',\ 'greater'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00269}00269\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Defines\ the\ alternative\ hypothesis.\ Default\ is\ 'two-\/sided'.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00270}00270\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Let\ *F(u)*\ and\ *G(u)*\ be\ the\ cumulative\ distribution\ functions\ of\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00271}00271\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ distributions\ underlying\ \`{}x\`{}\ and\ \`{}y\`{},\ respectively.\ Then\ the\ following}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00272}00272\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ alternative\ hypotheses\ are\ available:}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00273}00273\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00274}00274\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'two-\/sided':\ the\ distributions\ are\ not\ equal,\ i.e.\ *F(u)\ â‰ \ G(u)*\ for}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00275}00275\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ at\ least\ one\ *u*.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00276}00276\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'less':\ the\ distribution\ underlying\ \`{}x\`{}\ is\ stochastically\ less}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00277}00277\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ than\ the\ distribution\ underlying\ \`{}y\`{},\ i.e.\ *F(u)\ >\ G(u)*\ for\ all\ *u*.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00278}00278\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ 'greater':\ the\ distribution\ underlying\ \`{}x\`{}\ is\ stochastically\ greater}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00279}00279\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ than\ the\ distribution\ underlying\ \`{}y\`{},\ i.e.\ *F(u)\ <\ G(u)*\ for\ all\ *u*.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00280}00280\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00281}00281\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Under\ a\ more\ restrictive\ set\ of\ assumptions,\ the\ alternative\ hypotheses}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00282}00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ can\ be\ expressed\ in\ terms\ of\ the\ locations\ of\ the\ distributions;}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00283}00283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ see\ [5]\ section\ 5.1.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00284}00284\ \textcolor{stringliteral}{\ \ \ \ axis\ :\ int,\ optional}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00285}00285\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Axis\ along\ which\ to\ perform\ the\ test.\ Default\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00286}00286\ \textcolor{stringliteral}{\ \ \ \ method\ :\ \{'auto',\ 'asymptotic',\ 'exact'\},\ optional}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00287}00287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Selects\ the\ method\ used\ to\ calculate\ the\ *p*-\/value.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00288}00288\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Default\ is\ 'auto'.\ The\ following\ options\ are\ available.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00289}00289\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00290}00290\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ \`{}\`{}'asymptotic'\`{}\`{}:\ compares\ the\ standardized\ test\ statistic}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00291}00291\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ against\ the\ normal\ distribution,\ correcting\ for\ ties.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ \`{}\`{}'exact'\`{}\`{}:\ computes\ the\ exact\ *p*-\/value\ by\ comparing\ the\ observed}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ :math:\`{}U\`{}\ statistic\ against\ the\ exact\ distribution\ of\ the\ :math:\`{}U\`{}}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ statistic\ under\ the\ null\ hypothesis.\ No\ correction\ is\ made\ for\ ties.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00295}00295\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ *\ \`{}\`{}'auto'\`{}\`{}:\ chooses\ \`{}\`{}'exact'\`{}\`{}\ when\ the\ size\ of\ one\ of\ the\ samples}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ is\ less\ than\ or\ equal\ to\ 8\ and\ there\ are\ no\ ties;}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ chooses\ \`{}\`{}'asymptotic'\`{}\`{}\ otherwise.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00298}00298\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ Returns}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00300}00300\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ res\ :\ MannwhitneyuResult}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00302}00302\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ An\ object\ containing\ attributes:}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00303}00303\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ statistic\ :\ float}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00305}00305\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ Mann-\/Whitney\ U\ statistic\ corresponding\ with\ sample\ \`{}x\`{}.\ See}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Notes\ for\ the\ test\ statistic\ corresponding\ with\ sample\ \`{}y\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ pvalue\ :\ float}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ The\ associated\ *p*-\/value\ for\ the\ chosen\ \`{}alternative\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00309}00309\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ Notes}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ If\ \`{}\`{}U1\`{}\`{}\ is\ the\ statistic\ corresponding\ with\ sample\ \`{}x\`{},\ then\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00313}00313\ \textcolor{stringliteral}{\ \ \ \ statistic\ corresponding\ with\ sample\ \`{}y\`{}\ is}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00314}00314\ \textcolor{stringliteral}{\ \ \ \ \`{}U2\ =\ \`{}x.shape[axis]\ *\ y.shape[axis]\ -\/\ U1\`{}\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00315}00315\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00316}00316\ \textcolor{stringliteral}{\ \ \ \ \`{}mannwhitneyu\`{}\ is\ for\ independent\ samples.\ For\ related\ /\ paired\ samples,}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00317}00317\ \textcolor{stringliteral}{\ \ \ \ consider\ \`{}scipy.stats.wilcoxon\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00318}00318\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00319}00319\ \textcolor{stringliteral}{\ \ \ \ \`{}method\`{}\ \`{}\`{}'exact'\`{}\`{}\ is\ recommended\ when\ there\ are\ no\ ties\ and\ when\ either}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00320}00320\ \textcolor{stringliteral}{\ \ \ \ sample\ size\ is\ less\ than\ 8\ [1]\_.\ The\ implementation\ follows\ the\ recurrence}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00321}00321\ \textcolor{stringliteral}{\ \ \ \ relation\ originally\ proposed\ in\ [1]\_\ as\ it\ is\ described\ in\ [3]\_.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00322}00322\ \textcolor{stringliteral}{\ \ \ \ Note\ that\ the\ exact\ method\ is\ *not*\ corrected\ for\ ties,\ but}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00323}00323\ \textcolor{stringliteral}{\ \ \ \ \`{}mannwhitneyu\`{}\ will\ not\ raise\ errors\ or\ warnings\ if\ there\ are\ ties\ in\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00324}00324\ \textcolor{stringliteral}{\ \ \ \ data.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00325}00325\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00326}00326\ \textcolor{stringliteral}{\ \ \ \ The\ Mann-\/Whitney\ U\ test\ is\ a\ non-\/parametric\ version\ of\ the\ t-\/test\ for}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00327}00327\ \textcolor{stringliteral}{\ \ \ \ independent\ samples.\ When\ the\ means\ of\ samples\ from\ the\ populations}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00328}00328\ \textcolor{stringliteral}{\ \ \ \ are\ normally\ distributed,\ consider\ \`{}scipy.stats.ttest\_ind\`{}.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00329}00329\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00330}00330\ \textcolor{stringliteral}{\ \ \ \ See\ Also}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00331}00331\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00332}00332\ \textcolor{stringliteral}{\ \ \ \ scipy.stats.wilcoxon,\ scipy.stats.ranksums,\ scipy.stats.ttest\_ind}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00333}00333\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00334}00334\ \textcolor{stringliteral}{\ \ \ \ References}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00335}00335\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00336}00336\ \textcolor{stringliteral}{\ \ \ \ ..\ [1]\ H.B.\ Mann\ and\ D.R.\ Whitney,\ "{}On\ a\ test\ of\ whether\ one\ of\ two\ random}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00337}00337\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ variables\ is\ stochastically\ larger\ than\ the\ other"{},\ The\ Annals\ of}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00338}00338\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Mathematical\ Statistics,\ Vol.\ 18,\ pp.\ 50-\/60,\ 1947.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00339}00339\ \textcolor{stringliteral}{\ \ \ \ ..\ [2]\ Mann-\/Whitney\ U\ Test,\ Wikipedia,}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00340}00340\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ http://en.wikipedia.org/wiki/Mann-\/Whitney\_U\_test}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00341}00341\ \textcolor{stringliteral}{\ \ \ \ ..\ [3]\ A.\ Di\ Bucchianico,\ "{}Combinatorics,\ computer\ algebra,\ and\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00342}00342\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Wilcoxon-\/Mann-\/Whitney\ test"{},\ Journal\ of\ Statistical\ Planning\ and}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00343}00343\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Inference,\ Vol.\ 79,\ pp.\ 349-\/364,\ 1999.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00344}00344\ \textcolor{stringliteral}{\ \ \ \ ..\ [4]\ Rosie\ Shier,\ "{}Statistics:\ 2.3\ The\ Mann-\/Whitney\ U\ Test"{},\ Mathematics}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00345}00345\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ Learning\ Support\ Centre,\ 2004.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00346}00346\ \textcolor{stringliteral}{\ \ \ \ ..\ [5]\ Michael\ P.\ Fay\ and\ Michael\ A.\ Proschan.\ "{}Wilcoxon-\/Mann-\/Whitney}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00347}00347\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ or\ t-\/test?\ On\ assumptions\ for\ hypothesis\ tests\ and\ multiple\ \(\backslash\)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00348}00348\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ interpretations\ of\ decision\ rules."{}\ Statistics\ surveys,\ Vol.\ 4,\ pp.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00349}00349\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ 1-\/39,\ 2010.\ https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00350}00350\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00351}00351\ \textcolor{stringliteral}{\ \ \ \ Examples}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00352}00352\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00353}00353\ \textcolor{stringliteral}{\ \ \ \ We\ follow\ the\ example\ from\ [4]\_:\ nine\ randomly\ sampled\ young\ adults\ were}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00354}00354\ \textcolor{stringliteral}{\ \ \ \ diagnosed\ with\ type\ II\ diabetes\ at\ the\ ages\ below.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00355}00355\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00356}00356\ \textcolor{stringliteral}{\ \ \ \ >>>\ males\ =\ [19,\ 22,\ 16,\ 29,\ 24]}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00357}00357\ \textcolor{stringliteral}{\ \ \ \ >>>\ females\ =\ [20,\ 11,\ 17,\ 12]}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00358}00358\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00359}00359\ \textcolor{stringliteral}{\ \ \ \ We\ use\ the\ Mann-\/Whitney\ U\ test\ to\ assess\ whether\ there\ is\ a\ statistically}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00360}00360\ \textcolor{stringliteral}{\ \ \ \ significant\ difference\ in\ the\ diagnosis\ age\ of\ males\ and\ females.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00361}00361\ \textcolor{stringliteral}{\ \ \ \ The\ null\ hypothesis\ is\ that\ the\ distribution\ of\ male\ diagnosis\ ages\ is}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00362}00362\ \textcolor{stringliteral}{\ \ \ \ the\ same\ as\ the\ distribution\ of\ female\ diagnosis\ ages.\ We\ decide}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00363}00363\ \textcolor{stringliteral}{\ \ \ \ that\ a\ confidence\ level\ of\ 95\%\ is\ required\ to\ reject\ the\ null\ hypothesis}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00364}00364\ \textcolor{stringliteral}{\ \ \ \ in\ favor\ of\ the\ alternative\ that\ the\ distributions\ are\ different.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00365}00365\ \textcolor{stringliteral}{\ \ \ \ Since\ the\ number\ of\ samples\ is\ very\ small\ and\ there\ are\ no\ ties\ in\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00366}00366\ \textcolor{stringliteral}{\ \ \ \ data,\ we\ can\ compare\ the\ observed\ test\ statistic\ against\ the\ *exact*}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00367}00367\ \textcolor{stringliteral}{\ \ \ \ distribution\ of\ the\ test\ statistic\ under\ the\ null\ hypothesis.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00368}00368\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00369}00369\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ mannwhitneyu}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00370}00370\ \textcolor{stringliteral}{\ \ \ \ >>>\ U1,\ p\ =\ mannwhitneyu(males,\ females,\ method="{}exact"{})}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00371}00371\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(U1)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00372}00372\ \textcolor{stringliteral}{\ \ \ \ 17.0}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00373}00373\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00374}00374\ \textcolor{stringliteral}{\ \ \ \ \`{}mannwhitneyu\`{}\ always\ reports\ the\ statistic\ associated\ with\ the\ first}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00375}00375\ \textcolor{stringliteral}{\ \ \ \ sample,\ which,\ in\ this\ case,\ is\ males.\ This\ agrees\ with\ :math:\`{}U\_M\ =\ 17\`{}}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00376}00376\ \textcolor{stringliteral}{\ \ \ \ reported\ in\ [4]\_.\ The\ statistic\ associated\ with\ the\ second\ statistic}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00377}00377\ \textcolor{stringliteral}{\ \ \ \ can\ be\ calculated:}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00378}00378\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00379}00379\ \textcolor{stringliteral}{\ \ \ \ >>>\ nx,\ ny\ =\ len(males),\ len(females)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00380}00380\ \textcolor{stringliteral}{\ \ \ \ >>>\ U2\ =\ nx*ny\ -\/\ U1}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00381}00381\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(U2)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00382}00382\ \textcolor{stringliteral}{\ \ \ \ 3.0}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00383}00383\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00384}00384\ \textcolor{stringliteral}{\ \ \ \ This\ agrees\ with\ :math:\`{}U\_F\ =\ 3\`{}\ reported\ in\ [4]\_.\ The\ two-\/sided}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00385}00385\ \textcolor{stringliteral}{\ \ \ \ *p*-\/value\ can\ be\ calculated\ from\ either\ statistic,\ and\ the\ value\ produced}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00386}00386\ \textcolor{stringliteral}{\ \ \ \ by\ \`{}mannwhitneyu\`{}\ agrees\ with\ :math:\`{}p\ =\ 0.11\`{}\ reported\ in\ [4]\_.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00387}00387\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00388}00388\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(p)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00389}00389\ \textcolor{stringliteral}{\ \ \ \ 0.1111111111111111}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00390}00390\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00391}00391\ \textcolor{stringliteral}{\ \ \ \ The\ exact\ distribution\ of\ the\ test\ statistic\ is\ asymptotically\ normal,\ so}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00392}00392\ \textcolor{stringliteral}{\ \ \ \ the\ example\ continues\ by\ comparing\ the\ exact\ *p*-\/value\ against\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00393}00393\ \textcolor{stringliteral}{\ \ \ \ *p*-\/value\ produced\ using\ the\ normal\ approximation.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00394}00394\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00395}00395\ \textcolor{stringliteral}{\ \ \ \ >>>\ \_,\ pnorm\ =\ mannwhitneyu(males,\ females,\ method="{}asymptotic"{})}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00396}00396\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(pnorm)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00397}00397\ \textcolor{stringliteral}{\ \ \ \ 0.11134688653314041}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00398}00398\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00399}00399\ \textcolor{stringliteral}{\ \ \ \ Here\ \`{}mannwhitneyu\`{}'s\ reported\ *p*-\/value\ appears\ to\ conflict\ with\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00400}00400\ \textcolor{stringliteral}{\ \ \ \ value\ :math:\`{}p\ =\ 0.09\`{}\ given\ in\ [4]\_.\ The\ reason\ is\ that\ [4]\_}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00401}00401\ \textcolor{stringliteral}{\ \ \ \ does\ not\ apply\ the\ continuity\ correction\ performed\ by\ \`{}mannwhitneyu\`{};}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00402}00402\ \textcolor{stringliteral}{\ \ \ \ \`{}mannwhitneyu\`{}\ reduces\ the\ distance\ between\ the\ test\ statistic\ and\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00403}00403\ \textcolor{stringliteral}{\ \ \ \ mean\ :math:\`{}\(\backslash\)mu\ =\ n\_x\ n\_y\ /\ 2\`{}\ by\ 0.5\ to\ correct\ for\ the\ fact\ that\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00404}00404\ \textcolor{stringliteral}{\ \ \ \ discrete\ statistic\ is\ being\ compared\ against\ a\ continuous\ distribution.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00405}00405\ \textcolor{stringliteral}{\ \ \ \ Here,\ the\ :math:\`{}U\`{}\ statistic\ used\ is\ less\ than\ the\ mean,\ so\ we\ reduce}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00406}00406\ \textcolor{stringliteral}{\ \ \ \ the\ distance\ by\ adding\ 0.5\ in\ the\ numerator.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00407}00407\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00408}00408\ \textcolor{stringliteral}{\ \ \ \ >>>\ import\ numpy\ as\ np}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00409}00409\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ norm}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00410}00410\ \textcolor{stringliteral}{\ \ \ \ >>>\ U\ =\ min(U1,\ U2)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00411}00411\ \textcolor{stringliteral}{\ \ \ \ >>>\ N\ =\ nx\ +\ ny}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00412}00412\ \textcolor{stringliteral}{\ \ \ \ >>>\ z\ =\ (U\ -\/\ nx*ny/2\ +\ 0.5)\ /\ np.sqrt(nx*ny\ *\ (N\ +\ 1)/\ 12)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00413}00413\ \textcolor{stringliteral}{\ \ \ \ >>>\ p\ =\ 2\ *\ norm.cdf(z)\ \ \#\ use\ CDF\ to\ get\ p-\/value\ from\ smaller\ statistic}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00414}00414\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(p)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00415}00415\ \textcolor{stringliteral}{\ \ \ \ 0.11134688653314041}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00416}00416\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00417}00417\ \textcolor{stringliteral}{\ \ \ \ If\ desired,\ we\ can\ disable\ the\ continuity\ correction\ to\ get\ a\ result}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00418}00418\ \textcolor{stringliteral}{\ \ \ \ that\ agrees\ with\ that\ reported\ in\ [4]\_.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00419}00419\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00420}00420\ \textcolor{stringliteral}{\ \ \ \ >>>\ \_,\ pnorm\ =\ mannwhitneyu(males,\ females,\ use\_continuity=False,}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00421}00421\ \textcolor{stringliteral}{\ \ \ \ ...\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ method="{}asymptotic"{})}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00422}00422\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(pnorm)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00423}00423\ \textcolor{stringliteral}{\ \ \ \ 0.0864107329737}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00424}00424\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00425}00425\ \textcolor{stringliteral}{\ \ \ \ Regardless\ of\ whether\ we\ perform\ an\ exact\ or\ asymptotic\ test,\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00426}00426\ \textcolor{stringliteral}{\ \ \ \ probability\ of\ the\ test\ statistic\ being\ as\ extreme\ or\ more\ extreme\ by}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00427}00427\ \textcolor{stringliteral}{\ \ \ \ chance\ exceeds\ 5\%,\ so\ we\ do\ not\ consider\ the\ results\ statistically}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00428}00428\ \textcolor{stringliteral}{\ \ \ \ significant.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00429}00429\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00430}00430\ \textcolor{stringliteral}{\ \ \ \ Suppose\ that,\ before\ seeing\ the\ data,\ we\ had\ hypothesized\ that\ females}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00431}00431\ \textcolor{stringliteral}{\ \ \ \ would\ tend\ to\ be\ diagnosed\ at\ a\ younger\ age\ than\ males.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00432}00432\ \textcolor{stringliteral}{\ \ \ \ In\ that\ case,\ it\ would\ be\ natural\ to\ provide\ the\ female\ ages\ as\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00433}00433\ \textcolor{stringliteral}{\ \ \ \ first\ input,\ and\ we\ would\ have\ performed\ a\ one-\/sided\ test\ using}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00434}00434\ \textcolor{stringliteral}{\ \ \ \ \`{}\`{}alternative\ =\ 'less'\`{}\`{}:\ females\ are\ diagnosed\ at\ an\ age\ that\ is}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00435}00435\ \textcolor{stringliteral}{\ \ \ \ stochastically\ less\ than\ that\ of\ males.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00436}00436\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00437}00437\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ mannwhitneyu(females,\ males,\ alternative="{}less"{},\ method="{}exact"{})}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00438}00438\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00439}00439\ \textcolor{stringliteral}{\ \ \ \ MannwhitneyuResult(statistic=3.0,\ pvalue=0.05555555555555555)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00440}00440\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00441}00441\ \textcolor{stringliteral}{\ \ \ \ Again,\ the\ probability\ of\ getting\ a\ sufficiently\ low\ value\ of\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00442}00442\ \textcolor{stringliteral}{\ \ \ \ test\ statistic\ by\ chance\ under\ the\ null\ hypothesis\ is\ greater\ than\ 5\%,}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00443}00443\ \textcolor{stringliteral}{\ \ \ \ so\ we\ do\ not\ reject\ the\ null\ hypothesis\ in\ favor\ of\ our\ alternative.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00444}00444\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00445}00445\ \textcolor{stringliteral}{\ \ \ \ If\ it\ is\ reasonable\ to\ assume\ that\ the\ means\ of\ samples\ from\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00446}00446\ \textcolor{stringliteral}{\ \ \ \ populations\ are\ normally\ distributed,\ we\ could\ have\ used\ a\ t-\/test\ to}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00447}00447\ \textcolor{stringliteral}{\ \ \ \ perform\ the\ analysis.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00448}00448\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00449}00449\ \textcolor{stringliteral}{\ \ \ \ >>>\ from\ scipy.stats\ import\ ttest\_ind}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00450}00450\ \textcolor{stringliteral}{\ \ \ \ >>>\ res\ =\ ttest\_ind(females,\ males,\ alternative="{}less"{})}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00451}00451\ \textcolor{stringliteral}{\ \ \ \ >>>\ print(res)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00452}00452\ \textcolor{stringliteral}{\ \ \ \ Ttest\_indResult(statistic=-\/2.239334696520584,\ pvalue=0.030068441095757924)}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00453}00453\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00454}00454\ \textcolor{stringliteral}{\ \ \ \ Under\ this\ assumption,\ the\ *p*-\/value\ would\ be\ low\ enough\ to\ reject\ the}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00455}00455\ \textcolor{stringliteral}{\ \ \ \ null\ hypothesis\ in\ favor\ of\ the\ alternative.}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00456}00456\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00457}00457\ \textcolor{stringliteral}{\ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00458}00458\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00459}00459\ \ \ \ \ x,\ y,\ use\_continuity,\ alternative,\ axis\_int,\ method\ =\ (}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00460}00460\ \ \ \ \ \ \ \ \ \_mwu\_input\_validation(x,\ y,\ use\_continuity,\ alternative,\ axis,\ method))}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00461}00461\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00462}00462\ \ \ \ \ x,\ y,\ xy\ =\ \_broadcast\_concatenate(x,\ y,\ axis)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00463}00463\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00464}00464\ \ \ \ \ n1,\ n2\ =\ x.shape[-\/1],\ y.shape[-\/1]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00465}00465\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00466}00466\ \ \ \ \ if\ method\ ==\ "{}auto"{}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00467}00467\ \ \ \ \ \ \ \ \ method\ =\ \_mwu\_choose\_method(n1,\ n2,\ xy,\ method)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00468}00468\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00469}00469\ \ \ \ \ \#\ Follows\ [2]}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00470}00470\ \ \ \ \ ranks\ =\ stats.rankdata(xy,\ axis=-\/1)\ \ \#\ method\ 2,\ step\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00471}00471\ \ \ \ \ R1\ =\ ranks[...,\ :n1].sum(axis=-\/1)\ \ \ \ \#\ method\ 2,\ step\ 2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00472}00472\ \ \ \ \ U1\ =\ R1\ -\/\ n1*(n1+1)/2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ method\ 2,\ step\ 3}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00473}00473\ \ \ \ \ U2\ =\ n1\ *\ n2\ -\/\ U1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \#\ as\ U1\ +\ U2\ =\ n1\ *\ n2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00474}00474\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00475}00475\ \ \ \ \ if\ alternative\ ==\ "{}greater"{}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ U,\ f\ =\ U1,\ 1\ \ \#\ U\ is\ the\ statistic\ to\ use\ for\ p-\/value,\ f\ is\ a\ factor}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00477}00477\ \ \ \ \ elif\ alternative\ ==\ "{}less"{}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ U,\ f\ =\ U2,\ 1\ \ \#\ Due\ to\ symmetry,\ use\ SF\ of\ U2\ rather\ than\ CDF\ of\ U1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00479}00479\ \ \ \ \ else:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00480}00480\ \ \ \ \ \ \ \ \ U,\ f\ =\ np.maximum(U1,\ U2),\ 2\ \ \#\ multiply\ SF\ by\ two\ for\ two-\/sided\ test}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00481}00481\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00482}00482\ \ \ \ \ if\ method\ ==\ "{}exact"{}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00483}00483\ \ \ \ \ \ \ \ \ p\ =\ \_mwu\_state.sf(U.astype(int),\ n1,\ n2)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00484}00484\ \ \ \ \ elif\ method\ ==\ "{}asymptotic"{}:}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00485}00485\ \ \ \ \ \ \ \ \ z\ =\ \_get\_mwu\_z(U,\ n1,\ n2,\ ranks,\ continuity=use\_continuity)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00486}00486\ \ \ \ \ \ \ \ \ p\ =\ stats.norm.sf(z)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00487}00487\ \ \ \ \ p\ *=\ f}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00488}00488\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00489}00489\ \ \ \ \ \#\ Ensure\ that\ test\ statistic\ is\ not\ greater\ than\ 1}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00490}00490\ \ \ \ \ \#\ This\ could\ happen\ for\ exact\ test\ when\ U\ =\ m*n/2}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00491}00491\ \ \ \ \ p\ =\ np.clip(p,\ 0,\ 1)}
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00492}00492\ }
\DoxyCodeLine{\Hypertarget{__mannwhitneyu_8py_source_l00493}00493\ \ \ \ \ return\ MannwhitneyuResult(U1,\ p)}

\end{DoxyCode}
