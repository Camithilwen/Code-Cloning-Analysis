\doxysection{Wmf\+Image\+Plugin.\+py}
\hypertarget{WmfImagePlugin_8py_source}{}\label{WmfImagePlugin_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/PIL/WmfImagePlugin.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/PIL/WmfImagePlugin.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00001}\mbox{\hyperlink{namespacePIL_1_1WmfImagePlugin}{00001}}\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00002}00002\ \textcolor{comment}{\#\ The\ Python\ Imaging\ Library}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00003}00003\ \textcolor{comment}{\#\ \$Id\$}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00004}00004\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00005}00005\ \textcolor{comment}{\#\ WMF\ stub\ codec}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00006}00006\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00007}00007\ \textcolor{comment}{\#\ history:}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00008}00008\ \textcolor{comment}{\#\ 1996-\/12-\/14\ fl\ \ \ Created}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00009}00009\ \textcolor{comment}{\#\ 2004-\/02-\/22\ fl\ \ \ Turned\ into\ a\ stub\ driver}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00010}00010\ \textcolor{comment}{\#\ 2004-\/02-\/23\ fl\ \ \ Added\ EMF\ support}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00011}00011\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00012}00012\ \textcolor{comment}{\#\ Copyright\ (c)\ Secret\ Labs\ AB\ 1997-\/2004.\ \ All\ rights\ reserved.}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00013}00013\ \textcolor{comment}{\#\ Copyright\ (c)\ Fredrik\ Lundh\ 1996.}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00014}00014\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00015}00015\ \textcolor{comment}{\#\ See\ the\ README\ file\ for\ information\ on\ usage\ and\ redistribution.}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00016}00016\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00017}00017\ \textcolor{comment}{\#\ WMF/EMF\ reference\ documentation:}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00018}00018\ \textcolor{comment}{\#\ https://winprotocoldoc.blob.core.windows.net/productionwindowsarchives/MS-\/WMF/[MS-\/WMF].pdf}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00019}00019\ \textcolor{comment}{\#\ http://wvware.sourceforge.net/caolan/index.html}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00020}00020\ \textcolor{comment}{\#\ http://wvware.sourceforge.net/caolan/ora-\/wmf.html}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00021}00021\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00023}00023\ \textcolor{keyword}{from}\ typing\ \textcolor{keyword}{import}\ IO}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00025}00025\ \textcolor{keyword}{from}\ .\ \textcolor{keyword}{import}\ Image,\ ImageFile}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00026}00026\ \textcolor{keyword}{from}\ .\_binary\ \textcolor{keyword}{import}\ i16le\ \textcolor{keyword}{as}\ word}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00027}00027\ \textcolor{keyword}{from}\ .\_binary\ \textcolor{keyword}{import}\ si16le\ \textcolor{keyword}{as}\ short}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00028}00028\ \textcolor{keyword}{from}\ .\_binary\ \textcolor{keyword}{import}\ si32le\ \textcolor{keyword}{as}\ \_long}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00030}00030\ \_handler\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00033}\mbox{\hyperlink{namespacePIL_1_1WmfImagePlugin_a715b64cdade030321230918c8bebe086}{00033}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacePIL_1_1WmfImagePlugin_a715b64cdade030321230918c8bebe086}{register\_handler}}(handler:\ ImageFile.StubHandler\ |\ \textcolor{keywordtype}{None})\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00034}00034\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ Install\ application-\/specific\ WMF\ image\ handler.}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00036}00036\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ :param\ handler:\ Handler\ object.}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00039}00039\ \ \ \ \ \textcolor{keyword}{global}\ \_handler}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00040}00040\ \ \ \ \ \_handler\ =\ handler}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00043}00043\ \textcolor{keywordflow}{if}\ hasattr(Image.core,\ \textcolor{stringliteral}{"{}drawwmf"{}}):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00044}00044\ \ \ \ \ \textcolor{comment}{\#\ install\ default\ handler\ (windows\ only)}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00046}\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfHandler}{00046}}\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfHandler}{WmfHandler}}(\mbox{\hyperlink{classPIL_1_1ImageFile_1_1StubHandler}{ImageFile.StubHandler}}):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }open(self,\ im:\ ImageFile.StubImageFile)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ im.\_mode\ =\ \textcolor{stringliteral}{"{}RGB"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfHandler_a1f1ec73c02324bbad8b642b5ada4ef3f}{bbox}}\ =\ im.info[\textcolor{stringliteral}{"{}wmf\_bbox"{}}]}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }load(self,\ im:\ ImageFile.StubImageFile)\ -\/>\ \mbox{\hyperlink{classPIL_1_1Image_1_1Image}{Image.Image}}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ im.fp.seek(0)\ \ \textcolor{comment}{\#\ rewind}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Image.frombytes(}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}RGB"{}},}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ im.size,}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Image.core.drawwmf(im.fp.read(),\ im.size,\ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfHandler_a1f1ec73c02324bbad8b642b5ada4ef3f}{bbox}}),}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}raw"{}},}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}BGR"{}},}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (im.size[0]\ *\ 3\ +\ 3)\ \&\ -\/4,}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/1,}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00063}00063\ \ \ \ \ \mbox{\hyperlink{namespacePIL_1_1WmfImagePlugin_a715b64cdade030321230918c8bebe086}{register\_handler}}(\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfHandler}{WmfHandler}}())}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00065}00065\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00066}00066\ \textcolor{comment}{\#\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00067}00067\ \textcolor{comment}{\#\ Read\ WMF\ file}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00070}00070\ \textcolor{keyword}{def\ }\_accept(prefix:\ bytes)\ -\/>\ bool:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00071}00071\ \ \ \ \ \textcolor{keywordflow}{return}\ prefix.startswith((b\textcolor{stringliteral}{"{}\(\backslash\)xd7\(\backslash\)xcd\(\backslash\)xc6\(\backslash\)x9a\(\backslash\)x00\(\backslash\)x00"{}},\ b\textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x00\(\backslash\)x00\(\backslash\)x00"{}}))}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00078}\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile}{00078}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile}{WmfStubImageFile}}(\mbox{\hyperlink{classPIL_1_1ImageFile_1_1StubImageFile}{ImageFile.StubImageFile}}):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00079}00079\ \ \ \ \ format\ =\ \textcolor{stringliteral}{"{}WMF"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00080}00080\ \ \ \ \ format\_description\ =\ \textcolor{stringliteral}{"{}Windows\ Metafile"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00082}00082\ \ \ \ \ \textcolor{keyword}{def\ }\_open(self)\ -\/>\ None:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ placable\ header}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ s\ =\ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_a96deddd6e1e06bf4c25e974ea9f390fe}{fp}}.read(44)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00085}00085\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ s.startswith(b\textcolor{stringliteral}{"{}\(\backslash\)xd7\(\backslash\)xcd\(\backslash\)xc6\(\backslash\)x9a\(\backslash\)x00\(\backslash\)x00"{}}):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ placeable\ windows\ metafile}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ units\ per\ inch}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ inch\ =\ word(s,\ 14)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ inch\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Invalid\ inch"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classValueError}{ValueError}}(msg)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_af1fc2577cf0da2739119be813ed1797d}{\_inch}}:\ tuple[float,\ float]\ =\ inch,\ inch}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ bounding\ box}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ x0\ =\ short(s,\ 6)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ y0\ =\ short(s,\ 8)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ short(s,\ 10)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ y1\ =\ short(s,\ 12)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ normalize\ size\ to\ 72\ dots\ per\ inch}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ =\ 72}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ size\ =\ (}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (x1\ -\/\ x0)\ *\ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ //\ inch,}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (y1\ -\/\ y0)\ *\ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ //\ inch,}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00108}00108\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}wmf\_bbox"{}}]\ =\ x0,\ y0,\ x1,\ y1}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ sanity\ check\ (standard\ metafile\ header)}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ s[22:26]\ !=\ b\textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x00\(\backslash\)t\(\backslash\)x00"{}}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Unsupported\ WMF\ file\ format"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classSyntaxError}{SyntaxError}}(msg)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ s.startswith(b\textcolor{stringliteral}{"{}\(\backslash\)x01\(\backslash\)x00\(\backslash\)x00\(\backslash\)x00"{}})\ \textcolor{keywordflow}{and}\ s[40:44]\ ==\ b\textcolor{stringliteral}{"{}\ EMF"{}}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ enhanced\ metafile}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ bounding\ box}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ x0\ =\ \_long(s,\ 8)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ y0\ =\ \_long(s,\ 12)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ \_long(s,\ 16)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ y1\ =\ \_long(s,\ 20)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ get\ frame\ (in\ 0.01\ millimeter\ units)}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ frame\ =\ \_long(s,\ 24),\ \_long(s,\ 28),\ \_long(s,\ 32),\ \_long(s,\ 36)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ size\ =\ x1\ -\/\ x0,\ y1\ -\/\ y0}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ calculate\ dots\ per\ inch\ from\ bbox\ and\ frame}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ xdpi\ =\ 2540.0\ *\ (x1\ -\/\ x0)\ /\ (frame[2]\ -\/\ frame[0])}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ ydpi\ =\ 2540.0\ *\ (y1\ -\/\ y0)\ /\ (frame[3]\ -\/\ frame[1])}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}wmf\_bbox"{}}]\ =\ x0,\ y0,\ x1,\ y1}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ xdpi\ ==\ ydpi:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ =\ xdpi}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ =\ xdpi,\ ydpi}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_af1fc2577cf0da2739119be813ed1797d}{\_inch}}\ =\ xdpi,\ ydpi}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}Unsupported\ file\ format"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classSyntaxError}{SyntaxError}}(msg)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_a5137850120fce16cf6b5c04897214f40}{\_mode}}\ =\ \textcolor{stringliteral}{"{}RGB"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_a953ee3ca70f93329b38a9df7eb29671c}{\_size}}\ =\ size}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ loader\ =\ self.\mbox{\hyperlink{classPIL_1_1ImageFile_1_1StubImageFile_ac1782d9f143b35539143151e9221379d}{\_load}}()}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ loader:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ loader.open(self)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00153}\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_a4ffa91db9efa0860ffe706223e5c723a}{00153}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_a4ffa91db9efa0860ffe706223e5c723a}{\_load}}(self)\ -\/>\ ImageFile.StubHandler\ |\ None:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_handler}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00156}\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_aa0f9609065c7882a0e35f857ecd4a8d3}{00156}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_aa0f9609065c7882a0e35f857ecd4a8d3}{load}}(}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ self,\ dpi:\ float\ |\ tuple[float,\ float]\ |\ \textcolor{keywordtype}{None}\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00158}00158\ \ \ \ \ )\ -\/>\ Image.core.PixelAccess\ |\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ dpi\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}dpi"{}}]\ =\ dpi}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ x0,\ y0,\ x1,\ y1\ =\ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_ab5cae44b3e263b47aeca3056bea811fd}{info}}[\textcolor{stringliteral}{"{}wmf\_bbox"{}}]}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(dpi,\ tuple):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dpi\ =\ dpi,\ dpi}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classPIL_1_1Image_1_1Image_a953ee3ca70f93329b38a9df7eb29671c}{\_size}}\ =\ (}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int((x1\ -\/\ x0)\ *\ dpi[0]\ /\ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_af1fc2577cf0da2739119be813ed1797d}{\_inch}}[0]),}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int((y1\ -\/\ y0)\ *\ dpi[1]\ /\ self.\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_af1fc2577cf0da2739119be813ed1797d}{\_inch}}[1]),}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ super().\mbox{\hyperlink{classPIL_1_1WmfImagePlugin_1_1WmfStubImageFile_aa0f9609065c7882a0e35f857ecd4a8d3}{load}}()}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00171}00171\ \textcolor{keyword}{def\ }\_save(im:\ Image.Image,\ fp:\ IO[bytes],\ filename:\ str\ |\ bytes)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00172}00172\ \ \ \ \ \textcolor{keywordflow}{if}\ \_handler\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ hasattr(\_handler,\ \textcolor{stringliteral}{"{}save"{}}):}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ msg\ =\ \textcolor{stringliteral}{"{}WMF\ save\ handler\ not\ installed"{}}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classOSError}{OSError}}(msg)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00175}00175\ \ \ \ \ \_handler.save(im,\ fp,\ filename)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00178}00178\ \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00179}00179\ \textcolor{comment}{\#\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00180}00180\ \textcolor{comment}{\#\ Registry\ stuff}}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00182}00182\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00183}00183\ Image.register\_open(WmfStubImageFile.format,\ WmfStubImageFile,\ \_accept)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00184}00184\ Image.register\_save(WmfStubImageFile.format,\ \_save)}
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{WmfImagePlugin_8py_source_l00186}00186\ Image.register\_extensions(WmfStubImageFile.format,\ [\textcolor{stringliteral}{"{}.wmf"{}},\ \textcolor{stringliteral}{"{}.emf"{}}])}

\end{DoxyCode}
