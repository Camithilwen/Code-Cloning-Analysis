\doxysection{scipy.\+sparse.\+linalg.\+\_\+isolve.\+\_\+gcrotmk Namespace Reference}
\hypertarget{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk}{}\label{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk}\index{scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_a218bc72fc2f4dc3ff493394f4f3264d6}{\+\_\+fgmres}} (matvec, v0, m, atol, lpsolve=None, rpsolve=None, cs=(), outer\+\_\+v=(), prepend\+\_\+outer\+\_\+v=False)
\item 
\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_aa98a12563f21c62d7adbafc49d1b1998}{gcrotmk}} (A, b, x0=None, tol=1e-\/5, maxiter=1000, M=None, callback=None, m=20, k=None, CU=None, discard\+\_\+C=False, truncate=\textquotesingle{}oldest\textquotesingle{}, atol=None)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_adb5b42b05bd78ff04a306b5b9d1db5d4}{\+\_\+\+\_\+all\+\_\+\+\_\+}} = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_aa98a12563f21c62d7adbafc49d1b1998}{gcrotmk}}\textquotesingle{}\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_a218bc72fc2f4dc3ff493394f4f3264d6}\index{scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}!\_fgmres@{\_fgmres}}
\index{\_fgmres@{\_fgmres}!scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}}
\doxysubsubsection{\texorpdfstring{\_fgmres()}{\_fgmres()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_a218bc72fc2f4dc3ff493394f4f3264d6} 
scipy.\+sparse.\+linalg.\+\_\+isolve.\+\_\+gcrotmk.\+\_\+fgmres (\begin{DoxyParamCaption}\item[{}]{matvec}{, }\item[{}]{v0}{, }\item[{}]{m}{, }\item[{}]{atol}{, }\item[{}]{lpsolve}{ = {\ttfamily None}, }\item[{}]{rpsolve}{ = {\ttfamily None}, }\item[{}]{cs}{ = {\ttfamily ()}, }\item[{}]{outer\+\_\+v}{ = {\ttfamily ()}, }\item[{}]{prepend\+\_\+outer\+\_\+v}{ = {\ttfamily False}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}FGMRES Arnoldi process, with optional projection or augmentation

Parameters
----------
matvec : callable
    Operation A*x
v0 : ndarray
    Initial vector, normalized to nrm2(v0) == 1
m : int
    Number of GMRES rounds
atol : float
    Absolute tolerance for early exit
lpsolve : callable
    Left preconditioner L
rpsolve : callable
    Right preconditioner R
cs : list of (ndarray, ndarray)
    Columns of matrices C and U in GCROT
outer_v : list of ndarrays
    Augmentation vectors in LGMRES
prepend_outer_v : bool, optional
    Whether augmentation vectors come before or after
    Krylov iterates

Raises
------
LinAlgError
    If nans encountered

Returns
-------
Q, R : ndarray
    QR decomposition of the upper Hessenberg H=QR
B : ndarray
    Projections corresponding to matrix C
vs : list of ndarray
    Columns of matrix V
zs : list of ndarray
    Columns of matrix Z
y : ndarray
    Solution to ||H y - e_1||_2 = min!
res : float
    The final (preconditioned) residual norm
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__gcrotmk_8py_source_l00014}{14}} of file \mbox{\hyperlink{__gcrotmk_8py_source}{\+\_\+gcrotmk.\+py}}.



Referenced by \mbox{\hyperlink{__gcrotmk_8py_source_l00186}{gcrotmk()}}.

\Hypertarget{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_aa98a12563f21c62d7adbafc49d1b1998}\index{scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}!gcrotmk@{gcrotmk}}
\index{gcrotmk@{gcrotmk}!scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}}
\doxysubsubsection{\texorpdfstring{gcrotmk()}{gcrotmk()}}
{\footnotesize\ttfamily \label{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_aa98a12563f21c62d7adbafc49d1b1998} 
scipy.\+sparse.\+linalg.\+\_\+isolve.\+\_\+gcrotmk.\+gcrotmk (\begin{DoxyParamCaption}\item[{}]{A}{, }\item[{}]{b}{, }\item[{}]{x0}{ = {\ttfamily None}, }\item[{}]{tol}{ = {\ttfamily 1e-\/5}, }\item[{}]{maxiter}{ = {\ttfamily 1000}, }\item[{}]{M}{ = {\ttfamily None}, }\item[{}]{callback}{ = {\ttfamily None}, }\item[{}]{m}{ = {\ttfamily 20}, }\item[{}]{k}{ = {\ttfamily None}, }\item[{}]{CU}{ = {\ttfamily None}, }\item[{}]{discard\+\_\+C}{ = {\ttfamily False}, }\item[{}]{truncate}{ = {\ttfamily \textquotesingle{}oldest\textquotesingle{}}, }\item[{}]{atol}{ = {\ttfamily None}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Solve a matrix equation using flexible GCROT(m,k) algorithm.

Parameters
----------
A : {sparse matrix, ndarray, LinearOperator}
    The real or complex N-by-N matrix of the linear system.
    Alternatively, ``A`` can be a linear operator which can
    produce ``Ax`` using, e.g.,
    ``scipy.sparse.linalg.LinearOperator``.
b : ndarray
    Right hand side of the linear system. Has shape (N,) or (N,1).
x0 : ndarray
    Starting guess for the solution.
tol, atol : float, optional
    Tolerances for convergence, ``norm(residual) <= max(tol*norm(b), atol)``.
    The default for ``atol`` is `tol`.

    .. warning::

       The default value for `atol` will be changed in a future release.
       For future compatibility, specify `atol` explicitly.
maxiter : int, optional
    Maximum number of iterations.  Iteration will stop after maxiter
    steps even if the specified tolerance has not been achieved.
M : {sparse matrix, ndarray, LinearOperator}, optional
    Preconditioner for A.  The preconditioner should approximate the
    inverse of A. gcrotmk is a 'flexible' algorithm and the preconditioner
    can vary from iteration to iteration. Effective preconditioning
    dramatically improves the rate of convergence, which implies that
    fewer iterations are needed to reach a given error tolerance.
callback : function, optional
    User-supplied function to call after each iteration.  It is called
    as callback(xk), where xk is the current solution vector.
m : int, optional
    Number of inner FGMRES iterations per each outer iteration.
    Default: 20
k : int, optional
    Number of vectors to carry between inner FGMRES iterations.
    According to [2]_, good values are around m.
    Default: m
CU : list of tuples, optional
    List of tuples ``(c, u)`` which contain the columns of the matrices
    C and U in the GCROT(m,k) algorithm. For details, see [2]_.
    The list given and vectors contained in it are modified in-place.
    If not given, start from empty matrices. The ``c`` elements in the
    tuples can be ``None``, in which case the vectors are recomputed
    via ``c = A u`` on start and orthogonalized as described in [3]_.
discard_C : bool, optional
    Discard the C-vectors at the end. Useful if recycling Krylov subspaces
    for different linear systems.
truncate : {'oldest', 'smallest'}, optional
    Truncation scheme to use. Drop: oldest vectors, or vectors with
    smallest singular values using the scheme discussed in [1,2].
    See [2]_ for detailed comparison.
    Default: 'oldest'

Returns
-------
x : ndarray
    The solution found.
info : int
    Provides convergence information:

    * 0  : successful exit
    * >0 : convergence to tolerance not achieved, number of iterations

Examples
--------
>>> import numpy as np
>>> from scipy.sparse import csc_matrix
>>> from scipy.sparse.linalg import gcrotmk
>>> R = np.random.randn(5, 5)
>>> A = csc_matrix(R)
>>> b = np.random.randn(5)
>>> x, exit_code = gcrotmk(A, b)
>>> print(exit_code)
0
>>> np.allclose(A.dot(x), b)
True

References
----------
.. [1] E. de Sturler, ''Truncation strategies for optimal Krylov subspace
       methods'', SIAM J. Numer. Anal. 36, 864 (1999).
.. [2] J.E. Hicken and D.W. Zingg, ''A simplified and flexible variant
       of GCROT for solving nonsymmetric linear systems'',
       SIAM J. Sci. Comput. 32, 172 (2010).
.. [3] M.L. Parks, E. de Sturler, G. Mackey, D.D. Johnson, S. Maiti,
       ''Recycling Krylov subspaces for sequences of linear systems'',
       SIAM J. Sci. Comput. 28, 1651 (2006).
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{__gcrotmk_8py_source_l00184}{184}} of file \mbox{\hyperlink{__gcrotmk_8py_source}{\+\_\+gcrotmk.\+py}}.



References \mbox{\hyperlink{__gcrotmk_8py_source_l00015}{\+\_\+fgmres()}}.



\doxysubsection{Variable Documentation}
\Hypertarget{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_adb5b42b05bd78ff04a306b5b9d1db5d4}\index{scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}!\_\_all\_\_@{\_\_all\_\_}}
\index{\_\_all\_\_@{\_\_all\_\_}!scipy.sparse.linalg.\_isolve.\_gcrotmk@{scipy.sparse.linalg.\_isolve.\_gcrotmk}}
\doxysubsubsection{\texorpdfstring{\_\_all\_\_}{\_\_all\_\_}}
{\footnotesize\ttfamily \label{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_adb5b42b05bd78ff04a306b5b9d1db5d4} 
list scipy.\+sparse.\+linalg.\+\_\+isolve.\+\_\+gcrotmk.\+\_\+\+\_\+all\+\_\+\+\_\+ = \mbox{[}\textquotesingle{}\mbox{\hyperlink{namespacescipy_1_1sparse_1_1linalg_1_1__isolve_1_1__gcrotmk_aa98a12563f21c62d7adbafc49d1b1998}{gcrotmk}}\textquotesingle{}\mbox{]}\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{__gcrotmk_8py_source_l00011}{11}} of file \mbox{\hyperlink{__gcrotmk_8py_source}{\+\_\+gcrotmk.\+py}}.

