\doxysection{test\+\_\+cosine\+\_\+distr.\+py}
\hypertarget{test__cosine__distr_8py_source}{}\label{test__cosine__distr_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/special/tests/test\_cosine\_distr.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/special/tests/test\_cosine\_distr.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1special_1_1tests_1_1test__cosine__distr}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00002}00002\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_allclose}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00003}00003\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00004}00004\ \textcolor{keyword}{from}\ scipy.special.\_ufuncs\ \textcolor{keyword}{import}\ \_cosine\_cdf,\ \_cosine\_invcdf}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00007}00007\ \textcolor{comment}{\#\ These\ values\ are\ (x,\ p)\ where\ p\ is\ the\ expected\ exact\ value\ of}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00008}00008\ \textcolor{comment}{\#\ \_cosine\_cdf(x).\ \ These\ values\ will\ be\ tested\ for\ exact\ agreement.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00009}00009\ \_coscdf\_exact\ =\ [}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00010}00010\ \ \ \ \ (-\/4.0,\ 0.0),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00011}00011\ \ \ \ \ (0,\ 0.5),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00012}00012\ \ \ \ \ (np.pi,\ 1.0),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00013}00013\ \ \ \ \ (4.0,\ 1.0),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00014}00014\ ]}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00016}00016\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}x,\ expected"{},\ \_coscdf\_exact)}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00017}00017\ \textcolor{keyword}{def\ }test\_cosine\_cdf\_exact(x,\ expected):}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00018}00018\ \ \ \ \ \textcolor{keyword}{assert}\ \_cosine\_cdf(x)\ ==\ expected}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00021}00021\ \textcolor{comment}{\#\ These\ values\ are\ (x,\ p),\ where\ p\ is\ the\ expected\ value\ of}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00022}00022\ \textcolor{comment}{\#\ \_cosine\_cdf(x).\ The\ expected\ values\ were\ computed\ with\ mpmath\ using}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00023}00023\ \textcolor{comment}{\#\ 50\ digits\ of\ precision.\ \ These\ values\ will\ be\ tested\ for\ agreement}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00024}00024\ \textcolor{comment}{\#\ with\ the\ computed\ values\ using\ a\ very\ small\ relative\ tolerance.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00025}00025\ \textcolor{comment}{\#\ The\ value\ at\ -\/np.pi\ is\ not\ 0,\ because\ -\/np.pi\ does\ not\ equal\ -\/Ï€.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00026}00026\ \_coscdf\_close\ =\ [}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00027}00027\ \ \ \ \ (3.1409,\ 0.999999999991185),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00028}00028\ \ \ \ \ (2.25,\ 0.9819328173287907),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00029}00029\ \ \ \ \ \textcolor{comment}{\#\ -\/1.6\ is\ the\ threshold\ below\ which\ the\ Pade\ approximant\ is\ used.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00030}00030\ \ \ \ \ (-\/1.599,\ 0.08641959838382553),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00031}00031\ \ \ \ \ (-\/1.601,\ 0.086110582992713),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00032}00032\ \ \ \ \ (-\/2.0,\ 0.0369709335961611),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00033}00033\ \ \ \ \ (-\/3.0,\ 7.522387241801384e-\/05),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00034}00034\ \ \ \ \ (-\/3.1415,\ 2.109869685443648e-\/14),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00035}00035\ \ \ \ \ (-\/3.14159,\ 4.956444476505336e-\/19),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00036}00036\ \ \ \ \ (-\/np.pi,\ 4.871934450264861e-\/50),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00037}00037\ ]}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00039}00039\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}x,\ expected"{},\ \_coscdf\_close)}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00040}00040\ \textcolor{keyword}{def\ }test\_cosine\_cdf(x,\ expected):}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00041}00041\ \ \ \ \ assert\_allclose(\_cosine\_cdf(x),\ expected,\ rtol=5e-\/15)}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00044}00044\ \textcolor{comment}{\#\ These\ values\ are\ (p,\ x)\ where\ x\ is\ the\ expected\ exact\ value\ of}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00045}00045\ \textcolor{comment}{\#\ \_cosine\_invcdf(p).\ \ These\ values\ will\ be\ tested\ for\ exact\ agreement.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00046}00046\ \_cosinvcdf\_exact\ =\ [}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00047}00047\ \ \ \ \ (0.0,\ -\/np.pi),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00048}00048\ \ \ \ \ (0.5,\ 0.0),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00049}00049\ \ \ \ \ (1.0,\ np.pi),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00050}00050\ ]}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00052}00052\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}p,\ expected"{},\ \_cosinvcdf\_exact)}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00053}00053\ \textcolor{keyword}{def\ }test\_cosine\_invcdf\_exact(p,\ expected):}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00054}00054\ \ \ \ \ \textcolor{keyword}{assert}\ \_cosine\_invcdf(p)\ ==\ expected}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00057}00057\ \textcolor{keyword}{def\ }test\_cosine\_invcdf\_invalid\_p():}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00058}00058\ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ p\ values\ outside\ of\ [0,\ 1]\ return\ nan.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00059}00059\ \ \ \ \ \textcolor{keyword}{assert}\ np.isnan(\_cosine\_invcdf([-\/0.1,\ 1.1])).all()}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00062}00062\ \textcolor{comment}{\#\ These\ values\ are\ (p,\ x),\ where\ x\ is\ the\ expected\ value\ of\ \_cosine\_invcdf(p).}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00063}00063\ \textcolor{comment}{\#\ The\ expected\ values\ were\ computed\ with\ mpmath\ using\ 50\ digits\ of\ precision.}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00064}00064\ \_cosinvcdf\_close\ =\ [}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00065}00065\ \ \ \ \ (1e-\/50,\ -\/np.pi),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00066}00066\ \ \ \ \ (1e-\/14,\ -\/3.1415204137058454),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00067}00067\ \ \ \ \ (1e-\/08,\ -\/3.1343686589124524),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00068}00068\ \ \ \ \ (0.0018001,\ -\/2.732563923138336),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00069}00069\ \ \ \ \ (0.010,\ -\/2.41276589008678),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00070}00070\ \ \ \ \ (0.060,\ -\/1.7881244975330157),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00071}00071\ \ \ \ \ (0.125,\ -\/1.3752523669869274),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00072}00072\ \ \ \ \ (0.250,\ -\/0.831711193579736),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00073}00073\ \ \ \ \ (0.400,\ -\/0.3167954512395289),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00074}00074\ \ \ \ \ (0.419,\ -\/0.25586025626919906),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00075}00075\ \ \ \ \ (0.421,\ -\/0.24947570750445663),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00076}00076\ \ \ \ \ (0.750,\ 0.831711193579736),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00077}00077\ \ \ \ \ (0.940,\ 1.7881244975330153),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00078}00078\ \ \ \ \ (0.9999999996,\ 3.1391220839917167),}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00079}00079\ ]}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00081}00081\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}p,\ expected"{},\ \_cosinvcdf\_close)}}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00082}00082\ \textcolor{keyword}{def\ }test\_cosine\_invcdf(p,\ expected):}
\DoxyCodeLine{\Hypertarget{test__cosine__distr_8py_source_l00083}00083\ \ \ \ \ assert\_allclose(\_cosine\_invcdf(p),\ expected,\ rtol=1e-\/14)}

\end{DoxyCode}
