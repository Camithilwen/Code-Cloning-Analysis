\doxysection{test\+\_\+vq.\+py}
\hypertarget{test__vq_8py_source}{}\label{test__vq_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/cluster/tests/test\_vq.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/cluster/tests/test\_vq.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1cluster_1_1tests_1_1test__vq}{00001}}\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00002}00002\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00004}00004\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ (assert\_array\_equal,\ assert\_array\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00006}00006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose,\ assert\_equal,\ assert\_,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00007}00007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ suppress\_warnings)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00008}00008\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00009}00009\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1cluster_1_1vq}{scipy.cluster.vq}}\ \textcolor{keyword}{import}\ (kmeans,\ kmeans2,\ py\_vq,\ vq,\ whiten,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ClusterError,\ \_krandinit)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00013}00013\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1cluster}{scipy.cluster}}\ \textcolor{keyword}{import}\ \_vq}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1sparse_1_1__sputils}{scipy.sparse.\_sputils}}\ \textcolor{keyword}{import}\ matrix}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00017}00017\ TESTDATA\_2D\ =\ np.array([}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00018}00018\ \ \ \ \ -\/2.2,\ 1.17,\ -\/1.63,\ 1.69,\ -\/2.04,\ 4.38,\ -\/3.09,\ 0.95,\ -\/1.7,\ 4.79,\ -\/1.68,\ 0.68,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00019}00019\ \ \ \ \ -\/2.26,\ 3.34,\ -\/2.29,\ 2.55,\ -\/1.72,\ -\/0.72,\ -\/1.99,\ 2.34,\ -\/2.75,\ 3.43,\ -\/2.45,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00020}00020\ \ \ \ \ 2.41,\ -\/4.26,\ 3.65,\ -\/1.57,\ 1.87,\ -\/1.96,\ 4.03,\ -\/3.01,\ 3.86,\ -\/2.53,\ 1.28,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00021}00021\ \ \ \ \ -\/4.0,\ 3.95,\ -\/1.62,\ 1.25,\ -\/3.42,\ 3.17,\ -\/1.17,\ 0.12,\ -\/3.03,\ -\/0.27,\ -\/2.07,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00022}00022\ \ \ \ \ -\/0.55,\ -\/1.17,\ 1.34,\ -\/2.82,\ 3.08,\ -\/2.44,\ 0.24,\ -\/1.71,\ 2.48,\ -\/5.23,\ 4.29,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00023}00023\ \ \ \ \ -\/2.08,\ 3.69,\ -\/1.89,\ 3.62,\ -\/2.09,\ 0.26,\ -\/0.92,\ 1.07,\ -\/2.25,\ 0.88,\ -\/2.25,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00024}00024\ \ \ \ \ 2.02,\ -\/4.31,\ 3.86,\ -\/2.03,\ 3.42,\ -\/2.76,\ 0.3,\ -\/2.48,\ -\/0.29,\ -\/3.42,\ 3.21,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00025}00025\ \ \ \ \ -\/2.3,\ 1.73,\ -\/2.84,\ 0.69,\ -\/1.81,\ 2.48,\ -\/5.24,\ 4.52,\ -\/2.8,\ 1.31,\ -\/1.67,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00026}00026\ \ \ \ \ -\/2.34,\ -\/1.18,\ 2.17,\ -\/2.17,\ 2.82,\ -\/1.85,\ 2.25,\ -\/2.45,\ 1.86,\ -\/6.79,\ 3.94,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00027}00027\ \ \ \ \ -\/2.33,\ 1.89,\ -\/1.55,\ 2.08,\ -\/1.36,\ 0.93,\ -\/2.51,\ 2.74,\ -\/2.39,\ 3.92,\ -\/3.33,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00028}00028\ \ \ \ \ 2.99,\ -\/2.06,\ -\/0.9,\ -\/2.83,\ 3.35,\ -\/2.59,\ 3.05,\ -\/2.36,\ 1.85,\ -\/1.69,\ 1.8,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00029}00029\ \ \ \ \ -\/1.39,\ 0.66,\ -\/2.06,\ 0.38,\ -\/1.47,\ 0.44,\ -\/4.68,\ 3.77,\ -\/5.58,\ 3.44,\ -\/2.29,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00030}00030\ \ \ \ \ 2.24,\ -\/1.04,\ -\/0.38,\ -\/1.85,\ 4.23,\ -\/2.88,\ 0.73,\ -\/2.59,\ 1.39,\ -\/1.34,\ 1.75,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00031}00031\ \ \ \ \ -\/1.95,\ 1.3,\ -\/2.45,\ 3.09,\ -\/1.99,\ 3.41,\ -\/5.55,\ 5.21,\ -\/1.73,\ 2.52,\ -\/2.17,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00032}00032\ \ \ \ \ 0.85,\ -\/2.06,\ 0.49,\ -\/2.54,\ 2.07,\ -\/2.03,\ 1.3,\ -\/3.23,\ 3.09,\ -\/1.55,\ 1.44,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00033}00033\ \ \ \ \ -\/0.81,\ 1.1,\ -\/2.99,\ 2.92,\ -\/1.59,\ 2.18,\ -\/2.45,\ -\/0.73,\ -\/3.12,\ -\/1.3,\ -\/2.83,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00034}00034\ \ \ \ \ 0.2,\ -\/2.77,\ 3.24,\ -\/1.98,\ 1.6,\ -\/4.59,\ 3.39,\ -\/4.85,\ 3.75,\ -\/2.25,\ 1.71,\ -\/3.28,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00035}00035\ \ \ \ \ 3.38,\ -\/1.74,\ 0.88,\ -\/2.41,\ 1.92,\ -\/2.24,\ 1.19,\ -\/2.48,\ 1.06,\ -\/1.68,\ -\/0.62,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00036}00036\ \ \ \ \ -\/1.3,\ 0.39,\ -\/1.78,\ 2.35,\ -\/3.54,\ 2.44,\ -\/1.32,\ 0.66,\ -\/2.38,\ 2.76,\ -\/2.35,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00037}00037\ \ \ \ \ 3.95,\ -\/1.86,\ 4.32,\ -\/2.01,\ -\/1.23,\ -\/1.79,\ 2.76,\ -\/2.13,\ -\/0.13,\ -\/5.25,\ 3.84,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00038}00038\ \ \ \ \ -\/2.24,\ 1.59,\ -\/4.85,\ 2.96,\ -\/2.41,\ 0.01,\ -\/0.43,\ 0.13,\ -\/3.92,\ 2.91,\ -\/1.75,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00039}00039\ \ \ \ \ -\/0.53,\ -\/1.69,\ 1.69,\ -\/1.09,\ 0.15,\ -\/2.11,\ 2.17,\ -\/1.53,\ 1.22,\ -\/2.1,\ -\/0.86,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00040}00040\ \ \ \ \ -\/2.56,\ 2.28,\ -\/3.02,\ 3.33,\ -\/1.12,\ 3.86,\ -\/2.18,\ -\/1.19,\ -\/3.03,\ 0.79,\ -\/0.83,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00041}00041\ \ \ \ \ 0.97,\ -\/3.19,\ 1.45,\ -\/1.34,\ 1.28,\ -\/2.52,\ 4.22,\ -\/4.53,\ 3.22,\ -\/1.97,\ 1.75,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00042}00042\ \ \ \ \ -\/2.36,\ 3.19,\ -\/0.83,\ 1.53,\ -\/1.59,\ 1.86,\ -\/2.17,\ 2.3,\ -\/1.63,\ 2.71,\ -\/2.03,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00043}00043\ \ \ \ \ 3.75,\ -\/2.57,\ -\/0.6,\ -\/1.47,\ 1.33,\ -\/1.95,\ 0.7,\ -\/1.65,\ 1.27,\ -\/1.42,\ 1.09,\ -\/3.0,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00044}00044\ \ \ \ \ 3.87,\ -\/2.51,\ 3.06,\ -\/2.6,\ 0.74,\ -\/1.08,\ -\/0.03,\ -\/2.44,\ 1.31,\ -\/2.65,\ 2.99,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00045}00045\ \ \ \ \ -\/1.84,\ 1.65,\ -\/4.76,\ 3.75,\ -\/2.07,\ 3.98,\ -\/2.4,\ 2.67,\ -\/2.21,\ 1.49,\ -\/1.21,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00046}00046\ \ \ \ \ 1.22,\ -\/5.29,\ 2.38,\ -\/2.85,\ 2.28,\ -\/5.6,\ 3.78,\ -\/2.7,\ 0.8,\ -\/1.81,\ 3.5,\ -\/3.75,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00047}00047\ \ \ \ \ 4.17,\ -\/1.29,\ 2.99,\ -\/5.92,\ 3.43,\ -\/1.83,\ 1.23,\ -\/1.24,\ -\/1.04,\ -\/2.56,\ 2.37,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00048}00048\ \ \ \ \ -\/3.26,\ 0.39,\ -\/4.63,\ 2.51,\ -\/4.52,\ 3.04,\ -\/1.7,\ 0.36,\ -\/1.41,\ 0.04,\ -\/2.1,\ 1.0,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00049}00049\ \ \ \ \ -\/1.87,\ 3.78,\ -\/4.32,\ 3.59,\ -\/2.24,\ 1.38,\ -\/1.99,\ -\/0.22,\ -\/1.87,\ 1.95,\ -\/0.84,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00050}00050\ \ \ \ \ 2.17,\ -\/5.38,\ 3.56,\ -\/1.27,\ 2.9,\ -\/1.79,\ 3.31,\ -\/5.47,\ 3.85,\ -\/1.44,\ 3.69,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00051}00051\ \ \ \ \ -\/2.02,\ 0.37,\ -\/1.29,\ 0.33,\ -\/2.34,\ 2.56,\ -\/1.74,\ -\/1.27,\ -\/1.97,\ 1.22,\ -\/2.51,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00052}00052\ \ \ \ \ -\/0.16,\ -\/1.64,\ -\/0.96,\ -\/2.99,\ 1.4,\ -\/1.53,\ 3.31,\ -\/2.24,\ 0.45,\ -\/2.46,\ 1.71,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00053}00053\ \ \ \ \ -\/2.88,\ 1.56,\ -\/1.63,\ 1.46,\ -\/1.41,\ 0.68,\ -\/1.96,\ 2.76,\ -\/1.61,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00054}00054\ \ \ \ \ 2.11]).reshape((200,\ 2))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00057}00057\ \textcolor{comment}{\#\ Global\ data}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00058}00058\ X\ =\ np.array([[3.0,\ 3],\ [4,\ 3],\ [4,\ 2],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [9,\ 2],\ [5,\ 1],\ [6,\ 2],\ [9,\ 4],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5,\ 2],\ [5,\ 4],\ [7,\ 4],\ [6,\ 5]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00062}00062\ CODET1\ =\ np.array([[3.0000,\ 3.0000],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [6.2000,\ 4.0000],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [5.8000,\ 1.8000]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00066}00066\ CODET2\ =\ np.array([[11.0/3,\ 8.0/3],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [6.7500,\ 4.2500],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [6.2500,\ 1.7500]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00070}00070\ LABEL1\ =\ np.array([0,\ 1,\ 2,\ 2,\ 2,\ 2,\ 1,\ 2,\ 1,\ 1,\ 1])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00073}\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestWhiten}{00073}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestWhiten}{TestWhiten}}:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00074}00074\ \ \ \ \ \textcolor{keyword}{def\ }test\_whiten(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ desired\ =\ np.array([[5.08738849,\ 2.97091878],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [3.19909255,\ 0.69660580],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4.51041982,\ 0.02640918],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [4.38567074,\ 0.95120889],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.32191480,\ 1.63195503]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ obs\ =\ tp([[0.98744510,\ 0.82766775],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.62093317,\ 0.19406729],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.87545741,\ 0.00735733],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.85124403,\ 0.26499712],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.45067590,\ 0.45464607]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(whiten(obs),\ desired,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00088}00088\ \ \ \ \ \textcolor{keyword}{def\ }test\_whiten\_zero\_std(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ desired\ =\ np.array([[0.,\ 1.0,\ 2.86666544],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 1.0,\ 1.32460034],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 1.0,\ 3.74382172]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ obs\ =\ tp([[0.,\ 1.,\ 0.74109533],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 1.,\ 0.34243798],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.,\ 1.,\ 0.96785929]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ w:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{'always'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(whiten(obs),\ desired,\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_equal(len(w),\ 1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_(issubclass(w[-\/1].category,\ RuntimeWarning))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00102}00102\ \ \ \ \ \textcolor{keyword}{def\ }test\_whiten\_not\_finite(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ bad\_value\ \textcolor{keywordflow}{in}\ np.nan,\ np.inf,\ -\/np.inf:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ obs\ =\ tp([[0.98744510,\ bad\_value],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.62093317,\ 0.19406729],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.87545741,\ 0.00735733],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.85124403,\ 0.26499712],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0.45067590,\ 0.45464607]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ whiten,\ obs)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00113}\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestVq}{00113}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestVq}{TestVq}}:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00114}00114\ \ \ \ \ \textcolor{keyword}{def\ }test\_py\_vq(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ initc\ =\ np.concatenate([[X[0]],\ [X[1]],\ [X[2]]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ label1\ =\ py\_vq(tp(X),\ tp(initc))[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(label1,\ LABEL1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00120}00120\ \ \ \ \ \textcolor{keyword}{def\ }test\_vq(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ initc\ =\ np.concatenate([[X[0]],\ [X[1]],\ [X[2]]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ label1,\ dist\ =\ \_vq.vq(tp(X),\ tp(initc))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(label1,\ LABEL1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ tlabel1,\ tdist\ =\ vq(tp(X),\ tp(initc))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00127}00127\ \ \ \ \ \textcolor{keyword}{def\ }test\_vq\_1d(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ special\ rank\ 1\ vq\ algo,\ python\ implementation.}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ data\ =\ X[:,\ 0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ initc\ =\ data[:3]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ a,\ b\ =\ \_vq.vq(data,\ initc)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ ta,\ tb\ =\ py\_vq(data[:,\ np.newaxis],\ initc[:,\ np.newaxis])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ assert\_array\_equal(a,\ ta)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ assert\_array\_equal(b,\ tb)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00136}00136\ \ \ \ \ \textcolor{keyword}{def\ }test\_\_vq\_sametype(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ a\ =\ np.array([1.0,\ 2.0],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ b\ =\ a.astype(np.float32)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ assert\_raises(TypeError,\ \_vq.vq,\ a,\ b)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00141}00141\ \ \ \ \ \textcolor{keyword}{def\ }test\_\_vq\_invalid\_type(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ a\ =\ np.array([1,\ 2],\ dtype=int)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ assert\_raises(TypeError,\ \_vq.vq,\ a,\ a)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00145}00145\ \ \ \ \ \textcolor{keyword}{def\ }test\_vq\_large\_nfeat(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ X\ =\ np.random.rand(20,\ 20)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ code\_book\ =\ np.random.rand(3,\ 20)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ codes0,\ dis0\ =\ \_vq.vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ codes1,\ dis1\ =\ py\_vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ assert\_allclose(dis0,\ dis1,\ 1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ assert\_array\_equal(codes0,\ codes1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ X\ =\ X.astype(np.float32)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ code\_book\ =\ code\_book.astype(np.float32)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ codes0,\ dis0\ =\ \_vq.vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ codes1,\ dis1\ =\ py\_vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ assert\_allclose(dis0,\ dis1,\ 1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ assert\_array\_equal(codes0,\ codes1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00162}00162\ \ \ \ \ \textcolor{keyword}{def\ }test\_vq\_large\_features(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00163}00163\ \ \ \ \ \ \ \ \ X\ =\ np.random.rand(10,\ 5)\ *\ 1000000}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ code\_book\ =\ np.random.rand(2,\ 5)\ *\ 1000000}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ codes0,\ dis0\ =\ \_vq.vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00167}00167\ \ \ \ \ \ \ \ \ codes1,\ dis1\ =\ py\_vq(X,\ code\_book)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ assert\_allclose(dis0,\ dis1,\ 1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ assert\_array\_equal(codes0,\ codes1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00172}\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestKMean}{00172}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1cluster_1_1tests_1_1test__vq_1_1TestKMean}{TestKMean}}:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00173}00173\ \ \ \ \ \textcolor{keyword}{def\ }test\_large\_features(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Generate\ a\ data\ set\ with\ large\ values,\ and\ run\ kmeans\ on\ it\ to}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (regression\ for\ 1077).}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ d\ =\ 300}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ n\ =\ 100}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00179}00179\ \ \ \ \ \ \ \ \ m1\ =\ np.random.randn(d)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ m2\ =\ np.random.randn(d)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ x\ =\ 10000\ *\ np.random.randn(n,\ d)\ -\/\ 20000\ *\ m1}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ y\ =\ 10000\ *\ np.random.randn(n,\ d)\ +\ 20000\ *\ m2}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ data\ =\ np.empty((x.shape[0]\ +\ y.shape[0],\ d),\ np.double)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ data[:x.shape[0]]\ =\ x}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ data[x.shape[0]:]\ =\ y}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ kmeans(data,\ 2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00190}00190\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_simple(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00191}00191\ \ \ \ \ \ \ \ \ np.random.seed(54321)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ initc\ =\ np.concatenate([[X[0]],\ [X[1]],\ [X[2]]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ code1\ =\ kmeans(tp(X),\ tp(initc),\ iter=1)[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(code1,\ CODET2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00197}00197\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_lost\_cluster(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ This\ will\ cause\ kmeans\ to\ have\ a\ cluster\ with\ no\ points.}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ initk\ =\ np.array([[-\/1.8127404,\ -\/0.67128041],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [2.04621601,\ 0.07401111],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/2.31149087,\ -\/0.05160469]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00203}00203\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ kmeans(data,\ initk)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(UserWarning,}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}One\ of\ the\ clusters\ is\ empty.\ Re-\/run\ kmeans\ with\ a\ "{}}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}different\ initialization"{}})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ kmeans2(data,\ initk,\ missing=\textcolor{stringliteral}{'warn'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ assert\_raises(ClusterError,\ kmeans2,\ data,\ initk,\ missing=\textcolor{stringliteral}{'raise'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00212}00212\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00213}00213\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_simple(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ np.random.seed(12345678)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ initc\ =\ np.concatenate([[X[0]],\ [X[1]],\ [X[2]]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ tp\ \textcolor{keywordflow}{in}\ np.array,\ matrix:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ code1\ =\ kmeans2(tp(X),\ tp(initc),\ iter=1)[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ code2\ =\ kmeans2(tp(X),\ tp(initc),\ iter=2)[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00219}00219\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(code1,\ CODET1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(code2,\ CODET2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00223}00223\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_rank1(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00224}00224\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ data1\ =\ data[:,\ 0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ initc\ =\ data1[:3]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00228}00228\ \ \ \ \ \ \ \ \ code\ =\ initc.copy()}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00229}00229\ \ \ \ \ \ \ \ \ kmeans2(data1,\ code,\ iter=1)[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ kmeans2(data1,\ code,\ iter=2)[0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00232}00232\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_rank1\_2(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00234}00234\ \ \ \ \ \ \ \ \ data1\ =\ data[:,\ 0]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00235}00235\ \ \ \ \ \ \ \ \ kmeans2(data1,\ 2,\ iter=1)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00237}00237\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_high\_dim(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ kmeans2\ when\ the\ number\ of\ dimensions\ exceeds\ the\ number}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ of\ input\ points}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ data\ =\ data.reshape((20,\ 20))[:10]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ kmeans2(data,\ 2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00244}00244\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_init(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ np.random.seed(12345)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00247}00247\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ kmeans2(data,\ 3,\ minit=\textcolor{stringliteral}{'points'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ kmeans2(data[:,\ :1],\ 3,\ minit=\textcolor{stringliteral}{'points'})\ \ \textcolor{comment}{\#\ special\ case\ (1-\/D)}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00251}00251\ \ \ \ \ \ \ \ \ kmeans2(data,\ 3,\ minit=\textcolor{stringliteral}{'++'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ kmeans2(data[:,\ :1],\ 3,\ minit=\textcolor{stringliteral}{'++'})\ \ \textcolor{comment}{\#\ special\ case\ (1-\/D)}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ minit='random'\ can\ give\ warnings,\ filter\ those}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ \mbox{\hyperlink{classnumpy_1_1testing_1_1__private_1_1utils_1_1suppress__warnings}{suppress\_warnings}}()\ \textcolor{keyword}{as}\ sup:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ sup.filter(message=\textcolor{stringliteral}{"{}One\ of\ the\ clusters\ is\ empty.\ Re-\/run."{}})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ kmeans2(data,\ 3,\ minit=\textcolor{stringliteral}{'random'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ kmeans2(data[:,\ :1],\ 3,\ minit=\textcolor{stringliteral}{'random'})\ \ \textcolor{comment}{\#\ special\ case\ (1-\/D)}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00259}00259\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00260}00260\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.skipif}(sys.platform\ ==\ \textcolor{stringliteral}{'win32'},}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reason=\textcolor{stringliteral}{'Fails\ with\ MemoryError\ in\ Wine.'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00262}00262\ \ \ \ \ \textcolor{keyword}{def\ }test\_krandinit(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ data\ =\ TESTDATA\_2D}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ datas\ =\ [data.reshape((200,\ 2)),\ data.reshape((20,\ 20))[:10]]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00265}00265\ \ \ \ \ \ \ \ \ k\ =\ int(1e6)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00266}00266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ data\ \textcolor{keywordflow}{in}\ datas:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ np.random.Generator\ can\ be\ used\ (numpy\ >=\ 1.17)}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(np.random,\ \textcolor{stringliteral}{'default\_rng'}):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(1234)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rng\ =\ np.random.RandomState(1234)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ init\ =\ \_krandinit(data,\ k,\ rng)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ orig\_cov\ =\ np.cov(data,\ rowvar=0)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ init\_cov\ =\ np.cov(init,\ rowvar=0)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(orig\_cov,\ init\_cov,\ atol=1e-\/2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00278}00278\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_empty(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/1032.}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00280}00280\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ kmeans2,\ [],\ 2)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00282}00282\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_0k(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/1073:\ fail\ when\ k\ arg\ is\ 0.}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ kmeans,\ X,\ 0)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ kmeans2,\ X,\ 0)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ kmeans2,\ X,\ np.array([]))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00288}00288\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_large\_thres(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/1774}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ x\ =\ np.array([1,\ 2,\ 3,\ 4,\ 10],\ dtype=float)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ res\ =\ kmeans(x,\ 1,\ thresh=1e16)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ assert\_allclose(res[0],\ np.array([4.]))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00293}00293\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 2.3999999999999999)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00294}00294\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00295}00295\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_kpp\_low\_dim(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/11462}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ prev\_res\ =\ np.array([[-\/1.95266667,\ 0.898],}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/3.153375,\ 3.3945]])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00300}00300\ \ \ \ \ \ \ \ \ res,\ \_\ =\ kmeans2(TESTDATA\_2D,\ 2,\ minit=\textcolor{stringliteral}{'++'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00301}00301\ \ \ \ \ \ \ \ \ assert\_allclose(res,\ prev\_res)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00302}00302\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00303}00303\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans2\_kpp\_high\_dim(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/11462}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00305}00305\ \ \ \ \ \ \ \ \ n\_dim\ =\ 100}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ size\ =\ 10}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00307}00307\ \ \ \ \ \ \ \ \ centers\ =\ np.vstack([5\ *\ np.ones(n\_dim),}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/5\ *\ np.ones(n\_dim)])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ np.random.seed(42)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00310}00310\ \ \ \ \ \ \ \ \ data\ =\ np.vstack([}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ np.random.multivariate\_normal(centers[0],\ np.eye(n\_dim),\ size=size),}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ np.random.multivariate\_normal(centers[1],\ np.eye(n\_dim),\ size=size)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ res,\ \_\ =\ kmeans2(data,\ 2,\ minit=\textcolor{stringliteral}{'++'})}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ assert\_array\_almost\_equal(res,\ centers,\ decimal=0)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00316}00316\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00317}00317\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_diff\_convergence(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ gh-\/8727}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ obs\ =\ np.array([-\/3,\ -\/1,\ 0,\ 1,\ 1,\ 8],\ float)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ res\ =\ kmeans(obs,\ np.array([-\/3.,\ 0.99]))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ assert\_allclose(res[0],\ np.array([-\/0.4,\ \ 8.]))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00322}00322\ \ \ \ \ \ \ \ \ assert\_allclose(res[1],\ 1.0666666666666667)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00323}00323\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00324}00324\ \ \ \ \ \textcolor{keyword}{def\ }test\_kmeans\_and\_kmeans2\_random\_seed(self):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ seed\_list\ =\ [1234,\ np.random.RandomState(1234)]}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ np.random.Generator\ can\ be\ used\ (numpy\ >=\ 1.17)}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00329}00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(np.random,\ \textcolor{stringliteral}{'default\_rng'}):}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ seed\_list.append(np.random.default\_rng(1234))}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ seed\ \textcolor{keywordflow}{in}\ seed\_list:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ kmeans}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ res1,\ \_\ =\ kmeans(TESTDATA\_2D,\ 2,\ seed=seed)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ res2,\ \_\ =\ kmeans(TESTDATA\_2D,\ 2,\ seed=seed)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res1,\ res1)\ \ \textcolor{comment}{\#\ should\ be\ same\ results}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00337}00337\ }
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ for\ kmeans2}}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ minit\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{"{}random"{}},\ \textcolor{stringliteral}{"{}points"{}},\ \textcolor{stringliteral}{"{}++"{}}]:}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res1,\ \_\ =\ kmeans2(TESTDATA\_2D,\ 2,\ minit=minit,\ seed=seed)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ res2,\ \_\ =\ kmeans2(TESTDATA\_2D,\ 2,\ minit=minit,\ seed=seed)}
\DoxyCodeLine{\Hypertarget{test__vq_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(res1,\ res1)\ \ \textcolor{comment}{\#\ should\ be\ same\ results}}

\end{DoxyCode}
