\doxysection{\+\_\+sorting\+\_\+functions.\+py}
\hypertarget{__sorting__functions_8py_source}{}\label{__sorting__functions_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/numpy/array\_api/\_sorting\_functions.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/numpy/array\_api/\_sorting\_functions.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00001}\mbox{\hyperlink{namespacenumpy_1_1array__api_1_1__sorting__functions}{00001}}\ \textcolor{keyword}{from}\ \_\_future\_\_\ \textcolor{keyword}{import}\ annotations}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00003}00003\ \textcolor{keyword}{from}\ .\_array\_object\ \textcolor{keyword}{import}\ Array}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00004}00004\ \textcolor{keyword}{from}\ .\_dtypes\ \textcolor{keyword}{import}\ \_real\_numeric\_dtypes}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00006}00006\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00009}00009\ \textcolor{comment}{\#\ Note:\ the\ descending\ keyword\ argument\ is\ new\ in\ this\ function}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00010}\mbox{\hyperlink{namespacenumpy_1_1array__api_1_1__sorting__functions_ac2d7a029d1f5a4e5179310ffb252e407}{00010}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacenumpy_1_1array__api_1_1__sorting__functions_ac2d7a029d1f5a4e5179310ffb252e407}{argsort}}(}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00011}00011\ \ \ \ \ x:\ Array,\ /,\ *,\ axis:\ int\ =\ -\/1,\ descending:\ bool\ =\ \textcolor{keyword}{False},\ stable:\ bool\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00012}00012\ )\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00013}00013\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ Array\ API\ compatible\ wrapper\ for\ :py:func:\`{}np.argsort\ <numpy.argsort>\`{}.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00015}00015\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ See\ its\ docstring\ for\ more\ information.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00018}00018\ \ \ \ \ \textcolor{keywordflow}{if}\ x.dtype\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \_real\_numeric\_dtypes:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}Only\ real\ numeric\ dtypes\ are\ allowed\ in\ argsort"{}})}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00020}00020\ \ \ \ \ \textcolor{comment}{\#\ Note:\ this\ keyword\ argument\ is\ different,\ and\ the\ default\ is\ different.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00021}00021\ \ \ \ \ kind\ =\ \textcolor{stringliteral}{"{}stable"{}}\ \textcolor{keywordflow}{if}\ stable\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}quicksort"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ descending:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ res\ =\ np.argsort(x.\_array,\ axis=axis,\ kind=kind)}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ As\ NumPy\ has\ no\ native\ descending\ sort,\ we\ imitate\ it\ here.\ Note\ that}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ simply\ flipping\ the\ results\ of\ np.argsort(x.\_array,\ ...)\ would\ not}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ respect\ the\ relative\ order\ like\ it\ would\ in\ native\ descending\ sorts.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ res\ =\ np.flip(}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ np.argsort(np.flip(x.\_array,\ axis=axis),\ axis=axis,\ kind=kind),}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ axis=axis,}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Rely\ on\ flip()/argsort()\ to\ validate\ axis}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ normalised\_axis\ =\ axis\ \textcolor{keywordflow}{if}\ axis\ >=\ 0\ \textcolor{keywordflow}{else}\ x.ndim\ +\ axis}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ max\_i\ =\ x.shape[normalised\_axis]\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ res\ =\ max\_i\ -\/\ res}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{return}\ Array.\_new(res)}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00038}00038\ \textcolor{comment}{\#\ Note:\ the\ descending\ keyword\ argument\ is\ new\ in\ this\ function}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00039}\mbox{\hyperlink{namespacenumpy_1_1array__api_1_1__sorting__functions_ad091fe8d2430140bf6b63454c2855ea9}{00039}}\ \textcolor{keyword}{def\ }sort(}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00040}00040\ \ \ \ \ x:\ Array,\ /,\ *,\ axis:\ int\ =\ -\/1,\ descending:\ bool\ =\ \textcolor{keyword}{False},\ stable:\ bool\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00041}00041\ )\ -\/>\ Array:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00042}00042\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ Array\ API\ compatible\ wrapper\ for\ :py:func:\`{}np.sort\ <numpy.sort>\`{}.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00044}00044\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ See\ its\ docstring\ for\ more\ information.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{if}\ x.dtype\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ \_real\_numeric\_dtypes:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(\textcolor{stringliteral}{"{}Only\ real\ numeric\ dtypes\ are\ allowed\ in\ sort"{}})}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00049}00049\ \ \ \ \ \textcolor{comment}{\#\ Note:\ this\ keyword\ argument\ is\ different,\ and\ the\ default\ is\ different.}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00050}00050\ \ \ \ \ kind\ =\ \textcolor{stringliteral}{"{}stable"{}}\ \textcolor{keywordflow}{if}\ stable\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}quicksort"{}}}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00051}00051\ \ \ \ \ res\ =\ np.sort(x.\_array,\ axis=axis,\ kind=kind)}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{if}\ descending:}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ res\ =\ np.flip(res,\ axis=axis)}
\DoxyCodeLine{\Hypertarget{__sorting__functions_8py_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{return}\ Array.\_new(res)}

\end{DoxyCode}
