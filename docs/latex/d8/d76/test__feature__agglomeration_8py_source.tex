\doxysection{test\+\_\+feature\+\_\+agglomeration.\+py}
\hypertarget{test__feature__agglomeration_8py_source}{}\label{test__feature__agglomeration_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/cluster/tests/test\_feature\_agglomeration.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/cluster/tests/test\_feature\_agglomeration.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1cluster_1_1tests_1_1test__feature__agglomeration}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00002}00002\ \textcolor{stringliteral}{Tests\ for\ sklearn.cluster.\_feature\_agglomeration}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00005}00005\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_array\_equal}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1cluster}{sklearn.cluster}}\ \textcolor{keyword}{import}\ FeatureAgglomeration}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00009}00009\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1datasets}{sklearn.datasets}}\ \textcolor{keyword}{import}\ make\_blobs}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1__testing}{sklearn.utils.\_testing}}\ \textcolor{keyword}{import}\ assert\_array\_almost\_equal}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00013}00013\ \textcolor{keyword}{def\ }test\_feature\_agglomeration():}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00014}00014\ \ \ \ \ n\_clusters\ =\ 1}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00015}00015\ \ \ \ \ X\ =\ np.array([0,\ 0,\ 1]).reshape(1,\ 3)\ \ \textcolor{comment}{\#\ (n\_samples,\ n\_features)}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00017}00017\ \ \ \ \ agglo\_mean\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__agglomerative_1_1FeatureAgglomeration}{FeatureAgglomeration}}(n\_clusters=n\_clusters,\ pooling\_func=np.mean)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00018}00018\ \ \ \ \ agglo\_median\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__agglomerative_1_1FeatureAgglomeration}{FeatureAgglomeration}}(n\_clusters=n\_clusters,\ pooling\_func=np.median)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00019}00019\ \ \ \ \ agglo\_mean.fit(X)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00020}00020\ \ \ \ \ agglo\_median.fit(X)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{assert}\ np.size(np.unique(agglo\_mean.labels\_))\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{assert}\ np.size(np.unique(agglo\_median.labels\_))\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{assert}\ np.size(agglo\_mean.labels\_)\ ==\ X.shape[1]}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{assert}\ np.size(agglo\_median.labels\_)\ ==\ X.shape[1]}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00027}00027\ \ \ \ \ \textcolor{comment}{\#\ Test\ transform}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00028}00028\ \ \ \ \ Xt\_mean\ =\ agglo\_mean.transform(X)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00029}00029\ \ \ \ \ Xt\_median\ =\ agglo\_median.transform(X)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00030}00030\ \ \ \ \ \textcolor{keyword}{assert}\ Xt\_mean.shape[1]\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{assert}\ Xt\_median.shape[1]\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00032}00032\ \ \ \ \ \textcolor{keyword}{assert}\ Xt\_mean\ ==\ np.array([1\ /\ 3.0])}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{assert}\ Xt\_median\ ==\ np.array([0.0])}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00035}00035\ \ \ \ \ \textcolor{comment}{\#\ Test\ inverse\ transform}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00036}00036\ \ \ \ \ X\_full\_mean\ =\ agglo\_mean.inverse\_transform(Xt\_mean)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00037}00037\ \ \ \ \ X\_full\_median\ =\ agglo\_median.inverse\_transform(Xt\_median)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00038}00038\ \ \ \ \ \textcolor{keyword}{assert}\ np.unique(X\_full\_mean[0]).size\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00039}00039\ \ \ \ \ \textcolor{keyword}{assert}\ np.unique(X\_full\_median[0]).size\ ==\ n\_clusters}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00041}00041\ \ \ \ \ assert\_array\_almost\_equal(agglo\_mean.transform(X\_full\_mean),\ Xt\_mean)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00042}00042\ \ \ \ \ assert\_array\_almost\_equal(agglo\_median.transform(X\_full\_median),\ Xt\_median)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00045}\mbox{\hyperlink{namespacesklearn_1_1cluster_1_1tests_1_1test__feature__agglomeration_aaf4b3086020c934d9caf0407623610ce}{00045}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1cluster_1_1tests_1_1test__feature__agglomeration_aaf4b3086020c934d9caf0407623610ce}{test\_feature\_agglomeration\_feature\_names\_out}}():}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00046}00046\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ \`{}get\_feature\_names\_out\`{}\ for\ \`{}FeatureAgglomeration\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00047}00047\ \ \ \ \ X,\ \_\ =\ make\_blobs(n\_features=6,\ random\_state=0)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00048}00048\ \ \ \ \ agglo\ =\ \mbox{\hyperlink{classsklearn_1_1cluster_1_1__agglomerative_1_1FeatureAgglomeration}{FeatureAgglomeration}}(n\_clusters=3)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00049}00049\ \ \ \ \ agglo.fit(X)}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00050}00050\ \ \ \ \ n\_clusters\ =\ agglo.n\_clusters\_}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00052}00052\ \ \ \ \ names\_out\ =\ agglo.get\_feature\_names\_out()}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00053}00053\ \ \ \ \ assert\_array\_equal(}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ [f\textcolor{stringliteral}{"{}featureagglomeration\{i\}"{}}\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(n\_clusters)],\ names\_out}
\DoxyCodeLine{\Hypertarget{test__feature__agglomeration_8py_source_l00055}00055\ \ \ \ \ )}

\end{DoxyCode}
