\doxysection{test\+\_\+max\+\_\+len\+\_\+seq.\+py}
\hypertarget{test__max__len__seq_8py_source}{}\label{test__max__len__seq_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/signal/tests/test\_max\_len\_seq.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/signal/tests/test\_max\_len\_seq.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1signal_1_1tests_1_1test__max__len__seq}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00002}00002\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_allclose,\ assert\_array\_equal}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00003}00003\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1fft}{numpy.fft}}\ \textcolor{keyword}{import}\ fft,\ ifft}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00007}00007\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1signal}{scipy.signal}}\ \textcolor{keyword}{import}\ max\_len\_seq}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00010}\mbox{\hyperlink{classscipy_1_1signal_1_1tests_1_1test__max__len__seq_1_1TestMLS}{00010}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1signal_1_1tests_1_1test__max__len__seq_1_1TestMLS}{TestMLS}}:}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00012}00012\ \ \ \ \ \textcolor{keyword}{def\ }test\_mls\_inputs(self):}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00013}00013\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ can't\ all\ be\ zero\ state}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00014}00014\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ max\_len\_seq,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00015}00015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 10,\ state=np.zeros(10))}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ wrong\ size\ state}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ max\_len\_seq,\ 10,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ state=np.ones(3))}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ wrong\ length}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ max\_len\_seq,\ 10,\ length=-\/1)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ assert\_array\_equal(max\_len\_seq(10,\ length=0)[0],\ [])}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ unknown\ taps}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ max\_len\_seq,\ 64)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ bad\ taps}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ max\_len\_seq,\ 10,\ taps=[-\/1,\ 1])}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{def\ }test\_mls\_output(self):}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ define\ some\ alternate\ working\ taps}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ alt\_taps\ =\ \{2:\ [1],\ 3:\ [2],\ 4:\ [3],\ 5:\ [4,\ 3,\ 2],\ 6:\ [5,\ 4,\ 1],\ 7:\ [4],}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 8:\ [7,\ 5,\ 3]\}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ assume\ the\ other\ bit\ levels\ work,\ too\ slow\ to\ test\ higher\ orders...}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ nbits\ \textcolor{keywordflow}{in}\ range(2,\ 8):}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ state\ \textcolor{keywordflow}{in}\ [\textcolor{keywordtype}{None},\ np.round(np.random.rand(nbits))]:}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ taps\ \textcolor{keywordflow}{in}\ [\textcolor{keywordtype}{None},\ alt\_taps[nbits]]:}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ state\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ np.all(state\ ==\ 0):}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ state[0]\ =\ 1\ \ \textcolor{comment}{\#\ they\ can't\ all\ be\ zero}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_m\ =\ max\_len\_seq(nbits,\ state=state,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ taps=taps)[0]}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\ =\ 2.\ *\ orig\_m\ -\/\ 1.\ \ \textcolor{comment}{\#\ convert\ to\ +/-\/\ 1\ representation}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ First,\ make\ sure\ we\ got\ all\ 1's\ or\ -\/1}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{"{}mls\ had\ non\ binary\ terms"{}}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(np.abs(m),\ np.ones\_like(m),}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg=err\_msg)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ via\ circular\ cross-\/correlation,\ which\ is\ just\ mult.}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ the\ frequency\ domain\ with\ one\ signal\ conjugated}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tester\ =\ np.real(ifft(fft(m)\ *\ np.conj(fft(m))))}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\_len\ =\ 2**nbits\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ impulse\ amplitude\ ==\ test\_len}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{"{}mls\ impulse\ has\ incorrect\ value"{}}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(tester[0],\ out\_len,\ err\_msg=err\_msg)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ steady-\/state\ is\ -\/1}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{"{}mls\ steady-\/state\ has\ incorrect\ value"{}}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_allclose(tester[1:],\ np.full(out\_len\ -\/\ 1,\ -\/1),}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\_msg=err\_msg)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ let's\ do\ the\ split\ thing\ using\ a\ couple\ options}}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ n\ \textcolor{keywordflow}{in}\ (1,\ 2**(nbits\ -\/\ 1)):}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m1,\ s1\ =\ max\_len\_seq(nbits,\ state=state,\ taps=taps,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length=n)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m2,\ s2\ =\ max\_len\_seq(nbits,\ state=s1,\ taps=taps,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length=1)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m3,\ s3\ =\ max\_len\_seq(nbits,\ state=s2,\ taps=taps,}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ length=out\_len\ -\/\ n\ -\/\ 1)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_m\ =\ np.concatenate((m1,\ m2,\ m3))}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert\_array\_equal(orig\_m,\ new\_m)}
\DoxyCodeLine{\Hypertarget{test__max__len__seq_8py_source_l00065}00065\ }

\end{DoxyCode}
