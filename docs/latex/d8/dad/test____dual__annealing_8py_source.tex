\doxysection{test\+\_\+\+\_\+dual\+\_\+annealing.\+py}
\hypertarget{test____dual__annealing_8py_source}{}\label{test____dual__annealing_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/tests/test\_\_dual\_annealing.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/scipy/optimize/tests/test\_\_dual\_annealing.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00001}\mbox{\hyperlink{namespacescipy_1_1optimize_1_1tests_1_1test____dual__annealing}{00001}}\ \textcolor{comment}{\#\ Dual\ annealing\ unit\ tests\ implementation.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00002}00002\ \textcolor{comment}{\#\ Copyright\ (c)\ 2018\ Sylvain\ Gubian\ <sylvain.gubian@pmi.com>,}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00003}00003\ \textcolor{comment}{\#\ Yang\ Xiang\ <yang.xiang@pmi.com>}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00004}00004\ \textcolor{comment}{\#\ Author:\ Sylvain\ Gubian,\ PMP\ S.A.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00005}00005\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00006}00006\ \textcolor{stringliteral}{Unit\ tests\ for\ the\ dual\ annealing\ global\ optimizer}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00007}00007\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00008}00008\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ dual\_annealing,\ Bounds}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00010}00010\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__dual__annealing}{scipy.optimize.\_dual\_annealing}}\ \textcolor{keyword}{import}\ EnergyState}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00011}00011\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__dual__annealing}{scipy.optimize.\_dual\_annealing}}\ \textcolor{keyword}{import}\ LocalSearchWrapper}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00012}00012\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__dual__annealing}{scipy.optimize.\_dual\_annealing}}\ \textcolor{keyword}{import}\ ObjectiveFunWrapper}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00013}00013\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__dual__annealing}{scipy.optimize.\_dual\_annealing}}\ \textcolor{keyword}{import}\ StrategyChain}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__dual__annealing}{scipy.optimize.\_dual\_annealing}}\ \textcolor{keyword}{import}\ VisitingDistribution}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00015}00015\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ rosen,\ rosen\_der}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00016}00016\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00017}00017\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00018}00018\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacenumpy_1_1testing}{numpy.testing}}\ \textcolor{keyword}{import}\ assert\_equal,\ assert\_allclose,\ assert\_array\_less}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00019}00019\ \textcolor{keyword}{from}\ pytest\ \textcolor{keyword}{import}\ raises\ \textcolor{keyword}{as}\ assert\_raises}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00020}00020\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1__lib_1_1__util}{scipy.\_lib.\_util}}\ \textcolor{keyword}{import}\ check\_random\_state}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00023}\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing}{00023}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing}{TestDualAnnealing}}:}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{def\ }setup\_method(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ function\ that\ returns\ always\ infinity\ for\ initialization\ tests}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3bed4c4e92bdd410d5d7f620f9731b2b}{weirdfunc}}\ =\ \textcolor{keyword}{lambda}\ x:\ np.inf}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 2-\/D\ bounds\ for\ testing\ function}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}}\ =\ [(-\/5.12,\ 5.12)]\ *\ 2}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ 4-\/D\ bounds\ for\ testing\ function}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a89ebb03561b81d4110ed6ff9cc1c4f09}{hd\_bounds}}\ =\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}}\ *\ 4}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ values\ to\ be\ generated\ for\ testing\ visit\ function}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a884db6dca7492ff6f8e114a18ce7d647}{nbtestvalues}}\ =\ 5000}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a2a787315819dd56499e2e75868873483}{high\_temperature}}\ =\ 5230}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a6a7be09138262e756dc8cc6bb85ae6e4}{low\_temperature}}\ =\ 0.1}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_ac029d681962543aafdf18caf5809e574}{qv}}\ =\ 2.62}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}}\ =\ 1234}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa0d032681283652b0126c690ef8c94c3}{rs}}\ =\ check\_random\_state(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a9b1ebcd53b01f6471015589ce56f3ad0}{nb\_fun\_call}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a0987b53fd475d8212e5d269a438bb540}{ngev}}\ =\ 0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00042}00042\ \ \ \ \ \textcolor{keyword}{def\ }callback(self,\ x,\ f,\ context):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ For\ testing\ callback\ mechanism.\ Should\ stop\ for\ e\ <=\ 1\ as}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ callback\ function\ returns\ True}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ f\ <=\ 1.0:}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00048}00048\ \ \ \ \ \textcolor{keyword}{def\ }func(self,\ x,\ args=()):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Using\ Rastrigin\ function\ for\ performing\ tests}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ args:}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ shift\ =\ args}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ shift\ =\ 0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ y\ =\ np.sum((x\ -\/\ shift)\ **\ 2\ -\/\ 10\ *\ np.cos(2\ *\ np.pi\ *\ (}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ x\ -\/\ shift)))\ +\ 10\ *\ np.size(x)\ +\ shift}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a9b1ebcd53b01f6471015589ce56f3ad0}{nb\_fun\_call}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ y}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00059}00059\ \ \ \ \ \textcolor{keyword}{def\ }rosen\_der\_wrapper(self,\ x,\ args=()):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a0987b53fd475d8212e5d269a438bb540}{ngev}}\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacescipy_1_1optimize_1_1__optimize_a54e7ddc9ff63c7eaa2b008492c9f7821}{rosen\_der}}(x,\ *args)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00062}00062\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00063}00063\ \ \ \ \ \textcolor{comment}{\#\ FIXME:\ there\ are\ some\ discontinuities\ in\ behaviour\ as\ a\ function\ of\ \`{}qv`,}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00064}00064\ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ this\ needs\ investigating\ -\/\ see\ gh-\/12384}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00065}00065\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('qv',\ [1.1,\ 1.41,\ 2,\ 2.62,\ 2.9])}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00066}00066\ \ \ \ \ \textcolor{keyword}{def\ }test\_visiting\_stepping(self,\ qv):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ lu\ =\ list(zip(*self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}}))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ lower\ =\ np.array(lu[0])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ upper\ =\ np.array(lu[1])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ dim\ =\ lower.size}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ vd\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1VisitingDistribution}{VisitingDistribution}}(lower,\ upper,\ qv,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa0d032681283652b0126c690ef8c94c3}{rs}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ values\ =\ np.zeros(dim)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ x\_step\_low\ =\ vd.visiting(values,\ 0,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a2a787315819dd56499e2e75868873483}{high\_temperature}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ that\ only\ the\ first\ component\ is\ changed}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ assert\_equal(np.not\_equal(x\_step\_low,\ 0),\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ values\ =\ np.zeros(dim)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ x\_step\_high\ =\ vd.visiting(values,\ dim,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a2a787315819dd56499e2e75868873483}{high\_temperature}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Make\ sure\ that\ component\ other\ than\ at\ dim\ has\ changed}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ assert\_equal(np.not\_equal(x\_step\_high[0],\ 0),\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00081}00081\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize('qv',\ [2.25,\ 2.62,\ 2.9])}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00082}00082\ \ \ \ \ \textcolor{keyword}{def\ }test\_visiting\_dist\_high\_temperature(self,\ qv):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ lu\ =\ list(zip(*self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}}))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ lower\ =\ np.array(lu[0])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ upper\ =\ np.array(lu[1])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ vd\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1VisitingDistribution}{VisitingDistribution}}(lower,\ upper,\ qv,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa0d032681283652b0126c690ef8c94c3}{rs}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ values\ =\ np.zeros(self.nbtestvalues)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ for\ i\ in\ np.arange(self.nbtestvalues):}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ values[i]\ =\ vd.visit\_fn(self.high\_temperature)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ values\ =\ vd.visit\_fn(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a2a787315819dd56499e2e75868873483}{high\_temperature}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a884db6dca7492ff6f8e114a18ce7d647}{nbtestvalues}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Visiting\ distribution\ is\ a\ distorted\ version\ of\ Cauchy-\/Lorentz}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ distribution,\ and\ as\ no\ 1st\ and\ higher\ moments\ (no\ mean\ defined,}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ no\ variance\ defined).}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ big\ tails\ values\ are\ generated}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ assert\_array\_less(np.min(values),\ 1e-\/10)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ assert\_array\_less(1e+10,\ np.max(values))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00099}00099\ \ \ \ \ \textcolor{keyword}{def\ }test\_reset(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ owf\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1ObjectiveFunWrapper}{ObjectiveFunWrapper}}(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3bed4c4e92bdd410d5d7f620f9731b2b}{weirdfunc}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ lu\ =\ list(zip(*self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}}))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ lower\ =\ np.array(lu[0])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ upper\ =\ np.array(lu[1])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ es\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1EnergyState}{EnergyState}}(lower,\ upper)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ es.reset,\ owf,\ check\_random\_state(\textcolor{keywordtype}{None}))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00107}00107\ \ \ \ \ \textcolor{keyword}{def\ }test\_low\_dim(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.,\ atol=1e-\/12)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.success}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00113}00113\ \ \ \ \ \textcolor{keyword}{def\ }test\_high\_dim(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a89ebb03561b81d4110ed6ff9cc1c4f09}{hd\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.,\ atol=1e-\/12)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.success}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00118}00118\ \ \ \ \ \textcolor{keyword}{def\ }test\_low\_dim\_no\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ no\_local\_search=\textcolor{keyword}{True},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00123}00123\ \ \ \ \ \textcolor{keyword}{def\ }test\_high\_dim\_no\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a89ebb03561b81d4110ed6ff9cc1c4f09}{hd\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ no\_local\_search=\textcolor{keyword}{True},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00128}00128\ \ \ \ \ \textcolor{keyword}{def\ }test\_nb\_fun\_call(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a9b1ebcd53b01f6471015589ce56f3ad0}{nb\_fun\_call}},\ ret.nfev)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00132}00132\ \ \ \ \ \textcolor{keyword}{def\ }test\_nb\_fun\_call\_no\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ no\_local\_search=\textcolor{keyword}{True},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ assert\_equal(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a9b1ebcd53b01f6471015589ce56f3ad0}{nb\_fun\_call}},\ ret.nfev)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00137}00137\ \ \ \ \ \textcolor{keyword}{def\ }test\_max\_reinit(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3bed4c4e92bdd410d5d7f620f9731b2b}{weirdfunc}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00141}00141\ \ \ \ \ \textcolor{keyword}{def\ }test\_reproduce(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ res1\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ res2\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ res3\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we\ have\ reproducible\ results,\ x\ components\ found\ has\ to}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ be\ exactly\ the\ same,\ which\ is\ not\ the\ case\ with\ no\ seeding}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ assert\_equal(res1.x,\ res2.x)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ assert\_equal(res1.x,\ res3.x)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00150}00150\ \ \ \ \ \textcolor{keyword}{def\ }test\_rand\_gen(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ check\ that\ np.random.Generator\ can\ be\ used\ (numpy\ >=\ 1.17)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ obtain\ a\ np.random.Generator\ object}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(1)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ res1\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=rng)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ seed\ again}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(1)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ res2\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ seed=rng)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we\ have\ reproducible\ results,\ x\ components\ found\ has\ to}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00160}00160\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ be\ exactly\ the\ same,\ which\ is\ not\ the\ case\ with\ no\ seeding}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00161}00161\ \ \ \ \ \ \ \ \ assert\_equal(res1.x,\ res2.x)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00163}00163\ \ \ \ \ \textcolor{keyword}{def\ }test\_bounds\_integrity(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00164}00164\ \ \ \ \ \ \ \ \ wrong\_bounds\ =\ [(-\/5.12,\ 5.12),\ (1,\ 0),\ (5.12,\ 5.12)]}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ wrong\_bounds)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00168}00168\ \ \ \ \ \textcolor{keyword}{def\ }test\_bound\_validity(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ invalid\_bounds\ =\ [(-\/5,\ 5),\ (-\/np.inf,\ 0),\ (-\/5,\ 5)]}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invalid\_bounds)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ invalid\_bounds\ =\ [(-\/5,\ 5),\ (0,\ np.inf),\ (-\/5,\ 5)]}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invalid\_bounds)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ invalid\_bounds\ =\ [(-\/5,\ 5),\ (0,\ np.nan),\ (-\/5,\ 5)]}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00176}00176\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invalid\_bounds)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00179}00179\ \ \ \ \ \textcolor{keyword}{def\ }test\_deprecated\_local\_search\_options\_bounds(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00180}00180\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }func(x):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum((x\ -\/\ 5)\ *\ (x\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00182}00182\ \ \ \ \ \ \ \ \ bounds\ =\ list(zip([-\/6,\ -\/5],\ [6,\ 5]))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ bounds\ can\ be\ passed\ (see\ gh-\/10831)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00184}00184\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{r"{}Method\ CG\ cannot\ handle\ "{}}):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ dual\_annealing(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ func,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bounds=bounds,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=\{\textcolor{stringliteral}{"{}method"{}}:\ \textcolor{stringliteral}{"{}CG"{}},\ \textcolor{stringliteral}{"{}bounds"{}}:\ bounds\})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00190}00190\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00191}00191\ \ \ \ \ \textcolor{keyword}{def\ }test\_minimizer\_kwargs\_bounds(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00192}00192\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }func(x):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum((x\ -\/\ 5)\ *\ (x\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00194}00194\ \ \ \ \ \ \ \ \ bounds\ =\ list(zip([-\/6,\ -\/5],\ [6,\ 5]))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ bounds\ can\ be\ passed\ (see\ gh-\/10831)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00196}00196\ \ \ \ \ \ \ \ \ dual\_annealing(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ func,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ bounds=bounds,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=\{\textcolor{stringliteral}{"{}method"{}}:\ \textcolor{stringliteral}{"{}SLSQP"{}},\ \textcolor{stringliteral}{"{}bounds"{}}:\ bounds\})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00200}00200\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00201}00201\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(RuntimeWarning,\ match=\textcolor{stringliteral}{r"{}Method\ CG\ cannot\ handle\ "{}}):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ dual\_annealing(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ func,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bounds=bounds,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=\{\textcolor{stringliteral}{"{}method"{}}:\ \textcolor{stringliteral}{"{}CG"{}},\ \textcolor{stringliteral}{"{}bounds"{}}:\ bounds\})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00207}00207\ \ \ \ \ \textcolor{keyword}{def\ }test\_max\_fun\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00208}00208\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ maxfun=100,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00211}00211\ \ \ \ \ \ \ \ \ ls\_max\_iter\ =\ min(max(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ len(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}})\ *\ LocalSearchWrapper.LS\_MAXITER\_RATIO,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ LocalSearchWrapper.LS\_MAXITER\_MIN),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ LocalSearchWrapper.LS\_MAXITER\_MAX)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.nfev\ <=\ 100\ +\ ls\_max\_iter}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00216}00216\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ ret.success}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00218}00218\ \ \ \ \ \textcolor{keyword}{def\ }test\_max\_fun\_no\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00219}00219\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ no\_local\_search=\textcolor{keyword}{True},\ maxfun=500,\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.nfev\ <=\ 500}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ ret.success}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00224}00224\ \ \ \ \ \textcolor{keyword}{def\ }test\_maxiter(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00225}00225\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ maxiter=700,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00227}00227\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.nit\ <=\ 700}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00229}00229\ \ \ \ \ \textcolor{comment}{\#\ Testing\ that\ args\ are\ passed\ correctly\ for\ dual\_annealing}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00230}00230\ \ \ \ \ \textcolor{keyword}{def\ }test\_fun\_args\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args=((3.14159,)),\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00233}00233\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 3.14159,\ atol=1e-\/6)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00235}00235\ \ \ \ \ \textcolor{comment}{\#\ Testing\ that\ args\ are\ passed\ correctly\ for\ pure\ simulated\ annealing}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00236}00236\ \ \ \ \ \textcolor{keyword}{def\ }test\_fun\_args\_no\_ls(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00237}00237\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args=((3.14159,\ )),\ no\_local\_search=\textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 3.14159,\ atol=1e-\/4)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00241}00241\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00242}00242\ \ \ \ \ \textcolor{keyword}{def\ }test\_callback\_stop(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Testing\ that\ callback\ make\ the\ algorithm\ stop\ for}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ fun\ value\ <=\ 1.0\ (see\ callback\ method)}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ callback=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a783f900bc45b8be5eefc97a0a453e057}{callback}},\ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.fun\ <=\ 1.0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00248}00248\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{stringliteral}{'stop\ early'}\ \textcolor{keywordflow}{in}\ ret.message[0]}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ \textcolor{keywordflow}{not}\ ret.success}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00251}00251\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'method,\ atol'},\ [}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00252}00252\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'Nelder-\/Mead'},\ 2e-\/5),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00253}00253\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'COBYLA'},\ 1e-\/5),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00254}00254\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'Powell'},\ 1e-\/8),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00255}00255\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'CG'},\ 1e-\/8),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00256}00256\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'BFGS'},\ 1e-\/8),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00257}00257\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'TNC'},\ 1e-\/8),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00258}00258\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{'SLSQP'},\ 2e-\/7),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00259}00259\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00260}00260\ \ \ \ \ \textcolor{keyword}{def\ }test\_multi\_ls\_minimizer(self,\ method,\ atol):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00261}00261\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=dict(method=method),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00264}00264\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.,\ atol=atol)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00266}00266\ \ \ \ \ \textcolor{keyword}{def\ }test\_wrong\_restart\_temp(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00267}00267\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ restart\_temp\_ratio=1)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00269}00269\ \ \ \ \ \ \ \ \ assert\_raises(ValueError,\ dual\_annealing,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3b9433293bda8ca208f67b10e40b4391}{func}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},\ restart\_temp\_ratio=0)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00271}00271\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00272}00272\ \ \ \ \ \textcolor{keyword}{def\ }test\_gradient\_gnev(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00273}00273\ \ \ \ \ \ \ \ \ minimizer\_opts\ =\ \{}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'jac'}:\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a3bc4893fb3c6fdc26e9b1eaebb623da1}{rosen\_der\_wrapper}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00275}00275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00276}00276\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(rosen,\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_aa863069fd88d71b89aa8344ff0849b6a}{ld\_bounds}},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=minimizer\_opts,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ seed=self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a00b9b21e63df1007c5ff89d84f4a4e8d}{seed}})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00279}00279\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret.njev\ ==\ self.\mbox{\hyperlink{classscipy_1_1optimize_1_1tests_1_1test____dual__annealing_1_1TestDualAnnealing_a0987b53fd475d8212e5d269a438bb540}{ngev}}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00280}00280\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00281}00281\ \ \ \ \ \textcolor{keyword}{def\ }test\_from\_docstring(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00282}00282\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }func(x):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum(x\ *\ x\ -\/\ 10\ *\ np.cos(2\ *\ np.pi\ *\ x))\ +\ 10\ *\ np.size(x)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00284}00284\ \ \ \ \ \ \ \ \ lw\ =\ [-\/5.12]\ *\ 10}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00285}00285\ \ \ \ \ \ \ \ \ up\ =\ [5.12]\ *\ 10}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00286}00286\ \ \ \ \ \ \ \ \ ret\ =\ dual\_annealing(func,\ bounds=list(zip(lw,\ up)),\ seed=1234)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00287}00287\ \ \ \ \ \ \ \ \ assert\_allclose(ret.x,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [-\/4.26437714e-\/09,\ -\/3.91699361e-\/09,\ -\/1.86149218e-\/09,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/3.97165720e-\/09,\ -\/6.29151648e-\/09,\ -\/6.53145322e-\/09,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/3.93616815e-\/09,\ -\/6.55623025e-\/09,\ -\/6.05775280e-\/09,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/5.00668935e-\/09],\ atol=4e-\/8)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00292}00292\ \ \ \ \ \ \ \ \ assert\_allclose(ret.fun,\ 0.000000,\ atol=5e-\/13)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00293}00293\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00294}00294\ \ \ \ \ \textcolor{preprocessor}{@pytest.mark.parametrize}(\textcolor{stringliteral}{'new\_e,\ temp\_step,\ accepted,\ accept\_rate'},\ [}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00295}00295\ \ \ \ \ \ \ \ \ (0,\ 100,\ 1000,\ 1.0097587941791923),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00296}00296\ \ \ \ \ \ \ \ \ (0,\ 2,\ 1000,\ 1.2599210498948732),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00297}00297\ \ \ \ \ \ \ \ \ (10,\ 100,\ 878,\ 0.8786035869128718),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00298}00298\ \ \ \ \ \ \ \ \ (10,\ 60,\ 695,\ 0.6812920690579612),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00299}00299\ \ \ \ \ \ \ \ \ (2,\ 100,\ 990,\ 0.9897404249173424),}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00300}00300\ \ \ \ \ ])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00301}00301\ \ \ \ \ \textcolor{keyword}{def\ }test\_accept\_reject\_probabilistic(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00302}00302\ \ \ \ \ \ \ \ \ \ \ \ \ self,\ new\_e,\ temp\_step,\ accepted,\ accept\_rate):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00303}00303\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Test\ accepts\ unconditionally\ with\ e\ <\ current\_energy\ and}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00304}00304\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ probabilistically\ with\ e\ >\ current\_energy}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00306}00306\ \ \ \ \ \ \ \ \ rs\ =\ check\_random\_state(123)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00307}00307\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00308}00308\ \ \ \ \ \ \ \ \ count\_accepted\ =\ 0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00309}00309\ \ \ \ \ \ \ \ \ iterations\ =\ 1000}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00310}00310\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00311}00311\ \ \ \ \ \ \ \ \ accept\_param\ =\ -\/5}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00312}00312\ \ \ \ \ \ \ \ \ current\_energy\ =\ 1}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00313}00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(iterations):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ energy\_state\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1EnergyState}{EnergyState}}(lower=\textcolor{keywordtype}{None},\ upper=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Set\ energy\ state\ with\ current\_energy,\ any\ location.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ energy\_state.update\_current(current\_energy,\ [0])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00317}00317\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ chain\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__dual__annealing_1_1StrategyChain}{StrategyChain}}(}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ accept\_param,\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None},\ rs,\ energy\_state)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Normally\ this\ is\ set\ in\ run()}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ chain.temperature\_step\ =\ temp\_step}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ if\ update\ is\ accepted.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ chain.accept\_reject(j=1,\ e=new\_e,\ x\_visit=[2])}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ energy\_state.current\_energy\ ==\ new\_e:}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ count\_accepted\ +=\ 1}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00328}00328\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ count\_accepted\ ==\ accepted}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00329}00329\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00330}00330\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ accept\ rate}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ pqv\ =\ 1\ -\/\ (1\ -\/\ accept\_param)\ *\ (new\_e\ -\/\ current\_energy)\ /\ temp\_step}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00332}00332\ \ \ \ \ \ \ \ \ rate\ =\ 0\ \textcolor{keywordflow}{if}\ pqv\ <=\ 0\ \textcolor{keywordflow}{else}\ np.exp(np.log(pqv)\ /\ (1\ -\/\ accept\_param))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00333}00333\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00334}00334\ \ \ \ \ \ \ \ \ assert\_allclose(rate,\ accept\_rate)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00336}00336\ \ \ \ \ \textcolor{keyword}{def\ }test\_bounds\_class(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00337}00337\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ that\ result\ does\ not\ depend\ on\ the\ bounds\ type}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00338}00338\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }func(x):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ f\ =\ np.sum(x\ *\ x\ -\/\ 10\ *\ np.cos(2\ *\ np.pi\ *\ x))\ +\ 10\ *\ np.size(x)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ f}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00341}00341\ \ \ \ \ \ \ \ \ lw\ =\ [-\/5.12]\ *\ 5}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00342}00342\ \ \ \ \ \ \ \ \ up\ =\ [5.12]\ *\ 5}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00344}00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Unbounded\ global\ minimum\ is\ all\ zeros.\ Most\ bounds\ below\ will\ force}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00345}00345\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ a\ DV\ away\ from\ unbounded\ minimum\ and\ be\ active\ at\ solution.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00346}00346\ \ \ \ \ \ \ \ \ up[0]\ =\ -\/2.0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00347}00347\ \ \ \ \ \ \ \ \ up[1]\ =\ -\/1.0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00348}00348\ \ \ \ \ \ \ \ \ lw[3]\ =\ 1.0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00349}00349\ \ \ \ \ \ \ \ \ lw[4]\ =\ 2.0}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00350}00350\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00351}00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ run\ optimizations}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00352}00352\ \ \ \ \ \ \ \ \ bounds\ =\ \mbox{\hyperlink{classscipy_1_1optimize_1_1__constraints_1_1Bounds}{Bounds}}(lw,\ up)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00353}00353\ \ \ \ \ \ \ \ \ ret\_bounds\_class\ =\ dual\_annealing(func,\ bounds=bounds,\ seed=1234)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00354}00354\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00355}00355\ \ \ \ \ \ \ \ \ bounds\_old\ =\ list(zip(lw,\ up))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00356}00356\ \ \ \ \ \ \ \ \ ret\_bounds\_list\ =\ dual\_annealing(func,\ bounds=bounds\_old,\ seed=1234)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00358}00358\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ test\ that\ found\ minima,\ function\ evaluations\ and\ iterations\ match}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00359}00359\ \ \ \ \ \ \ \ \ assert\_allclose(ret\_bounds\_class.x,\ ret\_bounds\_list.x,\ atol=1e-\/8)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00360}00360\ \ \ \ \ \ \ \ \ assert\_allclose(ret\_bounds\_class.x,\ np.arange(-\/2,\ 3),\ atol=1e-\/7)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00361}00361\ \ \ \ \ \ \ \ \ assert\_allclose(ret\_bounds\_list.fun,\ ret\_bounds\_class.fun,\ atol=1e-\/9)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00362}00362\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ ret\_bounds\_list.nfev\ ==\ ret\_bounds\_class.nfev}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00364}00364\ \ \ \ \ \textcolor{keyword}{def\ }test\_callable\_jac\_with\_args\_gh11052(self):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00365}00365\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ dual\_annealing\ used\ to\ fail\ when\ \`{}jac`\ was\ callable\ and\ \`{}args`\ were}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00366}00366\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ used;\ check\ that\ this\ is\ resolved.\ Example\ is\ from\ gh-\/11052.}}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00367}00367\ \ \ \ \ \ \ \ \ rng\ =\ np.random.default\_rng(94253637693657847462)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00368}00368\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }f(x,\ power):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.sum(np.exp(x\ **\ power))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00371}00371\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }jac(x,\ power):}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ np.exp(x\ **\ power)\ *\ power\ *\ x\ **\ (power\ -\/\ 1)}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00373}00373\ }
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00374}00374\ \ \ \ \ \ \ \ \ res1\ =\ dual\_annealing(f,\ args=(2,\ ),\ bounds=[[0,\ 1],\ [0,\ 1]],\ seed=rng,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00375}00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=dict(method=\textcolor{stringliteral}{'L-\/BFGS-\/B'}))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00376}00376\ \ \ \ \ \ \ \ \ res2\ =\ dual\_annealing(f,\ args=(2,\ ),\ bounds=[[0,\ 1],\ [0,\ 1]],\ seed=rng,}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ minimizer\_kwargs=dict(method=\textcolor{stringliteral}{'L-\/BFGS-\/B'},}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jac=jac))}
\DoxyCodeLine{\Hypertarget{test____dual__annealing_8py_source_l00379}00379\ \ \ \ \ \ \ \ \ assert\_allclose(res1.fun,\ res2.fun,\ rtol=1e-\/6)}

\end{DoxyCode}
