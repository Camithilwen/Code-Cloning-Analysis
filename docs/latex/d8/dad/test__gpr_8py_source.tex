\doxysection{test\+\_\+gpr.\+py}
\hypertarget{test__gpr_8py_source}{}\label{test__gpr_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/gaussian\_process/tests/test\_gpr.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/sklearn/gaussian\_process/tests/test\_gpr.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00001}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Testing\ for\ Gaussian\ process\ regression"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00003}00003\ \textcolor{comment}{\#\ Authors:\ The\ scikit-\/learn\ developers}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00004}00004\ \textcolor{comment}{\#\ SPDX-\/License-\/Identifier:\ BSD-\/3-\/Clause}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00006}00006\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00007}00007\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00008}00008\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00010}00010\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00011}00011\ \textcolor{keyword}{import}\ pytest}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00012}00012\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacescipy_1_1optimize}{scipy.optimize}}\ \textcolor{keyword}{import}\ approx\_fprime}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00014}00014\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1exceptions}{sklearn.exceptions}}\ \textcolor{keyword}{import}\ ConvergenceWarning}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00015}00015\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1gaussian__process}{sklearn.gaussian\_process}}\ \textcolor{keyword}{import}\ GaussianProcessRegressor}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00016}00016\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1kernels}{sklearn.gaussian\_process.kernels}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00017}00017\ \ \ \ \ RBF,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00018}00018\ \ \ \ \ DotProduct,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00019}00019\ \ \ \ \ ExpSineSquared,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00020}00020\ \ \ \ \ WhiteKernel,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00021}00021\ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00022}00022\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1kernels}{sklearn.gaussian\_process.kernels}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00023}00023\ \ \ \ \ ConstantKernel\ \textcolor{keyword}{as}\ C,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00024}00024\ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00025}00025\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1__mini__sequence__kernel}{sklearn.gaussian\_process.tests.\_mini\_sequence\_kernel}}\ \textcolor{keyword}{import}\ MiniSeqKernel}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00026}00026\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacesklearn_1_1utils_1_1__testing}{sklearn.utils.\_testing}}\ \textcolor{keyword}{import}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00027}00027\ \ \ \ \ assert\_allclose,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00028}00028\ \ \ \ \ assert\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00029}00029\ \ \ \ \ assert\_array\_almost\_equal,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00030}00030\ \ \ \ \ assert\_array\_less,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00031}00031\ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00034}00034\ \textcolor{keyword}{def\ }f(x):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00035}00035\ \ \ \ \ \textcolor{keywordflow}{return}\ x\ *\ np.sin(x)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00038}00038\ X\ =\ np.atleast\_2d([1.0,\ 3.0,\ 5.0,\ 6.0,\ 7.0,\ 8.0]).T}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00039}00039\ X2\ =\ np.atleast\_2d([2.0,\ 4.0,\ 5.5,\ 6.5,\ 7.5]).T}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00040}00040\ y\ =\ f(X).ravel()}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00042}00042\ fixed\_kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0,\ length\_scale\_bounds=\textcolor{stringliteral}{"{}fixed"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00043}00043\ kernels\ =\ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00044}00044\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00045}00045\ \ \ \ \ fixed\_kernel,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00046}00046\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0,\ length\_scale\_bounds=(1e-\/3,\ 1e3)),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00047}00047\ \ \ \ \ \mbox{\hyperlink{classC}{C}}(1.0,\ (1e-\/2,\ 1e2))\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0,\ length\_scale\_bounds=(1e-\/3,\ 1e3)),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00048}00048\ \ \ \ \ \mbox{\hyperlink{classC}{C}}(1.0,\ (1e-\/2,\ 1e2))\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0,\ length\_scale\_bounds=(1e-\/3,\ 1e3))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00049}00049\ \ \ \ \ +\ \mbox{\hyperlink{classC}{C}}(1e-\/5,\ (1e-\/5,\ 1e2)),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00050}00050\ \ \ \ \ \mbox{\hyperlink{classC}{C}}(0.1,\ (1e-\/2,\ 1e2))\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0,\ length\_scale\_bounds=(1e-\/3,\ 1e3))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00051}00051\ \ \ \ \ +\ \mbox{\hyperlink{classC}{C}}(1e-\/5,\ (1e-\/5,\ 1e2)),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00052}00052\ ]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00053}00053\ non\_fixed\_kernels\ =\ [kernel\ \textcolor{keywordflow}{for}\ kernel\ \textcolor{keywordflow}{in}\ kernels\ \textcolor{keywordflow}{if}\ kernel\ !=\ fixed\_kernel]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00056}00056\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00057}00057\ \textcolor{keyword}{def\ }test\_gpr\_interpolation(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00058}00058\ \ \ \ \ \textcolor{keywordflow}{if}\ sys.maxsize\ <=\ 2**32:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ pytest.xfail(\textcolor{stringliteral}{"{}This\ test\ may\ fail\ on\ 32\ bit\ Python"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00061}00061\ \ \ \ \ \textcolor{comment}{\#\ Test\ the\ interpolating\ property\ for\ different\ kernels.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00062}00062\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00063}00063\ \ \ \ \ y\_pred,\ y\_cov\ =\ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00065}00065\ \ \ \ \ assert\_almost\_equal(y\_pred,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00066}00066\ \ \ \ \ assert\_almost\_equal(np.diag(y\_cov),\ 0.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00069}00069\ \textcolor{keyword}{def\ }test\_gpr\_interpolation\_structured():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00070}00070\ \ \ \ \ \textcolor{comment}{\#\ Test\ the\ interpolating\ property\ for\ different\ kernels.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00071}00071\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1tests_1_1__mini__sequence__kernel_1_1MiniSeqKernel}{MiniSeqKernel}}(baseline\_similarity\_bounds=\textcolor{stringliteral}{"{}fixed"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00072}00072\ \ \ \ \ X\ =\ [\textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}B"{}},\ \textcolor{stringliteral}{"{}C"{}}]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00073}00073\ \ \ \ \ y\ =\ np.array([1,\ 2,\ 3])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00074}00074\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00075}00075\ \ \ \ \ y\_pred,\ y\_cov\ =\ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00077}00077\ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ kernel(X,\ eval\_gradient=\textcolor{keyword}{True})[1].ravel(),\ (1\ -\/\ np.eye(len(X))).ravel()}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00079}00079\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00080}00080\ \ \ \ \ assert\_almost\_equal(y\_pred,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00081}00081\ \ \ \ \ assert\_almost\_equal(np.diag(y\_cov),\ 0.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00083}00083\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00084}00084\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ non\_fixed\_kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00085}00085\ \textcolor{keyword}{def\ }test\_lml\_improving(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00086}00086\ \ \ \ \ \textcolor{keywordflow}{if}\ sys.maxsize\ <=\ 2**32:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ pytest.xfail(\textcolor{stringliteral}{"{}This\ test\ may\ fail\ on\ 32\ bit\ Python"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00089}00089\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ hyperparameter-\/tuning\ improves\ log-\/marginal\ likelihood.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00090}00090\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00091}00091\ \ \ \ \ \textcolor{keyword}{assert}\ gpr.log\_marginal\_likelihood(gpr.kernel\_.theta)\ >\ gpr.log\_marginal\_likelihood(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ kernel.theta}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00093}00093\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00096}00096\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00097}00097\ \textcolor{keyword}{def\ }test\_lml\_precomputed(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00098}00098\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ lml\ of\ optimized\ kernel\ is\ stored\ correctly.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00099}00099\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00100}00100\ \ \ \ \ \textcolor{keyword}{assert}\ gpr.log\_marginal\_likelihood(gpr.kernel\_.theta)\ ==\ pytest.approx(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ gpr.log\_marginal\_likelihood()}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00102}00102\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00105}00105\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00106}00106\ \textcolor{keyword}{def\ }test\_lml\_without\_cloning\_kernel(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00107}00107\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ lml\ of\ optimized\ kernel\ is\ stored\ correctly.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00108}00108\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00109}00109\ \ \ \ \ input\_theta\ =\ np.ones(gpr.kernel\_.theta.shape,\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00111}00111\ \ \ \ \ gpr.log\_marginal\_likelihood(input\_theta,\ clone\_kernel=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00112}00112\ \ \ \ \ assert\_almost\_equal(gpr.kernel\_.theta,\ input\_theta,\ 7)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00113}00113\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00115}00115\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ non\_fixed\_kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00116}00116\ \textcolor{keyword}{def\ }test\_converged\_to\_local\_maximum(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00117}00117\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ we\ are\ in\ local\ maximum\ after\ hyperparameter-\/optimization.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00118}00118\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00120}00120\ \ \ \ \ lml,\ lml\_gradient\ =\ gpr.log\_marginal\_likelihood(gpr.kernel\_.theta,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00121}00121\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00122}00122\ \ \ \ \ \textcolor{keyword}{assert}\ np.all(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ (np.abs(lml\_gradient)\ <\ 1e-\/4)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ |\ (gpr.kernel\_.theta\ ==\ gpr.kernel\_.bounds[:,\ 0])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ |\ (gpr.kernel\_.theta\ ==\ gpr.kernel\_.bounds[:,\ 1])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00126}00126\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00127}00127\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00128}00128\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00129}00129\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ non\_fixed\_kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00130}00130\ \textcolor{keyword}{def\ }test\_solution\_inside\_bounds(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00131}00131\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ hyperparameter-\/optimization\ remains\ in\ bounds\#}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00132}00132\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00134}00134\ \ \ \ \ bounds\ =\ gpr.kernel\_.bounds}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00135}00135\ \ \ \ \ max\_\ =\ np.finfo(gpr.kernel\_.theta.dtype).max}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00136}00136\ \ \ \ \ tiny\ =\ 1e-\/10}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00137}00137\ \ \ \ \ bounds[\string~np.isfinite(bounds[:,\ 1]),\ 1]\ =\ max\_}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00139}00139\ \ \ \ \ assert\_array\_less(bounds[:,\ 0],\ gpr.kernel\_.theta\ +\ tiny)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00140}00140\ \ \ \ \ assert\_array\_less(gpr.kernel\_.theta,\ bounds[:,\ 1]\ +\ tiny)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00143}00143\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00144}00144\ \textcolor{keyword}{def\ }test\_lml\_gradient(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00145}00145\ \ \ \ \ \textcolor{comment}{\#\ Compare\ analytic\ and\ numeric\ gradient\ of\ log\ marginal\ likelihood.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00146}00146\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00147}00147\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00148}00148\ \ \ \ \ lml,\ lml\_gradient\ =\ gpr.log\_marginal\_likelihood(kernel.theta,\ \textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00149}00149\ \ \ \ \ lml\_gradient\_approx\ =\ approx\_fprime(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00150}00150\ \ \ \ \ \ \ \ \ kernel.theta,\ \textcolor{keyword}{lambda}\ theta:\ gpr.log\_marginal\_likelihood(theta,\ \textcolor{keyword}{False}),\ 1e-\/10}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00151}00151\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00153}00153\ \ \ \ \ assert\_almost\_equal(lml\_gradient,\ lml\_gradient\_approx,\ 3)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00155}00155\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00156}00156\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00157}00157\ \textcolor{keyword}{def\ }test\_prior(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00158}00158\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ GP\ prior\ has\ mean\ 0\ and\ identical\ variances.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00159}00159\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00160}00160\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00161}00161\ \ \ \ \ y\_mean,\ y\_cov\ =\ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00163}00163\ \ \ \ \ assert\_almost\_equal(y\_mean,\ 0,\ 5)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00164}00164\ \ \ \ \ \textcolor{keywordflow}{if}\ len(gpr.kernel.theta)\ >\ 1:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ XXX:\ quite\ hacky,\ works\ only\ for\ current\ kernels}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00166}00166\ \ \ \ \ \ \ \ \ assert\_almost\_equal(np.diag(y\_cov),\ np.exp(kernel.theta[0]),\ 5)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00167}00167\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00168}00168\ \ \ \ \ \ \ \ \ assert\_almost\_equal(np.diag(y\_cov),\ 1,\ 5)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00171}00171\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00172}00172\ \textcolor{keyword}{def\ }test\_sample\_statistics(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00173}00173\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ statistics\ of\ samples\ drawn\ from\ GP\ are\ correct.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00174}00174\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00176}00176\ \ \ \ \ y\_mean,\ y\_cov\ =\ gpr.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00178}00178\ \ \ \ \ samples\ =\ gpr.sample\_y(X2,\ 300000)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00180}00180\ \ \ \ \ \textcolor{comment}{\#\ More\ digits\ accuracy\ would\ require\ many\ more\ samples}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00181}00181\ \ \ \ \ assert\_almost\_equal(y\_mean,\ np.mean(samples,\ 1),\ 1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00182}00182\ \ \ \ \ assert\_almost\_equal(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00183}00183\ \ \ \ \ \ \ \ \ np.diag(y\_cov)\ /\ np.diag(y\_cov).max(),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00184}00184\ \ \ \ \ \ \ \ \ np.var(samples,\ 1)\ /\ np.diag(y\_cov).max(),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00186}00186\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00189}00189\ \textcolor{keyword}{def\ }test\_no\_optimizer():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00190}00190\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ kernel\ parameters\ are\ unmodified\ when\ optimizer\ is\ None.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00191}00191\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(1.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00192}00192\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ optimizer=\textcolor{keywordtype}{None}).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00193}00193\ \ \ \ \ \textcolor{keyword}{assert}\ np.exp(gpr.kernel\_.theta)\ ==\ 1.0}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00194}00194\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00195}00195\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00196}00196\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00197}00197\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}target"{},\ [y,\ np.ones(X.shape[0],\ dtype=np.float64)}])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00198}00198\ \textcolor{keyword}{def\ }test\_predict\_cov\_vs\_std(kernel,\ target):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00199}00199\ \ \ \ \ \textcolor{keywordflow}{if}\ sys.maxsize\ <=\ 2**32:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00200}00200\ \ \ \ \ \ \ \ \ pytest.xfail(\textcolor{stringliteral}{"{}This\ test\ may\ fail\ on\ 32\ bit\ Python"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00202}00202\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ predicted\ std.-\/dev.\ is\ consistent\ with\ cov's\ diagonal.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00203}00203\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00204}00204\ \ \ \ \ y\_mean,\ y\_cov\ =\ gpr.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00205}00205\ \ \ \ \ y\_mean,\ y\_std\ =\ gpr.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00206}00206\ \ \ \ \ assert\_almost\_equal(np.sqrt(np.diag(y\_cov)),\ y\_std)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00209}00209\ \textcolor{keyword}{def\ }test\_anisotropic\_kernel():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00210}00210\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ GPR\ can\ identify\ meaningful\ anisotropic\ length-\/scales.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00211}00211\ \ \ \ \ \textcolor{comment}{\#\ We\ learn\ a\ function\ which\ varies\ in\ one\ dimension\ ten-\/times\ slower}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00212}00212\ \ \ \ \ \textcolor{comment}{\#\ than\ in\ the\ other.\ The\ corresponding\ length-\/scales\ should\ differ\ by\ at}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00213}00213\ \ \ \ \ \textcolor{comment}{\#\ least\ a\ factor\ 5}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00214}00214\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00215}00215\ \ \ \ \ X\ =\ rng.uniform(-\/1,\ 1,\ (50,\ 2))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00216}00216\ \ \ \ \ y\ =\ X[:,\ 0]\ +\ 0.1\ *\ X[:,\ 1]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00218}00218\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}([1.0,\ 1.0])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00219}00219\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00220}00220\ \ \ \ \ \textcolor{keyword}{assert}\ np.exp(gpr.kernel\_.theta[1])\ >\ np.exp(gpr.kernel\_.theta[0])\ *\ 5}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00223}00223\ \textcolor{keyword}{def\ }test\_random\_starts():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00224}00224\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ an\ increasing\ number\ of\ random-\/starts\ of\ GP\ fitting\ only}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00225}00225\ \ \ \ \ \textcolor{comment}{\#\ increases\ the\ log\ marginal\ likelihood\ of\ the\ chosen\ theta.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00226}00226\ \ \ \ \ n\_samples,\ n\_features\ =\ 25,\ 2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00227}00227\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00228}00228\ \ \ \ \ X\ =\ rng.randn(n\_samples,\ n\_features)\ *\ 2\ -\/\ 1}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00229}00229\ \ \ \ \ y\ =\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00230}00230\ \ \ \ \ \ \ \ \ np.sin(X).sum(axis=1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00231}00231\ \ \ \ \ \ \ \ \ +\ np.sin(3\ *\ X).sum(axis=1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00232}00232\ \ \ \ \ \ \ \ \ +\ rng.normal(scale=0.1,\ size=n\_samples)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00233}00233\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00235}00235\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classC}{C}}(1.0,\ (1e-\/2,\ 1e2))\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00236}00236\ \ \ \ \ \ \ \ \ length\_scale=[1.0]\ *\ n\_features,\ length\_scale\_bounds=[(1e-\/4,\ 1e2)]\ *\ n\_features}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00237}00237\ \ \ \ \ )\ +\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1WhiteKernel}{WhiteKernel}}(noise\_level=1e-\/5,\ noise\_level\_bounds=(1e-\/5,\ 1e1))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00238}00238\ \ \ \ \ last\_lml\ =\ -\/np.inf}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00239}00239\ \ \ \ \ \textcolor{keywordflow}{for}\ n\_restarts\_optimizer\ \textcolor{keywordflow}{in}\ range(5):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00240}00240\ \ \ \ \ \ \ \ \ gp\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ kernel=kernel,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ n\_restarts\_optimizer=n\_restarts\_optimizer,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ random\_state=0,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00244}00244\ \ \ \ \ \ \ \ \ ).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00245}00245\ \ \ \ \ \ \ \ \ lml\ =\ gp.log\_marginal\_likelihood(gp.kernel\_.theta)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00246}00246\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ lml\ >\ last\_lml\ -\/\ np.finfo(np.float32).eps}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00247}00247\ \ \ \ \ \ \ \ \ last\_lml\ =\ lml}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00249}00249\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00250}00250\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00251}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9be9f9fe6e4a869cb320a3913f3c0d0c}{00251}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9be9f9fe6e4a869cb320a3913f3c0d0c}{test\_y\_normalization}}(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00252}00252\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00253}00253\ \textcolor{stringliteral}{\ \ \ \ Test\ normalization\ of\ the\ target\ values\ in\ GP}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00254}00254\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00255}00255\ \textcolor{stringliteral}{\ \ \ \ Fitting\ non-\/normalizing\ GP\ on\ normalized\ y\ and\ fitting\ normalizing\ GP}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00256}00256\ \textcolor{stringliteral}{\ \ \ \ on\ unnormalized\ y\ should\ yield\ identical\ results.\ Note\ that,\ here,}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00257}00257\ \textcolor{stringliteral}{\ \ \ \ 'normalized\ y'\ refers\ to\ y\ that\ has\ been\ made\ zero\ mean\ and\ unit}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00258}00258\ \textcolor{stringliteral}{\ \ \ \ variance.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00259}00259\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00260}00260\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00262}00262\ \ \ \ \ y\_mean\ =\ np.mean(y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00263}00263\ \ \ \ \ y\_std\ =\ np.std(y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00264}00264\ \ \ \ \ y\_norm\ =\ (y\ -\/\ y\_mean)\ /\ y\_std}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00266}00266\ \ \ \ \ \textcolor{comment}{\#\ Fit\ non-\/normalizing\ GP\ on\ normalized\ y}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00267}00267\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00268}00268\ \ \ \ \ gpr.fit(X,\ y\_norm)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00269}00269\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00270}00270\ \ \ \ \ \textcolor{comment}{\#\ Fit\ normalizing\ GP\ on\ unnormalized\ y}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00271}00271\ \ \ \ \ gpr\_norm\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ normalize\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00272}00272\ \ \ \ \ gpr\_norm.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00274}00274\ \ \ \ \ \textcolor{comment}{\#\ Compare\ predicted\ mean,\ std-\/devs\ and\ covariances}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00275}00275\ \ \ \ \ y\_pred,\ y\_pred\_std\ =\ gpr.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00276}00276\ \ \ \ \ y\_pred\ =\ y\_pred\ *\ y\_std\ +\ y\_mean}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00277}00277\ \ \ \ \ y\_pred\_std\ =\ y\_pred\_std\ *\ y\_std}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00278}00278\ \ \ \ \ y\_pred\_norm,\ y\_pred\_std\_norm\ =\ gpr\_norm.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00280}00280\ \ \ \ \ assert\_almost\_equal(y\_pred,\ y\_pred\_norm)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00281}00281\ \ \ \ \ assert\_almost\_equal(y\_pred\_std,\ y\_pred\_std\_norm)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00282}00282\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00283}00283\ \ \ \ \ \_,\ y\_cov\ =\ gpr.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00284}00284\ \ \ \ \ y\_cov\ =\ y\_cov\ *\ y\_std**2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00285}00285\ \ \ \ \ \_,\ y\_cov\_norm\ =\ gpr\_norm.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00287}00287\ \ \ \ \ assert\_almost\_equal(y\_cov,\ y\_cov\_norm)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00288}00288\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00290}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ab4681addac50a3dd9331ed8a9da67d95}{00290}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ab4681addac50a3dd9331ed8a9da67d95}{test\_large\_variance\_y}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00291}00291\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00292}00292\ \textcolor{stringliteral}{\ \ \ \ Here\ we\ test\ that,\ when\ noramlize\_y=True,\ our\ GP\ can\ produce\ a}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00293}00293\ \textcolor{stringliteral}{\ \ \ \ sensible\ fit\ to\ training\ data\ whose\ variance\ is\ significantly}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00294}00294\ \textcolor{stringliteral}{\ \ \ \ larger\ than\ unity.\ This\ test\ was\ made\ in\ response\ to\ issue\ \#15612.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00295}00295\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00296}00296\ \textcolor{stringliteral}{\ \ \ \ GP\ predictions\ are\ verified\ against\ predictions\ that\ were\ made}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00297}00297\ \textcolor{stringliteral}{\ \ \ \ using\ GPy\ which,\ here,\ is\ treated\ as\ the\ 'gold\ standard'.\ Note\ that\ we}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00298}00298\ \textcolor{stringliteral}{\ \ \ \ only\ investigate\ the\ RBF\ kernel\ here,\ as\ that\ is\ what\ was\ used\ in\ the}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00299}00299\ \textcolor{stringliteral}{\ \ \ \ GPy\ implementation.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00300}00300\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00301}00301\ \textcolor{stringliteral}{\ \ \ \ The\ following\ code\ can\ be\ used\ to\ recreate\ the\ GPy\ data:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00302}00302\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00303}00303\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00304}00304\ \textcolor{stringliteral}{\ \ \ \ import\ GPy}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00305}00305\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00306}00306\ \textcolor{stringliteral}{\ \ \ \ kernel\_gpy\ =\ GPy.kern.RBF(input\_dim=1,\ lengthscale=1.)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00307}00307\ \textcolor{stringliteral}{\ \ \ \ gpy\ =\ GPy.models.GPRegression(X,\ np.vstack(y\_large),\ kernel\_gpy)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00308}00308\ \textcolor{stringliteral}{\ \ \ \ gpy.optimize()}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00309}00309\ \textcolor{stringliteral}{\ \ \ \ y\_pred\_gpy,\ y\_var\_gpy\ =\ gpy.predict(X2)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00310}00310\ \textcolor{stringliteral}{\ \ \ \ y\_pred\_std\_gpy\ =\ np.sqrt(y\_var\_gpy)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00311}00311\ \textcolor{stringliteral}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00312}00312\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00314}00314\ \ \ \ \ \textcolor{comment}{\#\ Here\ we\ utilise\ a\ larger\ variance\ version\ of\ the\ training\ data}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00315}00315\ \ \ \ \ y\_large\ =\ 10\ *\ y}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00316}00316\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00317}00317\ \ \ \ \ \textcolor{comment}{\#\ Standard\ GP\ with\ normalize\_y=True}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00318}00318\ \ \ \ \ RBF\_params\ =\ \{\textcolor{stringliteral}{"{}length\_scale"{}}:\ 1.0\}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00319}00319\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(**RBF\_params)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00320}00320\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ normalize\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00321}00321\ \ \ \ \ gpr.fit(X,\ y\_large)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00322}00322\ \ \ \ \ y\_pred,\ y\_pred\_std\ =\ gpr.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00323}00323\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00324}00324\ \ \ \ \ \textcolor{comment}{\#\ 'Gold\ standard'\ mean\ predictions\ from\ GPy}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00325}00325\ \ \ \ \ y\_pred\_gpy\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00326}00326\ \ \ \ \ \ \ \ \ [15.16918303,\ -\/27.98707845,\ -\/39.31636019,\ 14.52605515,\ 69.18503589]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00327}00327\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00328}00328\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00329}00329\ \ \ \ \ \textcolor{comment}{\#\ 'Gold\ standard'\ std\ predictions\ from\ GPy}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00330}00330\ \ \ \ \ y\_pred\_std\_gpy\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00331}00331\ \ \ \ \ \ \ \ \ [7.78860962,\ 3.83179178,\ 0.63149951,\ 0.52745188,\ 0.86170042]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00332}00332\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00333}00333\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00334}00334\ \ \ \ \ \textcolor{comment}{\#\ Based\ on\ numerical\ experiments,\ it's\ reasonable\ to\ expect\ our}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00335}00335\ \ \ \ \ \textcolor{comment}{\#\ GP's\ mean\ predictions\ to\ get\ within\ 7\%\ of\ predictions\ of\ those}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00336}00336\ \ \ \ \ \textcolor{comment}{\#\ made\ by\ GPy.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00337}00337\ \ \ \ \ assert\_allclose(y\_pred,\ y\_pred\_gpy,\ rtol=0.07,\ atol=0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00338}00338\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00339}00339\ \ \ \ \ \textcolor{comment}{\#\ Based\ on\ numerical\ experiments,\ it's\ reasonable\ to\ expect\ our}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00340}00340\ \ \ \ \ \textcolor{comment}{\#\ GP's\ std\ predictions\ to\ get\ within\ 15\%\ of\ predictions\ of\ those}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00341}00341\ \ \ \ \ \textcolor{comment}{\#\ made\ by\ GPy.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00342}00342\ \ \ \ \ assert\_allclose(y\_pred\_std,\ y\_pred\_std\_gpy,\ rtol=0.15,\ atol=0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00343}00343\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00344}00344\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00345}00345\ \textcolor{keyword}{def\ }test\_y\_multioutput():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00346}00346\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ GPR\ can\ deal\ with\ multi-\/dimensional\ target\ values}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00347}00347\ \ \ \ \ y\_2d\ =\ np.vstack((y,\ y\ *\ 2)).T}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00348}00348\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00349}00349\ \ \ \ \ \textcolor{comment}{\#\ Test\ for\ fixed\ kernel\ that\ first\ dimension\ of\ 2d\ GP\ equals\ the\ output}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00350}00350\ \ \ \ \ \textcolor{comment}{\#\ of\ 1d\ GP\ and\ that\ second\ dimension\ is\ twice\ as\ large}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00351}00351\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=1.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00352}00352\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00353}00353\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ optimizer=\textcolor{keywordtype}{None},\ normalize\_y=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00354}00354\ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00355}00355\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00356}00356\ \ \ \ \ gpr\_2d\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ optimizer=\textcolor{keywordtype}{None},\ normalize\_y=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00357}00357\ \ \ \ \ gpr\_2d.fit(X,\ y\_2d)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00358}00358\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00359}00359\ \ \ \ \ y\_pred\_1d,\ y\_std\_1d\ =\ gpr.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00360}00360\ \ \ \ \ y\_pred\_2d,\ y\_std\_2d\ =\ gpr\_2d.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00361}00361\ \ \ \ \ \_,\ y\_cov\_1d\ =\ gpr.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00362}00362\ \ \ \ \ \_,\ y\_cov\_2d\ =\ gpr\_2d.predict(X2,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00364}00364\ \ \ \ \ assert\_almost\_equal(y\_pred\_1d,\ y\_pred\_2d[:,\ 0])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00365}00365\ \ \ \ \ assert\_almost\_equal(y\_pred\_1d,\ y\_pred\_2d[:,\ 1]\ /\ 2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00367}00367\ \ \ \ \ \textcolor{comment}{\#\ Standard\ deviation\ and\ covariance\ do\ not\ depend\ on\ output}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00368}00368\ \ \ \ \ \textcolor{keywordflow}{for}\ target\ \textcolor{keywordflow}{in}\ range(y\_2d.shape[1]):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00369}00369\ \ \ \ \ \ \ \ \ assert\_almost\_equal(y\_std\_1d,\ y\_std\_2d[...,\ target])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00370}00370\ \ \ \ \ \ \ \ \ assert\_almost\_equal(y\_cov\_1d,\ y\_cov\_2d[...,\ target])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00372}00372\ \ \ \ \ y\_sample\_1d\ =\ gpr.sample\_y(X2,\ n\_samples=10)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00373}00373\ \ \ \ \ y\_sample\_2d\ =\ gpr\_2d.sample\_y(X2,\ n\_samples=10)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00374}00374\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00375}00375\ \ \ \ \ \textcolor{keyword}{assert}\ y\_sample\_1d.shape\ ==\ (5,\ 10)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00376}00376\ \ \ \ \ \textcolor{keyword}{assert}\ y\_sample\_2d.shape\ ==\ (5,\ 2,\ 10)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00377}00377\ \ \ \ \ \textcolor{comment}{\#\ Only\ the\ first\ target\ will\ be\ equal}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00378}00378\ \ \ \ \ assert\_almost\_equal(y\_sample\_1d,\ y\_sample\_2d[:,\ 0,\ :])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00379}00379\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00380}00380\ \ \ \ \ \textcolor{comment}{\#\ Test\ hyperparameter\ optimization}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00381}00381\ \ \ \ \ \textcolor{keywordflow}{for}\ kernel\ \textcolor{keywordflow}{in}\ kernels:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00382}00382\ \ \ \ \ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ normalize\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00383}00383\ \ \ \ \ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00384}00384\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00385}00385\ \ \ \ \ \ \ \ \ gpr\_2d\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ normalize\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00386}00386\ \ \ \ \ \ \ \ \ gpr\_2d.fit(X,\ np.vstack((y,\ y)).T)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00388}00388\ \ \ \ \ \ \ \ \ assert\_almost\_equal(gpr.kernel\_.theta,\ gpr\_2d.kernel\_.theta,\ 4)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00389}00389\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00390}00390\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00391}00391\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ non\_fixed\_kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00392}00392\ \textcolor{keyword}{def\ }test\_custom\_optimizer(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00393}00393\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ GPR\ can\ use\ externally\ defined\ optimizers.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00394}00394\ \ \ \ \ \textcolor{comment}{\#\ Define\ a\ dummy\ optimizer\ that\ simply\ tests\ 50\ random\ hyperparameters}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00395}00395\ \ \ \ \ \textcolor{keyword}{def\ }optimizer(obj\_func,\ initial\_theta,\ bounds):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00396}00396\ \ \ \ \ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00397}00397\ \ \ \ \ \ \ \ \ theta\_opt,\ func\_min\ =\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00398}00398\ \ \ \ \ \ \ \ \ \ \ \ \ initial\_theta,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00399}00399\ \ \ \ \ \ \ \ \ \ \ \ \ obj\_func(initial\_theta,\ eval\_gradient=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00400}00400\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00401}00401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(50):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00402}00402\ \ \ \ \ \ \ \ \ \ \ \ \ theta\ =\ np.atleast\_1d(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00403}00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rng.uniform(np.maximum(-\/2,\ bounds[:,\ 0]),\ np.minimum(1,\ bounds[:,\ 1]))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ f\ =\ obj\_func(theta,\ eval\_gradient=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00406}00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ f\ <\ func\_min:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ theta\_opt,\ func\_min\ =\ theta,\ f}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ theta\_opt,\ func\_min}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00409}00409\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00410}00410\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ optimizer=optimizer)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00411}00411\ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00412}00412\ \ \ \ \ \textcolor{comment}{\#\ Checks\ that\ optimizer\ improved\ marginal\ likelihood}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00413}00413\ \ \ \ \ \textcolor{keyword}{assert}\ gpr.log\_marginal\_likelihood(gpr.kernel\_.theta)\ >\ gpr.log\_marginal\_likelihood(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00414}00414\ \ \ \ \ \ \ \ \ gpr.kernel.theta}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00415}00415\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00416}00416\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00417}00417\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00418}00418\ \textcolor{keyword}{def\ }test\_gpr\_correct\_error\_message():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00419}00419\ \ \ \ \ X\ =\ np.arange(12).reshape(6,\ -\/1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00420}00420\ \ \ \ \ y\ =\ np.ones(6)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00421}00421\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1DotProduct}{DotProduct}}()}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00422}00422\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ alpha=0.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00423}00423\ \ \ \ \ message\ =\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00424}00424\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ kernel,\ \%s,\ is\ not\ returning\ a\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00425}00425\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}positive\ definite\ matrix.\ Try\ gradually\ increasing\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ 'alpha'\ parameter\ of\ your\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00427}00427\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}GaussianProcessRegressor\ estimator."{}}\ \%\ kernel}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00428}00428\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00429}00429\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(\mbox{\hyperlink{classnp_1_1linalg_1_1LinAlgError}{np.linalg.LinAlgError}},\ match=re.escape(message)):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00430}00430\ \ \ \ \ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00431}00431\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00432}00432\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00433}00433\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00434}00434\ \textcolor{keyword}{def\ }test\_duplicate\_input(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00435}00435\ \ \ \ \ \textcolor{comment}{\#\ Test\ GPR\ can\ handle\ two\ different\ output-\/values\ for\ the\ same\ input.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00436}00436\ \ \ \ \ gpr\_equal\_inputs\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ alpha=1e-\/2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00437}00437\ \ \ \ \ gpr\_similar\_inputs\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ alpha=1e-\/2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00439}00439\ \ \ \ \ X\_\ =\ np.vstack((X,\ X[0]))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00440}00440\ \ \ \ \ y\_\ =\ np.hstack((y,\ y[0]\ +\ 1))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00441}00441\ \ \ \ \ gpr\_equal\_inputs.fit(X\_,\ y\_)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00442}00442\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00443}00443\ \ \ \ \ X\_\ =\ np.vstack((X,\ X[0]\ +\ 1e-\/15))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00444}00444\ \ \ \ \ y\_\ =\ np.hstack((y,\ y[0]\ +\ 1))}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00445}00445\ \ \ \ \ gpr\_similar\_inputs.fit(X\_,\ y\_)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00446}00446\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00447}00447\ \ \ \ \ X\_test\ =\ np.linspace(0,\ 10,\ 100)[:,\ \textcolor{keywordtype}{None}]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00448}00448\ \ \ \ \ y\_pred\_equal,\ y\_std\_equal\ =\ gpr\_equal\_inputs.predict(X\_test,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00449}00449\ \ \ \ \ y\_pred\_similar,\ y\_std\_similar\ =\ gpr\_similar\_inputs.predict(X\_test,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00450}00450\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00451}00451\ \ \ \ \ assert\_almost\_equal(y\_pred\_equal,\ y\_pred\_similar)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00452}00452\ \ \ \ \ assert\_almost\_equal(y\_std\_equal,\ y\_std\_similar)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00453}00453\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00454}00454\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00455}00455\ \textcolor{keyword}{def\ }test\_no\_fit\_default\_predict():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00456}00456\ \ \ \ \ \textcolor{comment}{\#\ Test\ that\ GPR\ predictions\ without\ fit\ does\ not\ break\ by\ default.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00457}00457\ \ \ \ \ default\_kernel\ =\ \mbox{\hyperlink{classC}{C}}(1.0,\ constant\_value\_bounds=\textcolor{stringliteral}{"{}fixed"{}})\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00458}00458\ \ \ \ \ \ \ \ \ 1.0,\ length\_scale\_bounds=\textcolor{stringliteral}{"{}fixed"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00459}00459\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00460}00460\ \ \ \ \ gpr1\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}()}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00461}00461\ \ \ \ \ \_,\ y\_std1\ =\ gpr1.predict(X,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00462}00462\ \ \ \ \ \_,\ y\_cov1\ =\ gpr1.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00463}00463\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00464}00464\ \ \ \ \ gpr2\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=default\_kernel)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00465}00465\ \ \ \ \ \_,\ y\_std2\ =\ gpr2.predict(X,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00466}00466\ \ \ \ \ \_,\ y\_cov2\ =\ gpr2.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00467}00467\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00468}00468\ \ \ \ \ assert\_array\_almost\_equal(y\_std1,\ y\_std2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00469}00469\ \ \ \ \ assert\_array\_almost\_equal(y\_cov1,\ y\_cov2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00470}00470\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00471}00471\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00472}00472\ \textcolor{keyword}{def\ }test\_warning\_bounds():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00473}00473\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale\_bounds=[1e-\/5,\ 1e-\/3])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00474}00474\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00475}00475\ \ \ \ \ warning\_message\ =\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00476}00476\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ optimal\ value\ found\ for\ dimension\ 0\ of\ parameter\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00477}00477\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}length\_scale\ is\ close\ to\ the\ specified\ upper\ bound\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00478}00478\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}0.001.\ Increasing\ the\ bound\ and\ calling\ fit\ again\ may\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00479}00479\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}find\ a\ better\ value."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00480}00480\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00481}00481\ \ \ \ \ \textcolor{keyword}{with}\ pytest.warns(ConvergenceWarning,\ match=warning\_message):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00482}00482\ \ \ \ \ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00483}00483\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00484}00484\ \ \ \ \ kernel\_sum\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1WhiteKernel}{WhiteKernel}}(noise\_level\_bounds=[1e-\/5,\ 1e-\/3])\ +\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00485}00485\ \ \ \ \ \ \ \ \ length\_scale\_bounds=[1e3,\ 1e5]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00486}00486\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00487}00487\ \ \ \ \ gpr\_sum\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel\_sum)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00488}00488\ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ record:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00489}00489\ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00490}00490\ \ \ \ \ \ \ \ \ gpr\_sum.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00491}00491\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00492}00492\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ len(record)\ ==\ 2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00493}00493\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00494}00494\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ issubclass(record[0].category,\ ConvergenceWarning)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00495}00495\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00496}00496\ \ \ \ \ \ \ \ \ \ \ \ \ record[0].message.args[0]\ ==\ \textcolor{stringliteral}{"{}The\ optimal\ value\ found\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00497}00497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}dimension\ 0\ of\ parameter\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00498}00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}k1\_\_noise\_level\ is\ close\ to\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00499}00499\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specified\ upper\ bound\ 0.001.\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00500}00500\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Increasing\ the\ bound\ and\ calling\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00501}00501\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}fit\ again\ may\ find\ a\ better\ value."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00502}00502\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00503}00503\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00504}00504\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ issubclass(record[1].category,\ ConvergenceWarning)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00505}00505\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00506}00506\ \ \ \ \ \ \ \ \ \ \ \ \ record[1].message.args[0]\ ==\ \textcolor{stringliteral}{"{}The\ optimal\ value\ found\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00507}00507\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}dimension\ 0\ of\ parameter\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00508}00508\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}k2\_\_length\_scale\ is\ close\ to\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specified\ lower\ bound\ 1000.0.\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00510}00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Decreasing\ the\ bound\ and\ calling\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00511}00511\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}fit\ again\ may\ find\ a\ better\ value."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00512}00512\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00513}00513\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00514}00514\ \ \ \ \ X\_tile\ =\ np.tile(X,\ 2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00515}00515\ \ \ \ \ kernel\_dims\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=[1.0,\ 2.0],\ length\_scale\_bounds=[1e1,\ 1e2])}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00516}00516\ \ \ \ \ gpr\_dims\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel\_dims)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00517}00517\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00518}00518\ \ \ \ \ \textcolor{keyword}{with}\ warnings.catch\_warnings(record=\textcolor{keyword}{True})\ \textcolor{keyword}{as}\ record:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00519}00519\ \ \ \ \ \ \ \ \ warnings.simplefilter(\textcolor{stringliteral}{"{}always"{}})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00520}00520\ \ \ \ \ \ \ \ \ gpr\_dims.fit(X\_tile,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00521}00521\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00522}00522\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ len(record)\ ==\ 2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00523}00523\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00524}00524\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ issubclass(record[0].category,\ ConvergenceWarning)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00525}00525\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00526}00526\ \ \ \ \ \ \ \ \ \ \ \ \ record[0].message.args[0]\ ==\ \textcolor{stringliteral}{"{}The\ optimal\ value\ found\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00527}00527\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}dimension\ 0\ of\ parameter\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00528}00528\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}length\_scale\ is\ close\ to\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00529}00529\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specified\ lower\ bound\ 10.0.\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00530}00530\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Decreasing\ the\ bound\ and\ calling\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00531}00531\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}fit\ again\ may\ find\ a\ better\ value."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00532}00532\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00533}00533\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00534}00534\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ issubclass(record[1].category,\ ConvergenceWarning)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00535}00535\ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00536}00536\ \ \ \ \ \ \ \ \ \ \ \ \ record[1].message.args[0]\ ==\ \textcolor{stringliteral}{"{}The\ optimal\ value\ found\ for\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00537}00537\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}dimension\ 1\ of\ parameter\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00538}00538\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}length\_scale\ is\ close\ to\ the\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00539}00539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specified\ lower\ bound\ 10.0.\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Decreasing\ the\ bound\ and\ calling\ "{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}fit\ again\ may\ find\ a\ better\ value."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00542}00542\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00544}00544\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00545}00545\ \textcolor{keyword}{def\ }test\_bound\_check\_fixed\_hyperparameter():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00546}00546\ \ \ \ \ \textcolor{comment}{\#\ Regression\ test\ for\ issue\ \#17943}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00547}00547\ \ \ \ \ \textcolor{comment}{\#\ Check\ that\ having\ a\ hyperparameter\ with\ fixed\ bounds\ doesn't\ cause\ an}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00548}00548\ \ \ \ \ \textcolor{comment}{\#\ error}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00549}00549\ \ \ \ \ k1\ =\ 50.0**2\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(length\_scale=50.0)\ \ \textcolor{comment}{\#\ long\ term\ smooth\ rising\ trend}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00550}00550\ \ \ \ \ k2\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1ExpSineSquared}{ExpSineSquared}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00551}00551\ \ \ \ \ \ \ \ \ length\_scale=1.0,\ periodicity=1.0,\ periodicity\_bounds=\textcolor{stringliteral}{"{}fixed"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00552}00552\ \ \ \ \ )\ \ \textcolor{comment}{\#\ seasonal\ component}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00553}00553\ \ \ \ \ kernel\ =\ k1\ +\ k2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00554}00554\ \ \ \ \ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00555}00555\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00556}00556\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00557}00557\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}kernel"{},\ kernels)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00558}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ad3cb3dfc90509ff667bb8b5c4e1eaf22}{00558}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ad3cb3dfc90509ff667bb8b5c4e1eaf22}{test\_constant\_target}}(kernel):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00559}00559\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ the\ std.\ dev.\ is\ affected\ to\ 1\ when\ normalizing\ a\ constant}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00560}00560\ \textcolor{stringliteral}{\ \ \ \ feature.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00561}00561\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00562}00562\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/18318}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00563}00563\ \textcolor{stringliteral}{\ \ \ \ NaN\ where\ affected\ to\ the\ target\ when\ scaling\ due\ to\ null\ std.\ dev.\ with}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00564}00564\ \textcolor{stringliteral}{\ \ \ \ constant\ target.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00565}00565\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00566}00566\ \ \ \ \ y\_constant\ =\ np.ones(X.shape[0],\ dtype=np.float64)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00567}00567\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00568}00568\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ normalize\_y=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00569}00569\ \ \ \ \ gpr.fit(X,\ y\_constant)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00570}00570\ \ \ \ \ \textcolor{keyword}{assert}\ gpr.\_y\_train\_std\ ==\ pytest.approx(1.0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00571}00571\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00572}00572\ \ \ \ \ y\_pred,\ y\_cov\ =\ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00573}00573\ \ \ \ \ assert\_allclose(y\_pred,\ y\_constant)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00574}00574\ \ \ \ \ \textcolor{comment}{\#\ set\ atol\ because\ we\ compare\ to\ zero}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00575}00575\ \ \ \ \ assert\_allclose(np.diag(y\_cov),\ 0.0,\ atol=1e-\/9)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00576}00576\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00577}00577\ \ \ \ \ \textcolor{comment}{\#\ Test\ multi-\/target\ data}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00578}00578\ \ \ \ \ n\_samples,\ n\_targets\ =\ X.shape[0],\ 2}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00579}00579\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00580}00580\ \ \ \ \ y\ =\ np.concatenate(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00581}00581\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00582}00582\ \ \ \ \ \ \ \ \ \ \ \ \ rng.normal(size=(n\_samples,\ 1)),\ \ \textcolor{comment}{\#\ non-\/constant\ target}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00583}00583\ \ \ \ \ \ \ \ \ \ \ \ \ np.full(shape=(n\_samples,\ 1),\ fill\_value=2),\ \ \textcolor{comment}{\#\ constant\ target}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00584}00584\ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00585}00585\ \ \ \ \ \ \ \ \ axis=1,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00586}00586\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00587}00587\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00588}00588\ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00589}00589\ \ \ \ \ Y\_pred,\ Y\_cov\ =\ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00590}00590\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00591}00591\ \ \ \ \ assert\_allclose(Y\_pred[:,\ 1],\ 2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00592}00592\ \ \ \ \ assert\_allclose(np.diag(Y\_cov[...,\ 1]),\ 0.0,\ atol=1e-\/9)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00593}00593\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00594}00594\ \ \ \ \ \textcolor{keyword}{assert}\ Y\_pred.shape\ ==\ (n\_samples,\ n\_targets)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00595}00595\ \ \ \ \ \textcolor{keyword}{assert}\ Y\_cov.shape\ ==\ (n\_samples,\ n\_samples,\ n\_targets)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00596}00596\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00597}00597\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00598}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9782fe89777b5ec032262a9fb9828517}{00598}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9782fe89777b5ec032262a9fb9828517}{test\_gpr\_consistency\_std\_cov\_non\_invertible\_kernel}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00599}00599\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ consistency\ between\ the\ returned\ std.\ dev.\ and\ the\ covariance.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00600}00600\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00601}00601\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/19936}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00602}00602\ \textcolor{stringliteral}{\ \ \ \ Inconsistencies\ were\ observed\ when\ the\ kernel\ cannot\ be\ inverted\ (or}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00603}00603\ \textcolor{stringliteral}{\ \ \ \ numerically\ stable).}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00604}00604\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00605}00605\ \ \ \ \ kernel\ =\ \mbox{\hyperlink{classC}{C}}(8.98576054e05,\ (1e-\/12,\ 1e12))\ *\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00606}00606\ \ \ \ \ \ \ \ \ [5.91326520e02,\ 1.32584051e03],\ (1e-\/12,\ 1e12)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00607}00607\ \ \ \ \ )\ +\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1WhiteKernel}{WhiteKernel}}(noise\_level=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00608}00608\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=kernel,\ alpha=0,\ optimizer=\textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00609}00609\ \ \ \ \ X\_train\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00610}00610\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00611}00611\ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ 0.0],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00612}00612\ \ \ \ \ \ \ \ \ \ \ \ \ [1.54919334,\ -\/0.77459667],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00613}00613\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.54919334,\ 0.0],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00614}00614\ \ \ \ \ \ \ \ \ \ \ \ \ [0.0,\ -\/1.54919334],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00615}00615\ \ \ \ \ \ \ \ \ \ \ \ \ [0.77459667,\ 0.77459667],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/0.77459667,\ 1.54919334],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00617}00617\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00618}00618\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00619}00619\ \ \ \ \ y\_train\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00620}00620\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00621}00621\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/2.14882017e-\/10],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00622}00622\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/4.66975823e00],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00623}00623\ \ \ \ \ \ \ \ \ \ \ \ \ [4.01823986e00],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00624}00624\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.30303674e00],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.35760156e00],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ [3.31215668e00],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00627}00627\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00628}00628\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00629}00629\ \ \ \ \ gpr.fit(X\_train,\ y\_train)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00630}00630\ \ \ \ \ X\_test\ =\ np.array(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00631}00631\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.93649167,\ -\/1.93649167],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ [1.93649167,\ -\/1.93649167],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ [-\/1.93649167,\ 1.93649167],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ [1.93649167,\ 1.93649167],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00636}00636\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00637}00637\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00638}00638\ \ \ \ \ pred1,\ std\ =\ gpr.predict(X\_test,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00639}00639\ \ \ \ \ pred2,\ cov\ =\ gpr.predict(X\_test,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00640}00640\ \ \ \ \ assert\_allclose(std,\ np.sqrt(np.diagonal(cov)),\ rtol=1e-\/5)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00641}00641\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00642}00642\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00643}00643\ \textcolor{preprocessor}{@pytest.mark.parametrize}(}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00644}00644\ \ \ \ \ \textcolor{stringliteral}{"{}params,\ TypeError,\ err\_msg"{}},}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00645}00645\ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00646}00646\ \ \ \ \ \ \ \ \ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}alpha"{}}:\ np.zeros(100)\},}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ ValueError,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}alpha\ must\ be\ a\ scalar\ or\ an\ array\ with\ same\ number\ of\ entries\ as\ y"{}},}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00650}00650\ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00651}00651\ \ \ \ \ \ \ \ \ (}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}kernel"{}}:\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1WhiteKernel}{WhiteKernel}}(noise\_level\_bounds=(-\/np.inf,\ np.inf)),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}n\_restarts\_optimizer"{}}:\ 2,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ ValueError,}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}requires\ that\ all\ bounds\ are\ finite"{}},}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00658}00658\ \ \ \ \ \ \ \ \ ),}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00659}00659\ \ \ \ \ ],}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00660}00660\ )}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00661}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_abf2494662f5400f1af3780a8363f33f0}{00661}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_abf2494662f5400f1af3780a8363f33f0}{test\_gpr\_fit\_error}}(params,\ TypeError,\ err\_msg):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00662}00662\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ expected\ error\ are\ raised\ during\ fit."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00663}00663\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(**params)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00664}00664\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(TypeError,\ match=err\_msg):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00665}00665\ \ \ \ \ \ \ \ \ gpr.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00666}00666\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00667}00667\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00668}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_aed0bd563eb469d22825f50ccbe1bce8e}{00668}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_aed0bd563eb469d22825f50ccbe1bce8e}{test\_gpr\_lml\_error}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00669}00669\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ we\ raise\ the\ proper\ error\ in\ the\ LML\ method."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00670}00670\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=\mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}()).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00671}00671\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00672}00672\ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{"{}Gradient\ can\ only\ be\ evaluated\ for\ theta!=None"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00673}00673\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=err\_msg):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00674}00674\ \ \ \ \ \ \ \ \ gpr.log\_marginal\_likelihood(eval\_gradient=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00675}00675\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00676}00676\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00677}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_abcd909bd1e9b40c17c28f8333741be31}{00677}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_abcd909bd1e9b40c17c28f8333741be31}{test\_gpr\_predict\_error}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00678}00678\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ we\ raise\ the\ proper\ error\ during\ predict."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00679}00679\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=\mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1kernels_1_1RBF}{RBF}}()).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00680}00680\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00681}00681\ \ \ \ \ err\_msg\ =\ \textcolor{stringliteral}{"{}At\ most\ one\ of\ return\_std\ or\ return\_cov\ can\ be\ requested."{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00682}00682\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(RuntimeError,\ match=err\_msg):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00683}00683\ \ \ \ \ \ \ \ \ gpr.predict(X,\ return\_cov=\textcolor{keyword}{True},\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00684}00684\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00685}00685\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00686}00686\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}normalize\_y"{},\ [True,\ False])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00687}00687\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_targets"{},\ [None,\ 1,\ 10])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00688}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9ed6be0d95651ce006d1207f97a0ff27}{00688}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a9ed6be0d95651ce006d1207f97a0ff27}{test\_predict\_shapes}}(normalize\_y,\ n\_targets):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00689}00689\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ shapes\ of\ y\_mean,\ y\_std,\ and\ y\_cov\ in\ single-\/output}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00690}00690\ \textcolor{stringliteral}{\ \ \ \ (n\_targets=None)\ and\ multi-\/output\ settings,\ including\ the\ edge\ case\ when}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00691}00691\ \textcolor{stringliteral}{\ \ \ \ n\_targets=1,\ where\ the\ sklearn\ convention\ is\ to\ squeeze\ the\ predictions.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00692}00692\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00693}00693\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00694}00694\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/17394}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00695}00695\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/18065}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00696}00696\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/22174}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00697}00697\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00698}00698\ \ \ \ \ rng\ =\ np.random.RandomState(1234)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00699}00699\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00700}00700\ \ \ \ \ n\_features,\ n\_samples\_train,\ n\_samples\_test\ =\ 6,\ 9,\ 7}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00701}00701\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00702}00702\ \ \ \ \ y\_train\_shape\ =\ (n\_samples\_train,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00703}00703\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00704}00704\ \ \ \ \ \ \ \ \ y\_train\_shape\ =\ y\_train\_shape\ +\ (n\_targets,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00705}00705\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00706}00706\ \ \ \ \ \textcolor{comment}{\#\ By\ convention\ single-\/output\ data\ is\ squeezed\ upon\ prediction}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00707}00707\ \ \ \ \ y\_test\_shape\ =\ (n\_samples\_test,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00708}00708\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ n\_targets\ >\ 1:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00709}00709\ \ \ \ \ \ \ \ \ y\_test\_shape\ =\ y\_test\_shape\ +\ (n\_targets,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00710}00710\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00711}00711\ \ \ \ \ X\_train\ =\ rng.randn(n\_samples\_train,\ n\_features)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00712}00712\ \ \ \ \ X\_test\ =\ rng.randn(n\_samples\_test,\ n\_features)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00713}00713\ \ \ \ \ y\_train\ =\ rng.randn(*y\_train\_shape)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00714}00714\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00715}00715\ \ \ \ \ model\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(normalize\_y=normalize\_y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00716}00716\ \ \ \ \ model.fit(X\_train,\ y\_train)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00717}00717\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00718}00718\ \ \ \ \ y\_pred,\ y\_std\ =\ model.predict(X\_test,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00719}00719\ \ \ \ \ \_,\ y\_cov\ =\ model.predict(X\_test,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00720}00720\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00721}00721\ \ \ \ \ \textcolor{keyword}{assert}\ y\_pred.shape\ ==\ y\_test\_shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00722}00722\ \ \ \ \ \textcolor{keyword}{assert}\ y\_std.shape\ ==\ y\_test\_shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00723}00723\ \ \ \ \ \textcolor{keyword}{assert}\ y\_cov.shape\ ==\ (n\_samples\_test,)\ +\ y\_test\_shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00724}00724\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00725}00725\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00726}00726\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}normalize\_y"{},\ [True,\ False])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00727}00727\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_targets"{},\ [None,\ 1,\ 10])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00728}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ac56866c51a19a89629f76cebf008437c}{00728}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ac56866c51a19a89629f76cebf008437c}{test\_sample\_y\_shapes}}(normalize\_y,\ n\_targets):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00729}00729\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ shapes\ of\ y\_samples\ in\ single-\/output\ (n\_targets=0)\ and}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00730}00730\ \textcolor{stringliteral}{\ \ \ \ multi-\/output\ settings,\ including\ the\ edge\ case\ when\ n\_targets=1,\ where\ the}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00731}00731\ \textcolor{stringliteral}{\ \ \ \ sklearn\ convention\ is\ to\ squeeze\ the\ predictions.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00732}00732\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00733}00733\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00734}00734\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/22175}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00735}00735\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00736}00736\ \ \ \ \ rng\ =\ np.random.RandomState(1234)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00737}00737\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00738}00738\ \ \ \ \ n\_features,\ n\_samples\_train\ =\ 6,\ 9}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00739}00739\ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ spatial\ locations\ to\ predict\ at}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00740}00740\ \ \ \ \ n\_samples\_X\_test\ =\ 7}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00741}00741\ \ \ \ \ \textcolor{comment}{\#\ Number\ of\ sample\ predictions\ per\ test\ point}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00742}00742\ \ \ \ \ n\_samples\_y\_test\ =\ 5}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00743}00743\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00744}00744\ \ \ \ \ y\_train\_shape\ =\ (n\_samples\_train,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00745}00745\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00746}00746\ \ \ \ \ \ \ \ \ y\_train\_shape\ =\ y\_train\_shape\ +\ (n\_targets,)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00747}00747\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00748}00748\ \ \ \ \ \textcolor{comment}{\#\ By\ convention\ single-\/output\ data\ is\ squeezed\ upon\ prediction}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00749}00749\ \ \ \ \ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ n\_targets\ >\ 1:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00750}00750\ \ \ \ \ \ \ \ \ y\_test\_shape\ =\ (n\_samples\_X\_test,\ n\_targets,\ n\_samples\_y\_test)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00751}00751\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00752}00752\ \ \ \ \ \ \ \ \ y\_test\_shape\ =\ (n\_samples\_X\_test,\ n\_samples\_y\_test)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00753}00753\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00754}00754\ \ \ \ \ X\_train\ =\ rng.randn(n\_samples\_train,\ n\_features)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00755}00755\ \ \ \ \ X\_test\ =\ rng.randn(n\_samples\_X\_test,\ n\_features)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00756}00756\ \ \ \ \ y\_train\ =\ rng.randn(*y\_train\_shape)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00757}00757\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00758}00758\ \ \ \ \ model\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(normalize\_y=normalize\_y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00759}00759\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00760}00760\ \ \ \ \ \textcolor{comment}{\#\ FIXME:\ before\ fitting,\ the\ estimator\ does\ not\ have\ information\ regarding}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00761}00761\ \ \ \ \ \textcolor{comment}{\#\ the\ number\ of\ targets\ and\ default\ to\ 1.\ This\ is\ inconsistent\ with\ the\ shape}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00762}00762\ \ \ \ \ \textcolor{comment}{\#\ provided\ after\ \`{}fit`.\ This\ assert\ should\ be\ made\ once\ the\ following\ issue}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00763}00763\ \ \ \ \ \textcolor{comment}{\#\ is\ fixed:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00764}00764\ \ \ \ \ \textcolor{comment}{\#\ https://github.com/scikit-\/learn/scikit-\/learn/issues/22430}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00765}00765\ \ \ \ \ \textcolor{comment}{\#\ y\_samples\ =\ model.sample\_y(X\_test,\ n\_samples=n\_samples\_y\_test)}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00766}00766\ \ \ \ \ \textcolor{comment}{\#\ assert\ y\_samples.shape\ ==\ y\_test\_shape}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00767}00767\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00768}00768\ \ \ \ \ model.fit(X\_train,\ y\_train)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00769}00769\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00770}00770\ \ \ \ \ y\_samples\ =\ model.sample\_y(X\_test,\ n\_samples=n\_samples\_y\_test)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00771}00771\ \ \ \ \ \textcolor{keyword}{assert}\ y\_samples.shape\ ==\ y\_test\_shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00772}00772\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00773}00773\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00774}00774\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_targets"{},\ [None,\ 1,\ 2,\ 3])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00775}00775\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_samples"{},\ [1,\ 5])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00776}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a1ace91aefd207e8e600ebe638031403f}{00776}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a1ace91aefd207e8e600ebe638031403f}{test\_sample\_y\_shape\_with\_prior}}(n\_targets,\ n\_samples):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00777}00777\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ output\ shape\ of\ \`{}sample\_y\`{}\ is\ consistent\ before\ and\ after\ \`{}fit\`{}."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00778}00778\ \ \ \ \ rng\ =\ np.random.RandomState(1024)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00779}00779\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00780}00780\ \ \ \ \ X\ =\ rng.randn(10,\ 3)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00781}00781\ \ \ \ \ y\ =\ rng.randn(10,\ n\_targets\ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ 1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00782}00782\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00783}00783\ \ \ \ \ model\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(n\_targets=n\_targets)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00784}00784\ \ \ \ \ shape\_before\_fit\ =\ model.sample\_y(X,\ n\_samples=n\_samples).shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00785}00785\ \ \ \ \ model.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00786}00786\ \ \ \ \ shape\_after\_fit\ =\ model.sample\_y(X,\ n\_samples=n\_samples).shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00787}00787\ \ \ \ \ \textcolor{keyword}{assert}\ shape\_before\_fit\ ==\ shape\_after\_fit}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00788}00788\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00789}00789\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00790}00790\ \textcolor{preprocessor}{@pytest.mark.parametrize("{}n\_targets"{},\ [None,\ 1,\ 2,\ 3])}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00791}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a794fb893e56a7162f07fcc0422b6f397}{00791}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a794fb893e56a7162f07fcc0422b6f397}{test\_predict\_shape\_with\_prior}}(n\_targets):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00792}00792\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ the\ output\ shape\ of\ \`{}predict\`{}\ with\ prior\ distribution."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00793}00793\ \ \ \ \ rng\ =\ np.random.RandomState(1024)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00794}00794\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00795}00795\ \ \ \ \ n\_sample\ =\ 10}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00796}00796\ \ \ \ \ X\ =\ rng.randn(n\_sample,\ 3)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00797}00797\ \ \ \ \ y\ =\ rng.randn(n\_sample,\ n\_targets\ \textcolor{keywordflow}{if}\ n\_targets\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ 1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00798}00798\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00799}00799\ \ \ \ \ model\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(n\_targets=n\_targets)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00800}00800\ \ \ \ \ mean\_prior,\ cov\_prior\ =\ model.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00801}00801\ \ \ \ \ \_,\ std\_prior\ =\ model.predict(X,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00802}00802\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00803}00803\ \ \ \ \ model.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00804}00804\ \ \ \ \ mean\_post,\ cov\_post\ =\ model.predict(X,\ return\_cov=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00805}00805\ \ \ \ \ \_,\ std\_post\ =\ model.predict(X,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00806}00806\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00807}00807\ \ \ \ \ \textcolor{keyword}{assert}\ mean\_prior.shape\ ==\ mean\_post.shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00808}00808\ \ \ \ \ \textcolor{keyword}{assert}\ cov\_prior.shape\ ==\ cov\_post.shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00809}00809\ \ \ \ \ \textcolor{keyword}{assert}\ std\_prior.shape\ ==\ std\_post.shape}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00810}00810\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00811}00811\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00812}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ab981dc9bf32d3743e3f03ff647c81b71}{00812}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_ab981dc9bf32d3743e3f03ff647c81b71}{test\_n\_targets\_error}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00813}00813\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Check\ that\ an\ error\ is\ raised\ when\ the\ number\ of\ targets\ seen\ at\ fit\ is}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00814}00814\ \textcolor{stringliteral}{\ \ \ \ inconsistent\ with\ n\_targets.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00815}00815\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00816}00816\ \ \ \ \ rng\ =\ np.random.RandomState(0)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00817}00817\ \ \ \ \ X\ =\ rng.randn(10,\ 3)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00818}00818\ \ \ \ \ y\ =\ rng.randn(10,\ 2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00819}00819\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00820}00820\ \ \ \ \ model\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(n\_targets=1)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00821}00821\ \ \ \ \ \textcolor{keyword}{with}\ pytest.raises(ValueError,\ match=\textcolor{stringliteral}{"{}The\ number\ of\ targets\ seen\ in\ \`{}y`"{}}):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00822}00822\ \ \ \ \ \ \ \ \ model.fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00823}00823\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00824}00824\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00825}\mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1tests_1_1test__gpr_1_1CustomKernel}{00825}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1tests_1_1test__gpr_1_1CustomKernel}{CustomKernel}}(\mbox{\hyperlink{classC}{C}}):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00826}00826\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00827}00827\ \textcolor{stringliteral}{\ \ \ \ A\ custom\ kernel\ that\ has\ a\ diag\ method\ that\ returns\ the\ first\ column\ of\ the}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00828}00828\ \textcolor{stringliteral}{\ \ \ \ input\ matrix\ X.\ This\ is\ a\ helper\ for\ the\ test\ to\ check\ that\ the\ input}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00829}00829\ \textcolor{stringliteral}{\ \ \ \ matrix\ X\ is\ not\ mutated.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00830}00830\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00831}00831\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00832}00832\ \ \ \ \ \textcolor{keyword}{def\ }diag(self,\ X):}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00833}00833\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ X[:,\ 0]}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00834}00834\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00835}00835\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00836}\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a89439fb11833dff1a0144535d99c0f3e}{00836}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacesklearn_1_1gaussian__process_1_1tests_1_1test__gpr_a89439fb11833dff1a0144535d99c0f3e}{test\_gpr\_predict\_input\_not\_modified}}():}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00837}00837\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00838}00838\ \textcolor{stringliteral}{\ \ \ \ Check\ that\ the\ input\ X\ is\ not\ modified\ by\ the\ predict\ method\ of\ the}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00839}00839\ \textcolor{stringliteral}{\ \ \ \ GaussianProcessRegressor\ when\ setting\ return\_std=True.}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00840}00840\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00841}00841\ \textcolor{stringliteral}{\ \ \ \ Non-\/regression\ test\ for:}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00842}00842\ \textcolor{stringliteral}{\ \ \ \ https://github.com/scikit-\/learn/scikit-\/learn/issues/24340}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00843}00843\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00844}00844\ \ \ \ \ gpr\ =\ \mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1__gpr_1_1GaussianProcessRegressor}{GaussianProcessRegressor}}(kernel=\mbox{\hyperlink{classsklearn_1_1gaussian__process_1_1tests_1_1test__gpr_1_1CustomKernel}{CustomKernel}}()).fit(X,\ y)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00845}00845\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00846}00846\ \ \ \ \ X2\_copy\ =\ np.copy(X2)}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00847}00847\ \ \ \ \ \_,\ \_\ =\ gpr.predict(X2,\ return\_std=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00848}00848\ }
\DoxyCodeLine{\Hypertarget{test__gpr_8py_source_l00849}00849\ \ \ \ \ assert\_allclose(X2,\ X2\_copy)}

\end{DoxyCode}
