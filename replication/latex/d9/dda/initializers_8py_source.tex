\doxysection{initializers.\+py}
\hypertarget{initializers_8py_source}{}\label{initializers_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/initializers.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/externals/loky/initializers.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers}{00001}}\ \textcolor{keyword}{import}\ warnings}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00004}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers_a4407cee76f84adc3ea038ef769447e89}{00004}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers_a4407cee76f84adc3ea038ef769447e89}{\_viztracer\_init}}(init\_kwargs):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00005}00005\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Initialize\ viztracer's\ profiler\ in\ worker\ processes"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00006}00006\ \ \ \ \ \textcolor{keyword}{from}\ viztracer\ \textcolor{keyword}{import}\ VizTracer}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00008}00008\ \ \ \ \ tracer\ =\ VizTracer(**init\_kwargs)}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00009}00009\ \ \ \ \ tracer.register\_exit()}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00010}00010\ \ \ \ \ tracer.start()}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00013}00013\ \textcolor{keyword}{def\ }\_make\_viztracer\_initializer\_and\_initargs():}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00014}00014\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00015}00015\ \ \ \ \ \ \ \ \ \textcolor{keyword}{import}\ viztracer}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ tracer\ =\ viztracer.get\_tracer()}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ tracer\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ getattr(tracer,\ \textcolor{stringliteral}{"{}enable"{}},\ \textcolor{keyword}{False}):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Profiler\ is\ active:\ introspect\ its\ configuration\ to}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ initialize\ the\ workers\ with\ the\ same\ configuration.}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_viztracer\_init,\ (tracer.init\_kwargs,)}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ viztracer\ is\ not\ installed:\ nothing\ to\ do}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ In\ case\ viztracer's\ API\ evolve,\ we\ do\ not\ want\ to\ crash\ loky\ but}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ want\ to\ know\ about\ it\ to\ be\ able\ to\ update\ loky.}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ warnings.warn(f\textcolor{stringliteral}{"{}Unable\ to\ introspect\ viztracer\ state:\ \{e\}"{}})}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None},\ ()}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00032}\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1initializers_1_1__ChainedInitializer}{00032}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1initializers_1_1__ChainedInitializer}{\_ChainedInitializer}}:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00033}00033\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compound\ worker\ initializer}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00034}00034\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ This\ is\ meant\ to\ be\ used\ in\ conjunction\ with\ \_chain\_initializers\ to}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ produce\ \ the\ necessary\ chained\_args\ list\ to\ be\ passed\ to\ \_\_call\_\_.}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00039}00039\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ initializers):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1initializers_1_1__ChainedInitializer_ab44dc6ee6bfc6d62623af72e64303c3e}{\_initializers}}\ =\ initializers}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00042}00042\ \ \ \ \ \textcolor{keyword}{def\ }\_\_call\_\_(self,\ *chained\_args):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ initializer,\ args\ \textcolor{keywordflow}{in}\ zip(self.\mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1initializers_1_1__ChainedInitializer_ab44dc6ee6bfc6d62623af72e64303c3e}{\_initializers}},\ chained\_args):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ initializer(*args)}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00047}\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers_ae3381f8e2864b40691e296e4441b83c8}{00047}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers_ae3381f8e2864b40691e296e4441b83c8}{\_chain\_initializers}}(initializer\_and\_args):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00048}00048\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Convenience\ helper\ to\ combine\ a\ sequence\ of\ initializers.}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00049}00049\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00050}00050\ \textcolor{stringliteral}{\ \ \ \ If\ some\ initializers\ are\ None,\ they\ are\ filtered\ out.}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00051}00051\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00052}00052\ \ \ \ \ filtered\_initializers\ =\ []}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00053}00053\ \ \ \ \ filtered\_initargs\ =\ []}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{for}\ initializer,\ initargs\ \textcolor{keywordflow}{in}\ initializer\_and\_args:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ initializer\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ filtered\_initializers.append(initializer)}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ filtered\_initargs.append(initargs)}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00059}00059\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ filtered\_initializers:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None},\ ()}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{elif}\ len(filtered\_initializers)\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ filtered\_initializers[0],\ filtered\_initargs[0]}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00063}00063\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classjoblib_1_1externals_1_1loky_1_1initializers_1_1__ChainedInitializer}{\_ChainedInitializer}}(filtered\_initializers),\ filtered\_initargs}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00067}00067\ \textcolor{keyword}{def\ }\_prepare\_initializer(initializer,\ initargs):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{if}\ initializer\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ callable(initializer):}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classTypeError}{TypeError}}(}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}initializer\ must\ be\ a\ callable,\ got:\ \{initializer!r\}"{}}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00073}00073\ \ \ \ \ \textcolor{comment}{\#\ Introspect\ runtime\ to\ determine\ if\ we\ need\ to\ propagate\ the\ viztracer}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00074}00074\ \ \ \ \ \textcolor{comment}{\#\ profiler\ information\ to\ the\ workers:}}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00075}00075\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacejoblib_1_1externals_1_1loky_1_1initializers_ae3381f8e2864b40691e296e4441b83c8}{\_chain\_initializers}}(}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ (initializer,\ initargs),}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \_make\_viztracer\_initializer\_and\_initargs(),}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{initializers_8py_source_l00080}00080\ \ \ \ \ )}

\end{DoxyCode}
