\doxysection{cff.\+py}
\hypertarget{subset_2cff_8py_source}{}\label{subset_2cff_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/fontTools/subset/cff.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/fontTools/subset/cff.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00001}\mbox{\hyperlink{namespacefontTools_1_1subset_1_1cff}{00001}}\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1misc}{fontTools.misc}}\ \textcolor{keyword}{import}\ psCharStrings}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00002}00002\ \textcolor{keyword}{from}\ fontTools\ \textcolor{keyword}{import}\ ttLib}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00003}00003\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1pens_1_1basePen}{fontTools.pens.basePen}}\ \textcolor{keyword}{import}\ NullPen}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1misc_1_1roundTools}{fontTools.misc.roundTools}}\ \textcolor{keyword}{import}\ otRound}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00005}00005\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1misc_1_1loggingTools}{fontTools.misc.loggingTools}}\ \textcolor{keyword}{import}\ deprecateFunction}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00006}00006\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1subset_1_1util}{fontTools.subset.util}}\ \textcolor{keyword}{import}\ \_add\_method,\ \_uniq\_sort}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00009}\mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler}{00009}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler}{\_ClosureGlyphsT2Decompiler}}(\mbox{\hyperlink{classfontTools_1_1misc_1_1psCharStrings_1_1SimpleT2Decompiler}{psCharStrings.SimpleT2Decompiler}}):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00010}00010\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ components,\ localSubrs,\ globalSubrs):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00011}00011\ \ \ \ \ \ \ \ \ psCharStrings.SimpleT2Decompiler.\_\_init\_\_(self,\ localSubrs,\ globalSubrs)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00012}00012\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler_a955c55f9aa9ec132f5a34fb1976991a2}{components}}\ =\ components}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00014}00014\ \ \ \ \ \textcolor{keyword}{def\ }op\_endchar(self,\ index):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00015}00015\ \ \ \ \ \ \ \ \ args\ =\ self.\mbox{\hyperlink{classfontTools_1_1misc_1_1psCharStrings_1_1SimpleT2Decompiler_a4270b4efe114fdc35ae66e9dc00e29e4}{popall}}()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(args)\ >=\ 4:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1encodings_1_1StandardEncoding}{fontTools.encodings.StandardEncoding}}\ \textcolor{keyword}{import}\ StandardEncoding}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00019}00019\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ endchar\ can\ do\ seac\ accent\ bulding;\ The\ T2\ spec\ says\ it's\ deprecated,}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ but\ recent\ software\ that\ shall\ remain\ nameless\ does\ output\ it.}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ adx,\ ady,\ bchar,\ achar\ =\ args[-\/4:]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ baseGlyph\ =\ StandardEncoding[bchar]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \ \ \ \ accentGlyph\ =\ StandardEncoding[achar]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler_a955c55f9aa9ec132f5a34fb1976991a2}{components}}.add(baseGlyph)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler_a955c55f9aa9ec132f5a34fb1976991a2}{components}}.add(accentGlyph)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00028}00028\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00029}00029\ \textcolor{keyword}{def\ }closure\_glyphs(self,\ s):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00030}00030\ \ \ \ \ cff\ =\ self.cff}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{assert}\ len(cff)\ ==\ 1}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00032}00032\ \ \ \ \ font\ =\ cff[cff.keys()[0]]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00033}00033\ \ \ \ \ glyphSet\ =\ font.CharStrings}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00035}00035\ \ \ \ \ decompose\ =\ s.glyphs}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{while}\ decompose:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ components\ =\ set()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ g\ \textcolor{keywordflow}{in}\ decompose:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ glyphSet:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ gl\ =\ glyphSet[g]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ subrs\ =\ getattr(gl.private,\ \textcolor{stringliteral}{"{}Subrs"{}},\ [])}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ decompiler\ =\ \mbox{\hyperlink{classfontTools_1_1subset_1_1cff_1_1__ClosureGlyphsT2Decompiler}{\_ClosureGlyphsT2Decompiler}}(components,\ subrs,\ gl.globalSubrs)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ decompiler.execute(gl)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ components\ -\/=\ s.glyphs}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ s.glyphs.update(components)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ decompose\ =\ components}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00051}00051\ \textcolor{keyword}{def\ }\_empty\_charstring(font,\ glyphName,\ isCFF2,\ ignoreWidth=False):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00052}00052\ \ \ \ \ c,\ fdSelectIndex\ =\ font.CharStrings.getItemAndSelector(glyphName)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{if}\ isCFF2\ \textcolor{keywordflow}{or}\ ignoreWidth:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ CFF2\ charstrings\ have\ no\ widths\ nor\ 'endchar'\ operators}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ c.setProgram([]\ \textcolor{keywordflow}{if}\ isCFF2\ \textcolor{keywordflow}{else}\ [\textcolor{stringliteral}{"{}endchar"{}}])}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00056}00056\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(font,\ \textcolor{stringliteral}{"{}FDArray"{}})\ \textcolor{keywordflow}{and}\ font.FDArray\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ private\ =\ font.FDArray[fdSelectIndex].Private}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ private\ =\ font.Private}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ dfltWdX\ =\ private.defaultWidthX}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ nmnlWdX\ =\ private.nominalWidthX}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ pen\ =\ \mbox{\hyperlink{classfontTools_1_1pens_1_1basePen_1_1NullPen}{NullPen}}()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ c.draw(pen)\ \ \textcolor{comment}{\#\ this\ will\ set\ the\ charstring's\ width}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ c.width\ !=\ dfltWdX:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ c.program\ =\ [c.width\ -\/\ nmnlWdX,\ \textcolor{stringliteral}{"{}endchar"{}}]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ c.program\ =\ [\textcolor{stringliteral}{"{}endchar"{}}]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00071}00071\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00072}00072\ \textcolor{keyword}{def\ }prune\_pre\_subset(self,\ font,\ options):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00073}00073\ \ \ \ \ cff\ =\ self.cff}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00074}00074\ \ \ \ \ \textcolor{comment}{\#\ CFF\ table\ must\ have\ one\ font\ only}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00075}00075\ \ \ \ \ cff.fontNames\ =\ cff.fontNames[:1]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00077}00077\ \ \ \ \ \textcolor{keywordflow}{if}\ options.notdef\_glyph\ \textcolor{keywordflow}{and}\ \textcolor{keywordflow}{not}\ options.notdef\_outline:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ isCFF2\ =\ cff.major\ >\ 1}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ fontname\ \textcolor{keywordflow}{in}\ cff.keys():}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ font\ =\ cff[fontname]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \_empty\_charstring(font,\ \textcolor{stringliteral}{"{}.notdef"{}},\ isCFF2=isCFF2)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00082}00082\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00083}00083\ \ \ \ \ \textcolor{comment}{\#\ Clear\ useless\ Encoding}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00084}00084\ \ \ \ \ \textcolor{keywordflow}{for}\ fontname\ \textcolor{keywordflow}{in}\ cff.keys():}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ font\ =\ cff[fontname]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://github.com/fonttools/fonttools/issues/620}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ font.Encoding\ =\ \textcolor{stringliteral}{"{}StandardEncoding"{}}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00089}00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}\ \ \textcolor{comment}{\#\ bool(cff.fontNames)}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00092}00092\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00093}00093\ \textcolor{keyword}{def\ }subset\_glyphs(self,\ s):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00094}00094\ \ \ \ \ cff\ =\ self.cff}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00095}00095\ \ \ \ \ \textcolor{keywordflow}{for}\ fontname\ \textcolor{keywordflow}{in}\ cff.keys():}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ font\ =\ cff[fontname]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ cs\ =\ font.CharStrings}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ glyphs\ =\ s.glyphs.union(s.glyphs\_emptied)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00100}00100\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Load\ all\ glyphs}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ g\ \textcolor{keywordflow}{in}\ font.charset:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ glyphs:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ c,\ \_\ =\ cs.getItemAndSelector(g)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cs.charStringsAreIndexed:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ indices\ =\ [i\ \textcolor{keywordflow}{for}\ i,\ g\ \textcolor{keywordflow}{in}\ enumerate(font.charset)\ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{in}\ glyphs]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ csi\ =\ cs.charStringsIndex}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ csi.items\ =\ [csi.items[i]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ indices]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ del\ csi.file,\ csi.offsets}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(font,\ \textcolor{stringliteral}{"{}FDSelect"{}}):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sel\ =\ font.FDSelect}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sel.format\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sel.gidArray\ =\ [sel.gidArray[i]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ indices]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ newCharStrings\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ indicesIdx,\ charsetIdx\ \textcolor{keywordflow}{in}\ enumerate(indices):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ g\ =\ font.charset[charsetIdx]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{in}\ cs.charStrings:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ newCharStrings[g]\ =\ indicesIdx}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ cs.charStrings\ =\ newCharStrings}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00122}00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ cs.charStrings\ =\ \{g:\ v\ \textcolor{keywordflow}{for}\ g,\ v\ \textcolor{keywordflow}{in}\ cs.charStrings.items()\ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{in}\ glyphs\}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ font.charset\ =\ [g\ \textcolor{keywordflow}{for}\ g\ \textcolor{keywordflow}{in}\ font.charset\ \textcolor{keywordflow}{if}\ g\ \textcolor{keywordflow}{in}\ glyphs]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ font.numGlyphs\ =\ len(font.charset)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00126}00126\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ s.options.retain\_gids:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ isCFF2\ =\ cff.major\ >\ 1}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ g\ \textcolor{keywordflow}{in}\ s.glyphs\_emptied:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_empty\_charstring(font,\ g,\ isCFF2=isCFF2,\ ignoreWidth=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00131}00131\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00132}00132\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}\ \ \textcolor{comment}{\#\ any(cff[fontname].numGlyphs\ for\ fontname\ in\ cff.keys())}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00135}00135\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00136}00136\ \textcolor{keyword}{def\ }prune\_post\_subset(self,\ ttfFont,\ options):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00137}00137\ \ \ \ \ cff\ =\ self.cff}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00138}00138\ \ \ \ \ \textcolor{keywordflow}{for}\ fontname\ \textcolor{keywordflow}{in}\ cff.keys():}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ font\ =\ cff[fontname]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ cs\ =\ font.CharStrings}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Drop\ unused\ FontDictionaries}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hasattr(font,\ \textcolor{stringliteral}{"{}FDSelect"{}}):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ sel\ =\ font.FDSelect}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ indices\ =\ \_uniq\_sort(sel.gidArray)}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ sel.gidArray\ =\ [indices.index(ss)\ \textcolor{keywordflow}{for}\ ss\ \textcolor{keywordflow}{in}\ sel.gidArray]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ arr\ =\ font.FDArray}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ arr.items\ =\ [arr[i]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ indices]}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ del\ arr.file,\ arr.offsets}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00150}00150\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00151}00151\ \ \ \ \ \textcolor{comment}{\#\ Desubroutinize\ if\ asked\ for}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00152}00152\ \ \ \ \ \textcolor{keywordflow}{if}\ options.desubroutinize:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ cff.desubroutinize()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00154}00154\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00155}00155\ \ \ \ \ \textcolor{comment}{\#\ Drop\ hints\ if\ not\ needed}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00156}00156\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ options.hinting:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00157}00157\ \ \ \ \ \ \ \ \ self.remove\_hints()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00158}00158\ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{keywordflow}{not}\ options.desubroutinize:}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00159}00159\ \ \ \ \ \ \ \ \ self.remove\_unused\_subroutines()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00160}00160\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00163}00163\ \textcolor{preprocessor}{@deprecateFunction}(}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00164}00164\ \ \ \ \ \textcolor{stringliteral}{"{}use\ 'CFFFontSet.desubroutinize()'\ instead"{}},\ category=DeprecationWarning}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00165}00165\ )}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00166}00166\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00167}00167\ \textcolor{keyword}{def\ }desubroutinize(self):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00168}00168\ \ \ \ \ self.cff.desubroutinize()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00171}00171\ \textcolor{preprocessor}{@deprecateFunction}(}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00172}00172\ \ \ \ \ \textcolor{stringliteral}{"{}use\ 'CFFFontSet.remove\_hints()'\ instead"{}},\ category=DeprecationWarning}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00173}00173\ )}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00174}00174\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00175}00175\ \textcolor{keyword}{def\ }remove\_hints(self):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00176}00176\ \ \ \ \ self.cff.remove\_hints()}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00179}00179\ \textcolor{preprocessor}{@deprecateFunction}(}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00180}00180\ \ \ \ \ \textcolor{stringliteral}{"{}use\ 'CFFFontSet.remove\_unused\_subroutines'\ instead"{}},\ category=DeprecationWarning}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00181}00181\ )}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00182}00182\ \textcolor{preprocessor}{@\_add\_method(ttLib.getTableClass("{}CFF\ "{})})}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00183}00183\ \textcolor{keyword}{def\ }remove\_unused\_subroutines(self):}
\DoxyCodeLine{\Hypertarget{subset_2cff_8py_source_l00184}00184\ \ \ \ \ self.cff.remove\_unused\_subroutines()}

\end{DoxyCode}
