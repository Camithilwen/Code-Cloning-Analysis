\doxysection{create\+\_\+numpy\+\_\+pickle.\+py}
\hypertarget{create__numpy__pickle_8py_source}{}\label{create__numpy__pickle_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/data/create\_numpy\_pickle.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/joblib/test/data/create\_numpy\_pickle.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00001}\mbox{\hyperlink{namespacejoblib_1_1test_1_1data_1_1create__numpy__pickle}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00002}00002\ \textcolor{stringliteral}{This\ script\ is\ used\ to\ generate\ test\ data\ for\ joblib/test/test\_numpy\_pickle.py}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00003}00003\ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00005}00005\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00006}00006\ \textcolor{keyword}{import}\ sys}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00008}00008\ \textcolor{comment}{\#\ pytest\ needs\ to\ be\ able\ to\ import\ this\ module\ even\ when\ numpy\ is}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00009}00009\ \textcolor{comment}{\#\ not\ installed}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00010}00010\ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00011}00011\ \ \ \ \ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00012}00012\ \textcolor{keywordflow}{except}\ ImportError:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00013}00013\ \ \ \ \ np\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00015}00015\ \textcolor{keyword}{import}\ joblib}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00018}\mbox{\hyperlink{namespacejoblib_1_1test_1_1data_1_1create__numpy__pickle_ae7945f118a1e26cedd3de1f89211ca2f}{00018}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacejoblib_1_1test_1_1data_1_1create__numpy__pickle_ae7945f118a1e26cedd3de1f89211ca2f}{get\_joblib\_version}}(joblib\_version=joblib.\_\_version\_\_):}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00019}00019\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Normalize\ joblib\ version\ by\ removing\ suffix.}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00020}00020\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ >>>\ get\_joblib\_version('0.8.4')}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ '0.8.4'}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ >>>\ get\_joblib\_version('0.8.4b1')}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ '0.8.4'}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ >>>\ get\_joblib\_version('0.9.dev0')}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ '0.9'}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00027}00027\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00028}00028\ \ \ \ \ matches\ =\ [re.match(\textcolor{stringliteral}{r"{}(\(\backslash\)d+).*"{}},\ each)\ \textcolor{keywordflow}{for}\ each\ \textcolor{keywordflow}{in}\ joblib\_version.split(\textcolor{stringliteral}{"{}."{}})]}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}."{}}.join([m.group(1)\ \textcolor{keywordflow}{for}\ m\ \textcolor{keywordflow}{in}\ matches\ \textcolor{keywordflow}{if}\ m\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}])}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00032}00032\ \textcolor{keyword}{def\ }write\_test\_pickle(to\_pickle,\ args):}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00033}00033\ \ \ \ \ kwargs\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00034}00034\ \ \ \ \ compress\ =\ args.compress}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00035}00035\ \ \ \ \ method\ =\ args.method}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00036}00036\ \ \ \ \ joblib\_version\ =\ \mbox{\hyperlink{namespacejoblib_1_1test_1_1data_1_1create__numpy__pickle_ae7945f118a1e26cedd3de1f89211ca2f}{get\_joblib\_version}}()}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00037}00037\ \ \ \ \ py\_version\ =\ \textcolor{stringliteral}{"{}\{0[0]\}\{0[1]\}"{}}.format(sys.version\_info)}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00038}00038\ \ \ \ \ numpy\_version\ =\ \textcolor{stringliteral}{"{}"{}}.join(np.\_\_version\_\_.split(\textcolor{stringliteral}{"{}."{}})[:2])}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00040}00040\ \ \ \ \ \textcolor{comment}{\#\ The\ game\ here\ is\ to\ generate\ the\ right\ filename\ according\ to\ the\ options.}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00041}00041\ \ \ \ \ body\ =\ \textcolor{stringliteral}{"{}\_compressed"{}}\ \textcolor{keywordflow}{if}\ (compress\ \textcolor{keywordflow}{and}\ method\ ==\ \textcolor{stringliteral}{"{}zlib"{}})\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00042}00042\ \ \ \ \ \textcolor{keywordflow}{if}\ compress:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ method\ ==\ \textcolor{stringliteral}{"{}zlib"{}}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ kwargs[\textcolor{stringliteral}{"{}compress"{}}]\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ extension\ =\ \textcolor{stringliteral}{"{}.gz"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ kwargs[\textcolor{stringliteral}{"{}compress"{}}]\ =\ (method,\ 3)}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ extension\ =\ \textcolor{stringliteral}{"{}.pkl.\{\}"{}}.format(method)}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ args.cache\_size:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ kwargs[\textcolor{stringliteral}{"{}cache\_size"{}}]\ =\ 0}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ body\ +=\ \textcolor{stringliteral}{"{}\_cache\_size"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00052}00052\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ extension\ =\ \textcolor{stringliteral}{"{}.pkl"{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00055}00055\ \ \ \ \ pickle\_filename\ =\ \textcolor{stringliteral}{"{}joblib\_\{\}\{\}\_pickle\_py\{\}\_np\{\}\{\}"{}}.format(}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ joblib\_version,\ body,\ py\_version,\ numpy\_version,\ extension}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00057}00057\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00059}00059\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ joblib.dump(to\_pickle,\ pickle\_filename,\ **kwargs)}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ e:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ With\ old\ python\ version\ (=<\ 3.3.),\ we\ can\ arrive\ there\ when}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ dumping\ compressed\ pickle\ with\ LzmaFile.}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ print(}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Error:\ cannot\ generate\ file\ '\{\}'\ with\ arguments\ '\{\}'.\ "{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Error\ was:\ \{\}"{}}.format(pickle\_filename,\ kwargs,\ e)}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ print(\textcolor{stringliteral}{"{}File\ '\{\}'\ generated\ successfully."{}}.format(pickle\_filename))}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00072}00072\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00073}00073\ \ \ \ \ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00075}00075\ \ \ \ \ parser\ =\ argparse.ArgumentParser(description=\textcolor{stringliteral}{"{}Joblib\ pickle\ data\ generator."{}})}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00076}00076\ \ \ \ \ parser.add\_argument(}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/-\/cache\_size"{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ action=\textcolor{stringliteral}{"{}store\_true"{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{"{}Force\ creation\ of\ companion\ numpy\ files\ for\ pickled\ arrays."{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00080}00080\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00081}00081\ \ \ \ \ parser.add\_argument(}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/-\/compress"{}},\ action=\textcolor{stringliteral}{"{}store\_true"{}},\ help=\textcolor{stringliteral}{"{}Generate\ compress\ pickles."{}}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00083}00083\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00084}00084\ \ \ \ \ parser.add\_argument(}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}-\/-\/method"{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ type=str,}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00087}00087\ \ \ \ \ \ \ \ \ default=\textcolor{stringliteral}{"{}zlib"{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ choices=[\textcolor{stringliteral}{"{}zlib"{}},\ \textcolor{stringliteral}{"{}gzip"{}},\ \textcolor{stringliteral}{"{}bz2"{}},\ \textcolor{stringliteral}{"{}xz"{}},\ \textcolor{stringliteral}{"{}lzma"{}},\ \textcolor{stringliteral}{"{}lz4"{}}],}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ help=\textcolor{stringliteral}{"{}Set\ compression\ method."{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00090}00090\ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00091}00091\ \ \ \ \ \textcolor{comment}{\#\ We\ need\ to\ be\ specific\ about\ dtypes\ in\ particular\ endianness}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00092}00092\ \ \ \ \ \textcolor{comment}{\#\ because\ the\ pickles\ can\ be\ generated\ on\ one\ architecture\ and}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00093}00093\ \ \ \ \ \textcolor{comment}{\#\ the\ tests\ run\ on\ another\ one.\ See}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00094}00094\ \ \ \ \ \textcolor{comment}{\#\ https://github.com/joblib/joblib/issues/279.}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00095}00095\ \ \ \ \ to\_pickle\ =\ [}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ np.arange(5,\ dtype=np.dtype(\textcolor{stringliteral}{"{}<i8"{}})),}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ np.arange(5,\ dtype=np.dtype(\textcolor{stringliteral}{"{}<f8"{}})),}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00098}00098\ \ \ \ \ \ \ \ \ np.array([1,\ \textcolor{stringliteral}{"{}abc"{}},\ \{\textcolor{stringliteral}{"{}a"{}}:\ 1,\ \textcolor{stringliteral}{"{}b"{}}:\ 2\}],\ dtype=\textcolor{stringliteral}{"{}O"{}}),}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ all\ possible\ bytes\ as\ a\ byte\ string}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ np.arange(256,\ dtype=np.uint8).tobytes(),}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00101}00101\ \ \ \ \ \ \ \ \ np.matrix([0,\ 1,\ 2],\ dtype=np.dtype(\textcolor{stringliteral}{"{}<i8"{}})),}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ unicode\ string\ with\ non-\/ascii\ chars}}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}C'est\ l'\(\backslash\)xe9t\(\backslash\)xe9\ !"{}},}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00104}00104\ \ \ \ \ ]}
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{create__numpy__pickle_8py_source_l00106}00106\ \ \ \ \ write\_test\_pickle(to\_pickle,\ parser.parse\_args())}

\end{DoxyCode}
