\doxysection{geometry.\+py}
\hypertarget{geometry_8py_source}{}\label{geometry_8py_source}\index{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/fontTools/colorLib/geometry.py@{/home/jam/Research/IRES-\/2025/dev/src/llm-\/scripts/testing/hypothesis-\/testing/hyp-\/env/lib/python3.12/site-\/packages/fontTools/colorLib/geometry.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00001}\mbox{\hyperlink{namespacefontTools_1_1colorLib_1_1geometry}{00001}}\ \textcolor{stringliteral}{"{}"{}"{}Helpers\ for\ manipulating\ 2D\ points\ and\ vectors\ in\ COLR\ table."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00003}00003\ \textcolor{keyword}{from}\ math\ \textcolor{keyword}{import}\ copysign,\ cos,\ hypot,\ isclose,\ pi}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00004}00004\ \textcolor{keyword}{from}\ \mbox{\hyperlink{namespacefontTools_1_1misc_1_1roundTools}{fontTools.misc.roundTools}}\ \textcolor{keyword}{import}\ otRound}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00007}00007\ \textcolor{keyword}{def\ }\_vector\_between(origin,\ target):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00008}00008\ \ \ \ \ \textcolor{keywordflow}{return}\ (target[0]\ -\/\ origin[0],\ target[1]\ -\/\ origin[1])}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00011}00011\ \textcolor{keyword}{def\ }\_round\_point(pt):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00012}00012\ \ \ \ \ \textcolor{keywordflow}{return}\ (otRound(pt[0]),\ otRound(pt[1]))}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00015}00015\ \textcolor{keyword}{def\ }\_unit\_vector(vec):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00016}00016\ \ \ \ \ length\ =\ hypot(*vec)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00017}00017\ \ \ \ \ \textcolor{keywordflow}{if}\ length\ ==\ 0:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00019}00019\ \ \ \ \ \textcolor{keywordflow}{return}\ (vec[0]\ /\ length,\ vec[1]\ /\ length)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00022}00022\ \_CIRCLE\_INSIDE\_TOLERANCE\ =\ 1e-\/4}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00025}00025\ \textcolor{comment}{\#\ The\ unit\ vector's\ X\ and\ Y\ components\ are\ respectively}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00026}00026\ \textcolor{comment}{\#\ \ \ U\ =\ (cos(α),\ sin(α))}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00027}00027\ \textcolor{comment}{\#\ where\ α\ is\ the\ angle\ between\ the\ unit\ vector\ and\ the\ positive\ x\ axis.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00028}00028\ \_UNIT\_VECTOR\_THRESHOLD\ =\ cos(3\ /\ 8\ *\ pi)\ \ \textcolor{comment}{\#\ ==\ sin(1/8\ *\ pi)\ ==\ 0.38268343236508984}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00031}00031\ \textcolor{keyword}{def\ }\_rounding\_offset(direction):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00032}00032\ \ \ \ \ \textcolor{comment}{\#\ Return\ 2-\/tuple\ of\ -\//+\ 1.0\ or\ 0.0\ approximately\ based\ on\ the\ direction\ vector.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00033}00033\ \ \ \ \ \textcolor{comment}{\#\ We\ divide\ the\ unit\ circle\ in\ 8\ equal\ slices\ oriented\ towards\ the\ cardinal}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00034}00034\ \ \ \ \ \textcolor{comment}{\#\ (N,\ E,\ S,\ W)\ and\ intermediate\ (NE,\ SE,\ SW,\ NW)\ directions.\ To\ each\ slice\ we}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00035}00035\ \ \ \ \ \textcolor{comment}{\#\ map\ one\ of\ the\ possible\ cases:\ -\/1,\ 0,\ +1\ for\ either\ X\ and\ Y\ coordinate.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00036}00036\ \ \ \ \ \textcolor{comment}{\#\ E.g.\ Return\ (+1.0,\ -\/1.0)\ if\ unit\ vector\ is\ oriented\ towards\ SE,\ or}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00037}00037\ \ \ \ \ \textcolor{comment}{\#\ (-\/1.0,\ 0.0)\ if\ it's\ pointing\ West,\ etc.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00038}00038\ \ \ \ \ uv\ =\ \_unit\_vector(direction)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ uv:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (0,\ 0)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00042}00042\ \ \ \ \ result\ =\ []}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00043}00043\ \ \ \ \ \textcolor{keywordflow}{for}\ uv\_component\ \textcolor{keywordflow}{in}\ uv:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ -\/\_UNIT\_VECTOR\_THRESHOLD\ <=\ uv\_component\ <\ \_UNIT\_VECTOR\_THRESHOLD:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ unit\ vector\ component\ near\ 0:\ direction\ almost\ orthogonal\ to\ the}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ direction\ of\ the\ current\ axis,\ thus\ keep\ coordinate\ unchanged}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ result.append(0)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ nudge\ coord\ by\ +/-\/\ 1.0\ in\ direction\ of\ unit\ vector}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ result.append(copysign(1.0,\ uv\_component))}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00051}00051\ \ \ \ \ \textcolor{keywordflow}{return}\ tuple(result)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00054}\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle}{00054}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle}{Circle}}:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00055}00055\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ centre,\ radius):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}\ =\ centre}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_aafe8a14a48361b7d56e7391595d545b0}{radius}}\ =\ radius}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00058}00058\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00059}00059\ \ \ \ \ \textcolor{keyword}{def\ }\_\_repr\_\_(self):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ f\textcolor{stringliteral}{"{}Circle(centre=\{self.centre\},\ radius=\{self.radius\})"{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00062}00062\ \ \ \ \ \textcolor{keyword}{def\ }round(self):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle}{Circle}}(\_round\_point(self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}),\ otRound(self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_aafe8a14a48361b7d56e7391595d545b0}{radius}}))}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00065}00065\ \ \ \ \ \textcolor{keyword}{def\ }inside(self,\ outer\_circle,\ tolerance=\_CIRCLE\_INSIDE\_TOLERANCE):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ dist\ =\ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_aafe8a14a48361b7d56e7391595d545b0}{radius}}\ +\ hypot(*\_vector\_between(self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}},\ outer\_circle.centre))}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ isclose(outer\_circle.radius,\ dist,\ rel\_tol=\_CIRCLE\_INSIDE\_TOLERANCE)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ outer\_circle.radius\ >\ dist}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00072}00072\ \ \ \ \ \textcolor{keyword}{def\ }concentric(self,\ other):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}\ ==\ other.centre}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00074}00074\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00075}00075\ \ \ \ \ \textcolor{keyword}{def\ }move(self,\ dx,\ dy):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00076}00076\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}\ =\ (self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}[0]\ +\ dx,\ self.\mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle_afc2785411defac916c0b187efd425043}{centre}}[1]\ +\ dy)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00079}\mbox{\hyperlink{namespacefontTools_1_1colorLib_1_1geometry_aa459de1d26d0e4b76f8ff42bfb9fd40d}{00079}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacefontTools_1_1colorLib_1_1geometry_aa459de1d26d0e4b76f8ff42bfb9fd40d}{round\_start\_circle\_stable\_containment}}(c0,\ r0,\ c1,\ r1):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00080}00080\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Round\ start\ circle\ so\ that\ it\ stays\ inside/outside\ end\ circle\ after\ rounding.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00081}00081\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ The\ rounding\ of\ circle\ coordinates\ to\ integers\ may\ cause\ an\ abrupt\ change}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ if\ the\ start\ circle\ c0\ is\ so\ close\ to\ the\ end\ circle\ c1's\ perimiter\ that}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ it\ ends\ up\ falling\ outside\ (or\ inside)\ as\ a\ result\ of\ the\ rounding.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00085}00085\ \textcolor{stringliteral}{\ \ \ \ To\ keep\ the\ gradient\ unchanged,\ we\ nudge\ it\ in\ the\ right\ direction.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00086}00086\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00087}00087\ \textcolor{stringliteral}{\ \ \ \ See:}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00088}00088\ \textcolor{stringliteral}{\ \ \ \ https://github.com/googlefonts/colr-\/gradients-\/spec/issues/204}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00089}00089\ \textcolor{stringliteral}{\ \ \ \ https://github.com/googlefonts/picosvg/issues/158}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00090}00090\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00091}00091\ \ \ \ \ start,\ end\ =\ \mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle}{Circle}}(c0,\ r0),\ \mbox{\hyperlink{classfontTools_1_1colorLib_1_1geometry_1_1Circle}{Circle}}(c1,\ r1)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00093}00093\ \ \ \ \ inside\_before\_round\ =\ start.inside(end)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00095}00095\ \ \ \ \ round\_start\ =\ start.round()}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00096}00096\ \ \ \ \ round\_end\ =\ end.round()}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00097}00097\ \ \ \ \ inside\_after\_round\ =\ round\_start.inside(round\_end)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00099}00099\ \ \ \ \ \textcolor{keywordflow}{if}\ inside\_before\_round\ ==\ inside\_after\_round:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ round\_start}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00101}00101\ \ \ \ \ \textcolor{keywordflow}{elif}\ inside\_after\_round:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00102}00102\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ start\ was\ outside\ before\ rounding:\ we\ need\ to\ push\ start\ away\ from\ end}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00103}00103\ \ \ \ \ \ \ \ \ direction\ =\ \_vector\_between(round\_end.centre,\ round\_start.centre)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00104}00104\ \ \ \ \ \ \ \ \ radius\_delta\ =\ +1.0}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00105}00105\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ start\ was\ inside\ before\ rounding:\ we\ need\ to\ push\ start\ towards\ end}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ direction\ =\ \_vector\_between(round\_start.centre,\ round\_end.centre)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ radius\_delta\ =\ -\/1.0}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00109}00109\ \ \ \ \ dx,\ dy\ =\ \_rounding\_offset(direction)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00111}00111\ \ \ \ \ \textcolor{comment}{\#\ At\ most\ 2\ iterations\ ought\ to\ be\ enough\ to\ converge.\ Before\ the\ loop,\ we}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00112}00112\ \ \ \ \ \textcolor{comment}{\#\ know\ the\ start\ circle\ didn't\ keep\ containment\ after\ normal\ rounding;\ thus}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00113}00113\ \ \ \ \ \textcolor{comment}{\#\ we\ continue\ adjusting\ by\ -\//+\ 1.0\ until\ containment\ is\ restored.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00114}00114\ \ \ \ \ \textcolor{comment}{\#\ Normal\ rounding\ can\ at\ most\ move\ each\ coordinates\ -\//+0.5;\ in\ the\ worst\ case}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00115}00115\ \ \ \ \ \textcolor{comment}{\#\ both\ the\ start\ and\ end\ circle's\ centres\ and\ radii\ will\ be\ rounded\ in\ opposite}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00116}00116\ \ \ \ \ \textcolor{comment}{\#\ directions,\ e.g.\ when\ they\ move\ along\ a\ 45\ degree\ diagonal:}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00117}00117\ \ \ \ \ \textcolor{comment}{\#\ \ \ c0\ =\ (1.5,\ 1.5)\ ===>\ (2.0,\ 2.0)}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00118}00118\ \ \ \ \ \textcolor{comment}{\#\ \ \ r0\ =\ 0.5\ ===>\ 1.0}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00119}00119\ \ \ \ \ \textcolor{comment}{\#\ \ \ c1\ =\ (0.499,\ 0.499)\ ===>\ (0.0,\ 0.0)}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00120}00120\ \ \ \ \ \textcolor{comment}{\#\ \ \ r1\ =\ 2.499\ ===>\ 2.0}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00121}00121\ \ \ \ \ \textcolor{comment}{\#\ In\ this\ example,\ the\ relative\ distance\ between\ the\ circles,\ calculated}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00122}00122\ \ \ \ \ \textcolor{comment}{\#\ as\ r1\ -\/\ (r0\ +\ distance(c0,\ c1))\ is\ initially\ 0.57437\ (c0\ is\ inside\ c1),\ and}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00123}00123\ \ \ \ \ \textcolor{comment}{\#\ -\/1.82842\ after\ rounding\ (c0\ is\ now\ outside\ c1).\ Nudging\ c0\ by\ -\/1.0\ on\ both}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00124}00124\ \ \ \ \ \textcolor{comment}{\#\ x\ and\ y\ axes\ moves\ it\ towards\ c1\ by\ hypot(-\/1.0,\ -\/1.0)\ =\ 1.41421.\ Two\ of\ these}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00125}00125\ \ \ \ \ \textcolor{comment}{\#\ moves\ cover\ twice\ that\ distance,\ which\ is\ enough\ to\ restore\ containment.}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00126}00126\ \ \ \ \ max\_attempts\ =\ 2}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00127}00127\ \ \ \ \ \textcolor{keywordflow}{for}\ \_\ \textcolor{keywordflow}{in}\ range(max\_attempts):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ round\_start.concentric(round\_end):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ can't\ move\ c0\ towards\ c1\ (they\ are\ the\ same),\ so\ we\ change\ the\ radius}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ round\_start.radius\ +=\ radius\_delta}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ round\_start.radius\ >=\ 0}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ round\_start.move(dx,\ dy)}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ inside\_before\_round\ ==\ round\_start.inside(round\_end):}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00136}00136\ \ \ \ \ \textcolor{keywordflow}{else}:\ \ \textcolor{comment}{\#\ likely\ a\ bug}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ \mbox{\hyperlink{classAssertionError}{AssertionError}}(}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}Rounding\ circle\ \{start\}\ "{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{'inside'\ if\ inside\_before\_round\ else\ 'outside'\}\ "{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ f\textcolor{stringliteral}{"{}\{end\}\ failed\ after\ \{max\_attempts\}\ attempts!"{}}}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{geometry_8py_source_l00143}00143\ \ \ \ \ \textcolor{keywordflow}{return}\ round\_start}

\end{DoxyCode}
